/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2014 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 __fastcall RSNSupplicant::MetaClass::MetaClass(RSNSupplicant::MetaClass *__hidden this); // idb
__int64 __fastcall RSNSupplicant::MetaClass::~MetaClass(RSNSupplicant::MetaClass *__hidden this); // idb
__int64 __fastcall RSNSupplicant::RSNSupplicant(__int64 a1);
__int64 __fastcall RSNSupplicant::RSNSupplicant(__int64 a1);
__int64 __fastcall RSNSupplicant::~RSNSupplicant(RSNSupplicant *__hidden this); // idb
__int64 __fastcall RSNSupplicant::~RSNSupplicant(RSNSupplicant *__hidden this); // idb
void __fastcall RSNSupplicant::~RSNSupplicant(RSNSupplicant *this);
__int64 __fastcall RSNSupplicant::getMetaClass(RSNSupplicant *__hidden this); // idb
__int64 __fastcall RSNSupplicant::MetaClass::MetaClass(RSNSupplicant::MetaClass *__hidden this); // idb
__int64 __fastcall RSNSupplicant::MetaClass::alloc(RSNSupplicant::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall RSNSupplicant::RSNSupplicant(__int64 a1);
__int64 __fastcall RSNSupplicant::RSNSupplicant(__int64 a1);
int __fastcall RSNSupplicant::reset(RSNSupplicant *this);
void __fastcall RSNSupplicant::joinPTKThread(__int64 a1, __int64 a2);
char __fastcall RSNSupplicant::linkDown(RSNSupplicant *this);
__int64 __fastcall RSNSupplicant::clearKeys(RSNSupplicant *__hidden this); // idb
int __fastcall RSNSupplicant::init(RSNSupplicant *this);
int __fastcall RSNSupplicant::free(RSNSupplicant *this);
int __fastcall RSNSupplicant::freeAuthenticator(__int64 a1, __int64 a2);
// char __usercall RSNSupplicant::parseWPAIE@<al>(RSNSupplicant *this@<rdi>, unsigned __int8 *a2@<rsi>, char a3@<al>);
// char __usercall RSNSupplicant::parseRSNIE@<al>(RSNSupplicant *this@<rdi>, unsigned __int8 *a2@<rsi>, char a3@<al>);
char __fastcall RSNSupplicant::parseIE(RSNSupplicant *this, unsigned __int8 *a2);
char __fastcall RSNSupplicant::initWithInterfaceIEAndMode(RSNSupplicant *this, IO80211Interface *a2, unsigned __int8 *a3, __int64 a4, __int64 a5, __int64 a6);
char __fastcall RSNSupplicant::allocateAuthenticator(RSNSupplicant *this, ether_addr *a2, unsigned __int8 *a3);
int __fastcall RSNSupplicant::getCommandGate(RSNSupplicant *this);
void __fastcall RSNSupplicant::updateIE(RSNSupplicant *this, unsigned __int8 *a2);
__int64 __fastcall hex_dump(unsigned __int8 *a1, int a2, const char *a3, __int64 a4, __int64 a5, __int64 a6);
unsigned __int8 *__fastcall RSNSupplicant::findWPAIE(RSNSupplicant *this, unsigned __int8 *a2, unsigned __int64 *a3);
char __fastcall RSNSupplicant::wpaIECompatible(RSNSupplicant *this, unsigned __int8 *a2, unsigned __int64 a3);
unsigned __int8 *__fastcall RSNSupplicant::findRSNIE(RSNSupplicant *this, unsigned __int8 *a2, unsigned __int64 *a3);
char __fastcall RSNSupplicant::rsnIECompatible(RSNSupplicant *this, unsigned __int8 *a2, unsigned __int64 a3);
char __fastcall RSNSupplicant::shouldRoam(__int64 a1, __int64 a2);
// char __usercall RSNSupplicant::inputEAPOLFrame@<al>(RSNSupplicant *this@<rdi>, __mbuf *a2@<rsi>, char a3);
__int64 __fastcall RSNSupplicant::authenticatorForAddr(RSNSupplicant *this, ether_addr *a2);
char __fastcall RSNSupplicant::validateEAPOLMIC(__int64 a1, __int64 a2, __int64 a3, __int64 a4, unsigned __int16 a5, __int64 a6);
// char __usercall RSNSupplicant::decryptKeyData@<al>(__int64 a1@<rdx>, int a2@<ecx>, __int64 a3@<rdi>, __int64 a4@<rsi>, unsigned __int64 a5@<r15>);
// int __usercall RSNSupplicant::process3of4@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<rdi>, __int64 a4@<rsi>, int a5@<r8d>, char a6);
__int64 __fastcall RSNSupplicant::process1of4(RSNSupplicant *this, __int64 a2, __int64 a3, __int64 a4, int a5);
__int64 __fastcall RSNSupplicant::process1of2(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5);
int __fastcall RSNSupplicant::setCounterMeasures(RSNSupplicant *this, unsigned __int8 a2);
// int __usercall RSNSupplicant::setPMK@<eax>(RSNSupplicant *this@<rdi>, unsigned __int8 *a2@<rsi>, char a3);
__int64 __fastcall wpa_eapol_key_mic(unsigned __int8 *a1, int a2, unsigned __int8 *a3, unsigned __int64 a4, unsigned __int8 *a5);
signed __int64 __fastcall _aes_unwrap(unsigned __int8 *a1, int a2, unsigned __int8 *a3, unsigned __int8 *a4);
char __fastcall RSNSupplicant::storeFullRSNIE(__int64 a1, __int64 a2);
__int64 __fastcall RSNSupplicant::pmksaLookup(RSNSupplicant *__hidden this, ether_addr *, unsigned __int8 *); // idb
__int64 __fastcall RSNSupplicant::cachePMKSA(RSNSupplicant *this, ether_addr *a2);
// char __usercall RSNSupplicant::wpaPTKToApplePTK@<al>(char a1@<al>, __int64 a2@<rdx>, __int64 a3@<rdi>, __int64 a4@<rsi>);
char __fastcall RSNSupplicant::wpaPGTKToApplePGTK(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5);
char __fastcall RSNSupplicant::wpaPBIPGTKToApplePBIPGTK(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5);
int __fastcall ptk_thread(void *a1, void *a2);
char __fastcall RSNSupplicant::wpaGTKToAppleGTK(__int64 a1, __int64 a2, __int64 a3, void *a4, unsigned int a5, __int16 a6, char a7);
// char __usercall RSNSupplicant::installGTK@<al>(char a1@<al>, __int64 a2@<rdi>, __int64 a3@<rsi>);
char __fastcall RSNSupplicant::wpaIGTKToAppleIGTK(__int64 a1, __int64 a2, __int64 a3, __int64 a4, unsigned int a5, __int16 a6, const void *a7);
char __fastcall RSNSupplicant::installPTK(__int64 a1, __int64 a2);
bool __fastcall RSNSupplicant::useAuthenticatorPTK(__int64 a1, __int64 a2);
// int __usercall RSNSupplicant::sendKeyRequest@<eax>(char a1@<dl>, char a2@<cl>, __int64 a3@<rdi>, __int64 a4@<rsi>, char a5);
signed __int64 __fastcall RSNSupplicant::incrementRequestCounter(__int64 a1, __int64 a2);
__int64 __fastcall RSNSupplicant::state(RSNSupplicant *__hidden this); // idb
// int __usercall RSNSupplicant::micFailure@<eax>(RSNSupplicant *this@<rdi>, __int64 a2@<rax>, int a3@<esi>);
int __fastcall RSNSupplicant::ptkThread(__int64 a1, __int64 a2);
__int64 __fastcall RSNSupplicant::ptkThreadGated(RSNSupplicant *__hidden this, OSObject *, void *, void *, void *, void *); // idb
__int64 __fastcall RSNSupplicant::rsnPMKID(RSNSupplicant *this, unsigned __int8 *a2, unsigned __int8 *a3, unsigned __int8 *a4, unsigned __int8 *a5);
char __fastcall RSNSupplicant::ibssPeerArrived(RSNSupplicant *this, ether_addr *a2, unsigned __int8 *a3);
int __fastcall RSNSupplicant::ibssPeerLeft(RSNSupplicant *this, ether_addr *a2);
__int64 __fastcall RSNSupplicant::MetaClass::~MetaClass(RSNSupplicant::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a();
__int64 `global destructor keyed to'_a();
int __fastcall sha1_mac(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5);
__int64 __fastcall hmac_sha1_vector(const void *a1, unsigned __int64 a2, int a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall hmac_sha1(const void *a1, unsigned __int64 a2, __int64 a3, __int64 a4, __int64 a5);
__int64 __fastcall sha1_prf(const void *a1, unsigned __int64 a2, const char *a3, __int64 a4, __int64 a5, __int64 a6, size_t a7);
__int64 __fastcall sha1_t_prf(const void *a1, unsigned __int64 a2, const char *a3, __int64 a4, __int64 a5, __int64 a6, size_t a7);
signed __int64 __fastcall tls_prf(const void *a1, __int64 a2, const char *a3, __int64 a4, __int64 a5, __int64 a6, int a7);
__int64 __fastcall pbkdf2_sha1(const char *a1, __int64 a2, __int64 a3, signed int a4, void *a5, size_t a6);
int __fastcall sha1_vector(int a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall rc4_skip(__int64 a1, int a2, unsigned __int64 a3, __int64 a4, unsigned __int64 a5);
__int64 __fastcall md5_mac(__int64 a1, unsigned int a2, __int64 a3, unsigned int a4, __int64 a5);
__int64 __fastcall hmac_md5_vector(const void *a1, unsigned __int64 a2, unsigned __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall hmac_md5(const void *a1, unsigned __int64 a2, __int64 a3, __int64 a4, __int64 a5);
__int64 __fastcall IO80211WorkLoop::MetaClass::MetaClass(IO80211WorkLoop::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211WorkLoop::MetaClass::~MetaClass(IO80211WorkLoop::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211WorkLoop::IO80211WorkLoop(__int64 a1);
__int64 __fastcall IO80211WorkLoop::IO80211WorkLoop(__int64 a1);
__int64 __fastcall IO80211WorkLoop::~IO80211WorkLoop(IO80211WorkLoop *__hidden this); // idb
__int64 __fastcall IO80211WorkLoop::~IO80211WorkLoop(IO80211WorkLoop *__hidden this); // idb
void __fastcall IO80211WorkLoop::~IO80211WorkLoop(IO80211WorkLoop *this);
__int64 __fastcall IO80211WorkLoop::getMetaClass(IO80211WorkLoop *__hidden this); // idb
__int64 __fastcall IO80211WorkLoop::MetaClass::MetaClass(IO80211WorkLoop::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211WorkLoop::MetaClass::alloc(IO80211WorkLoop::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211WorkLoop::IO80211WorkLoop(__int64 a1);
__int64 __fastcall IO80211WorkLoop::IO80211WorkLoop(__int64 a1);
__int64 __fastcall IO80211WorkLoop::workLoop(IO80211WorkLoop *this, unsigned __int64 a2);
int __fastcall IO80211WorkLoop::sleepGateDeadline(IO80211WorkLoop *this, void *a2, unsigned int a3, __int64 a4);
int __fastcall IO80211WorkLoop::wakeupGate(IO80211WorkLoop *this, void *a2, unsigned __int8 a3);
int __fastcall IO80211WorkLoop::sleepGate(IO80211WorkLoop *this, void *a2);
int __fastcall IO80211WorkLoop::openGate(IO80211WorkLoop *this);
int __fastcall IO80211WorkLoop::closeGate(IO80211WorkLoop *this);
__int64 __fastcall IO80211WorkLoop::MetaClass::~MetaClass(IO80211WorkLoop::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_0();
__int64 `global destructor keyed to'_a_0();
__int64 __fastcall sha256_prf(void *a1, size_t a2, const char *a3, __int64 a4, __int64 a5, __int64 a6, unsigned __int64 a7);
__int64 __fastcall LogManagerDevice::MetaClass::MetaClass(LogManagerDevice::MetaClass *__hidden this); // idb
__int64 __fastcall LogManagerDevice::MetaClass::~MetaClass(LogManagerDevice::MetaClass *__hidden this); // idb
__int64 __fastcall LogManagerDevice::LogManagerDevice(__int64 a1);
__int64 __fastcall LogManagerDevice::LogManagerDevice(__int64 a1);
__int64 __fastcall LogManagerDevice::~LogManagerDevice(LogManagerDevice *__hidden this); // idb
__int64 __fastcall LogManagerDevice::~LogManagerDevice(LogManagerDevice *__hidden this); // idb
void __fastcall LogManagerDevice::~LogManagerDevice(LogManagerDevice *this);
__int64 __fastcall LogManagerDevice::getMetaClass(LogManagerDevice *__hidden this); // idb
__int64 __fastcall LogManagerDevice::MetaClass::MetaClass(LogManagerDevice::MetaClass *__hidden this); // idb
__int64 __fastcall LogManagerDevice::MetaClass::alloc(LogManagerDevice::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall LogManagerDevice::LogManagerDevice(__int64 a1);
__int64 __fastcall LogManagerDevice::LogManagerDevice(__int64 a1);
__int64 __fastcall LogManagerDevice::withDeviceNameAndGate(LogManagerDevice *this, IOCommandGate *a2, IOCommandGate *a3, int a4);
char __fastcall LogManagerDevice::initWithDeviceNameAndGate(LogManagerDevice *this, const char *a2, IOCommandGate *a3, int a4, int a5);
__int64 __fastcall LogManagerDevice::withDeviceNameAndLock(const char *a1, unsigned __int64 a2, int a3, int a4);
char __fastcall LogManagerDevice::initWithDeviceNameAndLock(__int64 a1, const char *a2, __int64 a3, int a4, int a5);
__int64 __fastcall LogManagerDevice::deviceRequestCallback(LogManagerDevice *this, int a2, void *a3, void *a4);
void __fastcall LogManagerDevice::dataReadyCallback(LogManagerDevice *this, void *a2, unsigned __int8 a3);
void __fastcall LogManagerDevice::free(LogManagerDevice *this);
__int64 __fastcall LogManagerDevice::getDataSourceLock(LogManagerDevice *__hidden this); // idb
void __fastcall LogManagerDevice::willRelease(LogManagerDevice *this);
__int64 __fastcall LogManagerDevice::MetaClass::~MetaClass(LogManagerDevice::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_1();
__int64 `global destructor keyed to'_a_1();
__int64 __fastcall cdev_init(const char *a1, __int64 a2, int a3, int a4, __int64 a5, __int64 a6);
__int64 __fastcall _dev_clone(dev_t dev, int action);
__int64 __fastcall cdev_free(int a1);
__int64 __fastcall _get_dev_node(int a1, int a2);
__int64 __fastcall _remove_client(__int64 a1, __int64 a2);
void __fastcall cdev_data_ready(__int64 a1, int a2);
int __fastcall _wake_write_sleepers(__int64 a1);
signed __int64 _get_free_min();
__int64 __fastcall cdev_open(int a1, int a2, __int64 a3, __int64 a4);
__int64 __fastcall cdev_close(int a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall cdev_read(int a1, __int64 a2, char a3);
__int64 __fastcall cdev_write(int a1, __int64 a2);
__int64 __fastcall cdev_ioctl(int a1, __int64 a2, __int64 a3, int a4, __int64 a5);
__int64 __fastcall cdev_select(int a1, int a2, __int64 a3, __int64 a4);
// __int64 __usercall cdev_getc@<rax>(__int64 a1@<rax>, int a2@<edi>);
// __int64 __usercall cdev_putc@<rax>(__int64 a1@<rax>, int a2@<edi>, char a3@<sil>);
__int64 __fastcall IO80211QueueCall::MetaClass::MetaClass(IO80211QueueCall::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211QueueCall::MetaClass::~MetaClass(IO80211QueueCall::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211QueueCall::IO80211QueueCall(__int64 a1);
__int64 __fastcall IO80211QueueCall::IO80211QueueCall(__int64 a1);
__int64 __fastcall IO80211QueueCall::~IO80211QueueCall(IO80211QueueCall *__hidden this); // idb
__int64 __fastcall IO80211QueueCall::~IO80211QueueCall(IO80211QueueCall *__hidden this); // idb
void __fastcall IO80211QueueCall::~IO80211QueueCall(IO80211QueueCall *this);
__int64 __fastcall IO80211QueueCall::getMetaClass(IO80211QueueCall *__hidden this); // idb
__int64 __fastcall IO80211QueueCall::MetaClass::MetaClass(IO80211QueueCall::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211QueueCall::MetaClass::alloc(IO80211QueueCall::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211QueueCall::IO80211QueueCall(__int64 a1);
__int64 __fastcall IO80211QueueCall::IO80211QueueCall(__int64 a1);
__int64 __fastcall IO80211QueueCall::io80211QueueCall(IO80211QueueCall *this, unsigned __int64 a2);
char __fastcall IO80211QueueCall::init(IO80211QueueCall *this);
int __fastcall IO80211QueueCall::handleQueue(IO80211QueueCall *this, void *a2);
int __fastcall IO80211QueueCall::free(IO80211QueueCall *this);
int __fastcall IO80211QueueCall::freeEntry(__int64 a1, __int64 a2);
int __fastcall IO80211QueueCall::addEntryToQueueAndCall(__int64 a1, __int64 a2);
// int __usercall IO80211QueueCall::handleEntry@<eax>(__int64 a1@<rax>, __int64 a2@<rsi>, int a3@<r14d>);
__int64 __fastcall IO80211QueueCall::ifnet_notice_node_presence(IO80211QueueCall *this, __ifnet *a2, sockaddr *a3, int a4, int a5, const void *a6);
__int64 __fastcall IO80211QueueCall::ifnet_notice_node_absence(IO80211QueueCall *this, __ifnet *a2, sockaddr *a3);
__int64 __fastcall IO80211QueueCall::ifnet_notice_master_elected(IO80211QueueCall *__hidden this, __ifnet *); // idb
__int64 __fastcall IO80211QueueCall::kev_post_msg(void *a1, unsigned __int64 a2);
void __fastcall IO80211QueueCall::flushQueue(IO80211QueueCall *this);
__int64 __fastcall IO80211QueueCall::MetaClass::~MetaClass(IO80211QueueCall::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_2();
__int64 `global destructor keyed to'_a_2();
__int64 __fastcall LogManager::MetaClass::MetaClass(LogManager::MetaClass *__hidden this); // idb
__int64 __fastcall LogManager::MetaClass::~MetaClass(LogManager::MetaClass *__hidden this); // idb
__int64 __fastcall LogManager::LogManager(__int64 a1);
__int64 __fastcall LogManager::LogManager(__int64 a1);
__int64 __fastcall LogManager::~LogManager(LogManager *__hidden this); // idb
__int64 __fastcall LogManager::~LogManager(LogManager *__hidden this); // idb
void __fastcall LogManager::~LogManager(LogManager *this);
__int64 __fastcall LogManager::getMetaClass(LogManager *__hidden this); // idb
__int64 __fastcall LogManager::MetaClass::MetaClass(LogManager::MetaClass *__hidden this); // idb
__int64 __fastcall LogManager::MetaClass::alloc(LogManager::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall LogManager::LogManager(__int64 a1);
__int64 __fastcall LogManager::LogManager(__int64 a1);
int __fastcall LogManager::initWithDataRadyCallback(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall LogManager::withDataReadyCallback(__int64 a1, unsigned __int64 a2, __int64 a3);
int __fastcall LogManager::terminateWriteSleepers(LogManager *this);
// int __usercall LogManager::free@<eax>(LogManager *this@<rdi>, int a2@<eax>);
// int __usercall LogManager::freeClient@<eax>(int result@<eax>, __int64 a2@<rdi>, __int64 a3@<rsi>);
void __fastcall LogManager::queueNodeRelease(__int64 a1, __int64 a2);
__int64 __fastcall LogManager::hlog(LogManager *this, unsigned __int8 *a2, unsigned __int64 a3, const char *a4, __va_list_tag *a5, __int64 a6);
__int64 __fastcall LogManager::vlog(LogManager *this, const char *, va_list); // idb
__int64 __fastcall LogManager::log(LogManager *this, const char *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
// int __usercall LogManager::notifyAllDataReady@<eax>(LogManager *this@<rdi>, int result@<eax>, unsigned __int8 a3@<sil>);
__int64 __fastcall LogManager::queueUIO(LogManager *this, uio *); // idb
char __fastcall LogManager::allocateQueueNode(LogManager *this);
__int64 __fastcall LogManager::queueData(LogManager *this, unsigned __int8 *, size_t); // idb
__int64 __fastcall LogManager::vlogBlock(LogManager *this, const char *a2, __va_list_tag *a3, void *a4, unsigned int a5);
__int64 __fastcall LogManager::blog(LogManager *__hidden this, unsigned __int8 *, unsigned __int64); // idb
__int64 __fastcall LogManager::writeData(LogManager *__hidden this, void *, uio *); // idb
__int64 __fastcall LogManager::readData(LogManager *__hidden this, void *, uio *); // idb
__int64 __fastcall LogManager::clientForID(LogManager *__hidden this, void *); // idb
__int64 __fastcall LogManager::registerClient(LogManager *__hidden this, void *); // idb
// __int64 __usercall LogManager::deregisterClient@<rax>(LogManager *this@<rdi>, void *a2@<rsi>, __int64 a3@<rax>);
bool __fastcall LogManager::dataAvailable(LogManager *this, void *a2);
__int64 __fastcall LogManager::getDataSourceLock(LogManager *__hidden this); // idb
bool __fastcall LogManager::writeRoomAvailable(LogManager *this);
__int64 __fastcall LogManager::MetaClass::~MetaClass(LogManager::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_3();
__int64 `global destructor keyed to'_a_3();
char *__fastcall convertApple80211ReturnToString(int a1);
__int64 __fastcall convertIEEEStatusToString(int a1);
__int64 __fastcall convertIEEEReasonToString(int a1);
__int64 __fastcall convertApple80211ReturnToErrno(int); // idb
__int64 __fastcall IOCharacterDevice::MetaClass::MetaClass(IOCharacterDevice::MetaClass *__hidden this); // idb
__int64 __fastcall IOCharacterDevice::MetaClass::~MetaClass(IOCharacterDevice::MetaClass *__hidden this); // idb
__int64 __fastcall IOCharacterDevice::IOCharacterDevice(__int64 a1);
__int64 __fastcall IOCharacterDevice::IOCharacterDevice(__int64 a1);
__int64 __fastcall IOCharacterDevice::~IOCharacterDevice(IOCharacterDevice *__hidden this); // idb
__int64 __fastcall IOCharacterDevice::~IOCharacterDevice(IOCharacterDevice *__hidden this); // idb
void __fastcall IOCharacterDevice::~IOCharacterDevice(IOCharacterDevice *this);
__int64 __fastcall IOCharacterDevice::getMetaClass(IOCharacterDevice *__hidden this); // idb
__int64 __fastcall IOCharacterDevice::MetaClass::MetaClass(IOCharacterDevice::MetaClass *__hidden this); // idb
__int64 __fastcall IOCharacterDevice::MetaClass::alloc(IOCharacterDevice::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOCharacterDevice::IOCharacterDevice(__int64 a1);
__int64 __fastcall IOCharacterDevice::IOCharacterDevice(__int64 a1);
__int64 __fastcall IOCharacterDevice::withGatedDataSource(__int64 a1, unsigned __int64 a2, __int64 a3, __int64 a4, const char *a5, int a6, int a7);
int __fastcall IOCharacterDevice::initWithGatedDataSource(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, const char *a6, int a7, int a8);
__int64 __fastcall IOCharacterDevice::withLockedDataSource(__int64 a1, unsigned __int64 a2, __int64 a3, __int64 a4, const char *a5, int a6, int a7);
int __fastcall IOCharacterDevice::initWithLockedDataSource(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, const char *a6, int a7, int a8);
__int64 __fastcall _deviceCallback(void *this, int a2, void *a3, void *a4);
int __fastcall IOCharacterDevice::free(IOCharacterDevice *this);
__int64 __fastcall IOCharacterDevice::deviceCallbackGated(IOCharacterDevice *__hidden this, OSObject *, void *, void *, void *, void *); // idb
int __fastcall IOCharacterDevice::dataSourceCallback(IOCharacterDevice *this, __int64 a2, void *a3, void *a4);
void __fastcall IOCharacterDevice::dataReady(IOCharacterDevice *this, void *a2, unsigned __int8 a3);
__int64 __fastcall IOCharacterDevice::deviceCallback(IOCharacterDevice *this, int a2, void *a3, void *a4);
void __fastcall IOCharacterDevice::willRelease(IOCharacterDevice *this);
__int64 __fastcall IOCharacterDevice::MetaClass::~MetaClass(IOCharacterDevice::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_4();
__int64 `global destructor keyed to'_a_4();
__int64 __fastcall hmac_sha256_vector(void *a1, size_t a2, unsigned __int64 a3, __int64 *a4, __int64 *a5, __int64 a6);
__int64 __fastcall XX_hmac_sha256(void *a1, size_t a2, __int64 a3, __int64 a4, __int64 a5);
__int64 __fastcall IO8LogInit(__int64 a1, __int64 a2);
int IO8LogDeinit();
__int64 __fastcall IO8Log(const char *a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, char a7);
__int64 __fastcall _vlog(const char *a1, struct __va_list_tag *__attribute__((__org_typedef(va_list))) a2, char a3, void *a4, unsigned int a5);
__int64 __fastcall IO8Logq(const char *a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, char a7);
__int64 __fastcall IO8LogBlock(void *a1, unsigned int a2, char *a3, __int64 a4, __int64 a5, __int64 a6, char a7);
__int64 __fastcall IO8LogqBlock(void *a1, unsigned int a2, char *a3, __int64 a4, __int64 a5, __int64 a6, char a7);
__int64 __fastcall IO8Logv(const char *a1, struct __va_list_tag *a2);
__int64 __fastcall IO8Logvq(const char *a1, struct __va_list_tag *a2);
__int64 __fastcall IO8Logh(unsigned __int8 *a1, unsigned __int64 a2, char *a3, __int64 a4, __int64 a5, __int64 a6, char a7);
int __fastcall IO8Loghv(unsigned __int8 *a1, unsigned __int64 a2, char *a3, __va_list_tag *a4);
void __fastcall IO8LogMT(const char *a1, const char **a2, const char **a3, int a4);
int __fastcall net80211_ioctl(__int64 a1, __int64 a2, IO80211Controller *a3, __int64 a4);
int __fastcall getSSID(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getAuthType(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getChannel(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getPowersave(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getProtMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getTxPower(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getRate(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getBSSID(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getScanResult(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4, char a5);
int __fastcall getCardCapabilities(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getStateReq(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getPhyMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getOpMode(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getRSSI(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getNoise(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getIntMit(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getPower(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAssociateResult(__int64 a1, IO80211Interface *a2, IO80211VirtualInterface *a3, __int64 a4);
int __fastcall getApMode(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getSupportedChannels(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getLocale(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getDeauth(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getFragThreshold(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getRateSet(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getShortSlot(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getMulticastRate(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getRetryLimit(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getAntenna(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getROM(IO80211Controller *a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getDTIMInt(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getStationList(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getVersion(IO80211Controller *a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getRand(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getRSN_IE(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getBackgroundScan(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAP_IE_List(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getStats(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getAssociationStatus(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getCountryCode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getDebugFlags(__int64 a1, IO80211Interface *a2, IO80211VirtualInterface *a3, __int64 a4);
int __fastcall getLastRxPktData(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getRadioInfo(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getGuardInterval(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getMimoPowersave(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getMCS(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getRIFS(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getLDPC(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getMSDU(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getMPDU(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getBlockAck(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getPLS(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getPSMP(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getPhySubMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getMCSIndexSet(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
signed __int64 getCacheThreshBcast();
signed __int64 getCacheThreshDirect();
__int64 __fastcall getWoWParameters(IO80211Controller *this, __int64 a2, __int64 a3, signed __int64 a4, char a5);
int __fastcall getWoWEnabled(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall get40MhzIntolerant(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
signed __int64 __fastcall getPidLocked(__int64 a1, IO80211Interface *a2, __int64 a3, __int64 a4);
__int64 __fastcall getSTA_IE_LIST(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4, char a5);
int __fastcall getRSN_Conf(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getKeyRSC(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getSTA_Stats(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getRoamThresh(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getVendorDebugFlags(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
signed __int64 __fastcall getCacheAgeThresh(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getPMKCache(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getLinkQualEventParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getIE(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4, char a5);
int __fastcall getBTCoexMode(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getWoWTest(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
signed __int64 __fastcall getVirtualIfRole(__int64 a1, __int64 a2, IO80211VirtualInterface *a3, __int64 a4);
__int64 __fastcall getVirtualIfParent(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getP2PNoAList(IO80211Controller *this, __int64 a2, IO80211VirtualInterface *a3, __int64 a4);
__int64 __fastcall getP2POppPS(__int64 a1, __int64 a2, IO80211VirtualInterface *a3, __int64 a4);
__int64 __fastcall getP2PCTWindow(__int64 a1, __int64 a2, IO80211VirtualInterface *a3, __int64 a4);
signed __int64 getBTCoexFlags();
signed __int64 getCurrentNetwork();
signed __int64 getBTPower();
signed __int64 getRSSIBounds();
int __fastcall getTXChainPower(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getCDDMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getLastBcastScanTime(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getThermalThrottling(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getFactoryMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
signed __int64 getPowerDebugInfo();
signed int __fastcall getAwdlSyncParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlSyncEnabled(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
signed int __fastcall getAwdlExtensionParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlPeerServiceParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlPeerServiceRequest(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlElectionId(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
signed int __fastcall getAwdlMaxTreeDepth(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlGuardTime(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlBssid(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlElectionMetric(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlAvailabilityWindowApAlignment(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlSyncFrameApAlignment(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlChannelSequence(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
signed int __fastcall getAwdlMaxPeers(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlOUI(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlMasterChannel(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlTopMaster(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
signed int __fastcall getAwdlSyncState(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
signed int __fastcall getAwdlElectionRssiThresholds(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
signed int __fastcall getAwdlPresenceMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
signed int __fastcall getAwdlElectionMasterCounts(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlSyncFramePacketLifetime(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlMasterSyncFramePeriod(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlNonElectionMasterSyncFramePeriod(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlBtCoexProtectedPeriodLength(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlStrategy(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlMaxNoMasterPeriods(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getLogFlags(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getPeerStats(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getHtCapabilityIE(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlElectionParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getAwdlCtl(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlSocialTimeSlots(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlPeerTrafficRegistration(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getBeaconPeriod(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getACLPolicy(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getACLList(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getChainAck(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getDesense(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getOffloadScanning(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getOffloadRSN(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getOffloadCountryCode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getOffloadKeepAliveL2(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getOffloadArpNdp(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getVHTMCSIndexSet(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getDWDS(IO80211Controller *this, __int64 a2, IO80211VirtualInterface *a3, __int64 a4);
int __fastcall getInterruptStats(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getTimerStats(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getOffloadStats(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getOffloadBeacons(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getRoaming(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getOffloadArp(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getOffloadNdp(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getOffloadScan(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getDesenseLevel(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getMcsVht(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getTxNss(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getGASResults(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlBtleStateParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlPeerDatabase(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlSecondaryMasterChannel(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlAfTxMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getErrorString(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getErrorNo(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlPrivateElectionId(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getVhtCapabilityIE(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getBGScanCacheResults(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getRoamProfile(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlOperatingMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
// __int64 __usercall getAwdlRestorDefaults@<rax>(IO80211Controller *this@<rdi>, __int64 a2@<rax>, __int64 a3@<rdx>, __int64 a4@<rcx>);
__int64 __fastcall getAwdlEncryptType(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getBTCoexProfiles(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall getBTCoexConfig(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall getAwdlStatistics(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setSSID(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setAuthType(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setCipherKey(IO80211Controller *this, IO80211Interface *a2, IO80211VirtualInterface *a3, __int64 a4);
__int64 __fastcall setChannel(IO80211Controller *this, IO80211Interface *a2, __int64 a3, __int64 a4);
int __fastcall setPowersave(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setProtMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setTxPower(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setRate(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setBSSID(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setScanRequest(IO80211Controller *this, IO80211Interface *a2, __int64 a3, __int64 a4);
int __fastcall setPhyMode(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setIntMit(__int64 a1, IO80211Interface *a2, __int64 a3, __int64 a4);
__int64 __fastcall setPower(IO80211Controller *this, IO80211Interface *a2, __int64 a3, __int64 a4);
__int64 __fastcall setAssociateRequest(IO80211Controller *this, IO80211Interface *a2, IO80211VirtualInterface *a3, __int64 a4);
__int64 __fastcall setDisassociate(__int64 a1, IO80211Interface *a2, IO80211VirtualInterface *a3);
__int64 __fastcall setIBSS_Or_HostAP_Mode(IO80211Controller *this, IO80211Interface *a2, IO80211VirtualInterface *a3, __int64 a4, unsigned int a5);
int __fastcall setApMode(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setLocale(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setDeauth(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setCounterMeasures(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setFragThreshold(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setRateSet(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setShortSlot(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setMulticastRate(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setRetryLimit(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setAntenna(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setAntennaDiversity(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setDTIMInt(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setRSN_IE(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setBackgroundScan(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setCountryCode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setDebugFlags(__int64 a1, IO80211Interface *a2, IO80211VirtualInterface *a3, __int64 a4);
int __fastcall setGuardInterval(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setMCS(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setRIFS(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setLDPC(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setMSDU(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setMPDU(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setBlockAck(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setPLS(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setPSMP(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setPhySubMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setMCSIndexSet(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
signed __int64 setCacheThreshBcast();
signed __int64 setCacheThreshDirect();
__int64 __fastcall setWoWParameters(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4, char a5);
int __fastcall setWoWEnabled(__int64 a1, IO80211Interface *a2, IO80211VirtualInterface *a3, __int64 a4);
int __fastcall set40MhzIntolerant(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setPidLock(__int64 a1, IO80211Interface *a2, __int64 a3, __int64 a4);
int __fastcall setSTA_Authorize(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setSTA_DissasociateOrDeauth(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setRSN_Conf(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setRoamThresh(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setVendorDebugFlags(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setCacheAgeThresh(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setLinkQualEventParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setIE(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4, char a5);
__int64 __fastcall setScanRequestMultiple(IO80211Controller *this, IO80211Interface *a2, __int64 a3, __int64 a4);
int __fastcall setBTCoexMode(__int64 a1, IO80211Interface *a2, __int64 a3, __int64 a4);
int __fastcall setWoWTest(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
signed __int64 __fastcall setClearPMKCache(__int64 a1, IO80211Interface *a2);
int __fastcall setScanCacheClear(__int64 a1, __int64 a2);
int __fastcall setP2PListen(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setP2PScan(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setVirtualInterfaceCreate(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setVirtualInterfaceDelete(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setP2PGroupOwnerConfigure(IO80211Controller *this, __int64 a2, IO80211VirtualInterface *a3, __int64 a4);
__int64 __fastcall setP2POppPS(__int64 a1, __int64 a2, IO80211VirtualInterface *a3, __int64 a4);
__int64 __fastcall setP2PCTWindow(__int64 a1, __int64 a2, IO80211VirtualInterface *a3, __int64 a4);
signed __int64 setBTCoexFlags();
signed __int64 setBTPower();
int __fastcall setRoam(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setTXChainPower(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setCDDMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setThermalThrottling(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setFactoryMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setReassociate(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall setAwdlSyncParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlSyncEnabled(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlExtensionParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlPeerServiceParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlPeerServiceRequest(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlElectionId(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlMaxTreeDepth(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlGuardTime(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlBssid(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlElectionMetric(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlAvailabilityWindowApAlignment(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlSyncFrameApAlignment(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlChannelSequence(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlMaxPeers(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlOUI(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlMasterChannel(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlTopMaster(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlSyncState(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlElectionRssiThresholds(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlPresenceMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlElectionMasterCounts(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlSyncFramePacketLifetime(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlMasterSyncFramePeriod(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
signed int __fastcall setAwdlNonElectionMasterSyncFramePeriod(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setPeerCacheControl(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlBtCoexProtectedPeriodLength(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlStrategy(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
signed int __fastcall setAwdlMaxNoMasterPeriods(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlSyncFrameTemplate(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setLogFlags(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setPeerStats(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setHTCapability(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlElectionParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setDebugInfo(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlScanReservedTime(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlCtl(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlSocialTimeSlots(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlPeerTrafficRegistration(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlForcedRoamConfig(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setACLPolicy(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setACLAdd(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setACLRemove(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setACLFlush(__int64 a1, __int64 a2, __int64 a3);
int __fastcall setChainAck(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setDesense(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setOffloadScanning(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setOffloadRSN(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setOffloadCountryCode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setOffloadKeepAliveL2(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setOffloadArpNdp(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setDWDS(IO80211Controller *this, __int64 a2, IO80211VirtualInterface *a3, __int64 a4);
int __fastcall setInterruptStatsReset(__int64 a1, __int64 a2, __int64 a3);
int __fastcall setTimerStatsReset(__int64 a1, __int64 a2, __int64 a3);
int __fastcall setOffloadStatsReset(__int64 a1, __int64 a2, __int64 a3);
int __fastcall setOffloadBeacons(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setRoaming(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setOffloadArp(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setOffloadNdp(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setOffloadScan(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setDesenseLevel(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setMcsVht(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setTxNss(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 setGASReq();
__int64 setGASQuery();
__int64 setGASPeer();
__int64 __fastcall setAwdlBtlePeerIndication(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlBtleEnableSynchWithParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlSecondaryMasterChannel(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 setPhyStats();
__int64 __fastcall setAwdlAfTxMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlPrivateElectionId(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setVHTCapability(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setRoamProfile(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlOperatingMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlKey(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall setAwdlEncryptType(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setBTCoexProfiles(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
int __fastcall setBTCoexConfig(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall clearAwdlStatistics(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall IO80211AWDLMulticastPeer::MetaClass::MetaClass(IO80211AWDLMulticastPeer::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211AWDLMulticastPeer::MetaClass::~MetaClass(IO80211AWDLMulticastPeer::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211AWDLMulticastPeer::IO80211AWDLMulticastPeer(__int64 a1);
__int64 __fastcall IO80211AWDLMulticastPeer::IO80211AWDLMulticastPeer(__int64 a1);
__int64 __fastcall IO80211AWDLMulticastPeer::~IO80211AWDLMulticastPeer(IO80211AWDLMulticastPeer *__hidden this); // idb
__int64 __fastcall IO80211AWDLMulticastPeer::~IO80211AWDLMulticastPeer(IO80211AWDLMulticastPeer *__hidden this); // idb
void __fastcall IO80211AWDLMulticastPeer::~IO80211AWDLMulticastPeer(IO80211AWDLMulticastPeer *this);
__int64 __fastcall IO80211AWDLMulticastPeer::getMetaClass(IO80211AWDLMulticastPeer *__hidden this); // idb
__int64 __fastcall IO80211AWDLMulticastPeer::MetaClass::MetaClass(IO80211AWDLMulticastPeer::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211AWDLMulticastPeer::MetaClass::alloc(IO80211AWDLMulticastPeer::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211AWDLMulticastPeer::IO80211AWDLMulticastPeer(__int64 a1);
__int64 __fastcall IO80211AWDLMulticastPeer::IO80211AWDLMulticastPeer(__int64 a1);
__int64 __fastcall IO80211AWDLMulticastPeer::withAddressAndManager(IO80211AWDLMulticastPeer *this, IO80211AWDLPeerManager *, IO80211AWDLPeerManager *); // idb
char __fastcall IO80211AWDLMulticastPeer::initWithAddressAndManager(IO80211AWDLMulticastPeer *this, const unsigned __int8 *a2, IO80211AWDLPeerManager *a3);
bool __fastcall IO80211AWDLMulticastPeer::canTransmit(IO80211AWDLMulticastPeer *this);
__int64 __fastcall IO80211AWDLMulticastPeer::getPacket(__int64 a1, __int64 a2);
char __fastcall IO80211AWDLMulticastPeer::prepareForTransmit(IO80211AWDLMulticastPeer *this, IO80211PacketDescriptor *a2);
char __fastcall IO80211AWDLMulticastPeer::transmitSuccess(IO80211Peer *this, __int64 a2);
__int64 __fastcall IO80211AWDLMulticastPeer::inputPacket(__int64 a1, __int64 a2);
void __fastcall IO80211Peer::print(IO80211Peer *this);
__int64 __fastcall IO80211AWDLMulticastPeer::MetaClass::~MetaClass(IO80211AWDLMulticastPeer::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_5();
__int64 `global destructor keyed to'_a_5();
__int64 __fastcall IO80211AWDLPeer::MetaClass::MetaClass(IO80211AWDLPeer::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211AWDLPeer::MetaClass::~MetaClass(IO80211AWDLPeer::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211AWDLPeer::IO80211AWDLPeer(__int64 a1);
__int64 __fastcall IO80211AWDLPeer::IO80211AWDLPeer(__int64 a1);
__int64 __fastcall IO80211AWDLPeer::~IO80211AWDLPeer(IO80211AWDLPeer *__hidden this); // idb
__int64 __fastcall IO80211AWDLPeer::~IO80211AWDLPeer(IO80211AWDLPeer *__hidden this); // idb
void __fastcall IO80211AWDLPeer::~IO80211AWDLPeer(IO80211AWDLPeer *this);
__int64 __fastcall IO80211AWDLPeer::getMetaClass(IO80211AWDLPeer *__hidden this); // idb
__int64 __fastcall IO80211AWDLPeer::MetaClass::MetaClass(IO80211AWDLPeer::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211AWDLPeer::MetaClass::alloc(IO80211AWDLPeer::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211AWDLPeer::IO80211AWDLPeer(__int64 a1);
__int64 __fastcall IO80211AWDLPeer::IO80211AWDLPeer(__int64 a1);
__int64 __fastcall IO80211AWDLPeer::withAddressAndManager(IO80211AWDLPeer *__hidden this, const unsigned __int8 *, IO80211AWDLPeerManager *); // idb
int __fastcall IO80211AWDLPeer::initWithAddressAndManager(IO80211AWDLPeer *this, const unsigned __int8 *a2, IO80211AWDLPeerManager *a3);
__int64 __fastcall IO80211AWDLPeer::doMonitoring(IO80211AWDLPeer *a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeer::getInfraDataPacketsTxAttemps(IO80211AWDLPeer *__hidden this); // idb
char __fastcall IO80211AWDLPeer::evaluateRoute(IO80211AWDLPeer *this);
void __fastcall IO80211AWDLPeer::setPresenceMode(IO80211AWDLPeer *this, __int16 a2);
__int64 IO80211AWDLPeer::compareServiceParams();
__int64 __fastcall IO80211AWDLPeer::buildAwdlInviteTLV(IO80211AWDLPeer *this, unsigned __int8 *a2, __int64 a3, unsigned __int8 a4, char a5);
__int64 __fastcall IO80211AWDLPeer::handle11zPacket(IO80211AWDLPeer *this, __int64 *a2);
__int64 __fastcall IO80211AWDLPeer::parseAwdlDataPathTLV(IO80211AWDLPeer *__hidden this, unsigned __int8 *, unsigned int, bool *, char *); // idb
char __fastcall IO80211AWDLPeer::printTlv(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeer::tlvCheckBounds(__int64 a1, __int64 a2, unsigned int a3, unsigned int a4, __int64 a5);
char __fastcall IO80211AWDLPeer::actionFrameReport(IO80211AWDLPeer *a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeer::parseAwdlChanSeqFromSyncParamsTLV(IO80211AWDLPeer *a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeer::makeBrowseList(IO80211AWDLPeer *__hidden this); // idb
__int64 __fastcall IO80211AWDLPeer::handleServiceResponseTLV(IO80211AWDLPeer *this, unsigned __int8 *a2, unsigned int a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall IO80211AWDLPeer::parseAwdlInviteTLV(IO80211AWDLPeer *__hidden this, unsigned __int8 *, unsigned int, unsigned __int8 *); // idb
__int64 __fastcall IO80211AWDLPeer::parseAwdlIEEE80211CntnrTLV(IO80211Peer *a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeer::parseAwdlChanSeqFromChanSeqTLV(IO80211AWDLPeer *a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeer::peerAwdlReachability(IO80211AWDLPeer *__hidden this); // idb
__int64 __fastcall IO80211AWDLPeer::copyServiceRequestTlv(IO80211AWDLPeer *this, unsigned __int8 *a2);
__int64 __fastcall IO80211AWDLPeer::seq2ChanNum(IO80211AWDLPeer *__hidden this, unsigned __int16, unsigned int *); // idb
__int64 __fastcall IO80211AWDLPeer::print(IO80211AWDLPeer *this);
__int64 __fastcall IO80211AWDLPeer::getPresenceMode(IO80211AWDLPeer *__hidden this); // idb
__int64 __fastcall IO80211AWDLPeer::printChannelSequence(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeer::print(IO80211AWDLPeer *this, unsigned __int64 a2);
__int64 __fastcall IO80211AWDLPeer::nextServiceRequest(IO80211AWDLPeer *this, IO80211ActionFrameDescriptor *a2);
void __fastcall IO80211AWDLPeer::freeResources(IO80211AWDLPeer *this);
bool __fastcall IO80211AWDLPeer::canTransmit(IO80211AWDLPeer *this, unsigned int a2, unsigned int a3);
__int64 __fastcall IO80211AWDLPeer::getPacket(IO80211AWDLPeer *this, __int64 a2);
void __fastcall IO80211AWDLPeer::dumpTxPacket(IO80211AWDLPeer *this, __int64 a2, __int64 a3);
unsigned __int64 __fastcall IO80211AWDLPeer::serviceRequestRemainingTime(IO80211AWDLPeer *this, int a2);
__int64 __fastcall IO80211AWDLPeer::isSynchronized(IO80211AWDLPeer *__hidden this); // idb
char __fastcall IO80211AWDLPeer::prepareForTransmit(IO80211AWDLPeer *this, IO80211PacketDescriptor *a2);
__int64 __fastcall IO80211AWDLPeer::updateAwdlChanSeq(IO80211AWDLPeer *a1, __int64 a2);
char __fastcall IO80211AWDLPeer::awdlLllcInput(__int64 a1, __mbuf *a2, __int64 a3);
__int64 __fastcall IO80211AWDLPeer::inputPacket(__int64 a1, __mbuf *a2, __int64 a3);
__int64 __fastcall IO80211AWDLPeer::MetaClass::~MetaClass(IO80211AWDLPeer::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_6();
__int64 `global destructor keyed to'_a_6();
__int64 __fastcall IO80211AWDLPeerManager::MetaClass::MetaClass(IO80211AWDLPeerManager::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211AWDLPeerManager::MetaClass::~MetaClass(IO80211AWDLPeerManager::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211AWDLPeerManager::IO80211AWDLPeerManager(__int64 a1);
__int64 __fastcall IO80211AWDLPeerManager::IO80211AWDLPeerManager(__int64 a1);
__int64 __fastcall IO80211AWDLPeerManager::~IO80211AWDLPeerManager(IO80211AWDLPeerManager *__hidden this); // idb
__int64 __fastcall IO80211AWDLPeerManager::~IO80211AWDLPeerManager(IO80211AWDLPeerManager *__hidden this); // idb
void __fastcall IO80211AWDLPeerManager::~IO80211AWDLPeerManager(IO80211AWDLPeerManager *this);
__int64 __fastcall IO80211AWDLPeerManager::getMetaClass(IO80211AWDLPeerManager *__hidden this); // idb
__int64 __fastcall IO80211AWDLPeerManager::MetaClass::MetaClass(IO80211AWDLPeerManager::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211AWDLPeerManager::MetaClass::alloc(IO80211AWDLPeerManager::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::IO80211AWDLPeerManager(__int64 a1);
__int64 __fastcall IO80211AWDLPeerManager::IO80211AWDLPeerManager(__int64 a1);
__int64 __fastcall IO80211AWDLPeerManager::withInterface(IO80211AWDLPeerManager *this, IO80211VirtualInterface *, ether_addr *, ether_addr *); // idb
char __fastcall IO80211AWDLPeerManager::initWithInterface(IO80211AWDLPeerManager *this, IO80211VirtualInterface *a2, IO80211Interface *a3, ether_addr *a4);
char __fastcall IO80211AWDLPeerManager::captureInfraPacket(IO80211AWDLPeerManager *this, __mbuf **a2);
__int64 __fastcall IO80211AWDLPeerManager::findInfraPeer(IO80211AWDLPeerManager *this, unsigned __int8 *); // idb
__int64 __fastcall IO80211AWDLPeerManager::peerDoInfraInvite(IO80211AWDLPeerManager *__hidden this, IO80211AWDLPeer *); // idb
__int64 __fastcall IO80211AWDLPeerManager::peerDoInfraPing(IO80211AWDLPeerManager *this, IO80211AWDLPeer *); // idb
__mbuf *__fastcall IO80211AWDLPeerManager::addAwdlSnapHeader(IO80211AWDLPeerManager *this, __mbuf *a2, __int16 a3);
void __fastcall IO80211AWDLPeerManager::setAwdlManualMode(IO80211AWDLPeerManager *this);
__int64 __fastcall IO80211AWDLPeerManager::handleServiceTimer(IO80211AWDLPeerManager *this); // idb
void __fastcall IO80211AWDLPeerManager::handleInfraRequestTimer(IO80211PeerManager *this);
void IO80211AWDLPeerManager::handleAwServiceTimer();
void __fastcall IO80211AWDLPeerManager::handleMasterIndicationTimer(IO80211AWDLPeerManager *a1);
__int64 __fastcall IO80211AWDLPeerManager::initParamsToDefaults(IO80211AWDLPeerManager *__hidden this); // idb
signed __int64 __fastcall _infraAddressEqual(__int64 a1, __int64 a2, const void *a3);
signed __int64 __fastcall _infraAddressEqualAndRemove(__int64 a1, __int64 a2, const void *a3);
__int64 __fastcall IO80211AWDLPeerManager::addPeer(IO80211AWDLPeerManager *this, IO80211AWDLPeer *this); // idb
void __fastcall IO80211AWDLPeerManager::awdlStatsIncrementPeer(IO80211AWDLPeerManager *this);
__int64 __fastcall IO80211AWDLPeerManager::addInfraPeer(IO80211AWDLPeerManager *this, unsigned __int8 *); // idb
void __fastcall IO80211AWDLPeerManager::failToEnable(IO80211AWDLPeerManager *this);
int __fastcall IO80211AWDLPeerManager::doEnable(IO80211AWDLPeerManager *this, char *a2);
__int64 __fastcall IO80211AWDLPeerManager::configure(IO80211AWDLPeerManager *this); // idb
__int64 __fastcall IO80211AWDLPeerManager::configureValidNANChannels(IO80211AWDLPeerManager *this); // idb
__int64 __fastcall IO80211AWDLPeerManager::setElectionMetricsToDefault(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::setAwdlElectionMetric(IO80211PeerManager *this, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::setChannelSequenceUnconditional(IO80211AWDLPeerManager *this, char a2);
__int64 __fastcall IO80211AWDLPeerManager::setPresenceMode(IO80211AWDLPeerManager *this, unsigned int); // idb
void __fastcall IO80211AWDLPeerManager::setMinExt(IO80211AWDLPeerManager *this, __int64 a2, __int64 a3);
__int64 __fastcall IO80211AWDLPeerManager::reset(IO80211AWDLPeerManager *this); // idb
__int64 __fastcall _resetPeers(__int64 a1, IO80211Peer *a2);
__int64 __fastcall IO80211AWDLPeerManager::doAwdlDisable(IO80211AWDLPeerManager *this, int a2);
__int64 __fastcall IO80211AWDLPeerManager::awdlStatsPostMetrics(IO80211AWDLPeerManager *this, __int64 a2);
void __fastcall IO80211AWDLPeerManager::doDisable(IO80211AWDLPeerManager *this, char *a2);
void __fastcall IO80211AWDLPeerManager::disableWorkLoopSources(IO80211AWDLPeerManager *this);
void __fastcall IO80211AWDLPeerManager::enableWorkLoopSources(IO80211AWDLPeerManager *this);
void __fastcall IO80211AWDLPeerManager::setScanningState(IO80211PeerManager *this, __int64 a2, unsigned __int8 a3, __int64 a4);
void __fastcall IO80211AWDLPeerManager::setScheduleState(IO80211AWDLPeerManager *this, unsigned int a2, char a3);
char __fastcall IO80211AWDLPeerManager::usePiggybackScan(IO80211PeerManager *this, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::setMinimumAvailable(IO80211AWDLPeerManager *__hidden this); // idb
void IO80211AWDLPeerManager::setJoiningState();
void __fastcall IO80211AWDLPeerManager::setInfraTxState(IO80211AWDLPeerManager *this);
__int64 __fastcall IO80211AWDLPeerManager::setAlwaysAvailable(IO80211AWDLPeerManager *this, char a2);
char __fastcall IO80211AWDLPeerManager::realTimeDataModeRequired(IO80211AWDLPeerManager *this);
bool __fastcall IO80211AWDLPeerManager::useSingleBandDataMode(IO80211AWDLPeerManager *this);
__int64 __fastcall _countCachedSingleBandPeers(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IO80211AWDLPeerManager::calculateDataChannelsForAirplayDirectDFS(IO80211AWDLPeerManager *this, IO80211AWDLPeer *); // idb
__int64 __fastcall IO80211AWDLPeerManager::forceRoamToPeersAP(IO80211AWDLPeerManager *this, ether_addr *a2);
// char __usercall IO80211AWDLPeerManager::isDFSChannel@<al>(IO80211AWDLPeerManager *this@<rdi>, __int64 a2@<rax>, unsigned __int8 a3@<sil>);
// __int64 __usercall IO80211AWDLPeerManager::calculateDataChannelsForAirplayDirect@<rax>(IO80211AWDLPeerManager *this@<rdi>, IO80211AWDLPeer *a2@<rsi>, __int64 a3@<rax>);
char __fastcall IO80211AWDLPeerManager::calculateDataChannelsForAlwaysAvailable(IO80211AWDLPeerManager *this);
bool __fastcall IO80211AWDLPeerManager::addInfraToMinimumChannelSequence(IO80211AWDLPeerManager *this);
__int64 __fastcall _countAirPlayServices(__int64 a1, IO80211ServiceRequestDescriptor *a2, __int64 a3);
__int64 __fastcall IO80211AWDLPeerManager::cachedPeerHasChangedChannelSequence(IO80211AWDLPeerManager *this, IO80211AWDLPeer *); // idb
signed __int64 __fastcall IO80211AWDLPeerManager::awdlStatsAccumulateScheduleStateDuration(__int64 a1, unsigned int a2, __int64 a3);
signed __int64 __fastcall IO80211AWDLPeerManager::awdlStatsIncrementScheduleStateCount(__int64 a1, unsigned int a2);
__int64 __fastcall IO80211AWDLPeerManager::disablePrivateElectionID(IO80211AWDLPeerManager *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall IO80211AWDLPeerManager::enablePrivateElectionID(IO80211AWDLPeerManager *this); // idb
unsigned int __fastcall IO80211AWDLPeerManager::setAFTXMode(IO80211AWDLPeerManager *this, int a2);
__int64 __fastcall IO80211AWDLPeerManager::setSyncFramePeriod(IO80211AWDLPeerManager *this, int a2);
__int64 __fastcall IO80211AWDLPeerManager::setChannelSequence(IO80211AWDLPeerManager *__hidden this); // idb
__int64 __fastcall _adoptHighestPeerPrivEID(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::updateAWDLPrivateElectionID(IO80211AWDLPeerManager *this); // idb
__int64 __fastcall IO80211AWDLPeerManager::runPiggybackScanStateMachine(IO80211AWDLPeerManager *this); // idb
char __fastcall IO80211AWDLPeerManager::setPresenceModeForScan(IO80211AWDLPeerManager *this);
__int64 __fastcall IO80211AWDLPeerManager::sequenceToChannel(IO80211AWDLPeerManager *__hidden this); // idb
__int64 __fastcall IO80211AWDLPeerManager::updateServiceTimer(IO80211AWDLPeerManager *this); // idb
signed __int64 __fastcall _nextDeadLine(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IO80211AWDLPeerManager::sendOobFrame(IO80211AWDLPeerManager *this, IO80211ActionFrameDescriptor *); // idb
void IO80211AWDLPeerManager::handleChannelSwitchAnnouncement();
void __fastcall IO80211AWDLPeerManager::cachedPeerHasChangedInfra(IO80211AWDLPeerManager *this, IO80211Peer *a2);
char __fastcall IO80211AWDLPeerManager::doMonitorTimer(IO80211AWDLPeerManager *this);
__int64 __fastcall _countNonAirPlayServices(__int64 a1, IO80211ServiceRequestDescriptor *a2, __int64 a3);
__int64 __fastcall IO80211AWDLPeerManager::nonATVCachedCount(IO80211AWDLPeerManager *__hidden this); // idb
__int64 __fastcall IO80211AWDLPeerManager::enterQuietMode(IO80211AWDLPeerManager *this, char a2);
__int64 __fastcall IO80211AWDLPeerManager::enableRoaming(IO80211AWDLPeerManager *this); // idb
__int64 __fastcall IO80211AWDLPeerManager::awdlStatsIncrementCachedPeers(IO80211AWDLPeerManager *__hidden this, unsigned int); // idb
__int64 __fastcall IO80211AWDLPeerManager::awdlStatsCollectCachedPeersBandInfo(IO80211AWDLPeerManager *__hidden this); // idb
__int64 __fastcall IO80211AWDLPeerManager::awdlStatsUnicastPktCount(IO80211AWDLPeerManager *__hidden this); // idb
void __fastcall IO80211AWDLPeerManager::awdlStatsSetSelfInfraChannel(IO80211AWDLPeerManager *this, char a2);
void __fastcall IO80211AWDLPeerManager::awdlStatsSetFlags(IO80211AWDLPeerManager *this, int a2);
void __fastcall IO80211AWDLPeerManager::awdlStatsClearFlags(IO80211AWDLPeerManager *this, int a2);
__int64 __fastcall IO80211AWDLPeerManager::doNeighborMonitoring(IO80211AWDLPeerManager *this, IO80211AWDLPeer *); // idb
__int64 __fastcall IO80211AWDLPeerManager::buildMasterIndicationTemplate(IO80211AWDLPeerManager *this, unsigned __int8 *a2, unsigned int a3, char a4);
__int64 __fastcall IO80211AWDLPeerManager::queueOOBFrame(IO80211AWDLPeerManager *this, __mbuf *a2, __int64 a3, IO80211AWDLPeer *a4);
void __fastcall IO80211AWDLPeerManager::doPrimaryPeerMonitoring(IO80211AWDLPeerManager *this, IO80211AWDLPeer *a2);
__int64 __fastcall _sendOobFrame(__int64 a1, __int64 a2);
void __fastcall IO80211AWDLPeerManager::updateAndSendMI(IO80211AWDLPeerManager *this, char a2);
signed __int64 __fastcall _nextServiceRequest(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall _compareDeadLine(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::doOOBInvite(IO80211AWDLPeerManager *__hidden this, ether_addr *); // idb
void __fastcall IO80211AWDLPeerManager::inputPacket(IO80211PeerManager *this, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::outputStart(IO80211AWDLPeerManager *__hidden this); // idb
int __fastcall IO80211AWDLPeerManager::outputPacket(IO80211AWDLPeerManager *this, __mbuf *a2);
__int64 __fastcall IO80211AWDLPeerManager::exitQuietMode(IO80211AWDLPeerManager *this); // idb
__mbuf *__fastcall IO80211AWDLPeerManager::addRedirectSnapHeader(IO80211AWDLPeerManager *this, __mbuf *a2, IO80211AWDLPeer *a3);
char __fastcall IO80211AWDLPeerManager::didQueuePacket(IO80211AWDLPeerManager *this, unsigned __int8 *a2);
bool __fastcall IO80211AWDLPeerManager::isBrowsingFor(IO80211AWDLPeerManager *this, unsigned __int8 *a2, __int16 a3);
__int64 __fastcall _is_browsing_for(__int64 a1, IO80211ServiceRequestDescriptor *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
// __int64 __usercall IO80211AWDLPeerManager::dequeueTxPacket@<rax>(IO80211PeerManager *this@<rdi>, __int64 a2@<rsi>, unsigned __int64 a3@<r15>);
__int64 __fastcall IO80211AWDLPeerManager::updateSyncFrameTemplate(IO80211AWDLPeerManager *this); // idb
__int64 __fastcall IO80211AWDLPeerManager::buildServiceParamTlv(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::buildServiceResponseTlvs(IO80211PeerManager *this, __int64 a2, __int64 a3, unsigned int a4);
char __fastcall IO80211AWDLPeerManager::setInfraChannelSpec(IO80211PeerManager *this, int a2, const void *a3);
char __fastcall IO80211AWDLPeerManager::getInfrastructureState(IO80211AWDLPeerManager *this);
char __fastcall IO80211AWDLPeerManager::interfaceStateChange(IO80211AWDLPeerManager *this, unsigned int a2);
__int64 __fastcall IO80211AWDLPeerManager::selectChannelsToUseForAWDL(IO80211AWDLPeerManager *__hidden this); // idb
__int64 __fastcall IO80211AWDLPeerManager::setAwdlElectionId(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::adjustAwdlSnapHeader(IO80211AWDLPeerManager *this, IO80211PacketDescriptor *, IO80211Peer *); // idb
__int64 __fastcall IO80211AWDLPeerManager::buildEnhDataRateTlv(IO80211AWDLPeerManager *this, unsigned __int8 *a2);
__int64 __fastcall IO80211AWDLPeerManager::buildDataPathStateTlv(IO80211AWDLPeerManager *this, unsigned __int8 *a2, char a3);
__int64 __fastcall IO80211AWDLPeerManager::build11zServiceRequests(IO80211AWDLPeerManager *__hidden this); // idb
__int64 __fastcall IO80211AWDLPeerManager::masterReport(IO80211PeerManager *this, void *a2, int a3);
__int64 __fastcall IO80211AWDLPeerManager::seq2Channel(IO80211AWDLPeerManager *__hidden this, unsigned int); // idb
char __fastcall IO80211AWDLPeerManager::reportDataPathEvents(IO80211AWDLPeerManager *this, __int64 a2, void *a3, __int64 a4, __int64 a5, __int64 a6);
signed __int64 __fastcall _cleanOobFrame(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IO80211AWDLPeerManager::logAF(IO80211PeerManager *this, __int64 a2, unsigned __int8 *a3, unsigned __int64 a4, char a5);
char __fastcall IO80211AWDLPeerManager::actionFrameHasCorrectOUI(IO80211PeerManager *this, __int64 a2, unsigned __int64 a3);
void __fastcall IO80211AWDLPeerManager::updateAFStats(__int64 a1, __int64 a2, char a3);
// bool __usercall IO80211AWDLPeerManager::validCCForPeerLearning@<al>(IO80211AWDLPeerManager *this@<rdi>, unsigned __int8 *a2@<rsi>, __int64 a3@<rax>);
bool __fastcall IO80211AWDLPeerManager::actionFrameInput(IO80211AWDLPeerManager *this, __mbuf *a2, __int64 a3, void *a4, __int64 a5);
signed __int64 __fastcall _actionFrameReport(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall _serviceResponseSendToUserLand(IO80211PeerManager *this, __int64 a2, __int64 a3, __int64 *a4);
__int64 __fastcall IO80211AWDLPeerManager::setAwdlSyncParams(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::setAwdlSyncEnabled(IO80211AWDLPeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::setAwdlPeerTrafficRegistration(IO80211AWDLPeerManager *this, void *); // idb
__int64 __fastcall _setPrimary(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall _getPrimary(__int64 a1, __int64 a2);
void __fastcall IO80211AWDLPeerManager::awdlStatsSetPeerInfraChannel(IO80211AWDLPeerManager *this, char a2);
__int64 __fastcall IO80211AWDLPeerManager::getAwdlPeerTrafficRegistration(IO80211PeerManager *this, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::setAwdlExtensionParams(IO80211PeerManager *this, void *); // idb
__int64 __fastcall _countNonATVCachedPeers(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IO80211AWDLPeerManager::isValidChannel(IO80211PeerManager *this, __int64 a2, int a3, int a4, __int64 a5);
int __fastcall IO80211AWDLPeerManager::setAwdlCtl(IO80211AWDLPeerManager *this, __int64 a2);
__int64 __fastcall _discardAirPlayService(__int64 a1, IO80211ServiceRequestDescriptor *a2, __int64 a3, __int64 a4);
__int64 __fastcall IO80211AWDLPeerManager::setAwdlSocialTimeSlots(IO80211PeerManager *this, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::getAwdlSocialTimeSlots(IO80211PeerManager *this, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::getAwdlBtleStateParams(IO80211PeerManager *this, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::getAwdlTxCalPeriod(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::setAwdlTxCalPeriod(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::getAwdlAfTxMode(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::setAwdlAfTxMode(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::setAwdlBtlePeerIndication(IO80211PeerManager *this, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::setAwdlBtleEnableSynchWithParams(IO80211AWDLPeerManager *this, __int64 a2);
int __fastcall IO80211AWDLPeerManager::handleDebugCmd_infra_rst(IO80211PeerManager *this, __int64 a2);
signed __int64 __fastcall _resetInfra(__int64 a1, __int64 a2, const void *a3);
int __fastcall IO80211AWDLPeerManager::handleDebugCmd_iping(IO80211AWDLPeerManager *this, __int64 a2, __int64 a3);
__int64 __fastcall IO80211AWDLPeerManager::handleDebugCmd_presence(IO80211PeerManager *this, __int64 a2, __int64 a3);
__int64 __fastcall IO80211AWDLPeerManager::handleDebugCmd_absence(IO80211PeerManager *this, __int64 a2, __int64 a3);
int __fastcall IO80211AWDLPeerManager::handleDebugCmd_iredirect(IO80211PeerManager *this, __int64 a2, __int64 a3);
int __fastcall IO80211AWDLPeerManager::handleDebugCmd_aredirect(IO80211AWDLPeerManager *this, __int64 a2, __int64 a3);
int __fastcall IO80211AWDLPeerManager::handleDebugCmd_poll(IO80211PeerManager *this, __int64 a2);
signed __int64 __fastcall _setNeighborMonitoring(__int64 a1, __int64 a2, const void **a3);
__int64 __fastcall IO80211AWDLPeerManager::handleDebugCmd_primary(IO80211PeerManager *this, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::handleDebugCmd_force(IO80211AWDLPeerManager *this, __int64 a2, __int64 a3);
__int64 __fastcall IO80211AWDLPeerManager::handleDebugCmd_chanlist(IO80211PeerManager *this, __int64 a2, __int64 a3);
int __fastcall IO80211AWDLPeerManager::handleDebugCmd_print_awdl_peers(IO80211PeerManager *this, __int64 a2, __int64 a3);
int __fastcall IO80211AWDLPeerManager::handleDebugCmd(IO80211AWDLPeerManager *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall IO80211AWDLPeerManager::printServiceRequests(__int64 a1, __int64 a2);
// __int64 __usercall IO80211AWDLPeerManager::printOobRequests@<rax>(char a1@<al>, __int64 a2@<rdi>, __int64 a3@<rsi>);
int __fastcall IO80211AWDLPeerManager::getAwdlCtl(IO80211PeerManager *this, __int64 a2);
signed __int64 __fastcall IO80211AWDLPeerManager::printAwdlPeers(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::setAwdlPeerServiceParams(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::setAwdlStrategy(IO80211PeerManager *this, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::buildSyncParamsTlv(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::buildELectionParamsTlv(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::buildEncapsulatedIP(IO80211AWDLPeerManager *__hidden this, unsigned __int8 *, __mbuf *, unsigned int); // idb
__int64 __fastcall IO80211AWDLPeerManager::buildIEEE80211CntnrTlv(IO80211AWDLPeerManager *this, unsigned __int8 *a2, unsigned __int8 *a3, unsigned int a4);
bool __fastcall IO80211AWDLPeerManager::multicastAllowedOnInfra(IO80211AWDLPeerManager *this);
// bool __usercall IO80211AWDLPeerManager::inMulticastTimeslot@<al>(IO80211AWDLPeerManager *this@<rdi>, __int64 a2@<rax>);
int __fastcall IO80211AWDLPeerManager::queueInfraPacket(IO80211AWDLPeerManager *this, __mbuf *a2);
__int64 __fastcall IO80211AWDLPeerManager::buildInfraIdPacket(IO80211AWDLPeerManager *this, IO80211AWDLPeer *a2, unsigned __int8 a3, char a4, __mbuf *a5);
__int64 __fastcall IO80211AWDLPeerManager::handle11zPacket(IO80211AWDLPeerManager *this, __mbuf *); // idb
signed __int64 __fastcall _handle11z(__int64 a1, __int64 a2, __int64 *a3);
__int64 __fastcall IO80211AWDLPeerManager::buildAndQueueOOBServiceResponse(IO80211AWDLPeerManager *this, IO80211AWDLPeer *); // idb
__int64 __fastcall IO80211AWDLPeerManager::buildAndQueueOOBInquiry(IO80211AWDLPeerManager *this, IO80211AWDLPeer *); // idb
__int64 __fastcall IO80211AWDLPeerManager::buildAndQueueOOBData(IO80211AWDLPeerManager *this, __mbuf *, IO80211AWDLPeer *); // idb
__int64 __fastcall IO80211AWDLPeerManager::buildServiceRequest(IO80211AWDLPeerManager *this, unsigned int a2, __int64 a3);
__int64 __fastcall IO80211AWDLPeerManager::comparePeerForPrivateElection(IO80211AWDLPeerManager *__hidden this, IO80211AWDLPeer *); // idb
__int64 __fastcall IO80211AWDLPeerManager::copyServiceRequestsForPeer(IO80211AWDLPeerManager *this, IO80211AWDLPeer *a2, unsigned __int8 *a3);
__int64 __fastcall _countAdvertisement(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IO80211AWDLPeerManager::updateSSTH(IO80211AWDLPeerManager *this); // idb
__int64 __fastcall _countBrowse(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IO80211AWDLPeerManager::updateLocalRequests(IO80211AWDLPeerManager *this, __int64 a2);
signed __int64 __fastcall _serviceFindAndRemove(__int64 a1, IO80211ServiceRequestDescriptor *a2, IO80211ServiceRequestDescriptor *a3);
__int64 __fastcall _remakeBrowseList(__int64 a1, IO80211AWDLPeer *a2);
__int64 __fastcall IO80211AWDLPeerManager::setAwdlPeerServiceRequest(IO80211AWDLPeerManager *this, __int64 a2);
signed __int64 IO80211AWDLPeerManager::getAwdlPeerServiceRequest();
__int64 __fastcall IO80211AWDLPeerManager::setAwdlMaxPeers(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::setAwdlMaxTreeDepth(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::setAwdlPrivateElectionId(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::setAwdlForcedRoamConfig(IO80211AWDLPeerManager *a1, ether_addr *a2);
__int64 __fastcall IO80211AWDLPeerManager::setAwdlGuardTime(__int64 a1, __int64 a2);
// __int64 __usercall IO80211AWDLPeerManager::setAwdlBssid@<rax>(IO80211PeerManager *this@<rdi>, void *a2@<rsi>, __int64 a3@<rax>);
__int64 __fastcall IO80211AWDLPeerManager::setAwdlScanReservedTime(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::setAwdlElectionParams(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::setAwdlAvailabilityWindowApAlignment(IO80211PeerManager *this, void *); // idb
signed __int64 IO80211AWDLPeerManager::setAwdlSyncFrameApAlignment();
__int64 __fastcall IO80211AWDLPeerManager::printAwdlChannelSequence(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall IO80211AWDLPeerManager::printAwdlTimingStats(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::setAwdlChannelSequence(IO80211PeerManager *this, void *); // idb
__int64 IO80211AWDLPeerManager::setAwdlOOBRequest();
__int64 IO80211AWDLPeerManager::setAwdlSyncFrameTemplate();
__int64 __fastcall IO80211AWDLPeerManager::setAwdlOUI(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::setAwdlSecondaryMasterChannel(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::setAwdlMasterChannel(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::setAwdlKey(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::setAwdlEncryptType(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::getAwdlEncryptType(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::getAwdlStatistics(__int64 a1, void *a2);
__int64 __fastcall IO80211AWDLPeerManager::clearAwdlStatistics(__int64 a1);
signed __int64 IO80211AWDLPeerManager::setAwdlTopMaster();
__int64 __fastcall IO80211AWDLPeerManager::setAwdlElectionRssiThresholds(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::setAwdlSyncState(IO80211AWDLPeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::setAwdlPresenceMode(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::setAwdlElectionMasterCounts(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::setAwdlSyncFramePacketLifetime(IO80211PeerManager *this, void *); // idb
__int64 IO80211AWDLPeerManager::setAwdlMasterSyncFramePeriod();
signed int __fastcall IO80211AWDLPeerManager::setAwdlNonElectionMasterSyncFramePeriod(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::setAwdlBtCoexProtectedPeriodLength(IO80211PeerManager *this, void *); // idb
signed int __fastcall IO80211AWDLPeerManager::setAwdlMaxNoMasterPeriods(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::setAwdlSuspendedMode(IO80211AWDLPeerManager *this); // idb
int __fastcall IO80211AWDLPeerManager::setAwdlAutoMode(IO80211AWDLPeerManager *this);
__int64 __fastcall IO80211AWDLPeerManager::getAwdlOperatingMode(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::setAwdlOperatingMode(IO80211AWDLPeerManager *this, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::getAwdlRestoreDefaults(IO80211AWDLPeerManager *this, unsigned int *); // idb
signed int __fastcall IO80211AWDLPeerManager::getAwdlExtensionParams(IO80211PeerManager *this, void *a2);
signed int __fastcall IO80211AWDLPeerManager::getAwdlSyncParams(IO80211PeerManager *this, void *a2);
__int64 __fastcall IO80211AWDLPeerManager::getAwdlSyncEnabled(IO80211PeerManager *this, void *); // idb
__int64 IO80211AWDLPeerManager::getAwdlPeerServiceParams();
__int64 __fastcall IO80211AWDLPeerManager::getAwdlElectionId(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::getAwdlPrivateElectionId(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::getAwdlElectionMetric(IO80211PeerManager *this, void *); // idb
signed int __fastcall IO80211AWDLPeerManager::getAwdlMaxTreeDepth(IO80211PeerManager *a1, void *a2);
signed int __fastcall IO80211AWDLPeerManager::getAwdlMaxPeers(IO80211PeerManager *a1, void *a2);
__int64 __fastcall IO80211AWDLPeerManager::getAwdlGuardTime(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::getAwdlBssid(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::getAwdlElectionParams(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::getAwdlAvailabilityWindowApAlignment(__int64 a1, __int64 a2);
signed __int64 IO80211AWDLPeerManager::getAwdlSyncFrameApAlignment();
__int64 __fastcall IO80211AWDLPeerManager::getAwdlChannelSequence(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::getAwdlOUI(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::getAwdlMasterChannel(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::getAwdlSecondaryMasterChannel(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::getAwdlTopMaster(__int64 a1, __int64 a2);
signed int __fastcall IO80211AWDLPeerManager::getAwdlElectionRssiThresholds(IO80211PeerManager *a1, void *a2);
signed int __fastcall IO80211AWDLPeerManager::getAwdlSyncState(IO80211PeerManager *a1, void *a2);
signed int __fastcall IO80211AWDLPeerManager::getAwdlPresenceMode(IO80211PeerManager *a1, void *a2);
signed int __fastcall IO80211AWDLPeerManager::getAwdlElectionMasterCounts(IO80211PeerManager *a1, void *a2);
__int64 __fastcall IO80211AWDLPeerManager::getAwdlSyncFramePacketLifetime(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::getAwdlMasterSyncFramePeriod(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::getAwdlNonElectionMasterSyncFramePeriod(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::getAwdlMaxNoMasterPeriods(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::getAwdlBtCoexProtectedPeriodLength(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211AWDLPeerManager::getAwdlStrategy(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::getAwdlPeerDatabase(__int64 a1, __int64 a2);
__int64 __fastcall _generatePeerDatabase(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IO80211AWDLPeerManager::printState(__int64 a1, __int64 a2);
__int64 __fastcall IO80211AWDLPeerManager::printDataPath(IO80211PeerManager *this, __int64 a2);
void *__fastcall IO80211AWDLPeerManager::awdlStatsClearMetrics(IO80211AWDLPeerManager *this);
__int64 __fastcall IO80211AWDLPeerManager::awdlStatsPrintMetric(IO80211AWDLPeerManager *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
void __fastcall IO80211AWDLPeerManager::awdlStatsDecrementPeer(IO80211AWDLPeerManager *this);
// char __usercall IO80211AWDLPeerManager::awdlStatsCountPeersBand@<al>(IO80211AWDLPeerManager *this@<rdi>, __int64 a2@<rax>, unsigned __int8 a3@<sil>);
void __fastcall IO80211QueueDescriptor::freeResources(IO80211QueueDescriptor *this);
__int64 __fastcall IO80211AWDLPeerManager::MetaClass::~MetaClass(IO80211AWDLPeerManager::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_7();
__int64 `global destructor keyed to'_a_7();
__int64 __fastcall IO80211Peer::MetaClass::MetaClass(IO80211Peer::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211Peer::MetaClass::~MetaClass(IO80211Peer::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211Peer::IO80211Peer(__int64 a1);
__int64 __fastcall IO80211Peer::IO80211Peer(__int64 a1);
__int64 __fastcall IO80211Peer::~IO80211Peer(IO80211Peer *__hidden this); // idb
__int64 __fastcall IO80211Peer::~IO80211Peer(IO80211Peer *__hidden this); // idb
void __fastcall IO80211Peer::~IO80211Peer(IO80211Peer *this);
__int64 __fastcall IO80211Peer::getMetaClass(IO80211Peer *__hidden this); // idb
__int64 __fastcall IO80211Peer::MetaClass::MetaClass(IO80211Peer::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211Peer::MetaClass::alloc(IO80211Peer::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211Peer::IO80211Peer(__int64 a1);
__int64 __fastcall IO80211Peer::IO80211Peer(__int64 a1);
__int64 __fastcall IO80211Peer::withAddressAndManager(IO80211Peer *__hidden this, const unsigned __int8 *, IO80211PeerManager *); // idb
void __fastcall IO80211Peer::addPhyStatistics(IO80211Peer *this);
char __fastcall IO80211Peer::initWithAddressAndManager(IO80211Peer *this, const unsigned __int8 *a2, IO80211PeerManager *a3);
__int64 __fastcall IO80211Peer::logDebug(IO80211Peer *this, __int64 a2, const char *a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall IO80211Peer::doCreditGrant(IO80211Peer *this, __int64 a2);
__int64 __fastcall IO80211Peer::updateRequestBitField(IO80211Peer *__hidden this); // idb
char __fastcall IO80211Peer::cacheControlPending(IO80211Peer *this, void *a2);
__int64 __fastcall IO80211Peer::parseHTCapTLV(IO80211Peer *this, unsigned __int8 *a2, unsigned int a3);
__int64 __fastcall IO80211Peer::parseVhtCapTLV(IO80211Peer *this, void *); // idb
__int64 __fastcall IO80211Peer::doCacheControl(IO80211Peer *this, __int64 a2);
__int64 __fastcall IO80211Peer::findPacketDescriptor(IO80211Peer *__hidden this, __mbuf *); // idb
char IO80211Peer::transmitSuccess();
char __fastcall IO80211Peer::prepareForTransmit(IO80211Peer *this, IO80211PacketDescriptor *a2);
__int64 __fastcall IO80211Peer::reset(IO80211Peer *__hidden this); // idb
__int64 __fastcall IO80211Peer::reclaimPackets(IO80211Peer *__hidden this); // idb
int __fastcall IO80211Peer::freeResources(IO80211Peer *this);
int __fastcall IO80211Peer::flushQueues(IO80211Peer *this, int a2);
__int64 __fastcall _reclaimPackets(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IO80211Peer::logDebug(IO80211Peer *this, const char *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall _addToFlushList(__int64 a1, __int64 a2);
__int64 __fastcall _flushQueues(IO80211Peer *this, void *a2, __int64 a3);
__int64 __fastcall IO80211Peer::doTransmitStatus(IO80211Peer *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall IO80211Peer::numPacket(__int64 a1, unsigned int a2);
char __fastcall IO80211Peer::inputPacket(__int64 a1, __int64 a2);
void __fastcall IO80211Peer::reportRssi(__int64 a1, char a2, __int64 a3, char a4);
__int64 __fastcall IO80211Peer::getRssi(IO80211Peer *__hidden this); // idb
__int64 __fastcall IO80211Peer::getRssi_5(IO80211Peer *__hidden this); // idb
__int64 __fastcall IO80211Peer::getRssi_2_4(IO80211Peer *__hidden this); // idb
__int64 __fastcall IO80211Peer::reportTransmitStatus(IO80211Peer *this, __int64 a2);
int __fastcall _doTransmitStatus(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall IO80211Peer::doMonitoring(__int64 a1);
__int64 __fastcall IO80211Peer::getPacketStats(IO80211Peer *__hidden this); // idb
__int64 __fastcall IO80211Peer::getPacketStatsRealTimeTx(IO80211Peer *__hidden this); // idb
__int64 __fastcall IO80211Peer::getPacketStatsRealTimeRx(IO80211Peer *__hidden this); // idb
__int16 __fastcall IO80211Peer::updateNumHostPackets(IO80211Peer *this, unsigned int a2, __int16 a3, __int64 a4, __int64 a5, __int64 a6);
bool __fastcall IO80211Peer::canTransmit(IO80211Peer *this, unsigned __int8 a2, char a3);
__int64 __fastcall IO80211Peer::printMac(IO80211Peer *__hidden this); // idb
__int64 __fastcall IO80211Peer::packetStats(__int64 a1, __int64 a2);
__int64 __fastcall _peerPacketStats(__int64 a1, __int64 a2, __int64 a3);
char __fastcall IO80211Peer::hasQueuedPackets(IO80211Peer *this);
__int64 __fastcall IO80211Peer::getStats(__int64 a1, __int64 a2);
__int64 __fastcall IO80211Peer::queuePacket(IO80211Peer *this, IO80211PacketDescriptor *); // idb
__int64 __fastcall IO80211Peer::dumpTxPacket(__int64 a1, char *a2, __int64 a3);
__int64 __fastcall IO80211Peer::getPacket(IO80211Peer *this, __int64 a2);
__int64 __fastcall _transmitReady(void *a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall IO80211Peer::setState(IO80211Peer *this, int a2);
signed __int64 __fastcall IO80211Peer::printHTandVHTFlags(__int64 a1, __int64 a2);
// __int64 __usercall IO80211Peer::print@<rax>(IO80211Peer *this@<rdi>, __int64 a2@<rsi>, __int64 a3@<r8>, __int64 a4@<r9>, __int64 a5@<r13>);
void __fastcall IO80211Peer::print(IO80211Peer *this);
__int64 __fastcall IO80211Peer::MetaClass::~MetaClass(IO80211Peer::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_8();
__int64 `global destructor keyed to'_a_8();
__int64 __fastcall IO80211PeerManager::MetaClass::MetaClass(IO80211PeerManager::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211PeerManager::MetaClass::~MetaClass(IO80211PeerManager::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211PeerManager::IO80211PeerManager(__int64 a1);
__int64 __fastcall IO80211PeerManager::IO80211PeerManager(__int64 a1);
__int64 __fastcall IO80211PeerManager::~IO80211PeerManager(IO80211PeerManager *__hidden this); // idb
__int64 __fastcall IO80211PeerManager::~IO80211PeerManager(IO80211PeerManager *__hidden this); // idb
void __fastcall IO80211PeerManager::~IO80211PeerManager(IO80211PeerManager *this);
__int64 __fastcall IO80211PeerManager::getMetaClass(IO80211PeerManager *__hidden this); // idb
__int64 __fastcall IO80211PeerManager::MetaClass::MetaClass(IO80211PeerManager::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211PeerManager::MetaClass::alloc(IO80211PeerManager::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211PeerManager::IO80211PeerManager(__int64 a1);
__int64 __fastcall IO80211PeerManager::IO80211PeerManager(__int64 a1);
__int64 __fastcall IO80211PeerManager::withInterface(IO80211PeerManager *this, IO80211VirtualInterface *, IO80211Interface *); // idb
char __fastcall IO80211PeerManager::initWithInterface(IO80211PeerManager *this, IO80211VirtualInterface *a2, IO80211Interface *a3);
__int64 __fastcall IO80211PeerManager::doDisable(IO80211PeerManager *this, char *); // idb
__int64 __fastcall IO80211PeerManager::logDebug(IO80211PeerManager *this, const char *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
void __fastcall IO80211PeerManager::printPERReport(IO80211PeerManager *this);
int __fastcall IO80211PeerManager::removeAllPeers(IO80211PeerManager *this);
__int64 __fastcall IO80211PeerManager::flushFreeMbufs(IO80211PeerManager *__hidden this); // idb
char __fastcall IO80211PeerManager::doEnable(IO80211PeerManager *this, char *a2);
__int64 __fastcall IO80211PeerManager::getController(IO80211PeerManager *__hidden this); // idb
__int64 __fastcall IO80211PeerManager::failToEnable(IO80211PeerManager *this); // idb
__int64 __fastcall IO80211PeerManager::enableGated(IO80211PeerManager *__hidden this, void *, void *, void *, void *, void *); // idb
__int64 __fastcall IO80211PeerManager::disableGated(IO80211PeerManager *__hidden this, void *, void *, void *, void *, void *); // idb
__int64 __fastcall IO80211PeerManager::enable(IO80211PeerManager *this, const char *); // idb
char __fastcall IO80211PeerManager::shouldLog(IO80211PeerManager *this, __int64 a2);
__int64 __fastcall IO80211PeerManager::logDebug(IO80211PeerManager *this, __int64 a2, const char *a3, __int64 a4, __int64 a5, __int64 a6);
char *__fastcall IO80211PeerManager::getBSDName(IO80211PeerManager *this);
__int64 __fastcall IO80211PeerManager::disable(IO80211PeerManager *this, const char *); // idb
__int64 __fastcall IO80211PeerManager::reset(IO80211PeerManager *this); // idb
IO80211CommandQueue *__fastcall IO80211PeerManager::allocateQueue(IO80211PeerManager *this, IOCommandGate *a2, signed int a3);
__int64 __fastcall IO80211PeerManager::packetSpace(__int64 a1, unsigned int a2);
bool __fastcall IO80211PeerManager::fcTryLock(IO80211PeerManager *this);
int __fastcall IO80211PeerManager::fcLock(IO80211PeerManager *this);
int __fastcall IO80211PeerManager::fcUnlock(IO80211PeerManager *this);
int __fastcall IO80211PeerManager::handleTimer(__int64 a1);
int __fastcall IO80211PeerManager::handleMonitorTimer(__int64 a1);
void __fastcall IO80211PeerManager::handleUnflowControlTimer(IO80211PeerManager *this);
void __fastcall IO80211PeerManager::free(IO80211PeerManager *this);
__int64 __fastcall _compareByMac(IO80211QueueDescriptor *, IO80211QueueDescriptor *); // idb
signed __int64 __fastcall _macAddressEqual(__int64 a1, __int64 a2, const void *a3);
signed __int64 __fastcall IO80211PeerManager::macAddressEqual(IO80211PeerManager *this, IO80211Peer *a2, unsigned __int8 *a3);
signed __int64 __fastcall _macAddressEqualAndLru(__int64 a1, __int64 a2, const void *a3);
signed __int64 __fastcall _macAddressEqualAndRemove(__int64 a1, __int64 a2, const void *a3);
__int64 __fastcall _countCachedPeers(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IO80211PeerManager::findPeer(IO80211PeerManager *this, unsigned __int8 *a2, char a3);
__int64 __fastcall IO80211PeerManager::performCacheOperation(IO80211PeerManager *this, __int64 (__fastcall *a2)(__int64 a1, __int64 a2, __int64 a3));
int __fastcall IO80211PeerManager::lockDataPath(IO80211PeerManager *this);
int __fastcall IO80211PeerManager::unlockDataPath(IO80211PeerManager *this, __int64 a2);
int __fastcall IO80211PeerManager::ioctl_internal(IO80211PeerManager *a1, __int64 a2);
__int64 __fastcall IO80211PeerManager::addPeer(IO80211PeerManager *this, IO80211Peer *this); // idb
__int64 __fastcall IO80211PeerManager::setPeerCacheControl(IO80211PeerManager *this, __int64 a2);
__int64 __fastcall IO80211PeerManager::uncache(IO80211PeerManager *this, ether_addr *); // idb
__int64 __fastcall IO80211PeerManager::removePeer(IO80211PeerManager *this, IO80211Peer *); // idb
__int64 __fastcall _addToFlush(__int64 a1, __int64 a2);
signed __int64 _removePeers();
// int __usercall IO80211PeerManager::removeFlushedPeers@<eax>(IO80211PeerManager *this@<rdi>, __int64 a2@<rax>);
int __fastcall IO80211PeerManager::removePeer(IO80211PeerManager *this, unsigned __int8 *a2);
char *__fastcall stringFromScanSource(unsigned int a1);
__int64 __fastcall IO80211PeerManager::setScanningState(IO80211PeerManager *this, unsigned int a2, char a3, __int64 a4);
void IO80211PeerManager::setJoiningState();
int __fastcall IO80211PeerManager::setInfraChannel(__int64 a1, __int64 a2);
int __fastcall IO80211PeerManager::getIfNet(IO80211PeerManager *this);
__int64 __fastcall IO80211PeerManager::dumpPacket(__int64 a1, signed __int64 a2, __int64 a3);
__int64 __fastcall IO80211PeerManager::dumpPacket(__int64 a1, signed __int64 a2, char *a3, __int64 a4);
void __fastcall IO80211PeerManager::unflowControlStack(IO80211PeerManager *this);
int __fastcall IO80211PeerManager::printFlowControl(IO80211PeerManager *this, int *a2, const char *a3);
// void __usercall IO80211PeerManager::sendUnflowControlStack(IO80211PeerManager *this@<rdi>, __int64 a2@<rax>, unsigned int a3@<esi>);
__int64 __fastcall IO80211PeerManager::doFreePacket(IO80211PeerManager *this, IO80211PacketDescriptor *a2);
int __fastcall IO80211PeerManager::vlogDebug(IO80211PeerManager *this, __int64 a2, const char *a3, __va_list_tag *a4);
__int64 __fastcall IO80211PeerManager::getPeerManagerLogFlags(IO80211PeerManager *__hidden this); // idb
bool __fastcall IO80211PeerManager::shouldVerboseLog(IO80211PeerManager *this, __int64 a2);
void __fastcall IO80211PeerManager::initUserPrintContext(IO80211PeerManager *a1, __int64 a2, char *a3, int a4);
void __fastcall IO80211PeerManager::initUserPrintContext(IO80211PeerManager *this, __int64 a2, void *a3, char *a4, int a5);
void __fastcall IO80211PeerManager::logUserPrint(IO80211PeerManager *this, IO80211QueueDescriptor *a2, int a3, char *a4);
void __fastcall IO80211PeerManager::logUserPrint(IO80211PeerManager *this, __int64 a2, IO80211QueueDescriptor *a3, int a4, char *a5);
int __fastcall IO80211PeerManager::vlogDebugBPF(IO80211PeerManager *this, __int64 a2, const char *a3, __va_list_tag *a4);
int __fastcall IO80211PeerManager::reportTransmitStatus(IO80211PeerManager *this, __int64 a2, int a3, __int64 a4);
__int64 __fastcall _reportTransmitStatus(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall _reclaimFlushedPacket(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IO80211PeerManager::checkForCacheablePeers(IO80211PeerManager *this); // idb
signed __int64 __fastcall _findUncachedPeer(__int64 a1, IO80211Peer *a2, void *a3);
int __fastcall IO80211PeerManager::disableWorkLoopSources(IO80211PeerManager *this);
__int64 __fastcall IO80211PeerManager::enableWorkLoopSources(IO80211PeerManager *this); // idb
char __fastcall IO80211PeerManager::reportDataPathEvents(IO80211PeerManager *this, __int64 a2, void *a3, __int64 a4, __int64 a5, __int64 a6);
int __fastcall IO80211PeerManager::setDataPathState(IO80211PeerManager *this, char a2);
signed __int64 __fastcall _doPeerCredit(__int64 a1, __int64 a2, const void **a3);
int __fastcall IO80211PeerManager::requestTxPacket(IO80211PeerManager *this, const char *a2);
signed __int64 __fastcall _setPeerState(__int64 a1, __int64 a2, const void **a3);
signed __int64 __fastcall _doCacheControl(__int64 a1, __int64 a2, __int64 *a3);
__int64 __fastcall IO80211PeerManager::captureInfraPacket(IO80211PeerManager *__hidden this, __mbuf **); // idb
__int64 __fastcall IO80211PeerManager::dequeueStackOutputPackets(IO80211PeerManager *this, signed int a2, __int64 a3);
__int64 __fastcall IO80211PeerManager::getMulticastPackets(__int64 a1, __int64 a2);
__int64 __fastcall IO80211PeerManager::getUnicastPackets(IO80211PeerManager *this, __int64 a2, int a3);
__int64 __fastcall _getPacket(IO80211PeerManager *this, __int64 a2, __int64 a3);
__int64 __fastcall _updateNumHostPackets(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IO80211PeerManager::dequeueTxPacket(IO80211PeerManager *this, signed __int64 a2);
// __int64 __usercall IO80211PeerManager::stackHasPackets@<rax>(IO80211PeerManager *this@<rdi>, __int64 a2@<rax>);
__int64 __fastcall IO80211PeerManager::outputStart(IO80211PeerManager *this); // idb
__int64 __fastcall IO80211PeerManager::allocateDescriptor(IO80211PeerManager *__hidden this, __mbuf *); // idb
__int64 __fastcall IO80211PeerManager::queuePacket(IO80211PeerManager *this, __mbuf *); // idb
__int64 __fastcall IO80211PeerManager::queuePacket(IO80211PeerManager *this, IO80211PacketDescriptor *); // idb
signed __int64 __fastcall _queuePacket(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IO80211PeerManager::getHashTableIndex(IO80211PeerManager *__hidden this, ether_addr *); // idb
char __fastcall IO80211PeerManager::doMonitorTimer(IO80211PeerManager *this);
signed __int64 __fastcall _doMonitoring(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IO80211PeerManager::outputPacket(IO80211PeerManager *this, __mbuf *); // idb
signed int __fastcall IO80211PeerManager::ioctl_internal_gated(__int64 a1, __int64 a2);
signed int __fastcall IO80211PeerManager::do_ioctl(IO80211PeerManager *this, unsigned int a2, unsigned int a3, void *a4);
void IO80211PeerManager::handlePERReportTimer();
char __fastcall IO80211PeerManager::inputPacket(IO80211PeerManager *this, signed __int64 a2, __int64 a3);
signed __int64 __fastcall _doInputPacket(__int64 a1, __int64 a2, __int64 *a3);
signed __int64 __fastcall _clearFlushedPacket(__int64 a1, __int64 a2, __int64 a3);
char __fastcall IO80211PeerManager::actionFrameInput(IO80211PeerManager *this, __mbuf *a2, __int64 a3, void *a4);
__int64 __fastcall IO80211PeerManager::getBufferPoolSize(__int64 a1, unsigned int a2);
__int64 __fastcall IO80211PeerManager::getBufferPoolSize(IO80211PeerManager *__hidden this); // idb
int __fastcall IO80211PeerManager::requiresExplicitMBufRelease(IO80211PeerManager *this);
signed __int64 __fastcall IO80211PeerManager::getPeerStats(__int64 a1, __int64 a2);
signed __int64 __fastcall _getPeerStats(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IO80211PeerManager::setHtCapabilityIE(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211PeerManager::getHtCapabilityIE(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211PeerManager::getVHtCapabilityIE(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211PeerManager::setVHtCapabilityIE(IO80211PeerManager *this, void *); // idb
__int64 __fastcall IO80211PeerManager::postPeerPresence(IO80211PeerManager *__hidden this, ether_addr *, int, int, int, char *); // idb
__int64 __fastcall IO80211PeerManager::getAwdlCtl(IO80211PeerManager *this, __int64 a2);
__int64 __fastcall IO80211PeerManager::setAwdlCtl(IO80211PeerManager *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
char __fastcall IO80211PeerManager::isInfraRedirectSupported(IO80211PeerManager *this);
int __fastcall IO80211PeerManager::printPeers(IO80211PeerManager *this, __int64 a2, int a3);
__int64 __fastcall IO80211PeerManager::printDataPath(IO80211PeerManager *this, __int64 a2);
void __fastcall IO80211PeerManager::setPeerManagerLogFlags(IO80211PeerManager *this);
void __fastcall IO80211PeerManager::setPeerManagerVerboseLogFlags(IO80211PeerManager *this, __int64 a2);
__int64 __fastcall IO80211PeerManager::setLogFlags(IO80211PeerManager *this, __int64 a2);
__int64 __fastcall IO80211PeerManager::getLogFlags(IO80211PeerManager *this, __int64 a2);
__int64 __fastcall IO80211PeerManager::printPackets(__int64 a1, __int64 a2);
__int64 __fastcall _packetStats(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall IO80211PeerManager::getExtendedStats(__int64 a1, __int64 a2);
__int64 __fastcall IO80211PeerManager::printHashTable(IO80211PeerManager *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall _printMac(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
// __int64 __usercall IO80211PeerManager::printState@<rax>(__int64 a1@<rax>, __int64 a2@<rdi>, __int64 a3@<rsi>);
__int64 __fastcall IO80211PeerManager::handleDebugCmd(IO80211PeerManager *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
void __fastcall IO80211QueueDescriptor::freeResources(IO80211QueueDescriptor *this);
void IO80211PeerManager::handleChannelSwitchAnnouncement();
char IO80211PeerManager::interfaceStateChange();
void __fastcall IO80211PeerManager::setInfraTxState(IO80211PeerManager *this);
__int64 __fastcall IO80211PeerManager::handle11zPacket(IO80211PeerManager *__hidden this, __mbuf *); // idb
void __fastcall IO80211PeerManager::cachedPeerHasChangedInfra(IO80211PeerManager *this, IO80211Peer *a2);
__int64 __fastcall IO80211PeerManager::MetaClass::~MetaClass(IO80211PeerManager::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_9();
__int64 `global destructor keyed to'_a_9();
__int64 __fastcall IO80211P2PInterface::MetaClass::MetaClass(IO80211P2PInterface::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::MetaClass::~MetaClass(IO80211P2PInterface::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::IO80211P2PInterface(__int64 a1);
__int64 __fastcall IO80211P2PInterface::IO80211P2PInterface(__int64 a1);
__int64 __fastcall IO80211P2PInterface::~IO80211P2PInterface(IO80211P2PInterface *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::~IO80211P2PInterface(IO80211P2PInterface *__hidden this); // idb
void __fastcall IO80211P2PInterface::~IO80211P2PInterface(IO80211P2PInterface *this);
__int64 __fastcall IO80211P2PInterface::getMetaClass(IO80211P2PInterface *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::MetaClass::MetaClass(IO80211P2PInterface::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::MetaClass::alloc(IO80211P2PInterface::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211P2PInterface::IO80211P2PInterface(__int64 a1);
__int64 __fastcall IO80211P2PInterface::IO80211P2PInterface(__int64 a1);
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface0(IO80211P2PInterface *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface1(IO80211P2PInterface *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface2(IO80211P2PInterface *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface3(IO80211P2PInterface *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface4(IO80211P2PInterface *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface5(IO80211P2PInterface *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface6(IO80211P2PInterface *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface7(IO80211P2PInterface *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface8(IO80211P2PInterface *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface9(IO80211P2PInterface *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface10(IO80211P2PInterface *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface11(IO80211P2PInterface *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface12(IO80211P2PInterface *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface13(IO80211P2PInterface *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface14(IO80211P2PInterface *__hidden this); // idb
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface15(IO80211P2PInterface *__hidden this); // idb
char __fastcall IO80211P2PInterface::init(IO80211P2PInterface *this, IO80211Controller *a2, ether_addr *a3, unsigned int a4, const char *a5);
size_t __fastcall IO80211P2PInterface::setUnitNumber(IO80211P2PInterface *this, const char *a2);
__int64 __fastcall IO80211P2PInterface::MetaClass::~MetaClass(IO80211P2PInterface::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_10();
__int64 `global destructor keyed to'_a_10();
__int64 __fastcall IO80211InitPeerFoundEventData(__int64 a1, int a2, const void *a3, __int64 a4, unsigned int a5);
__int64 __fastcall _findWPSSubIE(unsigned __int16 a1, __int64 a2, int a3);
__int64 __fastcall _findP2PSubIE(unsigned __int8 a1, __int64 a2, unsigned __int64 a3);
__int64 __fastcall _rijndaelKeySetupEnc(__int64 a1, __int64 a2);
signed __int64 __fastcall _rijndaelKeySetupDec(__int64 a1, __int64 a2);
__int64 __fastcall _rijndaelEncrypt(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall _rijndaelDecrypt(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall aes_wrap(__int64 a1, int a2, const void *a3, void *a4);
signed __int64 __fastcall aes_unwrap(__int64 a1, int a2, const void *a3, void *a4);
__int64 __fastcall omac1_aes_128(__int64 a1, signed __int64 a2, unsigned __int64 a3, __int64 a4);
char __fastcall gf_mulx(__int64 a1);
__int64 __fastcall aes_128_encrypt_block(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall aes_128_ctr_encrypt(__int64 a1, const void *a2, __int64 a3, unsigned __int64 a4);
signed __int64 __fastcall aes_128_eax_encrypt(__int64 a1, const void *a2, unsigned __int64 a3, const void *a4, size_t a5, const void *a6, unsigned __int64 a7, __int64 a8);
signed __int64 __fastcall aes_128_eax_decrypt(__int64 a1, const void *a2, size_t a3, const void *a4, size_t a5, const void *a6, size_t a7, __int64 a8);
__int64 __fastcall aes_128_cbc_encrypt(__int64 a1, const void *a2, void *a3, unsigned __int64 a4);
__int64 __fastcall aes_128_cbc_decrypt(__int64 a1, const void *a2, __int64 a3, unsigned __int64 a4);
__int64 __fastcall IO80211ActionFrameDescriptor::MetaClass::MetaClass(IO80211ActionFrameDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211ActionFrameDescriptor::MetaClass::~MetaClass(IO80211ActionFrameDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211ActionFrameDescriptor::IO80211ActionFrameDescriptor(__int64 a1);
__int64 __fastcall IO80211ActionFrameDescriptor::IO80211ActionFrameDescriptor(__int64 a1);
__int64 __fastcall IO80211ActionFrameDescriptor::~IO80211ActionFrameDescriptor(IO80211ActionFrameDescriptor *__hidden this); // idb
__int64 __fastcall IO80211ActionFrameDescriptor::~IO80211ActionFrameDescriptor(IO80211ActionFrameDescriptor *__hidden this); // idb
void __fastcall IO80211ActionFrameDescriptor::~IO80211ActionFrameDescriptor(IO80211ActionFrameDescriptor *this);
__int64 __fastcall IO80211ActionFrameDescriptor::getMetaClass(IO80211ActionFrameDescriptor *__hidden this); // idb
__int64 __fastcall IO80211ActionFrameDescriptor::MetaClass::MetaClass(IO80211ActionFrameDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211ActionFrameDescriptor::MetaClass::alloc(IO80211ActionFrameDescriptor::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211ActionFrameDescriptor::IO80211ActionFrameDescriptor(__int64 a1);
__int64 __fastcall IO80211ActionFrameDescriptor::IO80211ActionFrameDescriptor(__int64 a1);
char __fastcall IO80211ActionFrameDescriptor::initWithAddr(IO80211ActionFrameDescriptor *this, ether_addr *a2);
int __fastcall IO80211ActionFrameDescriptor::freeResources(IO80211ActionFrameDescriptor *this, unsigned __int8 a2);
__int64 __fastcall IO80211ActionFrameDescriptor::print(__int64 a1, __int64 a2);
void __fastcall IO80211QueueDescriptor::freeResources(IO80211QueueDescriptor *this);
__int64 __fastcall IO80211ActionFrameDescriptor::MetaClass::~MetaClass(IO80211ActionFrameDescriptor::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_11();
__int64 `global destructor keyed to'_a_11();
__int64 __fastcall IO80211CommandQueue::MetaClass::MetaClass(IO80211CommandQueue::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211CommandQueue::MetaClass::~MetaClass(IO80211CommandQueue::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211CommandQueue::IO80211CommandQueue(__int64 a1);
__int64 __fastcall IO80211CommandQueue::IO80211CommandQueue(__int64 a1);
__int64 __fastcall IO80211CommandQueue::~IO80211CommandQueue(IO80211CommandQueue *__hidden this); // idb
__int64 __fastcall IO80211CommandQueue::~IO80211CommandQueue(IO80211CommandQueue *__hidden this); // idb
void __fastcall IO80211CommandQueue::~IO80211CommandQueue(IO80211CommandQueue *this);
__int64 __fastcall IO80211CommandQueue::getMetaClass(IO80211CommandQueue *__hidden this); // idb
__int64 __fastcall IO80211CommandQueue::MetaClass::MetaClass(IO80211CommandQueue::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211CommandQueue::MetaClass::alloc(IO80211CommandQueue::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211CommandQueue::IO80211CommandQueue(__int64 a1);
__int64 __fastcall IO80211CommandQueue::IO80211CommandQueue(__int64 a1);
IO80211CommandQueue *__fastcall IO80211CommandQueue::withGateAndCapacity(IO80211CommandQueue *this, IOCommandGate *a2, signed int a3);
char __fastcall IO80211CommandQueue::initWithGateAndCapacity(IO80211CommandQueue *this, IOCommandGate *a2, int a3, signed int a4);
int __fastcall IO80211CommandQueue::releaseResources(IO80211CommandQueue *this);
__int64 __fastcall IO80211CommandQueue::lockFlush(IO80211CommandQueue *this); // idb
int __fastcall IO80211CommandQueue::dump(IO80211CommandQueue *this);
char __fastcall IO80211CommandQueue::enqueue(IO80211CommandQueue *this, IO80211QueueDescriptor *a2);
int __fastcall IO80211CommandQueue::lock(IO80211CommandQueue *this, const char *a2, int a3);
int __fastcall IO80211CommandQueue::unlock(IO80211CommandQueue *this, const char *a2);
__int64 __fastcall IO80211CommandQueue::dequeue(IO80211CommandQueue *this, unsigned int a2);
__int64 __fastcall IO80211CommandQueue::dequeueBlocking(IO80211CommandQueue *this, char a2);
__int64 __fastcall IO80211CommandQueue::flush(IO80211CommandQueue *this); // idb
char __fastcall IO80211CommandQueue::lockEnqueue(IO80211CommandQueue *this, IO80211QueueDescriptor *a2);
__int64 __fastcall IO80211CommandQueue::lockDequeue(IO80211CommandQueue *this, unsigned int a2);
__int64 __fastcall IO80211CommandQueue::lockDequeueBlocking(IO80211CommandQueue *this);
__int64 __fastcall IO80211CommandQueue::lockMap(IO80211CommandQueue *this, int (__fastcall *a2)(_QWORD, _QWORD, _QWORD, _QWORD), __int64 a3, __int64 a4, __int64 a5, int a6);
__int64 __fastcall IO80211CommandQueue::map(__int64 a1, int (__fastcall *a2)(_QWORD, _QWORD, _QWORD, _QWORD), __int64 a3, __int64 a4, __int64 a5, int a6);
signed __int64 __fastcall _insert(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall IO80211CommandQueue::getLast(IO80211CommandQueue *this, __int64 a2);
__int64 __fastcall IO80211CommandQueue::lockInsert(IO80211CommandQueue *this, __int64 a2, __int64 a3, __int64 a4, unsigned int a5, __int64 a6);
__int64 __fastcall IO80211CommandQueue::insert(IO80211CommandQueue *this, __int64 a2, __int64 a3, __int64 a4, unsigned int a5, __int64 a6);
__int64 __fastcall IO80211CommandQueue::getNext(IO80211CommandQueue *__hidden this, IO80211QueueDescriptor *); // idb
__int64 __fastcall IO80211CommandQueue::getFirst(IO80211CommandQueue *this, __int64 a2);
__int64 __fastcall IO80211CommandQueue::countEntries(IO80211CommandQueue *this, unsigned int a2);
__int64 __fastcall IO80211CommandQueue::lockCountEntries(IO80211CommandQueue *this, unsigned int a2);
__int64 __fastcall IO80211CommandQueue::print(__int64 a1, __int64 a2);
signed __int64 __fastcall _doUserPrint(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall IO80211CommandQueue::MetaClass::~MetaClass(IO80211CommandQueue::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_12();
__int64 `global destructor keyed to'_a_12();
__int64 __fastcall IO80211Controller::MetaClass::MetaClass(IO80211Controller::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211Controller::MetaClass::~MetaClass(IO80211Controller::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211Controller::IO80211Controller(IOEthernetController *a1, const OSMetaClass *a2);
__int64 __fastcall IO80211Controller::~IO80211Controller(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::~IO80211Controller(IO80211Controller *__hidden this); // idb
void __fastcall IO80211Controller::~IO80211Controller(IO80211Controller *this);
__int64 __fastcall IO80211Controller::getMetaClass(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::MetaClass::MetaClass(IO80211Controller::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211Controller::MetaClass::alloc(IO80211Controller::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller0(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller1(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller2(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller3(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller4(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller5(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller6(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller7(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller8(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller9(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller10(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller11(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller12(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller13(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller14(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller15(IO80211Controller *__hidden this); // idb
char __fastcall IO80211Controller::start(IO80211Controller *this, IOService *a2);
// __int64 __usercall IO80211Controller::powerChangeHandler@<rax>(IO80211Controller *this@<rdi>, void *a2@<rsi>, void *a3@<rdx>, IOService *a4@<r8>, void *a5@<r9>, __int64 a6@<rax>);
int __fastcall IO80211Controller::init(IO80211Controller *this, OSDictionary *a2);
int __fastcall IO80211Controller::free(IO80211Controller *this);
int __fastcall IO80211Controller::stop(IO80211Controller *this, IOService *a2);
__int64 __fastcall IO80211Controller::enable(IO80211Controller *__hidden this, IONetworkInterface *); // idb
signed __int64 __fastcall IO80211Controller::radioCountForInterface(IO80211Controller *this, IO80211Interface *a2);
__int64 __fastcall IO80211Controller::disable(IO80211Controller *__hidden this, IONetworkInterface *); // idb
// char __usercall IO80211Controller::configureInterface@<al>(IO80211Controller *this@<rdi>, IONetworkInterface *a2@<rsi>, char a3@<al>);
int __fastcall IO80211Controller::setInfraChannel(__int64 a1, __int64 a2);
__int64 __fastcall IO80211Controller::getHtCapabilityLength(IO80211Controller *__hidden this); // idb
char *__fastcall IO80211Controller::getHtCapability(IO80211Controller *this);
int __fastcall IO80211Controller::setHtCapability(__int64 a1, const void *a2);
int __fastcall IO80211Controller::setCurrentChannel(__int64 a1, __int64 a2);
int __fastcall IO80211Controller::printChannels(IO80211Controller *this);
int __fastcall IO80211Controller::scanStarted(__int64 a1, __int64 a2, int a3);
int __fastcall IO80211Controller::scanDone(__int64 a1, __int64 a2, int a3);
int __fastcall IO80211Controller::handleChannelSwitchAnnouncement(__int64 a1);
int __fastcall IO80211Controller::joinStarted(__int64 a1, __int64 a2);
int __fastcall IO80211Controller::joinDone(__int64 a1, __int64 a2);
int __fastcall IO80211Controller::infraBSSIDChange(IO80211Controller *this);
char __fastcall IO80211Controller::checkForInfraPacketRedirect(IO80211Controller *this, __mbuf **a2);
int __fastcall IO80211Controller::inputInfraPacket(IO80211Controller *this, __mbuf *a2);
__int64 __fastcall IO80211Controller::getOutputQueue(IO80211Controller *__hidden this); // idb
char __fastcall IO80211Controller::getBSSIDData(__int64 a1, void *a2);
bool __fastcall IO80211Controller::getBeaconPeriod(__int64 a1, void *a2);
char __fastcall IO80211Controller::getInfraExtendedStats(__int64 a1, __int64 a2);
char __fastcall IO80211Controller::getInfraChannel(__int64 a1, void *a2);
int __fastcall IO80211Controller::setCountryCode(__int64 a1, __int64 a2);
bool __fastcall IO80211Controller::getCountryCode(__int64 a1, void *a2);
int __fastcall IO80211Controller::outputStart(IO80211Controller *this, IONetworkInterface *a2);
int __fastcall IO80211Controller::inputPacket(IO80211Controller *this, __mbuf *a2);
bool __fastcall IO80211Controller::createWorkLoop(IO80211Controller *this, unsigned __int64 a2);
__int64 __fastcall IO80211Controller::getWorkLoop(IO80211Controller *__hidden this); // idb
int __fastcall IO80211Controller::getNetworkInterface(IO80211Controller *this);
signed __int64 IO80211Controller::getHardwareAddress();
__int64 __fastcall IO80211Controller::createInterface(IO80211Controller *__hidden this); // idb
signed int __fastcall IO80211Controller::apple80211_ioctl(IO80211Controller *this, IO80211Interface *a2, IO80211VirtualInterface *a3, __ifnet *a4, __int64 a5, void *a6);
__int64 __fastcall IO80211Controller::inputMonitorPacket(IO80211Controller *this, __mbuf *a2, unsigned int a3, void *a4, __int64 a5);
int __fastcall IO80211Controller::apple80211_ioctl_get(IO80211Controller *this, IO80211Interface *a2, IO80211VirtualInterface *a3, __ifnet *a4, void *a5);
int __fastcall IO80211Controller::apple80211_ioctl_set(IO80211Controller *this, IO80211Interface *a2, IO80211VirtualInterface *a3, __ifnet *a4, void *a5);
int __fastcall IO80211Controller::stringFromReturn(IO80211Controller *this, int a2);
int __fastcall IO80211Controller::errnoFromReturn(IO80211Controller *this, int a2);
__int64 __fastcall IO80211Controller::getASSOCIATE_RESULT(__int64 a1, IO80211Interface *a2, IO80211VirtualInterface *a3, __int64 a4);
__int64 __fastcall IO80211Controller::getProvider(IO80211Controller *__hidden this); // idb
char __fastcall IO80211Controller::attachInterface(IO80211Controller *this, IONetworkInterface **a2, unsigned __int8 a3);
char __fastcall IO80211Controller::attachVirtualInterface(IO80211Controller *this, IO80211VirtualInterface **a2, ether_addr *a3, unsigned int a4, char a5);
int __fastcall IO80211Controller::detachVirtualInterface(IO80211Controller *this, IO80211VirtualInterface *a2, unsigned __int8 a3);
__int64 __fastcall IO80211Controller::createVirtualInterface(IO80211Controller *__hidden this, ether_addr *, unsigned int); // idb
int __fastcall IO80211Controller::dataLinkLayerAttachComplete(IO80211Controller *this, IO80211Interface *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
char __fastcall IO80211Controller::useAppleRSNSupplicant(IO80211Controller *this, IO80211Interface *a2);
char __fastcall IO80211Controller::useAppleRSNSupplicant(IO80211Controller *this, IO80211VirtualInterface *a2);
int __fastcall IO80211Controller::getHardwareAddressForInterface(__int64 a1, __int64 a2, __int64 a3);
int __fastcall IO80211Controller::requestPacketTx(IO80211Controller *this, void *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall IO80211Controller::awdlSendInfraPacket(IO80211Controller *__hidden this, __mbuf *); // idb
__int64 __fastcall IO80211Controller::handle11zPacket(IO80211Controller *__hidden this, __mbuf *); // idb
__int64 __fastcall IO80211Controller::bpfOutputPacket(IO80211Controller *this, OSObject *a2, __int64 a3, __mbuf *a4);
__int64 __fastcall IO80211Controller::copyIn(IO80211Controller *this, __int64 a2, void *a3, __int64 a4);
__int64 __fastcall IO80211Controller::copyOut(IO80211Controller *this, const void *a2, __int64 a3, __int64 a4);
int __fastcall IO80211Controller::powerChangeGated(IO80211Controller *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
signed __int64 __fastcall IO80211Controller::setVirtualHardwareAddress(IO80211Controller *this, IO80211VirtualInterface *a2, ether_addr *a3);
__int64 __fastcall IO80211Controller::enableVirtualInterface(IO80211Controller *this, IO80211VirtualInterface *a2);
__int64 __fastcall IO80211Controller::disableVirtualInterface(IO80211Controller *this, IO80211VirtualInterface *a2);
signed __int64 __fastcall IO80211Controller::apple80211VirtualRequest(IO80211Controller *this, __int64 a2, __int64 a3, IO80211VirtualInterface *a4, void *a5);
signed __int64 __fastcall IO80211Controller::monitorModeSetEnabled(IO80211Controller *this, IO80211Interface *a2);
int __fastcall IO80211Controller::apple80211_ioctl(IO80211Controller *this, IO80211Interface *a2, __ifnet *a3, __int64 a4, void *a5);
__int64 __fastcall IO80211Controller::stopDMA(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::hardwareOutputQueueDepth(IO80211Controller *this, IO80211Interface *a2);
signed __int64 IO80211Controller::performCountryCodeOperation();
signed __int64 IO80211Controller::enableFeature();
__int64 __fastcall IO80211Controller::requiresExplicitMBufRelease(IO80211Controller *__hidden this); // idb
__int64 __fastcall IO80211Controller::MetaClass::~MetaClass(IO80211Controller::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_13();
__int64 `global destructor keyed to'_a_13();
char *__fastcall ssidBufToString(unsigned __int8 *a1, unsigned __int64 a2, char *a3);
__int64 __fastcall timespecSub(__int64 a1, __int64 a2, __int64 a3);
__int64 getAbsoluteTime(void); // idb
int __fastcall io80211_get_calendar_time(__int64 a1);
bool __fastcall procIsSuperuser(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall calculateChannelBandwidth(int a1);
__int64 __fastcall channelToFrequency(int a1, unsigned int a2);
__int64 __fastcall IO80211Interface::MetaClass::MetaClass(IO80211Interface::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211Interface::MetaClass::~MetaClass(IO80211Interface::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211Interface::IO80211Interface(IOEthernetInterface *a1, const OSMetaClass *a2);
__int64 __fastcall IO80211Interface::IO80211Interface(IOEthernetInterface *a1, const OSMetaClass *a2);
__int64 __fastcall IO80211Interface::~IO80211Interface(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::~IO80211Interface(IO80211Interface *__hidden this); // idb
void __fastcall IO80211Interface::~IO80211Interface(IO80211Interface *this);
__int64 __fastcall IO80211Interface::getMetaClass(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::MetaClass::MetaClass(IO80211Interface::MetaClass *__hidden this); // idb
IOEthernetInterface *__fastcall IO80211Interface::MetaClass::alloc(IO80211Interface::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211Interface::IO80211Interface(IOEthernetInterface *a1);
__int64 __fastcall IO80211Interface::IO80211Interface(IOEthernetInterface *a1);
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface0(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface1(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface2(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface3(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface4(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface5(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface6(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface7(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface8(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface9(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface10(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface11(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface12(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface13(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface14(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface15(IO80211Interface *__hidden this); // idb
char __fastcall IO80211Interface::init(IO80211Interface *this, IONetworkController *a2);
// int __usercall IO80211Interface::free@<eax>(IO80211Interface *this@<rdi>, __int64 a2@<rax>);
// int __usercall IO80211Interface::terminateSupplicant@<eax>(IO80211Interface *this@<rdi>, __int64 a2@<rax>);
void __fastcall IO80211Interface::setCountermeasuresTimer(__int64 a1, __int64 a2);
// int __usercall IO80211Interface::freePMKSACache@<eax>(IO80211Interface *this@<rdi>, int result@<eax>);
signed int __fastcall IO80211Interface::performCommand(IO80211Interface *this, IONetworkController *a2, __int64 a3, void *a4, void *a5);
__int64 __fastcall IO80211Interface::performGatedCommand(IO80211Interface *this, void *a2, void *a3, void *a4, void *a5, void *a6);
__int64 __fastcall IO80211Interface::getController(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::finishAttachToDataLinkLayer(IO80211Interface *this); // idb
__int64 __fastcall IO80211Interface::updateStaticProperties(IO80211Interface *this); // idb
int __fastcall IO80211Interface::powerChangeHandler(IO80211Interface *this, void *a2, void *a3, __int64 a4, IOService *a5, void *a6);
__int64 __fastcall IO80211Interface::bpfAttach(IO80211Interface *this, int a2, unsigned int a3);
__int64 __fastcall IO80211Interface::finishAttachToDataLinkLayerGated(IO80211Interface *__hidden this, OSObject *, void *, void *, void *, void *); // idb
int __fastcall IO80211Interface::attachToDataLinkLayer(IO80211Interface *this, unsigned int a2, void *a3);
__int64 __fastcall IO80211Interface::outputPreEnqueueHandler(IO80211Interface *this, void *, void *, __mbuf *); // idb
int __fastcall IO80211Interface::detachFromDataLinkLayer(IO80211Interface *this, unsigned int a2, void *a3);
int __fastcall IO80211Interface::reportTransmitStatus(__int64 a1, __int64 a2, int a3, __int64 a4);
// __int64 __usercall IO80211Interface::reportDataPathEventsGated@<rax>(IO80211Interface *this@<rdi>, void *a2@<rsi>, void *a3@<rdx>, void *a4@<rcx>, void *a5@<r8>, void *a6@<r9>, __int64 a7@<rax>);
// char *__usercall IO80211Interface::getBSDName@<rax>(IO80211Interface *this@<rdi>, __int64 a2@<rax>);
bool __fastcall IO80211Interface::reportDataPathEvents(IO80211Interface *this, int a2, void *a3, __int64 a4);
// char __usercall IO80211Interface::postMessage@<al>(IO80211Interface *this@<rdi>, ether_addr *a2@<rdx>, __int64 a3@<rax>, __int64 a4@<rcx>, signed int a5@<esi>);
__int64 __fastcall IO80211Interface::reportDataTransferRates(IO80211Interface *this); // idb
int __fastcall IO80211Interface::updateBSSIDProperty(IO80211Interface *this);
int __fastcall IO80211Interface::updateChannelProperty(IO80211Interface *this);
__int64 __fastcall IO80211Interface::updateSSIDProperty(IO80211Interface *__hidden this); // idb
int __fastcall IO80211Interface::updateCountryCodeProperty(IO80211Interface *this, char a2);
int __fastcall IO80211Interface::setPoweredOnByUser(IO80211Interface *this, unsigned __int8 a2);
int __fastcall IO80211Interface::configureAntennae(IO80211Interface *this);
char __fastcall IO80211Interface::poweredOnByUser(IO80211Interface *this);
void __fastcall IO80211Interface::setEnabledBySystem(IO80211Interface *this, char a2);
char __fastcall IO80211Interface::enabledBySystem(IO80211Interface *this);
void __fastcall IO80211Interface::setAuthTimeout(IO80211Interface *this, __int64 a2);
__int64 __fastcall IO80211Interface::authTimeout(IO80211Interface *__hidden this); // idb
int __fastcall IO80211Interface::stringFromReturn(IO80211Interface *this);
int __fastcall IO80211Interface::errnoFromReturn(IO80211Interface *this);
char __fastcall IO80211Interface::updateLinkSpeed(IO80211Interface *this);
char __fastcall IO80211Interface::setLinkState(IO80211Interface *this, int a2, int a3);
int __fastcall IO80211Interface::stopOutputQueues(IO80211Interface *this);
__int64 __fastcall IO80211Interface::debugFlags(IO80211Interface *__hidden this); // idb
int __fastcall IO80211Interface::startOutputQueues(IO80211Interface *this);
__int64 __fastcall IO80211Interface::linkState(IO80211Interface *__hidden this); // idb
int __fastcall IO80211Interface::inputEvent(IO80211Interface *this, __int64 a2, void *a3);
char __fastcall IO80211Interface::initSupplicant(IO80211Interface *this, unsigned __int8 *a2, unsigned int a3);
int __fastcall IO80211Interface::resetSupplicant(IO80211Interface *this);
char __fastcall IO80211Interface::setPMK(IO80211Interface *this, unsigned __int8 *a2);
bool __fastcall IO80211Interface::supplicantExchangeComplete(IO80211Interface *this);
int __fastcall IO80211Interface::outputEAPOLFrame(IO80211Interface *this, __mbuf *a2);
bool __fastcall IO80211Interface::supplicantInitialized(IO80211Interface *this);
int __fastcall IO80211Interface::cachePMKSA(IO80211Interface *this, unsigned __int8 *a2, size_t a3, ether_addr *a4, unsigned __int8 *a5);
int __fastcall IO80211Interface::purgePMKSACache(IO80211Interface *this);
__int64 __fastcall IO80211Interface::cachePMKSA(IO80211Interface *this, unsigned __int8 *a2, __int64 a3, ether_addr *a4);
__int64 __fastcall IO80211Interface::pmksaLookup(IO80211Interface *this, ether_addr *a2, unsigned __int8 *a3);
int __fastcall IO80211Interface::getPMKSAList(__int64 a1, __int64 a2);
signed __int64 __fastcall IO80211Interface::getExtendedStats(__int64 a1, __int64 a2);
char __fastcall IO80211Interface::shouldRoam(__int64 a1, __int64 a2);
__int64 __fastcall IO80211Interface::willRoam(IO80211Interface *this, ether_addr *a2, char a3);
int __fastcall IO80211Interface::awsRespond(IO80211Interface *this, __int64 a2, unsigned int *a3, __int64 a4, __int16 a5);
int __fastcall IO80211Interface::queueWMEPacket(IO80211Interface *this, __mbuf *a2, void *a3);
int __fastcall IO80211Interface::inputAWSPacket(IO80211Interface *this, __mbuf *a2);
__int64 __fastcall IO80211Interface::inputPacket(IO80211Interface *this, __mbuf *a2, unsigned int a3, __int64 a4, void *a5);
bool __fastcall IO80211Interface::shouldLog(IO80211Interface *this, __int64 a2);
__int64 __fastcall IO80211Interface::logDebug(IO80211Interface *this, const char *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
int __fastcall IO80211Interface::outputPacket(IO80211Interface *this, __mbuf *a2, void *a3);
int __fastcall IO80211Interface::setLinkQualityMetric(IO80211Interface *this, unsigned int a2);
// void __usercall IO80211Interface::stopCountermeasures(__int64 a1@<rax>, __int64 a2@<rdi>);
__int64 __fastcall IO80211Interface::getOutputQueue(IO80211Interface *__hidden this); // idb
__int64 __fastcall IO80211Interface::performCountryCodeOpGated(IO80211Interface *__hidden this, OSObject *, void *, void *, void *, void *); // idb
void __fastcall IO80211Interface::setPeerManagerLogFlag(IO80211Interface *this, int a2, char a3);
void __fastcall IO80211Interface::setDebugFlags(IO80211Interface *this, __int64 a2);
void __fastcall IO80211Interface::togglePeerManagerLogFlag(IO80211Interface *this, char a2);
__int64 __fastcall IO80211Interface::bpfAttach(__int64 a1, int a2, unsigned int a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7, __int64 a8, __int64 a9);
__int64 __fastcall _bpfOutput(__ifnet *a1, int a2, __mbuf *a3);
int __fastcall IO80211Interface::bpfOutputPacket(IO80211Interface *this, __mbuf *a2, void *a3);
int __fastcall IO80211Interface::bpfOutput(IO80211Interface *this, int a2, __mbuf *a3);
int __fastcall IO80211Interface::vlogDebug(IO80211Interface *this, __int64 a2, const char *a3, __va_list_tag *a4);
__int64 __fastcall IO80211Interface::logDebug(IO80211Interface *this, __int64 a2, const char *a3, __int64 a4, __int64 a5, __int64 a6);
void __fastcall IO80211Interface::vlogDebugBPF(IO80211Interface *this, __int64 a2, const char *a3, __va_list_tag *a4);
__int64 __fastcall IO80211Interface::monitorModeInputPacket(IO80211Interface *this, __mbuf *a2, unsigned int a3, void *a4, __int64 a5);
// int __usercall IO80211Interface::bpfTapInput@<eax>(IO80211Interface *this@<rdi>, __mbuf *a2@<rsi>, void *a3@<rcx>, int result@<eax>, unsigned int a5@<edx>, __int64 a6@<r8>);
int __fastcall IO80211Interface::outputStart(IO80211Interface *this);
int __fastcall IO80211Interface::configureInterface(IO80211Interface *this);
int __fastcall IO80211Interface::setDataPathState(IO80211Interface *this, char a2);
__int64 __fastcall IO80211Interface::bpfTap(IO80211Interface *this, int a2, unsigned int a3);
int __fastcall IO80211Interface::configureBpfOutputQueues(IO80211Interface *this, unsigned __int8 a2);
__int64 __fastcall IO80211Interface::getOutputQueueForDLT(IO80211Interface *this, int a2);
__int64 __fastcall IO80211Interface::setPidLock(IO80211Interface *this, __int64 a2, __int64 a3, __int64 a4);
bool __fastcall IO80211Interface::pidLocked(IO80211Interface *this);
char __fastcall IO80211Interface::netBooting(IO80211Interface *this);
void __fastcall IO80211Interface::setNetBooting(IO80211Interface *this, char a2);
__int64 __fastcall IO80211Interface::netBootThreadGated(IO80211Interface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
int __fastcall IO80211Interface::netBootThread(IO80211Interface *this, IOService *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
void __fastcall IO80211Interface::associateForNetBoot(IO80211Interface *this, IOService *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
int __fastcall net_boot_thread(void *a1, void *a2);
__int64 __fastcall IO80211Interface::associateForNetBootGated(IO80211Interface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
char __fastcall IO80211Interface::efiNVRAMPublished(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 *__fastcall IO80211Interface::apCompare(__int64 a1, __int64 *a2, __int64 *a3);
int __fastcall IO80211Interface::setWoWEnabled(IO80211Interface *this, unsigned __int8 a2);
char __fastcall IO80211Interface::shortGISupported40MHz(IO80211Interface *this);
char __fastcall IO80211Interface::shortGISupported20MHz(IO80211Interface *this);
__int64 __fastcall IO80211Interface::dequeueTxPackets(IO80211Interface *this);
int __fastcall IO80211Interface::dequeueTxPackets(__int64 a1, void *a2);
int __fastcall IO80211Interface::getControllerWorkLoop(IO80211Interface *this);
int __fastcall IO80211Interface::handleDebugCmd(__int64 a1);
int __fastcall IO80211Interface::printPeers(IO80211Interface *this);
__int64 __fastcall IO80211Interface::MetaClass::~MetaClass(IO80211Interface::MetaClass *__hidden this); // idb
__int64 __fastcall _phyModeForAsr(__int64 a1);
__int64 `global constructor keyed to'_a_14();
__int64 `global destructor keyed to'_a_14();
char __fastcall IO80211InterfaceValidateApple80211Command(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
char __fastcall IO80211InterfaceValidateNet80211Command(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
char __fastcall IO80211InterfaceUserlandToKernelApple80211Commmand(char *a1, char *a2, __int64 a3, __int64 a4);
char __fastcall IO80211InterfaceUserlandToKernelNet80211Commmand(char *a1, char *a2, __int64 a3, __int64 a4);
__int64 __fastcall IO80211InterfacePostMessage(char *a1, unsigned __int64 a2, void *a3, unsigned __int64 a4);
__mbuf *__fastcall IO80211InterfaceClassifyAndFixupPacket(OSObject *a1, __mbuf *a2);
__int64 __fastcall IO80211InterfaceDetermineWMEQueueByMulticastFixup(OSObject *, __mbuf *, unsigned __int8, __int64 *); // idb
__int64 __fastcall setWMEtclass(__mbuf *); // idb
__int64 __fastcall IO80211InterfaceQueueWMEPacket(OSObject *, __mbuf *); // idb
int __fastcall IO80211ConfigureBPFOutputQueue(__int64 a1, int a2, __int64 a3);
__int64 __fastcall IO80211BPFNodeForDLT(int a1, __int64 a2);
void __fastcall IO80211BPFListFree(__int64 a1);
int __fastcall IO80211BPFNodeFree(__int64 a1);
// __int64 __usercall IO80211AllocBPFNode@<rax>(__int64 a1@<rdx>, __int64 a2@<rcx>, int a3@<edi>, __int64 a4@<rsi>, __int64 a5@<r8>, __int64 a6, __int64 a7);
__int64 __fastcall IO80211BpfTap(__ifnet *a1, int a2, int a3);
int __fastcall IO80211AllocateBpfTapThreadCall(OSObject *a1);
int __fastcall _bpfTapCallbackThread(IO80211VirtualInterface *this, void *a2);
__int64 __fastcall _bpfTapCallbackGated(IO80211Interface *this, void *, void *, void *, void *); // idb
__int64 __fastcall sha256_vector(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall IO80211NetBootNub::MetaClass::MetaClass(IO80211NetBootNub::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211NetBootNub::MetaClass::~MetaClass(IO80211NetBootNub::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211NetBootNub::IO80211NetBootNub(__int64 a1);
__int64 __fastcall IO80211NetBootNub::IO80211NetBootNub(__int64 a1);
__int64 __fastcall IO80211NetBootNub::~IO80211NetBootNub(IO80211NetBootNub *__hidden this); // idb
__int64 __fastcall IO80211NetBootNub::~IO80211NetBootNub(IO80211NetBootNub *__hidden this); // idb
void __fastcall IO80211NetBootNub::~IO80211NetBootNub(IO80211NetBootNub *this);
__int64 __fastcall IO80211NetBootNub::getMetaClass(IO80211NetBootNub *__hidden this); // idb
__int64 __fastcall IO80211NetBootNub::MetaClass::MetaClass(IO80211NetBootNub::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211NetBootNub::MetaClass::alloc(IO80211NetBootNub::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211NetBootNub::IO80211NetBootNub(__int64 a1);
__int64 __fastcall IO80211NetBootNub::IO80211NetBootNub(__int64 a1);
__int64 __fastcall IO80211NetBootNub::nubWithControllerAndInterface(IO80211NetBootNub *__hidden this, IO80211Controller *, IO80211Interface *, IOService *); // idb
int __fastcall IO80211NetBootNub::initWithControllerAndInterface(IO80211NetBootNub *this, IO80211Controller *a2, IO80211Interface *a3, IOService *a4);
char __fastcall IO80211NetBootNub::start(IO80211NetBootNub *this, IOService *a2);
int __fastcall IO80211NetBootNub::getWorkLoop(IO80211NetBootNub *this);
__int64 __fastcall IO80211NetBootNub::associate(__int64 a1, __int64 a2);
int __fastcall IO80211NetBootNub::disassociate(IO80211NetBootNub *this);
__int64 __fastcall IO80211NetBootNub::associationResult(__int64 a1, __int64 a2);
int __fastcall IO80211NetBootNub::enableInterface(IO80211NetBootNub *this);
__int64 __fastcall IO80211NetBootNub::MetaClass::~MetaClass(IO80211NetBootNub::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_15();
__int64 `global destructor keyed to'_a_15();
__int64 __fastcall IO80211PacketDescriptor::MetaClass::MetaClass(IO80211PacketDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211PacketDescriptor::MetaClass::~MetaClass(IO80211PacketDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211PacketDescriptor::IO80211PacketDescriptor(__int64 a1);
__int64 __fastcall IO80211PacketDescriptor::IO80211PacketDescriptor(__int64 a1);
__int64 __fastcall IO80211PacketDescriptor::~IO80211PacketDescriptor(IO80211PacketDescriptor *__hidden this); // idb
__int64 __fastcall IO80211PacketDescriptor::~IO80211PacketDescriptor(IO80211PacketDescriptor *__hidden this); // idb
void __fastcall IO80211PacketDescriptor::~IO80211PacketDescriptor(IO80211PacketDescriptor *this);
__int64 __fastcall IO80211PacketDescriptor::getMetaClass(IO80211PacketDescriptor *__hidden this); // idb
__int64 __fastcall IO80211PacketDescriptor::MetaClass::MetaClass(IO80211PacketDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211PacketDescriptor::MetaClass::alloc(IO80211PacketDescriptor::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211PacketDescriptor::IO80211PacketDescriptor(__int64 a1);
__int64 __fastcall IO80211PacketDescriptor::IO80211PacketDescriptor(__int64 a1);
char __fastcall IO80211PacketDescriptor::init(IO80211PacketDescriptor *this, char a2);
int __fastcall IO80211PacketDescriptor::freeResources(IO80211PacketDescriptor *this);
__int64 __fastcall IO80211PacketDescriptor::print(__int64 a1, __int64 a2);
__int64 __fastcall IO80211PacketDescriptor::MetaClass::~MetaClass(IO80211PacketDescriptor::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_16();
__int64 `global destructor keyed to'_a_16();
__int64 __fastcall IO80211ScanManager::MetaClass::MetaClass(IO80211ScanManager::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211ScanManager::MetaClass::~MetaClass(IO80211ScanManager::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211ScanManager::IO80211ScanManager(__int64 a1);
__int64 __fastcall IO80211ScanManager::IO80211ScanManager(__int64 a1);
__int64 __fastcall IO80211ScanManager::~IO80211ScanManager(IO80211ScanManager *__hidden this); // idb
__int64 __fastcall IO80211ScanManager::~IO80211ScanManager(IO80211ScanManager *__hidden this); // idb
void __fastcall IO80211ScanManager::~IO80211ScanManager(IO80211ScanManager *this);
__int64 __fastcall IO80211ScanManager::getMetaClass(IO80211ScanManager *__hidden this); // idb
__int64 __fastcall IO80211ScanManager::MetaClass::MetaClass(IO80211ScanManager::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211ScanManager::MetaClass::alloc(IO80211ScanManager::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211ScanManager::IO80211ScanManager(__int64 a1);
__int64 __fastcall IO80211ScanManager::IO80211ScanManager(__int64 a1);
char *__fastcall IO80211ScanManager::makeSSID(IO80211ScanManager *this, unsigned __int8 *a2, size_t a3);
int __fastcall IO80211ScanManager::initWithControllerAndInterface(IO80211ScanManager *this, IO80211Controller *a2, IO80211Interface *a3);
int __fastcall IO80211ScanManager::cachePurgeTimeout(IO80211ScanManager *a1);
int __fastcall IO80211ScanManager::free(IO80211ScanManager *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
int __fastcall _releaseReqNode(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
int __fastcall _releaseCacheNode(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
signed __int64 __fastcall IO80211ScanManager::getCachedScanResults(__int64 a1, __int64 a2, __int64 a3, const void *a4, unsigned int a5);
__int64 __fastcall IO80211ScanManager::fastScan(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
void *__fastcall _allocScanReqNode(const void *a1, const void *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall IO80211ScanManager::searchForPendingAndClearPid(IO80211ScanManager *this, unsigned int a2);
__int64 __fastcall IO80211ScanManager::fastScanMultiple(__int64 a1, __int64 a2, unsigned int a3);
__int64 __fastcall IO80211ScanManager::startScanMultiple(IO80211ScanManager *this, void *); // idb
bool __fastcall IO80211ScanManager::isOpModeScanFriendly(IO80211ScanManager *this);
bool __fastcall IO80211ScanManager::isBroadcastScanRequest(__int64 a1, __int64 a2);
__int64 __fastcall IO80211ScanManager::startScan(IO80211ScanManager *this, __int64 a2);
signed __int64 __fastcall IO80211ScanManager::getScanResult(__int64 a1, __int64 a2);
__int64 __fastcall IO80211ScanManager::updateCache(__int64 a1, __int64 a2, __int64 a3);
char __fastcall IO80211ScanManager::scanDone(IO80211ScanManager *this, char a2);
int __fastcall IO80211ScanManager::cachePurge(IO80211ScanManager *this, __int64 a2);
__int64 __fastcall IO80211ScanManager::setCacheAgeThreshold(IO80211ScanManager *this, __int64 a2, __int64 a3, __int64 a4);
void __fastcall IO80211ScanManager::getTimeSinceLastBroadcastScan(__int64 a1, __int64 a2);
__int64 __fastcall IO80211ScanManager::MetaClass::~MetaClass(IO80211ScanManager::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_17();
__int64 `global destructor keyed to'_a_17();
__int64 _init_crc8_ccitt(void); // idb
__int64 __fastcall IO80211ServiceRequestDescriptor::MetaClass::MetaClass(IO80211ServiceRequestDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211ServiceRequestDescriptor::MetaClass::~MetaClass(IO80211ServiceRequestDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211ServiceRequestDescriptor::IO80211ServiceRequestDescriptor(__int64 a1);
__int64 __fastcall IO80211ServiceRequestDescriptor::IO80211ServiceRequestDescriptor(__int64 a1);
__int64 __fastcall IO80211ServiceRequestDescriptor::~IO80211ServiceRequestDescriptor(IO80211ServiceRequestDescriptor *__hidden this); // idb
__int64 __fastcall IO80211ServiceRequestDescriptor::~IO80211ServiceRequestDescriptor(IO80211ServiceRequestDescriptor *__hidden this); // idb
void __fastcall IO80211ServiceRequestDescriptor::~IO80211ServiceRequestDescriptor(IO80211ServiceRequestDescriptor *this);
__int64 __fastcall IO80211ServiceRequestDescriptor::getMetaClass(IO80211ServiceRequestDescriptor *__hidden this); // idb
__int64 __fastcall IO80211ServiceRequestDescriptor::MetaClass::MetaClass(IO80211ServiceRequestDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211ServiceRequestDescriptor::MetaClass::alloc(IO80211ServiceRequestDescriptor::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211ServiceRequestDescriptor::IO80211ServiceRequestDescriptor(__int64 a1);
__int64 __fastcall IO80211ServiceRequestDescriptor::IO80211ServiceRequestDescriptor(__int64 a1);
char __fastcall IO80211ServiceRequestDescriptor::initWithUserAddress(__int64 a1, __int64 a2, __int64 a3);
// __int64 __usercall putAsNameD2Dv1@<rax>(unsigned __int8 *a1@<rdi>, unsigned __int8 *a2@<rdx>, char a3@<al>, unsigned int a4@<esi>, __int64 a5@<r9>);
__int64 __fastcall compressAwdl(unsigned __int8 *a1, unsigned int a2, unsigned __int8 *a3, unsigned int a4, unsigned __int8 *a5);
__int64 __fastcall _do_crc8_ccitt(int a1, unsigned __int8 *a2);
char __fastcall IO80211ServiceRequestDescriptor::initWithArpaTLV(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
// __int64 __usercall IO80211ServiceRequestDescriptor::awdlUncompressData@<rax>(char a1@<al>, __int64 a2@<rdi>, __int64 a3@<rsi>);
char __fastcall IO80211ServiceRequestDescriptor::initWithTLVData(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall _service_response_tlv_checks(unsigned __int8 *a1, unsigned int a2, unsigned __int16 *a3, unsigned __int16 *a4, unsigned __int16 *a5, unsigned __int16 *a6, unsigned __int8 *a7);
signed __int64 __fastcall IO80211ServiceRequestDescriptor::awdlUncompressKey(__int64 a1, __int64 a2);
int __fastcall IO80211ServiceRequestDescriptor::freeResources(IO80211ServiceRequestDescriptor *this);
__int64 __fastcall _service_response_get_hash(unsigned __int8 *, unsigned __int8, unsigned __int8 *, unsigned __int8 *); // idb
__int64 __fastcall uncompressAwdl(unsigned __int8 *a1, int a2, unsigned __int8 *a3, unsigned int a4, unsigned __int8 *a5, unsigned int a6);
char __fastcall _service_response_init_context(__int64 a1, __int64 a2, unsigned __int8 a3);
signed __int64 __fastcall _findTLV(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IO80211ServiceRequestDescriptor::compare(__int64 a1, __int64 a2);
__int64 __fastcall _copyTLV(__int64 a1, __int64 a2, __int64 a3, __int64 *a4);
__int64 __fastcall IO80211ServiceRequestDescriptor::getLength(IO80211ServiceRequestDescriptor *__hidden this); // idb
__int64 __fastcall IO80211ServiceRequestDescriptor::recordType(IO80211ServiceRequestDescriptor *__hidden this); // idb
__int64 __fastcall IO80211ServiceRequestDescriptor::hasString(IO80211ServiceRequestDescriptor *this, const char *a2, unsigned __int64 a3);
__int64 __fastcall IO80211ServiceRequestDescriptor::copyData(IO80211ServiceRequestDescriptor *__hidden this, unsigned __int8 *); // idb
__int64 __fastcall _service_response_tlv_get_type(unsigned __int8 *a1, unsigned int a2);
__int64 __fastcall _compareServiceKeys(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IO80211ServiceRequestDescriptor::getDataLength(IO80211ServiceRequestDescriptor *__hidden this); // idb
__int64 __fastcall IO80211ServiceRequestDescriptor::copyDataOnly(IO80211ServiceRequestDescriptor *this, unsigned __int8 *a2, unsigned __int64 a3);
__int64 __fastcall IO80211ServiceRequestDescriptor::copy(IO80211ServiceRequestDescriptor *this, unsigned __int64 a2);
__int64 __fastcall IO80211ServiceRequestDescriptor::setMulticastSendPending(IO80211ServiceRequestDescriptor *this, unsigned __int8 *a2, unsigned __int8 a3, ether_addr *a4);
__int64 __fastcall IO80211ServiceRequestDescriptor::insertData(IO80211ServiceRequestDescriptor *this, unsigned __int8 *a2, unsigned int a3);
__int64 __fastcall IO80211ServiceRequestDescriptor::isBrowseFor(IO80211ServiceRequestDescriptor *this, unsigned __int8 *a2, unsigned __int8 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall IO80211ServiceRequestDescriptor::compare(IO80211ServiceRequestDescriptor *__hidden this, IO80211ServiceRequestDescriptor *); // idb
__int64 __fastcall IO80211ServiceRequestDescriptor::recordTypeCoded(IO80211ServiceRequestDescriptor *__hidden this); // idb
__int64 __fastcall IO80211ServiceRequestDescriptor::print(IO80211ServiceRequestDescriptor *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall IO80211ServiceRequestDescriptor::buildmDNSFrame(__int64 a1, __int64 a2);
__int64 __fastcall IO80211ServiceRequestDescriptor::MetaClass::~MetaClass(IO80211ServiceRequestDescriptor::MetaClass *__hidden this); // idb
char *`global constructor keyed to'_a_18();
__int64 `global destructor keyed to'_a_18();
__int64 __fastcall getLengthBeforeSensitivePayload(int a1, __mbuf *a2);
__int64 __fastcall getLengthBeforeSensitivePayloadUDP(int, __mbuf *); // idb
__int64 __fastcall Stopwatch::MetaClass::MetaClass(Stopwatch::MetaClass *__hidden this); // idb
__int64 __fastcall Stopwatch::MetaClass::~MetaClass(Stopwatch::MetaClass *__hidden this); // idb
__int64 __fastcall Stopwatch::Stopwatch(__int64 a1);
__int64 __fastcall Stopwatch::Stopwatch(__int64 a1);
__int64 __fastcall Stopwatch::~Stopwatch(Stopwatch *__hidden this); // idb
__int64 __fastcall Stopwatch::~Stopwatch(Stopwatch *__hidden this); // idb
void __fastcall Stopwatch::~Stopwatch(Stopwatch *this);
__int64 __fastcall Stopwatch::getMetaClass(Stopwatch *__hidden this); // idb
__int64 __fastcall Stopwatch::MetaClass::MetaClass(Stopwatch::MetaClass *__hidden this); // idb
__int64 __fastcall Stopwatch::MetaClass::alloc(Stopwatch::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall Stopwatch::Stopwatch(__int64 a1);
__int64 __fastcall Stopwatch::Stopwatch(__int64 a1);
__int64 __fastcall Stopwatch::withUptime(Stopwatch *this, unsigned __int64 a2);
int __fastcall Stopwatch::init(Stopwatch *this);
int __fastcall Stopwatch::free(Stopwatch *this);
// int __usercall Stopwatch::start@<eax>(Stopwatch *this@<rdi>, __int64 a2@<rax>);
__int64 __fastcall Stopwatch::getElapsed_ns(Stopwatch *__hidden this); // idb
void __fastcall Stopwatch::reset(Stopwatch *this);
int __fastcall Stopwatch::restart(Stopwatch *this);
int __fastcall Stopwatch::stop(Stopwatch *this);
// __int64 __usercall Stopwatch::getSplit_ns@<rax>(Stopwatch *this@<rdi>, __int64 a2@<rax>);
// unsigned __int64 __usercall Stopwatch::getSplit_us@<rax>(Stopwatch *this@<rdi>, __int64 a2@<rax>);
unsigned __int64 __fastcall Stopwatch::getElapsed_us(Stopwatch *this);
unsigned __int64 __fastcall Stopwatch::getElapsed_s(Stopwatch *this);
unsigned __int64 __fastcall Stopwatch::getElapsed(__int64 a1, __int64 a2);
__int64 __fastcall Stopwatch::MetaClass::~MetaClass(Stopwatch::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_19();
__int64 `global destructor keyed to'_a_19();
__int64 __fastcall tls_prf_sha256(void *a1, size_t a2, const char *a3, __int64 a4, __int64 a5, __int64 a6, unsigned __int64 a7);
__int64 __fastcall IO80211VirtualInterface::MetaClass::MetaClass(IO80211VirtualInterface::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::MetaClass::~MetaClass(IO80211VirtualInterface::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::IO80211VirtualInterface(__int64 a1);
__int64 __fastcall IO80211VirtualInterface::IO80211VirtualInterface(__int64 a1);
__int64 __fastcall IO80211VirtualInterface::~IO80211VirtualInterface(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::~IO80211VirtualInterface(IO80211VirtualInterface *__hidden this); // idb
void __fastcall IO80211VirtualInterface::~IO80211VirtualInterface(IO80211VirtualInterface *this);
__int64 __fastcall IO80211VirtualInterface::getMetaClass(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::MetaClass::MetaClass(IO80211VirtualInterface::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::MetaClass::alloc(IO80211VirtualInterface::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211VirtualInterface::IO80211VirtualInterface(__int64 a1);
__int64 __fastcall IO80211VirtualInterface::IO80211VirtualInterface(__int64 a1);
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface0(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface1(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface2(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface3(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface4(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface5(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface6(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface7(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface8(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface9(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface10(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface11(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface12(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface13(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface14(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface15(IO80211VirtualInterface *__hidden this); // idb
char __fastcall IO80211VirtualInterface::attachToBpf(IO80211VirtualInterface *this);
__int64 __fastcall IO80211VirtualInterface::getController(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::getInterfaceRole(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::bpfAttach(IO80211VirtualInterface *this, int a2, int a3);
__int64 __fastcall IO80211VirtualInterface::getIfnet(IO80211VirtualInterface *__hidden this); // idb
char *__fastcall IO80211VirtualInterface::getBSDName(IO80211VirtualInterface *this);
__int64 __fastcall IO80211VirtualInterface::init(IO80211VirtualInterface *this, IO80211Controller *, ether_addr *, unsigned int, const char *); // idb
int __fastcall IO80211VirtualInterface::setInterfaceRole(IO80211VirtualInterface *this, int a2);
char __fastcall IO80211VirtualInterface::attachIfnet(IO80211VirtualInterface *this, ether_addr *a2, const char *a3);
int __fastcall IO80211VirtualInterface::stringFromReturn(IO80211VirtualInterface *this);
int __fastcall IO80211VirtualInterface::errnoFromReturn(IO80211VirtualInterface *this);
__int64 __fastcall IO80211VirtualInterface::configureAQMOutput(IO80211VirtualInterface *__hidden this); // idb
int __fastcall IO80211VirtualInterface::reportTransmitStatus(__int64 a1, __int64 a2, int a3, __int64 a4);
char __fastcall IO80211VirtualInterface::dualBandCapable(IO80211VirtualInterface *this);
__int64 __fastcall IO80211VirtualInterface::reportDataPathEventsGated(IO80211VirtualInterface *this, void *a2, void *a3, void *a4, void *a5, void *a6);
bool __fastcall IO80211VirtualInterface::reportDataPathEvents(IO80211VirtualInterface *this, int a2, void *a3, __int64 a4);
int __fastcall IO80211VirtualInterface::free(IO80211VirtualInterface *this, signed __int64 a2);
int __fastcall IO80211VirtualInterface::detachIfnet(IO80211VirtualInterface *this);
int __fastcall IO80211VirtualInterface::terminate(IO80211VirtualInterface *this, unsigned int a2);
__int64 __fastcall IO80211VirtualInterface::powerStateWillChangeTo(IO80211VirtualInterface *this, __int64 a2, __int64 a3, IOService *a4);
int __fastcall IO80211VirtualInterface::powerStateWillChangeToGated(IO80211VirtualInterface *this, void *a2, void *a3, void *a4, void *a5, void *a6);
// __int64 __usercall IO80211VirtualInterface::controllerWillChangePowerState@<rax>(IO80211VirtualInterface *this@<rdi>, IO80211Controller *a2@<rsi>, IOService *a3@<r8>, char a4@<dh>);
__int64 __fastcall IO80211VirtualInterface::handleSIOCSIFFLAGS(IO80211VirtualInterface *this); // idb
__int64 __fastcall IO80211VirtualInterface::powerStateDidChangeTo(IO80211VirtualInterface *this, __int64 a2, __int64 a3, IOService *a4);
int __fastcall IO80211VirtualInterface::powerStateDidChangeToGated(IO80211VirtualInterface *this, void *a2, void *a3, void *a4, void *a5, void *a6);
// __int64 __usercall IO80211VirtualInterface::controllerDidChangePowerState@<rax>(IO80211VirtualInterface *this@<rdi>, IO80211Controller *a2@<rsi>, IOService *a3@<r8>, char a4@<dh>);
void __fastcall IO80211VirtualInterface::setEnabledBySystem(IO80211VirtualInterface *this, char a2);
char __fastcall IO80211VirtualInterface::enabledBySystem(IO80211VirtualInterface *this);
__int64 __fastcall IO80211VirtualInterface::bpfTap(IO80211VirtualInterface *this, int a2, unsigned int a3);
int __fastcall IO80211VirtualInterface::configureBpfOutputQueues(IO80211VirtualInterface *this, unsigned __int8 a2);
int __fastcall IO80211VirtualInterface::bpfOutputPacket(IO80211VirtualInterface *this, __mbuf *a2, void *a3);
__int64 __fastcall IO80211VirtualInterface::bpfOutput(IO80211VirtualInterface *this, signed __int64 a2, __mbuf *a3);
int __fastcall IO80211VirtualInterface::bpfAttachEN10MB(IO80211VirtualInterface *this, int a2);
__int64 __fastcall _bpfOutput(__ifnet *a1, unsigned int a2, __mbuf *a3);
__int64 __fastcall IO80211VirtualInterface::bpfAttach(IO80211VirtualInterface *this, int a2, int a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7, __int64 a8, __int64 a9);
int __fastcall IO80211VirtualInterface::bpfTapInput(IO80211VirtualInterface *this, __mbuf *a2, unsigned int a3, void *a4, __int64 a5);
int __fastcall IO80211VirtualInterface::ifnet_start_callback(IO80211VirtualInterface *this, __ifnet *a2);
int __fastcall IO80211VirtualInterface::ifnet_detach_callback(IO80211VirtualInterface *this, __ifnet *a2);
int __fastcall IO80211VirtualInterface::ifnet_ioctl_callback(IO80211VirtualInterface *this, __ifnet *a2, __int64 a3, void *a4);
__int64 __fastcall IO80211VirtualInterface::getDetachLock(IO80211VirtualInterface *__hidden this); // idb
void __fastcall IO80211VirtualInterface::setWaitingForDetach(IO80211VirtualInterface *this, char a2);
int __fastcall IO80211VirtualInterface::dequeueTxPackets(__int64 a1, void *a2);
int __fastcall IO80211VirtualInterface::ioctl_internal_gated(IO80211VirtualInterface *this, void *a2, void *a3, void *a4, void *a5, void *a6);
int __fastcall IO80211VirtualInterface::ioctl_internal(IO80211VirtualInterface *this, void *a2);
int __fastcall IO80211VirtualInterface::handleIoctl(IO80211VirtualInterface *this, __int64 a2, void *a3);
int __fastcall IO80211VirtualInterface::handleIoctlGated(IO80211VirtualInterface *this, void *a2, ifmediareq *a3, void *a4, void *a5, void *a6);
// __int64 __usercall IO80211VirtualInterface::handleSIOCGIFMEDIA@<rax>(IO80211VirtualInterface *this@<rdi>, ifmediareq *a2@<rdx>, __int64 a3@<rax>, __int64 a4@<rsi>);
__int64 __fastcall IO80211VirtualInterface::handleSIOCSIFADDR(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::getMediumType(IO80211VirtualInterface *__hidden this); // idb
int __fastcall IO80211VirtualInterface::getWorkLoop(IO80211VirtualInterface *this);
int __fastcall IO80211VirtualInterface::setScanningState(__int64 a1, __int64 a2, unsigned __int8 a3);
int __fastcall IO80211VirtualInterface::setJoiningState(IO80211VirtualInterface *this, __int64 a2, unsigned __int8 a3);
int __fastcall IO80211VirtualInterface::setInfraTxState(IO80211VirtualInterface *this, unsigned __int8 a2);
int __fastcall IO80211VirtualInterface::infraBSSIDChange(IO80211VirtualInterface *this);
int __fastcall IO80211VirtualInterface::setInfraChannel(__int64 a1, __int64 a2);
__int64 __fastcall IO80211VirtualInterface::postAwdlStatistics(__int64 a1, const void *a2);
__int64 __fastcall IO80211VirtualInterface::postSyncStateChanged(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::postNewMasterElected(IO80211VirtualInterface *this, __ifnet *a2);
int __fastcall IO80211VirtualInterface::postServiceIndication(IO80211VirtualInterface *this);
int __fastcall IO80211VirtualInterface::postMessage(IO80211VirtualInterface *this, unsigned __int64 a2, void *a3, unsigned __int64 a4);
__int64 __fastcall IO80211VirtualInterface::postPeerPresence(IO80211VirtualInterface *this, ether_addr *a2, int a3, int a4, int a5, char *a6);
__int64 __fastcall IO80211VirtualInterface::postPeerAbsence(IO80211VirtualInterface *this, ether_addr *a2);
// char __usercall IO80211VirtualInterface::signalOutputThread@<al>(IO80211VirtualInterface *this@<rdi>, __int64 a2@<rax>);
bool __fastcall IO80211VirtualInterface::isOutputFlowControlled(IO80211VirtualInterface *this);
__int64 __fastcall IO80211VirtualInterface::setOutputFlowControlled(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::clearOutputFlowControlled(IO80211VirtualInterface *__hidden this); // idb
char __fastcall IO80211VirtualInterface::outputStart(IO80211VirtualInterface *this);
// __int64 __usercall IO80211VirtualInterface::dequeueOutputPacketsWithServiceClass@<rax>(signed int a1@<edx>, __int64 a2@<rcx>, __int64 a3@<rdi>, unsigned int a4@<esi>, __int64 a5);
int __fastcall IO80211VirtualInterface::outputPacket(IO80211VirtualInterface *this, __mbuf *a2, void *a3);
void __fastcall IO80211VirtualInterface::setAuthTimeout(IO80211VirtualInterface *this, __int64 a2);
__int64 __fastcall IO80211VirtualInterface::authTimeout(IO80211VirtualInterface *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterface::initSupplicant(IO80211VirtualInterface *this, unsigned __int8 *a2);
__int64 __fastcall IO80211VirtualInterface::setPMK(IO80211VirtualInterface *__hidden this, unsigned __int8 *); // idb
void __fastcall IO80211VirtualInterface::terminateSupplicant(IO80211VirtualInterface *this);
__int64 __fastcall IO80211VirtualInterface::supplicantInitialized(IO80211VirtualInterface *__hidden this); // idb
void __fastcall IO80211VirtualInterface::resetSupplicant(IO80211VirtualInterface *this);
void __fastcall IO80211VirtualInterface::cachePMKSA(IO80211VirtualInterface *this, unsigned __int8 *a2, __int64 a3, ether_addr *a4, unsigned __int8 *a5);
__int64 __fastcall IO80211VirtualInterface::cachePMKSA(IO80211VirtualInterface *this, unsigned __int8 *a2, __int64 a3, ether_addr *a4);
void __fastcall IO80211VirtualInterface::setDebugFlags(IO80211VirtualInterface *this, __int64 a2);
__int64 __fastcall IO80211VirtualInterface::debugFlags(IO80211VirtualInterface *__hidden this); // idb
void __fastcall IO80211VirtualInterface::setWoWEnabled(IO80211VirtualInterface *this);
__int64 __fastcall IO80211VirtualInterface::supplicantExchangeComplete(IO80211VirtualInterface *__hidden this); // idb
void IO80211VirtualInterface::getPMKSAList();
__int64 __fastcall IO80211VirtualInterface::linkState(IO80211VirtualInterface *__hidden this); // idb
char __fastcall IO80211VirtualInterface::setLinkState(__int64 a1, int a2, int a3);
int __fastcall IO80211VirtualInterface::startOutputQueues(IO80211VirtualInterface *this);
int __fastcall IO80211VirtualInterface::stopOutputQueues(IO80211VirtualInterface *this);
char __fastcall IO80211VirtualInterface::controllerLostPower(IO80211VirtualInterface *this);
__int64 __fastcall IO80211VirtualInterface::handle11zPacket(IO80211VirtualInterface *__hidden this, __mbuf *); // idb
int __fastcall IO80211VirtualInterface::captureInfraPacket(IO80211VirtualInterface *this, __mbuf **a2);
int __fastcall IO80211VirtualInterface::pushPacket(IO80211VirtualInterface *this, __mbuf *a2, __int64 a3);
int __fastcall IO80211VirtualInterface::inputPacket(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IO80211VirtualInterface::reportTransmitCompletionStatus(IO80211VirtualInterface *this, __mbuf *a2);
int __fastcall IO80211VirtualInterface::passUp(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IO80211VirtualInterface::getOutputQueueForDLT(IO80211VirtualInterface *this, int a2);
void __fastcall IO80211VirtualInterface::setPeerManagerLogFlag(IO80211VirtualInterface *this, int a2, char a3);
void __fastcall IO80211VirtualInterface::togglePeerManagerLogFlag(IO80211VirtualInterface *this, char a2);
__int64 __fastcall IO80211VirtualInterface::getPeerManagerLogFlags(IO80211VirtualInterface *__hidden this); // idb
size_t __fastcall IO80211VirtualInterface::setUnitNumber(IO80211VirtualInterface *this, const char *a2);
size_t __fastcall IO80211VirtualInterface::setUnitNumber(IO80211VirtualInterface *this, const char *a2, int a3);
int __fastcall IO80211VirtualInterface::handleDebugCmd(__int64 a1);
int __fastcall IO80211VirtualInterface::handleChannelSwitchAnnouncement(__int64 a1);
__int64 __fastcall IO80211VirtualInterface::MetaClass::~MetaClass(IO80211VirtualInterface::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_20();
__int64 `global destructor keyed to'_a_20();
__int64 __fastcall IO80211QueueDescriptor::MetaClass::MetaClass(IO80211QueueDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211QueueDescriptor::MetaClass::~MetaClass(IO80211QueueDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211QueueDescriptor::IO80211QueueDescriptor(__int64 a1);
__int64 __fastcall IO80211QueueDescriptor::IO80211QueueDescriptor(__int64 a1);
__int64 __fastcall IO80211QueueDescriptor::~IO80211QueueDescriptor(IO80211QueueDescriptor *__hidden this); // idb
__int64 __fastcall IO80211QueueDescriptor::~IO80211QueueDescriptor(IO80211QueueDescriptor *__hidden this); // idb
void __fastcall IO80211QueueDescriptor::~IO80211QueueDescriptor(IO80211QueueDescriptor *this);
__int64 __fastcall IO80211QueueDescriptor::getMetaClass(IO80211QueueDescriptor *__hidden this); // idb
__int64 __fastcall IO80211QueueDescriptor::MetaClass::MetaClass(IO80211QueueDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211QueueDescriptor::MetaClass::alloc(IO80211QueueDescriptor::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211QueueDescriptor::IO80211QueueDescriptor(__int64 a1);
__int64 __fastcall IO80211QueueDescriptor::IO80211QueueDescriptor(__int64 a1);
char *__fastcall buf_kernel_addrperm_addr(void *a1);
char *__fastcall vm_kernel_addrperm_addr(void *a1);
__int64 __fastcall _userPrint(__int64 a1, char *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, char a7);
char __fastcall IO80211QueueDescriptor::init(IO80211QueueDescriptor *this);
__int64 IO80211QueueDescriptor::print();
__int64 __fastcall IO80211QueueDescriptor::MetaClass::~MetaClass(IO80211QueueDescriptor::MetaClass *__hidden this); // idb
void __fastcall IO80211QueueDescriptor::freeResources(IO80211QueueDescriptor *this);
__int64 `global constructor keyed to'_a_21();
__int64 `global destructor keyed to'_a_21();
__int64 __fastcall IO80211PeerExtendedStats::MetaClass::MetaClass(IO80211PeerExtendedStats::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211PeerExtendedStats::MetaClass::~MetaClass(IO80211PeerExtendedStats::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211PeerExtendedStats::IO80211PeerExtendedStats(__int64 a1);
__int64 __fastcall IO80211PeerExtendedStats::IO80211PeerExtendedStats(__int64 a1);
__int64 __fastcall IO80211PeerExtendedStats::~IO80211PeerExtendedStats(IO80211PeerExtendedStats *__hidden this); // idb
__int64 __fastcall IO80211PeerExtendedStats::~IO80211PeerExtendedStats(IO80211PeerExtendedStats *__hidden this); // idb
void __fastcall IO80211PeerExtendedStats::~IO80211PeerExtendedStats(IO80211PeerExtendedStats *this);
__int64 __fastcall IO80211PeerExtendedStats::getMetaClass(IO80211PeerExtendedStats *__hidden this); // idb
__int64 __fastcall IO80211PeerExtendedStats::MetaClass::MetaClass(IO80211PeerExtendedStats::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211PeerExtendedStats::MetaClass::alloc(IO80211PeerExtendedStats::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211PeerExtendedStats::IO80211PeerExtendedStats(__int64 a1);
__int64 __fastcall IO80211PeerExtendedStats::IO80211PeerExtendedStats(__int64 a1);
__int64 __fastcall IO80211PeerExtendedStats::MetaClass::~MetaClass(IO80211PeerExtendedStats::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_22();
__int64 `global destructor keyed to'_a_22();
__int64 __fastcall IO80211VirtualInterfaceNamer::MetaClass::MetaClass(IO80211VirtualInterfaceNamer::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterfaceNamer::MetaClass::~MetaClass(IO80211VirtualInterfaceNamer::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterfaceNamer::IO80211VirtualInterfaceNamer(__int64 a1);
__int64 __fastcall IO80211VirtualInterfaceNamer::IO80211VirtualInterfaceNamer(__int64 a1);
__int64 __fastcall IO80211VirtualInterfaceNamer::~IO80211VirtualInterfaceNamer(IO80211VirtualInterfaceNamer *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterfaceNamer::~IO80211VirtualInterfaceNamer(IO80211VirtualInterfaceNamer *__hidden this); // idb
void __fastcall IO80211VirtualInterfaceNamer::~IO80211VirtualInterfaceNamer(IO80211VirtualInterfaceNamer *this);
__int64 __fastcall IO80211VirtualInterfaceNamer::getMetaClass(IO80211VirtualInterfaceNamer *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterfaceNamer::MetaClass::MetaClass(IO80211VirtualInterfaceNamer::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211VirtualInterfaceNamer::MetaClass::alloc(IO80211VirtualInterfaceNamer::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211VirtualInterfaceNamer::IO80211VirtualInterfaceNamer(__int64 a1);
__int64 __fastcall IO80211VirtualInterfaceNamer::IO80211VirtualInterfaceNamer(__int64 a1);
bool __fastcall IO80211VirtualInterfaceNamer::init(IO80211VirtualInterfaceNamer *this);
int __fastcall IO80211VirtualInterfaceNamer::free(IO80211VirtualInterfaceNamer *this);
char __fastcall IO80211VirtualInterfaceNamer::arrayContainsUnitNumber(IO80211VirtualInterfaceNamer *this, OSArray *a2, OSNumber *a3);
char __fastcall IO80211VirtualInterfaceNamer::markInterfaceUnitUsed(IO80211VirtualInterfaceNamer *this, const char *a2, unsigned int a3);
int __fastcall IO80211VirtualInterfaceNamer::markInterfaceUnitUnused(IO80211VirtualInterfaceNamer *this, const char *a2, unsigned int a3);
__int64 __fastcall IO80211VirtualInterfaceNamer::nextAvailableUnitNumberForName(IO80211VirtualInterfaceNamer *this, const char *a2, char a3);
char IO80211VirtualInterfaceNamerRetain(void);
int IO80211VirtualInterfaceNamerRelease(void);
char __fastcall IO80211VirtualInterfaceNamerMarkInterfaceUnitUsed(const char *a1, unsigned int a2);
int __fastcall IO80211VirtualInterfaceNamerMarkInterfaceUnitUnused(const char *a1, unsigned int a2);
__int64 __fastcall IO80211VirtualInterfaceNamerNextAvailableUnitNumberForName(const char *a1, char a2);
__int64 __fastcall IO80211VirtualInterfaceNamer::MetaClass::~MetaClass(IO80211VirtualInterfaceNamer::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_23();
__int64 `global destructor keyed to'_a_23();
__int64 __fastcall IO80211DriverCommandDescriptor::MetaClass::MetaClass(IO80211DriverCommandDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211DriverCommandDescriptor::MetaClass::~MetaClass(IO80211DriverCommandDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211DriverCommandDescriptor::IO80211DriverCommandDescriptor(__int64 a1);
__int64 __fastcall IO80211DriverCommandDescriptor::IO80211DriverCommandDescriptor(__int64 a1);
__int64 __fastcall IO80211DriverCommandDescriptor::~IO80211DriverCommandDescriptor(IO80211DriverCommandDescriptor *__hidden this); // idb
__int64 __fastcall IO80211DriverCommandDescriptor::~IO80211DriverCommandDescriptor(IO80211DriverCommandDescriptor *__hidden this); // idb
void __fastcall IO80211DriverCommandDescriptor::~IO80211DriverCommandDescriptor(IO80211DriverCommandDescriptor *this);
__int64 __fastcall IO80211DriverCommandDescriptor::getMetaClass(IO80211DriverCommandDescriptor *__hidden this); // idb
__int64 __fastcall IO80211DriverCommandDescriptor::MetaClass::MetaClass(IO80211DriverCommandDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall IO80211DriverCommandDescriptor::MetaClass::alloc(IO80211DriverCommandDescriptor::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IO80211DriverCommandDescriptor::IO80211DriverCommandDescriptor(__int64 a1);
__int64 __fastcall IO80211DriverCommandDescriptor::IO80211DriverCommandDescriptor(__int64 a1);
char __fastcall IO80211DriverCommandDescriptor::initWithIoctl(IO80211DriverCommandDescriptor *this, unsigned __int8 *a2, size_t a3, int a4, int a5);
char __fastcall IO80211DriverCommandDescriptor::initAsOutputStart(IO80211DriverCommandDescriptor *this);
int __fastcall IO80211DriverCommandDescriptor::freeResources(IO80211DriverCommandDescriptor *this);
// __int64 __usercall IO80211DriverCommandDescriptor::print@<rax>(char a1@<al>, __int64 a2@<rdi>, __int64 a3@<rsi>);
__int64 __fastcall IO80211DriverCommandDescriptor::MetaClass::~MetaClass(IO80211DriverCommandDescriptor::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_24();
__int64 `global destructor keyed to'_a_24();
int _start();
__int64 *OSKextGetCurrentIdentifier();
__int64 *OSKextGetCurrentVersionString();
__int64 OSKextGetCurrentLoadTag();
int _stop();
// int __fastcall IOFree(_QWORD, _QWORD); weak
// int __fastcall IOFreeAligned(_QWORD, _QWORD); weak
// int __cdecl IOLockAlloc(_QWORD); weak
// int __fastcall IOLockFree(_QWORD); weak
// int __fastcall IOLockInitWithState(_QWORD, _QWORD); weak
// int __fastcall IOLockLock(_QWORD); weak
// int __fastcall IOLockSleep_darwin14(_QWORD, _QWORD, _QWORD); weak
// int __cdecl IOLockTryLock(_QWORD); weak
// int __fastcall IOLockUnlock(_QWORD); weak
// int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall IOLogv(_QWORD); weak
// int __fastcall IOMalloc(_QWORD); weak
// int __fastcall IOMallocAligned(_QWORD, _QWORD); weak
// int __cdecl IORecursiveLockAlloc(_QWORD); weak
// int __cdecl IORecursiveLockFree(_QWORD); weak
// int __cdecl IORecursiveLockLock(_QWORD); weak
// int __fastcall IORecursiveLockUnlock(_QWORD, _QWORD); weak
// int __fastcall IOSimpleLockAlloc(_QWORD); weak
// int IOSimpleLockFree(void); weak
// int __fastcall IOSimpleLockInit(_QWORD); weak
// int __fastcall IOSimpleLockLock(_QWORD); weak
// int __fastcall IOSimpleLockUnlock(_QWORD); weak
// int __fastcall MD5Final(_QWORD, _QWORD); weak
// int __fastcall MD5Init(_QWORD); weak
// int __fastcall MD5Update(_QWORD, _QWORD, _QWORD); weak
// int __fastcall OSBitAndAtomic(_QWORD, _QWORD); weak
// int __fastcall OSBitOrAtomic(_QWORD, _QWORD); weak
// int __fastcall OSCompareAndSwap(_QWORD, _QWORD, _QWORD); weak
// int __fastcall OSCompareAndSwapPtr(_QWORD, _QWORD, _QWORD); weak
// int __fastcall OSDecrementAtomic(_QWORD); weak
// int __fastcall OSIncrementAtomic(_QWORD); weak
// int __fastcall PE_parse_boot_argn(_QWORD, _QWORD, _QWORD); weak
// int __fastcall SHA1Final(_QWORD, _QWORD); weak
// int __fastcall SHA1Init(_QWORD); weak
// int __fastcall SHA1Update(_QWORD, _QWORD, _QWORD); weak
// int __cdecl IOWorkLoop::IOWorkLoop(_QWORD); weak
// _QWORD __cdecl IOWorkLoop::~IOWorkLoop(IOWorkLoop *__hidden this); idb
// int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD); weak
// _QWORD __cdecl OSMetaClass::~OSMetaClass(OSMetaClass *__hidden this); idb
// _QWORD __cdecl OSDictionary::withCapacity(OSDictionary *__hidden this, unsigned int); idb
// _QWORD __cdecl IOCommandGate::commandGate(IOCommandGate *__hidden this, OSObject *, int (__cdecl *)(OSObject *, void *, void *, void *, void *)); idb
// int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD); weak
// int __fastcall IOGatedOutputQueue::withTarget(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); weak
// _QWORD __cdecl IONetworkInterface::flushOutputQueue(IONetworkInterface *__hidden this, unsigned int); idb
// _QWORD __cdecl IONetworkInterface::stopOutputThread(IONetworkInterface *__hidden this, unsigned int); idb
// _QWORD __cdecl IONetworkInterface::startOutputThread(IONetworkInterface *__hidden this, unsigned int); idb
// _QWORD __cdecl IONetworkInterface::signalOutputThread(IONetworkInterface *__hidden this, unsigned int); idb
// _QWORD __cdecl IONetworkInterface::enqueueOutputPacket(IONetworkInterface *__hidden this, __mbuf *, unsigned int); idb
// _QWORD __cdecl IONetworkInterface::setInterfaceSubType(IONetworkInterface *__hidden this, unsigned int); idb
// _QWORD __cdecl IONetworkInterface::installOutputPreEnqueueHandler(IONetworkInterface *__hidden this, int (__cdecl *)(void *, void *, __mbuf *), void *, void *); idb
// _QWORD __cdecl IONetworkInterface::reportTransmitCompletionStatus(IONetworkInterface *__hidden this, __mbuf *, int, unsigned int, unsigned int, unsigned int); idb
// int __fastcall IOTimerEventSource::timerEventSource(_QWORD, _QWORD); weak
// _QWORD __cdecl IOEthernetInterface::IOEthernetInterface(IOEthernetInterface *__hidden this, const OSMetaClass *); idb
// _QWORD __cdecl IOEthernetInterface::~IOEthernetInterface(IOEthernetInterface *__hidden this); idb
// _QWORD __cdecl IOEthernetController::IOEthernetController(IOEthernetController *__hidden this, const OSMetaClass *); idb
// _QWORD __cdecl IOEthernetController::~IOEthernetController(IOEthernetController *__hidden this); idb
// _QWORD __cdecl OSArray::withCapacity(OSArray *__hidden this, unsigned int); idb
// _QWORD __cdecl OSNumber::withNumber(OSNumber *__hidden this, unsigned __int64, unsigned int); idb
// int __cdecl OSObject::OSObject(_QWORD); weak
// _QWORD __cdecl OSObject::~OSObject(OSObject *__hidden this); idb
// void __cdecl OSObject::operator delete(void *); idb
// _QWORD __cdecl OSObject::operator new(OSObject *__hidden this, unsigned __int64); idb
// _QWORD __cdecl IOService::serviceMatching(IOService *__hidden this, const char *, OSDictionary *); idb
// int __fastcall IOService::addMatchingNotification(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); weak
// _QWORD __cdecl IOService::registerInterestedDriver(IOService *__hidden this, IOService *); idb
// _QWORD __cdecl IOService::deRegisterInterestedDriver(IOService *__hidden this, IOService *); idb
// int __cdecl IOService::IOService(_QWORD); weak
// _QWORD __cdecl IOService::~IOService(IOService *__hidden this); idb
// _QWORD OSMetaClass::getClassName(OSMetaClass *__hidden this); idb
// _QWORD __cdecl OSMetaClass::reservedCalled(OSMetaClass *__hidden this, int); idb
// _QWORD OSMetaClass::instanceConstructed(OSMetaClass *__hidden this); idb
// _QWORD IONetworkController::getCurrentMedium(IONetworkController *__hidden this); idb
// int __fastcall __bzero(_QWORD, _QWORD); weak
// int __fastcall absolutetime_to_nanoseconds(_QWORD, _QWORD); weak
// int __fastcall aes_decrypt(_QWORD, _QWORD, _QWORD); weak
// int __fastcall aes_decrypt_key(_QWORD, _QWORD, _QWORD); weak
// int __fastcall assert_wait(_QWORD, _QWORD); weak
// void __cdecl bcopy(const void *, void *, size_t);
// int __fastcall bpf_attach(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall bpf_tap_in(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall bpf_tap_out(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall bpfattach(_QWORD, _QWORD, _QWORD); weak
// void __cdecl bzero(void *, size_t);
// int __fastcall cc_clear(_QWORD, _QWORD); weak
// int __fastcall ccdigest_init(_QWORD, _QWORD); weak
// int __fastcall ccdigest_update(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int ccsha256_di(void); weak
// int __fastcall cdevsw_add(_QWORD, _QWORD); weak
// int __fastcall cdevsw_remove(_QWORD, _QWORD); weak
// int __fastcall clock_get_calendar_nanotime(_QWORD, _QWORD); weak
// int __fastcall clock_get_system_nanotime(_QWORD, _QWORD); weak
// int __fastcall clock_interval_to_deadline(_QWORD, _QWORD, _QWORD); weak
// int __fastcall copyin(_QWORD, _QWORD, _QWORD); weak
// int __fastcall copyout(_QWORD, _QWORD, _QWORD); weak
// int __fastcall current_thread(_QWORD, _QWORD); weak
// void *devfs_make_node(dev_t dev, int chrblk, uid_t uid, gid_t gid, int perms, const char *fmt, ...);
// void *devfs_make_node_clone(dev_t dev, int chrblk, uid_t uid, gid_t gid, int perms, int (__cdecl *clone)(dev_t dev, int action), const char *fmt, ...);
// void __cdecl devfs_remove(void *handle);
// int __fastcall ifmaddr_release(_QWORD); weak
// int __fastcall ifnet_add_multicast(_QWORD, _QWORD, _QWORD); weak
// int __fastcall ifnet_allocate_extended(_QWORD, _QWORD); weak
// int __fastcall ifnet_attach(_QWORD, _QWORD); weak
// int __fastcall ifnet_dequeue_service_class_multi(_QWORD, _QWORD, _QWORD); weak
// int __fastcall ifnet_detach(_QWORD); weak
// int __fastcall ifnet_enqueue(_QWORD, _QWORD); weak
// int __fastcall ifnet_event(_QWORD, _QWORD); weak
// int __fastcall ifnet_family(_QWORD, _QWORD); weak
// int __fastcall ifnet_flags(_QWORD); weak
// int __fastcall ifnet_get_sndq_len(_QWORD, _QWORD); weak
// int __fastcall ifnet_index(_QWORD); weak
// int __fastcall ifnet_input(_QWORD, _QWORD, _QWORD); weak
// int __fastcall ifnet_lladdr(_QWORD); weak
// int __fastcall ifnet_name(_QWORD); weak
// int __fastcall ifnet_notice_master_elected(_QWORD); weak
// int __fastcall ifnet_notice_node_absence(_QWORD, _QWORD); weak
// int __fastcall ifnet_notice_node_presence(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall ifnet_reference(_QWORD); weak
// int __fastcall ifnet_release(_QWORD); weak
// int __cdecl ifnet_remove_multicast(_QWORD); weak
// int __fastcall ifnet_set_addrlen(_QWORD, _QWORD); weak
// int __fastcall ifnet_set_baudrate(_QWORD, _QWORD); weak
// int __fastcall ifnet_set_eflags(_QWORD, _QWORD, _QWORD); weak
// int __fastcall ifnet_set_flags(_QWORD, _QWORD, _QWORD); weak
// int __fastcall ifnet_set_hdrlen(_QWORD, _QWORD); weak
// int __fastcall ifnet_set_link_quality(_QWORD, _QWORD); weak
// int __fastcall ifnet_set_mtu(_QWORD, _QWORD); weak
// int __fastcall ifnet_softc(_QWORD); weak
// int __fastcall ifnet_stat_increment_out(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall ifnet_tx_compl_status(_QWORD, _QWORD); weak
// int __fastcall ifnet_type(_QWORD, _QWORD); weak
// int __fastcall ifnet_unit(_QWORD); weak
// int __fastcall kalloc(_QWORD); weak
// int __fastcall kev_post_msg(_QWORD); weak
// int __fastcall kfree(_QWORD, _QWORD); weak
// int __fastcall kprintf(_QWORD, _QWORD, _QWORD); weak
// uint64_t mach_absolute_time(void);
// int __fastcall mbuf_adj(_QWORD, _QWORD); weak
// int __fastcall mbuf_allocpacket(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall mbuf_copydata(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall mbuf_data(_QWORD); weak
// int __fastcall mbuf_datastart(_QWORD); weak
// int __fastcall mbuf_dup(_QWORD, _QWORD, _QWORD); weak
// int __fastcall mbuf_flags(_QWORD, _QWORD); weak
// int __fastcall mbuf_free(_QWORD, _QWORD); weak
// int __cdecl mbuf_freem(_QWORD); weak
// int __fastcall mbuf_freem_list(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall mbuf_get_traffic_class(_QWORD); weak
// int __fastcall mbuf_inet_cksum(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall mbuf_leadingspace(_QWORD, _QWORD); weak
// int __fastcall mbuf_len(_QWORD); weak
// int __fastcall mbuf_maxlen(_QWORD); weak
// int __fastcall mbuf_next(_QWORD, _QWORD); weak
// int __fastcall mbuf_nextpkt(_QWORD); weak
// int __fastcall mbuf_pkthdr_len(_QWORD); weak
// int __fastcall mbuf_pkthdr_rcvif(_QWORD, _QWORD, _QWORD); weak
// int __fastcall mbuf_pkthdr_setheader(_QWORD, _QWORD); weak
// int __fastcall mbuf_pkthdr_setlen(_QWORD, _QWORD); weak
// int __fastcall mbuf_pkthdr_setrcvif(_QWORD, _QWORD, _QWORD); weak
// int __fastcall mbuf_pullup(_QWORD, _QWORD); weak
// int __fastcall mbuf_set_traffic_class(_QWORD, _QWORD); weak
// int __fastcall mbuf_setdata(_QWORD, _QWORD, _QWORD); weak
// int __fastcall mbuf_setflags_mask(_QWORD, _QWORD, _QWORD); weak
// int __fastcall mbuf_setlen(_QWORD, _QWORD); weak
// int __fastcall mbuf_setnext(_QWORD, _QWORD); weak
// int __fastcall mbuf_setnextpkt(_QWORD, _QWORD); weak
// int __fastcall mbuf_type(_QWORD); weak
// int __cdecl memcmp(const void *, const void *, size_t);
// void *__cdecl memcpy(void *, const void *, size_t);
// void *__cdecl memmove(void *, const void *, size_t);
// void *__cdecl memset(void *, int, size_t);
// void panic(const char *, ...);
// int __fastcall proc_is64bit(_QWORD); weak
// int __fastcall proc_pid(_QWORD, _QWORD); weak
// int __fastcall proc_rele(_QWORD); weak
// int __fastcall proc_self(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall proc_selfname(_QWORD, _QWORD); weak
// int __fastcall proc_selfpid(_QWORD, _QWORD); weak
// int __fastcall proc_suser(_QWORD); weak
// __int64 random(void);
// void __cdecl read_random(void *buffer, u_int numBytes);
// int __fastcall registerPrioritySleepWakeInterest(_QWORD, _QWORD, _QWORD); weak
// int __fastcall selrecord(_QWORD, _QWORD, _QWORD); weak
// int __fastcall selthreadclear(_QWORD); weak
// int __fastcall selwakeup(_QWORD); weak
// int snprintf(char *, size_t, const char *, ...);
// char *__cdecl strchr(const char *, int);
// size_t __cdecl strlcpy(char *, const char *, size_t);
// size_t __cdecl strlen(const char *);
// int __cdecl strncasecmp(const char *, const char *, size_t);
// char *__cdecl strncat(char *, const char *, size_t);
// int __cdecl strncmp(const char *, const char *, size_t);
// char *__cdecl strncpy(char *, const char *, size_t);
// size_t __cdecl strnlen(const char *, size_t);
// int __fastcall thread_block(_QWORD); weak
// int __fastcall thread_call_allocate(_QWORD, _QWORD); weak
// int __fastcall thread_call_cancel(_QWORD, _QWORD); weak
// int __fastcall thread_call_enter(_QWORD); weak
// int __fastcall thread_call_enter1(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall thread_call_free(_QWORD, _QWORD); weak
// int __fastcall thread_wakeup_prim(_QWORD, _QWORD, _QWORD); weak
// int __fastcall uio_resid(_QWORD); weak
// int __fastcall uiomove(_QWORD, _QWORD, _QWORD); weak
// int __cdecl vsnprintf(char *, size_t, const char *, va_list);

//-------------------------------------------------------------------------
// Data declarations

int dword_0 = 4277009103; // weak
int dword_4 = 16777223; // weak
int dword_8 = 3; // weak
int dword_10 = 8; // weak
int dword_14 = 1176; // weak
segment_command_64 stru_20 = { 25u, 312u, "__TEXT", 0uLL, 503808uLL, 0uLL, 503808uLL, 7, 5, 3u, 0u }; // weak
section_64 stru_68 =
{
  {
    '_',
    '_',
    't',
    'e',
    'x',
    't',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0'
  },
  "__TEXT",
  5072uLL,
  413383uLL,
  5072u,
  4u,
  0u,
  0u,
  2147484672u,
  0u,
  0u,
  0u
}; // weak
section_64 stru_108 =
{
  {
    '_',
    '_',
    'c',
    'o',
    'n',
    's',
    't',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0'
  },
  "__TEXT",
  488960uLL,
  14848uLL,
  488960u,
  4u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u
}; // weak
segment_command_64 stru_158 = { 25u, 632u, "__DATA", 503808uLL, 40960uLL, 503808uLL, 40960uLL, 7, 3, 7u, 0u }; // weak
section_64 stru_240 =
{
  {
    '_',
    '_',
    'm',
    'o',
    'd',
    '_',
    't',
    'e',
    'r',
    'm',
    '_',
    'f',
    'u',
    'n',
    'c',
    '\0'
  },
  "__DATA",
  504192uLL,
  208uLL,
  504192u,
  3u,
  0u,
  0u,
  10u,
  0u,
  0u,
  0u
}; // weak
segment_command_64 stru_3D0 =
{
  25u,
  72u,
  "__LINKEDIT",
  544768uLL,
  274432uLL,
  544768uLL,
  272096uLL,
  7,
  1,
  0u,
  0u
}; // weak
uuid_command stru_480 =
{
  27u,
  24u,
  {
    234u,
    78u,
    12u,
    183u,
    96u,
    222u,
    48u,
    70u,
    163u,
    108u,
    168u,
    55u,
    130u,
    78u,
    46u,
    206u
  }
}; // weak
__int64 qword_4B8[483] =
{
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL
}; // weak
_UNKNOWN loc_213D; // weak
char byte_690F5 = '\0'; // weak
ether_addr stru_6F47B = { { 37u, 115u, 58u, 37u, 115u, 32u } }; // idb
_QWORD _wpaOUIAndType = 140262499364786176LL; // weak
_QWORD _wpaSuiteWEP40 = 428492875516497920LL; // weak
_QWORD _wpaSuiteWEP104 = 212320093469822976LL; // weak
_QWORD _wpaSuiteTKIP = 356435281495347200LL; // weak
_QWORD _wpaSuiteCCMP = 140262499415117824LL; // weak
_QWORD _wpaAuth8021xUnspec = 212320093402714112LL; // weak
_QWORD _wpaAuthPSK = 120487782756012032LL; // weak
_QWORD _rsnSuiteWEP40 = 408718158886342400LL; // weak
_QWORD _rsnSuiteWEP104 = 192545376839667456LL; // weak
_QWORD _rsnSuiteTKIP = 336660564865191680LL; // weak
_QWORD _rsnSuiteCCMP = 120487782784962304LL; // weak
_QWORD _rsnAuth8021xUnspec = 192545376772558592LL; // weak
_QWORD _rsnAuthPSK = 408718158903119616LL; // weak
_QWORD _rsnAuthSHA256_IEEE8021X = 480775752991379200LL; // weak
_QWORD _rsnAuthSHA256_PSK = 4406906624LL; // weak
_QWORD RSN_KEY_DATA_PMKID = 140262499410513664LL; // weak
_QWORD WPA_OUI_TYPE = 120487782739234816LL; // weak
_QWORD RSN_KEY_DATA_GROUPKEY = 696948535038054144LL; // weak
_QWORD RSN_KEY_DATA_GROUPKEY_BIP = 4457238272LL; // weak
__int64 rsn_pmkid(unsigned char *,unsigned char *,unsigned char *,unsigned char *)::len[3] = { 8LL, 6LL, 6LL }; // weak
__int64 qword_77698 = 55834574853LL; // weak
int dword_77E94 = 236212736; // weak
int null_address = 0; // weak
_QWORD bcast_address = 281474976710655LL; // weak
__int64 Te4[128] =
{
  8970181431500432227LL,
  8897841259016058743LL,
  7740398495948010226LL,
  -4195730026056945809LL,
  72340173629698096LL,
  3110627433047877479LL,
  -2893606912866189570LL,
  8536140395785726891LL,
  -9042521603546887478LL,
  9042521606039652809LL,
  6438275385300548346LL,
  -1085102595417618617LL,
  -3110627432694174291LL,
  -5787213827265092958LL,
  -6582955728399721316LL,
  -4557430890112585102LL,
  -144680346855163977LL,
  2748926569682801555LL,
  4557430888647243318LL,
  -3689348814017660937LL,
  -6510615557330160588LL,
  -1012762419935189531LL,
  -2821266742419820175LL,
  1519143630071214385LL,
  -4051049682216680444LL,
  -4340410372979481821LL,
  -7595718150120269800LL,
  -7306357459155352315LL,
  1302123110900107015LL,
  -2097865013954838400LL,
  2821266743986220011LL,
  8463800223082394290LL,
  -8970181433976354551LL,
  1880844494093167660LL,
  7957419010790464283LL,
  -6872316420796294566LL,
  4268070197833912914LL,
  -5497853135104321834LL,
  -2025524842598946519LL,
  -8897841260515086545LL,
  -3327647952673746093LL,
  -1302123115077173248LL,
  -217020522219692000LL,
  6582955729713476017LL,
  -3761688989213758870LL,
  4123389854010490558LL,
  5497853135660141130LL,
  -3472328298231998376LL,
  -1157442765931360048LL,
  -289360692716590422LL,
  5570193308363473731LL,
  -8825501087626480845LL,
  -434041040060201659LL,
  9187201948330361346LL,
  4340410370621460560LL,
  -6293595037064257633LL,
  -6655295902484180655LL,
  -8102099359195185088LL,
  -7089336938316787054LL,
  -723401731564095432LL,
  -5280832617078539076LL,
  2387225706772486874LL,
  -4025479152LL,
  -3255307777157630989LL,
  868082077307620813LL,
  -1374463287578389741LL,
  -7523377976103182497LL,
  1663823976033698884LL,
  -6365935209262299964LL,
  4412750544217472638LL,
  6727636074059031652LL,
  8319119874862946585LL,
  -9114861778153480096LL,
  -2531906051707547825LL,
  3038287259064476194LL,
  -8608480567596380016LL,
  -1229782941076928954LL,
  1446803459523786936LL,
  6799976248935112414LL,
  -2604246225674106101LL,
  3617008644834517216LL,
  723401729189231162LL,
  434041038156941641LL,
  6655295900159845412LL,
  -3182967605161704766LL,
  7089336939377896620LL,
  -7668058320903499375LL,
  8753160915209479396LL,
  -3978709505572083737LL,
  7885078838440834871LL,
  -3038287260411916915LL,
  -6221254865607307698LL,
  6221254864445140076LL,
  -1519143629431180044LL,
  8825501085891650917LL,
  578721385500552878LL,
  8680820741680839354LL,
  3327647950399939877LL,
  -6438275384913159140LL,
  -4123389852073544524LL,
  -2459565876309333784LL,
  2242545359412032628LL,
  -4774451409233163445LL,
  -8463800222038127733LL,
  4485090716802904176LL,
  7378697630814418357LL,
  217020519676397640LL,
  1012762423640651510LL,
  3834029161159156065LL,
  -5063812100315981993LL,
  -4485090716954491258LL,
  -7016996767466185443LL,
  -506381210253925919LL,
  1229782940521109656LL,
  -2748926569733330583LL,
  -7740398493775262066LL,
  2170205187247676315LL,
  -1591483804088301689LL,
  6148914693274521294LL,
  -2314885533900724184LL,
  -6799976247132910452LL,
  940422248983529865LL,
  -1808504321608794177LL,
  7523377974519939650LL,
  -7378697630966005439LL,
  1085102593076440365LL,
  6076574519947997360LL,
  1591483805216783291LL
}; // weak
__int64 rcon[6] =
{
  144115188092633088LL,
  576460752370532352LL,
  2305843009482129408LL,
  -9223372035781033984LL,
  3891110078501093376LL,
  0LL
}; // weak
__int64 Td0[128] =
{
  9097664130796791632LL,
  4190421977067398339LL,
  2278053888909863883LL,
  5468218305355077803LL,
  -5947445354026698155LL,
  -791986860371183983LL,
  -4239351973597030404LL,
  -5376555169910274944LL,
  2718515458003262025LL,
  6773062963384946328LL,
  -9129658381212093182LL,
  7769828413313292195LL,
  1554476985220030439LL,
  -7686982817918649621LL,
  6373756566327165741LL,
  -8157769054382167767LL,
  -824588123483502230LL,
  2862444234745069163LL,
  -1114450590275907658LL,
  9065247648086273126LL,
  -1938182253538489832LL,
  7085146575652074336LL,
  -4941664281173919776LL,
  -502103439526748132LL,
  -8122808067193018280LL,
  5943617600605809799LL,
  8235679516139442979LL,
  7373988165576527703LL,
  3437867211709687815LL,
  -3227101100963955814LL,
  2575959696609937394LL,
  -1362758505550615878LL,
  -6378868855706543061LL,
  5650296392707994352LL,
  433962762857280717LL,
  -4276450923972894177LL,
  -6704921273665956963LL,
  -6559796919381860046LL,
  4638971129808284729LL,
  -4796878611440099578LL,
  -7575892138062148871LL,
  5613382097621091758LL,
  8197779500215602613LL,
  6940071210806334575LL,
  -2972963343815869660LL,
  7483186492093776844LL,
  543118649274679997LL,
  8775526502173858616LL,
  8953736505277024839LL,
  4169408201LL,
  3615244019547801219LL,
  7807678583837651116LL,
  1118362028735397883LL,
  3903839292701463838LL,
  7520068138634828132LL,
  2609323863357215953LL,
  -7829535375347783759LL,
  1989343771240601298LL,
  7051546998872261967LL,
  2022707865952144233LL,
  -4566602855316473334LL,
  1304661931384299587LL,
  -969461748689466101LL,
  1449782807285377209LL,
  -5803724520322688635LL,
  -6665502279738991173LL,
  6661656990781089439LL,
  6628030039556766661LL,
  -3808982209293768330LL,
  -5123705065467675544LL,
  4783813536573938890LL,
  -8879390785849056704LL,
  -3261945367502379907LL,
  -4095564893657681391LL,
  -2543917018778816693LL,
  8629428843738190572LL,
  -6237281416393845140LL,
  5181782943753062650LL,
  -6849905649493701436LL,
  2464472778724420824LL,
  -2794252939654771001LL,
  -7434304755963616514LL,
  -6522656844111576625LL,
  4588534310125407782LL,
  5798545105513782756LL,
  6088381134756891803LL,
  -8009448626570062910LL,
  -9024175760742942882LL,
  7624756332597182654LL,
  -3520386971835486807LL,
  1159815063627667771LL,
  -2649317814919470226LL,
  7951414056792258569LL,
  -8984792681266104575LL,
  -6124923535491764635LL,
  -1218812049027707128LL,
  5363565942748453849LL,
  3004038213957257684LL,
  3044190567318991535LL,
  3864764408389801008LL,
  -251415812914627529LL,
  3722181205518504112LL,
  4750412465404418122LL,
  1698409218363445262LL,
  4895325166718801549LL,
  -1975386027297452716LL,
  5506363146623890915LL,
  5072550164446322616LL,
  111522766965893636LL,
  -357120075418340237LL,
  -7864461071633408678LL,
  7914591545990338099LL,
  4008498864059801996LL,
  -1507794889621367666LL,
  -5232680059090163730LL,
  8811206071006586349LL,
  6193139154639052633LL,
  8342698128609431161LL,
  6916871911938444778LL,
  8666292955285122836LL,
  -5086600005147430015LL,
  -4421619631439727572LL,
  -4836262316001606798LL,
  -68234312260236917LL,
  580036219055374705LL,
  7230179079645095068LL,
  -3084202200565840799LL,
  -3406877175911261068LL
}; // weak
__int64 Td1[128] =
{
  6016318055608612007LL,
  -7621736131417466972LL,
  -1071965263202899093LL,
  -7832917521976198568LL,
  -671750557456649990LL,
  2735094876579875958LL,
  -2898863729543223849LL,
  -8091452701132049084LL,
  7432551386411086170LL,
  -2207328139199780338LL,
  1333431558400585589LL,
  -4148989562547517801LL,
  -7704090384959041697LL,
  -2696158255750615686LL,
  -3217694247904559485LL,
  4940107702795362409LL,
  8715747830997041801LL,
  -2510834370448107458LL,
  1725028936959582543LL,
  -5440966024565808980LL,
  -9014770280947261622LL,
  4999650342881153331LL,
  -8882387441219967881LL,
  -7712123905632206432LL,
  1841767727030618216LL,
  -5236987109321679252LL,
  -2129557201232366637LL,
  3055223591619731343LL,
  229601950976633640LL,
  -6497789327273704069LL,
  -5610429991319754617LL,
  6696032971692049258LL,
  -7879195208329801956LL,
  -6823399961993738254LL,
  -3096781376722707724LL,
  -8447443390654499742LL,
  -6871662532378743213LL,
  8477171888635087585LL,
  -6178832108181814292LL,
  5889984902775861663LL,
  4437977504841343370LL,
  5065958858218618373LL,
  392310549315146893LL,
  -44947943286634796LL,
  -7505602919935665925LL,
  8604084889174229059LL,
  -8644789726438430654LL,
  -2631851581738903205LL,
  -1622349132366513142LL,
  3388507166LL,
  5202268818672025734LL,
  5650991081003553136LL,
  6201321691704790783LL,
  2825495539565309653LL,
  2407275870542237657LL,
  4189533128074419028LL,
  1122337384764803687LL,
  -7053873340738113898LL,
  -6745868735493390139LL,
  1593168272828299083LL,
  -1891335741063916614LL,
  2094766563406914272LL,
  -5912509673783817971LL,
  -4029562052284664152LL,
  5525763942969241881LL,
  -170152307463382563LL,
  -4873894297445400282LL,
  3772885634746967611LL,
  -2536894629793807575LL,
  7185744930964696572LL,
  1171608279354651100LL,
  2343215483531269922LL,
  -517145134420899292LL,
  7910337042262718770LL,
  -874628307128312273LL,
  -3425055806929926574LL,
  -7374238973156412650LL,
  2470199540537463880LL,
  1918797597932846220LL,
  -1215352252238758612LL,
  -4478485880796395186LL,
  3934127422488496802LL,
  2928882230059529601LL,
  -6611374691454371954LL,
  959399292918577821LL,
  7085426955480883148LL,
  -1688611572207416045LL,
  -755826629478041097LL,
  8964925866234568064LL,
  -5490128658659027667LL,
  -6408595343595230055LL,
  8924792762770431075LL,
  -833630921238436232LL,
  -6304107530512721225LL,
  9127388959836902766LL,
  -1806200839239254833LL,
  -3581928272247986277LL,
  -3014684425353257207LL,
  3542713479375987890LL,
  -4596589284873034348LL,
  -6414107964257055044LL,
  1527749247731011792LL,
  -629962050550823784LL,
  3393341330238197072LL,
  5567557105926688214LL,
  -2313559363214857651LL,
  1967064273420997045LL,
  9171129092853017631LL,
  6701791879842586346LL,
  3385311920645638004LL,
  5950059754221168413LL,
  1400010660484026454LL,
  8806684671616931681LL,
  -8508685920179193836LL,
  3870669924671072551LL,
  4357874418960112869LL,
  4563820374648476383LL,
  -4651154949074840370LL,
  6584260090756593613LL,
  -8757173767683228305LL,
  4519758894243426291LL,
  6900257075100132404LL,
  917857074532457923LL,
  4755534667462491209LL,
  -2447692432637581311LL,
  -8042207645016738588LL,
  8130460461188238212LL,
  4814550687411629148LL
}; // weak
__int64 Td2[128] =
{
  7301318241342738932LL,
  6815699028014209559LL,
  5039844218983103403LL,
  257633043507555578LL,
  7923711320922595376LL,
  5487061111948806348LL,
  -3758318576214454299LL,
  -6660905890197002699LL,
  1974588443934187185LL,
  -4548250802919553558LL,
  -1147712789645442257LL,
  -448552556350436026LL,
  -7163795913844522097LL,
  6474651595780636525LL,
  2437389080777839806LL,
  -4015927972003755552LL,
  8753014768822547906LL,
  8204757772708583768LL,
  -5974041912440078623LL,
  4230144276616890656LL,
  3567665755905876959LL,
  9170844325693658961LL,
  -5871361943937175196LL,
  3140408655625387649LL,
  -208978379429875640LL,
  -524860141510093602LL,
  207854202802908019LL,
  -6112961026538872033LL,
  -4466673950314220821LL,
  623136358711068357LL,
  -6507099206070423512LL,
  -9053100470385901053LL,
  -5435097661677270321LL,
  -2116324132933012729LL,
  -4695840413812169254LL,
  -105055422399917772LL,
  6170110655461143598LL,
  -1480095522274278006LL,
  -1177057567579763837LL,
  1175929260532457073LL,
  449681416070446625LL,
  -4808069901838262978LL,
  6702888709415866708LL,
  1585091494135399430LL,
  -1614585829938423400LL,
  -7028034510645327552LL,
  -8392449619493277464LL,
  -1235259771352193255LL,
  1146584203224654204LL,
  516552836LL,
  -1348772925875746432LL,
  8236639904200400401LL,
  4059449182320852238LL,
  4118319954730565038LL,
  -6475780041188570609LL,
  3331014690163759963LL,
  -1797055722686444534LL,
  -7953889536825445138LL,
  2351549556271841472LL,
  1879720759373945463LL,
  3091088515808289427LL,
  1665507348132871202LL,
  -4058321010157744631LL,
  -6212693564045316682LL,
  525988173969709041LL,
  6988921966325132953LL,
  -739614593451559167LL,
  9093994682165576806LL,
  -4117192607443547325LL,
  -1052794594247788819LL,
  -8858507470364289231LL,
  1234132284412531607LL,
  4465550731750769994LL,
  -6814571681394086151LL,
  3527405591016971678LL,
  -2030991759740498554LL,
  -5072837206378533965LL,
  7215408620278256020LL,
  4547123728798230780LL,
  -8003140409623030147LL,
  -3332143413414361271LL,
  808001222194662602LL,
  -2438517252638660875LL,
  -4637511701637965129LL,
  -7922587690499560390LL,
  5071709033947949663LL,
  -5122685318415059315LL,
  -5767559969597673927LL,
  -7819258508787933347LL,
  1347648472100728789LL,
  9054223273687763116LL,
  -4937111518363850596LL,
  1798183481772723494LL,
  -7302442417385247590LL,
  -1837843583875029355LL,
  -1664380135320051268LL,
  3949175766467066599LL,
  8995423141775075999LL,
  2535854518255432100LL,
  7403976759784294053LL,
  -3844107593480440754LL,
  -2876335991152385904LL,
  -2668591769770594044LL,
  -707320703593054259LL,
  -5742859252451674547LL,
  351250630151818410LL,
  -8639227438978326831LL,
  5872489839252259116LL,
  3845231361577491806LL,
  4696967488010975879LL,
  -3291406907866434713LL,
  5121557968587057424LL,
  899092241879702231LL,
  4362276181266815480LL,
  -3948047870410699095LL,
  -5675526981174828772LL,
  8304450739512122578LL,
  4017056694637500436LL,
  -6171233320695081993LL,
  -2628281097207357635LL,
  -4305800333306508625LL,
  4638640147425671204LL,
  2669716361251526173LL,
  -7691586256038582212LL,
  -5485938448433858136LL,
  -4498985703377676108LL,
  -5300502348469011509LL,
  6287817520006318188LL
}; // weak
__int64 Td3[128] =
{
  4712264389848682577LL,
  2836869991538934554LL,
  -7114014918039581893LL,
  -2088663847637832788LL,
  8533748092648445216LL,
  165549023933403528LL,
  3083795614829902927LL,
  7107682645366308902LL,
  -5036318346696832546LL,
  -89824199072376763LL,
  5543951487349359299LL,
  -3172286298457660531LL,
  -7882261327972931837LL,
  5934014319359093695LL,
  8368201960737942996LL,
  -3906797296302872247LL,
  -8180374255510656395LL,
  -5084039343270630503LL,
  -8598189790240721218LL,
  -3586355703735097655LL,
  1887433642650245219LL,
  6016603915761705111LL,
  7759285148385271985LL,
  588727975644503294LL,
  5043215260910639216LL,
  8933091427436234644LL,
  5405131483995382699LL,
  6173074332345915363LL,
  -5349709903019112526LL,
  3965601800869616262LL,
  -4637104377234460112LL,
  1621960988841130498LL,
  8769795623829121930LL,
  7629838075231924467LL,
  414002441184660837LL,
  -6413536244031938607LL,
  -912646731050279628LL,
  -654299971287174651LL,
  6984988741142853899LL,
  7930928817896359518LL,
  -2520259226450069186LL,
  -1820221376820826403LL,
  -4297272485133568623LL,
  5770799285441687300LL,
  -4762108183022197735LL,
  -2765641835815383927LL,
  -8535579101207806544LL,
  -3967992908503893785LL,
  4760280052020168609LL,
  2216610296LL,
  3165265494853190409LL,
  6517357836814560286LL,
  -8847226845293184003LL,
  3258678921194184253LL,
  6676060228449559562LL,
  3904121854802317723LL,
  6334048525129068812LL,
  -7236829283403509068LL,
  -2584887645380980864LL,
  1304379353593506138LL,
  -6905454463344309534LL,
  1952060927220138812LL,
  -8374533727026607346LL,
  2209517083491350829LL,
  8432793145822512471LL,
  9178614919684013038LL,
  8283734192960217079LL,
  -324764555962235580LL,
  2577990602279450251LL,
  -1949667517756839754LL,
  7171155858147822295LL,
  -4174519625752362989LL,
  -4954530432966951547LL,
  2999799532452188590LL,
  -5606713407204013283LL,
  -4475504392902874099LL,
  8122692357072514091LL,
  -1629139474375443951LL,
  -1135159302339902296LL,
  3715732623988676694LL,
  4094266675238455175LL,
  -3167377883062403444LL,
  8853558610710613926LL,
  -5926837991026841894LL,
  8688021269383078956LL,
  9099068211672685418LL,
  -2830256658262539530LL,
  -4345985175722172882LL,
  -3417250900261945697LL,
  2671395234200267119LL,
  1764750319056141256LL,
  4304170052034457320LL,
  6420150022745622989LL,
  5736082358599614956LL,
  -7179078277896730LL,
  1578765586732615713LL,
  8013819408061028794LL,
  -5729469151671888662LL,
  4549534107795894065LL,
  -6744492055296986938LL,
  -9022215300900440204LL,
  -6352303963188973344LL,
  -1379518477213611279LL,
  -7929098314663850369LL,
  -1175354551279645322LL,
  -7636732894910786356LL,
  7676415581602833310LL,
  7300756410308999361LL,
  -8343660474165230435LL,
  810981065747624954LL,
  -2606930445545416013LL,
  -3006412867100068887LL,
  -6841959353627341670LL,
  1386134431895686745LL,
  7046222154931105486LL,
  5165976742739176929LL,
  -976367056366642788LL,
  -4091591235451586280LL,
  -168221568335484333LL,
  4961707265463620831LL,
  7549227842621637066LL,
  -6683236559582122952LL,
  -2151299244906810858LL,
  978761058506869544LL,
  915319278046114105LL,
  6251436519972969688LL,
  3654232211202531707LL,
  -5163584984818355128LL
}; // weak
__int64 Te0[128] =
{
  -541420945485372507LL,
  -685818668722456679LL,
  -2996182663297830387LL,
  -7942725399498231887LL,
  144397777062867024LL,
  6209104330594150313LL,
  -5343565613052789223LL,
  -1407807428406563866LL,
  2270520775382059589LL,
  -397023171052975808LL,
  -5595342192152741355LL,
  -292470043356739639LL,
  -5488528505909170708LL,
  5021425530703094525LL,
  6027123582689909951LL,
  -7223562301395012970LL,
  -2162293947392084030LL,
  5487115433738998702LL,
  9097059322532607578LL,
  -8949553715690866942LL,
  5883290957368276060LL,
  -436302668694690508LL,
  -6063858906022448749LL,
  3032353286078411091LL,
  -7653929886557142004LL,
  -7078599379625237659LL,
  4005554537633421352LL,
  3430224168543913231LL,
  2599159958319073033LL,
  -2314038506432724837LL,
  5631513194429934374LL,
  -1552205168656600371LL,
  2126688163979659547LL,
  3754342025716837492LL,
  -2562989426236253395LL,
  6602454056648202990LL,
  8519468324756804342LL,
  9057780976001144417LL,
  -2457871114808252037LL,
  1406394769301516145LL,
  -5057030659163073547LL,
  -4472658081674690560LL,
  -2018461321818791840LL,
  -5306546660418932280LL,
  -8229260389017556290LL,
  8230672790022176473LL,
  -7472513205809820962LL,
  -8804590826792920856LL,
  -4183862561985212309LL,
  -1298167994321818907LL,
  -7328115430596066363LL,
  1262562142963577685LL,
  -1586963544236800561LL,
  -108227673938853370LL,
  8663866048599052528LL,
  5451793042474246074LL,
  6747416980771394035LL,
  400696716879216832LL,
  2422265606441177773LL,
  -1011633141863401400LL,
  8626283077993020639LL,
  4765126592770529909LL,
  -1873498432290680784LL,
  -4624402497502186738LL,
  1732773238847425868LL,
  -4328825454563486923LL,
  3861721930727907297LL,
  3321148786075780300LL,
  6172086474637624407LL,
  8808263825594678914LL,
  -5017751159740013396LL,
  -1841000738036573909LL,
  1837892616006426784LL,
  -6639189309975998511LL,
  6064706570005127782LL,
  831064228471279787LL,
  -4040029953490270518LL,
  2887955510789191891LL,
  -4873353419196277127LL,
  -5918895985025938659LL,
  7219888501265850427LL,
  1443977756440934990LL,
  866386620789115355LL,
  -5162148937340803988LL,
  -4768235108375018915LL,
  -4295762628318548753LL,
  3572926411961373096LL,
  -974614202886593481LL,
  -8374223313418328270LL,
  -2707387166384244903LL,
  -5632361133457437300LL,
  5307960417992986322LL,
  -6028535415816033100LL,
  -3464699514580569081LL,
  -830216427596847697LL,
  1155182204795399913LL,
  -1119011980016174379LL,
  6642297568823158127LL,
  6315919082392394788LL,
  -7510097275457850169LL,
  -6783021935683377117LL,
  4476330785123890332LL,
  7042994147389295581LL,
  1119859761417522054LL,
  8952661566213353616LL,
  -3718171560109558332LL,
  433193311588075736LL,
  2021568757368288769LL,
  7653081827185353123LL,
  7618324550603200505LL,
  -7367394931305445743LL,
  2854893732180598055LL,
  -1443130916428717768LL,
  2454762183366056115LL,
  -6207691532763829829LL,
  3716759037594734217LL,
  4331933023719889846LL,
  -3897327678503024750LL,
  -6172933158257897911LL,
  -6494226421221152648LL,
  6458621427209505935LL,
  1877171012278782336LL,
  -2889369011076743206LL,
  -3429375974540426554LL,
  2997596010370384323LL,
  2165966512990268791LL,
  -6317330933910294325LL,
  3176751027361397718LL
}; // weak
__int64 Te1[128] =
{
  -8865198991679790237LL,
  -8217244699297155209LL,
  -4767505047984540942LL,
  6093869223692365679LL,
  216736837222281264LL,
  9031453569270572903LL,
  7112828505354141438LL,
  -7283316244322866261LL,
  -7124832589452424502LL,
  -8648462157504460343LL,
  -1463008689786979590LL,
  863548670535944007LL,
  7472550217699667373LL,
  -1565652125036338526LL,
  -624974895785993060LL,
  6601081612239401586LL,
  2081223769152927671LL,
  7659539013824254867LL,
  4719279000863389238LL,
  5729648327540471799LL,
  -841709525703052236LL,
  646814039779960293LL,
  8334993960084861297LL,
  4551473554748748081LL,
  5950882140354249732LL,
  6817820654893933347LL,
  -6829824738220566504LL,
  -5390920242471238395LL,
  3901263045880317703LL,
  4458531619012837504LL,
  7588045471274101739LL,
  -6923592328309394766LL,
  -7053336842274207479LL,
  3329314725457046572LL,
  -5558446420598056165LL,
  -334497134248961446LL,
  5581713916899381842LL,
  -3567497746787608874LL,
  4530027366370650409LL,
  -7560553645052383441LL,
  7546293350335664979LL,
  3225120410337017856LL,
  2297958395765858336LL,
  -1317765391195721295LL,
  5083943630311549546LL,
  5436470620812983998LL,
  -3127666048173323702LL,
  5369926622578235480LL,
  3082133331588665552LL,
  1652253697617406634LL,
  -2910929212719873213LL,
  -7777288273782230221LL,
  1218780025504548165LL,
  -9079679615193841150LL,
  4933759624217120848LL,
  -2068374161215610977LL,
  -117758090679266991LL,
  -8501230874019217344LL,
  -4890454419805597038LL,
  356336279370086456LL,
  -4505932005612733252LL,
  7152315585809865434LL,
  1938236686142017552LL,
  7908271270322369523LL,
  1447920527162330573LL,
  3441855039489315603LL,
  -6758328987216355489LL,
  4120256100073751620LL,
  -984696606339906364LL,
  5150496458251468414LL,
  -1748982848367860636LL,
  -7645296378931701479LL,
  -7486810511779012512LL,
  9197437704988413775LL,
  9102947108415349282LL,
  -9003952909427437424LL,
  3010637585288283718LL,
  4334736721023056056LL,
  -2108706765655253282LL,
  8551733001578744587LL,
  6225155776266887392LL,
  2167368360054241850LL,
  723960266623174985LL,
  -1965719685323807708LL,
  7979767019532698306LL,
  -6429906190917718868LL,
  -6615341907625537135LL,
  -8362487996538952476LL,
  4867204584475846631LL,
  -5198722503426558153LL,
  7255815587824242061LL,
  -2285108789065789874LL,
  -383836937832076180LL,
  2724654590459114740LL,
  -8145751158652508827LL,
  1733894690904190638LL,
  -8579224829768516934LL,
  8240512195151668517LL,
  -1056192355092653028LL,
  5879386395607545012LL,
  8980703073811556584LL,
  2395386272444609652LL,
  -2566561689460389045LL,
  -8858709614455321717LL,
  4790772542054887536LL,
  -6139419600444344907LL,
  361980135103023176LL,
  1304933445355960054LL,
  6875366285631447393LL,
  -3429005432856881321LL,
  6384346983881475718LL,
  -5104937250501026531LL,
  1435514651237016033LL,
  3684526212860582040LL,
  8118259332494289257LL,
  -6398607279888298354LL,
  2466879813146483611LL,
  2362676668920072071LL,
  -24113023202898226LL,
  8837715994673686568LL,
  -551231764114994036LL,
  1664657363900664201LL,
  3591593107032227775LL,
  -5129485176358550974LL,
  -5752898163299958463LL,
  1233439907047419181LL,
  -240849856896454480LL,
  4191749640517696443LL
}; // weak
__int64 Te2[128] =
{
  8972569570760312419LL,
  8903043048529325687LL,
  7763597091767451634LL,
  -4227593873025540497LL,
  72904223096856624LL,
  3133755660142497383LL,
  -2926576868551694338LL,
  8546403237323230635LL,
  -9035030630835580982LL,
  9045473794751236553LL,
  6479468588420165626LL,
  -1149548270447915449LL,
  -3141344489035251283LL,
  -5770723351865761886LL,
  -6559682365772323940LL,
  -4585900544688200590LL,
  -208043002939935305LL,
  2768108649542729107LL,
  4558063107835587638LL,
  -3724613450471377417LL,
  -6488471393144117196LL,
  -1078337293427355163LL,
  -2849745193088589199LL,
  1530988668839486001LL,
  -4084037230072690684LL,
  -4368881127064779229LL,
  -7592726378980036584LL,
  -7298875282527679995LL,
  1312276001271123463LL,
  -2144311683645236352LL,
  2839886973389688299LL,
  8475750814966448050LL,
  -8962693759790018039LL,
  1886502580934432812LL,
  7976680255487030811LL,
  -6846778064208219046LL,
  4273201618611512402LL,
  -5490312684368709674LL,
  -2071974810820586967LL,
  -8892617480767185361LL,
  -3357229213496793517LL,
  -1356496164093952000LL,
  -279253979859238880LL,
  6624151131872852401LL,
  -3799193330831666070LL,
  4128519075755812798LL,
  5536217295386219594LL,
  -3509845833985511336LL,
  -1212939515838350384LL,
  -353833855542276182LL,
  5609121517553419843LL,
  -8821406506322401741LL,
  -499642301810767291LL,
  9187904536260772866LL,
  4342728141143318608LL,
  -6277090268017973857LL,
  -6629758645406817711LL,
  -8103658466674966464LL,
  -7080747553478852718LL,
  -791241598996811720LL,
  -5277805661565000772LL,
  2405839339112476634LL,
  -64486360992440304LL,
  -3283757640541340173LL,
  870347071252365773LL,
  -1427707138151209453LL,
  -7520389503490343329LL,
  1673419414018230340LL,
  -6344914745969634364LL,
  4415632364194167934LL,
  6766581875431229540LL,
  8328816467909489177LL,
  -9108502202894204832LL,
  -2558145896695882161LL,
  3061977336601003042LL,
  -8610025381431657584LL,
  -1285276392433742778LL,
  1458084448826518456LL,
  6837234299947296734LL,
  -2632725775855577589LL,
  3627196719566674912LL,
  729042223841047610LL,
  435173535143137865LL,
  6693677652066977828LL,
  -3211420767071920190LL,
  7108584989938107308LL,
  -7663946147414132335LL,
  8758360505685890020LL,
  -4016212747695761945LL,
  7906027833487093303LL,
  -3070133515198922355LL,
  -6205879294995817394LL,
  6267511318630422636LL,
  -1574623886672661516LL,
  8831264725849328229LL,
  583233781224785838LL,
  8685456282705293242LL,
  3346838826356001317LL,
  -6417251623077922788LL,
  -4156374101393968204LL,
  -2486934919760851992LL,
  2243142394228566132LL,
  -4765826840015301045LL,
  -8465342836852257397LL,
  4486284786432794736LL,
  7397950079417741749LL,
  217586768174157896LL,
  1013903716694226934LL,
  3845909384301625953LL,
  -5057426136771219881LL,
  -4514689569973528698LL,
  -7009527784978040291LL,
  -570853273582904863LL,
  1239371781428685720LL,
  -2778534218840681879LL,
  -7735157121846016114LL,
  2171364072505093531LL,
  -1648095458778540665LL,
  6196858897794959310LL,
  -2343378278217658328LL,
  -6775567088996121716LL,
  943251292401174921LL,
  -1859467785066093121LL,
  7546010321874748482LL,
  -7372346851795434943LL,
  1085682035709139501LL,
  6123954675013876656LL,
  1601641093635927483LL
}; // weak
__int64 Te3[30] =
{
  8970190760169416134LL,
  8897861578506344942LL,
  7740489115462929919LL,
  -4195854494209166882LL,
  72342376947929184LL,
  3110717777684965838LL,
  -2893735701755586073LL,
  8536180485010482765LL,
  -9042492341934733937LL,
  9042533138026807433LL,
  6438436296250234351LL,
  -1085354336335705714LL,
  -3110747421195506623LL,
  -5787149411345564321LL,
  -6582864816826958045LL,
  -4557542099700771100LL,
  -144927857230495115LL,
  2749001499682254397LL,
  4557433358253447788LL,
  -3689486566503808267LL,
  -6510529056688808856LL,
  -1013018571784768303LL,
  -2821377986367745054LL,
  1519189899753902946LL,
  -4051178539825492984LL,
  -4340521586862627514LL,
  -7595706463514253264LL,
  -7306328231902900470LL,
  1302162770628118798LL,
  -2098046446258316517LL
}; // weak
__int64 qword_7A120[98] =
{
  2821339479257327309LL,
  8463846905081941375LL,
  -8970152185249064174LL,
  1880866595994891352LL,
  7957494250027560246LL,
  -6872216661590872396LL,
  4268090242446325412LL,
  -5497823680218635849LL,
  -2025706287787312302LL,
  -8897820855125446306LL,
  -3327763504473836122LL,
  -1302335509799895040LL,
  -217263621663596480LL,
  6583116649253161081LL,
  -3761835490548203820LL,
  4123409890032933223LL,
  5498002995659071124LL,
  -3472474851106035536LL,
  -1157659550110684229LL,
  -289612541008878257LL,
  5570345371680621958LL,
  -8825485093168261786LL,
  -434297294988914806LL,
  9187204692814464516LL,
  4340419424412561568LL,
  -6293530565310170587LL,
  -6655196147573722206LL,
  -8102105449458777984LL,
  -7089303386032263873LL,
  -723666731046254480LL,
  -5280820793033564317LL,
  2387298416273814959LL,
  -251903857381344LL,
  -3255418909436473603LL,
  868090924940217473LL,
  -1374671271369689818LL,
  -7523366302382038594LL,
  1663861458213325960LL,
  -6365853098077562989LL,
  4412761801326756604LL,
  6727788206095641800LL,
  8319157752179534642LL,
  -9114836936062623552LL,
  -2532008551102033506LL,
  3038379798429853252LL,
  -8608486602025424069LL,
  -1229999712371291508LL,
  1446847525888250731LL,
  6800121788196878759LL,
  -2604357473917002474LL,
  3617048442001439707LL,
  723423762371464820LL,
  434045461973293970LL,
  6655445828878232648LL,
  -3183078750325416545LL,
  7089412127075397443LL,
  -7668042257725806535LL,
  8753181226109777875LL,
  -3978856002611629355LL,
  7885160670452734318LL,
  -3038411659844678655LL,
  -6221194804784606564LL,
  6221435553719301336LL,
  -1519360349186029581LL,
  8825523600110235594LL,
  578739012046350663LL,
  8680838849262966127LL,
  3327722914759143242LL,
  -6438193260843490248LL,
  -4123518696797452429LL,
  -2459672786635316277LL,
  2242547691579284712LL,
  -4774417719509656170LL,
  -8463806247877245427LL,
  4485095381137395936LL,
  7378772835691775089LL,
  217022731584592016LL,
  1012766881816642039LL,
  3834075568280806338LL,
  -5063787155145885266LL,
  -4485206337474096873LL,
  -7016967591753341126LL,
  -506633054251304743LL,
  1229820396930904875LL,
  -2749042224612656174LL,
  -7740378019666163449LL,
  2170209714143213101LL,
  -1591704943364435435LL,
  6149101975323429255LL,
  -2314996833683212208LL,
  -6799880898858938621LL,
  940433299934380041LL,
  -1808703397637924251LL,
  7523466382126794372LL,
  -7378672823234870398LL,
  1085104856524224346LL,
  6076759598678723451LL,
  1591523482124670573LL
}; // weak
__int64 Td4[128] =
{
  651061556772229714LL,
  -3038287261001422230LL,
  3906369333155082288LL,
  4051049680768181669LL,
  4629771063775969215LL,
  -7016996765209222237LL,
  -868082075977023103LL,
  -289360691958655017LL,
  -2025524841200976772LL,
  -9042521605989123783LL,
  3399988125208648603LL,
  -8680820738548039681LL,
  -8174439532218534860LL,
  4919131752972370755LL,
  -2387225704094448444LL,
  -3761688987074696727LL,
  8897841258426553428LL,
  3617008643554448532LL,
  -4412750543594281306LL,
  4412750542684758819LL,
  5497853138422394606LL,
  795741903543178645LL,
  -361700867289497022LL,
  5642533483340612547LL,
  3327647949911492616LL,
  7378697630477558177LL,
  -2748926570828126168LL,
  -5570193310923611100LL,
  6582955728719738486LL,
  5280832618678624930LL,
  -8391460049722184339LL,
  2676586397905834449LL,
  -506381212123499918LL,
  7234017286266746614LL,
  7523377975665264262LL,
  1591483804627277976LL,
  -6582955727456512812LL,
  -3689348816628327332LL,
  7306357456510999901LL,
  -7885078838744009034LL,
  8102099357797215340LL,
  5787213826911389768LL,
  -1302123110815891971LL,
  -2676586395564656199LL,
  1519143630829149790LL,
  6293595036626339398LL,
  -8246779703102822489LL,
  -8897841258662355555LL,
  -2821266741897686896LL,
  2880154539LL,
  -4846791580959601524LL,
  723401731766211539LL,
  -1953184666308053001LL,
  361700865588353112LL,
  -5497853135609612104LL,
  434041038089569605LL,
  3182967607637627088LL,
  -8102099359767847394LL,
  4557430891140008650LL,
  144680345895112463LL,
  -5787213826742959679LL,
  217020521647029693LL,
  1374463283620282625LL,
  7740398494196337290LL,
  -7957419013653775814LL,
  4702111233666519313LL,
  7451037801917665103LL,
  -1519143629835412260LL,
  -940422248427710569LL,
  -3544668469048913969LL,
  -5425512961845169936LL,
  8319119878315763430LL,
  -6004234345930910058LL,
  2459565877875733620LL,
  -5931894171745392665LL,
  -8825501087592794827LL,
  -434041037415849246LL,
  -1663823978256976073LL,
  8463800220555942940LL,
  7957419014091694047LL,
  -1012762422596384953LL,
  8174439529237322266LL,
  2965947086159027485LL,
  -8536140393882466875LL,
  -5208492445554217105LL,
  1012762421147886178LL,
  1736164150572919466LL,
  1953184669373480638LL,
  6221254866870533372LL,
  5425512962636791358LL,
  -3255307777915566394LL,
  2314885532317481337LL,
  -2604246223265555814LL,
  -72340173882343232LL,
  -3617008643335489416LL,
  -795741903812666790LL,
  -2459565879694778593LL,
  3689348816712542376LL,
  506381212039284872LL,
  3544668471592208327LL,
  1302123113763418545LL,
  6438275381359284240LL,
  -9187201951934765273LL,
  6872316421992148204LL,
  5859554000136855648LL,
  -6221254864782000257LL,
  -5353172792645183207LL,
  940422247922420298LL,
  -1880844496889107155LL,
  -6944656593078551942LL,
  -3906369334165662829LL,
  -1157442766807196516LL,
  -2242545359058329440LL,
  5570193308228729659LL,
  3038287261422497454LL,
  -5714873653045889547LL,
  -1446803457351038776LL,
  4340410372423662523LL,
  6004234346368828291LL,
  7016996766236645785LL,
  3110627431700436759LL,
  9114861775542813700LL,
  8608480568859605690LL,
  2748926570811283158LL,
  7595718150019211745LL,
  7161677109638992916LL,
  2387225704532366677LL,
  9042521602856324108LL
}; // weak
_QWORD MCS_RATE_TABLE_40MHZ = 8444365266419726LL; // weak
_QWORD AG_PHY_SNR_RATE_TABLE = 2252182066167815LL; // weak
_QWORD B_PHY_SNR_RATE_TABLE = 1407761430675458LL; // weak
_QWORD AWS_SNAP_HEADER = 855564095334886058LL; // weak
_QWORD AC_80_SISO_PHY_SNR_RATE_TABLE = 2533618389680134LL; // weak
__int64 IO80211InterfaceClassifyAndFixupPacket(OSObject *,__mbuf *)::ac2tc[2] = { 4294967296LL, 12884901890LL }; // weak
int IO80211ScanManager::getCachedScanResults(apple80211_scan_data *,apple80211scan_req_node *,ether_addr *,unsigned int)::emptyEA = 0; // weak
_QWORD ether_broadcast_addr = 3689573994723278847LL; // weak
__int64 qword_7AFF0[2] = { 15763698211619200LL, 4504149383184384LL }; // weak
_QWORD off_7B000[22] =
{
  817144LL,
  817416LL,
  817872LL,
  818304LL,
  819056LL,
  819416LL,
  819440LL,
  819592LL,
  819640LL,
  821592LL,
  821600LL,
  821608LL,
  821616LL,
  821624LL,
  821632LL,
  821664LL,
  821888LL,
  821896LL,
  821904LL,
  821912LL,
  821920LL,
  821928LL
}; // weak
_QWORD off_7B008[21] =
{
  817416LL,
  817872LL,
  818304LL,
  819056LL,
  819416LL,
  819440LL,
  819592LL,
  819640LL,
  821592LL,
  821600LL,
  821608LL,
  821616LL,
  821624LL,
  821632LL,
  821664LL,
  821888LL,
  821896LL,
  821904LL,
  821912LL,
  821920LL,
  821928LL
}; // weak
_QWORD off_7B010[20] =
{
  817872LL,
  818304LL,
  819056LL,
  819416LL,
  819440LL,
  819592LL,
  819640LL,
  821592LL,
  821600LL,
  821608LL,
  821616LL,
  821624LL,
  821632LL,
  821664LL,
  821888LL,
  821896LL,
  821904LL,
  821912LL,
  821920LL,
  821928LL
}; // weak
_QWORD off_7B018[19] =
{
  818304LL,
  819056LL,
  819416LL,
  819440LL,
  819592LL,
  819640LL,
  821592LL,
  821600LL,
  821608LL,
  821616LL,
  821624LL,
  821632LL,
  821664LL,
  821888LL,
  821896LL,
  821904LL,
  821912LL,
  821920LL,
  821928LL
}; // weak
_QWORD off_7B020[18] =
{
  819056LL,
  819416LL,
  819440LL,
  819592LL,
  819640LL,
  821592LL,
  821600LL,
  821608LL,
  821616LL,
  821624LL,
  821632LL,
  821664LL,
  821888LL,
  821896LL,
  821904LL,
  821912LL,
  821920LL,
  821928LL
}; // weak
_QWORD off_7B028[17] =
{
  819416LL,
  819440LL,
  819592LL,
  819640LL,
  821592LL,
  821600LL,
  821608LL,
  821616LL,
  821624LL,
  821632LL,
  821664LL,
  821888LL,
  821896LL,
  821904LL,
  821912LL,
  821920LL,
  821928LL
}; // weak
_QWORD off_7B030[16] =
{
  819440LL,
  819592LL,
  819640LL,
  821592LL,
  821600LL,
  821608LL,
  821616LL,
  821624LL,
  821632LL,
  821664LL,
  821888LL,
  821896LL,
  821904LL,
  821912LL,
  821920LL,
  821928LL
}; // weak
_QWORD off_7B038[15] =
{
  819592LL,
  819640LL,
  821592LL,
  821600LL,
  821608LL,
  821616LL,
  821624LL,
  821632LL,
  821664LL,
  821888LL,
  821896LL,
  821904LL,
  821912LL,
  821920LL,
  821928LL
}; // weak
_QWORD off_7B040[14] =
{
  819640LL,
  821592LL,
  821600LL,
  821608LL,
  821616LL,
  821624LL,
  821632LL,
  821664LL,
  821888LL,
  821896LL,
  821904LL,
  821912LL,
  821920LL,
  821928LL
}; // weak
__int64 off_7B048[13] =
{
  821592LL,
  821600LL,
  821608LL,
  821616LL,
  821624LL,
  821632LL,
  821664LL,
  821888LL,
  821896LL,
  821904LL,
  821912LL,
  821920LL,
  821928LL
}; // weak
__int64 off_7B050[12] =
{
  821600LL,
  821608LL,
  821616LL,
  821624LL,
  821632LL,
  821664LL,
  821888LL,
  821896LL,
  821904LL,
  821912LL,
  821920LL,
  821928LL
}; // weak
__int64 off_7B058[11] =
{
  821608LL,
  821616LL,
  821624LL,
  821632LL,
  821664LL,
  821888LL,
  821896LL,
  821904LL,
  821912LL,
  821920LL,
  821928LL
}; // weak
__int64 off_7B060[10] =
{
  821616LL,
  821624LL,
  821632LL,
  821664LL,
  821888LL,
  821896LL,
  821904LL,
  821912LL,
  821920LL,
  821928LL
}; // weak
__int64 off_7B068[9] =
{
  821624LL,
  821632LL,
  821664LL,
  821888LL,
  821896LL,
  821904LL,
  821912LL,
  821920LL,
  821928LL
}; // weak
__int64 off_7B070[8] =
{
  821632LL,
  821664LL,
  821888LL,
  821896LL,
  821904LL,
  821912LL,
  821920LL,
  821928LL
}; // weak
__int64 off_7B078[7] = { 821664LL, 821888LL, 821896LL, 821904LL, 821912LL, 821920LL, 821928LL }; // weak
__int64 off_7B080[6] = { 821888LL, 821896LL, 821904LL, 821912LL, 821920LL, 821928LL }; // weak
__int64 off_7B088[5] = { 821896LL, 821904LL, 821912LL, 821920LL, 821928LL }; // weak
__int64 off_7B090[4] = { 821904LL, 821912LL, 821920LL, 821928LL }; // weak
__int64 off_7B098[3] = { 821912LL, 821920LL, 821928LL }; // weak
__int64 off_7B0A0[2] = { 821920LL, 821928LL }; // weak
__int64 off_7B0A8 = 821928LL; // weak
__int64 (__fastcall *off_7B270[2])(RSNSupplicant *__hidden this) = { &RSNSupplicant::~RSNSupplicant, &RSNSupplicant::~RSNSupplicant }; // weak
__int64 (__fastcall *off_7B3A0[2])(RSNSupplicant::MetaClass *__hidden this) = { &RSNSupplicant::MetaClass::~MetaClass, &RSNSupplicant::MetaClass::~MetaClass }; // weak
_QWORD *off_7B480[3] = { &_wpaSuiteWEP40, &_wpaSuiteWEP104, &_wpaSuiteTKIP }; // weak
_QWORD *off_7B4B0[3] = { &_rsnSuiteWEP40, &_rsnSuiteWEP104, &_rsnSuiteTKIP }; // weak
char *off_7B4E0[3] = { "WEP-40", "WEP-104", "TKIP" }; // weak
_QWORD IO80211WorkLoop::metaClass = 541464LL; // weak
__int64 (__fastcall *off_7B520[2])(IO80211WorkLoop *__hidden this) = { &IO80211WorkLoop::~IO80211WorkLoop, &IO80211WorkLoop::~IO80211WorkLoop }; // weak
__int64 (__fastcall *off_7B740[2])(IO80211WorkLoop::MetaClass *__hidden this) =
{
  &IO80211WorkLoop::MetaClass::~MetaClass,
  &IO80211WorkLoop::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_7B840[2])(LogManagerDevice *__hidden this) = { &LogManagerDevice::~LogManagerDevice, &LogManagerDevice::~LogManagerDevice }; // weak
__int64 (__fastcall *off_7B980[2])(LogManagerDevice::MetaClass *__hidden this) =
{
  &LogManagerDevice::MetaClass::~MetaClass,
  &LogManagerDevice::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_7BA80[2])(IO80211QueueCall *__hidden this) = { &IO80211QueueCall::~IO80211QueueCall, &IO80211QueueCall::~IO80211QueueCall }; // weak
__int64 (__fastcall *off_7BBB0[2])(IO80211QueueCall::MetaClass *__hidden this) =
{
  &IO80211QueueCall::MetaClass::~MetaClass,
  &IO80211QueueCall::MetaClass::~MetaClass
}; // weak
__int64 `vtable for'LogManager[2] = { 0LL, 0LL }; // weak
__int64 (__fastcall *off_7BCB0[2])(LogManager *__hidden this) = { &LogManager::~LogManager, &LogManager::~LogManager }; // weak
__int64 (__fastcall *off_7BDF0[2])(LogManager::MetaClass *__hidden this) = { &LogManager::MetaClass::~MetaClass, &LogManager::MetaClass::~MetaClass }; // weak
int dword_7BED4 = 102; // weak
char *off_7BED8 = "Should Not On Thread"; // weak
__int64 qword_7C150[] = { 1LL }; // weak
__int64 qword_7C370[] = { 0LL }; // weak
__int64 (__fastcall *off_7C5B0[2])(IOCharacterDevice *__hidden this) =
{
  &IOCharacterDevice::~IOCharacterDevice,
  &IOCharacterDevice::~IOCharacterDevice
}; // weak
__int64 (__fastcall *off_7C6E0[2])(IOCharacterDevice::MetaClass *__hidden this) =
{
  &IOCharacterDevice::MetaClass::~MetaClass,
  &IOCharacterDevice::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_7C7E0[2])(IO80211AWDLMulticastPeer *__hidden this) =
{
  &IO80211AWDLMulticastPeer::~IO80211AWDLMulticastPeer,
  &IO80211AWDLMulticastPeer::~IO80211AWDLMulticastPeer
}; // weak
__int64 (__fastcall *off_7C990[2])(IO80211AWDLMulticastPeer::MetaClass *__hidden this) =
{
  &IO80211AWDLMulticastPeer::MetaClass::~MetaClass,
  &IO80211AWDLMulticastPeer::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_7CA90[2])(IO80211AWDLPeer *__hidden this) = { &IO80211AWDLPeer::~IO80211AWDLPeer, &IO80211AWDLPeer::~IO80211AWDLPeer }; // weak
__int64 (__fastcall *off_7CC40[2])(IO80211AWDLPeer::MetaClass *__hidden this) =
{
  &IO80211AWDLPeer::MetaClass::~MetaClass,
  &IO80211AWDLPeer::MetaClass::~MetaClass
}; // weak
char *off_7CD20[19] =
{
  "AWDL_SSTH_REQUEST_TLV",
  "AWDL_SERVICE_REQUEST_TLV",
  "AWDL_SERVICE_RESPONSE_TLV",
  "UNKNOWN",
  "AWDL_SYNCHRONIZATON_PARAMETERS_TLV",
  "AWDL_ELECTION_PARAMETERS_TLV",
  "AWDL_SERVICE_PARAMETERS_TLV",
  "AWDL_ENHANCED_DATA_RATE_CAPABILITIES_TLV",
  "AWDL_ENHANCED_DATA_RATE_OPERATION_TLV",
  "AWDL_INFRA_TLV",
  "AWDL_INVITE_TLV",
  "AWDL_DBG_STRING_TLV",
  "AWDL_DATA_PATH_STATE_TLV",
  "AWDL_ENCAPSULATED_IP_TLV",
  "AWDL_DATAPATH_DEBUG_PACKET_LIVE_TLV",
  "AWDL_DATAPATH_DEBUG_AF_LIVE_TLV",
  "AWDL_ARPA_TLV",
  "AWDL_IEEE80211_CNTNR_TLV",
  "AWDL_CHAN_SEQ_TLV"
}; // weak
_QWORD IO80211AWDLPeerManager::metaClass = 541744LL; // weak
__int64 (__fastcall *off_7CDE0[2])(IO80211AWDLPeerManager *__hidden this) =
{
  &IO80211AWDLPeerManager::~IO80211AWDLPeerManager,
  &IO80211AWDLPeerManager::~IO80211AWDLPeerManager
}; // weak
__int64 (__fastcall *off_7D020[2])(IO80211AWDLPeerManager::MetaClass *__hidden this) =
{
  &IO80211AWDLPeerManager::MetaClass::~MetaClass,
  &IO80211AWDLPeerManager::MetaClass::~MetaClass
}; // weak
char *IO80211AWDLPeerManager::setAwdlOperatingMode(apple80211_awdl_oper_mode *)::awdlOperModeDesc[3] = { "AUTO", "MANUAL", "SUSPENDED" }; // weak
char *off_7D120[33] =
{
  "MinimumFast",
  "Minimum",
  "MinimumSlow",
  "unknown",
  "Always",
  "AlwaysFast",
  "AlwaysRealTime",
  "Always+Scans",
  "AlwaysRealtime + Scan",
  "RealTime Minimum",
  "Always+Piggyback Scan",
  "Forced",
  "AwdlFollowsInfra",
  "AwdlStateMachine",
  "AwdlFixed",
  "AwdlUserConfigured",
  "Init",
  "BSSIDChanged",
  "Mdns",
  "setSyncEnabled",
  "Debug",
  "Interface",
  "Reset",
  "Enable",
  "Channel Switch Complete",
  "SetInfraChannel",
  "Master Channel Changed",
  "Secondary Master Channel Changed",
  "Grace Period expired",
  "AirPlay Solo Request",
  "allow20",
  "allow40",
  "allow80"
}; // weak
char *off_7D180[21] =
{
  "AwdlFollowsInfra",
  "AwdlStateMachine",
  "AwdlFixed",
  "AwdlUserConfigured",
  "Init",
  "BSSIDChanged",
  "Mdns",
  "setSyncEnabled",
  "Debug",
  "Interface",
  "Reset",
  "Enable",
  "Channel Switch Complete",
  "SetInfraChannel",
  "Master Channel Changed",
  "Secondary Master Channel Changed",
  "Grace Period expired",
  "AirPlay Solo Request",
  "allow20",
  "allow40",
  "allow80"
}; // weak
char *off_7D1A0[17] =
{
  "Init",
  "BSSIDChanged",
  "Mdns",
  "setSyncEnabled",
  "Debug",
  "Interface",
  "Reset",
  "Enable",
  "Channel Switch Complete",
  "SetInfraChannel",
  "Master Channel Changed",
  "Secondary Master Channel Changed",
  "Grace Period expired",
  "AirPlay Solo Request",
  "allow20",
  "allow40",
  "allow80"
}; // weak
char *off_7D210[3] = { "allow20", "allow40", "allow80" }; // weak
char *off_7D230[19] =
{
  "AWDL_SSTH_REQUEST_TLV",
  "AWDL_SERVICE_REQUEST_TLV",
  "AWDL_SERVICE_RESPONSE_TLV",
  "UNKNOWN",
  "AWDL_SYNCHRONIZATON_PARAMETERS_TLV",
  "AWDL_ELECTION_PARAMETERS_TLV",
  "AWDL_SERVICE_PARAMETERS_TLV",
  "AWDL_ENHANCED_DATA_RATE_CAPABILITIES_TLV",
  "AWDL_ENHANCED_DATA_RATE_OPERATION_TLV",
  "AWDL_INFRA_TLV",
  "AWDL_INVITE_TLV",
  "AWDL_DBG_STRING_TLV",
  "AWDL_DATA_PATH_STATE_TLV",
  "AWDL_ENCAPSULATED_IP_TLV",
  "AWDL_DATAPATH_DEBUG_PACKET_LIVE_TLV",
  "AWDL_DATAPATH_DEBUG_AF_LIVE_TLV",
  "AWDL_ARPA_TLV",
  "AWDL_IEEE80211_CNTNR_TLV",
  "AWDL_CHAN_SEQ_TLV"
}; // weak
char *off_7D2D0[6] =
{
  "Valid (from host)",
  "Peer request",
  "Pending change",
  "Valid (from peer)",
  &IO80211Peer::gMetaClass,
  &IO80211QueueDescriptor::gMetaClass
}; // weak
__int64 `vtable for'IO80211Peer[2] = { 0LL, 0LL }; // weak
__int64 (__fastcall *off_7D310[2])(IO80211Peer *__hidden this) = { &IO80211Peer::~IO80211Peer, &IO80211Peer::~IO80211Peer }; // weak
__int64 (__fastcall *off_7D4C0[2])(IO80211Peer::MetaClass *__hidden this) = { &IO80211Peer::MetaClass::~MetaClass, &IO80211Peer::MetaClass::~MetaClass }; // weak
__int64 `vtable for'IO80211PeerManager[2] = { 0LL, 0LL }; // weak
__int64 (__fastcall *off_7D5C0[2])(IO80211PeerManager *__hidden this) =
{
  &IO80211PeerManager::~IO80211PeerManager,
  &IO80211PeerManager::~IO80211PeerManager
}; // weak
__int64 (__fastcall *off_7D800[2])(IO80211PeerManager::MetaClass *__hidden this) =
{
  &IO80211PeerManager::MetaClass::~MetaClass,
  &IO80211PeerManager::MetaClass::~MetaClass
}; // weak
char *off_7D8E0[11] =
{
  "ScanManagerFamily",
  "DriverInterleavedScan",
  "DriverScanDone",
  "DriverInternalScanDone",
  "DebugCmd",
  "Joining",
  "DriverRoamRequest",
  "ScanRefused",
  "ScanError",
  "ScanBlocked",
  "ScanDone"
}; // weak
_QWORD IO80211P2PInterface::metaClass = 542024LL; // weak
__int64 (__fastcall *off_7D960[2])(IO80211P2PInterface *__hidden this) =
{
  &IO80211P2PInterface::~IO80211P2PInterface,
  &IO80211P2PInterface::~IO80211P2PInterface
}; // weak
__int64 (__fastcall *off_7E360[2])(IO80211P2PInterface::MetaClass *__hidden this) =
{
  &IO80211P2PInterface::MetaClass::~MetaClass,
  &IO80211P2PInterface::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_7E460[2])(IO80211ActionFrameDescriptor *__hidden this) =
{
  &IO80211ActionFrameDescriptor::~IO80211ActionFrameDescriptor,
  &IO80211ActionFrameDescriptor::~IO80211ActionFrameDescriptor
}; // weak
__int64 (__fastcall *off_7E5A0[2])(IO80211ActionFrameDescriptor::MetaClass *__hidden this) =
{
  &IO80211ActionFrameDescriptor::MetaClass::~MetaClass,
  &IO80211ActionFrameDescriptor::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_7E6A0[2])(IO80211CommandQueue *__hidden this) =
{
  &IO80211CommandQueue::~IO80211CommandQueue,
  &IO80211CommandQueue::~IO80211CommandQueue
}; // weak
__int64 (__fastcall *off_7E7D0[2])(IO80211CommandQueue::MetaClass *__hidden this) =
{
  &IO80211CommandQueue::MetaClass::~MetaClass,
  &IO80211CommandQueue::MetaClass::~MetaClass
}; // weak
char *off_7E8B0[6] =
{
  "Descending",
  "Equal",
  "Ascending",
  "Error",
  &IO80211Controller::gMetaClass,
  &IOEthernetController::gMetaClass
}; // weak
_QWORD IO80211Controller::metaClass = 542144LL; // weak
__int64 (__fastcall *off_7E8F0[2])(IO80211Controller *__hidden this) =
{
  &IO80211Controller::~IO80211Controller,
  &IO80211Controller::~IO80211Controller
}; // weak
__int64 (__fastcall *off_7F6B0[2])(IO80211Controller::MetaClass *__hidden this) =
{
  &IO80211Controller::MetaClass::~MetaClass,
  &IO80211Controller::MetaClass::~MetaClass
}; // weak
_QWORD IO80211Interface::metaClass = 542184LL; // weak
__int64 (__fastcall *off_7F7B0[2])(IO80211Interface *__hidden this) = { &IO80211Interface::~IO80211Interface, &IO80211Interface::~IO80211Interface }; // weak
__int64 (__fastcall *off_80320[2])(IO80211Interface::MetaClass *__hidden this) =
{
  &IO80211Interface::MetaClass::~MetaClass,
  &IO80211Interface::MetaClass::~MetaClass
}; // weak
_QWORD VHT_MCS_RATE_TABLE_80MHZ = 503216LL; // weak
_QWORD VHT_MCS_RATE_TABLE_40MHZ = 503072LL; // weak
_QWORD VHT_MCS_RATE_TABLE_20MHZ = 502928LL; // weak
_QWORD N_20_NSS_PHY_SNR_RATE_TABLE = 502672LL; // weak
_QWORD N_40_NSS_PHY_SNR_RATE_TABLE = 502768LL; // weak
char *off_804A0[7] = { "FCC", "ETSI", "Japan", "Korea", "APAC", "RoW", "Indonesia" }; // weak
__int64 (__fastcall *off_80500[2])(IO80211NetBootNub *__hidden this) =
{
  &IO80211NetBootNub::~IO80211NetBootNub,
  &IO80211NetBootNub::~IO80211NetBootNub
}; // weak
__int64 (__fastcall *off_80D70[2])(IO80211NetBootNub::MetaClass *__hidden this) =
{
  &IO80211NetBootNub::MetaClass::~MetaClass,
  &IO80211NetBootNub::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_80E70[2])(IO80211PacketDescriptor *__hidden this) =
{
  &IO80211PacketDescriptor::~IO80211PacketDescriptor,
  &IO80211PacketDescriptor::~IO80211PacketDescriptor
}; // weak
__int64 (__fastcall *off_80FC0[2])(IO80211PacketDescriptor::MetaClass *__hidden this) =
{
  &IO80211PacketDescriptor::MetaClass::~MetaClass,
  &IO80211PacketDescriptor::MetaClass::~MetaClass
}; // weak
_QWORD IO80211ScanManager::metaClass = 542304LL; // weak
__int64 (__fastcall *off_810C0[2])(IO80211ScanManager *__hidden this) =
{
  &IO80211ScanManager::~IO80211ScanManager,
  &IO80211ScanManager::~IO80211ScanManager
}; // weak
__int64 (__fastcall *off_811F0[2])(IO80211ScanManager::MetaClass *__hidden this) =
{
  &IO80211ScanManager::MetaClass::~MetaClass,
  &IO80211ScanManager::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_812F0[2])(IO80211ServiceRequestDescriptor *__hidden this) =
{
  &IO80211ServiceRequestDescriptor::~IO80211ServiceRequestDescriptor,
  &IO80211ServiceRequestDescriptor::~IO80211ServiceRequestDescriptor
}; // weak
__int64 (__fastcall *off_81430[2])(IO80211ServiceRequestDescriptor::MetaClass *__hidden this) =
{
  &IO80211ServiceRequestDescriptor::MetaClass::~MetaClass,
  &IO80211ServiceRequestDescriptor::MetaClass::~MetaClass
}; // weak
char *off_81510[19] =
{
  "AWDL_SSTH_REQUEST_TLV",
  "AWDL_SERVICE_REQUEST_TLV",
  "AWDL_SERVICE_RESPONSE_TLV",
  "UNKNOWN",
  "AWDL_SYNCHRONIZATON_PARAMETERS_TLV",
  "AWDL_ELECTION_PARAMETERS_TLV",
  "AWDL_SERVICE_PARAMETERS_TLV",
  "AWDL_ENHANCED_DATA_RATE_CAPABILITIES_TLV",
  "AWDL_ENHANCED_DATA_RATE_OPERATION_TLV",
  "AWDL_INFRA_TLV",
  "AWDL_INVITE_TLV",
  "AWDL_DBG_STRING_TLV",
  "AWDL_DATA_PATH_STATE_TLV",
  "AWDL_ENCAPSULATED_IP_TLV",
  "AWDL_DATAPATH_DEBUG_PACKET_LIVE_TLV",
  "AWDL_DATAPATH_DEBUG_AF_LIVE_TLV",
  "AWDL_ARPA_TLV",
  "AWDL_IEEE80211_CNTNR_TLV",
  "AWDL_CHAN_SEQ_TLV"
}; // weak
__int64 (__fastcall *off_815D0[2])(Stopwatch *__hidden this) = { &Stopwatch::~Stopwatch, &Stopwatch::~Stopwatch }; // weak
__int64 (__fastcall *off_81700[2])(Stopwatch::MetaClass *__hidden this) = { &Stopwatch::MetaClass::~MetaClass, &Stopwatch::MetaClass::~MetaClass }; // weak
_QWORD IO80211VirtualInterface::metaClass = 544072LL; // weak
__int64 `vtable for'IO80211VirtualInterface[2] = { 0LL, 0LL }; // weak
__int64 (__fastcall *off_81800[2])(IO80211VirtualInterface *__hidden this) =
{
  &IO80211VirtualInterface::~IO80211VirtualInterface,
  &IO80211VirtualInterface::~IO80211VirtualInterface
}; // weak
__int64 (__fastcall *off_82180[2])(IO80211VirtualInterface::MetaClass *__hidden this) =
{
  &IO80211VirtualInterface::MetaClass::~MetaClass,
  &IO80211VirtualInterface::MetaClass::~MetaClass
}; // weak
char *off_82260[8] =
{
  "P2P Device",
  "P2P Client",
  "P2P Group Owner",
  "AirLink",
  "SoftAP",
  "WDS",
  &IO80211QueueDescriptor::gMetaClass,
  &OSObject::gMetaClass
}; // weak
__int64 `vtable for'IO80211QueueDescriptor[2] = { 0LL, 0LL }; // weak
__int64 (__fastcall *off_822B0[2])(IO80211QueueDescriptor *__hidden this) =
{
  &IO80211QueueDescriptor::~IO80211QueueDescriptor,
  &IO80211QueueDescriptor::~IO80211QueueDescriptor
}; // weak
__int64 (__fastcall *off_823F0[2])(IO80211QueueDescriptor::MetaClass *__hidden this) =
{
  &IO80211QueueDescriptor::MetaClass::~MetaClass,
  &IO80211QueueDescriptor::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_824F0[2])(IO80211PeerExtendedStats *__hidden this) =
{
  &IO80211PeerExtendedStats::~IO80211PeerExtendedStats,
  &IO80211PeerExtendedStats::~IO80211PeerExtendedStats
}; // weak
__int64 (__fastcall *off_82620[2])(IO80211PeerExtendedStats::MetaClass *__hidden this) =
{
  &IO80211PeerExtendedStats::MetaClass::~MetaClass,
  &IO80211PeerExtendedStats::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_82720[2])(IO80211VirtualInterfaceNamer *__hidden this) =
{
  &IO80211VirtualInterfaceNamer::~IO80211VirtualInterfaceNamer,
  &IO80211VirtualInterfaceNamer::~IO80211VirtualInterfaceNamer
}; // weak
__int64 (__fastcall *off_82F90[2])(IO80211VirtualInterfaceNamer::MetaClass *__hidden this) =
{
  &IO80211VirtualInterfaceNamer::MetaClass::~MetaClass,
  &IO80211VirtualInterfaceNamer::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_83090[2])(IO80211DriverCommandDescriptor *__hidden this) =
{
  &IO80211DriverCommandDescriptor::~IO80211DriverCommandDescriptor,
  &IO80211DriverCommandDescriptor::~IO80211DriverCommandDescriptor
}; // weak
__int64 (__fastcall *off_831D0[2])(IO80211DriverCommandDescriptor::MetaClass *__hidden this) =
{
  &IO80211DriverCommandDescriptor::MetaClass::~MetaClass,
  &IO80211DriverCommandDescriptor::MetaClass::~MetaClass
}; // weak
int _maj = 4294967295; // weak
__int64 (__fastcall *_cdevsw[5])() = { &cdev_open, &cdev_close, &cdev_read, &cdev_write, &cdev_ioctl }; // weak
__int64 (__fastcall *gGetHandlerTable[2])(IO80211Controller *this) = { &getSSID, &getAuthType }; // weak
__int64 gGetHandlerTableCount[2] = { 226LL, 0LL }; // weak
__int64 (__fastcall *gSetHandlerTable[2])(IO80211Controller *this) = { &setSSID, &setAuthType }; // weak
__int64 gSetHandlerTableCount[2] = { 226LL, 0LL }; // weak
char *stringFromOpcode[7] =
{
  "AWDL_INVITE_OPCODE_AWDL_PING",
  "AWDL_INVITE_OPCODE_SUCCESS",
  "AWDL_INVITE_OPCODE_REJECT",
  "AWDL_INVITE_OPCODE_CONFIRM",
  "AWDL_INVITE_OPCODE_REQUEST_CHANNEL_SEQUENCE",
  "AWDL_INVITE_OPCODE_REQUEST_ROAM",
  "AWDL_INVITE_OPCODE_REQUEST_AWDL_MEASUREMENT"
}; // weak
char *tcp_label = &qword_7AEF0; // idb
char *udp_label = &byte_7AEFD; // idb
char *local_label = &qword_7AFB8; // idb
char *airdrop_tcp_local_label = &word_7AF0A; // idb
char *airdrop_udp_local_label = &qword_7AF20; // idb
char *airdrop_label = "\b_airdrop"; // idb
char *airplay_tcp_local_label = &byte_7AF41; // idb
char *airplay_udp_local_label = &byte_7AF57; // idb
char *airplay_label = "\b_airplay"; // idb
char *raop_tcp_local_label = &qword_7AF78; // idb
char *raop_udp_local_label = &byte_7AF8B; // idb
char *raop_label = &qword_7AFC0; // idb
char *arpa6_label = &word_7AF9E; // idb
char *arpa4_label = &byte_7AFA9; // idb
int num_awdl_labels = 14; // weak
int _serviceDescriptorAllocCount = 1; // weak
__int64 kmod_info = 0LL; // weak
_QWORD RSNSupplicant::gMetaClass; // weak
_QWORD IO80211WorkLoop::gMetaClass; // weak
_QWORD LogManagerDevice::gMetaClass; // weak
_QWORD IO80211QueueCall::gMetaClass; // weak
_QWORD LogManager::gMetaClass; // weak
_QWORD IOCharacterDevice::gMetaClass; // weak
_QWORD IO80211AWDLMulticastPeer::gMetaClass; // weak
_QWORD IO80211AWDLPeer::gMetaClass; // weak
_QWORD IO80211AWDLPeerManager::gMetaClass; // weak
_QWORD IO80211Peer::gMetaClass; // weak
_QWORD IO80211PeerManager::gMetaClass; // weak
__int64 _logCount; // weak
__int64 buf_kernel_addrperm; // weak
char vm_kernel_addrperm; // weak
__int64 _log_buffer_size[2]; // weak
__int64 _log_debug_buffer[4]; // weak
__int64 _log_debug_buffer_owner[2]; // weak
char _log_debug_flip[4]; // weak
__int64 _logCC_debug_buffer[4]; // weak
_QWORD IO80211P2PInterface::gMetaClass; // weak
_QWORD IO80211ActionFrameDescriptor::gMetaClass; // weak
_QWORD IO80211CommandQueue::gMetaClass; // weak
_QWORD IO80211Controller::gMetaClass; // weak
_QWORD IO80211Interface::gMetaClass; // weak
_QWORD IO80211NetBootNub::gMetaClass; // weak
_QWORD IO80211PacketDescriptor::gMetaClass; // weak
_QWORD IO80211ScanManager::gMetaClass; // weak
unsigned __int8 bufout; // idb
char byte_84890; // weak
unsigned __int8 buf; // idb
unsigned __int8 word_848A6; // idb
char byte_84AA0; // weak
int _crc8_ccitt_inited; // weak
__int64 crc8_table[32]; // weak
_QWORD IO80211ServiceRequestDescriptor::gMetaClass; // weak
__int16 awdl_labels[]; // weak
__int16 word_84BF2; // weak
__int64 qword_84BF8; // weak
__int16 word_84C00; // weak
__int16 word_84C02; // weak
__int64 qword_84C08; // weak
__int16 word_84C10; // weak
__int16 word_84C12; // weak
__int64 qword_84C18; // weak
__int16 word_84C20; // weak
__int16 word_84C22; // weak
__int64 qword_84C28; // weak
__int16 word_84C30; // weak
__int16 word_84C32; // weak
__int64 qword_84C38; // weak
__int16 word_84C40; // weak
__int16 word_84C42; // weak
__int64 qword_84C48; // weak
__int16 word_84C50; // weak
__int16 word_84C52; // weak
__int64 qword_84C58; // weak
__int16 word_84C60; // weak
__int16 word_84C62; // weak
__int64 qword_84C68; // weak
__int16 word_84C70; // weak
__int16 word_84C72; // weak
__int64 qword_84C78; // weak
__int16 word_84C80; // weak
__int16 word_84C82; // weak
__int64 qword_84C88; // weak
__int16 word_84C90; // weak
__int16 word_84C92; // weak
__int64 qword_84C98; // weak
__int16 word_84CA0; // weak
__int16 word_84CA2; // weak
__int64 qword_84CA8; // weak
__int16 word_84CB0; // weak
__int16 word_84CB2; // weak
__int64 qword_84CB8; // weak
__int16 word_84CC0; // weak
__int16 word_84CC2; // weak
__int64 qword_84CC8; // weak
int inited_awdl_compression; // weak
__int16 v1_labels; // weak
__int16 word_84CE2; // weak
__int64 qword_84CE8; // weak
__int16 word_84CF0; // weak
__int16 word_84CF2; // weak
__int64 qword_84CF8; // weak
__int16 word_84D00; // weak
__int16 word_84D02; // weak
__int64 qword_84D08; // weak
__int16 word_84D10; // weak
__int16 word_84D12; // weak
__int64 qword_84D18; // weak
_QWORD Stopwatch::gMetaClass; // weak
_QWORD IO80211VirtualInterface::gMetaClass; // weak
_QWORD IO80211QueueDescriptor::gMetaClass; // weak
_QWORD IO80211PeerExtendedStats::gMetaClass; // weak
_QWORD IO80211VirtualInterfaceNamer::gMetaClass; // weak
_QWORD IO80211DriverCommandDescriptor::gMetaClass; // weak
int (*_realmain)(void); // weak
int (*_antimain)(void); // weak
__int64 _dev_node_lock; // weak
int _dev_node_lock_waiters; // weak
__int64 _node_head; // weak
__int64 _clone_head; // weak
_QWORD gQueueCall; // weak
_QWORD _logDevLock; // weak
_QWORD _logDevMTLock; // weak
_QWORD _logDevTempLock; // weak
LogManagerDevice *_logDev; // idb
LogManagerDevice *_logDevMT; // idb
LogManagerDevice *_logDevTemp; // idb
int _generatePeerDatabase(OSObject *,IO80211QueueDescriptor *,void *,mapExtraParam *)::count; // weak
_QWORD _ucounter; // weak
_QWORD pktDescriptorAllocCount; // weak
IO80211VirtualInterfaceNamer *_interfaceNamer; // idb


//----- (00000000000013D0) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::MetaClass::MetaClass(RSNSupplicant::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "RSNSupplicant", off_7B030[0], 272LL);
  result = (__int64)off_7B3A0;
  *(_QWORD *)this = off_7B3A0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 7B3A0: using guessed type __int64 (__fastcall *off_7B3A0[2])(RSNSupplicant::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000001402) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::MetaClass::~MetaClass(RSNSupplicant::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000140C) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::RSNSupplicant(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_7B270;
  *(_QWORD *)a1 = off_7B270;
  return result;
}
// 7B270: using guessed type __int64 (__fastcall *off_7B270[2])(RSNSupplicant *__hidden this);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000142C) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::RSNSupplicant(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_7B270;
  *(_QWORD *)a1 = off_7B270;
  return result;
}
// 7B270: using guessed type __int64 (__fastcall *off_7B270[2])(RSNSupplicant *__hidden this);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000144C) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::~RSNSupplicant(RSNSupplicant *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000001456) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::~RSNSupplicant(RSNSupplicant *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000001460) ----------------------------------------------------
void __fastcall RSNSupplicant::~RSNSupplicant(RSNSupplicant *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000001482) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::getMetaClass(RSNSupplicant *this)
{
  return (__int64)&RSNSupplicant::gMetaClass;
}
// 842F0: using guessed type _QWORD RSNSupplicant::gMetaClass;

//----- (0000000000001490) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::MetaClass::MetaClass(RSNSupplicant::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "RSNSupplicant", off_7B030[0], 272LL);
  result = (__int64)off_7B3A0;
  *(_QWORD *)this = off_7B3A0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 7B3A0: using guessed type __int64 (__fastcall *off_7B3A0[2])(RSNSupplicant::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000014C2) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::MetaClass::alloc(RSNSupplicant::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_108.sectname[8], a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_7B270;
  OSMetaClass::instanceConstructed((OSMetaClass *)&RSNSupplicant::gMetaClass);
  return v2;
}
// 108: using guessed type section_64 stru_108;
// 7B270: using guessed type __int64 (__fastcall *off_7B270[2])(RSNSupplicant *__hidden this);
// 842F0: using guessed type _QWORD RSNSupplicant::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000001502) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::RSNSupplicant(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_7B270;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&RSNSupplicant::gMetaClass);
}
// 7B270: using guessed type __int64 (__fastcall *off_7B270[2])(RSNSupplicant *__hidden this);
// 842F0: using guessed type _QWORD RSNSupplicant::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000001532) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::RSNSupplicant(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_7B270;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&RSNSupplicant::gMetaClass);
}
// 7B270: using guessed type __int64 (__fastcall *off_7B270[2])(RSNSupplicant *__hidden this);
// 842F0: using guessed type _QWORD RSNSupplicant::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000001562) ----------------------------------------------------
int __fastcall RSNSupplicant::reset(RSNSupplicant *this)
{
  __int64 i; // rbx@1

  for ( i = *((_QWORD *)this + 32); i; i = *(_QWORD *)i )
  {
    RSNSupplicant::joinPTKThread((__int64)this, i);
    *(_BYTE *)(i + 16) = 0;
    *(_BYTE *)(i + 163) = 1;
    *(_BYTE *)(i + 33) = 0;
    *(_BYTE *)(i + 98) = 0;
    *(_BYTE *)(i + 703) = 0;
    *(_DWORD *)(i + 232) = 0;
    *(_DWORD *)(i + 228) = 0;
    *(_BYTE *)(i + 961) = 0;
    *(_BYTE *)(i + 962) = 0;
    *(_BYTE *)(i + 680) = 0;
    bzero((void *)(i + 25), 8uLL);
    bzero((void *)(i + 236), 0x94uLL);
    bzero((void *)(i + 384), 0x94uLL);
    bzero((void *)(i + 532), 0x94uLL);
  }
  *((_BYTE *)this + 40) = 0;
  *((_BYTE *)this + 56) = 0;
  *((_QWORD *)this + 6) = 0LL;
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 2) + 632LL))(
           *((_QWORD *)this + 2),
           "IO80211RSNDone",
           0LL);
}

//----- (0000000000001642) ----------------------------------------------------
void __fastcall RSNSupplicant::joinPTKThread(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1
  __int64 v4; // rax@3
  __int64 v5; // rax@3
  __int64 v6; // r15@3
  IO80211Interface *v7; // rdi@4
  __int64 v8; // rdx@5
  __int64 v9; // rcx@5
  __int64 v10; // r8@5
  __int64 v11; // r9@5
  __int64 v12; // rdx@6
  __int64 v13; // rcx@6
  __int64 v14; // r8@6
  __int64 v15; // r9@6
  char v16; // [sp+0h] [bp-20h]@0

  v2 = a1;
  v3 = *(_QWORD *)(a1 + 24);
  if ( v3 )
  {
    if ( *(_BYTE *)(a2 + 696) )
    {
      LODWORD(v4) = (*(int (**)(void))(*(_QWORD *)v3 + 1672LL))();
      LODWORD(v5) = OSMetaClassBase::safeMetaCast(v4, IO80211WorkLoop::metaClass);
      v6 = v5;
      if ( v5 )
      {
        v7 = *(IO80211Interface **)(v2 + 16);
        if ( v7 )
        {
          if ( IO80211Interface::debugFlags(v7) & 4 )
          {
            IOLog("joinPTKThread: Waiting for PTK thread.\n", IO80211WorkLoop::metaClass, v8, v9, v10, v11);
            IO8Log("joinPTKThread: Waiting for PTK thread.\n", IO80211WorkLoop::metaClass, v12, v13, v14, v15, v16);
          }
        }
        *(_BYTE *)(v2 + 248) = 1;
        (*(void (__fastcall **)(__int64, __int64, signed __int64))(*(_QWORD *)v6 + 408LL))(v6, a2, 1LL);
        (*(void (__fastcall **)(__int64, __int64, _QWORD))(*(_QWORD *)v6 + 400LL))(v6, v2 + 248, 0LL);
      }
    }
  }
}
// 7B500: using guessed type _QWORD IO80211WorkLoop::metaClass;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000001706) ----------------------------------------------------
char __fastcall RSNSupplicant::linkDown(RSNSupplicant *this)
{
  int v1; // eax@1
  char result; // al@5

  RSNSupplicant::reset(this);
  RSNSupplicant::clearKeys(this);
  v1 = *((_DWORD *)this + 9);
  if ( v1 != 4 && v1 != 8 || *((_DWORD *)this + 25) != 1 )
    *((_BYTE *)this + 56) = 1;
  result = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)this + 30) + 568LL))(*((_QWORD *)this + 30));
  if ( !(result & 3) )
  {
    result = IO80211Interface::enabledBySystem(*((IO80211Interface **)this + 2));
    if ( result )
      result = (*(int (**)(void))(**((_QWORD **)this + 30) + 304LL))();
  }
  return result;
}

//----- (0000000000001772) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::clearKeys(RSNSupplicant *this)
{
  __int64 v1; // r15@1
  __int64 v2; // rax@3
  int v4; // [sp+8h] [bp-B8h]@1
  int v5; // [sp+10h] [bp-B0h]@1
  __int16 v6; // [sp+14h] [bp-ACh]@1
  unsigned __int16 v7; // [sp+16h] [bp-AAh]@1
  __int64 v8; // [sp+A0h] [bp-20h]@1

  v1 = off_7B078[0];
  v8 = *(_QWORD *)off_7B078[0];
  bzero(&v4, 0x94uLL);
  v4 = 1;
  v5 = 0;
  LOBYTE(v6) = v6 | 4;
  (*(void (__fastcall **)(_QWORD, signed __int64, signed __int64, _QWORD, int *))(**((_QWORD **)this + 3) + 3216LL))(
    *((_QWORD *)this + 3),
    2150132168LL,
    3LL,
    *((_QWORD *)this + 2),
    &v4);
  v6 = 0;
  if ( v7 <= 3u )
  {
    do
    {
      (*(void (__fastcall **)(_QWORD, signed __int64, signed __int64, _QWORD, int *))(**((_QWORD **)this + 3) + 3216LL))(
        *((_QWORD *)this + 3),
        2150132168LL,
        3LL,
        *((_QWORD *)this + 2),
        &v4);
      ++v7;
    }
    while ( v7 < 4u );
  }
  v2 = *((_QWORD *)this + 2);
  *(_DWORD *)(v2 + 564) = 0;
  *(_DWORD *)(v2 + 568) = 0;
  return *(_QWORD *)v1;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000001866) ----------------------------------------------------
int __fastcall RSNSupplicant::init(RSNSupplicant *this)
{
  *((_DWORD *)this + 8) = 0;
  *((_DWORD *)this + 9) = 0;
  *((_DWORD *)this + 24) = 0;
  *((_DWORD *)this + 23) = 0;
  *((_DWORD *)this + 25) = 0;
  *((_QWORD *)this + 32) = 0LL;
  return (*(int (**)(void))(off_7B068[0] + 152))();
}
// 7B068: using guessed type __int64 off_7B068[9];

//----- (00000000000018A6) ----------------------------------------------------
int __fastcall RSNSupplicant::free(RSNSupplicant *this)
{
  RSNSupplicant *v1; // r14@1
  __int64 v2; // rsi@1
  __int64 v3; // rbx@2
  __int64 v4; // rdi@4

  v1 = this;
  v2 = *((_QWORD *)this + 32);
  if ( v2 )
  {
    do
    {
      v3 = *(_QWORD *)v2;
      RSNSupplicant::freeAuthenticator((__int64)this, v2);
      v2 = v3;
    }
    while ( v3 );
  }
  if ( *((_QWORD *)this + 2) )
  {
    v4 = *((_QWORD *)this + 30);
    if ( v4 )
    {
      if ( !((*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v4 + 568LL))(v4, v2) & 3)
        && IO80211Interface::enabledBySystem(*((IO80211Interface **)v1 + 2)) )
        (*(void (**)(void))(**((_QWORD **)v1 + 30) + 304LL))();
    }
  }
  return (*(int (__fastcall **)(RSNSupplicant *, __int64))(off_7B068[0] + 160))(v1, v2);
}
// 7B068: using guessed type __int64 off_7B068[9];

//----- (0000000000001920) ----------------------------------------------------
int __fastcall RSNSupplicant::freeAuthenticator(__int64 a1, __int64 a2)
{
  __int64 v2; // r14@1
  IO80211Interface *v3; // rdi@1
  int v4; // ST00_4@3
  __int64 v5; // rax@4
  __int64 v6; // rdi@6

  v2 = a1;
  v3 = *(IO80211Interface **)(a1 + 16);
  if ( v3 && IO80211Interface::debugFlags(v3) & 4 )
  {
    v4 = *(_BYTE *)(a2 + 702);
    IOLog(
      "RSNSupplicant: Releasing authenticator for %02x:%02x:%02x:%02x:%02x:%02x\n",
      *(_BYTE *)(a2 + 697),
      *(_BYTE *)(a2 + 698),
      *(_BYTE *)(a2 + 699),
      *(_BYTE *)(a2 + 700),
      *(_BYTE *)(a2 + 701));
    IO8Log(
      "RSNSupplicant: Releasing authenticator for %02x:%02x:%02x:%02x:%02x:%02x\n",
      *(_BYTE *)(a2 + 697),
      *(_BYTE *)(a2 + 698),
      *(_BYTE *)(a2 + 699),
      *(_BYTE *)(a2 + 700),
      *(_BYTE *)(a2 + 701),
      *(_BYTE *)(a2 + 702));
  }
  v5 = *(_QWORD *)a2;
  if ( *(_QWORD *)a2 )
    *(_QWORD *)(v5 + 8) = *(_QWORD *)(a2 + 8);
  **(_QWORD **)(a2 + 8) = v5;
  RSNSupplicant::joinPTKThread(v2, a2);
  v6 = *(_QWORD *)(a2 + 688);
  if ( v6 )
    thread_call_free(v6, a2);
  return IOFree(a2, 968LL);
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8DD0: using guessed type int __fastcall thread_call_free(_QWORD, _QWORD);

//----- (0000000000001A0A) ----------------------------------------------------
char __usercall RSNSupplicant::parseWPAIE@<al>(RSNSupplicant *this@<rdi>, unsigned __int8 *a2@<rsi>, char a3@<al>)
{
  unsigned __int8 *v3; // rbx@1
  RSNSupplicant *v4; // r15@1
  IO80211Interface *v5; // rdi@2
  __int64 v6; // rdx@3
  __int64 v7; // rcx@3
  __int64 v8; // r8@3
  __int64 v9; // r9@3
  const char *v10; // rbx@4
  unsigned __int8 *v11; // rdi@5
  IO80211Interface *v12; // rdi@6
  IO80211Interface *v13; // rdi@14
  IO80211Interface *v14; // rdi@17
  IO80211Interface *v15; // rdi@27
  IO80211Interface *v16; // rdi@30
  const void *v17; // rbx@36
  IO80211Interface *v18; // rdi@38
  IO80211Interface *v19; // rdi@41
  char v20; // r14@44
  __int64 v21; // rdx@44
  __int64 v22; // rcx@44
  __int64 v23; // r8@44
  __int64 v24; // r9@44
  IO80211Interface *v26; // rdi@49
  __int64 v27; // r8@50
  __int64 v28; // r9@50
  __int64 v29; // r8@51
  __int64 v30; // r9@51
  char v31; // [sp-8h] [bp-20h]@1

  v31 = a3;
  v3 = a2;
  v4 = this;
  if ( a2[1] <= 0x15u )
  {
    v5 = (IO80211Interface *)*((_QWORD *)this + 2);
    if ( v5 && IO80211Interface::debugFlags(v5) & 4 )
    {
      v10 = "parseWPAIE: Too short!\n";
LABEL_44:
      v20 = 0;
      IOLog(v10, a2, v6, v7, v8, v9);
      IO8Log(v10, (__int64)a2, v21, v22, v23, v24, v31);
      return v20;
    }
    return 0;
  }
  v11 = a2 + 2;
  a2 = (unsigned __int8 *)&_wpaOUIAndType;
  if ( memcmp(v11, &_wpaOUIAndType, 4uLL) )
  {
    v12 = (IO80211Interface *)*((_QWORD *)v4 + 2);
    if ( v12 && IO80211Interface::debugFlags(v12) & 4 )
    {
      v10 = "parseWPAIE: Invalid OUI or type.\n";
      goto LABEL_44;
    }
    return 0;
  }
  if ( *((_WORD *)v3 + 3) != 1 )
  {
    v14 = (IO80211Interface *)*((_QWORD *)v4 + 2);
    if ( v14 && IO80211Interface::debugFlags(v14) & 4 )
    {
      v10 = "parseWPAIE: Invalid IE version.\n";
      goto LABEL_44;
    }
    return 0;
  }
  a2 = (unsigned __int8 *)&_wpaSuiteWEP40;
  if ( !memcmp(v3 + 8, &_wpaSuiteWEP40, 4uLL) )
  {
    *((_DWORD *)v4 + 23) = 1;
  }
  else
  {
    a2 = (unsigned __int8 *)&_wpaSuiteWEP104;
    if ( !memcmp(v3 + 8, &_wpaSuiteWEP104, 4uLL) )
    {
      *((_DWORD *)v4 + 23) = 2;
    }
    else
    {
      a2 = (unsigned __int8 *)&_wpaSuiteTKIP;
      if ( !memcmp(v3 + 8, &_wpaSuiteTKIP, 4uLL) )
      {
        *((_DWORD *)v4 + 23) = 3;
      }
      else
      {
        a2 = (unsigned __int8 *)&_wpaSuiteCCMP;
        if ( memcmp(v3 + 8, &_wpaSuiteCCMP, 4uLL) )
        {
          v13 = (IO80211Interface *)*((_QWORD *)v4 + 2);
          if ( v13 && IO80211Interface::debugFlags(v13) & 4 )
          {
            v10 = "parseWPAIE: Error parsing group cipher\n";
            goto LABEL_44;
          }
          return 0;
        }
        *((_DWORD *)v4 + 23) = 5;
      }
    }
  }
  if ( *((_WORD *)v3 + 6) != 1 )
  {
    v16 = (IO80211Interface *)*((_QWORD *)v4 + 2);
    if ( v16 && IO80211Interface::debugFlags(v16) & 4 )
    {
      v10 = "parseWPAIE: Invalid uCipher number\n";
      goto LABEL_44;
    }
    return 0;
  }
  a2 = (unsigned __int8 *)&_wpaSuiteTKIP;
  if ( !memcmp(v3 + 14, &_wpaSuiteTKIP, 4uLL) )
  {
    *((_DWORD *)v4 + 24) = 3;
  }
  else
  {
    a2 = (unsigned __int8 *)&_wpaSuiteCCMP;
    if ( memcmp(v3 + 14, &_wpaSuiteCCMP, 4uLL) )
    {
      v15 = (IO80211Interface *)*((_QWORD *)v4 + 2);
      if ( v15 && IO80211Interface::debugFlags(v15) & 4 )
      {
        v10 = "parseWPAIE: Error parsing uCipher\n";
        goto LABEL_44;
      }
      return 0;
    }
    *((_DWORD *)v4 + 24) = 5;
  }
  if ( *((_WORD *)v3 + 9) != 1 )
  {
    v19 = (IO80211Interface *)*((_QWORD *)v4 + 2);
    if ( v19 && IO80211Interface::debugFlags(v19) & 4 )
    {
      v10 = "parseWPAIE: Too many auth sels\n";
      goto LABEL_44;
    }
    return 0;
  }
  v17 = v3 + 20;
  if ( !memcmp(v17, &_wpaAuth8021xUnspec, 4uLL) )
  {
    *((_DWORD *)v4 + 25) = 1;
  }
  else
  {
    a2 = (unsigned __int8 *)&_wpaAuthPSK;
    if ( memcmp(v17, &_wpaAuthPSK, 4uLL) )
    {
      v18 = (IO80211Interface *)*((_QWORD *)v4 + 2);
      if ( v18 && IO80211Interface::debugFlags(v18) & 4 )
      {
        v10 = "parseWPAIE: Error parsing auth sel\n";
        goto LABEL_44;
      }
      return 0;
    }
    *((_DWORD *)v4 + 25) = 2;
  }
  v26 = (IO80211Interface *)*((_QWORD *)v4 + 2);
  v20 = 1;
  if ( v26 && IO80211Interface::debugFlags(v26) & 4 )
  {
    IOLog(
      "parseWPAIE: groupCipherType = %d pairwiseCipherType = %d authSel = %d\n",
      *((_DWORD *)v4 + 23),
      *((_DWORD *)v4 + 24),
      *((_DWORD *)v4 + 25),
      v27,
      v28);
    IO8Log(
      "parseWPAIE: groupCipherType = %d pairwiseCipherType = %d authSel = %d\n",
      *((_DWORD *)v4 + 23),
      *((_DWORD *)v4 + 24),
      *((_DWORD *)v4 + 25),
      v29,
      v30,
      v31);
  }
  return v20;
}
// 77600: using guessed type _QWORD _wpaOUIAndType;
// 77604: using guessed type _QWORD _wpaSuiteWEP40;
// 77608: using guessed type _QWORD _wpaSuiteWEP104;
// 7760C: using guessed type _QWORD _wpaSuiteTKIP;
// 77610: using guessed type _QWORD _wpaSuiteCCMP;
// 77614: using guessed type _QWORD _wpaAuth8021xUnspec;
// 77618: using guessed type _QWORD _wpaAuthPSK;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000001D06) ----------------------------------------------------
char __usercall RSNSupplicant::parseRSNIE@<al>(RSNSupplicant *this@<rdi>, unsigned __int8 *a2@<rsi>, char a3@<al>)
{
  unsigned __int8 *v3; // rbx@1
  RSNSupplicant *v4; // r14@1
  IO80211Interface *v5; // rdi@2
  __int64 v6; // rdx@3
  __int64 v7; // rcx@3
  __int64 v8; // r8@3
  __int64 v9; // r9@3
  const char *v10; // r14@4
  IO80211Interface *v11; // rdi@10
  IO80211Interface *v12; // rdi@13
  IO80211Interface *v13; // rdi@23
  IO80211Interface *v14; // rdi@26
  const void *v15; // rbx@32
  IO80211Interface *v16; // rdi@36
  IO80211Interface *v17; // rdi@39
  char v18; // bl@42
  __int64 v19; // rdx@42
  __int64 v20; // rcx@42
  __int64 v21; // r8@42
  __int64 v22; // r9@42
  IO80211Interface *v24; // rdi@49
  __int64 v25; // r8@50
  __int64 v26; // r9@50
  __int64 v27; // r8@51
  __int64 v28; // r9@51
  char v29; // [sp-8h] [bp-20h]@1

  v29 = a3;
  v3 = a2;
  v4 = this;
  if ( a2[1] <= 0x11u )
  {
    v5 = (IO80211Interface *)*((_QWORD *)this + 2);
    if ( v5 && IO80211Interface::debugFlags(v5) & 4 )
    {
      v10 = "parseRSNIE: Too short!\n";
LABEL_42:
      v18 = 0;
      IOLog(v10, a2, v6, v7, v8, v9);
      IO8Log(v10, (__int64)a2, v19, v20, v21, v22, v29);
      return v18;
    }
    return 0;
  }
  if ( *((_WORD *)a2 + 1) != 1 )
  {
    v12 = (IO80211Interface *)*((_QWORD *)this + 2);
    if ( v12 && IO80211Interface::debugFlags(v12) & 4 )
    {
      v10 = "parseRSNIE: Invalid version\n";
      goto LABEL_42;
    }
    return 0;
  }
  a2 = (unsigned __int8 *)&_rsnSuiteWEP40;
  if ( !memcmp(v3 + 4, &_rsnSuiteWEP40, 4uLL) )
  {
    *((_DWORD *)this + 23) = 1;
  }
  else
  {
    a2 = (unsigned __int8 *)&_rsnSuiteWEP104;
    if ( !memcmp(v3 + 4, &_rsnSuiteWEP104, 4uLL) )
    {
      *((_DWORD *)this + 23) = 2;
    }
    else
    {
      a2 = (unsigned __int8 *)&_rsnSuiteTKIP;
      if ( !memcmp(v3 + 4, &_rsnSuiteTKIP, 4uLL) )
      {
        *((_DWORD *)this + 23) = 3;
      }
      else
      {
        a2 = (unsigned __int8 *)&_rsnSuiteCCMP;
        if ( memcmp(v3 + 4, &_rsnSuiteCCMP, 4uLL) )
        {
          v11 = (IO80211Interface *)*((_QWORD *)this + 2);
          if ( v11 && IO80211Interface::debugFlags(v11) & 4 )
          {
            v10 = "parseRSNIE: Error parsing group cipher\n";
            goto LABEL_42;
          }
          return 0;
        }
        *((_DWORD *)this + 23) = 5;
      }
    }
  }
  if ( *((_WORD *)v3 + 4) != 1 )
  {
    v14 = (IO80211Interface *)*((_QWORD *)this + 2);
    if ( v14 && IO80211Interface::debugFlags(v14) & 4 )
    {
      v10 = "parseRSNIE: Invalid uCipher number\n";
      goto LABEL_42;
    }
    return 0;
  }
  a2 = (unsigned __int8 *)&_rsnSuiteTKIP;
  if ( !memcmp(v3 + 10, &_rsnSuiteTKIP, 4uLL) )
  {
    *((_DWORD *)this + 24) = 3;
  }
  else
  {
    a2 = (unsigned __int8 *)&_rsnSuiteCCMP;
    if ( memcmp(v3 + 10, &_rsnSuiteCCMP, 4uLL) )
    {
      v13 = (IO80211Interface *)*((_QWORD *)this + 2);
      if ( v13 && IO80211Interface::debugFlags(v13) & 4 )
      {
        v10 = "parseRSNIE: Error parsing uCipher\n";
        goto LABEL_42;
      }
      return 0;
    }
    *((_DWORD *)this + 24) = 5;
  }
  if ( *((_WORD *)v3 + 7) != 1 )
  {
    v17 = (IO80211Interface *)*((_QWORD *)this + 2);
    if ( v17 && IO80211Interface::debugFlags(v17) & 4 )
    {
      v10 = "parseRSNIE: Too many auth sels\n";
      goto LABEL_42;
    }
    return 0;
  }
  v15 = v3 + 16;
  if ( !memcmp(v15, &_rsnAuth8021xUnspec, 4uLL) )
  {
    *((_DWORD *)this + 25) = 1;
  }
  else if ( !memcmp(v15, &_rsnAuthPSK, 4uLL) )
  {
    *((_DWORD *)this + 25) = 2;
  }
  else if ( !memcmp(v15, &_rsnAuthSHA256_IEEE8021X, 4uLL) )
  {
    *((_DWORD *)this + 25) = 5;
  }
  else
  {
    a2 = (unsigned __int8 *)&_rsnAuthSHA256_PSK;
    if ( memcmp(v15, &_rsnAuthSHA256_PSK, 4uLL) )
    {
      v16 = (IO80211Interface *)*((_QWORD *)this + 2);
      if ( v16 && IO80211Interface::debugFlags(v16) & 4 )
      {
        v10 = "parseRSNIE: Error parsing auth sel\n";
        goto LABEL_42;
      }
      return 0;
    }
    *((_DWORD *)this + 25) = 6;
  }
  v24 = (IO80211Interface *)*((_QWORD *)this + 2);
  v18 = 1;
  if ( v24 && IO80211Interface::debugFlags(v24) & 4 )
  {
    IOLog(
      "parseRSNIE: groupCipherType = %d pairwiseCipherType = %d authSel = %d\n",
      *((_DWORD *)v4 + 23),
      *((_DWORD *)v4 + 24),
      *((_DWORD *)v4 + 25),
      v25,
      v26);
    IO8Log(
      "parseRSNIE: groupCipherType = %d pairwiseCipherType = %d authSel = %d\n",
      *((_DWORD *)v4 + 23),
      *((_DWORD *)v4 + 24),
      *((_DWORD *)v4 + 25),
      v27,
      v28,
      v29);
  }
  return v18;
}
// 7761C: using guessed type _QWORD _rsnSuiteWEP40;
// 77620: using guessed type _QWORD _rsnSuiteWEP104;
// 77624: using guessed type _QWORD _rsnSuiteTKIP;
// 77628: using guessed type _QWORD _rsnSuiteCCMP;
// 7762C: using guessed type _QWORD _rsnAuth8021xUnspec;
// 77630: using guessed type _QWORD _rsnAuthPSK;
// 77634: using guessed type _QWORD _rsnAuthSHA256_IEEE8021X;
// 77638: using guessed type _QWORD _rsnAuthSHA256_PSK;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000002012) ----------------------------------------------------
char __fastcall RSNSupplicant::parseIE(RSNSupplicant *this, unsigned __int8 *a2)
{
  int v2; // eax@1
  char v3; // bl@2
  IO80211Interface *v4; // rdi@5
  __int64 v5; // rdx@6
  __int64 v6; // rcx@6
  __int64 v7; // r8@6
  __int64 v8; // r9@6
  __int64 v9; // rdx@7
  __int64 v10; // rcx@7
  __int64 v11; // r8@7
  __int64 v12; // r9@7
  char v14; // [sp+0h] [bp-10h]@0

  v2 = *a2;
  if ( v2 == 48 )
  {
    v3 = RSNSupplicant::parseRSNIE(this, a2, 48);
  }
  else if ( (unsigned __int8)v2 == 221 )
  {
    v3 = RSNSupplicant::parseWPAIE(this, a2, v2);
  }
  else
  {
    v4 = (IO80211Interface *)*((_QWORD *)this + 2);
    if ( v4 && IO80211Interface::debugFlags(v4) & 4 )
    {
      v3 = 0;
      IOLog("parseIE: Unknown element ID\n", a2, v5, v6, v7, v8);
      IO8Log("parseIE: Unknown element ID\n", (__int64)a2, v9, v10, v11, v12, v14);
    }
    else
    {
      v3 = 0;
    }
  }
  return v3;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000002078) ----------------------------------------------------
char __fastcall RSNSupplicant::initWithInterfaceIEAndMode(RSNSupplicant *this, IO80211Interface *a2, unsigned __int8 *a3, __int64 a4, __int64 a5, __int64 a6)
{
  int v6; // ebx@1
  unsigned __int8 *v7; // r12@1
  IO80211Interface *v8; // r14@1
  RSNSupplicant *v9; // r15@1
  __int64 v10; // rdx@8
  __int64 v11; // rcx@8
  __int64 v12; // r8@8
  __int64 v13; // r9@8
  const char *v14; // rbx@9
  char v15; // r14@10
  __int64 v17; // rax@13
  IO80211Interface *v18; // rdi@13
  __int64 v19; // rax@14
  IO80211Interface *v20; // rdi@16
  IO80211Interface *v21; // rdi@19
  __int64 v22; // rdx@20
  __int64 v23; // rcx@20
  __int64 v24; // r8@20
  __int64 v25; // r9@20
  __int64 v26; // rdx@21
  __int64 v27; // rcx@21
  __int64 v28; // r8@21
  __int64 v29; // r9@21
  IO80211Interface *v30; // rdi@22
  IO80211Interface *v31; // rdi@25
  IO80211Interface *v32; // rdi@31
  __int64 v33; // rdx@34
  __int64 v34; // rcx@34
  __int64 v35; // r8@34
  __int64 v36; // r9@34
  IO80211Interface *v37; // rdi@36
  int v38; // ST00_4@38
  int v39; // ecx@39
  int v40; // eax@39
  unsigned __int64 v41; // rax@40
  signed __int64 v42; // rcx@41
  char v43; // [sp+0h] [bp-40h]@0
  __int64 v44; // [sp+10h] [bp-30h]@1
  int v45; // [sp+18h] [bp-28h]@1

  v6 = a4;
  v7 = a3;
  v8 = a2;
  v9 = this;
  v45 = 0;
  v44 = 1LL;
  if ( !a2 || !a3 || !(unsigned __int8)(*(int (**)(void))(*(_QWORD *)this + 136LL))() )
  {
    v15 = 0;
    IOLog("initWithInterfaceAndIE: init() failed\n", a2, a3, a4, a5, a6);
    return v15;
  }
  *((_DWORD *)this + 66) = v6;
  if ( v6 != 2 )
  {
    if ( v6 != 1 )
    {
      v21 = (IO80211Interface *)*((_QWORD *)this + 2);
      if ( !v21 || !(IO80211Interface::debugFlags(v21) & 4) )
        return 0;
      v15 = 0;
      IOLog("initWithInterfaceAndIE: Unexpected operating mode (0x%x)\n", *((_DWORD *)v9 + 66), v22, v23, v24, v25);
      IO8Log(
        "initWithInterfaceAndIE: Unexpected operating mode (0x%x)\n",
        *((_DWORD *)v9 + 66),
        v26,
        v27,
        v28,
        v29,
        v43);
      return v15;
    }
    a2 = 0LL;
    if ( !RSNSupplicant::allocateAuthenticator(this, 0LL, 0LL) )
    {
      v31 = (IO80211Interface *)*((_QWORD *)this + 2);
      if ( v31 && IO80211Interface::debugFlags(v31) & 4 )
      {
        v14 = "initWithInterfaceAndIE: Failed to allocate authenticator\n";
        goto LABEL_34;
      }
      return 0;
    }
  }
  *((_QWORD *)this + 2) = v8;
  if ( v7[1] >= 0x81u )
  {
    if ( IO80211Interface::debugFlags(v8) & 4 )
    {
      v14 = "initWithInterfaceAndIE: inIE too large\n";
LABEL_34:
      v15 = 0;
      IOLog(v14, a2, v10, v11, v12, v13);
      IO8Log(v14, (__int64)a2, v33, v34, v35, v36, v43);
      return v15;
    }
    return 0;
  }
  a2 = (IO80211Interface *)v7;
  if ( !RSNSupplicant::parseIE(this, v7) )
  {
    v30 = (IO80211Interface *)*((_QWORD *)this + 2);
    if ( v30 && IO80211Interface::debugFlags(v30) & 4 )
    {
      v14 = "initWithInterfaceAndIE: error parsing RSN IE\n";
      goto LABEL_34;
    }
    return 0;
  }
  a2 = (IO80211Interface *)v7;
  memcpy((char *)this + 110, v7, v7[1] + 2LL);
  v17 = IO80211Interface::getController(*((IO80211Interface **)this + 2));
  *((_QWORD *)this + 3) = v17;
  v18 = (IO80211Interface *)*((_QWORD *)this + 2);
  if ( !v17 )
  {
    if ( v18 && IO80211Interface::debugFlags(v18) & 4 )
    {
      v14 = "initWithInterfaceAndIE: unable to obtain _controller\n";
      goto LABEL_34;
    }
    return 0;
  }
  v19 = IO80211Interface::getOutputQueue(v18);
  *((_QWORD *)v9 + 30) = v19;
  if ( !v19 )
  {
    v32 = (IO80211Interface *)*((_QWORD *)v9 + 2);
    if ( v32 && IO80211Interface::debugFlags(v32) & 4 )
    {
      v14 = "initWithInterfaceAndIE: unable to obtain _outputQueue\n";
      goto LABEL_34;
    }
    return 0;
  }
  a2 = (IO80211Interface *)3223873993;
  if ( (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, __int64 *))(**((_QWORD **)v9 + 3) + 3216LL))(
         *((_QWORD *)v9 + 3),
         3223873993LL,
         2LL,
         v8,
         &v44) )
  {
    v20 = (IO80211Interface *)*((_QWORD *)v9 + 2);
    if ( v20 && IO80211Interface::debugFlags(v20) & 4 )
    {
      v14 = "initWithInterfaceAndIE: getAUTH_TYPE failed\n";
      goto LABEL_34;
    }
    return 0;
  }
  if ( (*(int (__fastcall **)(_QWORD, _QWORD, signed __int64))(**((_QWORD **)v9 + 3) + 3160LL))(
         *((_QWORD *)v9 + 3),
         *((_QWORD *)v9 + 2),
         (char *)v9 + 104) )
    return 0;
  v37 = (IO80211Interface *)*((_QWORD *)v9 + 2);
  if ( v37 && IO80211Interface::debugFlags(v37) & 4 )
  {
    v38 = *((_BYTE *)v9 + 109);
    IOLog(
      "initWithInterfaceAndIE: _myMacAddress %02x:%02x:%02x:%02x:%02x:%02x\n",
      *((_BYTE *)v9 + 104),
      *((_BYTE *)v9 + 105),
      *((_BYTE *)v9 + 106),
      *((_BYTE *)v9 + 107),
      *((_BYTE *)v9 + 108));
    IO8Log(
      "initWithInterfaceAndIE: _myMacAddress %02x:%02x:%02x:%02x:%02x:%02x\n",
      *((_BYTE *)v9 + 104),
      *((_BYTE *)v9 + 105),
      *((_BYTE *)v9 + 106),
      *((_BYTE *)v9 + 107),
      *((_BYTE *)v9 + 108),
      *((_BYTE *)v9 + 109));
  }
  v39 = HIDWORD(v44);
  *((_DWORD *)v9 + 8) = HIDWORD(v44);
  v40 = v45;
  *((_DWORD *)v9 + 9) = v45;
  if ( v39 != 1 )
    return 0;
  v15 = 0;
  v41 = (unsigned int)(v40 - 1);
  if ( (unsigned int)v41 <= 0x3F )
  {
    v42 = -9223372036854775669LL;
    if ( _bittest((const unsigned __int64 *)&v42, v41) )
    {
      RSNSupplicant::clearKeys(v9);
      v15 = 1;
    }
  }
  return v15;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000023A2) ----------------------------------------------------
char __fastcall RSNSupplicant::allocateAuthenticator(RSNSupplicant *this, ether_addr *a2, unsigned __int8 *a3)
{
  unsigned __int8 *v3; // r15@1
  void *v4; // rax@1
  void *v5; // rbx@1
  size_t v6; // rdx@5
  __int64 v8; // rax@9
  char *v9; // r14@9

  v3 = a3;
  LODWORD(v4) = IOMalloc(968LL);
  v5 = v4;
  if ( !v4 )
    return 0;
  bzero(v4, 0x3C8uLL);
  *((_DWORD *)v5 + 57) = 0;
  if ( a2 )
  {
    memcpy((char *)v5 + 697, a2, 6uLL);
    *((_BYTE *)v5 + 703) = 1;
  }
  if ( v3 )
  {
    v6 = v3[1] + 2LL;
    if ( v6 >= 0x102 )
    {
      IOFree(v5, 968LL);
      return 0;
    }
    memcpy((char *)v5 + 704, v3, v6);
    *((_BYTE *)v5 + 961) = 1;
  }
  *((_BYTE *)v5 + 163) = 1;
  v8 = *((_QWORD *)this + 32);
  v9 = (char *)this + 256;
  *(_QWORD *)v5 = v8;
  if ( v8 )
    *(_QWORD *)(v8 + 8) = v5;
  *(_QWORD *)v9 = v5;
  *((_QWORD *)v5 + 1) = v9;
  return 1;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (0000000000002470) ----------------------------------------------------
int __fastcall RSNSupplicant::getCommandGate(RSNSupplicant *this)
{
  __int64 v1; // rdi@1
  int result; // eax@2

  v1 = *((_QWORD *)this + 3);
  if ( v1 )
    result = (*(int (**)(void))(*(_QWORD *)v1 + 2224LL))();
  else
    result = 0;
  return result;
}

//----- (000000000000248C) ----------------------------------------------------
void __fastcall RSNSupplicant::updateIE(RSNSupplicant *this, unsigned __int8 *a2)
{
  size_t v2; // rdx@1
  __int64 v3; // rcx@2
  __int64 v4; // r8@2
  __int64 v5; // r9@2

  v2 = (unsigned int)a2[1] + 2;
  if ( (unsigned int)v2 <= 0x80 )
  {
    memcpy((char *)this + 110, a2, v2);
    if ( IO80211Interface::debugFlags(*((IO80211Interface **)this + 2)) & 4 )
      hex_dump((unsigned __int8 *)this + 110, *((_BYTE *)this + 111) + 2, "updateIE", v3, v4, v5);
  }
}

//----- (00000000000024DF) ----------------------------------------------------
__int64 __fastcall hex_dump(unsigned __int8 *a1, int a2, const char *a3, __int64 a4, __int64 a5, __int64 a6)
{
  const char *v6; // r15@1
  int v7; // er14@1
  unsigned __int8 *v8; // rbx@1
  __int64 v9; // r13@1
  __va_list_tag *v10; // rsi@2
  __int64 v11; // rdx@2
  __int64 v12; // rcx@2
  __int64 v13; // r8@2
  __int64 v14; // r9@2
  __int64 v15; // rdx@2
  __int64 v16; // rcx@2
  __int64 v17; // r8@2
  __int64 v18; // r9@2
  char v20; // [sp+0h] [bp-80h]@2
  __int64 v21; // [sp+18h] [bp-68h]@1
  __int64 v22; // [sp+20h] [bp-60h]@1
  __int64 v23; // [sp+28h] [bp-58h]@1
  __va_list_tag v24; // [sp+30h] [bp-50h]@2
  __int64 v25; // [sp+50h] [bp-30h]@1
  char v26; // [sp+90h] [bp+10h]@0

  v6 = a3;
  v7 = a2;
  v8 = a1;
  v23 = a6;
  v22 = a5;
  v21 = a4;
  v9 = off_7B078[0];
  v25 = *(_QWORD *)off_7B078[0];
  if ( a2 )
  {
    v24.reg_save_area = &v20;
    v24.overflow_arg_area = &v26;
    v24.fp_offset = 48;
    v24.gp_offset = 24;
    IO8Loghv(a1, a2, (char *)a3, &v24);
    v10 = &v24;
    IOLogv(v6);
    IOLog(": ", &v24, v11, v12, v13, v14);
    if ( v7 > 0 )
    {
      do
      {
        v10 = (__va_list_tag *)*v8;
        IOLog("%02x ", v10, v15, v16, v17, v18);
        ++v8;
        --v7;
      }
      while ( v7 );
    }
    IOLog("\n", v10, v15, v16, v17, v18);
  }
  return *(_QWORD *)v9;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7730: using guessed type int __fastcall IOLogv(_QWORD);

//----- (00000000000025B2) ----------------------------------------------------
unsigned __int8 *__fastcall RSNSupplicant::findWPAIE(RSNSupplicant *this, unsigned __int8 *a2, unsigned __int64 *a3)
{
  unsigned __int64 *v3; // r14@1
  unsigned __int8 *v4; // rbx@1
  int v5; // er13@1
  __int64 v6; // r15@1
  int v7; // eax@5
  __int64 v8; // rax@10

  v3 = a3;
  v4 = a2;
  v5 = *(_DWORD *)a3;
  v6 = 0LL;
  if ( *(_DWORD *)a3 > 0 && a2 && v5 >= 3 )
  {
    v6 = 0LL;
    do
    {
      v7 = v4[1];
      if ( v7 + 2 > v5 )
        break;
      if ( *v4 == 221 && (unsigned __int8)v7 >= 5u )
      {
        if ( !memcmp(v4 + 2, &_wpaOUIAndType, 4uLL) )
        {
          *v3 = v5;
          return v4;
        }
        LOBYTE(v7) = v4[1];
      }
      v8 = (unsigned int)(unsigned __int8)v7 + 2;
      v5 -= v8;
      v4 += v8;
    }
    while ( v5 > 2 );
  }
  return (unsigned __int8 *)v6;
}
// 77600: using guessed type _QWORD _wpaOUIAndType;

//----- (000000000000264C) ----------------------------------------------------
char __fastcall RSNSupplicant::wpaIECompatible(RSNSupplicant *this, unsigned __int8 *a2, unsigned __int64 a3)
{
  RSNSupplicant *v3; // r14@1
  unsigned __int8 *v4; // r15@1
  int v5; // eax@2
  int v6; // ecx@4
  int v7; // edi@6
  unsigned __int8 *v8; // rbx@6
  int v9; // eax@6
  unsigned __int8 *v10; // rcx@7
  IO80211Interface *v11; // rdi@8
  __int64 v12; // rdx@9
  __int64 v13; // rcx@9
  __int64 v14; // r8@9
  __int64 v15; // r9@9
  const char *v16; // r14@10
  char v17; // bl@11
  __int64 v18; // rdx@11
  __int64 v19; // rcx@11
  __int64 v20; // r8@11
  __int64 v21; // r9@11
  unsigned int v22; // er12@15
  unsigned __int8 *v23; // r12@17
  IO80211Interface *v24; // rdi@18
  __int64 v25; // rdx@19
  __int64 v26; // rcx@19
  __int64 v27; // r8@19
  __int64 v28; // r9@19
  __int64 v29; // rdx@20
  __int64 v30; // rcx@20
  __int64 v31; // r8@20
  __int64 v32; // r9@20
  IO80211Interface *v33; // rdi@21
  __int64 v34; // rdx@22
  __int64 v35; // rcx@22
  __int64 v36; // r8@22
  __int64 v37; // r9@22
  __int64 v38; // rdx@23
  __int64 v39; // rcx@23
  __int64 v40; // r8@23
  __int64 v41; // r9@23
  int v42; // er12@26
  __int64 v43; // rdi@26
  int v44; // er13@26
  char v45; // bl@26
  bool v46; // zf@28
  char v47; // al@28
  unsigned __int16 v48; // r12@32
  const void *v49; // r15@33
  IO80211Interface *v50; // rdi@40
  IO80211Interface *v51; // rdi@43
  char v53; // [sp+0h] [bp-60h]@0
  unsigned __int16 v54; // [sp+Eh] [bp-52h]@25
  unsigned __int8 *v55; // [sp+10h] [bp-50h]@24
  unsigned __int8 *v56; // [sp+18h] [bp-48h]@24
  int v57; // [sp+20h] [bp-40h]@24
  int v58; // [sp+20h] [bp-40h]@33
  int v59; // [sp+28h] [bp-38h]@33
  unsigned __int64 v60; // [sp+30h] [bp-30h]@1

  v3 = this;
  v60 = a3;
  v4 = RSNSupplicant::findWPAIE(this, a2, &v60);
  if ( !v4 )
  {
    v11 = (IO80211Interface *)*((_QWORD *)this + 2);
    if ( !v11 || !(IO80211Interface::debugFlags(v11) & 4) )
      return 0;
    v16 = "wpaIECompatible: No WPA IE found.\n";
    goto LABEL_11;
  }
  v5 = *((_DWORD *)this + 24) - 1;
  if ( (unsigned int)v5 > 4 )
    return 0;
  if ( v5 == 3 )
    return 0;
  v6 = *((_DWORD *)this + 23) - 1;
  if ( (unsigned int)v6 > 4 || v6 == 3 )
    return 0;
  v7 = v60;
  v8 = (unsigned __int8 *)off_7B480[v5];
  a2 = (unsigned __int8 *)off_7B480[v6];
  v9 = *((_DWORD *)v3 + 25);
  if ( v9 == 1 )
  {
    v10 = (unsigned __int8 *)&_wpaAuth8021xUnspec;
  }
  else
  {
    if ( v9 != 2 )
      return 0;
    v10 = (unsigned __int8 *)&_wpaAuthPSK;
  }
  if ( (signed int)v60 - 6 >= 2 )
  {
    v22 = *((_WORD *)v4 + 3);
    if ( v22 != 1 )
    {
      v33 = (IO80211Interface *)*((_QWORD *)v3 + 2);
      if ( v33 && IO80211Interface::debugFlags(v33) & 4 )
      {
        v17 = 0;
        IOLog("wpaIECompatible: Unsupported WPA version (%u).\n", v22, v34, v35, v36, v37);
        IO8Log("wpaIECompatible: Unsupported WPA version (%u).\n", v22, v38, v39, v40, v41, v53);
        return v17;
      }
      return 0;
    }
    if ( (signed int)v60 - 8 >= 4 )
    {
      v23 = v10;
      if ( memcmp(v4 + 8, a2, 4uLL) )
      {
        v24 = (IO80211Interface *)*((_QWORD *)v3 + 2);
        if ( v24 && IO80211Interface::debugFlags(v24) & 4 )
        {
          v17 = 0;
          IOLog("wpaIECompatible: Incompatible group cipher suite (%u).\n", v4[11], v25, v26, v27, v28);
          IO8Log("wpaIECompatible: Incompatible group cipher suite (%u).\n", v4[11], v29, v30, v31, v32, v53);
          return v17;
        }
        return 0;
      }
      v57 = v7;
      v56 = v23;
      a2 = v8;
      v55 = v8;
      if ( v7 - 12 >= 2 )
      {
        v54 = *((_WORD *)v4 + 6);
        if ( !v54 )
        {
LABEL_43:
          v51 = (IO80211Interface *)*((_QWORD *)v3 + 2);
          if ( !v51 || !(IO80211Interface::debugFlags(v51) & 4) )
            return 0;
          v16 = "wpaIECompatible: Unicast cipher suite not present.\n";
          goto LABEL_11;
        }
        v42 = v7 - 14;
        v43 = 0LL;
        v44 = 0;
        v45 = 0;
        while ( v42 >= 4 )
        {
          v46 = memcmp(&v4[v43 + 14], a2, 4uLL) == 0;
          v47 = 1;
          if ( !v46 )
            v47 = v45;
          v42 -= 4;
          ++v44;
          v43 += 4LL;
          v45 = v47;
          a2 = v55;
          if ( (unsigned __int16)v44 >= (unsigned int)v54 )
          {
            if ( !(v47 & 1) )
              goto LABEL_43;
            v48 = *(_WORD *)&v4[v43 + 14];
            if ( v48 )
            {
              v58 = v57 - 16 - v43;
              v49 = &v4[v43 + 16];
              v59 = 0;
              while ( v58 >= 4 )
              {
                a2 = v56;
                v17 = 1;
                if ( !memcmp(v49, v56, 4uLL) )
                  return v17;
                v49 = (char *)v49 + 4;
                v58 -= 4;
                ++v59;
                if ( (unsigned __int16)v59 >= (unsigned int)v48 )
                  goto LABEL_37;
              }
              break;
            }
LABEL_37:
            if ( *((_QWORD *)v3 + 2) && IO80211Interface::debugFlags(*((IO80211Interface **)v3 + 2)) & 4 )
            {
              v16 = "wpaIECompatible: Authentication selector not present.\n";
              goto LABEL_11;
            }
            return 0;
          }
        }
      }
    }
  }
  v50 = (IO80211Interface *)*((_QWORD *)v3 + 2);
  if ( !v50 || !(IO80211Interface::debugFlags(v50) & 4) )
    return 0;
  v16 = "wpaIECompatible: WPA IE too short.\n";
LABEL_11:
  v17 = 0;
  IOLog(v16, a2, v12, v13, v14, v15);
  IO8Log(v16, (__int64)a2, v18, v19, v20, v21, v53);
  return v17;
}
// 77614: using guessed type _QWORD _wpaAuth8021xUnspec;
// 77618: using guessed type _QWORD _wpaAuthPSK;
// 7B480: using guessed type _QWORD *off_7B480[3];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000295E) ----------------------------------------------------
unsigned __int8 *__fastcall RSNSupplicant::findRSNIE(RSNSupplicant *this, unsigned __int8 *a2, unsigned __int64 *a3)
{
  signed int v3; // er8@1
  unsigned __int8 *result; // rax@1
  __int64 v5; // r9@5
  signed int v6; // ecx@5

  v3 = *(_DWORD *)a3;
  result = 0LL;
  if ( *(_DWORD *)a3 > 0 && a2 && v3 >= 3 )
  {
    result = 0LL;
    do
    {
      v5 = (unsigned int)a2[1] + 2;
      v6 = v3 - v5;
      if ( v3 < (signed int)v5 )
        break;
      if ( *a2 == 48 )
      {
        *a3 = v3;
        return a2;
      }
      a2 += v5;
      v3 -= v5;
    }
    while ( v6 > 2 );
  }
  return result;
}

//----- (00000000000029AA) ----------------------------------------------------
char __fastcall RSNSupplicant::rsnIECompatible(RSNSupplicant *this, unsigned __int8 *a2, unsigned __int64 a3)
{
  RSNSupplicant *v3; // r14@1
  unsigned __int8 *v4; // r15@1
  int v5; // er13@2
  int v6; // eax@4
  char v7; // bl@6
  int v8; // ecx@6
  unsigned __int8 *v9; // rdi@6
  IO80211Interface *v10; // rdi@8
  __int64 v11; // rdx@9
  __int64 v12; // rcx@9
  __int64 v13; // r8@9
  __int64 v14; // r9@9
  const char *v15; // r14@10
  __int64 v16; // rdx@11
  __int64 v17; // rcx@11
  __int64 v18; // r8@11
  __int64 v19; // r9@11
  unsigned int v20; // er12@15
  int v21; // ebx@17
  IO80211Interface *v22; // rdi@18
  __int64 v23; // rdx@19
  __int64 v24; // rcx@19
  __int64 v25; // r8@19
  __int64 v26; // r9@19
  __int64 v27; // rdx@20
  __int64 v28; // rcx@20
  __int64 v29; // r8@20
  __int64 v30; // r9@20
  IO80211Interface *v31; // rdi@21
  __int64 v32; // rdx@22
  __int64 v33; // rcx@22
  __int64 v34; // r8@22
  __int64 v35; // r9@22
  __int64 v36; // rdx@23
  __int64 v37; // rcx@23
  __int64 v38; // r8@23
  __int64 v39; // r9@23
  int v40; // er13@26
  int v41; // er12@26
  char v42; // bl@26
  bool v43; // zf@28
  char v44; // al@28
  unsigned __int16 v45; // r12@33
  int v46; // edx@34
  unsigned __int8 *v47; // r15@34
  int v48; // er13@34
  int v49; // ebx@36
  int v50; // eax@36
  int v51; // ecx@36
  IO80211Interface *v52; // rdi@41
  IO80211Interface *v53; // rdi@44
  char v55; // [sp+0h] [bp-60h]@0
  const void *v56; // [sp+10h] [bp-50h]@26
  unsigned __int16 v57; // [sp+1Eh] [bp-42h]@25
  int v58; // [sp+20h] [bp-40h]@24
  int v59; // [sp+28h] [bp-38h]@28
  unsigned __int64 v60; // [sp+30h] [bp-30h]@1

  v3 = this;
  v60 = a3;
  v4 = RSNSupplicant::findRSNIE(this, a2, &v60);
  if ( v4 )
  {
    v5 = *((_DWORD *)this + 24) - 1;
    if ( (unsigned int)v5 <= 4 && v5 != 3 )
    {
      v6 = *((_DWORD *)this + 23) - 1;
      if ( (unsigned int)v6 <= 4 && v6 != 3 )
      {
        v7 = 0;
        v8 = *((_DWORD *)this + 25) - 1;
        a2 = (unsigned __int8 *)v60;
        v9 = (unsigned __int8 *)&_rsnAuth8021xUnspec;
        switch ( v8 )
        {
          case 1:
            v9 = (unsigned __int8 *)&_rsnAuthPSK;
            goto LABEL_14;
          case 4:
            v9 = (unsigned __int8 *)&_rsnAuthSHA256_IEEE8021X;
            goto LABEL_14;
          case 5:
            v9 = (unsigned __int8 *)&_rsnAuthSHA256_PSK;
            goto LABEL_14;
          case 0:
LABEL_14:
            if ( (signed int)v60 - 2 < 2 )
              goto LABEL_41;
            v20 = *((_WORD *)v4 + 1);
            if ( v20 != 1 )
            {
              v31 = (IO80211Interface *)*((_QWORD *)v3 + 2);
              if ( v31 && IO80211Interface::debugFlags(v31) & 4 )
              {
                v7 = 0;
                IOLog("rsnIECompatible: Unsupported RSN version (%u).\n", v20, v32, v33, v34, v35);
                IO8Log("rsnIECompatible: Unsupported RSN version (%u).\n", v20, v36, v37, v38, v39, v55);
                return v7;
              }
              return 0;
            }
            if ( (signed int)v60 - 4 < 4 )
              goto LABEL_41;
            v21 = v60;
            a2 = (unsigned __int8 *)off_7B4B0[v6];
            if ( memcmp(v4 + 4, a2, 4uLL) )
            {
              v22 = (IO80211Interface *)*((_QWORD *)v3 + 2);
              if ( v22 && IO80211Interface::debugFlags(v22) & 4 )
              {
                v7 = 0;
                IOLog("rsnIECompatible: Incompatible group cipher suite (%u).\n", v4[7], v23, v24, v25, v26);
                IO8Log("rsnIECompatible: Incompatible group cipher suite (%u).\n", v4[7], v27, v28, v29, v30, v55);
                return v7;
              }
              return 0;
            }
            v58 = v21;
            if ( v21 - 8 < 2 )
              goto LABEL_41;
            v57 = *((_WORD *)v4 + 4);
            if ( !v57 )
              goto LABEL_44;
            v56 = off_7B4B0[v5];
            v40 = v21 - 10;
            a2 = 0LL;
            v41 = 0;
            v42 = 0;
            break;
          default:
            return v7;
        }
        do
        {
          if ( v40 < 4 )
            goto LABEL_41;
          v59 = (signed int)a2;
          v43 = memcmp(&a2[(_QWORD)v4 + 10], v56, 4uLL) == 0;
          v44 = 1;
          if ( !v43 )
            v44 = v42;
          v40 -= 4;
          ++v41;
          a2 += 4;
          v42 = v44;
        }
        while ( (unsigned __int16)v41 < (unsigned int)v57 );
        if ( v44 & 1 )
        {
          if ( v40 >= 2 )
          {
            v45 = *(_WORD *)&a2[(_QWORD)v4 + 10];
            if ( !v45 )
            {
LABEL_38:
              if ( *((_QWORD *)v3 + 2) && IO80211Interface::debugFlags(*((IO80211Interface **)v3 + 2)) & 4 )
              {
                v15 = "rsnIECompatible: Authentication selector not present.\n";
                goto LABEL_11;
              }
              return 0;
            }
            v46 = v58 - 12 - (v59 + 4);
            v47 = &a2[(_QWORD)v4 + 12];
            v48 = 0;
            while ( v46 >= 4 )
            {
              v49 = v46;
              a2 = v9;
              v50 = memcmp(v47, v9, 4uLL);
              v51 = v49;
              v7 = 1;
              if ( !v50 )
                return v7;
              v47 += 4;
              v46 = v51 - 4;
              ++v48;
              if ( (unsigned __int16)v48 >= (unsigned int)v45 )
                goto LABEL_38;
            }
          }
LABEL_41:
          v52 = (IO80211Interface *)*((_QWORD *)v3 + 2);
          if ( v52 && IO80211Interface::debugFlags(v52) & 4 )
          {
            v15 = "rsnIECompatible: RSN IE too short.\n";
            goto LABEL_11;
          }
          return 0;
        }
LABEL_44:
        v53 = (IO80211Interface *)*((_QWORD *)v3 + 2);
        if ( v53 && IO80211Interface::debugFlags(v53) & 4 )
        {
          v15 = "rsnIECompatible: Unicast cipher suite not present.\n";
          goto LABEL_11;
        }
      }
    }
    return 0;
  }
  v10 = (IO80211Interface *)*((_QWORD *)this + 2);
  if ( !v10 || !(IO80211Interface::debugFlags(v10) & 4) )
    return 0;
  v15 = "rsnIECompatible: No RSN IE found.\n";
LABEL_11:
  v7 = 0;
  IOLog(v15, a2, v11, v12, v13, v14);
  IO8Log(v15, (__int64)a2, v16, v17, v18, v19, v55);
  return v7;
}
// 7762C: using guessed type _QWORD _rsnAuth8021xUnspec;
// 77630: using guessed type _QWORD _rsnAuthPSK;
// 77634: using guessed type _QWORD _rsnAuthSHA256_IEEE8021X;
// 77638: using guessed type _QWORD _rsnAuthSHA256_PSK;
// 7B4B0: using guessed type _QWORD *off_7B4B0[3];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000002CE4) ----------------------------------------------------
char __fastcall RSNSupplicant::shouldRoam(__int64 a1, __int64 a2)
{
  int v2; // eax@1
  char result; // al@4

  v2 = *(_DWORD *)(a1 + 36);
  if ( v2 == 8 || v2 == 4 )
  {
    result = RSNSupplicant::rsnIECompatible((RSNSupplicant *)a1, *(unsigned __int8 **)(a2 + 144), *(_WORD *)(a2 + 138));
  }
  else if ( (unsigned int)(v2 - 1) > 1 )
  {
    result = 0;
  }
  else
  {
    result = RSNSupplicant::wpaIECompatible((RSNSupplicant *)a1, *(unsigned __int8 **)(a2 + 144), *(_WORD *)(a2 + 138));
  }
  return result;
}

//----- (0000000000002D30) ----------------------------------------------------
char __usercall RSNSupplicant::inputEAPOLFrame@<al>(RSNSupplicant *this@<rdi>, __mbuf *a2@<rsi>, char a3)
{
  __int64 v3; // r14@1
  __int64 v4; // r13@1
  __int64 v5; // rax@1
  __int64 v6; // r12@1
  __int64 v7; // rax@1
  __int64 v8; // rbx@1
  IO80211Interface *v9; // rdi@2
  __int64 v10; // rdx@3
  __int64 v11; // rcx@3
  __int64 v12; // r8@3
  __int64 v13; // r9@3
  const char *v14; // rbx@4
  IO80211Interface *v15; // rdi@6
  IO80211Interface *v16; // rdi@10
  __int64 v17; // rdx@13
  __int64 v18; // rcx@13
  __int64 v19; // r8@13
  __int64 v20; // r9@13
  signed int v21; // er15@18
  IO80211Interface *v22; // rdi@19
  __int64 v23; // rdx@20
  __int64 v24; // rcx@20
  __int64 v25; // r8@20
  __int64 v26; // r9@20
  __int64 v27; // rdx@21
  __int64 v28; // rcx@21
  __int64 v29; // r8@21
  __int64 v30; // r9@21
  const char *v31; // rdi@21
  __int64 v32; // rsi@21
  IO80211Interface *v33; // rdi@22
  int v34; // ST00_4@24
  unsigned __int64 v35; // r15@26
  unsigned __int16 v36; // cx@26
  signed int v37; // ebx@26
  unsigned int v38; // ecx@26
  IO80211Interface *v39; // rdi@27
  __int64 v40; // rdx@28
  __int64 v41; // rcx@28
  __int64 v42; // r8@28
  __int64 v43; // r9@28
  unsigned int v44; // ebx@29
  IO80211Interface *v45; // rdi@30
  IO80211Interface *v46; // rdi@33
  __int64 v47; // rdx@34
  __int64 v48; // rcx@34
  __int64 v49; // r8@34
  __int64 v50; // r9@34
  __int64 v51; // rdx@35
  __int64 v52; // rcx@35
  __int64 v53; // r8@35
  __int64 v54; // r9@35
  __int64 v55; // rbx@36
  __int16 v56; // dx@38
  __int16 v57; // r15@40
  IO80211Interface *v58; // rdi@43
  IO80211Interface *v59; // rdi@46
  __int64 v60; // rdx@47
  __int64 v61; // rcx@47
  __int64 v62; // r8@47
  __int64 v63; // r9@47
  IO80211Interface *v64; // rdi@49
  __int64 v65; // rdx@50
  __int64 v66; // rcx@50
  __int64 v67; // r8@50
  __int64 v68; // r9@50
  IO80211Interface *v69; // rdi@53
  IO80211Interface *v70; // rdi@56
  __int16 v71; // r12@59
  unsigned __int64 v72; // r15@59
  int v73; // eax@61
  __int64 v74; // rdx@65
  __int64 v75; // r8@65
  __int64 v76; // r9@65
  __int64 v77; // rdx@66
  __int64 v78; // r8@66
  __int64 v79; // r9@66
  __int64 v80; // rdx@75
  __int64 v81; // rcx@75
  __int64 v82; // r8@75
  __int64 v83; // r9@75
  __int64 v84; // rdx@76
  __int64 v85; // rcx@76
  __int64 v86; // r8@76
  __int64 v87; // r9@76
  __int64 v88; // rdx@80
  __int64 v89; // rcx@80
  __int64 v90; // r8@80
  __int64 v91; // r9@80
  __int64 v92; // rdx@81
  __int64 v93; // rcx@81
  __int64 v94; // r8@81
  __int64 v95; // r9@81
  __int64 v96; // rdx@90
  __int64 v97; // rcx@90
  __int64 v98; // r8@90
  __int64 v99; // r9@90
  __int64 v100; // rdx@91
  __int64 v101; // rcx@91
  __int64 v102; // r8@91
  __int64 v103; // r9@91
  int v104; // eax@92
  char v106; // [sp+0h] [bp-50h]@0
  unsigned int v107; // [sp+10h] [bp-40h]@38
  unsigned int v108; // [sp+1Ch] [bp-34h]@33
  __int64 v109; // [sp+20h] [bp-30h]@33

  v3 = (__int64)a2;
  v4 = (__int64)this;
  LODWORD(v5) = mbuf_data(a2);
  v6 = v5;
  LODWORD(v7) = mbuf_len(a2);
  v8 = v7;
  if ( *((_BYTE *)this + 40) )
  {
    v9 = (IO80211Interface *)*((_QWORD *)this + 2);
    if ( v9 )
    {
      LOBYTE(v7) = IO80211Interface::debugFlags(v9);
      if ( v7 & 4 )
      {
        v14 = "inputEAPOLFrame: WPA countermeasures are active, ignoring frame.\n";
LABEL_13:
        IOLog(v14, a2, v10, v11, v12, v13);
        LOBYTE(v7) = IO8Log(v14, (__int64)a2, v17, v18, v19, v20, a3);
        return v7;
      }
    }
  }
  else if ( (signed int)v7 > 13 )
  {
    a2 = (RSNSupplicant *)((char *)this + 104);
    LODWORD(v7) = memcmp((const void *)v6, (char *)this + 104, 6uLL);
    if ( !(_DWORD)v7 )
    {
      if ( *((_DWORD *)this + 66) == 1 )
      {
        v7 = *((_QWORD *)this + 32);
      }
      else
      {
        a2 = (__mbuf *)(v6 + 6);
        v7 = RSNSupplicant::authenticatorForAddr(this, (ether_addr *)(v6 + 6));
      }
      if ( !v7 )
      {
        v33 = (IO80211Interface *)*((_QWORD *)this + 2);
        if ( v33 )
        {
          LOBYTE(v7) = IO80211Interface::debugFlags(v33);
          if ( v7 & 4 )
          {
            v34 = *(_BYTE *)(v6 + 11);
            IOLog(
              "inputEAPOLFrame: No authenticator configured for %02x:%02x:%02x:%02x:%02x:%02x\n",
              *(_BYTE *)(v6 + 6),
              *(_BYTE *)(v6 + 7),
              *(_BYTE *)(v6 + 8),
              *(_BYTE *)(v6 + 9),
              *(_BYTE *)(v6 + 10));
            LOBYTE(v7) = IO8Log(
                           "inputEAPOLFrame: No authenticator configured for %02x:%02x:%02x:%02x:%02x:%02x\n",
                           *(_BYTE *)(v6 + 6),
                           *(_BYTE *)(v6 + 7),
                           *(_BYTE *)(v6 + 8),
                           *(_BYTE *)(v6 + 9),
                           *(_BYTE *)(v6 + 10),
                           *(_BYTE *)(v6 + 11));
          }
        }
        return v7;
      }
      v21 = v8 - 95 + 81;
      if ( v21 > 98 )
      {
        if ( *(_BYTE *)(v6 + 15) != 3 )
        {
          v45 = (IO80211Interface *)*((_QWORD *)this + 2);
          if ( v45 )
          {
            LOBYTE(v7) = IO80211Interface::debugFlags(v45);
            if ( v7 & 4 )
            {
              v14 = "inputEAPOLFrame: Dropping EAPOL frame, not key frame\n";
              goto LABEL_13;
            }
          }
          return v7;
        }
        v35 = ((unsigned __int64)((v8 << 32) - 77309411328LL) >> 32) + 4294967201u;
        v36 = __ROL2__(*(_WORD *)(v6 + 111), 8);
        v37 = v36;
        v38 = v35 - v36;
        if ( (signed int)v35 >= v37 )
        {
          v108 = v38;
          v109 = v7;
          v46 = (IO80211Interface *)*((_QWORD *)this + 2);
          if ( v46 && IO80211Interface::debugFlags(v46) & 4 )
          {
            IOLog("inputEAPOLFrame: %d extra bytes present in EAPOL frame.\n", v108, v47, v48, v49, v50);
            IO8Log("inputEAPOLFrame: %d extra bytes present in EAPOL frame.\n", v108, v51, v52, v53, v54, v106);
          }
          v55 = v6 + 18;
          LODWORD(v7) = *(_BYTE *)(v6 + 18);
          if ( (_DWORD)v7 != 254 && (unsigned __int8)v7 != 2 )
          {
            v64 = *(IO80211Interface **)(v4 + 16);
            if ( !v64 )
              return v7;
            LOBYTE(v7) = IO80211Interface::debugFlags(v64);
            if ( !(v7 & 4) )
              return v7;
            IOLog("inputEAPOLFrame: Dropping EAPOL frame, invalid key type (%d)\n", *(_BYTE *)v55, v65, v66, v67, v68);
            v32 = *(_BYTE *)v55;
            v31 = "inputEAPOLFrame: Dropping EAPOL frame, invalid key type (%d)\n";
          }
          else
          {
            LOWORD(v7) = __ROL2__(*(_WORD *)(v6 + 19), 8);
            v56 = v7;
            LODWORD(v7) = v7 & 7;
            v107 = v7;
            LODWORD(v7) = v7 - 1;
            if ( (unsigned int)v7 < 3 )
            {
              a2 = (__mbuf *)v109;
              if ( *(_BYTE *)(v109 + 16)
                && (v57 = v56,
                    LODWORD(v7) = memcmp((const void *)(v6 + 23), (const void *)(v109 + 17), 8uLL),
                    v56 = v57,
                    a2 = (__mbuf *)v109,
                    (signed int)v7 <= 0) )
              {
                v70 = *(IO80211Interface **)(v4 + 16);
                if ( v70 )
                {
                  LOBYTE(v7) = IO80211Interface::debugFlags(v70);
                  if ( v7 & 4 )
                  {
                    v14 = "inputEAPOLFrame: Dropping EAPOL frame, replay counter did not increase\n";
                    goto LABEL_13;
                  }
                }
              }
              else if ( v56 & 0x80 )
              {
                if ( HIBYTE(v56) & 8 )
                {
                  v58 = *(IO80211Interface **)(v4 + 16);
                  if ( v58 )
                  {
                    LOBYTE(v7) = IO80211Interface::debugFlags(v58);
                    if ( v7 & 4 )
                    {
                      v14 = "inputEAPOLFrame: Dropping EAPOL frame, request bit set\n";
                      goto LABEL_13;
                    }
                  }
                }
                else
                {
                  v71 = v56;
                  v72 = v56 & 0x100;
                  if ( !(v56 & 0x100)
                    || (LOBYTE(v7) = RSNSupplicant::validateEAPOLMIC(v4, (__int64)a2, v3, v55, v107, (signed int)v108),
                        (_BYTE)v7) )
                  {
                    v73 = *(_DWORD *)(v4 + 36);
                    if ( v73 != 4 && v73 != 8 )
                      goto LABEL_104;
                    if ( !(HIBYTE(v71) & 0x10) )
                      goto LABEL_104;
                    if ( *(_QWORD *)(v4 + 16) && IO80211Interface::debugFlags(*(IO80211Interface **)(v4 + 16)) & 4 )
                    {
                      IOLog(
                        "inputEAPOLFrame: decrypting key data\n",
                        a2,
                        v74,
                        "inputEAPOLFrame: decrypting key data\n",
                        v75,
                        v76);
                      IO8Log(
                        "inputEAPOLFrame: decrypting key data\n",
                        (__int64)a2,
                        v77,
                        (__int64)"inputEAPOLFrame: decrypting key data\n",
                        v78,
                        v79,
                        v106);
                    }
                    LOBYTE(v7) = RSNSupplicant::decryptKeyData(v55, v107, v4, (__int64)a2, v72);
                    if ( (_BYTE)v7 )
                    {
LABEL_104:
                      if ( v71 & 8 )
                      {
                        v7 = *(_QWORD *)(v4 + 16);
                        if ( v71 & 0x30 )
                        {
                          if ( v7 )
                          {
                            LOBYTE(v7) = IO80211Interface::debugFlags(*(IO80211Interface **)(v4 + 16));
                            if ( v7 & 4 )
                            {
                              v14 = "inputEAPOLFrame: Dropping EAPOL frame, pairwise key with non-zero index\n";
                              goto LABEL_13;
                            }
                          }
                        }
                        else if ( (_DWORD)v72 )
                        {
                          if ( v7 && IO80211Interface::debugFlags(*(IO80211Interface **)(v4 + 16)) & 4 )
                          {
                            IOLog("inputEAPOLFrame: Received message 3 of 4\n", a2, v88, v89, v90, v91);
                            IO8Log("inputEAPOLFrame: Received message 3 of 4\n", (__int64)a2, v92, v93, v94, v95, v106);
                          }
                          if ( !*((_BYTE *)a2 + 696) )
                          {
                            LOBYTE(v7) = RSNSupplicant::process3of4(v3, v55, v4, (__int64)a2, v107, a3);
                            return v7;
                          }
                          v7 = *(_QWORD *)(v4 + 16);
                          if ( v7 )
                          {
                            LOBYTE(v7) = IO80211Interface::debugFlags(*(IO80211Interface **)(v4 + 16));
                            if ( v7 & 4 )
                            {
                              v14 = "inputEAPOLFrame: Waiting to install PTK, dropping message.\n";
                              goto LABEL_13;
                            }
                          }
                        }
                        else
                        {
                          if ( v7 && IO80211Interface::debugFlags(*(IO80211Interface **)(v4 + 16)) & 4 )
                          {
                            IOLog("inputEAPOLFrame: Received message 1 of 4\n", a2, v96, v97, v98, v99);
                            IO8Log(
                              "inputEAPOLFrame: Received message 1 of 4\n",
                              (__int64)a2,
                              v100,
                              v101,
                              v102,
                              v103,
                              v106);
                          }
                          v104 = *(_DWORD *)(v4 + 36);
                          if ( (v104 == 4 || v104 == 8) && *(_DWORD *)(v4 + 100) == 1 || *(_BYTE *)(v4 + 56) )
                          {
                            LOBYTE(v7) = RSNSupplicant::process1of4((RSNSupplicant *)v4, (__int64)a2, v3, v55, v107);
                            return v7;
                          }
                          v7 = *(_QWORD *)(v4 + 16);
                          if ( v7 )
                          {
                            LOBYTE(v7) = IO80211Interface::debugFlags(*(IO80211Interface **)(v4 + 16));
                            if ( v7 & 4 )
                            {
                              v14 = "inputEAPOLFrame: PMK not set, ignoring message 1!\n";
                              goto LABEL_13;
                            }
                          }
                        }
                      }
                      else
                      {
                        v7 = *(_QWORD *)(v4 + 16);
                        if ( (_DWORD)v72 )
                        {
                          if ( v7 && IO80211Interface::debugFlags(*(IO80211Interface **)(v4 + 16)) & 4 )
                          {
                            IOLog("inputEAPOLFrame: Received message 1 of 2\n", a2, v80, v81, v82, v83);
                            IO8Log("inputEAPOLFrame: Received message 1 of 2\n", (__int64)a2, v84, v85, v86, v87, v106);
                          }
                          LOBYTE(v7) = RSNSupplicant::process1of2(v4, (__int64)a2, v3, v55, v107);
                        }
                        else if ( v7 )
                        {
                          LOBYTE(v7) = IO80211Interface::debugFlags(*(IO80211Interface **)(v4 + 16));
                          if ( v7 & 4 )
                          {
                            v14 = "inputEAPOLFrame: Dropping EAPOL frame, group key without MIC bit set\n";
                            goto LABEL_13;
                          }
                        }
                      }
                    }
                  }
                }
              }
              else
              {
                v69 = *(IO80211Interface **)(v4 + 16);
                if ( v69 )
                {
                  LOBYTE(v7) = IO80211Interface::debugFlags(v69);
                  if ( v7 & 4 )
                  {
                    v14 = "inputEAPOLFrame: Dropping EAPOL frame, no ack bit set\n";
                    goto LABEL_13;
                  }
                }
              }
              return v7;
            }
            v59 = *(IO80211Interface **)(v4 + 16);
            if ( !v59 )
              return v7;
            LOBYTE(v7) = IO80211Interface::debugFlags(v59);
            if ( !(v7 & 4) )
              return v7;
            IOLog("inputEAPOLFrame: Dropping EAPOL frame, unknown key type (%d)\n", v107, v60, v61, v62, v63);
            v31 = "inputEAPOLFrame: Dropping EAPOL frame, unknown key type (%d)\n";
            v32 = v107;
          }
        }
        else
        {
          v39 = (IO80211Interface *)*((_QWORD *)this + 2);
          if ( !v39 )
            return v7;
          LOBYTE(v7) = IO80211Interface::debugFlags(v39);
          if ( !(v7 & 4) )
            return v7;
          v44 = v37 - v35;
          IOLog("inputEAPOLFrame: Dropping EAPOL frame, key data missing (%d bytes)\n", v44, v40, v41, v42, v43);
          v31 = "inputEAPOLFrame: Dropping EAPOL frame, key data missing (%d bytes)\n";
          v32 = v44;
        }
      }
      else
      {
        v22 = (IO80211Interface *)*((_QWORD *)this + 2);
        if ( !v22 )
          return v7;
        LOBYTE(v7) = IO80211Interface::debugFlags(v22);
        if ( !(v7 & 4) )
          return v7;
        IOLog("inputEAPOLFrame: Received non-key EAPOL frame (%u)\n", (unsigned int)v21, v23, v24, v25, v26);
        v31 = "inputEAPOLFrame: Received non-key EAPOL frame (%u)\n";
        v32 = (unsigned int)v21;
      }
      LOBYTE(v7) = IO8Log(v31, v32, v27, v28, v29, v30, a3);
      return v7;
    }
    v16 = (IO80211Interface *)*((_QWORD *)this + 2);
    if ( v16 )
    {
      LOBYTE(v7) = IO80211Interface::debugFlags(v16);
      if ( v7 & 4 )
      {
        v14 = "inputEAPOLFrame: WPA supplicant ignoring EAPOL frame, not for this interface\n";
        goto LABEL_13;
      }
    }
  }
  else
  {
    v15 = (IO80211Interface *)*((_QWORD *)this + 2);
    if ( v15 )
    {
      LOBYTE(v7) = IO80211Interface::debugFlags(v15);
      if ( v7 & 4 )
      {
        v14 = "inputEAPOLFrame: WPA supplicant ignoring EAPOL frame, missing ethernet header\n";
        goto LABEL_13;
      }
    }
  }
  return v7;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);

//----- (00000000000033F0) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::authenticatorForAddr(RSNSupplicant *this, ether_addr *a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // r14@1

  v2 = *((_QWORD *)this + 32);
  v3 = 0LL;
  if ( v2 )
  {
    v3 = 0LL;
    while ( memcmp((const void *)(v2 + 697), a2, 6uLL) )
    {
      v2 = *(_QWORD *)v2;
      if ( !v2 )
        return v3;
    }
    v3 = v2;
  }
  return v3;
}

//----- (0000000000003442) ----------------------------------------------------
char __fastcall RSNSupplicant::validateEAPOLMIC(__int64 a1, __int64 a2, __int64 a3, __int64 a4, unsigned __int16 a5, __int64 a6)
{
  __int64 v6; // r12@1
  __int64 v7; // rbx@1
  __int64 v8; // r14@1
  __int64 v9; // rax@1
  __int64 v10; // rax@1
  unsigned __int8 *v11; // r13@1
  __int64 v12; // r15@1
  __int64 v13; // rsi@1
  IO80211Interface *v14; // rdi@3
  __int64 v15; // rdx@4
  __int64 v16; // rcx@4
  __int64 v17; // r8@4
  __int64 v18; // r9@4
  __int64 v19; // rdx@5
  __int64 v20; // rcx@5
  __int64 v21; // r8@5
  __int64 v22; // r9@5
  IO80211Interface *v23; // rdi@8
  __int64 v24; // rdx@9
  __int64 v25; // rcx@9
  __int64 v26; // r8@9
  __int64 v27; // r9@9
  const char *v28; // r14@10
  IO80211Interface *v29; // rdi@11
  char v30; // bl@14
  __int64 v31; // rdx@14
  __int64 v32; // rcx@14
  __int64 v33; // r8@14
  __int64 v34; // r9@14
  __int64 v35; // rax@18
  char v37; // [sp+0h] [bp-70h]@0
  __int64 v38; // [sp+10h] [bp-60h]@1
  __int64 v39; // [sp+18h] [bp-58h]@1
  unsigned __int16 v40; // [sp+24h] [bp-4Ch]@1
  __int64 v41; // [sp+28h] [bp-48h]@1
  char v42; // [sp+30h] [bp-40h]@1
  __int64 v43; // [sp+40h] [bp-30h]@1

  v41 = a6;
  v40 = a5;
  v6 = a4;
  v7 = a3;
  v8 = a2;
  v38 = a1;
  v43 = *(_QWORD *)off_7B078[0];
  LODWORD(v9) = mbuf_len(a3);
  v39 = v9;
  LODWORD(v10) = mbuf_data(v7);
  v11 = (unsigned __int8 *)(v10 + 14);
  v12 = v6 + 77;
  v13 = v6 + 77;
  memcpy(&v42, (const void *)(v6 + 77), 0x10uLL);
  if ( *(_BYTE *)(v8 + 33) )
  {
    bzero((void *)(v6 + 77), 0x10uLL);
    wpa_eapol_key_mic((unsigned __int8 *)(v8 + 34), v40, v11, v39 + -14 - v41, (unsigned __int8 *)v12);
    v13 = v6 + 77;
    if ( !memcmp(&v42, (const void *)v12, 0x10uLL) )
    {
      *(_BYTE *)(v8 + 33) = 0;
      *(_BYTE *)(v8 + 98) = 1;
      memcpy((void *)(v8 + 99), (const void *)(v8 + 34), 0x40uLL);
      goto LABEL_17;
    }
    v14 = *(IO80211Interface **)(a1 + 16);
    if ( v14 && IO80211Interface::debugFlags(v14) & 4 )
    {
      IOLog("validateEAPOLMIC: Invalid EAPOL-key MIC when using TPTK\n", v12, v15, v16, v17, v18);
      IO8Log("validateEAPOLMIC: Invalid EAPOL-key MIC when using TPTK\n", v12, v19, v20, v21, v22, v37);
    }
  }
  if ( !*(_BYTE *)(v8 + 98) )
  {
    v29 = *(IO80211Interface **)(v38 + 16);
    if ( v29 && IO80211Interface::debugFlags(v29) & 4 )
    {
      v28 = "validateEAPOLMIC: Could not verify EAPOL-key mic, dropping packet\n";
      goto LABEL_14;
    }
    goto LABEL_15;
  }
  bzero((void *)v12, 0x10uLL);
  wpa_eapol_key_mic((unsigned __int8 *)(v8 + 99), v40, v11, v39 + -14 - v41, (unsigned __int8 *)v12);
  v13 = v6 + 77;
  if ( memcmp(&v42, (const void *)v12, 0x10uLL) )
  {
    v23 = *(IO80211Interface **)(v38 + 16);
    if ( v23 && IO80211Interface::debugFlags(v23) & 4 )
    {
      v28 = "validateEAPOLMIC: Invalid EAPOL-key mic, dropping packet\n";
LABEL_14:
      v30 = 0;
      IOLog(v28, v13, v24, v25, v26, v27);
      IO8Log(v28, v13, v31, v32, v33, v34, v37);
      goto LABEL_18;
    }
LABEL_15:
    v30 = 0;
    goto LABEL_18;
  }
LABEL_17:
  memcpy((void *)(v8 + 17), (const void *)(v6 + 5), 8uLL);
  *(_BYTE *)(v8 + 16) = 1;
  v30 = 1;
LABEL_18:
  v35 = *(_QWORD *)off_7B078[0];
  if ( *(_QWORD *)off_7B078[0] == v43 )
    LOBYTE(v35) = v30;
  return v35;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);

//----- (0000000000003632) ----------------------------------------------------
char __usercall RSNSupplicant::decryptKeyData@<al>(__int64 a1@<rdx>, int a2@<ecx>, __int64 a3@<rdi>, __int64 a4@<rsi>, unsigned __int64 a5@<r15>)
{
  __int64 v5; // r12@1
  const char *v6; // r14@1
  __int64 v7; // r13@1
  size_t v8; // rbx@1
  unsigned __int16 v9; // ax@2
  char result; // al@3
  IO80211Interface *v11; // rdi@4
  __int64 v12; // rdx@5
  __int64 v13; // rcx@5
  __int64 v14; // r8@5
  __int64 v15; // r9@5
  __int64 v16; // rdx@7
  __int64 v17; // rcx@7
  __int64 v18; // r8@7
  __int64 v19; // r9@7
  IO80211Interface *v20; // rdi@11
  __int64 v21; // rdx@12
  __int64 v22; // rcx@12
  __int64 v23; // r8@12
  __int64 v24; // r9@12
  __int64 v25; // rdx@13
  __int64 v26; // rcx@13
  __int64 v27; // r8@13
  __int64 v28; // r9@13
  unsigned __int8 *v29; // rax@14
  int v30; // esi@15
  unsigned __int8 *v31; // rdi@15
  IO80211Interface *v32; // rdi@16
  __int16 v33; // bx@22
  char v34; // [sp+0h] [bp-50h]@3
  char v35; // [sp+10h] [bp-40h]@3
  __int64 v36; // [sp+20h] [bp-30h]@1

  v5 = a1;
  v6 = (const char *)a4;
  v7 = a3;
  v8 = off_7B078[0];
  v36 = *(_QWORD *)off_7B078[0];
  if ( !*(_BYTE *)(a4 + 98) )
  {
    v11 = *(IO80211Interface **)(a3 + 16);
    if ( !v11 || !(IO80211Interface::debugFlags(v11) & 4) )
      goto LABEL_8;
    v6 = "decryptKeyData: PTK not set, unable to decrypt EAPOL key data\n";
    goto LABEL_7;
  }
  v9 = __ROL2__(*(_WORD *)(a1 + 93), 8);
  a5 = v9;
  if ( a2 != 1 )
  {
    result = 1;
    if ( (a2 & 0xFFFFFFFE) != 2 )
      goto LABEL_20;
    if ( a5 & 7 )
    {
      v20 = *(IO80211Interface **)(a3 + 16);
      if ( v20 )
      {
        if ( IO80211Interface::debugFlags(v20) & 4 )
        {
          IOLog("decryptKeyData: Unsupported AES wrap length (%d)\n", (unsigned int)a5, v21, v22, v23, v24);
          IO8Log("decryptKeyData: Unsupported AES wrap length (%d)\n", (unsigned int)a5, v25, v26, v27, v28, v34);
        }
      }
      goto LABEL_19;
    }
    a5 = (unsigned int)(a5 - 8);
    v8 = (signed int)a5;
    LODWORD(v29) = IOMalloc((signed int)a5);
    if ( !v29 )
    {
LABEL_19:
      result = 0;
      goto LABEL_20;
    }
    v30 = (signed int)a5 / 8;
    a5 = v5 + 95;
    v31 = (unsigned __int8 *)(v6 + 115);
    v6 = (const char *)v29;
    if ( !(unsigned int)_aes_unwrap(v31, v30, (unsigned __int8 *)(v5 + 95), v29) )
      goto LABEL_22;
    a4 = v8;
    IOFree(v6, v8);
    v32 = *(IO80211Interface **)(v7 + 16);
    v8 = off_7B078[0];
    if ( !v32 || !(IO80211Interface::debugFlags(v32) & 4) )
    {
LABEL_8:
      result = 0;
      goto LABEL_21;
    }
    v6 = "decryptKeyData: aes_unwrap failed\n";
LABEL_7:
    IOLog(v6, a4, v12, v13, v14, v15);
    IO8Log(v6, a4, v16, v17, v18, v19, v34);
    goto LABEL_8;
  }
  memcpy(&v34, (const void *)(a1 + 45), 0x10uLL);
  v6 = (const char *)(a4 + 115);
  memcpy(&v35, (const void *)(a4 + 115), 0x10uLL);
  v5 += 95LL;
  rc4_skip((__int64)&v34, 32, 0x100uLL, v5, a5);
  result = 1;
LABEL_20:
  v8 = off_7B078[0];
LABEL_21:
  while ( *(_QWORD *)v8 != v36 )
  {
LABEL_22:
    memcpy((void *)a5, v6, v8);
    IOFree(v6, v8);
    v33 = __ROL2__(v8, 8);
    *(_WORD *)(v5 + 93) = v33;
    v8 = off_7B078[0];
    result = 1;
  }
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (0000000000003818) ----------------------------------------------------
int __usercall RSNSupplicant::process3of4@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<rdi>, __int64 a4@<rsi>, int a5@<r8d>, char a6)
{
  __int64 v6; // r14@1
  __int16 v7; // dx@1
  unsigned __int16 v8; // ax@1
  int v9; // ebx@1
  signed __int64 v10; // r14@2
  IO80211Interface **v11; // r12@2
  __int64 v12; // r13@2
  int v13; // edx@3
  __int64 v14; // rdx@18
  __int64 v15; // rcx@18
  __int64 v16; // r8@18
  __int64 v17; // r9@18
  __int64 v18; // rdx@19
  __int64 v19; // rcx@19
  __int64 v20; // r8@19
  __int64 v21; // r9@19
  __mbuf *v22; // rax@20
  __int64 v23; // rdx@31
  __int64 v24; // rcx@31
  __int64 v25; // r8@31
  __int64 v26; // r9@31
  __int64 v27; // rdx@32
  __int64 v28; // rcx@32
  __int64 v29; // r8@32
  __int64 v30; // r9@32
  int v31; // eax@35
  __int64 v32; // rbx@35
  __int64 v33; // rdx@39
  __int64 v34; // rcx@39
  __int64 v35; // r8@39
  __int64 v36; // r9@39
  const char *v37; // rbx@40
  int v38; // eax@46
  int v39; // er14@46
  __int64 v40; // rdx@49
  __int64 v41; // rcx@49
  __int64 v42; // r8@49
  __int64 v43; // r9@49
  __int64 v44; // rdx@50
  __int64 v45; // rcx@50
  __int64 v46; // r8@50
  __int64 v47; // r9@50
  __int64 v48; // rdx@52
  __int64 v49; // rcx@52
  __int64 v50; // r8@52
  __int64 v51; // r9@52
  __int64 v52; // rdx@53
  __int64 v53; // rcx@53
  __int64 v54; // r8@53
  __int64 v55; // r9@53
  __int64 v56; // rcx@54
  __int64 v57; // r8@54
  __int64 v58; // r9@54
  __int64 v59; // rdx@57
  __int64 v60; // rcx@57
  __int64 v61; // r8@57
  __int64 v62; // r9@57
  __int64 v63; // rdx@58
  __int64 v64; // rcx@58
  __int64 v65; // r8@58
  __int64 v66; // r9@58
  __int64 v67; // rcx@59
  __int64 v68; // r8@59
  __int64 v69; // r9@59
  const char *v70; // rdx@60
  unsigned __int8 *v71; // rdi@60
  int v72; // esi@60
  __int64 v73; // rdx@68
  __int64 v74; // rcx@68
  __int64 v75; // r8@68
  __int64 v76; // r9@68
  __int64 v77; // rdx@69
  __int64 v78; // rcx@69
  __int64 v79; // r8@69
  __int64 v80; // r9@69
  __int64 v81; // rdx@71
  __int64 v82; // rcx@71
  __int64 v83; // r8@71
  __int64 v84; // r9@71
  __int64 v85; // rdx@72
  __int64 v86; // rcx@72
  __int64 v87; // r8@72
  __int64 v88; // r9@72
  __int64 v89; // rcx@73
  __int64 v90; // r8@73
  __int64 v91; // r9@73
  __int64 v92; // rdx@76
  __int64 v93; // rcx@76
  __int64 v94; // r8@76
  __int64 v95; // r9@76
  __int64 v96; // rdx@77
  __int64 v97; // rcx@77
  __int64 v98; // r8@77
  __int64 v99; // r9@77
  __int64 v100; // rdx@85
  __int64 v101; // rcx@85
  __int64 v102; // r8@85
  __int64 v103; // r9@85
  unsigned __int16 v104; // r14@86
  __int64 v105; // rdx@89
  __int64 v106; // rcx@89
  __int64 v107; // r8@89
  __int64 v108; // r9@89
  unsigned int v109; // ebx@90
  const char *v110; // r14@90
  __int64 v111; // r13@103
  __mbuf *v112; // r14@103
  void *v113; // rax@104
  void *v114; // r15@104
  __int64 v115; // rax@104
  int v116; // ecx@104
  char v117; // al@104
  __int16 v118; // ax@107
  __int64 v119; // rax@109
  __int64 v120; // rdx@109
  __int64 v121; // r8@109
  __int64 v122; // r9@109
  __int64 v123; // rax@109
  __int64 v124; // rdx@109
  __int64 v125; // r8@109
  __int64 v126; // r9@109
  __int64 v127; // rsi@110
  __int64 v128; // rdx@110
  __int64 v129; // rcx@110
  signed __int64 v130; // rbx@112
  __int64 v131; // rdx@114
  __int64 v132; // rcx@114
  __int64 v133; // r8@114
  __int64 v134; // r9@114
  __int64 v135; // rdx@115
  __int64 v136; // rcx@115
  __int64 v137; // r8@115
  __int64 v138; // r9@115
  __int64 v139; // rcx@119
  __int64 v140; // r8@119
  __int64 v141; // r9@119
  __int64 v142; // rdx@120
  __int64 v143; // rcx@120
  __int64 v144; // r8@120
  __int64 v145; // r9@120
  __int64 v146; // rdi@123
  __int64 v147; // rax@124
  __int64 v148; // rdx@129
  __int64 v149; // rcx@129
  __int64 v150; // r8@129
  __int64 v151; // r9@129
  char v153; // [sp+0h] [bp-A0h]@0
  int v154; // [sp+14h] [bp-8Ch]@2
  __int64 v155; // [sp+18h] [bp-88h]@2
  __int64 v156; // [sp+20h] [bp-80h]@1
  __int16 v157; // [sp+28h] [bp-78h]@2
  int v158; // [sp+2Ch] [bp-74h]@1
  int v159; // [sp+30h] [bp-70h]@2
  signed __int64 v160; // [sp+38h] [bp-68h]@2
  __int64 v161; // [sp+40h] [bp-60h]@2
  int v162; // [sp+48h] [bp-58h]@2
  signed __int64 v163; // [sp+50h] [bp-50h]@2
  int v164; // [sp+58h] [bp-48h]@2
  __int64 v165; // [sp+60h] [bp-40h]@2
  unsigned __int8 *v166; // [sp+68h] [bp-38h]@2
  int v167; // [sp+70h] [bp-30h]@2

  v158 = a5;
  v156 = a1;
  v6 = a4;
  *(_DWORD *)(a4 + 232) = 0;
  v7 = __ROL2__(*(_WORD *)(a2 + 1), 8);
  v8 = __ROL2__(*(_WORD *)(a2 + 93), 8);
  v9 = v8;
  if ( v8 > 2u )
  {
    v155 = a4;
    v10 = a2 + 95;
    v161 = a2;
    v165 = a3;
    v11 = (IO80211Interface **)(a3 + 16);
    v157 = v7;
    v164 = 0;
    v167 = 0;
    v162 = 0;
    v159 = 0;
    v160 = 0LL;
    v163 = 0LL;
    v12 = 0LL;
    v166 = 0LL;
    v154 = v7 & 0x1000;
    while ( 1 )
    {
      LODWORD(v22) = *(_BYTE *)(v10 + 1);
      if ( (signed int)v22 + 2 > v9 )
      {
LABEL_28:
        v6 = v155;
        goto LABEL_30;
      }
      v13 = *(_BYTE *)v10;
      if ( v13 == 48 )
      {
        v12 = v10;
        v167 = (_DWORD)v22 + 2;
      }
      else
      {
        if ( (unsigned __int8)v13 != 221 )
          goto LABEL_17;
        if ( (unsigned __int8)v22 >= 6u
          && v9 >= 8
          && (a4 = (__int64)&WPA_OUI_TYPE, !memcmp((const void *)(v10 + 2), &WPA_OUI_TYPE, 4uLL))
          && *(_BYTE *)(v10 + 6) == 1
          && !*(_BYTE *)(v10 + 7) )
        {
          v164 = *(_BYTE *)(v10 + 1) + 2;
          v166 = (unsigned __int8 *)v10;
        }
        else
        {
          if ( *(_BYTE *)v10 != 221 || (unsigned int)*(_BYTE *)(v10 + 1) < 7 )
          {
LABEL_17:
            if ( *v11 && IO80211Interface::debugFlags(*v11) & 4 )
            {
              IOLog("process3of4: Unknown Elem ID %d\n", *(_BYTE *)v10, v14, v15, v16, v17);
              a4 = *(_BYTE *)v10;
              IO8Log("process3of4: Unknown Elem ID %d\n", a4, v18, v19, v20, v21, v153);
            }
            goto LABEL_20;
          }
          a4 = (__int64)&RSN_KEY_DATA_GROUPKEY;
          if ( !memcmp((const void *)(v10 + 2), &RSN_KEY_DATA_GROUPKEY, 4uLL) )
          {
            LODWORD(v22) = v154;
            if ( !(_WORD)v154 )
              goto LABEL_91;
            v163 = v10 + 6;
            v162 = *(_BYTE *)(v10 + 1) - 4;
          }
          else
          {
            if ( *(_BYTE *)v10 != 221 )
              goto LABEL_17;
            if ( (unsigned int)*(_BYTE *)(v10 + 1) < 7 )
              goto LABEL_17;
            a4 = (__int64)&RSN_KEY_DATA_GROUPKEY_BIP;
            if ( memcmp((const void *)(v10 + 2), &RSN_KEY_DATA_GROUPKEY_BIP, 4uLL) )
              goto LABEL_17;
            LODWORD(v22) = v154;
            if ( !(_WORD)v154 )
            {
LABEL_91:
              if ( *v11 )
              {
                LODWORD(v22) = IO80211Interface::debugFlags(*v11);
                if ( (unsigned __int8)v22 & 4 )
                {
                  v37 = "process3of4: GTK IE is not encrypted\n";
LABEL_85:
                  IOLog(v37, a4, v33, v34, v35, v36);
                  LODWORD(v22) = IO8Log(v37, a4, v100, v101, v102, v103, a6);
                }
              }
              return (signed int)v22;
            }
            v160 = v10 + 6;
            v159 = *(_BYTE *)(v10 + 1) - 4;
          }
        }
      }
LABEL_20:
      v22 = (__mbuf *)((unsigned int)*(_BYTE *)(v10 + 1) + 2);
      v9 -= (signed int)v22;
      v10 += (signed __int64)v22;
      if ( v9 <= 2 )
        goto LABEL_28;
    }
  }
  v157 = v7;
  v161 = a2;
  v165 = a3;
  v11 = (IO80211Interface **)(a3 + 16);
  v164 = 0;
  v167 = 0;
  v162 = 0;
  v159 = 0;
  v160 = 0LL;
  v163 = 0LL;
  v12 = 0LL;
  LODWORD(v22) = 0;
  v166 = 0LL;
LABEL_30:
  if ( *v11 )
  {
    LODWORD(v22) = IO80211Interface::debugFlags(*v11);
    if ( (unsigned __int8)v22 & 4 )
    {
      IOLog("process3of4: Performing IE check.\n", a4, v23, v24, v25, v26);
      LODWORD(v22) = IO8Log("process3of4: Performing IE check.\n", a4, v27, v28, v29, v30, v153);
    }
  }
  if ( !*(_BYTE *)(v6 + 961) )
  {
    if ( *v11 )
    {
      LODWORD(v22) = IO80211Interface::debugFlags(*v11);
      if ( (unsigned __int8)v22 & 4 )
      {
        v37 = "process3of4: No RSN IE cached!";
        goto LABEL_85;
      }
    }
    return (signed int)v22;
  }
  a4 = v12;
  LODWORD(v22) = (unsigned int)v166 | v12;
  if ( !((unsigned __int64)v166 | v12) )
  {
    if ( *v11 )
    {
      LODWORD(v22) = IO80211Interface::debugFlags(*v11);
      if ( (unsigned __int8)v22 & 4 )
      {
        v37 = "process3of4: No WPA/RSN IE found in message 3!\n";
        goto LABEL_85;
      }
    }
    return (signed int)v22;
  }
  v31 = *(_DWORD *)(v165 + 36);
  v32 = v6;
  if ( v31 == 4 )
  {
    if ( !v12 )
      goto LABEL_81;
  }
  else if ( v31 != 8 || !v12 )
  {
    goto LABEL_62;
  }
  v38 = *(_BYTE *)(v6 + 705) + 2;
  v39 = v167;
  if ( v38 != v167 || memcmp((const void *)(v32 + 704), (const void *)v12, v167) )
  {
    if ( *v11 )
    {
      if ( IO80211Interface::debugFlags(*v11) & 4 )
      {
        IOLog("process3of4: RSN IE does not match IE in beacon/probe response\n", v12, v40, v41, v42, v43);
        IO8Log("process3of4: RSN IE does not match IE in beacon/probe response\n", v12, v44, v45, v46, v47, v153);
      }
      if ( *v11 && IO80211Interface::debugFlags(*v11) & 4 )
      {
        IOLog("Cached RSN IE Length = %d\n", (unsigned int)*(_BYTE *)(v32 + 705) + 2, v48, v49, v50, v51);
        v39 = v167;
        IO8Log("Cached RSN IE Length = %d\n", (unsigned int)*(_BYTE *)(v32 + 705) + 2, v52, v53, v54, v55, v153);
      }
    }
    if ( IO80211Interface::debugFlags(*v11) & 4 )
      hex_dump((unsigned __int8 *)(v32 + 704), *(_BYTE *)(v32 + 705) + 2, "Cached RSN IE", v56, v57, v58);
    if ( *v11 && IO80211Interface::debugFlags(*v11) & 4 )
    {
      IOLog("Msg 3 RSN IE Length = %d\n", (unsigned int)v39, v59, v60, v61, v62);
      IO8Log("Msg 3 RSN IE Length = %d\n", (unsigned int)v39, v63, v64, v65, v66, v153);
    }
    LODWORD(v22) = IO80211Interface::debugFlags(*v11);
    if ( !((unsigned __int8)v22 & 4) )
      return (signed int)v22;
    v70 = "Msg 3 RSN IE";
    v71 = (unsigned __int8 *)v12;
    v72 = v39;
    goto LABEL_80;
  }
  v31 = *(_DWORD *)(v165 + 36);
LABEL_62:
  if ( v31 == 1 || v31 == 2 )
  {
    if ( v166 )
    {
      if ( *(_BYTE *)(v32 + 705) + 2 != v164 || (a4 = (__int64)v166, memcmp((const void *)(v32 + 704), v166, v164)) )
      {
        if ( *v11 )
        {
          if ( IO80211Interface::debugFlags(*v11) & 4 )
          {
            IOLog("process3of4: WPA IE does not match IE in beacon/probe response\n", a4, v73, v74, v75, v76);
            IO8Log("process3of4: WPA IE does not match IE in beacon/probe response\n", a4, v77, v78, v79, v80, v153);
          }
          if ( *v11 && IO80211Interface::debugFlags(*v11) & 4 )
          {
            IOLog("Cached WPA IE Length = %d\n", (unsigned int)*(_BYTE *)(v32 + 705) + 2, v81, v82, v83, v84);
            IO8Log("Cached WPA IE Length = %d\n", (unsigned int)*(_BYTE *)(v32 + 705) + 2, v85, v86, v87, v88, v153);
          }
        }
        if ( IO80211Interface::debugFlags(*v11) & 4 )
          hex_dump((unsigned __int8 *)(v32 + 704), *(_BYTE *)(v32 + 705) + 2, "Cached WPA IE", v89, v90, v91);
        if ( *v11 && IO80211Interface::debugFlags(*v11) & 4 )
        {
          IOLog("Msg 3 WPA IE Length = %d\n", (unsigned int)v164, v92, v93, v94, v95);
          IO8Log("Msg 3 WPA IE Length = %d\n", (unsigned int)v164, v96, v97, v98, v99, v153);
        }
        LODWORD(v22) = IO80211Interface::debugFlags(*v11);
        if ( !((unsigned __int8)v22 & 4) )
          return (signed int)v22;
        v70 = "Msg 3 WPA IE";
        v71 = v166;
        v72 = v164;
LABEL_80:
        LODWORD(v22) = hex_dump(v71, v72, v70, v67, v68, v69);
        return (signed int)v22;
      }
    }
  }
LABEL_81:
  a4 = v161 + 13;
  LODWORD(v22) = memcmp((const void *)(v32 + 196), (const void *)(v161 + 13), 0x20uLL);
  if ( (_DWORD)v22 )
  {
    if ( *v11 )
    {
      LODWORD(v22) = IO80211Interface::debugFlags(*v11);
      if ( (unsigned __int8)v22 & 4 )
      {
        v37 = "process3of4: Anonce from message 1 differs from that in message 3!\n";
        goto LABEL_85;
      }
    }
  }
  else
  {
    LOWORD(v22) = *(_WORD *)(v161 + 3);
    v104 = __ROL2__(*(_WORD *)(v161 + 3), 8);
    switch ( *(_DWORD *)(v165 + 96) )
    {
      case 1:
        LODWORD(v22) = (unsigned __int16)v22;
        if ( (unsigned __int16)v22 == 1280 )
          goto LABEL_103;
        if ( *v11 )
        {
          LODWORD(v22) = IO80211Interface::debugFlags(*v11);
          if ( (unsigned __int8)v22 & 4 )
          {
            v109 = v104;
            v110 = "process3of4: Invalid WEP-40 key length (%d)\n";
            goto LABEL_129;
          }
        }
        break;
      case 2:
        LODWORD(v22) = (unsigned __int16)v22;
        if ( (unsigned __int16)v22 == 3328 )
          goto LABEL_103;
        if ( *v11 )
        {
          LODWORD(v22) = IO80211Interface::debugFlags(*v11);
          if ( (unsigned __int8)v22 & 4 )
          {
            v109 = v104;
            v110 = "process3of4: Invalid WEP-104 key length (%d)\n";
            goto LABEL_129;
          }
        }
        break;
      case 3:
        LODWORD(v22) = (unsigned __int16)v22;
        if ( (unsigned __int16)v22 == 0x2000 )
          goto LABEL_103;
        if ( *v11 )
        {
          LODWORD(v22) = IO80211Interface::debugFlags(*v11);
          if ( (unsigned __int8)v22 & 4 )
          {
            v109 = v104;
            v110 = "process3of4: Invalid TKIP key length (%d)\n";
            goto LABEL_129;
          }
        }
        break;
      case 5:
        LODWORD(v22) = (unsigned __int16)v22;
        if ( (unsigned __int16)v22 == 4096 )
          goto LABEL_103;
        if ( *v11 )
        {
          LODWORD(v22) = IO80211Interface::debugFlags(*v11);
          if ( (unsigned __int8)v22 & 4 )
          {
            v109 = v104;
            v110 = "process3of4: Invalid CCMP key length (%d)\n";
LABEL_129:
            IOLog(v110, v109, v105, v106, v107, v108);
            LODWORD(v22) = IO8Log(v110, v109, v148, v149, v150, v151, a6);
          }
        }
        break;
      default:
LABEL_103:
        v111 = v32;
        LODWORD(v22) = (*(int (__fastcall **)(_QWORD, signed __int64))(**(_QWORD **)(v165 + 24) + 2344LL))(
                         *(_QWORD *)(v165 + 24),
                         113LL);
        v112 = v22;
        if ( v22 )
        {
          mbuf_setlen(v22, 113LL);
          LODWORD(v113) = mbuf_data(v112);
          v114 = v113;
          bzero(v113, 0x71uLL);
          memcpy((char *)v114 + 6, (const void *)(v165 + 104), 6uLL);
          LODWORD(v115) = mbuf_data(v156);
          memcpy(v114, (const void *)(v115 + 6), 6uLL);
          *((_WORD *)v114 + 6) = -29048;
          *((_BYTE *)v114 + 14) = 1;
          *((_BYTE *)v114 + 15) = 3;
          *((_WORD *)v114 + 8) = 24320;
          v116 = *(_DWORD *)(v165 + 36);
          v117 = 2;
          if ( v116 != 4 )
          {
            v117 = 2;
            if ( v116 != 8 )
              v117 = -2;
          }
          *((_BYTE *)v114 + 18) = v117;
          v118 = __ROL2__(v158 | v157 & 0x200 | 0x108, 8);
          *(_WORD *)((char *)v114 + 19) = v118;
          *(_WORD *)((char *)v114 + 21) = 0;
          memcpy((char *)v114 + 23, (const void *)(v161 + 5), 8uLL);
          *(_WORD *)((char *)v114 + 111) = 0;
          memcpy((char *)v114 + 31, (const void *)(v32 + 164), 0x20uLL);
          wpa_eapol_key_mic(
            (unsigned __int8 *)(v32 + 99),
            v158,
            (unsigned __int8 *)v114 + 14,
            0x63uLL,
            (unsigned __int8 *)v114 + 95);
          if ( *v11 && IO80211Interface::debugFlags(*v11) & 4 )
          {
            LODWORD(v119) = mbuf_len(v112);
            IOLog("process3of4: sending replyPacket ( len = %d ).\n", (unsigned int)v119, v120, v119, v121, v122);
            LODWORD(v123) = mbuf_len(v112);
            IO8Log("process3of4: sending replyPacket ( len = %d ).\n", (unsigned int)v123, v124, v123, v125, v126, v153);
          }
          v127 = (__int64)v112;
          IO80211Interface::outputEAPOLFrame(*v11, v112);
          if ( v157 & 0x40 )
          {
            v127 = v32;
            RSNSupplicant::wpaPTKToApplePTK(v157, v161, v165, v32);
          }
          v130 = v163;
          if ( v163 )
          {
            if ( *v11 && IO80211Interface::debugFlags(*v11) & 4 )
            {
              IOLog("process3of4: received pairwise GTK\n", v127, v131, v132, v133, v134);
              v130 = v163;
              IO8Log("process3of4: received pairwise GTK\n", v127, v135, v136, v137, v138, v153);
            }
            v127 = v111;
            RSNSupplicant::wpaGTKToAppleGTK(
              v165,
              v111,
              v161,
              (void *)(v130 + 2),
              v162 - 2,
              *(_BYTE *)v130 & 3,
              (unsigned __int8)(*(_BYTE *)v130 & 4) >> 2);
          }
          if ( v160 )
          {
            if ( *v11 && IO80211Interface::debugFlags(*v11) & 4 )
            {
              IOLog("process3of4: received pairwise GTK_BIP \n", v127, v128, v139, v140, v141);
              IO8Log("process3of4: received pairwise GTK_BIP \n", v127, v142, v143, v144, v145, v153);
            }
            RSNSupplicant::wpaIGTKToAppleIGTK(
              v165,
              v111,
              v128,
              v160 + 8,
              v159 - 8,
              *(_WORD *)v160,
              (const void *)(v160 + 2));
            *(_BYTE *)(v111 + 680) = 1;
          }
          else
          {
            *(_BYTE *)(v111 + 680) = 0;
          }
          v146 = *(_QWORD *)(v111 + 688);
          if ( !v146 )
          {
            LODWORD(v147) = thread_call_allocate(ptk_thread, v165);
            v146 = v147;
            *(_QWORD *)(v111 + 688) = v147;
          }
          *(_BYTE *)(v111 + 696) = 1;
          LODWORD(v22) = thread_call_enter1(v146, v111, v128, v129);
        }
        break;
    }
  }
  return (signed int)v22;
}
// 7765C: using guessed type _QWORD WPA_OUI_TYPE;
// 77660: using guessed type _QWORD RSN_KEY_DATA_GROUPKEY;
// 77664: using guessed type _QWORD RSN_KEY_DATA_GROUPKEY_BIP;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8CB0: using guessed type int __fastcall mbuf_setlen(_QWORD, _QWORD);
// C8DB0: using guessed type int __fastcall thread_call_allocate(_QWORD, _QWORD);
// C8DC8: using guessed type int __fastcall thread_call_enter1(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000004254) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::process1of4(RSNSupplicant *this, __int64 a2, __int64 a3, __int64 a4, int a5)
{
  int v5; // er13@1
  __int64 v6; // rbx@1
  __int64 v7; // r14@1
  __int64 v8; // r15@1
  __int64 v9; // r12@1
  __int64 v10; // rsi@1
  IO80211Interface *v11; // rdi@4
  __int64 v12; // rdx@5
  __int64 v13; // rcx@5
  __int64 v14; // r8@5
  __int64 v15; // r9@5
  __int64 v16; // rdx@7
  __int64 v17; // rcx@7
  __int64 v18; // r8@7
  __int64 v19; // r9@7
  int v20; // eax@9
  IO80211Interface *v21; // rdi@10
  __int64 v22; // rcx@11
  __int64 v23; // r8@11
  __int64 v24; // r9@11
  __int64 v25; // rcx@12
  __int64 v26; // r8@12
  __int64 v27; // r9@12
  unsigned __int16 v28; // ax@15
  int v29; // ecx@15
  __int64 v30; // rdx@16
  signed int v31; // ecx@16
  __int64 v32; // r13@16
  int v33; // eax@21
  unsigned __int16 v34; // ax@24
  signed int v35; // er12@24
  IO80211Interface *v36; // rdi@25
  __int64 v37; // rcx@26
  __int64 v38; // r8@26
  __int64 v39; // r9@26
  __int64 v40; // rcx@27
  __int64 v41; // r8@27
  __int64 v42; // r9@27
  IO80211Interface *v43; // rdi@28
  int v44; // ST00_4@30
  __int64 v45; // rax@36
  IO80211Interface *v46; // rdi@39
  __int64 v47; // rax@43
  __int64 v48; // rax@44
  size_t v49; // r13@44
  __int64 v50; // rax@44
  void *v51; // rax@45
  void *v52; // r12@45
  __int64 v53; // rax@45
  __int16 v54; // ax@45
  int v55; // ecx@45
  char v56; // al@45
  __int16 v57; // ax@48
  __int16 v58; // ax@48
  const void *v59; // r13@50
  __int64 v60; // rcx@50
  __int64 v61; // r8@50
  __int64 v62; // r9@50
  signed __int64 v63; // rax@52
  char *v64; // rdi@55
  const void *v65; // rsi@55
  char *v66; // rdi@58
  const void *v67; // rsi@58
  __int64 v68; // rcx@63
  __int64 v69; // r8@63
  __int64 v70; // r9@63
  void *v71; // rbx@65
  signed __int64 v72; // rsi@65
  __int64 v73; // rcx@65
  __int64 v74; // r8@65
  __int64 v75; // r9@65
  IO80211Interface *v76; // rdi@67
  __int64 v77; // rax@69
  __int64 v78; // rdx@69
  __int64 v79; // r8@69
  __int64 v80; // r9@69
  __int64 v81; // rax@69
  __int64 v82; // rdx@69
  __int64 v83; // r8@69
  __int64 v84; // r9@69
  __int64 result; // rax@71
  IO80211Interface *v86; // rdi@72
  __int64 v87; // rdx@74
  __int64 v88; // rcx@74
  __int64 v89; // r8@74
  __int64 v90; // r9@74
  __int64 v91; // rdx@75
  __int64 v92; // rcx@75
  __int64 v93; // r8@75
  __int64 v94; // r9@75
  __int64 v95; // rdx@78
  __int64 v96; // rcx@78
  __int64 v97; // r8@78
  __int64 v98; // r9@78
  __int64 v99; // rdx@79
  __int64 v100; // rcx@79
  __int64 v101; // r8@79
  __int64 v102; // r9@79
  IO80211Interface *v103; // rdi@81
  char v104; // [sp+0h] [bp-100h]@0
  int v105; // [sp+Ch] [bp-F4h]@52
  size_t v106; // [sp+10h] [bp-F0h]@54
  const void *v107; // [sp+18h] [bp-E8h]@52
  const void *v108; // [sp+20h] [bp-E0h]@48
  __mbuf *v109; // [sp+30h] [bp-D0h]@45
  __int64 v110; // [sp+38h] [bp-C8h]@44
  int v111; // [sp+44h] [bp-BCh]@0
  void *v112; // [sp+48h] [bp-B8h]@0
  __int64 v113; // [sp+50h] [bp-B0h]@1
  __int64 v114; // [sp+58h] [bp-A8h]@10
  __int64 v115; // [sp+60h] [bp-A0h]@10
  __int64 v116; // [sp+68h] [bp-98h]@3
  int v117; // [sp+70h] [bp-90h]@3
  char v118; // [sp+78h] [bp-88h]@65
  char v119; // [sp+80h] [bp-80h]@55
  char v120; // [sp+86h] [bp-7Ah]@55
  char v121; // [sp+8Ch] [bp-74h]@58
  char v122; // [sp+ACh] [bp-54h]@58
  __int64 v123; // [sp+D0h] [bp-30h]@1

  v5 = a5;
  v6 = a4;
  v113 = a3;
  v7 = a2;
  v8 = (__int64)this;
  v9 = off_7B078[0];
  v123 = *(_QWORD *)off_7B078[0];
  v10 = (__int64)"IO80211RSNDone";
  (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 2) + 632LL))(
    *((_QWORD *)this + 2),
    "IO80211RSNDone",
    0LL);
  if ( *((_DWORD *)this + 66) == 1 && !*(_BYTE *)(v7 + 703) )
  {
    v117 = 0;
    v116 = 1LL;
    v10 = 3223873993LL;
    if ( (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, _QWORD, __int64 *))(**((_QWORD **)this + 3)
                                                                                          + 3216LL))(
           *((_QWORD *)this + 3),
           3223873993LL,
           9LL,
           *((_QWORD *)this + 2),
           &v116) )
    {
      v11 = (IO80211Interface *)*((_QWORD *)this + 2);
      if ( !v11 || !(IO80211Interface::debugFlags(v11) & 4) )
        goto LABEL_71;
      v6 = (__int64)"process1of4: unable to get bssid\n";
      goto LABEL_7;
    }
    v10 = (__int64)((char *)&v116 + 4);
    memcpy((void *)(v7 + 697), (char *)&v116 + 4, 6uLL);
    *(_BYTE *)(v7 + 703) = 1;
  }
  v20 = *(_DWORD *)(v7 + 232) + 1;
  *(_DWORD *)(v7 + 232) = v20;
  if ( (unsigned int)v20 >= 4 )
  {
    v115 = 0LL;
    v114 = 1LL;
    HIDWORD(v114) = 2;
    memcpy(&v115, (const void *)(v7 + 697), 6uLL);
    v21 = (IO80211Interface *)*((_QWORD *)this + 2);
    if ( v21 && IO80211Interface::debugFlags(v21) & 4 )
    {
      v6 = (__int64)"process1of4: Message 1 received %u times. Deauthing self with reason code %d.\n";
      IOLog(
        "process1of4: Message 1 received %u times. Deauthing self with reason code %d.\n",
        *(_DWORD *)(v7 + 232),
        2LL,
        v22,
        v23,
        v24);
      IO8Log(
        "process1of4: Message 1 received %u times. Deauthing self with reason code %d.\n",
        *(_DWORD *)(v7 + 232),
        2LL,
        v25,
        v26,
        v27,
        v104);
    }
    (*(void (__fastcall **)(_QWORD, signed __int64, signed __int64, _QWORD, __int64 *))(**(_QWORD **)(v8 + 24) + 3216LL))(
      *(_QWORD *)(v8 + 24),
      2150132168LL,
      29LL,
      *(_QWORD *)(v8 + 16),
      &v114);
    if ( *(_DWORD *)(v8 + 264) == 2 )
      RSNSupplicant::freeAuthenticator(v8, v7);
    goto LABEL_71;
  }
  v112 = (void *)v6;
  v28 = __ROL2__(*(_WORD *)(v6 + 3), 8);
  v29 = *((_DWORD *)this + 24) - 1;
  if ( (unsigned int)v29 > 2 )
  {
    v111 = v5;
    v31 = 16;
    v32 = (__int64)"CCMP";
  }
  else
  {
    v111 = v5;
    v30 = v29;
    v31 = *((_DWORD *)&qword_77698 + v29);
    v10 = (__int64)off_7B4E0;
    v32 = (__int64)off_7B4E0[v30];
  }
  v6 = v28;
  if ( v28 == v31 )
  {
    if ( *((_DWORD *)this + 66) == 1 )
    {
      v10 = v7;
      if ( !RSNSupplicant::storeFullRSNIE((__int64)this, v7) )
      {
        v43 = (IO80211Interface *)*((_QWORD *)this + 2);
        if ( v43 && IO80211Interface::debugFlags(v43) & 4 )
        {
          v44 = *(_BYTE *)(v7 + 702);
          v6 = (__int64)"process1of4: Unable to retreive RSN IE for %02x:%02x:%02x:%02x:%02x:%02x\n";
          IOLog(
            "process1of4: Unable to retreive RSN IE for %02x:%02x:%02x:%02x:%02x:%02x\n",
            *(_BYTE *)(v7 + 697),
            *(_BYTE *)(v7 + 698),
            *(_BYTE *)(v7 + 699),
            *(_BYTE *)(v7 + 700),
            *(_BYTE *)(v7 + 701));
          IO8Log(
            "process1of4: Unable to retreive RSN IE for %02x:%02x:%02x:%02x:%02x:%02x\n",
            *(_BYTE *)(v7 + 697),
            *(_BYTE *)(v7 + 698),
            *(_BYTE *)(v7 + 699),
            *(_BYTE *)(v7 + 700),
            *(_BYTE *)(v7 + 701),
            *(_BYTE *)(v7 + 702));
        }
        goto LABEL_71;
      }
    }
    v33 = *((_DWORD *)this + 9);
    if ( v33 != 4 && v33 != 8 || *((_DWORD *)this + 25) != 1 )
      goto LABEL_44;
    v6 = (__int64)((char *)v112 + 95);
    v34 = __ROL2__(*(_WORD *)((char *)v112 + 93), 8);
    v35 = v34;
    while ( v35 >= 3 )
    {
      if ( *(_BYTE *)v6 == 221 && v35 - 2 - *(_BYTE *)(v6 + 1) >= 0 && v35 - 2 >= 20 )
      {
        v10 = (__int64)&RSN_KEY_DATA_PMKID;
        if ( !memcmp((const void *)(v6 + 2), &RSN_KEY_DATA_PMKID, 4uLL) )
        {
          if ( !*((_BYTE *)this + 56) )
            goto LABEL_72;
LABEL_43:
          LODWORD(v47) = mbuf_data(v113);
          RSNSupplicant::cachePMKSA(this, (ether_addr *)(v47 + 6));
          v9 = off_7B078[0];
          goto LABEL_44;
        }
      }
      v45 = (unsigned int)*(_BYTE *)(v6 + 1) + 2;
      v35 -= v45;
      if ( v35 > 0 )
        v6 += v45;
    }
    if ( *((_BYTE *)this + 56) )
      goto LABEL_43;
    v46 = (IO80211Interface *)*((_QWORD *)this + 2);
    v9 = off_7B078[0];
    if ( !v46 || !(IO80211Interface::debugFlags(v46) & 4) )
      goto LABEL_71;
    v6 = (__int64)"process1of4: No PMK set, bailing\n";
LABEL_7:
    IOLog(v6, v10, v12, v13, v14, v15);
    IO8Log((const char *)v6, v10, v16, v17, v18, v19, v104);
    goto LABEL_71;
  }
  v36 = (IO80211Interface *)*((_QWORD *)this + 2);
  if ( v36 && IO80211Interface::debugFlags(v36) & 4 )
  {
    v7 = (__int64)"process1of4: Invalid %s key length (%u)\n";
    IOLog("process1of4: Invalid %s key length (%u)\n", v32, (unsigned int)v6, v37, v38, v39);
    IO8Log("process1of4: Invalid %s key length (%u)\n", v32, (unsigned int)v6, v40, v41, v42, v104);
  }
LABEL_71:
  while ( 1 )
  {
    result = *(_QWORD *)v9;
    if ( *(_QWORD *)v9 == v123 )
      return result;
LABEL_72:
    v10 = v7 + 697;
    v6 = IO80211Interface::pmksaLookup(
           *(IO80211Interface **)(v8 + 16),
           (ether_addr *)(v7 + 697),
           (unsigned __int8 *)(v6 + 6));
    v86 = *(IO80211Interface **)(v8 + 16);
    if ( v6 )
    {
      v9 = off_7B078[0];
      if ( v86 && IO80211Interface::debugFlags(v86) & 4 )
      {
        IOLog("PMKSA cache match! Using cached PMK\n", v10, v87, v88, v89, v90);
        IO8Log("PMKSA cache match! Using cached PMK\n", v10, v91, v92, v93, v94, v104);
      }
      memcpy((void *)(v8 + 57), (const void *)(v6 + 32), *(_QWORD *)(v6 + 64));
      *(_BYTE *)(v8 + 56) = 1;
LABEL_44:
      v48 = *(_BYTE *)(v8 + 111);
      v110 = v48;
      v49 = v48 + 115;
      LODWORD(v50) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v8 + 24) + 2344LL))(
                       *(_QWORD *)(v8 + 24),
                       (unsigned int)(v48 + 115));
      v6 = v50;
      if ( v50 )
      {
        mbuf_setlen(v50, v49);
        v109 = (__mbuf *)v6;
        LODWORD(v51) = mbuf_data(v6);
        v52 = v51;
        bzero(v51, v49);
        memcpy((char *)v52 + 6, (const void *)(v8 + 104), 6uLL);
        LODWORD(v53) = mbuf_data(v113);
        memcpy(v52, (const void *)(v53 + 6), 6uLL);
        *((_WORD *)v52 + 6) = -29048;
        *((_WORD *)v52 + 7) = 769;
        v54 = __ROL2__(*(_BYTE *)(v8 + 111) + 97, 8);
        *((_WORD *)v52 + 8) = v54;
        v55 = *(_DWORD *)(v8 + 36);
        v56 = 2;
        if ( v55 != 4 )
        {
          v56 = 2;
          if ( v55 != 8 )
            v56 = -2;
        }
        v108 = (const void *)(v8 + 104);
        *((_BYTE *)v52 + 18) = v56;
        v57 = __ROL2__(v111 | 0x108, 8);
        *(_WORD *)((char *)v52 + 19) = v57;
        *(_WORD *)((char *)v52 + 21) = 0;
        memcpy((char *)v52 + 23, (char *)v112 + 5, 8uLL);
        v58 = __ROL2__(*(_BYTE *)(v8 + 111) + 2, 8);
        *(_WORD *)((char *)v52 + 111) = v58;
        memcpy((char *)v52 + 113, (const void *)(v8 + 110), *(_BYTE *)(v8 + 111) + 2LL);
        if ( *(_BYTE *)(v7 + 163) )
        {
          read_random((void *)(v7 + 164), 0x20u);
          *(_BYTE *)(v7 + 163) = 0;
        }
        v59 = (const void *)(v7 + 164);
        memcpy((char *)v52 + 31, (const void *)(v7 + 164), 0x20uLL);
        v112 = (char *)v112 + 13;
        memcpy((void *)(v7 + 196), v112, 0x20uLL);
        if ( IO80211Interface::debugFlags(*(IO80211Interface **)(v8 + 16)) & 4 )
          hex_dump((unsigned __int8 *)(v8 + 57), 32, "PMK", v60, v61, v62);
        v107 = (const void *)(v8 + 57);
        v113 = v7 + 34;
        bzero((void *)(v7 + 34), 0x40uLL);
        v105 = *(_DWORD *)(v8 + 100) - 5;
        v63 = 48LL;
        if ( *(_DWORD *)(v8 + 96) == 3 )
          v63 = 64LL;
        v106 = v63;
        if ( memcmp(v108, v52, 6uLL) < 0 )
        {
          memcpy(&v119, v108, 6uLL);
          v64 = &v120;
          v65 = v52;
        }
        else
        {
          memcpy(&v119, v52, 6uLL);
          v64 = &v120;
          v65 = (const void *)(v8 + 104);
        }
        memcpy(v64, v65, 6uLL);
        if ( memcmp(v59, v112, 0x20uLL) < 0 )
        {
          memcpy(&v121, v59, 0x20uLL);
          v66 = &v122;
          v67 = v112;
        }
        else
        {
          memcpy(&v121, v112, 0x20uLL);
          v66 = &v122;
          v67 = (const void *)(v7 + 164);
        }
        memcpy(v66, v67, 0x20uLL);
        if ( (unsigned int)v105 > 1 )
          sha1_prf(v107, 0x20uLL, "Pairwise key expansion", (__int64)&v119, 76LL, v113, v106);
        else
          sha256_prf((void *)v107, 0x20uLL, "Pairwise key expansion", (__int64)&v119, 76LL, v113, v106);
        if ( IO80211Interface::debugFlags(*(IO80211Interface **)(v8 + 16)) & 4 )
          hex_dump((unsigned __int8 *)v113, 64, "TPTK", v68, v69, v70);
        *(_BYTE *)(v7 + 33) = 1;
        v71 = (void *)(v7 + 82);
        memcpy(&v118, (const void *)(v7 + 82), 8uLL);
        v7 += 90LL;
        memcpy(v71, (const void *)v7, 8uLL);
        memcpy((void *)v7, &v118, 8uLL);
        v72 = (unsigned int)v111;
        wpa_eapol_key_mic(
          (unsigned __int8 *)v113,
          v111,
          (unsigned __int8 *)v52 + 14,
          v110 + 101,
          (unsigned __int8 *)v52 + 95);
        if ( IO80211Interface::debugFlags(*(IO80211Interface **)(v8 + 16)) & 4 )
        {
          v72 = 16LL;
          hex_dump((unsigned __int8 *)v52 + 95, 16, "KEY MIC", v73, v74, v75);
        }
        (*(void (__fastcall **)(_QWORD, signed __int64))(**(_QWORD **)(v8 + 240) + 312LL))(*(_QWORD *)(v8 + 240), v72);
        v76 = *(IO80211Interface **)(v8 + 16);
        v9 = off_7B078[0];
        v6 = (__int64)v109;
        if ( v76 )
        {
          if ( IO80211Interface::debugFlags(v76) & 4 )
          {
            LODWORD(v77) = mbuf_len(v109);
            v7 = (__int64)"process1of4: sending replyPacket %d bytes\n";
            IOLog("process1of4: sending replyPacket %d bytes\n", (unsigned int)v77, v78, v77, v79, v80);
            LODWORD(v81) = mbuf_len(v109);
            IO8Log("process1of4: sending replyPacket %d bytes\n", (unsigned int)v81, v82, v81, v83, v84, v104);
          }
        }
        IO80211Interface::outputEAPOLFrame(*(IO80211Interface **)(v8 + 16), v109);
      }
    }
    else
    {
      v9 = off_7B078[0];
      if ( v86 && IO80211Interface::debugFlags(v86) & 4 )
      {
        v6 = (__int64)"process1of4: pmkid present in message 1, but not present in PMKSA cache.\n";
        IOLog("process1of4: pmkid present in message 1, but not present in PMKSA cache.\n", v10, v95, v96, v97, v98);
        IO8Log(
          "process1of4: pmkid present in message 1, but not present in PMKSA cache.\n",
          v10,
          v99,
          v100,
          v101,
          v102,
          v104);
      }
      if ( (unsigned int)*(_BYTE *)(v8 + 111) >= 0x15 )
      {
        v103 = *(IO80211Interface **)(v8 + 16);
        if ( v103 )
        {
          if ( IO80211Interface::debugFlags(v103) & 4 )
          {
            v6 = (__int64)"process1of4: Attempted fast roam, but PMKID rejected. No PMK available, dropping frame.\n";
            goto LABEL_7;
          }
        }
      }
    }
  }
}
// 77658: using guessed type _QWORD RSN_KEY_DATA_PMKID;
// 77698: using guessed type __int64 qword_77698;
// 7B078: using guessed type __int64 off_7B078[7];
// 7B4E0: using guessed type char *off_7B4E0[3];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8CB0: using guessed type int __fastcall mbuf_setlen(_QWORD, _QWORD);

//----- (0000000000004BA2) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::process1of2(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  __int64 v5; // r15@1
  unsigned __int8 *v6; // rbx@1
  int v7; // eax@1
  signed __int64 v8; // r12@3
  int v9; // er14@3
  size_t v10; // r13@3
  int v11; // eax@4
  int v12; // er14@4
  __int64 v13; // rax@17
  IO80211Interface *v14; // rdi@20
  __int64 v15; // r9@21
  __int64 v16; // rdx@22
  __int64 v17; // rcx@22
  __int64 v18; // r8@22
  __int64 v19; // r9@22
  unsigned __int16 v20; // ax@23
  __int64 v21; // r14@24
  IO80211Interface *v22; // rdi@25
  __int64 v23; // r9@26
  IO80211Interface *v24; // rdi@31
  __int64 v25; // r9@32
  __int64 v26; // rcx@33
  __int64 v27; // r8@33
  __int64 v28; // r9@33
  IO80211Interface *v29; // rdi@36
  unsigned __int8 *v30; // r14@41
  char v31; // ST00_1@44
  char v32; // al@44
  __int64 v33; // rdx@44
  IO80211Interface *v34; // rdi@45
  __int64 v35; // rcx@46
  __int64 v36; // r8@46
  __int64 v37; // r9@46
  __int64 v38; // rdx@47
  __int64 v39; // rcx@47
  __int64 v40; // r8@47
  __int64 v41; // r9@47
  __mbuf *v42; // rax@49
  __mbuf *v43; // r14@49
  void *v44; // rax@50
  __int64 v45; // rax@50
  int v46; // ecx@50
  char v47; // al@50
  __int16 v48; // dx@53
  IO80211Interface *v49; // rdi@55
  IO80211Interface *v50; // rdi@58
  IO80211Interface *v51; // rdi@61
  __int64 v52; // rdx@64
  __int64 v53; // rcx@64
  __int64 v54; // r8@64
  __int64 v55; // r9@64
  __int64 result; // rax@65
  signed int v57; // er14@66
  IO80211Interface *v58; // rdi@67
  __int64 v59; // r9@68
  __int64 v60; // rdx@69
  __int64 v61; // rcx@69
  __int64 v62; // r8@69
  __int64 v63; // r9@69
  IO80211Interface *v64; // rdi@71
  char v65; // [sp+0h] [bp-C0h]@0
  char v66; // [sp+Ch] [bp-B4h]@41
  __int64 v67; // [sp+10h] [bp-B0h]@3
  signed int v68; // [sp+18h] [bp-A8h]@3
  unsigned int v69; // [sp+1Ch] [bp-A4h]@3
  __int64 v70; // [sp+20h] [bp-A0h]@3
  __int64 v71; // [sp+30h] [bp-90h]@1
  __int64 v72; // [sp+38h] [bp-88h]@3
  __int64 v73; // [sp+40h] [bp-80h]@3
  signed __int64 v74; // [sp+48h] [bp-78h]@3
  char v75; // [sp+50h] [bp-70h]@24
  char v76; // [sp+60h] [bp-60h]@24
  unsigned __int8 v77; // [sp+70h] [bp-50h]@24
  __int64 v78; // [sp+90h] [bp-30h]@1

  v71 = a2;
  v5 = a1;
  v78 = *(_QWORD *)off_7B078[0];
  LOWORD(a2) = __ROL2__(*(_WORD *)(a4 + 1), 8);
  LOWORD(v6) = __ROL2__(*(_WORD *)(a4 + 93), 8);
  v7 = *(_DWORD *)(a1 + 36);
  if ( v7 != 4 && v7 != 8 )
  {
    v69 = a2;
    LODWORD(v8) = (unsigned int)(unsigned __int16)a2 >> 4;
    v20 = __ROL2__(*(_WORD *)(a4 + 3), 8);
    v10 = v20;
    if ( (_DWORD)a5 == 1 )
    {
      v67 = a3;
      v68 = 1;
      v21 = a4;
      v70 = a4;
      memcpy(&v75, (const void *)(a4 + 45), 0x10uLL);
      memcpy(&v76, (const void *)(v71 + 115), 0x10uLL);
      rc4_skip((__int64)&v75, 32, 0x100uLL, v21 + 95, (unsigned __int16)v6);
      v6 = &v77;
      memcpy(&v77, (const void *)(v21 + 95), v10);
      goto LABEL_43;
    }
    if ( (_DWORD)a5 != 2 )
    {
      v67 = a3;
      v70 = a4;
      v68 = a5;
      v6 = &v77;
      goto LABEL_43;
    }
    if ( !((unsigned __int8)v6 & 7) )
      goto LABEL_66;
    v29 = *(IO80211Interface **)(a1 + 16);
    if ( v29 && IO80211Interface::debugFlags(v29) & 4 )
    {
      v6 = (unsigned __int8 *)"process1of2: Unsupported AES wrap length\n";
      goto LABEL_64;
    }
    goto LABEL_65;
  }
  v67 = a3;
  v68 = a5;
  v8 = a4 + 95;
  v70 = a4;
  v9 = (unsigned __int16)v6;
  v69 = a2;
  LOWORD(v6) = a2 & 0x1000;
  LODWORD(v10) = 0;
  v74 = 0LL;
  v72 = 0LL;
  v73 = 0LL;
  do
  {
    v11 = *(_BYTE *)v8;
    v12 = v9 - 2;
    if ( v11 == 221 && v12 >= 5 )
    {
      LOBYTE(v11) = -35;
      if ( (unsigned int)*(_BYTE *)(v8 + 1) >= 7 )
      {
        a2 = (__int64)&RSN_KEY_DATA_GROUPKEY;
        if ( !memcmp((const void *)(v8 + 2), &RSN_KEY_DATA_GROUPKEY, 4uLL) )
        {
          if ( !(_WORD)v6 )
          {
            v49 = *(IO80211Interface **)(a1 + 16);
            if ( v49 && IO80211Interface::debugFlags(v49) & 4 )
            {
              v6 = (unsigned __int8 *)"process1of2: GTK IE unencrypted\n";
              goto LABEL_64;
            }
            goto LABEL_65;
          }
          v5 = v8 + 1;
          v74 = v8 + 6;
          LODWORD(v10) = *(_BYTE *)(v8 + 1) - 4;
          goto LABEL_17;
        }
        LOBYTE(v11) = *(_BYTE *)v8;
      }
    }
    v5 = v8 + 1;
    if ( (unsigned __int8)v11 == 221 && v12 >= 5 && (unsigned int)*(_BYTE *)v5 >= 7 )
    {
      a2 = (__int64)&RSN_KEY_DATA_GROUPKEY_BIP;
      if ( !memcmp((const void *)(v8 + 2), &RSN_KEY_DATA_GROUPKEY_BIP, 4uLL) )
      {
        if ( !(_WORD)v6 )
        {
          v50 = *(IO80211Interface **)(a1 + 16);
          if ( v50 && IO80211Interface::debugFlags(v50) & 4 )
          {
            v6 = (unsigned __int8 *)"process1of2: GTK IE is not encrypted\n";
            goto LABEL_64;
          }
          goto LABEL_65;
        }
        v72 = v8 + 6;
        v73 = (unsigned int)*(_BYTE *)(v8 + 1) - 4;
      }
    }
LABEL_17:
    v13 = *(_BYTE *)v5;
    a4 = *(_BYTE *)(v13 + v8 + 3);
    v8 += v13 + 2;
    v9 = v12 - a4;
  }
  while ( v9 > 0 );
  a2 = v74;
  if ( v74 )
  {
    LODWORD(v10) = v10 - 2;
    v5 = a1;
    if ( (signed int)v10 >= 33 )
    {
      v14 = *(IO80211Interface **)(a1 + 16);
      if ( v14 && IO80211Interface::debugFlags(v14) & 4 )
      {
        v6 = (unsigned __int8 *)"process1of2: GTK in GTK IE too long (%d)\n";
        IOLog("process1of2: GTK in GTK IE too long (%d)\n", (unsigned int)v10, a3, a4, a5, v15);
        IO8Log("process1of2: GTK in GTK IE too long (%d)\n", (unsigned int)v10, v16, v17, v18, v19, v65);
      }
      goto LABEL_65;
    }
    a3 = *(_BYTE *)v74;
    LOBYTE(v6) = *(_BYTE *)v74 >> 2;
    if ( *(_BYTE *)(v71 + 680) )
    {
      a4 = v73;
      if ( !(_DWORD)v73 || v72 == 0 )
      {
        v24 = *(IO80211Interface **)(a1 + 16);
        if ( v24 && IO80211Interface::debugFlags(v24) & 4 )
        {
          v5 = v72;
          LOWORD(v6) = v73;
          IOLog(
            "process1of2: No IGTK in group key message 1 (IGTK = %p, IGTKLen = %d\n",
            v72,
            (unsigned int)v73,
            a4,
            a5,
            v25);
          IO8Log(
            "process1of2: No IGTK in group key message 1 (IGTK = %p, IGTKLen = %d\n",
            v72,
            (unsigned int)v73,
            v26,
            v27,
            v28,
            v65);
        }
        goto LABEL_65;
      }
LABEL_41:
      v66 = *(_BYTE *)v74;
      v30 = &v77;
      memcpy(&v77, (const void *)(v74 + 2), (signed int)v10);
      v8 = v72;
      goto LABEL_44;
    }
    if ( !v72 && !(_DWORD)v73 )
      goto LABEL_41;
    v51 = *(IO80211Interface **)(a1 + 16);
    if ( v51 && IO80211Interface::debugFlags(v51) & 4 )
    {
      v6 = (unsigned __int8 *)"process1of2: Unexpected IGTK found in group key message 1 \n";
      goto LABEL_64;
    }
  }
  else
  {
    v22 = *(IO80211Interface **)(a1 + 16);
    if ( v22 && IO80211Interface::debugFlags(v22) & 4 )
    {
      v6 = (unsigned __int8 *)"process1of2: No GTK IE in group key message 1\n";
      goto LABEL_64;
    }
  }
LABEL_65:
  while ( 1 )
  {
    result = *(_QWORD *)off_7B078[0];
    if ( *(_QWORD *)off_7B078[0] == v78 )
      break;
LABEL_66:
    v67 = a3;
    v68 = a5;
    v57 = (unsigned __int16)v6 - 8;
    if ( v57 < 33 )
    {
      a2 = v57 / 8;
      v70 = a4;
      v6 = &v77;
      if ( (unsigned int)_aes_unwrap((unsigned __int8 *)(v71 + 115), a2, (unsigned __int8 *)(a4 + 95), &v77) )
      {
        v64 = *(IO80211Interface **)(v5 + 16);
        if ( v64 && IO80211Interface::debugFlags(v64) & 4 )
        {
          v6 = (unsigned __int8 *)"process1of2: aes_unwrap failed\n";
LABEL_64:
          IOLog(v6, a2, a3, a4, a5, v23);
          IO8Log((const char *)v6, a2, v52, v53, v54, v55, v65);
        }
      }
      else
      {
LABEL_43:
        v66 = v8;
        v30 = v6;
        LODWORD(v6) = v69 >> 6;
        v8 = 0LL;
        LODWORD(v73) = 0;
LABEL_44:
        v31 = (unsigned __int8)v6 & 1;
        LOWORD(v6) = v71;
        v32 = RSNSupplicant::wpaGTKToAppleGTK(v5, v71, v70, v30, v10, v66 & 3, v31);
        if ( v8 )
        {
          v34 = *(IO80211Interface **)(v5 + 16);
          if ( v34 && IO80211Interface::debugFlags(v34) & 4 )
          {
            IOLog("process1of2: received pairwise GTK_BIP \n", v71, v33, v35, v36, v37);
            IO8Log("process1of2: received pairwise GTK_BIP \n", v71, v38, v39, v40, v41, v65);
          }
          v32 = RSNSupplicant::wpaIGTKToAppleIGTK(v5, v71, v33, v8 + 8, v73 - 8, *(_WORD *)v8, (const void *)(v8 + 2));
          *(_BYTE *)(v71 + 680) = 1;
        }
        RSNSupplicant::installGTK(v32, v5, v71);
        LODWORD(v42) = (*(int (__fastcall **)(_QWORD, signed __int64))(**(_QWORD **)(v5 + 24) + 2344LL))(
                         *(_QWORD *)(v5 + 24),
                         113LL);
        v43 = v42;
        if ( v42 )
        {
          mbuf_setlen(v42, 113LL);
          LODWORD(v44) = mbuf_data(v43);
          v6 = (unsigned __int8 *)v44;
          bzero(v44, 0x71uLL);
          memcpy(v6 + 6, (const void *)(v5 + 104), 6uLL);
          LODWORD(v45) = mbuf_data(v67);
          memcpy(v6, (const void *)(v45 + 6), 6uLL);
          *((_WORD *)v6 + 6) = -29048;
          v6[14] = 1;
          v6[15] = 3;
          *((_WORD *)v6 + 8) = 24320;
          v46 = *(_DWORD *)(v5 + 36);
          v8 = v5;
          v47 = 2;
          if ( v46 != 4 )
          {
            v47 = 2;
            if ( v46 != 8 )
              v47 = -2;
          }
          v5 = (__int64)(v6 + 14);
          v6[18] = v47;
          LODWORD(v10) = v68;
          v48 = __ROL2__(v68 | v69 & 0x30 | 0x300, 8);
          *(_WORD *)(v6 + 19) = v48;
          *(_WORD *)(v6 + 21) = *(_WORD *)(v70 + 3);
          memcpy(v6 + 23, (const void *)(v70 + 5), 8uLL);
          *(_WORD *)(v6 + 111) = 0;
          wpa_eapol_key_mic((unsigned __int8 *)(v71 + 99), v68, v6 + 14, 0x63uLL, v6 + 95);
          IO80211Interface::outputEAPOLFrame(*(IO80211Interface **)(v8 + 16), v43);
          if ( !((*(int (__fastcall **)(_QWORD, __mbuf *))(**(_QWORD **)(v8 + 240) + 568LL))(*(_QWORD *)(v8 + 240), v43) & 3) )
            (*(void (**)(void))(**(_QWORD **)(v8 + 240) + 304LL))();
        }
      }
    }
    else
    {
      v58 = *(IO80211Interface **)(v5 + 16);
      if ( v58 )
      {
        if ( IO80211Interface::debugFlags(v58) & 4 )
        {
          v6 = (unsigned __int8 *)"process1of2: encrypted key data too large (%d)\n";
          IOLog("process1of2: encrypted key data too large (%d)\n", (unsigned int)v57, a3, a4, a5, v59);
          IO8Log("process1of2: encrypted key data too large (%d)\n", (unsigned int)v57, v60, v61, v62, v63, v65);
        }
      }
    }
  }
  return result;
}
// 77660: using guessed type _QWORD RSN_KEY_DATA_GROUPKEY;
// 77664: using guessed type _QWORD RSN_KEY_DATA_GROUPKEY_BIP;
// 7B078: using guessed type __int64 off_7B078[7];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8CB0: using guessed type int __fastcall mbuf_setlen(_QWORD, _QWORD);

//----- (00000000000052A8) ----------------------------------------------------
int __fastcall RSNSupplicant::setCounterMeasures(RSNSupplicant *this, unsigned __int8 a2)
{
  unsigned __int8 v2; // r15@1
  RSNSupplicant *v3; // rbx@1
  __int64 v4; // rax@1
  __int64 v5; // r14@3
  __int64 v6; // rsi@4
  IO80211Interface *v7; // rdi@5
  __int64 v8; // rdx@6
  __int64 v9; // rcx@6
  __int64 v10; // r8@6
  __int64 v11; // r9@6
  const char *v12; // rbx@7
  IO80211Interface *v13; // rdi@8
  __int64 v14; // r14@12
  __int64 v15; // rax@13
  IO80211Interface *v16; // rdi@15
  __int64 v17; // rdx@16
  __int64 v18; // rcx@16
  __int64 v19; // r8@16
  __int64 v20; // r9@16
  const char *v21; // rbx@17
  IO80211Interface *v22; // rdi@18
  __int64 v23; // rdx@21
  __int64 v24; // rcx@21
  __int64 v25; // r8@21
  __int64 v26; // r9@21
  IO80211Interface *v27; // rdi@22
  int v28; // eax@25
  __int64 v29; // rdi@25
  __int64 v30; // rdx@29
  __int64 v31; // rcx@29
  __int64 v32; // r8@29
  __int64 v33; // r9@29
  char *v34; // rcx@32
  __int64 v35; // r8@32
  __int64 v36; // r9@32
  char v37[8]; // rdx@32
  __int64 v39; // [sp+0h] [bp-30h]@8
  char v40; // [sp+8h] [bp-28h]@8
  __int64 v41; // [sp+10h] [bp-20h]@4

  v2 = a2;
  v3 = this;
  v4 = *((_BYTE *)this + 40);
  if ( (_DWORD)v4 == a2 )
    return v4;
  if ( !a2 )
    goto LABEL_32;
  v5 = *((_QWORD *)this + 32);
  if ( !v5 )
    return v4;
  v41 = 4294967297LL;
  v6 = 2150132168LL;
  LODWORD(v4) = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, _QWORD, __int64 *))(**((_QWORD **)this + 3)
                                                                                                 + 3216LL))(
                  *((_QWORD *)this + 3),
                  2150132168LL,
                  30LL,
                  *((_QWORD *)this + 2),
                  &v41);
  if ( (_DWORD)v4 )
  {
    v7 = (IO80211Interface *)*((_QWORD *)this + 2);
    if ( v7 )
    {
      LODWORD(v4) = IO80211Interface::debugFlags(v7);
      if ( v4 & 4 )
      {
        v12 = "setCounterMeasures: Error setting TKIP countermeasures!\n";
LABEL_21:
        IOLog(v12, v6, v8, v9, v10, v11);
        LODWORD(v4) = IO8Log(v12, v6, v23, v24, v25, v26, v39);
        return v4;
      }
    }
    return v4;
  }
  v39 = 60129542145LL;
  memcpy(&v40, (const void *)(v5 + 697), 6uLL);
  v6 = 2150132168LL;
  LODWORD(v4) = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, _QWORD, __int64 *))(**((_QWORD **)this + 3)
                                                                                                 + 3216LL))(
                  *((_QWORD *)this + 3),
                  2150132168LL,
                  29LL,
                  *((_QWORD *)this + 2),
                  &v39);
  v13 = (IO80211Interface *)*((_QWORD *)this + 2);
  if ( !(_DWORD)v4 )
  {
    v6 = (__int64)IO80211Interface::stopCountermeasures;
    LODWORD(v4) = IOTimerEventSource::timerEventSource(v13, IO80211Interface::stopCountermeasures);
    v14 = v4;
    if ( !v4 )
    {
      v22 = (IO80211Interface *)*((_QWORD *)v3 + 2);
      if ( v22 )
      {
        LODWORD(v4) = IO80211Interface::debugFlags(v22);
        if ( v4 & 4 )
        {
          v12 = "setCounterMeasures: Error allocing IOTimerEventSource.\n";
          goto LABEL_21;
        }
      }
      return v4;
    }
    LODWORD(v15) = (*(int (**)(void))(**((_QWORD **)v3 + 3) + 1672LL))();
    if ( !v15 )
    {
      v27 = (IO80211Interface *)*((_QWORD *)v3 + 2);
      if ( !v27 || !(IO80211Interface::debugFlags(v27) & 4) )
        goto LABEL_30;
      v21 = "setCounterMeasures: Error retrieving work loop!\n";
      goto LABEL_29;
    }
    v6 = v14;
    if ( (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v15 + 320LL))(v15, v14) )
    {
      v16 = (IO80211Interface *)*((_QWORD *)v3 + 2);
      if ( !v16 || !(IO80211Interface::debugFlags(v16) & 4) )
        goto LABEL_30;
      v21 = "setCounterMeasures: Error adding countermeasures timer to workloop\n";
LABEL_29:
      IOLog(v21, v6, v17, v18, v19, v20);
      IO8Log(v21, v6, v30, v31, v32, v33, v39);
LABEL_30:
      LODWORD(v4) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v14 + 40LL))(v14);
      return v4;
    }
    v6 = 60000LL;
    v28 = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v14 + 464LL))(v14, 60000LL);
    v29 = *((_QWORD *)v3 + 2);
    if ( v28 )
    {
      if ( !v29 || !(IO80211Interface::debugFlags((IO80211Interface *)v29) & 4) )
        goto LABEL_30;
      v21 = "setCounterMeasures: Error setting countermeasures timeout!\n";
      goto LABEL_29;
    }
    IO80211Interface::setCountermeasuresTimer(v29, v14);
LABEL_32:
    *((_BYTE *)v3 + 40) = v2;
    v34 = IO80211Interface::getBSDName(*((IO80211Interface **)v3 + 2), v4);
    *(_QWORD *)v37 = "disabled";
    if ( v2 )
      *(_QWORD *)v37 = "enabled";
    LODWORD(v4) = IOLog("%s: TKIP countermeasures %s.\n", v34, *(_QWORD *)v37, v34, v35, v36);
    return v4;
  }
  if ( v13 )
  {
    LODWORD(v4) = IO80211Interface::debugFlags(v13);
    if ( v4 & 4 )
    {
      v12 = "setCounterMeasures: Error setting deauth!\n";
      goto LABEL_21;
    }
  }
  return v4;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7C78: using guessed type int __fastcall IOTimerEventSource::timerEventSource(_QWORD, _QWORD);

//----- (00000000000054F4) ----------------------------------------------------
int __usercall RSNSupplicant::setPMK@<eax>(RSNSupplicant *this@<rdi>, unsigned __int8 *a2@<rsi>, char a3)
{
  int result; // eax@2
  IO80211Interface *v4; // rdi@2
  __int64 v5; // rdx@3
  __int64 v6; // rcx@3
  __int64 v7; // r8@3
  __int64 v8; // r9@3
  __int64 v9; // rdx@4
  __int64 v10; // rcx@4
  __int64 v11; // r8@4
  __int64 v12; // r9@4

  if ( a2 )
  {
    result = (unsigned __int64)memcpy((char *)this + 57, a2, 0x20uLL);
    *((_BYTE *)this + 56) = 1;
    v4 = (IO80211Interface *)*((_QWORD *)this + 2);
    if ( v4 )
    {
      result = IO80211Interface::debugFlags(v4);
      if ( result & 4 )
      {
        IOLog("setPMK: PMK SET!\n", a2, v5, v6, v7, v8);
        result = IO8Log("setPMK: PMK SET!\n", (__int64)a2, v9, v10, v11, v12, a3);
      }
    }
  }
  return result;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000554E) ----------------------------------------------------
__int64 __fastcall wpa_eapol_key_mic(unsigned __int8 *a1, int a2, unsigned __int8 *a3, unsigned __int64 a4, unsigned __int8 *a5)
{
  unsigned __int8 *v5; // rbx@1
  __int64 v6; // r15@1
  char *v7; // r14@3
  char v9; // [sp+0h] [bp-60h]@4
  char v10; // [sp+20h] [bp-40h]@3
  __int64 v11; // [sp+40h] [bp-20h]@1

  v5 = a5;
  v6 = off_7B078[0];
  v11 = *(_QWORD *)off_7B078[0];
  if ( a2 == 3 )
  {
    v7 = &v9;
    omac1_aes_128((__int64)a1, (signed __int64)a3, a4, (__int64)&v9);
    goto LABEL_5;
  }
  if ( a2 == 2 )
  {
    v7 = &v10;
    hmac_sha1(a1, 0x10uLL, (__int64)a3, a4, (__int64)&v10);
LABEL_5:
    memcpy(v5, v7, 0x10uLL);
    return *(_QWORD *)v6;
  }
  if ( a2 == 1 )
    hmac_md5(a1, 0x10uLL, (__int64)a3, a4, (__int64)a5);
  return *(_QWORD *)v6;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (00000000000055D8) ----------------------------------------------------
signed __int64 __fastcall _aes_unwrap(unsigned __int8 *a1, int a2, unsigned __int8 *a3, unsigned __int8 *a4)
{
  unsigned __int8 *v4; // r14@1
  unsigned __int8 *v5; // rbx@1
  int v6; // er12@1
  char *v7; // rdx@1
  int v8; // ecx@1
  int v9; // eax@1
  int v10; // ebx@2
  const void *v11; // r14@2
  void *i; // r15@2
  __int64 v13; // rcx@5
  signed __int64 result; // rax@6
  __int64 v15; // rcx@8
  void *v16; // [sp+10h] [bp-190h]@1
  int v17; // [sp+20h] [bp-180h]@2
  int v18; // [sp+2Ch] [bp-174h]@2
  char v19; // [sp+30h] [bp-170h]@1
  char v20; // [sp+150h] [bp-50h]@3
  char v21; // [sp+157h] [bp-49h]@3
  char v22; // [sp+158h] [bp-48h]@1
  char v23[8]; // [sp+168h] [bp-38h]@1
  __int64 v24; // [sp+170h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v24 = *(_QWORD *)off_7B078[0];
  memcpy(v23, a3, 8uLL);
  memcpy(v4, v5 + 8, 8 * a2);
  aes_decrypt_key(a1, 128LL, &v19);
  v16 = &v4[8 * a2 - 8];
  v7 = &v22;
  v8 = 6 * a2;
  v9 = 5;
  do
  {
    v17 = v9;
    v18 = v8;
    v10 = v8;
    v11 = v16;
    for ( i = v7; v6 > 0; --v10 )
    {
      memcpy(&v20, v23, 8uLL);
      v21 ^= v10;
      memcpy(i, v11, 8uLL);
      aes_decrypt(&v20, &v20, &v19);
      memcpy(v23, &v20, 8uLL);
      memcpy((void *)v11, i, 8uLL);
      v11 = (char *)v11 - 8;
      --v6;
    }
    v7 = (char *)i;
    v6 = a2;
    v8 = v18 - a2;
    v9 = v17 - 1;
  }
  while ( v17 > 0 );
  v13 = 0LL;
  do
  {
    result = 0xFFFFFFFFLL;
    if ( (unsigned __int8)v23[v13] != 166 )
      break;
    ++v13;
    result = 0LL;
  }
  while ( (signed int)v13 <= 7 );
  v15 = *(_QWORD *)off_7B078[0];
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C89B0: using guessed type int __fastcall aes_decrypt(_QWORD, _QWORD, _QWORD);
// C89B8: using guessed type int __fastcall aes_decrypt_key(_QWORD, _QWORD, _QWORD);
// 55D8: using guessed type char var_38[8];

//----- (000000000000576A) ----------------------------------------------------
char __fastcall RSNSupplicant::storeFullRSNIE(__int64 a1, __int64 a2)
{
  char *v2; // rbx@1
  signed int v3; // er13@1
  int v4; // er15@1
  int v5; // er14@2
  int v6; // eax@2
  int v7; // eax@9
  int v8; // eax@13
  __int64 v9; // rcx@17
  __int64 v10; // r8@17
  __int64 v11; // r9@17
  __int64 v12; // rax@19
  IO80211Interface *v13; // rdi@20
  __int64 v14; // rdx@21
  __int64 v15; // rcx@21
  __int64 v16; // r8@21
  __int64 v17; // r9@21
  __int64 v18; // rdx@22
  __int64 v19; // rcx@22
  __int64 v20; // r8@22
  __int64 v21; // r9@22
  char result; // al@23
  __int64 v23; // rcx@23
  unsigned __int8 *v24; // [sp+0h] [bp-450h]@0
  int v25; // [sp+10h] [bp-440h]@1
  int v26; // [sp+14h] [bp-43Ch]@1
  char *v27; // [sp+18h] [bp-438h]@1
  char v28; // [sp+20h] [bp-430h]@1
  __int64 v29; // [sp+420h] [bp-30h]@1

  v29 = *(_QWORD *)off_7B078[0];
  v25 = 1;
  v26 = 1024;
  v2 = &v28;
  v27 = &v28;
  v3 = 48;
  v4 = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, _QWORD, int *))(**(_QWORD **)(a1 + 24) + 3216LL))(
         *(_QWORD *)(a1 + 24),
         3223873993LL,
         48LL,
         *(_QWORD *)(a1 + 16),
         &v25);
  if ( !v4 )
  {
    v5 = v26;
    v6 = *(_DWORD *)(a1 + 36);
    if ( v6 != 4 )
    {
      v3 = 221;
      if ( v6 == 8 )
        v3 = 48;
    }
    if ( v26 >= 3 )
    {
      v24 = (unsigned __int8 *)(a2 + 704);
      do
      {
        if ( (unsigned __int8)*v2 == v3 )
        {
          if ( v3 == 221 )
          {
            v7 = (unsigned __int8)v2[1];
            if ( v5 - 2 >= v7
              && (unsigned int)(v7 + 2) <= 0x101
              && (unsigned __int8)v7 >= 4u
              && !memcmp(v2 + 2, &_wpaOUIAndType, 4uLL) )
            {
              LOBYTE(v8) = v2[1];
LABEL_17:
              memcpy(v24, v2, (unsigned __int8)v8 + 2LL);
              *(_BYTE *)(a2 + 961) = 1;
              if ( IO80211Interface::debugFlags(*(IO80211Interface **)(a1 + 16)) & 4 )
                hex_dump(v24, (unsigned __int8)v2[1] + 2, "FULL RSN IE FOUND", v9, v10, v11);
              goto LABEL_19;
            }
          }
          else if ( v3 == 48 )
          {
            v8 = (unsigned __int8)v2[1];
            if ( v5 - 2 >= v8 && (unsigned int)(v8 + 2) < 0x102 )
              goto LABEL_17;
          }
        }
LABEL_19:
        v12 = (unsigned int)(unsigned __int8)v2[1] + 2;
        v5 -= v12;
        v2 += v12;
      }
      while ( v5 > 2 );
    }
  }
  v13 = *(IO80211Interface **)(a1 + 16);
  if ( v13 && IO80211Interface::debugFlags(v13) & 4 )
  {
    IOLog("storeFullRSNIE: getAP_IE_LIST returned %d\n", (unsigned int)v4, v14, v15, v16, v17);
    IO8Log("storeFullRSNIE: getAP_IE_LIST returned %d\n", (unsigned int)v4, v18, v19, v20, v21, (char)v24);
  }
  result = *(_BYTE *)(a2 + 961);
  v23 = *(_QWORD *)off_7B078[0];
  return result;
}
// 77600: using guessed type _QWORD _wpaOUIAndType;
// 7B078: using guessed type __int64 off_7B078[7];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000597A) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::pmksaLookup(RSNSupplicant *this, ether_addr *a2, unsigned __int8 *a3)
{
  return IO80211Interface::pmksaLookup(*((IO80211Interface **)this + 2), a2, a3);
}

//----- (0000000000005988) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::cachePMKSA(RSNSupplicant *this, ether_addr *a2)
{
  RSNSupplicant *v2; // r15@1
  __int64 v3; // r13@1
  unsigned __int8 *v4; // r14@1
  IO80211Interface *v5; // rdi@1
  int v6; // ST00_4@3
  __int64 v7; // rcx@4
  __int64 v8; // r8@4
  __int64 v9; // r9@4
  unsigned __int8 v11; // [sp+10h] [bp-80h]@1
  char v12; // [sp+20h] [bp-70h]@1
  __int64 v13; // [sp+40h] [bp-50h]@1
  ether_addr *v14; // [sp+48h] [bp-48h]@1
  RSNSupplicant *v15; // [sp+50h] [bp-40h]@1
  __int64 v16; // [sp+60h] [bp-30h]@1

  v2 = this;
  v3 = off_7B078[0];
  v16 = *(_QWORD *)off_7B078[0];
  v4 = (unsigned __int8 *)((char *)this + 57);
  v13 = (__int64)"PMK Name";
  v14 = a2;
  v15 = (RSNSupplicant *)((char *)this + 104);
  hmac_sha1_vector(
    (char *)this + 57,
    0x20uLL,
    3,
    (__int64)&v13,
    (__int64)rsn_pmkid(unsigned char *,unsigned char *,unsigned char *,unsigned char *)::len,
    (__int64)&v12);
  memcpy(&v11, &v12, 0x10uLL);
  v5 = (IO80211Interface *)*((_QWORD *)this + 2);
  if ( v5 && IO80211Interface::debugFlags(v5) & 4 )
  {
    v6 = a2->octet[5];
    IOLog(
      "cachePMKSA: Caching PMKID for %02x:%02x:%02x:%02x:%02x:%02x\n",
      a2->octet[0],
      a2->octet[1],
      a2->octet[2],
      a2->octet[3],
      a2->octet[4]);
    IO8Log(
      "cachePMKSA: Caching PMKID for %02x:%02x:%02x:%02x:%02x:%02x\n",
      a2->octet[0],
      a2->octet[1],
      a2->octet[2],
      a2->octet[3],
      a2->octet[4],
      a2->octet[5]);
  }
  if ( IO80211Interface::debugFlags(*((IO80211Interface **)v2 + 2)) & 4 )
    hex_dump(&v11, 16, "PMKID", v7, v8, v9);
  IO80211Interface::cachePMKSA(*((IO80211Interface **)v2 + 2), v4, 0x20uLL, a2, &v11);
  return *(_QWORD *)v3;
}
// 77680: using guessed type __int64 rsn_pmkid(unsigned char *,unsigned char *,unsigned char *,unsigned char *)::len[3];
// 7B078: using guessed type __int64 off_7B078[7];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000005ABE) ----------------------------------------------------
char __usercall RSNSupplicant::wpaPTKToApplePTK@<al>(char a1@<al>, __int64 a2@<rdx>, __int64 a3@<rdi>, __int64 a4@<rsi>)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int v6; // eax@1
  signed int v7; // eax@2
  int v8; // ecx@5
  char v9; // bl@8
  IO80211Interface *v10; // rdi@9
  __int64 v11; // rdx@10
  __int64 v12; // rcx@10
  __int64 v13; // r8@10
  __int64 v14; // r9@10
  __int64 v15; // rdx@11
  __int64 v16; // rcx@11
  __int64 v17; // r8@11
  __int64 v18; // r9@11
  char v20; // [sp-8h] [bp-20h]@1

  v20 = a1;
  v4 = a2;
  v5 = a3;
  bzero((void *)(a4 + 236), 0x94uLL);
  *(_DWORD *)(a4 + 236) = 1;
  v6 = *(_DWORD *)(a3 + 96);
  if ( v6 == 5 )
  {
    *(_QWORD *)(a4 + 240) = 21474836496LL;
    *(_DWORD *)(a4 + 316) = 6;
    v7 = 16;
  }
  else
  {
    if ( v6 != 3 )
    {
      v10 = *(IO80211Interface **)(a3 + 16);
      if ( v10 && IO80211Interface::debugFlags(v10) & 4 )
      {
        v9 = 0;
        IOLog("wpaPTKToApplePTK: unsupported pairwise cipher type (%d)\n", *(_DWORD *)(v5 + 96), v11, v12, v13, v14);
        IO8Log(
          "wpaPTKToApplePTK: unsupported pairwise cipher type (%d)\n",
          *(_DWORD *)(v5 + 96),
          v15,
          v16,
          v17,
          v18,
          v20);
      }
      else
      {
        v9 = 0;
      }
      return v9;
    }
    *(_QWORD *)(a4 + 240) = 12884901920LL;
    *(_DWORD *)(a4 + 316) = 6;
    v7 = 32;
  }
  v8 = *(_DWORD *)(a3 + 36);
  if ( v8 != 4 && v8 != 8 )
  {
    memcpy((void *)(a4 + 320), (const void *)(v4 + 61), 6uLL);
    v7 = *(_DWORD *)(a4 + 240);
  }
  memcpy((void *)(a4 + 252), (const void *)(a4 + 131), (unsigned int)v7);
  memcpy((void *)(a4 + 328), (const void *)(a4 + 697), 6uLL);
  *(_WORD *)(a4 + 248) = 4;
  *(_DWORD *)(a4 + 336) = 16;
  memcpy((void *)(a4 + 340), (const void *)(a4 + 99), 0x10uLL);
  *(_DWORD *)(a4 + 356) = 16;
  memcpy((void *)(a4 + 360), (const void *)(a4 + 115), 0x10uLL);
  memcpy((void *)(a4 + 376), (const void *)(v4 + 5), 8uLL);
  return 1;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000005C48) ----------------------------------------------------
char __fastcall RSNSupplicant::wpaPGTKToApplePGTK(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5)
{
  return RSNSupplicant::wpaGTKToAppleGTK(
           a1,
           a2,
           a3,
           (void *)(a4 + 2),
           a5 - 2,
           *(_BYTE *)a4 & 3,
           (unsigned __int8)(*(_BYTE *)a4 & 4) >> 2);
}

//----- (0000000000005C76) ----------------------------------------------------
char __fastcall RSNSupplicant::wpaPBIPGTKToApplePBIPGTK(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5)
{
  return RSNSupplicant::wpaIGTKToAppleIGTK(a1, a2, a3, a4 + 8, a5 - 8, *(_WORD *)a4, (const void *)(a4 + 2));
}

//----- (0000000000005C9D) ----------------------------------------------------
int __fastcall ptk_thread(void *a1, void *a2)
{
  __int64 v2; // rax@1

  LODWORD(v2) = (*(int (**)(void))(**((_QWORD **)a1 + 3) + 2224LL))();
  return (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(RSNSupplicant *__hidden, OSObject *, void *, void *, void *, void *), void *, void *, _QWORD, _QWORD))(*(_QWORD *)v2 + 456LL))(
           v2,
           RSNSupplicant::ptkThreadGated,
           a1,
           a2,
           0LL,
           0LL);
}

//----- (0000000000005CDE) ----------------------------------------------------
char __fastcall RSNSupplicant::wpaGTKToAppleGTK(__int64 a1, __int64 a2, __int64 a3, void *a4, unsigned int a5, __int16 a6, char a7)
{
  __int16 v7; // r13@1
  __int64 v8; // r12@1
  __int64 v9; // r14@1
  __int64 v10; // rbx@1
  void *v11; // rdi@1
  __int64 v12; // rsi@1
  int v13; // eax@1
  size_t v14; // rdx@5
  IO80211Interface *v15; // rdi@6
  __int64 v16; // rdx@7
  __int64 v17; // rcx@7
  __int64 v18; // r8@7
  __int64 v19; // r9@7
  char v20; // r15@8
  __int64 v21; // rdx@8
  __int64 v22; // rcx@8
  __int64 v23; // r8@8
  __int64 v24; // r9@8
  signed __int64 v25; // rax@10
  IO80211Interface *v26; // rdi@14
  unsigned int v27; // ebx@15
  __int64 v28; // rdx@15
  __int64 v29; // rcx@15
  __int64 v30; // r8@15
  __int64 v31; // r9@15
  const char *v32; // r14@16
  IO80211Interface *v33; // rdi@17
  __int64 v34; // rdx@19
  __int64 v35; // rcx@19
  __int64 v36; // r8@19
  __int64 v37; // r9@19
  __int64 v38; // rdx@20
  __int64 v39; // rcx@20
  __int64 v40; // r8@20
  __int64 v41; // r9@20
  void *v42; // rdi@23
  __int64 v43; // rsi@24
  IO80211Interface *v44; // rdi@28
  __int64 v45; // rdx@29
  __int64 v46; // rcx@29
  __int64 v47; // r8@29
  __int64 v48; // r9@29
  __int64 v49; // rdx@30
  __int64 v50; // rcx@30
  __int64 v51; // r8@30
  __int64 v52; // r9@30
  IO80211Interface *v53; // rdi@31
  IO80211Interface *v54; // rdi@34
  __int64 v55; // rdx@42
  __int64 v56; // rcx@42
  __int64 v57; // r8@42
  __int64 v58; // r9@42
  __int64 v59; // rax@44
  char v61; // [sp+0h] [bp-60h]@0
  unsigned int v62; // [sp+1Ch] [bp-44h]@1
  void *v63; // [sp+20h] [bp-40h]@1
  char v64; // [sp+28h] [bp-38h]@2
  __int64 v65; // [sp+30h] [bp-30h]@1

  v7 = a6;
  v62 = a5;
  v63 = a4;
  v8 = a3;
  v9 = a2;
  v10 = a1;
  v65 = *(_QWORD *)off_7B078[0];
  v11 = (void *)(a2 + 384);
  v12 = 148LL;
  bzero(v11, 0x94uLL);
  *(_DWORD *)(v9 + 384) = 1;
  v13 = *(_DWORD *)(v10 + 92);
  if ( v13 == 3 )
  {
    memcpy(&v64, (char *)v63 + 16, 8uLL);
    memcpy((char *)v63 + 16, (char *)v63 + 24, 8uLL);
    v12 = (__int64)&v64;
    memcpy((char *)v63 + 24, &v64, 8uLL);
    v13 = *(_DWORD *)(v10 + 92);
  }
  switch ( v13 )
  {
    case 1:
      if ( v62 == 5 )
      {
        *(_QWORD *)(v9 + 388) = 4294967301LL;
        *(_DWORD *)(v9 + 464) = 0;
        v14 = 5LL;
        goto LABEL_23;
      }
      v26 = *(IO80211Interface **)(v10 + 16);
      if ( !v26 )
        goto LABEL_43;
      v27 = v62;
      if ( !(IO80211Interface::debugFlags(v26) & 4) )
        goto LABEL_43;
      v32 = "wpaGTKToAppleGTK: Invalid group cipher length (APPLE80211_CIPHER_WEP_40) %d\n";
      goto LABEL_42;
    default:
      v15 = *(IO80211Interface **)(v10 + 16);
      if ( !v15 || !(IO80211Interface::debugFlags(v15) & 4) )
        goto LABEL_43;
      v20 = 0;
      IOLog("wpaGTKToAppleGTK: Invalid group cipher type (%d)\n", *(_DWORD *)(v10 + 92), v16, v17, v18, v19);
      IO8Log("wpaGTKToAppleGTK: Invalid group cipher type (%d)\n", *(_DWORD *)(v10 + 92), v21, v22, v23, v24, v61);
      goto LABEL_44;
    case 3:
      if ( v62 == 32 )
      {
        v25 = 12884901920LL;
        goto LABEL_13;
      }
      v33 = *(IO80211Interface **)(v10 + 16);
      if ( v62 == 13 )
      {
        if ( !v33 )
          goto LABEL_49;
        if ( IO80211Interface::debugFlags(v33) & 4 )
        {
          IOLog(
            "Livebox/WANADOO workaround in effect. Configured for TKIP group cipher, but allowing 104 bit WEP key to be installed.\n",
            v12,
            v34,
            v35,
            v36,
            v37);
          IO8Log(
            "Livebox/WANADOO workaround in effect. Configured for TKIP group cipher, but allowing 104 bit WEP key to be installed.\n",
            v12,
            v38,
            v39,
            v40,
            v41,
            v61);
        }
LABEL_21:
        if ( v62 == 13 )
        {
LABEL_49:
          *(_QWORD *)(v9 + 388) = 8589934605LL;
          *(_DWORD *)(v9 + 464) = 0;
          v14 = 13LL;
          goto LABEL_23;
        }
        v53 = *(IO80211Interface **)(v10 + 16);
        if ( v53 )
        {
          v27 = v62;
          if ( IO80211Interface::debugFlags(v53) & 4 )
          {
            v32 = "wpaGTKToAppleGTK: Invalid group cipher length (APPLE80211_CIPHER_WEP_104) %d\n";
            goto LABEL_42;
          }
        }
      }
      else if ( v33 )
      {
        v27 = v62;
        if ( IO80211Interface::debugFlags(v33) & 4 )
        {
          v32 = "wpaGTKToAppleGTK: Invalid group cipher length (APPLE80211_CIPHER_TKIP) %d\n";
          goto LABEL_42;
        }
      }
      goto LABEL_43;
    case 5:
      if ( v62 == 16 )
      {
        v25 = 21474836496LL;
LABEL_13:
        *(_QWORD *)(v9 + 388) = v25;
        *(_DWORD *)(v9 + 464) = 6;
        memcpy((void *)(v9 + 468), (const void *)(v8 + 61), 6uLL);
        v14 = *(_DWORD *)(v9 + 388);
LABEL_23:
        *(_WORD *)(v9 + 398) = v7;
        memcpy((void *)(v9 + 400), v63, v14);
        v42 = (void *)(v9 + 476);
        if ( *(_DWORD *)(v10 + 264) == 1 )
        {
          v43 = 255LL;
          memset(v42, 255, 6uLL);
        }
        else
        {
          v43 = v9 + 697;
          memcpy(v42, (const void *)(v9 + 697), 6uLL);
          *(_WORD *)(v9 + 396) = 32;
        }
        if ( a7 )
        {
          if ( *(_DWORD *)(v10 + 96) )
          {
            v44 = *(IO80211Interface **)(v10 + 16);
            if ( v44 && IO80211Interface::debugFlags(v44) & 4 )
            {
              IOLog(
                "wpaGTKToAppleGTK: TX bit set in GTK KDE, but pairwise key in use...ignoring\n",
                v43,
                v45,
                v46,
                v47,
                v48);
              IO8Log(
                "wpaGTKToAppleGTK: TX bit set in GTK KDE, but pairwise key in use...ignoring\n",
                v43,
                v49,
                v50,
                v51,
                v52,
                v61);
            }
          }
          else
          {
            *(_WORD *)(v9 + 396) = 4;
          }
        }
        memcpy((void *)(v9 + 524), (const void *)(v8 + 5), 8uLL);
        v20 = 1;
      }
      else
      {
        v54 = *(IO80211Interface **)(v10 + 16);
        if ( v54 && (v27 = v62, IO80211Interface::debugFlags(v54) & 4) )
        {
          v32 = "wpaGTKToAppleGTK: Invalid group cipher length (APPLE80211_CIPHER_AES_CCM) %d\n";
LABEL_42:
          v20 = 0;
          IOLog(v32, v27, v28, v29, v30, v31);
          IO8Log(v32, v27, v55, v56, v57, v58, v61);
        }
        else
        {
LABEL_43:
          v20 = 0;
        }
      }
LABEL_44:
      v59 = *(_QWORD *)off_7B078[0];
      if ( *(_QWORD *)off_7B078[0] == v65 )
        LOBYTE(v59) = v20;
      return v59;
    case 2:
      goto LABEL_21;
  }
}
// 7B078: using guessed type __int64 off_7B078[7];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000006088) ----------------------------------------------------
char __usercall RSNSupplicant::installGTK@<al>(char a1@<al>, __int64 a2@<rdi>, __int64 a3@<rsi>)
{
  __int64 v3; // rbx@1
  IO80211Interface *v4; // rdi@1
  __int64 v5; // rdx@2
  __int64 v6; // rcx@2
  __int64 v7; // r8@2
  __int64 v8; // r9@2
  __int64 v9; // rdx@3
  __int64 v10; // rcx@3
  __int64 v11; // r8@3
  __int64 v12; // r9@3
  __int64 v13; // rcx@4
  __int64 v14; // r8@4
  __int64 v15; // r9@4
  __int64 v16; // rcx@6
  __int64 v17; // r8@6
  __int64 v18; // r9@6
  __int64 v19; // rax@8
  __int64 v20; // rax@9
  char *v21; // rax@9
  __int64 v22; // rdx@9
  __int64 v23; // r8@9
  __int64 v24; // r9@9
  int v25; // eax@10
  IO80211Interface *v26; // rdi@10
  __int64 v27; // rdx@12
  __int64 v28; // rcx@12
  __int64 v29; // r8@12
  __int64 v30; // r9@12
  const char *v31; // r14@13
  __int64 v32; // rdx@15
  __int64 v33; // rcx@15
  __int64 v34; // r8@15
  __int64 v35; // r9@15
  __int64 v36; // rdx@16
  __int64 v37; // rcx@16
  __int64 v38; // r8@16
  __int64 v39; // r9@16
  __int64 v40; // rcx@18
  __int64 v41; // r8@18
  __int64 v42; // r9@18
  __int64 v43; // rcx@20
  __int64 v44; // r8@20
  __int64 v45; // r9@20
  int v46; // eax@22
  IO80211Interface *v47; // rdi@22
  char v48; // bl@26
  __int64 v49; // rdx@26
  __int64 v50; // rcx@26
  __int64 v51; // r8@26
  __int64 v52; // r9@26
  __int64 v53; // rdx@29
  __int64 v54; // rcx@29
  __int64 v55; // r8@29
  __int64 v56; // r9@29
  __int64 v57; // rdx@30
  __int64 v58; // rcx@30
  __int64 v59; // r8@30
  __int64 v60; // r9@30
  char v62; // [sp-8h] [bp-20h]@1

  v62 = a1;
  v3 = a2;
  v4 = *(IO80211Interface **)(a2 + 16);
  if ( v4 && IO80211Interface::debugFlags(v4) & 4 )
  {
    IOLog("installGTK: setting cipher key (flags = 0x%x)\n", *(_WORD *)(a3 + 396), v5, v6, v7, v8);
    IO8Log("installGTK: setting cipher key (flags = 0x%x)\n", *(_WORD *)(a3 + 396), v9, v10, v11, v12, v62);
  }
  if ( IO80211Interface::debugFlags(*(IO80211Interface **)(v3 + 16)) & 4 )
    hex_dump((unsigned __int8 *)(a3 + 468), *(_DWORD *)(a3 + 464), "GTK-RSC", v13, v14, v15);
  if ( IO80211Interface::debugFlags(*(IO80211Interface **)(v3 + 16)) & 4 )
    hex_dump((unsigned __int8 *)(a3 + 400), *(_DWORD *)(a3 + 388), "GTK", v16, v17, v18);
  (*(void (__fastcall **)(_QWORD, _QWORD, signed __int64))(**(_QWORD **)(v3 + 16) + 632LL))(
    *(_QWORD *)(v3 + 16),
    "IO80211RSNDone",
    1LL);
  LODWORD(v19) = (*(int (__fastcall **)(_QWORD, signed __int64, _QWORD, _QWORD))(**(_QWORD **)(v3 + 16) + 1856LL))(
                   *(_QWORD *)(v3 + 16),
                   3758096688LL,
                   0LL,
                   0LL);
  if ( !*(_BYTE *)(a3 + 962) )
  {
    *(_BYTE *)(a3 + 962) = 1;
    LOBYTE(v20) = IO80211Interface::postMessage(*(IO80211Interface **)(v3 + 16), 0LL, v19, 0LL, 20);
    v21 = IO80211Interface::getBSDName(*(IO80211Interface **)(v3 + 16), v20);
    IOLog("AirPort: RSN handshake complete on %s\n", v21, v22, v21, v23, v24);
  }
  v25 = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, _QWORD, signed __int64))(**(_QWORD **)(v3 + 24)
                                                                                              + 3216LL))(
          *(_QWORD *)(v3 + 24),
          2150132168LL,
          3LL,
          *(_QWORD *)(v3 + 16),
          a3 + 384);
  v26 = *(IO80211Interface **)(v3 + 16);
  if ( !v25 )
  {
    if ( v26 && IO80211Interface::debugFlags(v26) & 4 )
    {
      IOLog("installGTK: GTK installed\n", 2150132168LL, v32, v33, v34, v35);
      IO8Log("installGTK: GTK installed\n", 2150132168LL, v36, v37, v38, v39, v62);
    }
    if ( *(_BYTE *)(a3 + 680) )
    {
      if ( IO80211Interface::debugFlags(*(IO80211Interface **)(v3 + 16)) & 4 )
        hex_dump((unsigned __int8 *)(a3 + 616), *(_DWORD *)(a3 + 612), "IGTK-RSC", v40, v41, v42);
      if ( IO80211Interface::debugFlags(*(IO80211Interface **)(v3 + 16)) & 4 )
        hex_dump((unsigned __int8 *)(a3 + 548), *(_DWORD *)(a3 + 536), "IGTK", v43, v44, v45);
      v46 = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, _QWORD, signed __int64))(**(_QWORD **)(v3 + 24)
                                                                                                  + 3216LL))(
              *(_QWORD *)(v3 + 24),
              2150132168LL,
              3LL,
              *(_QWORD *)(v3 + 16),
              a3 + 532);
      v47 = *(IO80211Interface **)(v3 + 16);
      if ( v46 )
      {
        if ( v47 && IO80211Interface::debugFlags(v47) & 4 )
        {
          v31 = "installGTK: error installing IGTK\n";
          goto LABEL_26;
        }
        return 0;
      }
      if ( v47 && IO80211Interface::debugFlags(v47) & 4 )
      {
        IOLog("installGTK: IGTK installed\n", 2150132168LL, v53, v54, v55, v56);
        IO8Log("installGTK: IGTK installed\n", 2150132168LL, v57, v58, v59, v60, v62);
      }
    }
    *(_DWORD *)(*(_QWORD *)(v3 + 16) + 568LL) = *(_DWORD *)(a3 + 392);
    *(_DWORD *)(a3 + 228) = 2;
    return 1;
  }
  if ( !v26 || !(IO80211Interface::debugFlags(v26) & 4) )
    return 0;
  v31 = "installGTK: error installing GTK\n";
LABEL_26:
  v48 = 0;
  IOLog(v31, 2150132168LL, v27, v28, v29, v30);
  IO8Log(v31, 2150132168LL, v49, v50, v51, v52, v62);
  return v48;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000631C) ----------------------------------------------------
char __fastcall RSNSupplicant::wpaIGTKToAppleIGTK(__int64 a1, __int64 a2, __int64 a3, __int64 a4, unsigned int a5, __int16 a6, const void *a7)
{
  __int16 v7; // r12@1
  unsigned int v8; // er13@1
  __int64 v9; // r14@1
  __int64 v10; // r15@1
  int v11; // eax@1
  unsigned int v12; // ST0C_4@2
  signed __int64 v13; // r13@2
  __int16 v14; // ST08_2@2
  __int64 v15; // r12@2
  const void *v16; // r14@2
  void *v17; // rdi@2
  void *v18; // rdi@2
  signed __int64 v19; // rax@5
  size_t v20; // rdx@10
  char v21; // bl@11
  IO80211Interface *v22; // rdi@12
  __int64 v23; // rdx@13
  __int64 v24; // rcx@13
  __int64 v25; // r8@13
  __int64 v26; // r9@13
  const char *v27; // r14@14
  IO80211Interface *v28; // rdi@15
  __int64 v29; // rdx@16
  __int64 v30; // rcx@16
  __int64 v31; // r8@16
  __int64 v32; // r9@16
  __int64 v33; // rdx@17
  __int64 v34; // rcx@17
  __int64 v35; // r8@17
  __int64 v36; // r9@17
  IO80211Interface *v37; // rdi@18
  __int64 v38; // rdx@21
  __int64 v39; // rcx@21
  __int64 v40; // r8@21
  __int64 v41; // r9@21
  IO80211Interface *v42; // rdi@22
  __int64 v43; // rdx@23
  __int64 v44; // rcx@23
  __int64 v45; // r8@23
  __int64 v46; // r9@23
  __int64 v47; // rdx@24
  __int64 v48; // rcx@24
  __int64 v49; // r8@24
  __int64 v50; // r9@24
  __int64 v51; // rax@26
  char v53; // [sp+0h] [bp-50h]@0
  char v54; // [sp+18h] [bp-38h]@2
  __int64 v55; // [sp+20h] [bp-30h]@1

  v7 = a6;
  v8 = a5;
  v9 = a4;
  v10 = a1;
  v55 = *(_QWORD *)off_7B078[0];
  bzero((void *)(a2 + 532), 0x94uLL);
  *(_DWORD *)(a2 + 384) = 1;
  v11 = *(_DWORD *)(a1 + 92);
  if ( v11 == 3 )
  {
    v12 = v8;
    v13 = v9 + 16;
    memcpy(&v54, (const void *)(v9 + 16), 8uLL);
    v14 = v7;
    v15 = v9;
    v16 = (const void *)(v9 + 24);
    v17 = (void *)v13;
    v8 = v12;
    memcpy(v17, v16, 8uLL);
    v18 = (void *)v16;
    v9 = v15;
    v7 = v14;
    memcpy(v18, &v54, 8uLL);
    v11 = *(_DWORD *)(v10 + 92);
  }
  if ( v11 != 5 )
  {
    if ( v11 != 3 )
    {
      v28 = *(IO80211Interface **)(v10 + 16);
      if ( v28 && IO80211Interface::debugFlags(v28) & 4 )
      {
        v21 = 0;
        IOLog("wpaBIPGTKToAppleBIPGTK: Invalid Igroup cipher type (%d)\n", *(_DWORD *)(v10 + 92), v29, v30, v31, v32);
        IO8Log(
          "wpaBIPGTKToAppleBIPGTK: Invalid Igroup cipher type (%d)\n",
          *(_DWORD *)(v10 + 92),
          v33,
          v34,
          v35,
          v36,
          v53);
        goto LABEL_26;
      }
      goto LABEL_25;
    }
    if ( v8 == 32 )
    {
      v19 = 12884901920LL;
      goto LABEL_9;
    }
    v37 = *(IO80211Interface **)(v10 + 16);
    if ( !v37 || !(IO80211Interface::debugFlags(v37) & 4) )
      goto LABEL_25;
    v27 = "wpaGTKToAppleGTK: Invalid group cipher length (APPLE80211_CIPHER_TKIP) %d\n";
LABEL_21:
    v21 = 0;
    IOLog(v27, v8, v23, v24, v25, v26);
    IO8Log(v27, v8, v38, v39, v40, v41, v53);
    goto LABEL_26;
  }
  if ( v8 != 16 )
  {
    v22 = *(IO80211Interface **)(v10 + 16);
    if ( !v22 || !(IO80211Interface::debugFlags(v22) & 4) )
      goto LABEL_25;
    v27 = "wpaGTKToAppleGTK: Invalid group cipher length (APPLE80211_CIPHER_AES_CCM) %d\n";
    goto LABEL_21;
  }
  v19 = 21474836496LL;
LABEL_9:
  *(_QWORD *)(a2 + 536) = v19;
  *(_DWORD *)(a2 + 612) = 6;
  if ( a7 )
  {
    memcpy((void *)(a2 + 616), a7, 6uLL);
    v20 = *(_DWORD *)(a2 + 536);
    *(_WORD *)(a2 + 546) = v7;
    memcpy((void *)(a2 + 548), (const void *)v9, v20);
    if ( *(_DWORD *)(v10 + 264) == 1 )
    {
      memset((void *)(a2 + 624), 255, 6uLL);
      *(_WORD *)(a2 + 544) = 64;
      v21 = 1;
      goto LABEL_26;
    }
    v42 = *(IO80211Interface **)(v10 + 16);
    if ( v42 )
    {
      if ( IO80211Interface::debugFlags(v42) & 4 )
      {
        v21 = 0;
        IOLog("wpaBIPGTKToAppleBIPGTK: Do we support iGTK for IBSS ?", v9, v43, v44, v45, v46);
        IO8Log("wpaBIPGTKToAppleBIPGTK: Do we support iGTK for IBSS ?", v9, v47, v48, v49, v50, v53);
        goto LABEL_26;
      }
    }
  }
LABEL_25:
  v21 = 0;
LABEL_26:
  v51 = *(_QWORD *)off_7B078[0];
  if ( *(_QWORD *)off_7B078[0] == v55 )
    LOBYTE(v51) = v21;
  return v51;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000006578) ----------------------------------------------------
char __fastcall RSNSupplicant::installPTK(__int64 a1, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 v3; // rbx@1
  __int64 v4; // rcx@1
  __int64 v5; // r8@1
  __int64 v6; // r9@1
  int v7; // eax@3
  IO80211Interface *v8; // rdi@5
  __int64 v9; // rdx@6
  __int64 v10; // rcx@6
  __int64 v11; // r8@6
  __int64 v12; // r9@6
  const char *v13; // r14@7
  bool v14; // al@9
  IO80211Interface *v15; // rdi@9
  __int64 v16; // rdx@11
  __int64 v17; // rcx@11
  __int64 v18; // r8@11
  __int64 v19; // r9@11
  __int64 v20; // rdx@12
  __int64 v21; // rcx@12
  __int64 v22; // r8@12
  __int64 v23; // r9@12
  int v24; // eax@14
  __int64 v25; // rdi@14
  char v26; // bl@18
  __int64 v27; // rdx@19
  __int64 v28; // rcx@19
  __int64 v29; // r8@19
  __int64 v30; // r9@19
  char v32; // [sp+0h] [bp-30h]@0
  __int64 v33; // [sp+8h] [bp-28h]@4
  int v34; // [sp+10h] [bp-20h]@4

  v2 = a2;
  v3 = a1;
  if ( IO80211Interface::debugFlags(*(IO80211Interface **)(a1 + 16)) & 4 )
    hex_dump((unsigned __int8 *)(a2 + 252), *(_DWORD *)(a2 + 240), "PTK", v4, v5, v6);
  v7 = *(_DWORD *)(a1 + 264);
  if ( v7 == 1 )
  {
    v34 = 0;
    v33 = 1LL;
    a2 = 3223873993LL;
    if ( (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, _QWORD, __int64 *))(**(_QWORD **)(a1 + 24)
                                                                                          + 3216LL))(
           *(_QWORD *)(a1 + 24),
           3223873993LL,
           9LL,
           *(_QWORD *)(a1 + 16),
           &v33) )
    {
      v8 = *(IO80211Interface **)(a1 + 16);
      if ( v8 && IO80211Interface::debugFlags(v8) & 4 )
      {
        v13 = "installPTK: unable to get bssid\n";
LABEL_18:
        v26 = 0;
LABEL_19:
        IOLog(v13, a2, v9, v10, v11, v12);
        IO8Log(v13, a2, v27, v28, v29, v30, v32);
        return v26;
      }
      return 0;
    }
    memcpy((void *)(v2 + 328), (char *)&v33 + 4, 6uLL);
LABEL_14:
    a2 = 2150132168LL;
    v24 = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, _QWORD, signed __int64))(**(_QWORD **)(v3 + 24)
                                                                                                + 3216LL))(
            *(_QWORD *)(v3 + 24),
            2150132168LL,
            3LL,
            *(_QWORD *)(v3 + 16),
            v2 + 236);
    v25 = *(_QWORD *)(v3 + 16);
    if ( !v24 )
    {
      *(_DWORD *)(v25 + 564) = *(_DWORD *)(v2 + 244);
      *(_DWORD *)(v2 + 228) = 1;
      return 1;
    }
    if ( v25 && IO80211Interface::debugFlags((IO80211Interface *)v25) & 4 )
    {
      v13 = "installPTK: error installing PTK\n";
      goto LABEL_18;
    }
    return 0;
  }
  if ( v7 != 2 )
    goto LABEL_14;
  v14 = RSNSupplicant::useAuthenticatorPTK(a1, a2);
  v15 = *(IO80211Interface **)(a1 + 16);
  if ( v14 )
  {
    if ( v15 && IO80211Interface::debugFlags(v15) & 4 )
    {
      IOLog("installPTK: Using IBSS authenticator PTK.\n", a2, v16, v17, v18, v19);
      IO8Log("installPTK: Using IBSS authenticator PTK.\n", a2, v20, v21, v22, v23, v32);
    }
    goto LABEL_14;
  }
  v26 = 1;
  if ( v15 && IO80211Interface::debugFlags(v15) & 4 )
  {
    v13 = "installPTK: IBSS authenticator MAC address is 'lower' than supplicant MAC address. Not using authenticator PTK.\n";
    goto LABEL_19;
  }
  return v26;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000006716) ----------------------------------------------------
bool __fastcall RSNSupplicant::useAuthenticatorPTK(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  signed __int64 v3; // rsi@1
  __int64 v4; // rcx@1
  unsigned __int64 v5; // rdx@1
  unsigned __int64 v6; // rax@1

  v2 = a1 + 104;
  v3 = a2 + 697;
  v4 = 0LL;
  v5 = 0LL;
  v6 = 0LL;
  do
  {
    v6 |= *(_BYTE *)v2 << v4;
    v5 |= *(_BYTE *)v3 << v4;
    ++v2;
    ++v3;
    v4 += 8LL;
  }
  while ( v4 != 48 );
  return v6 < v5;
}

//----- (000000000000675E) ----------------------------------------------------
int __usercall RSNSupplicant::sendKeyRequest@<eax>(char a1@<dl>, char a2@<cl>, __int64 a3@<rdi>, __int64 a4@<rsi>, char a5)
{
  char v5; // r12@1
  bool v6; // r13@1
  __mbuf *v7; // rax@1
  __mbuf *v8; // rbx@1
  void *v9; // rax@2
  void *v10; // r12@2
  int v11; // ecx@2
  char v12; // al@2
  int v13; // er13@5
  signed __int16 v14; // cx@5
  __int16 v15; // cx@7
  __int16 v16; // ax@7
  __int16 v17; // dx@9
  __int16 v18; // ax@11
  signed __int64 v19; // rax@11
  bool v20; // zf@12
  IO80211Interface *v21; // rdi@17
  __int64 v22; // rdx@18
  __int64 v23; // rcx@18
  __int64 v24; // r8@18
  __int64 v25; // r9@18
  __int64 v26; // rdx@19
  __int64 v27; // rcx@19
  __int64 v28; // r8@19
  __int64 v29; // r9@19
  char v31; // [sp+10h] [bp-30h]@2
  char v32; // [sp+14h] [bp-2Ch]@1
  char v33; // [sp+15h] [bp-2Bh]@11

  v5 = a2;
  v32 = a1;
  v6 = *(_DWORD *)(a3 + 96) == 5;
  LODWORD(v7) = (*(int (__fastcall **)(_QWORD, signed __int64))(**(_QWORD **)(a3 + 24) + 2344LL))(
                  *(_QWORD *)(a3 + 24),
                  113LL);
  v8 = v7;
  if ( v7 )
  {
    v31 = v5;
    mbuf_setlen(v7, 113LL);
    LODWORD(v9) = mbuf_data(v8);
    v10 = v9;
    bzero(v9, 0x71uLL);
    memcpy(v10, (const void *)(a4 + 697), 6uLL);
    memcpy((char *)v10 + 6, (const void *)(a3 + 104), 6uLL);
    *((_WORD *)v10 + 6) = -29048;
    *((_BYTE *)v10 + 14) = 1;
    *((_BYTE *)v10 + 15) = 3;
    *((_WORD *)v10 + 8) = 24320;
    v11 = *(_DWORD *)(a3 + 36);
    v12 = 2;
    if ( v11 != 4 )
    {
      v12 = 2;
      if ( v11 != 8 )
        v12 = -2;
    }
    v13 = v6 + 1;
    *((_BYTE *)v10 + 18) = v12;
    v14 = 2304;
    if ( !*(_BYTE *)(a4 + 98) )
      v14 = 2048;
    v15 = v13 | v14;
    v16 = v15 | 0x400;
    if ( !v32 )
      v16 = v15;
    v17 = v16 | 8;
    if ( !v31 )
      v17 = v16;
    v33 = HIBYTE(v17);
    v18 = __ROL2__(v17, 8);
    *(_WORD *)((char *)v10 + 19) = v18;
    memcpy((char *)v10 + 23, (const void *)(a4 + 25), 8uLL);
    v19 = 32LL;
    do
    {
      v20 = (*(_BYTE *)(a4 + v19))++ == -1;
      if ( !v20 )
        break;
      --v19;
    }
    while ( (signed int)v19 - 24 > 0 );
    if ( v33 & 1 )
      wpa_eapol_key_mic(
        (unsigned __int8 *)(a4 + 99),
        v13,
        (unsigned __int8 *)v10 + 14,
        0x63uLL,
        (unsigned __int8 *)v10 + 95);
    LODWORD(v7) = IO80211Interface::outputEAPOLFrame(*(IO80211Interface **)(a3 + 16), v8);
  }
  else
  {
    v21 = *(IO80211Interface **)(a3 + 16);
    if ( v21 )
    {
      LODWORD(v7) = IO80211Interface::debugFlags(v21);
      if ( (unsigned __int8)v7 & 4 )
      {
        IOLog("sendKeyRequest: Unable to allocate request packet.\n", 113LL, v22, v23, v24, v25);
        LODWORD(v7) = IO8Log("sendKeyRequest: Unable to allocate request packet.\n", 113LL, v26, v27, v28, v29, a5);
      }
    }
  }
  return (signed int)v7;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8CB0: using guessed type int __fastcall mbuf_setlen(_QWORD, _QWORD);

//----- (000000000000692E) ----------------------------------------------------
signed __int64 __fastcall RSNSupplicant::incrementRequestCounter(__int64 a1, __int64 a2)
{
  signed __int64 result; // rax@1
  bool v3; // zf@2

  result = 32LL;
  do
  {
    v3 = (*(_BYTE *)(a2 + result))++ == -1;
    if ( !v3 )
      break;
    --result;
  }
  while ( (signed int)result - 24 > 0 );
  return result;
}

//----- (0000000000006948) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::state(RSNSupplicant *this)
{
  __int64 result; // rax@1
  __int64 v2; // rcx@2

  result = 0LL;
  if ( *((_DWORD *)this + 66) == 1 )
  {
    v2 = *((_QWORD *)this + 32);
    if ( v2 )
      result = *(_DWORD *)(v2 + 228);
  }
  return result;
}

//----- (000000000000696C) ----------------------------------------------------
int __usercall RSNSupplicant::micFailure@<eax>(RSNSupplicant *this@<rdi>, __int64 a2@<rax>, int a3@<esi>)
{
  int v3; // er14@1
  char *v4; // rcx@2
  __int64 v5; // r8@2
  __int64 v6; // r9@2
  __int64 v7; // rdx@2
  __int64 v8; // rsi@4
  __int64 v9; // rax@5
  IO80211Interface *v10; // rdi@9
  __int64 v11; // rdx@10
  __int64 v12; // rcx@10
  __int64 v13; // r8@10
  __int64 v14; // r9@10
  __int64 v15; // rdx@11
  __int64 v16; // rcx@11
  __int64 v17; // r8@11
  __int64 v18; // r9@11
  __int64 v20; // [sp+0h] [bp-20h]@5

  v3 = a3;
  if ( *((_DWORD *)this + 66) == 1 )
  {
    v4 = IO80211Interface::getBSDName(*((IO80211Interface **)this + 2), a2);
    v7 = (__int64)"Group";
    if ( a3 == 5 )
      v7 = (__int64)"Pairwise";
    LODWORD(a2) = IOLog("%s: %s TKIP MIC failure reported!\n", v4, v7, v4, v5, v6);
    v8 = *((_QWORD *)this + 32);
    if ( v8 )
    {
      RSNSupplicant::sendKeyRequest(1, v3 == 5, (__int64)this, v8, v20);
      io80211_get_calendar_time((__int64)&v20);
      v9 = *((_QWORD *)this + 6);
      if ( v9 && (unsigned __int64)(v20 - v9) <= 0x3C )
        RSNSupplicant::setCounterMeasures(this, 1u);
      LODWORD(a2) = v20;
      *((_QWORD *)this + 6) = v20;
    }
    else
    {
      v10 = (IO80211Interface *)*((_QWORD *)this + 2);
      if ( v10 )
      {
        LODWORD(a2) = IO80211Interface::debugFlags(v10);
        if ( a2 & 4 )
        {
          IOLog("micFailure: No authenticator configured\n", 0LL, v11, v12, v13, v14);
          LODWORD(a2) = IO8Log("micFailure: No authenticator configured\n", 0LL, v15, v16, v17, v18, v20);
        }
      }
    }
  }
  return a2;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000006A4C) ----------------------------------------------------
int __fastcall RSNSupplicant::ptkThread(__int64 a1, __int64 a2)
{
  __int64 v2; // rax@1
  __int64 v3; // rsi@1
  __int64 v4; // rax@1
  __int64 v5; // r14@1
  IO80211Interface **v6; // rbx@3
  __int64 v7; // rdx@3
  signed __int64 v8; // rcx@3
  __int64 v9; // r8@3
  __int64 v10; // r9@3
  signed int v11; // er12@3
  __int64 v12; // rdx@8
  __int64 v13; // rcx@8
  __int64 v14; // r8@8
  __int64 v15; // r9@8
  __int64 v16; // rdx@9
  __int64 v17; // rcx@9
  __int64 v18; // r8@9
  __int64 v19; // r9@9
  int v20; // eax@10
  __int64 v21; // rdx@16
  __int64 v22; // rcx@16
  __int64 v23; // r8@16
  __int64 v24; // r9@16
  __int64 v25; // rdx@17
  __int64 v26; // rcx@17
  __int64 v27; // r8@17
  __int64 v28; // r9@17
  char v29; // al@18
  __int64 v30; // rdx@20
  __int64 v31; // rcx@20
  __int64 v32; // r8@20
  __int64 v33; // r9@20
  __int64 v34; // rdx@21
  __int64 v35; // rcx@21
  __int64 v36; // r8@21
  __int64 v37; // r9@21
  int result; // eax@23
  char v39; // [sp+0h] [bp-40h]@0
  __int64 v40; // [sp+8h] [bp-38h]@1
  __int64 v41; // [sp+10h] [bp-30h]@7

  v40 = a2;
  LODWORD(v2) = (*(int (**)(void))(**(_QWORD **)(a1 + 24) + 1672LL))();
  v3 = IO80211WorkLoop::metaClass;
  LODWORD(v4) = OSMetaClassBase::safeMetaCast(v2, IO80211WorkLoop::metaClass);
  v5 = v4;
  if ( *(_DWORD *)(a1 + 264) != 1 || !v4 )
  {
    v6 = (IO80211Interface **)(a1 + 16);
LABEL_15:
    if ( *v6 && IO80211Interface::debugFlags(*v6) & 4 )
    {
      IOLog("ptkThread: Installing PTK!\n", v3, v21, v22, v23, v24);
      IO8Log("ptkThread: Installing PTK!\n", v3, v25, v26, v27, v28, v39);
    }
    v29 = RSNSupplicant::installPTK(a1, v40);
    if ( *(_DWORD *)(v40 + 388) )
    {
      if ( *v6 )
      {
        v29 = IO80211Interface::debugFlags(*v6);
        if ( v29 & 4 )
        {
          IOLog("ptkThread: Installing GTK!\n", v40, v30, v31, v32, v33);
          v29 = IO8Log("ptkThread: Installing GTK!\n", v40, v34, v35, v36, v37, v39);
        }
      }
      RSNSupplicant::installGTK(v29, a1, v40);
      (*(void (__fastcall **)(_QWORD, __int64))(**(_QWORD **)(a1 + 240) + 304LL))(*(_QWORD *)(a1 + 240), v40);
    }
    goto LABEL_23;
  }
  v3 = *(_QWORD *)(a1 + 16);
  v6 = (IO80211Interface **)(a1 + 16);
  v11 = 0;
  if ( (*(int (__fastcall **)(_QWORD, __int64))(**(_QWORD **)(a1 + 24) + 3240LL))(*(_QWORD *)(a1 + 24), v3) )
  {
    v8 = 1LL;
    do
    {
      v11 = v8;
      if ( (signed int)v8 - 1 > 4999 )
        break;
      if ( *(_BYTE *)(a1 + 248) )
        goto LABEL_23;
      clock_interval_to_deadline(1LL, 1000000LL, &v41);
      if ( *v6 && IO80211Interface::debugFlags(*v6) & 4 )
      {
        IOLog("ptkThread: Sleeping!\n", 1000000LL, v12, v13, v14, v15);
        IO8Log("ptkThread: Sleeping!\n", 1000000LL, v16, v17, v18, v19, v39);
      }
      (*(void (__fastcall **)(__int64, __int64, _QWORD, __int64))(*(_QWORD *)v5 + 504LL))(v5, v40, 0LL, v41);
      v3 = *(_QWORD *)(a1 + 16);
      v20 = (*(int (__fastcall **)(_QWORD, __int64))(**(_QWORD **)(a1 + 24) + 3240LL))(*(_QWORD *)(a1 + 24), v3);
      v8 = (unsigned int)(v11 + 1);
    }
    while ( v20 );
  }
  if ( !*(_BYTE *)(a1 + 248) )
  {
    if ( v11 >= 5000 )
      IOLog("ptkThread: timing out and intalling keys!\n", v3, v7, v8, v9, v10);
    goto LABEL_15;
  }
LABEL_23:
  result = v40;
  *(_BYTE *)(v40 + 696) = 0;
  if ( *(_BYTE *)(a1 + 248) )
  {
    if ( v5 )
      result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64))(*(_QWORD *)v5 + 408LL))(
                 v5,
                 a1 + 248,
                 1LL);
  }
  return result;
}
// 7B500: using guessed type _QWORD IO80211WorkLoop::metaClass;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// C8A38: using guessed type int __fastcall clock_interval_to_deadline(_QWORD, _QWORD, _QWORD);

//----- (0000000000006C50) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::ptkThreadGated(RSNSupplicant *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  RSNSupplicant::ptkThread((__int64)a2, (__int64)a3);
  return 0LL;
}

//----- (0000000000006C64) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::rsnPMKID(RSNSupplicant *this, unsigned __int8 *a2, unsigned __int8 *a3, unsigned __int8 *a4, unsigned __int8 *a5)
{
  unsigned __int8 *v5; // r14@1
  __int64 v6; // r15@1
  char v8; // [sp+0h] [bp-60h]@1
  __int64 v9; // [sp+20h] [bp-40h]@1
  unsigned __int8 *v10; // [sp+28h] [bp-38h]@1
  unsigned __int8 *v11; // [sp+30h] [bp-30h]@1
  __int64 v12; // [sp+40h] [bp-20h]@1

  v5 = a4;
  v6 = off_7B078[0];
  v12 = *(_QWORD *)off_7B078[0];
  v9 = (__int64)"PMK Name";
  v10 = a2;
  v11 = a3;
  hmac_sha1_vector(
    (const void *)this,
    0x20uLL,
    3,
    (__int64)&v9,
    (__int64)rsn_pmkid(unsigned char *,unsigned char *,unsigned char *,unsigned char *)::len,
    (__int64)&v8);
  memcpy(v5, &v8, 0x10uLL);
  return *(_QWORD *)v6;
}
// 77680: using guessed type __int64 rsn_pmkid(unsigned char *,unsigned char *,unsigned char *,unsigned char *)::len[3];
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000006CE0) ----------------------------------------------------
char __fastcall RSNSupplicant::ibssPeerArrived(RSNSupplicant *this, ether_addr *a2, unsigned __int8 *a3)
{
  unsigned __int8 *v3; // r14@1
  RSNSupplicant *v4; // r15@1
  __int64 v5; // rcx@1
  char result; // al@1
  IO80211Interface *v7; // rdi@2
  int v8; // ST00_4@4

  v3 = a3;
  v4 = this;
  v5 = RSNSupplicant::authenticatorForAddr(this, a2);
  result = 1;
  if ( !v5 )
  {
    v7 = (IO80211Interface *)*((_QWORD *)this + 2);
    if ( v7 )
    {
      if ( IO80211Interface::debugFlags(v7) & 4 )
      {
        v8 = a2->octet[5];
        IOLog(
          "ibssPeerArrived: %0x2:%02x:%02x:%02x:%02x:%02x\n",
          a2->octet[0],
          a2->octet[1],
          a2->octet[2],
          a2->octet[3],
          a2->octet[4]);
        IO8Log(
          "ibssPeerArrived: %0x2:%02x:%02x:%02x:%02x:%02x\n",
          a2->octet[0],
          a2->octet[1],
          a2->octet[2],
          a2->octet[3],
          a2->octet[4],
          a2->octet[5]);
      }
    }
    result = RSNSupplicant::allocateAuthenticator(v4, a2, v3);
  }
  return result;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000006D88) ----------------------------------------------------
int __fastcall RSNSupplicant::ibssPeerLeft(RSNSupplicant *this, ether_addr *a2)
{
  __int64 v2; // rax@1
  IO80211Interface *v3; // rdi@2
  int v4; // ST00_4@4

  v2 = RSNSupplicant::authenticatorForAddr(this, a2);
  if ( v2 )
  {
    LODWORD(v2) = RSNSupplicant::freeAuthenticator((__int64)this, v2);
    v3 = (IO80211Interface *)*((_QWORD *)this + 2);
    if ( v3 )
    {
      LODWORD(v2) = IO80211Interface::debugFlags(v3);
      if ( v2 & 4 )
      {
        v4 = a2->octet[5];
        IOLog(
          "ibssPeerLeft: %0x2:%02x:%02x:%02x:%02x:%02x\n",
          a2->octet[0],
          a2->octet[1],
          a2->octet[2],
          a2->octet[3],
          a2->octet[4]);
        LODWORD(v2) = IO8Log(
                        "ibssPeerLeft: %0x2:%02x:%02x:%02x:%02x:%02x\n",
                        a2->octet[0],
                        a2->octet[1],
                        a2->octet[2],
                        a2->octet[3],
                        a2->octet[4],
                        a2->octet[5]);
      }
    }
  }
  return v2;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000006E24) ----------------------------------------------------
__int64 __fastcall RSNSupplicant::MetaClass::~MetaClass(RSNSupplicant::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000006E30) ----------------------------------------------------
__int64 `global constructor keyed to'_a()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&RSNSupplicant::gMetaClass, "RSNSupplicant", off_7B030[0], 272LL);
  result = (__int64)off_7B3A0;
  RSNSupplicant::gMetaClass = off_7B3A0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 7B3A0: using guessed type __int64 (__fastcall *off_7B3A0[2])(RSNSupplicant::MetaClass *__hidden this);
// 842F0: using guessed type _QWORD RSNSupplicant::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000006E70) ----------------------------------------------------
__int64 `global destructor keyed to'_a()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&RSNSupplicant::gMetaClass);
}
// 842F0: using guessed type _QWORD RSNSupplicant::gMetaClass;

//----- (0000000000006E81) ----------------------------------------------------
int __fastcall sha1_mac(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  __int64 v5; // ST08_8@1
  __int64 v6; // r15@1
  __int64 v7; // r12@1
  char v9; // [sp+10h] [bp-90h]@1

  v5 = a5;
  v6 = a4;
  v7 = a3;
  SHA1Init(&v9);
  SHA1Update(&v9, a1, a2);
  SHA1Update(&v9, v7, v6);
  SHA1Update(&v9, a1, a2);
  return SHA1Final(v5, &v9);
}
// C77E0: using guessed type int __fastcall SHA1Final(_QWORD, _QWORD);
// C77E8: using guessed type int __fastcall SHA1Init(_QWORD);
// C77F0: using guessed type int __fastcall SHA1Update(_QWORD, _QWORD, _QWORD);

//----- (0000000000006EFC) ----------------------------------------------------
__int64 __fastcall hmac_sha1_vector(const void *a1, unsigned __int64 a2, int a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // r15@1
  __int64 v7; // rbx@1
  int v8; // er12@1
  __int64 v9; // r13@4
  __int64 v11; // [sp+0h] [bp-170h]@1
  const void *v12; // [sp+8h] [bp-168h]@2
  signed __int64 v13; // [sp+10h] [bp-160h]@2
  char v14; // [sp+18h] [bp-158h]@2
  char v15; // [sp+80h] [bp-F0h]@2
  char v16[80]; // [sp+A0h] [bp-D0h]@4
  char v17[80]; // [sp+F0h] [bp-80h]@4
  __int64 v18; // [sp+140h] [bp-30h]@1

  v11 = a6;
  v6 = a5;
  v7 = a4;
  v8 = a3;
  v18 = *(_QWORD *)off_7B078[0];
  if ( a2 < 0x41 )
  {
    v13 = a2;
    v12 = a1;
  }
  else
  {
    SHA1Init(&v14);
    SHA1Update(&v14, a1, a2);
    v12 = &v15;
    SHA1Final(&v15, &v14);
    v13 = 20LL;
  }
  v9 = 0LL;
  memset(v17, 0, 0x41uLL);
  memset(v16, 0, 0x41uLL);
  memcpy(v17, v12, v13);
  memcpy(v16, v12, v13);
  do
  {
    v17[v9] ^= 0x36u;
    v16[v9] ^= 0x5Cu;
    ++v9;
  }
  while ( v9 != 64 );
  SHA1Init(&v14);
  SHA1Update(&v14, v17, 64LL);
  if ( v8 > 0 )
  {
    do
    {
      SHA1Update(&v14, *(_QWORD *)v7, *(_QWORD *)v6);
      v7 += 8LL;
      v6 += 8LL;
      --v8;
    }
    while ( v8 );
  }
  SHA1Final(v11, &v14);
  SHA1Init(&v14);
  SHA1Update(&v14, v16, 64LL);
  SHA1Update(&v14, v11, 20LL);
  SHA1Final(v11, &v14);
  return *(_QWORD *)off_7B078[0];
}
// 7B078: using guessed type __int64 off_7B078[7];
// C77E0: using guessed type int __fastcall SHA1Final(_QWORD, _QWORD);
// C77E8: using guessed type int __fastcall SHA1Init(_QWORD);
// C77F0: using guessed type int __fastcall SHA1Update(_QWORD, _QWORD, _QWORD);
// 6EFC: using guessed type char var_80[80];
// 6EFC: using guessed type char var_D0[80];

//----- (00000000000070C2) ----------------------------------------------------
__int64 __fastcall hmac_sha1(const void *a1, unsigned __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  __int64 v6; // [sp+0h] [bp-10h]@1
  __int64 v7; // [sp+8h] [bp-8h]@1

  v7 = a3;
  v6 = a4;
  return hmac_sha1_vector(a1, a2, 1, (__int64)&v7, (__int64)&v6, a5);
}

//----- (00000000000070F0) ----------------------------------------------------
__int64 __fastcall sha1_prf(const void *a1, unsigned __int64 a2, const char *a3, __int64 a4, __int64 a5, __int64 a6, size_t a7)
{
  __int64 v7; // ST08_8@1
  __int64 v8; // rbx@1
  size_t v9; // r13@1
  size_t v10; // rbx@2
  __int64 v12; // [sp+10h] [bp-A0h]@1
  char v13; // [sp+1Eh] [bp-92h]@1
  char v14; // [sp+1Fh] [bp-91h]@1
  size_t v15; // [sp+20h] [bp-90h]@1
  __int64 v16; // [sp+28h] [bp-88h]@1
  __int64 v17; // [sp+30h] [bp-80h]@1
  __int64 v18; // [sp+38h] [bp-78h]@1
  const char *v19; // [sp+40h] [bp-70h]@1
  char *v20; // [sp+48h] [bp-68h]@1
  __int64 v21; // [sp+50h] [bp-60h]@1
  char *v22; // [sp+58h] [bp-58h]@1
  char v23; // [sp+60h] [bp-50h]@6
  __int64 v24; // [sp+80h] [bp-30h]@1

  v12 = a6;
  v7 = a5;
  v8 = a4;
  v24 = *(_QWORD *)off_7B078[0];
  v14 = 0;
  v13 = 0;
  v19 = a3;
  v15 = strlen(a3);
  v20 = &v14;
  v16 = 1LL;
  v21 = v8;
  v17 = v7;
  v22 = &v13;
  v18 = 1LL;
  v9 = 0LL;
  if ( a7 )
  {
    v10 = a7;
    while ( v10 >= 0x14 )
    {
      hmac_sha1_vector(a1, a2, 4, (__int64)&v19, (__int64)&v15, v12 + v9);
      v9 += 20LL;
      ++v13;
      v10 -= 20LL;
      if ( v9 >= a7 )
        return *(_QWORD *)off_7B078[0];
    }
    hmac_sha1_vector(a1, a2, 4, (__int64)&v19, (__int64)&v15, (__int64)&v23);
    memcpy((void *)(v9 + v12), &v23, v10);
  }
  return *(_QWORD *)off_7B078[0];
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000007233) ----------------------------------------------------
__int64 __fastcall sha1_t_prf(const void *a1, unsigned __int64 a2, const char *a3, __int64 a4, __int64 a5, __int64 a6, size_t a7)
{
  __int64 v7; // r15@1
  __int64 v8; // rbx@1
  const void *v9; // r12@1
  size_t v10; // r14@1
  char v11; // al@2
  size_t i; // rbx@2
  void *v13; // rdi@4
  __int64 v15; // [sp+10h] [bp-C0h]@1
  char v16; // [sp+1Dh] [bp-B3h]@1
  char v17; // [sp+1Eh] [bp-B2h]@1
  char v18; // [sp+1Fh] [bp-B1h]@1
  __int64 v19; // [sp+20h] [bp-B0h]@1
  size_t v20; // [sp+28h] [bp-A8h]@1
  __int64 v21; // [sp+30h] [bp-A0h]@1
  __int64 v22; // [sp+38h] [bp-98h]@1
  __int64 v23; // [sp+40h] [bp-90h]@1
  char *v24; // [sp+50h] [bp-80h]@1
  const char *v25; // [sp+58h] [bp-78h]@1
  __int64 v26; // [sp+60h] [bp-70h]@1
  char *v27; // [sp+68h] [bp-68h]@1
  char *v28; // [sp+70h] [bp-60h]@1
  char v29; // [sp+80h] [bp-50h]@1
  __int64 v30; // [sp+A0h] [bp-30h]@1

  v15 = a6;
  v7 = a5;
  v8 = a4;
  v9 = a1;
  v30 = *(_QWORD *)off_7B078[0];
  v18 = 0;
  v24 = &v29;
  v19 = 0LL;
  v25 = a3;
  v20 = strlen(a3) + 1;
  v26 = v8;
  v21 = v7;
  v27 = &v16;
  v22 = 2LL;
  v28 = &v18;
  v23 = 1LL;
  v16 = BYTE1(a7);
  v17 = a7;
  v10 = 0LL;
  if ( a7 )
  {
    v11 = 1;
    for ( i = a7; ; i -= 20LL )
    {
      v18 = v11;
      hmac_sha1_vector(v9, a2, 5, (__int64)&v24, (__int64)&v19, (__int64)&v29);
      v13 = (void *)(v15 + v10);
      if ( i < 0x14 )
        break;
      memcpy(v13, &v29, 0x14uLL);
      v10 += 20LL;
      v19 = 20LL;
      if ( v10 >= a7 )
        return *(_QWORD *)off_7B078[0];
      v11 = v18 + 1;
    }
    memcpy(v13, &v29, i);
  }
  return *(_QWORD *)off_7B078[0];
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (00000000000073A1) ----------------------------------------------------
signed __int64 __fastcall tls_prf(const void *a1, __int64 a2, const char *a3, __int64 a4, __int64 a5, __int64 a6, int a7)
{
  const char *v7; // r13@1
  __int64 v8; // r15@1
  signed __int64 result; // rax@1
  __int64 v10; // r12@2
  __int64 v11; // r14@2
  const void *v12; // r12@2
  int v13; // er14@2
  signed int v14; // er15@3
  signed int v15; // er13@3
  __int64 v16; // rcx@11
  unsigned __int64 v17; // [sp+10h] [bp-130h]@2
  __int64 v18; // [sp+18h] [bp-128h]@2
  __int64 v19; // [sp+20h] [bp-120h]@7
  char *v20; // [sp+28h] [bp-118h]@7
  __int64 v21; // [sp+30h] [bp-110h]@2
  size_t v22; // [sp+38h] [bp-108h]@2
  __int64 v23; // [sp+40h] [bp-100h]@2
  char *v24; // [sp+50h] [bp-F0h]@2
  const char *v25; // [sp+58h] [bp-E8h]@2
  __int64 v26; // [sp+60h] [bp-E0h]@2
  __int64 v27; // [sp+70h] [bp-D0h]@2
  size_t v28; // [sp+78h] [bp-C8h]@2
  __int64 v29; // [sp+80h] [bp-C0h]@2
  char *v30; // [sp+90h] [bp-B0h]@2
  const char *v31; // [sp+98h] [bp-A8h]@2
  __int64 v32; // [sp+A0h] [bp-A0h]@2
  char v33[32]; // [sp+B0h] [bp-90h]@7
  char v34[16]; // [sp+D0h] [bp-70h]@5
  char v35; // [sp+E0h] [bp-60h]@2
  char v36; // [sp+100h] [bp-40h]@2
  __int64 v37; // [sp+110h] [bp-30h]@1

  v7 = a3;
  v8 = off_7B078[0];
  v37 = *(_QWORD *)off_7B078[0];
  result = 0xFFFFFFFFLL;
  if ( !(a2 & 1) )
  {
    v18 = a6;
    v30 = &v36;
    v27 = 16LL;
    v31 = a3;
    v10 = a4;
    v11 = a5;
    v28 = strlen(a3);
    v32 = v10;
    v29 = v11;
    v24 = &v35;
    v21 = 20LL;
    v25 = v7;
    v22 = strlen(v7);
    v26 = v10;
    v23 = v11;
    v17 = (unsigned __int64)(a2 + 1) >> 1;
    hmac_md5_vector(a1, v17, 2uLL, (__int64)&v31, (__int64)&v28, (__int64)&v36);
    v12 = (char *)a1 + v17;
    hmac_sha1_vector((char *)a1 + v17, v17, 2, (__int64)&v25, (__int64)&v22, (__int64)&v35);
    v13 = a7;
    if ( a7 > 0 )
    {
      v14 = 16;
      v15 = 20;
      do
      {
        if ( v14 == 16 )
        {
          hmac_md5_vector(a1, v17, 3uLL, (__int64)&v30, (__int64)&v27, (__int64)v34);
          hmac_md5(a1, v17, (__int64)&v36, 16LL, (__int64)&v36);
          v14 = 0;
        }
        if ( v15 == 20 )
        {
          hmac_sha1_vector(v12, v17, 3, (__int64)&v24, (__int64)&v21, (__int64)v33);
          v20 = &v35;
          v19 = 20LL;
          hmac_sha1_vector(v12, v17, 1, (__int64)&v20, (__int64)&v19, (__int64)&v35);
          v15 = 0;
        }
        *(_BYTE *)v18++ = v34[v14++] ^ v33[v15++];
        --v13;
      }
      while ( v13 );
      v8 = off_7B078[0];
    }
    result = 0LL;
  }
  v16 = *(_QWORD *)v8;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 73A1: using guessed type char var_70[16];
// 73A1: using guessed type char var_90[32];

//----- (00000000000075F2) ----------------------------------------------------
__int64 __fastcall pbkdf2_sha1(const char *a1, __int64 a2, __int64 a3, signed int a4, void *a5, size_t a6)
{
  size_t v6; // r15@1
  signed int v7; // er12@1
  int v8; // eax@2
  unsigned int v9; // ebx@3
  unsigned __int64 v10; // r15@3
  signed int v11; // ebx@3
  __int64 v12; // rax@4
  size_t v13; // rbx@7
  __int64 v15; // [sp+10h] [bp-F0h]@1
  signed int v16; // [sp+18h] [bp-E8h]@1
  int v17; // [sp+1Ch] [bp-E4h]@3
  size_t v18; // [sp+20h] [bp-E0h]@3
  void *v19; // [sp+28h] [bp-D8h]@1
  char v20; // [sp+3Ch] [bp-C4h]@3
  char v21; // [sp+3Dh] [bp-C3h]@3
  char v22; // [sp+3Eh] [bp-C2h]@3
  char v23; // [sp+3Fh] [bp-C1h]@3
  __int64 v24; // [sp+40h] [bp-C0h]@4
  char *v25; // [sp+48h] [bp-B8h]@4
  char v26[32]; // [sp+50h] [bp-B0h]@3
  __int64 v27; // [sp+70h] [bp-90h]@3
  __int64 v28; // [sp+78h] [bp-88h]@3
  __int64 v29; // [sp+80h] [bp-80h]@3
  char *v30; // [sp+88h] [bp-78h]@3
  char v31[32]; // [sp+90h] [bp-70h]@4
  char v32; // [sp+B0h] [bp-50h]@3
  __int64 v33; // [sp+D0h] [bp-30h]@1

  v6 = a6;
  v19 = a5;
  v7 = a4;
  v16 = a4;
  v15 = a3;
  v33 = *(_QWORD *)off_7B078[0];
  if ( a6 )
  {
    v8 = 1;
    do
    {
      v17 = v8;
      v18 = v6;
      v9 = v8;
      v10 = strlen(a1);
      v29 = a2;
      v27 = v15;
      v30 = &v20;
      v28 = 4LL;
      v20 = BYTE3(v9);
      v21 = v9 >> 16;
      v22 = BYTE1(v9);
      v23 = v9;
      hmac_sha1_vector(a1, v10, 2, (__int64)&v29, (__int64)&v27, (__int64)&v32);
      memcpy(v26, &v32, 0x14uLL);
      v11 = 1;
      if ( v7 >= 2 )
      {
        do
        {
          v25 = &v32;
          v24 = 20LL;
          hmac_sha1_vector(a1, v10, 1, (__int64)&v25, (__int64)&v24, (__int64)v31);
          memcpy(&v32, v31, 0x14uLL);
          v12 = 0LL;
          do
          {
            v26[v12] ^= v31[v12];
            ++v12;
          }
          while ( v12 != 20 );
          ++v11;
        }
        while ( v11 != v7 );
      }
      v13 = 20LL;
      if ( v18 <= 0x14 )
        v13 = v18;
      memcpy(v19, v26, v13);
      v19 = (char *)v19 + v13;
      v7 = v16;
      v8 = v17 + 1;
      v6 = v18 - v13;
    }
    while ( v18 != v13 );
  }
  return *(_QWORD *)off_7B078[0];
}
// 7B078: using guessed type __int64 off_7B078[7];
// 75F2: using guessed type char var_70[32];
// 75F2: using guessed type char var_B0[32];

//----- (00000000000077E6) ----------------------------------------------------
int __fastcall sha1_vector(int a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  __int64 v6; // rbx@1
  int v7; // er12@1
  char v9; // [sp+0h] [bp-90h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = a1;
  SHA1Init(&v9);
  if ( a1 > 0 )
  {
    do
    {
      SHA1Update(&v9, *(_QWORD *)v6, *(_QWORD *)v5);
      v6 += 8LL;
      v5 += 8LL;
      --v7;
    }
    while ( v7 );
  }
  return SHA1Final(v4, &v9);
}
// C77E0: using guessed type int __fastcall SHA1Final(_QWORD, _QWORD);
// C77E8: using guessed type int __fastcall SHA1Init(_QWORD);
// C77F0: using guessed type int __fastcall SHA1Update(_QWORD, _QWORD, _QWORD);

//----- (0000000000007854) ----------------------------------------------------
__int64 __fastcall rc4_skip(__int64 a1, int a2, unsigned __int64 a3, __int64 a4, unsigned __int64 a5)
{
  __int64 v5; // r9@1
  __int64 v6; // rax@1
  __int64 v7; // r11@3
  __int64 v8; // r15@3
  int v9; // eax@3
  char v10; // r14@4
  __int64 v11; // rsi@7
  signed int v12; // eax@8
  __int64 v13; // rdi@8
  char v14; // r10@9
  unsigned __int64 v15; // rbx@9
  __int64 v16; // rdx@12
  char v17; // al@13
  char v19[256]; // [sp+0h] [bp-120h]@2
  __int64 v20; // [sp+100h] [bp-20h]@1

  v5 = off_7B078[0];
  v20 = *(_QWORD *)off_7B078[0];
  v6 = 0LL;
  do
  {
    v19[v6] = v6;
    ++v6;
  }
  while ( v6 != 256 );
  v7 = 0LL;
  LOBYTE(v8) = 0;
  v9 = 0;
  do
  {
    v10 = v19[v7];
    v8 = (unsigned __int8)(v10 + v8 + *(_BYTE *)(a1 + v9++));
    if ( v9 >= a2 )
      v9 = 0;
    v19[v7] = v19[v8];
    v19[v8] = v10;
    ++v7;
  }
  while ( v7 != 256 );
  LOBYTE(v11) = 0;
  if ( a3 )
  {
    v12 = 1;
    LOBYTE(v13) = 0;
    do
    {
      v11 = (unsigned __int8)(v11 + 1);
      v14 = v19[v11];
      v13 = (unsigned __int8)(v14 + v13);
      v19[v11] = v19[v13];
      v19[v13] = v14;
      v15 = (unsigned int)v12++;
    }
    while ( v15 < a3 );
  }
  else
  {
    LOBYTE(v13) = 0;
  }
  v16 = 0LL;
  if ( a5 )
  {
    do
    {
      v11 = (unsigned __int8)(v11 + 1);
      v17 = v19[v11];
      v13 = (unsigned __int8)(v17 + v13);
      v19[v11] = v19[v13];
      v19[v13] = v17;
      *(_BYTE *)(a4 + v16++) ^= v19[(unsigned __int8)(v17 + v19[v11])];
    }
    while ( (unsigned int)v16 < a5 );
  }
  return *(_QWORD *)v5;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 7854: using guessed type char var_120[256];

//----- (000000000000798A) ----------------------------------------------------
__int64 __fastcall md5_mac(__int64 a1, unsigned int a2, __int64 a3, unsigned int a4, __int64 a5)
{
  __int64 v5; // ST00_8@1
  unsigned int v6; // er15@1
  __int64 v7; // r12@1
  char v9; // [sp+8h] [bp-88h]@1
  __int64 v10; // [sp+60h] [bp-30h]@1

  v5 = a5;
  v6 = a4;
  v7 = a3;
  v10 = *(_QWORD *)off_7B078[0];
  MD5Init(&v9);
  MD5Update(&v9, a1, a2);
  MD5Update(&v9, v7, v6);
  MD5Update(&v9, a1, a2);
  MD5Final(v5, &v9);
  return *(_QWORD *)off_7B078[0];
}
// 7B078: using guessed type __int64 off_7B078[7];
// C7790: using guessed type int __fastcall MD5Final(_QWORD, _QWORD);
// C7798: using guessed type int __fastcall MD5Init(_QWORD);
// C77A0: using guessed type int __fastcall MD5Update(_QWORD, _QWORD, _QWORD);

//----- (0000000000007A28) ----------------------------------------------------
__int64 __fastcall hmac_md5_vector(const void *a1, unsigned __int64 a2, unsigned __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // r15@1
  __int64 v7; // r12@1
  unsigned __int64 v8; // r13@1
  __int64 v9; // rbx@4
  unsigned __int64 v10; // rax@6
  signed int v11; // ebx@7
  __int64 v13; // [sp+8h] [bp-148h]@1
  const void *v14; // [sp+10h] [bp-140h]@2
  signed __int64 v15; // [sp+18h] [bp-138h]@2
  char v16; // [sp+20h] [bp-130h]@2
  char v17[80]; // [sp+30h] [bp-120h]@4
  char v18[72]; // [sp+80h] [bp-D0h]@4
  char v19; // [sp+C8h] [bp-88h]@2
  __int64 v20; // [sp+120h] [bp-30h]@1

  v13 = a6;
  v6 = a5;
  v7 = a4;
  v8 = a3;
  v20 = *(_QWORD *)off_7B078[0];
  if ( a2 < 0x41 )
  {
    v15 = a2;
    v14 = a1;
  }
  else
  {
    MD5Init(&v19);
    MD5Update(&v19, a1, (unsigned int)a2);
    v14 = &v16;
    MD5Final(&v16, &v19);
    v15 = 16LL;
  }
  v9 = 0LL;
  memset(v18, 0, 0x41uLL);
  memset(v17, 0, 0x41uLL);
  memcpy(v18, v14, v15);
  memcpy(v17, v14, v15);
  do
  {
    v18[v9] ^= 0x36u;
    v17[v9] ^= 0x5Cu;
    ++v9;
  }
  while ( v9 != 64 );
  MD5Init(&v19);
  MD5Update(&v19, v18, 64LL);
  v10 = 0LL;
  if ( v8 )
  {
    v11 = 1;
    do
    {
      MD5Update(&v19, *(_QWORD *)(v7 + 8 * v10), *(_DWORD *)(v6 + 8 * v10));
      v10 = (unsigned int)v11++;
    }
    while ( v10 < v8 );
  }
  MD5Final(v13, &v19);
  MD5Init(&v19);
  MD5Update(&v19, v17, 64LL);
  MD5Update(&v19, v13, 16LL);
  MD5Final(v13, &v19);
  return *(_QWORD *)off_7B078[0];
}
// 7B078: using guessed type __int64 off_7B078[7];
// C7790: using guessed type int __fastcall MD5Final(_QWORD, _QWORD);
// C7798: using guessed type int __fastcall MD5Init(_QWORD);
// C77A0: using guessed type int __fastcall MD5Update(_QWORD, _QWORD, _QWORD);
// 7A28: using guessed type char var_D0[72];
// 7A28: using guessed type char var_120[80];

//----- (0000000000007BF8) ----------------------------------------------------
__int64 __fastcall hmac_md5(const void *a1, unsigned __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  __int64 v6; // [sp+0h] [bp-10h]@1
  __int64 v7; // [sp+8h] [bp-8h]@1

  v7 = a3;
  v6 = a4;
  return hmac_md5_vector(a1, a2, 1uLL, (__int64)&v7, (__int64)&v6, a5);
}

//----- (0000000000007C30) ----------------------------------------------------
__int64 __fastcall IO80211WorkLoop::MetaClass::MetaClass(IO80211WorkLoop::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211WorkLoop", off_7B000[0], 72LL);
  result = (__int64)off_7B740;
  *(_QWORD *)this = off_7B740;
  return result;
}
// 7B000: using guessed type _QWORD off_7B000[22];
// 7B740: using guessed type __int64 (__fastcall *off_7B740[2])(IO80211WorkLoop::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000007C62) ----------------------------------------------------
__int64 __fastcall IO80211WorkLoop::MetaClass::~MetaClass(IO80211WorkLoop::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000007C6C) ----------------------------------------------------
__int64 __fastcall IO80211WorkLoop::IO80211WorkLoop(__int64 a1)
{
  __int64 result; // rax@1

  IOWorkLoop::IOWorkLoop(a1);
  result = (__int64)off_7B520;
  *(_QWORD *)a1 = off_7B520;
  return result;
}
// 7B520: using guessed type __int64 (__fastcall *off_7B520[2])(IO80211WorkLoop *__hidden this);
// C7898: using guessed type int __cdecl IOWorkLoop::IOWorkLoop(_QWORD);

//----- (0000000000007C8C) ----------------------------------------------------
__int64 __fastcall IO80211WorkLoop::IO80211WorkLoop(__int64 a1)
{
  __int64 result; // rax@1

  IOWorkLoop::IOWorkLoop(a1);
  result = (__int64)off_7B520;
  *(_QWORD *)a1 = off_7B520;
  return result;
}
// 7B520: using guessed type __int64 (__fastcall *off_7B520[2])(IO80211WorkLoop *__hidden this);
// C7898: using guessed type int __cdecl IOWorkLoop::IOWorkLoop(_QWORD);

//----- (0000000000007CAC) ----------------------------------------------------
__int64 __fastcall IO80211WorkLoop::~IO80211WorkLoop(IO80211WorkLoop *this)
{
  return IOWorkLoop::~IOWorkLoop(this);
}

//----- (0000000000007CB6) ----------------------------------------------------
__int64 __fastcall IO80211WorkLoop::~IO80211WorkLoop(IO80211WorkLoop *this)
{
  return IOWorkLoop::~IOWorkLoop(this);
}

//----- (0000000000007CC0) ----------------------------------------------------
void __fastcall IO80211WorkLoop::~IO80211WorkLoop(IO80211WorkLoop *this)
{
  IOWorkLoop::~IOWorkLoop(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000007CE2) ----------------------------------------------------
__int64 __fastcall IO80211WorkLoop::getMetaClass(IO80211WorkLoop *this)
{
  return (__int64)&IO80211WorkLoop::gMetaClass;
}
// 84318: using guessed type _QWORD IO80211WorkLoop::gMetaClass;

//----- (0000000000007CF0) ----------------------------------------------------
__int64 __fastcall IO80211WorkLoop::MetaClass::MetaClass(IO80211WorkLoop::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211WorkLoop", off_7B000[0], 72LL);
  result = (__int64)off_7B740;
  *(_QWORD *)this = off_7B740;
  return result;
}
// 7B000: using guessed type _QWORD off_7B000[22];
// 7B740: using guessed type __int64 (__fastcall *off_7B740[2])(IO80211WorkLoop::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000007D22) ----------------------------------------------------
__int64 __fastcall IO80211WorkLoop::MetaClass::alloc(IO80211WorkLoop::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20.fileoff, a2);
  IOWorkLoop::IOWorkLoop(v2);
  *(_QWORD *)v2 = off_7B520;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211WorkLoop::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 7B520: using guessed type __int64 (__fastcall *off_7B520[2])(IO80211WorkLoop *__hidden this);
// 84318: using guessed type _QWORD IO80211WorkLoop::gMetaClass;
// C7898: using guessed type int __cdecl IOWorkLoop::IOWorkLoop(_QWORD);

//----- (0000000000007D62) ----------------------------------------------------
__int64 __fastcall IO80211WorkLoop::IO80211WorkLoop(__int64 a1)
{
  IOWorkLoop::IOWorkLoop(a1);
  *(_QWORD *)a1 = off_7B520;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211WorkLoop::gMetaClass);
}
// 7B520: using guessed type __int64 (__fastcall *off_7B520[2])(IO80211WorkLoop *__hidden this);
// 84318: using guessed type _QWORD IO80211WorkLoop::gMetaClass;
// C7898: using guessed type int __cdecl IOWorkLoop::IOWorkLoop(_QWORD);

//----- (0000000000007D92) ----------------------------------------------------
__int64 __fastcall IO80211WorkLoop::IO80211WorkLoop(__int64 a1)
{
  IOWorkLoop::IOWorkLoop(a1);
  *(_QWORD *)a1 = off_7B520;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211WorkLoop::gMetaClass);
}
// 7B520: using guessed type __int64 (__fastcall *off_7B520[2])(IO80211WorkLoop *__hidden this);
// 84318: using guessed type _QWORD IO80211WorkLoop::gMetaClass;
// C7898: using guessed type int __cdecl IOWorkLoop::IOWorkLoop(_QWORD);

//----- (0000000000007DC2) ----------------------------------------------------
__int64 __fastcall IO80211WorkLoop::workLoop(IO80211WorkLoop *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20.fileoff, a2);
  IOWorkLoop::IOWorkLoop(v2);
  *(_QWORD *)v2 = off_7B520;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211WorkLoop::gMetaClass);
  if ( v2
    && !(unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v2 + 136LL))(
                           v2,
                           &IO80211WorkLoop::gMetaClass) )
  {
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
    v2 = 0LL;
  }
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 7B520: using guessed type __int64 (__fastcall *off_7B520[2])(IO80211WorkLoop *__hidden this);
// 84318: using guessed type _QWORD IO80211WorkLoop::gMetaClass;
// C7898: using guessed type int __cdecl IOWorkLoop::IOWorkLoop(_QWORD);

//----- (0000000000007E22) ----------------------------------------------------
int __fastcall IO80211WorkLoop::sleepGateDeadline(IO80211WorkLoop *this, void *a2, unsigned int a3, __int64 a4)
{
  return (*(int (__fastcall **)(IO80211WorkLoop *, void *, __int64, _QWORD))(off_7B048[0] + 448))(this, a2, a4, a3);
}
// 7B048: using guessed type __int64 off_7B048[13];

//----- (0000000000007E3C) ----------------------------------------------------
int __fastcall IO80211WorkLoop::wakeupGate(IO80211WorkLoop *this, void *a2, unsigned __int8 a3)
{
  return (*(int (__fastcall **)(IO80211WorkLoop *, void *, _QWORD))(off_7B048[0] + 424))(this, a2, a3);
}
// 7B048: using guessed type __int64 off_7B048[13];

//----- (0000000000007E52) ----------------------------------------------------
int __fastcall IO80211WorkLoop::sleepGate(IO80211WorkLoop *this, void *a2)
{
  return (*(int (__fastcall **)(IO80211WorkLoop *, void *))(off_7B048[0] + 416))(this, a2);
}
// 7B048: using guessed type __int64 off_7B048[13];

//----- (0000000000007E64) ----------------------------------------------------
int __fastcall IO80211WorkLoop::openGate(IO80211WorkLoop *this)
{
  return (*(int (__fastcall **)(IO80211WorkLoop *))(off_7B048[0] + 392))(this);
}
// 7B048: using guessed type __int64 off_7B048[13];

//----- (0000000000007E76) ----------------------------------------------------
int __fastcall IO80211WorkLoop::closeGate(IO80211WorkLoop *this)
{
  return (*(int (__fastcall **)(IO80211WorkLoop *))(off_7B048[0] + 400))(this);
}
// 7B048: using guessed type __int64 off_7B048[13];

//----- (0000000000007E88) ----------------------------------------------------
__int64 __fastcall IO80211WorkLoop::MetaClass::~MetaClass(IO80211WorkLoop::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000007EA0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_0()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IO80211WorkLoop::gMetaClass, "IO80211WorkLoop", off_7B000[0], 72LL);
  result = (__int64)off_7B740;
  IO80211WorkLoop::gMetaClass = off_7B740;
  return result;
}
// 7B000: using guessed type _QWORD off_7B000[22];
// 7B740: using guessed type __int64 (__fastcall *off_7B740[2])(IO80211WorkLoop::MetaClass *__hidden this);
// 84318: using guessed type _QWORD IO80211WorkLoop::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000007EE0) ----------------------------------------------------
__int64 `global destructor keyed to'_a_0()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211WorkLoop::gMetaClass);
}
// 84318: using guessed type _QWORD IO80211WorkLoop::gMetaClass;

//----- (0000000000007EF1) ----------------------------------------------------
__int64 __fastcall sha256_prf(void *a1, size_t a2, const char *a3, __int64 a4, __int64 a5, __int64 a6, unsigned __int64 a7)
{
  __int64 v7; // r13@1
  __int64 v8; // r14@1
  signed __int16 v9; // bx@2
  unsigned __int64 v10; // r13@2
  size_t v11; // r14@2
  __int64 v13; // [sp+10h] [bp-A0h]@1
  char v14; // [sp+1Ch] [bp-94h]@1
  char v15; // [sp+1Dh] [bp-93h]@1
  __int16 v16; // [sp+1Eh] [bp-92h]@1
  __int64 v17; // [sp+20h] [bp-90h]@1
  size_t v18; // [sp+28h] [bp-88h]@1
  __int64 v19; // [sp+30h] [bp-80h]@1
  __int64 v20; // [sp+38h] [bp-78h]@1
  __int16 *v21; // [sp+40h] [bp-70h]@1
  const char *v22; // [sp+48h] [bp-68h]@1
  __int64 v23; // [sp+50h] [bp-60h]@1
  char *v24; // [sp+58h] [bp-58h]@1
  char v25; // [sp+60h] [bp-50h]@6
  __int64 v26; // [sp+80h] [bp-30h]@1

  v13 = a6;
  v7 = a5;
  v8 = a4;
  v26 = *(_QWORD *)off_7B078[0];
  v21 = &v16;
  v17 = 2LL;
  v22 = a3;
  v18 = strlen(a3);
  v23 = v8;
  v19 = v7;
  v24 = &v14;
  v20 = 2LL;
  v15 = a7 >> 5;
  v14 = 8 * a7;
  if ( a7 )
  {
    v9 = 1;
    v10 = 0LL;
    v11 = a7;
    while ( 1 )
    {
      v16 = v9;
      if ( v11 < 0x20 )
        break;
      hmac_sha256_vector(a1, a2, 4uLL, (__int64 *)&v21, &v17, v13 + v10);
      v10 += 32LL;
      ++v9;
      v11 -= 32LL;
      if ( v10 >= a7 )
        return *(_QWORD *)off_7B078[0];
    }
    hmac_sha256_vector(a1, a2, 4uLL, (__int64 *)&v21, &v17, (__int64)&v25);
    memcpy((void *)(v10 + v13), &v25, v11);
  }
  return *(_QWORD *)off_7B078[0];
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000008060) ----------------------------------------------------
__int64 __fastcall LogManagerDevice::MetaClass::MetaClass(LogManagerDevice::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "LogManagerDevice", &LogManager::gMetaClass, 112LL);
  result = (__int64)off_7B980;
  *(_QWORD *)this = off_7B980;
  return result;
}
// 7B980: using guessed type __int64 (__fastcall *off_7B980[2])(LogManagerDevice::MetaClass *__hidden this);
// 84390: using guessed type _QWORD LogManager::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000008092) ----------------------------------------------------
__int64 __fastcall LogManagerDevice::MetaClass::~MetaClass(LogManagerDevice::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000809C) ----------------------------------------------------
__int64 __fastcall LogManagerDevice::LogManagerDevice(__int64 a1)
{
  __int64 result; // rax@1

  LogManager::LogManager(a1);
  result = (__int64)off_7B840;
  *(_QWORD *)a1 = off_7B840;
  return result;
}
// 7B840: using guessed type __int64 (__fastcall *off_7B840[2])(LogManagerDevice *__hidden this);

//----- (00000000000080BC) ----------------------------------------------------
__int64 __fastcall LogManagerDevice::LogManagerDevice(__int64 a1)
{
  __int64 result; // rax@1

  LogManager::LogManager(a1);
  result = (__int64)off_7B840;
  *(_QWORD *)a1 = off_7B840;
  return result;
}
// 7B840: using guessed type __int64 (__fastcall *off_7B840[2])(LogManagerDevice *__hidden this);

//----- (00000000000080DC) ----------------------------------------------------
__int64 __fastcall LogManagerDevice::~LogManagerDevice(LogManagerDevice *this)
{
  return LogManager::~LogManager(this);
}

//----- (00000000000080E6) ----------------------------------------------------
__int64 __fastcall LogManagerDevice::~LogManagerDevice(LogManagerDevice *this)
{
  return LogManager::~LogManager(this);
}

//----- (00000000000080F0) ----------------------------------------------------
void __fastcall LogManagerDevice::~LogManagerDevice(LogManagerDevice *this)
{
  LogManager::~LogManager(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000008112) ----------------------------------------------------
__int64 __fastcall LogManagerDevice::getMetaClass(LogManagerDevice *this)
{
  return (__int64)&LogManagerDevice::gMetaClass;
}
// 84340: using guessed type _QWORD LogManagerDevice::gMetaClass;

//----- (0000000000008120) ----------------------------------------------------
__int64 __fastcall LogManagerDevice::MetaClass::MetaClass(LogManagerDevice::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "LogManagerDevice", &LogManager::gMetaClass, 112LL);
  result = (__int64)off_7B980;
  *(_QWORD *)this = off_7B980;
  return result;
}
// 7B980: using guessed type __int64 (__fastcall *off_7B980[2])(LogManagerDevice::MetaClass *__hidden this);
// 84390: using guessed type _QWORD LogManager::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000008152) ----------------------------------------------------
__int64 __fastcall LogManagerDevice::MetaClass::alloc(LogManagerDevice::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_68.sectname[8], a2);
  LogManager::LogManager(v2);
  *(_QWORD *)v2 = off_7B840;
  OSMetaClass::instanceConstructed((OSMetaClass *)&LogManagerDevice::gMetaClass);
  return v2;
}
// 68: using guessed type section_64 stru_68;
// 7B840: using guessed type __int64 (__fastcall *off_7B840[2])(LogManagerDevice *__hidden this);
// 84340: using guessed type _QWORD LogManagerDevice::gMetaClass;

//----- (0000000000008192) ----------------------------------------------------
__int64 __fastcall LogManagerDevice::LogManagerDevice(__int64 a1)
{
  LogManager::LogManager(a1);
  *(_QWORD *)a1 = off_7B840;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&LogManagerDevice::gMetaClass);
}
// 7B840: using guessed type __int64 (__fastcall *off_7B840[2])(LogManagerDevice *__hidden this);
// 84340: using guessed type _QWORD LogManagerDevice::gMetaClass;

//----- (00000000000081C2) ----------------------------------------------------
__int64 __fastcall LogManagerDevice::LogManagerDevice(__int64 a1)
{
  LogManager::LogManager(a1);
  *(_QWORD *)a1 = off_7B840;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&LogManagerDevice::gMetaClass);
}
// 7B840: using guessed type __int64 (__fastcall *off_7B840[2])(LogManagerDevice *__hidden this);
// 84340: using guessed type _QWORD LogManagerDevice::gMetaClass;

//----- (00000000000081F2) ----------------------------------------------------
__int64 __fastcall LogManagerDevice::withDeviceNameAndGate(LogManagerDevice *this, IOCommandGate *a2, IOCommandGate *a3, int a4)
{
  int v4; // er15@1
  __int64 v5; // rbx@1
  int v7; // [sp+0h] [bp-2Ch]@1

  v7 = a4;
  v4 = (signed int)a3;
  v5 = OSObject::operator new((OSObject *)&stru_68.sectname[8], (unsigned __int64)a2);
  LogManager::LogManager(v5);
  *(_QWORD *)v5 = off_7B840;
  OSMetaClass::instanceConstructed((OSMetaClass *)&LogManagerDevice::gMetaClass);
  if ( v5 && !LogManagerDevice::initWithDeviceNameAndGate((LogManagerDevice *)v5, (const char *)this, a2, v4, v7) )
  {
    (*(void (__fastcall **)(__int64, LogManagerDevice *))(*(_QWORD *)v5 + 40LL))(v5, this);
    v5 = 0LL;
  }
  return v5;
}
// 68: using guessed type section_64 stru_68;
// 7B840: using guessed type __int64 (__fastcall *off_7B840[2])(LogManagerDevice *__hidden this);
// 84340: using guessed type _QWORD LogManagerDevice::gMetaClass;

//----- (0000000000008278) ----------------------------------------------------
char __fastcall LogManagerDevice::initWithDeviceNameAndGate(LogManagerDevice *this, const char *a2, IOCommandGate *a3, int a4, int a5)
{
  char v5; // r14@1
  __int64 v6; // rax@1

  v5 = 0;
  v6 = IOCharacterDevice::withGatedDataSource(
         (__int64)this,
         (unsigned __int64)LogManagerDevice::deviceRequestCallback,
         0LL,
         (__int64)a3,
         a2,
         a4,
         a5);
  *((_QWORD *)this + 12) = v6;
  if ( v6 )
    v5 = LogManager::initWithDataRadyCallback(
           (__int64)this,
           (__int64)this,
           (__int64)LogManagerDevice::dataReadyCallback,
           0LL);
  return v5;
}

//----- (00000000000082D4) ----------------------------------------------------
__int64 __fastcall LogManagerDevice::withDeviceNameAndLock(const char *a1, unsigned __int64 a2, int a3, int a4)
{
  int v4; // er15@1
  __int64 v5; // rbx@1
  int v7; // [sp+0h] [bp-2Ch]@1

  v7 = a4;
  v4 = a3;
  v5 = OSObject::operator new((OSObject *)&stru_68.sectname[8], a2);
  LogManager::LogManager(v5);
  *(_QWORD *)v5 = off_7B840;
  OSMetaClass::instanceConstructed((OSMetaClass *)&LogManagerDevice::gMetaClass);
  if ( v5 && !LogManagerDevice::initWithDeviceNameAndLock(v5, a1, a2, v4, v7) )
  {
    (*(void (__fastcall **)(__int64, const char *))(*(_QWORD *)v5 + 40LL))(v5, a1);
    v5 = 0LL;
  }
  return v5;
}
// 68: using guessed type section_64 stru_68;
// 7B840: using guessed type __int64 (__fastcall *off_7B840[2])(LogManagerDevice *__hidden this);
// 84340: using guessed type _QWORD LogManagerDevice::gMetaClass;

//----- (000000000000835A) ----------------------------------------------------
char __fastcall LogManagerDevice::initWithDeviceNameAndLock(__int64 a1, const char *a2, __int64 a3, int a4, int a5)
{
  __int64 v5; // r14@1
  char v6; // r15@1
  __int64 v7; // rax@1

  v5 = a3;
  v6 = 0;
  v7 = IOCharacterDevice::withLockedDataSource(
         a1,
         (unsigned __int64)LogManagerDevice::deviceRequestCallback,
         0LL,
         a3,
         a2,
         a4,
         a5);
  *(_QWORD *)(a1 + 96) = v7;
  if ( v7 )
  {
    *(_QWORD *)(a1 + 104) = v5;
    v6 = LogManager::initWithDataRadyCallback(a1, a1, (__int64)LogManagerDevice::dataReadyCallback, 0LL);
  }
  return v6;
}

//----- (00000000000083BE) ----------------------------------------------------
__int64 __fastcall LogManagerDevice::deviceRequestCallback(LogManagerDevice *this, int a2, void *a3, void *a4)
{
  __int64 result; // rax@1

  result = 0xFFFFFFFFLL;
  switch ( a2 )
  {
    case 1:
      LOBYTE(result) = LogManager::dataAvailable(this, a4);
      goto LABEL_8;
    case 2:
      result = LogManager::readData(this, a4, (uio *)a3);
      break;
    case 3:
      result = LogManager::writeData(this, a4, (uio *)a3);
      break;
    case 7:
      result = LogManager::registerClient(this, a4);
      break;
    case 8:
      result = LogManager::deregisterClient(this, a4, 0xFFFFFFFFLL);
      break;
    case 9:
      LOBYTE(result) = LogManager::writeRoomAvailable(this);
LABEL_8:
      result = (unsigned __int8)result;
      break;
    default:
      return result;
  }
  return result;
}

//----- (000000000000843C) ----------------------------------------------------
void __fastcall LogManagerDevice::dataReadyCallback(LogManagerDevice *this, void *a2, unsigned __int8 a3)
{
  IOCharacterDevice *v3; // rdi@1

  v3 = (IOCharacterDevice *)*((_QWORD *)this + 12);
  if ( v3 )
    IOCharacterDevice::dataReady(v3, a2, a3);
}

//----- (0000000000008454) ----------------------------------------------------
void __fastcall LogManagerDevice::free(LogManagerDevice *this)
{
  LogManagerDevice *v1; // rbx@1
  __int64 v2; // rdi@1

  v1 = this;
  v2 = *((_QWORD *)this + 12);
  if ( v2 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
    *((_QWORD *)v1 + 12) = 0LL;
  }
  JUMPOUT(__CS__, `vtable for'LogManager[20]);
}
// 7BCA0: using guessed type __int64 `vtable for'LogManager[2];

//----- (000000000000848A) ----------------------------------------------------
__int64 __fastcall LogManagerDevice::getDataSourceLock(LogManagerDevice *this)
{
  return *((_QWORD *)this + 13);
}

//----- (0000000000008494) ----------------------------------------------------
void __fastcall LogManagerDevice::willRelease(LogManagerDevice *this)
{
  IOCharacterDevice::willRelease(*((IOCharacterDevice **)this + 12));
}

//----- (00000000000084A2) ----------------------------------------------------
__int64 __fastcall LogManagerDevice::MetaClass::~MetaClass(LogManagerDevice::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000084B0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_1()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&LogManagerDevice::gMetaClass, "LogManagerDevice", &LogManager::gMetaClass, 112LL);
  result = (__int64)off_7B980;
  LogManagerDevice::gMetaClass = off_7B980;
  return result;
}
// 7B980: using guessed type __int64 (__fastcall *off_7B980[2])(LogManagerDevice::MetaClass *__hidden this);
// 84340: using guessed type _QWORD LogManagerDevice::gMetaClass;
// 84390: using guessed type _QWORD LogManager::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000084F0) ----------------------------------------------------
__int64 `global destructor keyed to'_a_1()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&LogManagerDevice::gMetaClass);
}
// 84340: using guessed type _QWORD LogManagerDevice::gMetaClass;

//----- (0000000000008501) ----------------------------------------------------
__int64 __fastcall cdev_init(const char *a1, __int64 a2, int a3, int a4, __int64 a5, __int64 a6)
{
  __int64 v6; // r13@1
  __int64 v7; // r14@1
  size_t v8; // rbx@1
  signed int v9; // er15@1
  __int64 v10; // rdi@3
  __int64 v11; // rax@4
  int v12; // er14@6
  void *v13; // r13@9
  char *v14; // r12@9
  int v15; // ebx@10
  int v16; // er14@11
  void *v17; // rax@12
  char *v18; // rax@15
  char *v19; // r14@15
  int v20; // er12@16
  void *v21; // rax@16
  __int64 v22; // rbx@16
  __int64 v23; // rax@17
  __int64 v25; // [sp+10h] [bp-60h]@8
  __int64 v26; // [sp+20h] [bp-50h]@5
  size_t v27; // [sp+28h] [bp-48h]@5
  int perms; // [sp+30h] [bp-40h]@1
  void *permsa; // [sp+30h] [bp-40h]@15
  int v30; // [sp+3Ch] [bp-34h]@1
  char *v31; // [sp+40h] [bp-30h]@1

  v6 = a6;
  v7 = a5;
  perms = a4;
  v30 = a3;
  v31 = (char *)a1;
  v8 = strlen(a1);
  v9 = 22;
  if ( v8 > 0x400 )
    return (unsigned int)v9;
  if ( !v7 )
    return (unsigned int)v9;
  v10 = _dev_node_lock;
  if ( !_dev_node_lock )
  {
    LODWORD(v11) = IOLockAlloc(_dev_node_lock);
    v10 = v11;
    _dev_node_lock = v11;
    v9 = 12;
    if ( !v11 )
      return (unsigned int)v9;
  }
  v26 = v7;
  v27 = v8;
  if ( IOLockTryLock(v10) )
  {
    v12 = _maj;
  }
  else
  {
    OSIncrementAtomic(&_dev_node_lock_waiters);
    IOLockLock(_dev_node_lock);
    OSDecrementAtomic(&_dev_node_lock_waiters);
    v12 = _maj;
    if ( _maj == -1 )
    {
      IOLockUnlock(_dev_node_lock);
      thread_wakeup_prim(&_dev_node_lock_waiters, 1LL, 0LL);
      v9 = 6;
      return (unsigned int)v9;
    }
  }
  v25 = v6;
  if ( v12 < 0 )
  {
    v12 = cdevsw_add(0xFFFFFFFFLL, _cdevsw);
    _maj = v12;
    v9 = 6;
    v13 = 0LL;
    v14 = 0LL;
    if ( v12 < 0 )
      goto LABEL_23;
  }
  v15 = _get_free_min();
  v9 = 16;
  v13 = 0LL;
  v14 = 0LL;
  if ( v15 < 0 )
    goto LABEL_23;
  v16 = v15 | (v12 << 24);
  v17 = BYTE1(v30) & 4 ? devfs_make_node_clone(v16, 0, 0, 0, perms, (int (__cdecl *)(dev_t, int))_dev_clone, "%s", v31) : devfs_make_node(v16, 0, 0, 0, perms, "%s", v31);
  v9 = 6;
  v13 = 0LL;
  v14 = 0LL;
  if ( !v17 )
    goto LABEL_23;
  permsa = v17;
  LODWORD(v18) = IOMalloc(v27 + 1);
  v19 = v18;
  v9 = 12;
  v14 = 0LL;
  if ( !v18 )
  {
    v13 = permsa;
    goto LABEL_23;
  }
  v20 = v15;
  strncpy(v18, v31, v27 + 1);
  LODWORD(v21) = IOMalloc(88LL);
  v22 = (__int64)v21;
  if ( !v21 )
  {
    v13 = permsa;
    v14 = v19;
LABEL_23:
    if ( !_node_head )
    {
      IOLockFree(_dev_node_lock);
      _dev_node_lock = 0LL;
      if ( _maj >= 0 )
      {
        cdevsw_remove((unsigned int)_maj, _cdevsw);
        _maj = -1;
      }
    }
    if ( v13 )
      devfs_remove(v13);
    if ( v14 )
      IOFree(v14, v27 + 1);
    goto LABEL_30;
  }
  bzero(v21, 0x58uLL);
  *(_DWORD *)(v22 + 16) = v20;
  *(_QWORD *)(v22 + 24) = permsa;
  *(_QWORD *)(v22 + 32) = v19;
  *(_DWORD *)(v22 + 40) = v30;
  *(_DWORD *)(v22 + 80) = -1;
  *(_QWORD *)(v22 + 48) = v26;
  *(_QWORD *)(v22 + 56) = v25;
  v23 = _node_head;
  *(_QWORD *)v22 = _node_head;
  if ( v23 )
    *(_QWORD *)(v23 + 8) = v22;
  _node_head = v22;
  *(_QWORD *)(v22 + 8) = &_node_head;
  *(_DWORD *)a2 = v20;
  v9 = 0;
LABEL_30:
  if ( _dev_node_lock )
    IOLockUnlock(_dev_node_lock);
  return (unsigned int)v9;
}
// 832B0: using guessed type int _maj;
// 832B8: using guessed type __int64 (__fastcall *_cdevsw[5])();
// 84E20: using guessed type __int64 _dev_node_lock;
// 84E28: using guessed type int _dev_node_lock_waiters;
// 84E30: using guessed type __int64 _node_head;
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C76F0: using guessed type int __cdecl IOLockAlloc(_QWORD);
// C76F8: using guessed type int __fastcall IOLockFree(_QWORD);
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7718: using guessed type int __cdecl IOLockTryLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// C77C8: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C8A18: using guessed type int __fastcall cdevsw_add(_QWORD, _QWORD);
// C8A20: using guessed type int __fastcall cdevsw_remove(_QWORD, _QWORD);
// C8DD8: using guessed type int __fastcall thread_wakeup_prim(_QWORD, _QWORD, _QWORD);

//----- (0000000000008815) ----------------------------------------------------
__int64 __fastcall _dev_clone(dev_t dev, int action)
{
  signed int v2; // er14@1
  int v3; // ebx@5
  __int64 v4; // rax@5
  __int64 v5; // rdi@6
  __int64 v6; // rbx@12
  signed int v7; // eax@13

  v2 = 6;
  if ( _dev_node_lock )
  {
    if ( IOLockTryLock(_dev_node_lock)
      || (OSIncrementAtomic(&_dev_node_lock_waiters),
          IOLockLock(_dev_node_lock),
          OSDecrementAtomic(&_dev_node_lock_waiters),
          _maj != -1) )
    {
      v2 = -1;
      if ( action )
      {
        if ( action == 1 )
        {
          v6 = _get_dev_node(dev & 0xFFFFFF, 0);
          if ( v6 )
          {
            v7 = _get_free_min();
            if ( v7 >= 0 )
            {
              *(_DWORD *)(v6 + 80) = v7;
              v2 = v7;
            }
          }
        }
      }
      else
      {
        v3 = dev & 0xFFFFFF;
        v4 = _clone_head;
        while ( 1 )
        {
          v5 = v4;
          if ( !v4 )
            break;
          v4 = *(_QWORD *)v4;
          if ( *(_DWORD *)(v5 + 16) == v3 )
          {
            if ( v4 )
              *(_QWORD *)(v4 + 8) = *(_QWORD *)(v5 + 8);
            **(_QWORD **)(v5 + 8) = v4;
            IOFree(v5, 88LL);
            v2 = 0;
            break;
          }
        }
      }
      if ( _dev_node_lock )
        IOLockUnlock(_dev_node_lock);
    }
    else
    {
      IOLockUnlock(_dev_node_lock);
      thread_wakeup_prim(&_dev_node_lock_waiters, 1LL, 0LL);
    }
  }
  return (unsigned int)v2;
}
// 832B0: using guessed type int _maj;
// 84E20: using guessed type __int64 _dev_node_lock;
// 84E28: using guessed type int _dev_node_lock_waiters;
// 84E38: using guessed type __int64 _clone_head;
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7718: using guessed type int __cdecl IOLockTryLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C77C8: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C8DD8: using guessed type int __fastcall thread_wakeup_prim(_QWORD, _QWORD, _QWORD);

//----- (0000000000008929) ----------------------------------------------------
__int64 __fastcall cdev_free(int a1)
{
  signed int v1; // er14@1
  __int64 v2; // rax@5
  __int64 v3; // r15@5
  __int64 v4; // rbx@6
  __int64 v5; // r12@7
  __int64 v6; // rsi@12
  __int64 v7; // rax@15
  __int64 v8; // rsi@19
  __int64 v9; // rbx@20
  size_t v10; // rax@20
  __int64 i; // rdi@23

  v1 = 22;
  if ( _node_head )
  {
    v1 = 6;
    if ( _dev_node_lock )
    {
      if ( IOLockTryLock(_dev_node_lock)
        || (OSIncrementAtomic(&_dev_node_lock_waiters),
            IOLockLock(_dev_node_lock),
            OSDecrementAtomic(&_dev_node_lock_waiters),
            _maj != -1) )
      {
        v1 = 0;
        v2 = _get_dev_node(a1, 0);
        v3 = v2;
        if ( !v2 )
          goto LABEL_30;
        devfs_remove(*(void **)(v2 + 24));
        v4 = _clone_head;
        if ( _clone_head )
        {
          do
          {
            v5 = *(_QWORD *)v4;
            if ( *(_QWORD *)(v4 + 72) == v3 )
            {
              if ( v5 )
                *(_QWORD *)(v5 + 8) = *(_QWORD *)(v4 + 8);
              **(_QWORD **)(v4 + 8) = v5;
              while ( 1 )
              {
                v6 = *(_QWORD *)(v4 + 64);
                if ( !v6 )
                  break;
                _remove_client(v4, v6);
              }
              IOFree(v4, 88LL);
            }
            v4 = v5;
          }
          while ( v5 );
        }
        v7 = *(_QWORD *)v3;
        if ( *(_QWORD *)v3 )
          *(_QWORD *)(v7 + 8) = *(_QWORD *)(v3 + 8);
        **(_QWORD **)(v3 + 8) = v7;
        while ( 1 )
        {
          v8 = *(_QWORD *)(v3 + 64);
          if ( !v8 )
            break;
          _remove_client(v3, v8);
        }
        v9 = *(_QWORD *)(v3 + 32);
        v10 = strlen(*(const char **)(v3 + 32));
        IOFree(v9, v10 + 1);
        IOFree(v3, 88LL);
        if ( !_node_head )
        {
          cdevsw_remove((unsigned int)_maj, _cdevsw);
          _maj = -1;
          for ( i = _dev_node_lock; _dev_node_lock_waiters; i = _dev_node_lock )
            IOLockSleep_darwin14(i, &_dev_node_lock_waiters, 0LL);
          IOLockFree(i);
          _dev_node_lock = 0LL;
          v1 = 0;
        }
        else
        {
LABEL_30:
          if ( _dev_node_lock )
            IOLockUnlock(_dev_node_lock);
        }
      }
      else
      {
        IOLockUnlock(_dev_node_lock);
        thread_wakeup_prim(&_dev_node_lock_waiters, 1LL, 0LL);
      }
    }
  }
  return (unsigned int)v1;
}
// 832B0: using guessed type int _maj;
// 832B8: using guessed type __int64 (__fastcall *_cdevsw[5])();
// 84E20: using guessed type __int64 _dev_node_lock;
// 84E28: using guessed type int _dev_node_lock_waiters;
// 84E30: using guessed type __int64 _node_head;
// 84E38: using guessed type __int64 _clone_head;
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C76F8: using guessed type int __fastcall IOLockFree(_QWORD);
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7710: using guessed type int __fastcall IOLockSleep_darwin14(_QWORD, _QWORD, _QWORD);
// C7718: using guessed type int __cdecl IOLockTryLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C77C8: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C8A20: using guessed type int __fastcall cdevsw_remove(_QWORD, _QWORD);
// C8DD8: using guessed type int __fastcall thread_wakeup_prim(_QWORD, _QWORD, _QWORD);

//----- (0000000000008B0C) ----------------------------------------------------
__int64 __fastcall _get_dev_node(int a1, int a2)
{
  __int64 result; // rax@1
  __int64 v3; // rbx@1
  __int64 v4; // rax@8
  __int64 v5; // r14@8
  __int64 v6; // rax@9
  __int64 v7; // rcx@13

  result = _node_head;
  v3 = 0LL;
  if ( _node_head )
  {
    while ( *(_DWORD *)(result + 16) != a1 )
    {
      if ( *(_DWORD *)(result + 80) == a1 )
        v3 = result;
      result = *(_QWORD *)result;
      if ( !result )
      {
        if ( !v3 || !a2 )
          goto LABEL_12;
        LODWORD(v4) = IOMalloc(88LL);
        v5 = v4;
        result = 0LL;
        if ( v5 )
        {
          bzero((void *)v5, 0x58uLL);
          *(_DWORD *)(v5 + 16) = a1;
          *(_QWORD *)(v5 + 72) = v3;
          *(_QWORD *)(v5 + 48) = *(_QWORD *)(v3 + 48);
          *(_QWORD *)(v5 + 56) = *(_QWORD *)(v3 + 56);
          *(_DWORD *)(v5 + 40) = *(_DWORD *)(v3 + 40);
          v6 = _clone_head;
          *(_QWORD *)v5 = _clone_head;
          if ( v6 )
            *(_QWORD *)(v6 + 8) = v5;
          _clone_head = v5;
          *(_QWORD *)(v5 + 8) = &_clone_head;
          *(_DWORD *)(v3 + 80) = -1;
          result = v5;
        }
        return result;
      }
    }
  }
  else
  {
LABEL_12:
    result = 0LL;
    if ( !a2 )
    {
      v7 = _clone_head;
      result = 0LL;
      if ( _clone_head )
      {
        result = 0LL;
        while ( *(_DWORD *)(v7 + 16) != a1 )
        {
          v7 = *(_QWORD *)v7;
          if ( !v7 )
            return result;
        }
        result = v7;
      }
    }
  }
  return result;
}
// 84E30: using guessed type __int64 _node_head;
// 84E38: using guessed type __int64 _clone_head;
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (0000000000008BF7) ----------------------------------------------------
__int64 __fastcall _remove_client(__int64 a1, __int64 a2)
{
  signed int v2; // er15@4
  __int64 v3; // rax@7

  if ( *(_DWORD *)(a2 + 20) != 1 )
  {
LABEL_7:
    v3 = *(_QWORD *)a2;
    if ( *(_QWORD *)a2 )
      *(_QWORD *)(v3 + 8) = *(_QWORD *)(a2 + 8);
    **(_QWORD **)(a2 + 8) = v3;
    selthreadclear(a2 + 24);
    selthreadclear(a2 + 72);
    if ( *(_BYTE *)(a2 + 120) & 1 )
    {
      (*(void (__fastcall **)(_QWORD, signed __int64, _QWORD, __int64))(a1 + 48))(*(_QWORD *)(a1 + 56), 8LL, 0LL, a2);
      if ( (*(int (__fastcall **)(_QWORD, signed __int64, _QWORD, __int64))(a1 + 48))(
             *(_QWORD *)(a1 + 56),
             9LL,
             0LL,
             a2) )
        _wake_write_sleepers(a1);
    }
    IOFree(a2, 128LL);
    v2 = 0;
    return (unsigned int)v2;
  }
  assert_wait(a2, 0LL);
  *(_DWORD *)(a2 + 20) = 2;
  if ( _dev_node_lock )
    IOLockUnlock(_dev_node_lock);
  thread_wakeup_prim(a2, 0LL, 0LL);
  thread_block(0LL);
  v2 = 6;
  if ( _dev_node_lock )
  {
    if ( !IOLockTryLock(_dev_node_lock) )
    {
      OSIncrementAtomic(&_dev_node_lock_waiters);
      IOLockLock(_dev_node_lock);
      OSDecrementAtomic(&_dev_node_lock_waiters);
      if ( _maj == -1 )
      {
        IOLockUnlock(_dev_node_lock);
        thread_wakeup_prim(&_dev_node_lock_waiters, 1LL, 0LL);
        return (unsigned int)v2;
      }
    }
    goto LABEL_7;
  }
  return (unsigned int)v2;
}
// 832B0: using guessed type int _maj;
// 84E20: using guessed type __int64 _dev_node_lock;
// 84E28: using guessed type int _dev_node_lock_waiters;
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7718: using guessed type int __cdecl IOLockTryLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C77C8: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C89C0: using guessed type int __fastcall assert_wait(_QWORD, _QWORD);
// C8D50: using guessed type int __fastcall selthreadclear(_QWORD);
// C8DA8: using guessed type int __fastcall thread_block(_QWORD);
// C8DD8: using guessed type int __fastcall thread_wakeup_prim(_QWORD, _QWORD, _QWORD);

//----- (0000000000008D2E) ----------------------------------------------------
void __fastcall cdev_data_ready(__int64 a1, int a2)
{
  if ( a1 && _dev_node_lock && (!a2 || IOLockTryLock(_dev_node_lock)) )
  {
    if ( *(_DWORD *)(a1 + 20) == 1 )
      thread_wakeup_prim(a1, 1LL, 0LL);
    else
      selwakeup(a1 + 24);
    if ( a2 )
    {
      if ( _dev_node_lock )
        IOLockUnlock(_dev_node_lock);
    }
  }
}
// 84E20: using guessed type __int64 _dev_node_lock;
// C7718: using guessed type int __cdecl IOLockTryLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C8D58: using guessed type int __fastcall selwakeup(_QWORD);
// C8DD8: using guessed type int __fastcall thread_wakeup_prim(_QWORD, _QWORD, _QWORD);

//----- (0000000000008D9C) ----------------------------------------------------
int __fastcall _wake_write_sleepers(__int64 a1)
{
  __int64 v1; // rax@1
  __int64 v2; // r15@2
  __int64 i; // rbx@6
  __int64 j; // rbx@11

  v1 = *(_QWORD *)(a1 + 72);
  if ( v1 )
  {
    v2 = _clone_head;
    if ( _clone_head )
    {
      while ( 1 )
      {
        if ( *(_QWORD *)(v2 + 72) == v1 )
        {
          for ( i = *(_QWORD *)(v2 + 64); i; i = *(_QWORD *)i )
            LODWORD(v1) = selwakeup(i + 72);
        }
        v2 = *(_QWORD *)v2;
        if ( !v2 )
          break;
        v1 = *(_QWORD *)(a1 + 72);
      }
    }
  }
  else
  {
    for ( j = *(_QWORD *)(a1 + 64); j; j = *(_QWORD *)j )
      LODWORD(v1) = selwakeup(j + 72);
  }
  return v1;
}
// 84E38: using guessed type __int64 _clone_head;
// C8D58: using guessed type int __fastcall selwakeup(_QWORD);

//----- (0000000000008E0D) ----------------------------------------------------
signed __int64 _get_free_min()
{
  signed int v0; // ecx@1
  __int64 v1; // rsi@2
  __int64 v2; // rsi@6
  signed __int64 result; // rax@11

  v0 = 0;
  do
  {
    v1 = _node_head;
    if ( _node_head )
    {
      while ( v0 != *(_DWORD *)(v1 + 16) && v0 != *(_DWORD *)(v1 + 80) )
      {
        v1 = *(_QWORD *)v1;
        if ( !v1 )
          goto LABEL_6;
      }
    }
    else
    {
LABEL_6:
      v2 = _clone_head;
      if ( !_clone_head )
        break;
      while ( v0 != *(_DWORD *)(v2 + 16) )
      {
        v2 = *(_QWORD *)v2;
        if ( !v2 )
          goto LABEL_11;
      }
    }
    ++v0;
  }
  while ( v0 < 0x1000000 );
LABEL_11:
  result = 0xFFFFFFFFLL;
  if ( v0 <= 0xFFFFFF )
    result = (unsigned int)v0;
  return result;
}
// 84E30: using guessed type __int64 _node_head;
// 84E38: using guessed type __int64 _clone_head;

//----- (0000000000008E6C) ----------------------------------------------------
__int64 __fastcall cdev_open(int a1, int a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r12@1
  int v5; // er15@1
  signed int v6; // ebx@1
  __int64 v7; // r15@4
  int v8; // er12@5
  __int64 i; // rax@5
  void *v10; // rax@10
  void *v11; // r13@10
  signed __int64 v12; // rbx@11
  __int64 v13; // rax@11

  v4 = a4;
  v5 = a1;
  v6 = 6;
  if ( _dev_node_lock )
  {
    if ( IOLockTryLock(_dev_node_lock)
      || (OSIncrementAtomic(&_dev_node_lock_waiters),
          IOLockLock(_dev_node_lock),
          OSDecrementAtomic(&_dev_node_lock_waiters),
          _maj != -1) )
    {
      v7 = _get_dev_node(v5 & 0xFFFFFF, 1);
      v6 = 22;
      if ( v7 )
      {
        v8 = proc_pid(v4, 1LL);
        for ( i = *(_QWORD *)(v7 + 64); i; i = *(_QWORD *)i )
        {
          v6 = 16;
          if ( *(_DWORD *)(i + 16) == v8 )
            goto LABEL_15;
        }
        LODWORD(v10) = IOMalloc(128LL);
        v11 = v10;
        v6 = 12;
        if ( v10 )
        {
          v12 = v7 + 64;
          bzero(v10, 0x80uLL);
          *((_DWORD *)v11 + 4) = v8;
          *((_DWORD *)v11 + 30) = a2;
          v13 = *(_QWORD *)(v7 + 64);
          *(_QWORD *)v11 = *(_QWORD *)(v7 + 64);
          if ( v13 )
            *(_QWORD *)(v13 + 8) = v11;
          *(_QWORD *)v12 = v11;
          *((_QWORD *)v11 + 1) = v12;
          v6 = 0;
          if ( a2 & 1 )
          {
            v6 = 0;
            (*(void (__fastcall **)(_QWORD, signed __int64, _QWORD, void *))(v7 + 48))(
              *(_QWORD *)(v7 + 56),
              7LL,
              0LL,
              v11);
          }
        }
      }
LABEL_15:
      if ( _dev_node_lock )
        IOLockUnlock(_dev_node_lock);
    }
    else
    {
      IOLockUnlock(_dev_node_lock);
      thread_wakeup_prim(&_dev_node_lock_waiters, 1LL, 0LL);
    }
  }
  return (unsigned int)v6;
}
// 832B0: using guessed type int _maj;
// 84E20: using guessed type __int64 _dev_node_lock;
// 84E28: using guessed type int _dev_node_lock_waiters;
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7718: using guessed type int __cdecl IOLockTryLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// C77C8: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C8D00: using guessed type int __fastcall proc_pid(_QWORD, _QWORD);
// C8DD8: using guessed type int __fastcall thread_wakeup_prim(_QWORD, _QWORD, _QWORD);

//----- (0000000000008FC2) ----------------------------------------------------
__int64 __fastcall cdev_close(int a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r15@1
  int v5; // ebx@1
  signed int v6; // er14@1
  __int64 v7; // rbx@4
  int v8; // eax@5
  __int64 v9; // rdx@5
  __int64 v10; // rcx@5
  __int64 v11; // r8@5
  __int64 v12; // r9@5
  __int64 v13; // rsi@5
  __int64 v14; // rax@15

  v4 = a4;
  v5 = a1;
  v6 = 6;
  if ( _dev_node_lock )
  {
    if ( IOLockTryLock(_dev_node_lock)
      || (OSIncrementAtomic(&_dev_node_lock_waiters),
          IOLockLock(_dev_node_lock),
          OSDecrementAtomic(&_dev_node_lock_waiters),
          _maj != -1) )
    {
      v7 = _get_dev_node(v5 & 0xFFFFFF, 0);
      v6 = 22;
      if ( v7 )
      {
        v8 = proc_pid(v4, 0LL);
        v13 = *(_QWORD *)(v7 + 64);
        v6 = 22;
        while ( v13 )
        {
          if ( *(_DWORD *)(v13 + 16) == v8 )
          {
            v6 = _remove_client(v7, v13);
            break;
          }
          v13 = *(_QWORD *)v13;
        }
        if ( *(_BYTE *)(v7 + 41) & 4 && *(_QWORD *)(v7 + 72) )
        {
          if ( *(_QWORD *)(v7 + 64) )
          {
            IOLog("cdev_close: node still has clients!\n", v13, v9, v10, v11, v12);
          }
          else
          {
            v14 = *(_QWORD *)v7;
            if ( *(_QWORD *)v7 )
              *(_QWORD *)(v14 + 8) = *(_QWORD *)(v7 + 8);
            **(_QWORD **)(v7 + 8) = v14;
            IOFree(v7, 88LL);
          }
        }
      }
      if ( _dev_node_lock )
        IOLockUnlock(_dev_node_lock);
    }
    else
    {
      IOLockUnlock(_dev_node_lock);
      thread_wakeup_prim(&_dev_node_lock_waiters, 1LL, 0LL);
    }
  }
  return (unsigned int)v6;
}
// 832B0: using guessed type int _maj;
// 84E20: using guessed type __int64 _dev_node_lock;
// 84E28: using guessed type int _dev_node_lock_waiters;
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7718: using guessed type int __cdecl IOLockTryLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C77C8: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C8D00: using guessed type int __fastcall proc_pid(_QWORD, _QWORD);
// C8DD8: using guessed type int __fastcall thread_wakeup_prim(_QWORD, _QWORD, _QWORD);

//----- (00000000000090F0) ----------------------------------------------------
__int64 __fastcall cdev_read(int a1, __int64 a2, char a3)
{
  char v3; // r13@1
  signed int v4; // er12@1
  __int64 v5; // rax@4
  __int64 v6; // r15@4
  int v7; // eax@6
  __int64 v8; // rbx@6
  int v9; // er14@6
  int v10; // er14@14
  __int64 v11; // rdi@21

  v3 = a3;
  v4 = 6;
  if ( !_dev_node_lock )
    return (unsigned int)v4;
  if ( !IOLockTryLock(_dev_node_lock) )
  {
    OSIncrementAtomic(&_dev_node_lock_waiters);
    IOLockLock(_dev_node_lock);
    OSDecrementAtomic(&_dev_node_lock_waiters);
    if ( _maj == -1 )
    {
LABEL_25:
      IOLockUnlock(_dev_node_lock);
      thread_wakeup_prim(&_dev_node_lock_waiters, 1LL, 0LL);
      return (unsigned int)v4;
    }
  }
  v5 = _get_dev_node(a1 & 0xFFFFFF, 0);
  v6 = v5;
  if ( !v5 )
  {
    v11 = _dev_node_lock;
    v4 = 5;
    goto LABEL_23;
  }
  if ( !(*(_BYTE *)(v5 + 40) & 1) )
  {
    v11 = _dev_node_lock;
    v4 = 102;
LABEL_23:
    if ( v11 )
      IOLockUnlock(v11);
    return (unsigned int)v4;
  }
  v7 = proc_selfpid(a1 & 0xFFFFFF, 0LL);
  v8 = *(_QWORD *)(v6 + 64);
  v9 = 22;
  while ( 1 )
  {
    if ( !v8 )
      goto LABEL_32;
    if ( *(_DWORD *)(v8 + 16) == v7 )
      break;
    v8 = *(_QWORD *)v8;
  }
  if ( (*(int (__fastcall **)(_QWORD, signed __int64, _QWORD, _QWORD))(v6 + 48))(*(_QWORD *)(v6 + 56), 1LL, 0LL, v8) )
  {
LABEL_29:
    v9 = (*(int (__fastcall **)(_QWORD, signed __int64, __int64, __int64))(v6 + 48))(*(_QWORD *)(v6 + 56), 2LL, a2, v8);
    if ( !v9 )
    {
      v9 = 0;
      if ( (*(int (__fastcall **)(_QWORD, signed __int64, _QWORD, __int64))(v6 + 48))(
             *(_QWORD *)(v6 + 56),
             9LL,
             0LL,
             v8) )
        _wake_write_sleepers(v6);
    }
    goto LABEL_32;
  }
  v9 = 35;
  if ( v3 & 0x10 )
  {
LABEL_32:
    if ( _dev_node_lock )
      IOLockUnlock(_dev_node_lock);
    v4 = v9;
    return (unsigned int)v4;
  }
  assert_wait(v8, 1LL);
  *(_DWORD *)(v8 + 20) = 1;
  if ( _dev_node_lock )
    IOLockUnlock(_dev_node_lock);
  v10 = thread_block(0LL);
  if ( _dev_node_lock )
  {
    if ( !IOLockTryLock(_dev_node_lock) )
    {
      OSIncrementAtomic(&_dev_node_lock_waiters);
      IOLockLock(_dev_node_lock);
      OSDecrementAtomic(&_dev_node_lock_waiters);
      if ( _maj == -1 )
        goto LABEL_25;
    }
    if ( *(_DWORD *)(v8 + 20) == 2 )
    {
      if ( _dev_node_lock )
        IOLockUnlock(_dev_node_lock);
      thread_wakeup_prim(v8 + 20, 0LL, 0LL);
      return (unsigned int)v4;
    }
    *(_DWORD *)(v8 + 20) = 0;
    if ( v10 )
    {
      v11 = _dev_node_lock;
      v4 = 4;
      goto LABEL_23;
    }
    v9 = 5;
    if ( !(*(int (__fastcall **)(_QWORD, signed __int64, _QWORD, _QWORD))(v6 + 48))(*(_QWORD *)(v6 + 56), 1LL, 0LL, v8) )
      goto LABEL_32;
    goto LABEL_29;
  }
  return (unsigned int)v4;
}
// 832B0: using guessed type int _maj;
// 84E20: using guessed type __int64 _dev_node_lock;
// 84E28: using guessed type int _dev_node_lock_waiters;
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7718: using guessed type int __cdecl IOLockTryLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C77C8: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C89C0: using guessed type int __fastcall assert_wait(_QWORD, _QWORD);
// C8D20: using guessed type int __fastcall proc_selfpid(_QWORD, _QWORD);
// C8DA8: using guessed type int __fastcall thread_block(_QWORD);
// C8DD8: using guessed type int __fastcall thread_wakeup_prim(_QWORD, _QWORD, _QWORD);

//----- (000000000000935A) ----------------------------------------------------
__int64 __fastcall cdev_write(int a1, __int64 a2)
{
  int v2; // er15@1
  __int64 v3; // rdi@4
  __int64 v4; // rax@4
  __int64 v5; // rbx@4
  int v6; // eax@6
  __int64 v7; // rcx@6
  __int64 v8; // rdi@11

  v2 = 6;
  if ( _dev_node_lock )
  {
    if ( IOLockTryLock(_dev_node_lock)
      || (OSIncrementAtomic(&_dev_node_lock_waiters),
          IOLockLock(_dev_node_lock),
          OSDecrementAtomic(&_dev_node_lock_waiters),
          _maj != -1) )
    {
      v3 = a1 & 0xFFFFFF;
      v4 = _get_dev_node(v3, 0);
      v5 = v4;
      if ( v4 )
      {
        if ( *(_BYTE *)(v4 + 40) & 2 )
        {
          v6 = proc_selfpid(v3, 0LL);
          v7 = *(_QWORD *)(v5 + 64);
          v2 = 22;
          while ( v7 )
          {
            if ( *(_DWORD *)(v7 + 16) == v6 )
            {
              v2 = (*(int (__fastcall **)(_QWORD, signed __int64, __int64))(v5 + 48))(*(_QWORD *)(v5 + 56), 3LL, a2);
              break;
            }
            v7 = *(_QWORD *)v7;
          }
          v8 = _dev_node_lock;
        }
        else
        {
          v8 = _dev_node_lock;
          v2 = 102;
        }
      }
      else
      {
        v8 = _dev_node_lock;
        v2 = 5;
      }
      if ( v8 )
        IOLockUnlock(v8);
    }
    else
    {
      IOLockUnlock(_dev_node_lock);
      thread_wakeup_prim(&_dev_node_lock_waiters, 1LL, 0LL);
    }
  }
  return (unsigned int)v2;
}
// 832B0: using guessed type int _maj;
// 84E20: using guessed type __int64 _dev_node_lock;
// 84E28: using guessed type int _dev_node_lock_waiters;
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7718: using guessed type int __cdecl IOLockTryLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C77C8: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C8D20: using guessed type int __fastcall proc_selfpid(_QWORD, _QWORD);
// C8DD8: using guessed type int __fastcall thread_wakeup_prim(_QWORD, _QWORD, _QWORD);

//----- (000000000000945E) ----------------------------------------------------
__int64 __fastcall cdev_ioctl(int a1, __int64 a2, __int64 a3, int a4, __int64 a5)
{
  __int64 v5; // r13@1
  int v6; // er12@1
  __int64 v7; // rbx@4
  __int64 v8; // rdi@8
  int v10; // [sp+Ch] [bp-54h]@2
  __int64 v11; // [sp+10h] [bp-50h]@2
  __int64 v12; // [sp+18h] [bp-48h]@7
  __int64 v13; // [sp+20h] [bp-40h]@7
  int v14; // [sp+28h] [bp-38h]@7
  __int64 v15; // [sp+30h] [bp-30h]@7

  v5 = a3;
  v6 = 6;
  if ( _dev_node_lock )
  {
    v10 = a4;
    v11 = a5;
    if ( IOLockTryLock(_dev_node_lock)
      || (OSIncrementAtomic(&_dev_node_lock_waiters),
          IOLockLock(_dev_node_lock),
          OSDecrementAtomic(&_dev_node_lock_waiters),
          _maj != -1) )
    {
      v6 = 0;
      v7 = _get_dev_node(a1 & 0xFFFFFF, 0);
      if ( v7 )
      {
        if ( (unsigned __int64)(a2 - 2147772029LL) >= 2 )
        {
          v6 = 102;
          if ( *(_BYTE *)(v7 + 40) & 4 )
          {
            v12 = a2;
            v13 = v5;
            v14 = v10;
            v15 = v11;
            v6 = (*(int (__fastcall **)(_QWORD, _QWORD, __int64 *, _QWORD))(v7 + 48))(
                   *(_QWORD *)(v7 + 56),
                   (unsigned int)a2,
                   &v12,
                   0LL);
          }
        }
        v8 = _dev_node_lock;
      }
      else
      {
        v8 = _dev_node_lock;
        v6 = 22;
      }
      if ( v8 )
        IOLockUnlock(v8);
    }
    else
    {
      IOLockUnlock(_dev_node_lock);
      thread_wakeup_prim(&_dev_node_lock_waiters, 1LL, 0LL);
    }
  }
  return (unsigned int)v6;
}
// 832B0: using guessed type int _maj;
// 84E20: using guessed type __int64 _dev_node_lock;
// 84E28: using guessed type int _dev_node_lock_waiters;
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7718: using guessed type int __cdecl IOLockTryLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C77C8: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C8DD8: using guessed type int __fastcall thread_wakeup_prim(_QWORD, _QWORD, _QWORD);

//----- (0000000000009585) ----------------------------------------------------
__int64 __fastcall cdev_select(int a1, int a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r15@1
  signed int v5; // er13@1
  __int64 v6; // r14@4
  int v7; // eax@5
  __int64 i; // rbx@5
  signed __int64 v9; // rbx@11
  __int64 v11; // [sp+0h] [bp-30h]@2

  v4 = a4;
  v5 = 6;
  if ( _dev_node_lock )
  {
    v11 = a3;
    if ( IOLockTryLock(_dev_node_lock)
      || (OSIncrementAtomic(&_dev_node_lock_waiters),
          IOLockLock(_dev_node_lock),
          OSDecrementAtomic(&_dev_node_lock_waiters),
          _maj != -1) )
    {
      v5 = 0;
      v6 = _get_dev_node(a1 & 0xFFFFFF, 0);
      if ( v6 )
      {
        v7 = proc_pid(v4, 0LL);
        for ( i = *(_QWORD *)(v6 + 64); ; i = *(_QWORD *)i )
        {
          if ( !i )
            goto LABEL_17;
          if ( *(_DWORD *)(i + 16) == v7 )
            break;
        }
        if ( a2 == 2 )
        {
          v5 = 1;
          if ( (*(int (__fastcall **)(_QWORD, signed __int64, _QWORD, __int64))(v6 + 48))(
                 *(_QWORD *)(v6 + 56),
                 9LL,
                 0LL,
                 i) )
            goto LABEL_17;
          v9 = i + 72;
          goto LABEL_16;
        }
        if ( a2 == 1 )
        {
          v5 = 1;
          if ( !(*(int (__fastcall **)(_QWORD, signed __int64, _QWORD, __int64))(v6 + 48))(
                  *(_QWORD *)(v6 + 56),
                  1LL,
                  0LL,
                  i) )
          {
            v9 = i + 24;
LABEL_16:
            selrecord(v4, v9, v11);
            v5 = 0;
            goto LABEL_17;
          }
        }
      }
LABEL_17:
      if ( _dev_node_lock )
        IOLockUnlock(_dev_node_lock);
    }
    else
    {
      IOLockUnlock(_dev_node_lock);
      thread_wakeup_prim(&_dev_node_lock_waiters, 1LL, 0LL);
    }
  }
  return (unsigned int)v5;
}
// 832B0: using guessed type int _maj;
// 84E20: using guessed type __int64 _dev_node_lock;
// 84E28: using guessed type int _dev_node_lock_waiters;
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7718: using guessed type int __cdecl IOLockTryLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C77C8: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C8D00: using guessed type int __fastcall proc_pid(_QWORD, _QWORD);
// C8D48: using guessed type int __fastcall selrecord(_QWORD, _QWORD, _QWORD);
// C8DD8: using guessed type int __fastcall thread_wakeup_prim(_QWORD, _QWORD, _QWORD);

//----- (00000000000096CB) ----------------------------------------------------
__int64 __usercall cdev_getc@<rax>(__int64 a1@<rax>, int a2@<edi>)
{
  signed int v2; // er14@1
  __int64 v3; // rdi@4
  __int64 v4; // rax@4
  __int64 v5; // rbx@4
  int v6; // eax@6
  __int64 i; // rcx@6
  __int64 v8; // rdi@14
  __int64 v10; // [sp-4h] [bp-20h]@1

  v10 = a1;
  v2 = 6;
  if ( !_dev_node_lock )
    return (unsigned int)v2;
  if ( !IOLockTryLock(_dev_node_lock) )
  {
    OSIncrementAtomic(&_dev_node_lock_waiters);
    IOLockLock(_dev_node_lock);
    OSDecrementAtomic(&_dev_node_lock_waiters);
    if ( _maj == -1 )
    {
      IOLockUnlock(_dev_node_lock);
      thread_wakeup_prim(&_dev_node_lock_waiters, 1LL, 0LL);
      return (unsigned int)v2;
    }
  }
  v3 = a2 & 0xFFFFFF;
  v4 = _get_dev_node(v3, 0);
  v5 = v4;
  if ( !v4 )
  {
    v8 = _dev_node_lock;
    v2 = 5;
    goto LABEL_16;
  }
  if ( !(*(_BYTE *)(v4 + 41) & 1) )
  {
    v8 = _dev_node_lock;
    v2 = 102;
LABEL_16:
    if ( v8 )
      IOLockUnlock(v8);
    return (unsigned int)v2;
  }
  HIDWORD(v10) = 0;
  v6 = proc_selfpid(v3, 0LL);
  for ( i = *(_QWORD *)(v5 + 64); i; i = *(_QWORD *)i )
  {
    if ( *(_DWORD *)(i + 16) == v6 )
    {
      (*(void (__fastcall **)(_QWORD, signed __int64, char *))(v5 + 48))(*(_QWORD *)(v5 + 56), 5LL, (char *)&v10 + 4);
      break;
    }
  }
  if ( _dev_node_lock )
    IOLockUnlock(_dev_node_lock);
  v2 = HIDWORD(v10);
  return (unsigned int)v2;
}
// 832B0: using guessed type int _maj;
// 84E20: using guessed type __int64 _dev_node_lock;
// 84E28: using guessed type int _dev_node_lock_waiters;
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7718: using guessed type int __cdecl IOLockTryLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C77C8: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C8D20: using guessed type int __fastcall proc_selfpid(_QWORD, _QWORD);
// C8DD8: using guessed type int __fastcall thread_wakeup_prim(_QWORD, _QWORD, _QWORD);

//----- (00000000000097DE) ----------------------------------------------------
__int64 __usercall cdev_putc@<rax>(__int64 a1@<rax>, int a2@<edi>, char a3@<sil>)
{
  int v3; // er14@1
  __int64 v4; // rdi@4
  __int64 v5; // rax@4
  __int64 v6; // rbx@4
  int v7; // eax@6
  __int64 v8; // rcx@6
  __int64 v9; // rdi@11
  __int64 v11; // [sp-6h] [bp-20h]@1

  v11 = a1;
  BYTE7(v11) = a3;
  v3 = 6;
  if ( _dev_node_lock )
  {
    if ( IOLockTryLock(_dev_node_lock)
      || (OSIncrementAtomic(&_dev_node_lock_waiters),
          IOLockLock(_dev_node_lock),
          OSDecrementAtomic(&_dev_node_lock_waiters),
          _maj != -1) )
    {
      v4 = a2 & 0xFFFFFF;
      v5 = _get_dev_node(v4, 0);
      v6 = v5;
      if ( v5 )
      {
        if ( *(_BYTE *)(v5 + 41) & 2 )
        {
          v7 = proc_selfpid(v4, 0LL);
          v8 = *(_QWORD *)(v6 + 64);
          v3 = 22;
          while ( v8 )
          {
            if ( *(_DWORD *)(v8 + 16) == v7 )
            {
              v3 = (*(int (__fastcall **)(_QWORD, signed __int64, char *))(v6 + 48))(
                     *(_QWORD *)(v6 + 56),
                     6LL,
                     (char *)&v11 + 7);
              break;
            }
            v8 = *(_QWORD *)v8;
          }
          v9 = _dev_node_lock;
        }
        else
        {
          v9 = _dev_node_lock;
          v3 = 102;
        }
      }
      else
      {
        v9 = _dev_node_lock;
        v3 = 5;
      }
      if ( v9 )
        IOLockUnlock(v9);
    }
    else
    {
      IOLockUnlock(_dev_node_lock);
      thread_wakeup_prim(&_dev_node_lock_waiters, 1LL, 0LL);
    }
  }
  return (unsigned int)v3;
}
// 832B0: using guessed type int _maj;
// 84E20: using guessed type __int64 _dev_node_lock;
// 84E28: using guessed type int _dev_node_lock_waiters;
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7718: using guessed type int __cdecl IOLockTryLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C77C8: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C8D20: using guessed type int __fastcall proc_selfpid(_QWORD, _QWORD);
// C8DD8: using guessed type int __fastcall thread_wakeup_prim(_QWORD, _QWORD, _QWORD);

//----- (00000000000098F0) ----------------------------------------------------
__int64 __fastcall IO80211QueueCall::MetaClass::MetaClass(IO80211QueueCall::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211QueueCall", off_7B030[0], 48LL);
  result = (__int64)off_7BBB0;
  *(_QWORD *)this = off_7BBB0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 7BBB0: using guessed type __int64 (__fastcall *off_7BBB0[2])(IO80211QueueCall::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000009922) ----------------------------------------------------
__int64 __fastcall IO80211QueueCall::MetaClass::~MetaClass(IO80211QueueCall::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000992C) ----------------------------------------------------
__int64 __fastcall IO80211QueueCall::IO80211QueueCall(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_7BA80;
  *(_QWORD *)a1 = off_7BA80;
  return result;
}
// 7BA80: using guessed type __int64 (__fastcall *off_7BA80[2])(IO80211QueueCall *__hidden this);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000994C) ----------------------------------------------------
__int64 __fastcall IO80211QueueCall::IO80211QueueCall(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_7BA80;
  *(_QWORD *)a1 = off_7BA80;
  return result;
}
// 7BA80: using guessed type __int64 (__fastcall *off_7BA80[2])(IO80211QueueCall *__hidden this);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000996C) ----------------------------------------------------
__int64 __fastcall IO80211QueueCall::~IO80211QueueCall(IO80211QueueCall *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000009976) ----------------------------------------------------
__int64 __fastcall IO80211QueueCall::~IO80211QueueCall(IO80211QueueCall *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000009980) ----------------------------------------------------
void __fastcall IO80211QueueCall::~IO80211QueueCall(IO80211QueueCall *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (00000000000099A2) ----------------------------------------------------
__int64 __fastcall IO80211QueueCall::getMetaClass(IO80211QueueCall *this)
{
  return (__int64)&IO80211QueueCall::gMetaClass;
}
// 84368: using guessed type _QWORD IO80211QueueCall::gMetaClass;

//----- (00000000000099B0) ----------------------------------------------------
__int64 __fastcall IO80211QueueCall::MetaClass::MetaClass(IO80211QueueCall::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211QueueCall", off_7B030[0], 48LL);
  result = (__int64)off_7BBB0;
  *(_QWORD *)this = off_7BBB0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 7BBB0: using guessed type __int64 (__fastcall *off_7BBB0[2])(IO80211QueueCall::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000099E2) ----------------------------------------------------
__int64 __fastcall IO80211QueueCall::MetaClass::alloc(IO80211QueueCall::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20.segname[8], a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_7BA80;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211QueueCall::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 7BA80: using guessed type __int64 (__fastcall *off_7BA80[2])(IO80211QueueCall *__hidden this);
// 84368: using guessed type _QWORD IO80211QueueCall::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000009A22) ----------------------------------------------------
__int64 __fastcall IO80211QueueCall::IO80211QueueCall(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_7BA80;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211QueueCall::gMetaClass);
}
// 7BA80: using guessed type __int64 (__fastcall *off_7BA80[2])(IO80211QueueCall *__hidden this);
// 84368: using guessed type _QWORD IO80211QueueCall::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000009A52) ----------------------------------------------------
__int64 __fastcall IO80211QueueCall::IO80211QueueCall(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_7BA80;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211QueueCall::gMetaClass);
}
// 7BA80: using guessed type __int64 (__fastcall *off_7BA80[2])(IO80211QueueCall *__hidden this);
// 84368: using guessed type _QWORD IO80211QueueCall::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000009A82) ----------------------------------------------------
__int64 __fastcall IO80211QueueCall::io80211QueueCall(IO80211QueueCall *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = gQueueCall;
  if ( !gQueueCall )
  {
    v2 = OSObject::operator new((OSObject *)&stru_20.segname[8], a2);
    OSObject::OSObject(v2);
    *(_QWORD *)v2 = off_7BA80;
    OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211QueueCall::gMetaClass);
    if ( v2
      && !(unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v2 + 136LL))(
                             v2,
                             &IO80211QueueCall::gMetaClass) )
    {
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
      v2 = 0LL;
    }
    if ( !(unsigned __int8)OSCompareAndSwapPtr(0LL, v2, &gQueueCall) )
    {
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
      v2 = gQueueCall;
    }
  }
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 7BA80: using guessed type __int64 (__fastcall *off_7BA80[2])(IO80211QueueCall *__hidden this);
// 84368: using guessed type _QWORD IO80211QueueCall::gMetaClass;
// 84E40: using guessed type _QWORD gQueueCall;
// C77C0: using guessed type int __fastcall OSCompareAndSwapPtr(_QWORD, _QWORD, _QWORD);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000009B14) ----------------------------------------------------
char __fastcall IO80211QueueCall::init(IO80211QueueCall *this)
{
  __int64 v1; // rax@2
  __int64 v2; // rax@3
  char result; // al@4

  if ( (unsigned __int8)(*(int (__cdecl **)(IO80211QueueCall *))(off_7B068[0] + 152))(this)
    && (LODWORD(v1) = thread_call_allocate(IO80211QueueCall::handleQueue, this), (*((_QWORD *)this + 5) = v1) != 0LL)
    && (LODWORD(v2) = IOLockAlloc(IO80211QueueCall::handleQueue), (*((_QWORD *)this + 4) = v2) != 0LL) )
  {
    *((_QWORD *)this + 2) = (char *)this + 16;
    *((_QWORD *)this + 3) = (char *)this + 16;
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 7B068: using guessed type __int64 off_7B068[9];
// C76F0: using guessed type int __cdecl IOLockAlloc(_QWORD);
// C8DB0: using guessed type int __fastcall thread_call_allocate(_QWORD, _QWORD);

//----- (0000000000009B6E) ----------------------------------------------------
int __fastcall IO80211QueueCall::handleQueue(IO80211QueueCall *this, void *a2)
{
  char *v2; // r15@1
  __int64 v3; // rbx@3
  __int64 v4; // rax@4
  __int64 v5; // rax@7

  IOLockLock(*((_QWORD *)this + 4));
  v2 = (char *)this + 16;
  while ( 1 )
  {
    v3 = *((_QWORD *)this + 2);
    if ( v2 == (char *)v3 )
      break;
    v4 = *(_QWORD *)v3;
    if ( v2 == *(char **)v3 )
      *((_QWORD *)this + 3) = v2;
    else
      *(_QWORD *)(v4 + 8) = v2;
    *((_QWORD *)this + 2) = v4;
    *(_QWORD *)v3 = 0LL;
    *(_QWORD *)(v3 + 8) = 0LL;
    LODWORD(v5) = IOLockUnlock(*((_QWORD *)this + 4));
    if ( !v3 )
      return v5;
    IO80211QueueCall::handleEntry(v5, v3, (int)this);
    IOLockLock(*((_QWORD *)this + 4));
  }
  LODWORD(v5) = IOLockUnlock(*((_QWORD *)this + 4));
  return v5;
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);

//----- (0000000000009BF6) ----------------------------------------------------
int __fastcall IO80211QueueCall::free(IO80211QueueCall *this)
{
  IO80211QueueCall *v1; // r14@1
  __int64 i; // rsi@1
  __int64 v3; // rdi@1
  signed __int64 v4; // rbx@2
  __int64 v5; // rax@5
  __int64 v6; // rdi@9
  __int64 v7; // rdi@11

  v1 = this;
  i = 0LL;
  OSCompareAndSwapPtr(this, 0LL, &gQueueCall);
  v3 = *((_QWORD *)this + 4);
  if ( v3 )
  {
    IOLockLock(v3);
    v4 = (signed __int64)((char *)v1 + 16);
    for ( i = *((_QWORD *)v1 + 2); v4 != i; i = *(_QWORD *)v4 )
    {
      v5 = *(_QWORD *)i;
      if ( v4 == *(_QWORD *)i )
        *((_QWORD *)v1 + 3) = v4;
      else
        *(_QWORD *)(v5 + 8) = v4;
      *(_QWORD *)v4 = v5;
      *(_QWORD *)i = 0LL;
      *(_QWORD *)(i + 8) = 0LL;
      IO80211QueueCall::freeEntry(v3, i);
    }
    IOLockUnlock(*((_QWORD *)v1 + 4));
  }
  v6 = *((_QWORD *)v1 + 5);
  if ( v6 )
  {
    thread_call_cancel(v6, i);
    thread_call_free(*((_QWORD *)v1 + 5), i);
    *((_QWORD *)v1 + 5) = 0LL;
  }
  v7 = *((_QWORD *)v1 + 4);
  if ( v7 )
  {
    IOLockFree(v7);
    *((_QWORD *)v1 + 4) = 0LL;
  }
  return (*(int (__fastcall **)(IO80211QueueCall *, __int64))(off_7B068[0] + 160))(v1, i);
}
// 7B068: using guessed type __int64 off_7B068[9];
// 84E40: using guessed type _QWORD gQueueCall;
// C76F8: using guessed type int __fastcall IOLockFree(_QWORD);
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C77C0: using guessed type int __fastcall OSCompareAndSwapPtr(_QWORD, _QWORD, _QWORD);
// C8DB8: using guessed type int __fastcall thread_call_cancel(_QWORD, _QWORD);
// C8DD0: using guessed type int __fastcall thread_call_free(_QWORD, _QWORD);

//----- (0000000000009CAC) ----------------------------------------------------
int __fastcall IO80211QueueCall::freeEntry(__int64 a1, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 v3; // rsi@1
  signed __int64 v4; // rbx@1
  __int64 v5; // rdi@5
  int v6; // eax@6

  v2 = a2;
  v3 = *(_DWORD *)(a2 + 16);
  v4 = 48LL;
  if ( (unsigned int)(v3 - 1) <= 3 )
  {
    switch ( (_DWORD)v3 )
    {
      case 1:
      case 2:
        IOFree(*(_QWORD *)(v2 + 32), **(_BYTE **)(v2 + 32));
        break;
      case 4:
        do
        {
          v5 = *(_QWORD *)(v2 + v4);
          if ( v5 )
          {
            v6 = *(_DWORD *)(v2 + v4 - 8);
            if ( v6 )
              IOFree(v5, v6);
          }
          v4 += 16LL;
        }
        while ( v4 != 128 );
        break;
      case 3:
        return IOFree(v2, 120LL);
      default:
        goto LABEL_2;
    }
  }
  else
  {
LABEL_2:
    panic(
      "\"IO80211QueueCall::freeEntry - bogus entry, type %d, entry %p\"@/SourceCache/AirPortFamily_kexts/AirPortFamily-710.55/BaseClass/IO80211QueueCall.cpp:243",
      v3);
  }
  return IOFree(v2, 120LL);
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (0000000000009D40) ----------------------------------------------------
int __fastcall IO80211QueueCall::addEntryToQueueAndCall(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rax@1
  __int64 v3; // rcx@1

  IOLockLock(*(_QWORD *)(a1 + 32));
  v2 = a1 + 16;
  v3 = *(_QWORD *)(a1 + 24);
  if ( a1 + 16 == v3 )
    *(_QWORD *)v2 = a2;
  else
    *(_QWORD *)v3 = a2;
  *(_QWORD *)(a2 + 8) = v3;
  *(_QWORD *)a2 = v2;
  *(_QWORD *)(a1 + 24) = a2;
  IOLockUnlock(*(_QWORD *)(a1 + 32));
  return thread_call_enter(*(_QWORD *)(a1 + 40));
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C8DC0: using guessed type int __fastcall thread_call_enter(_QWORD);

//----- (0000000000009D8C) ----------------------------------------------------
int __usercall IO80211QueueCall::handleEntry@<eax>(__int64 a1@<rax>, __int64 a2@<rsi>, int a3@<r14d>)
{
  __int64 v3; // rbx@1
  __int64 v4; // rsi@1
  int v5; // eax@4
  __int64 v6; // rdi@7
  __int64 v7; // rcx@10
  __int64 v8; // r8@10
  __int64 v9; // r9@10

  v3 = a2;
  v4 = *(_DWORD *)(a2 + 16);
  if ( (unsigned int)(v4 - 1) > 3 )
  {
LABEL_2:
    panic(
      "\"IO80211QueueCall::handleEntry - bogus type %d, entry %p\\n\"@/SourceCache/AirPortFamily_kexts/AirPortFamily-710.55/BaseClass/IO80211QueueCall.cpp:207",
      v4,
      a1);
LABEL_10:
    kprintf(
      "IO80211Family: IO80211QueueCall::handleEntry - called type %d, error 0x%x\n",
      *(_DWORD *)(v3 + 16),
      (unsigned int)a3);
    v6 = (__int64)"IO80211Family: IO80211QueueCall::handleEntry - called type %d, error 0x%x\n";
    IOLog(
      "IO80211Family: IO80211QueueCall::handleEntry - called type %d, error 0x%x\n",
      *(_DWORD *)(v3 + 16),
      (unsigned int)a3,
      v7,
      v8,
      v9);
    return IO80211QueueCall::freeEntry(v6, v3);
  }
  switch ( (_DWORD)v4 )
  {
    case 1:
      v5 = ifnet_notice_node_presence(
             *(_QWORD *)(v3 + 24),
             *(_QWORD *)(v3 + 32),
             *(_DWORD *)(v3 + 40),
             *(_DWORD *)(v3 + 44),
             *(_DWORD *)(v3 + 48),
             v3 + 52);
      goto LABEL_7;
    case 2:
      v5 = ifnet_notice_node_absence(*(_QWORD *)(v3 + 24), *(_QWORD *)(v3 + 32));
      goto LABEL_7;
    case 3:
      v5 = ifnet_notice_master_elected(*(_QWORD *)(v3 + 24));
LABEL_7:
      a3 = v5;
      v6 = *(_QWORD *)(v3 + 24);
      ifnet_release(v6);
      break;
    case 4:
      v6 = v3 + 24;
      a3 = kev_post_msg(v3 + 24);
      break;
    default:
      goto LABEL_2;
  }
  if ( a3 )
    goto LABEL_10;
  return IO80211QueueCall::freeEntry(v6, v3);
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8B28: using guessed type int __fastcall ifnet_notice_master_elected(_QWORD);
// C8B30: using guessed type int __fastcall ifnet_notice_node_absence(_QWORD, _QWORD);
// C8B38: using guessed type int __fastcall ifnet_notice_node_presence(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8B48: using guessed type int __fastcall ifnet_release(_QWORD);
// C8BC0: using guessed type int __fastcall kev_post_msg(_QWORD);
// C8BD0: using guessed type int __fastcall kprintf(_QWORD, _QWORD, _QWORD);

//----- (0000000000009E64) ----------------------------------------------------
__int64 __fastcall IO80211QueueCall::ifnet_notice_node_presence(IO80211QueueCall *this, __ifnet *a2, sockaddr *a3, int a4, int a5, const void *a6)
{
  int v6; // er14@1
  int v7; // ebx@1
  __int64 v8; // rax@1
  signed int v9; // er13@1
  __int64 v10; // rax@3
  __int64 v11; // r14@3
  void *v12; // rax@4
  void *v13; // rbx@4
  int v15; // [sp+8h] [bp-48h]@3
  int v16; // [sp+Ch] [bp-44h]@3
  __int64 v17; // [sp+10h] [bp-40h]@3
  int v18; // [sp+1Ch] [bp-34h]@1
  const void *v19; // [sp+20h] [bp-30h]@1

  v19 = a6;
  v6 = a5;
  v7 = a4;
  v18 = (signed int)a3;
  v8 = IO80211QueueCall::io80211QueueCall(this, (unsigned __int64)a2);
  v9 = 22;
  if ( this )
  {
    if ( a2 )
    {
      v15 = v7;
      v16 = v6;
      v17 = v8;
      LODWORD(v10) = IOMalloc(120LL);
      v11 = v10;
      v9 = 12;
      if ( v10 )
      {
        LODWORD(v12) = IOMalloc(*(_BYTE *)a2);
        v13 = v12;
        if ( v12 )
        {
          bcopy((const void *)a2, v12, *(_BYTE *)a2);
          *(_DWORD *)(v11 + 16) = 1;
          *(_QWORD *)(v11 + 24) = this;
          *(_QWORD *)(v11 + 32) = v13;
          *(_DWORD *)(v11 + 40) = v18;
          *(_DWORD *)(v11 + 44) = v15;
          *(_DWORD *)(v11 + 48) = v16;
          bcopy(v19, (void *)(v11 + 52), 0x30uLL);
          ifnet_reference(this);
          IO80211QueueCall::addEntryToQueueAndCall(v17, v11);
          v9 = 0;
        }
        else
        {
          IOFree(v11, 120LL);
        }
      }
    }
  }
  return (unsigned int)v9;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// C8B40: using guessed type int __fastcall ifnet_reference(_QWORD);

//----- (0000000000009F58) ----------------------------------------------------
__int64 __fastcall IO80211QueueCall::ifnet_notice_node_absence(IO80211QueueCall *this, __ifnet *a2, sockaddr *a3)
{
  __int64 v3; // r14@1
  signed int v4; // ebx@1
  __int64 v5; // rax@3
  __int64 v6; // r13@3
  void *v7; // rax@4
  void *v8; // r14@4
  __int64 v10; // [sp+0h] [bp-30h]@4

  v3 = IO80211QueueCall::io80211QueueCall(this, (unsigned __int64)a2);
  v4 = 22;
  if ( this )
  {
    if ( a2 )
    {
      LODWORD(v5) = IOMalloc(120LL);
      v6 = v5;
      v4 = 12;
      if ( v5 )
      {
        v10 = v3;
        LODWORD(v7) = IOMalloc(*(_BYTE *)a2);
        v8 = v7;
        if ( v7 )
        {
          bcopy((const void *)a2, v7, *(_BYTE *)a2);
          *(_DWORD *)(v6 + 16) = 2;
          *(_QWORD *)(v6 + 24) = this;
          *(_QWORD *)(v6 + 32) = v8;
          ifnet_reference(this);
          IO80211QueueCall::addEntryToQueueAndCall(v10, v6);
          v4 = 0;
        }
        else
        {
          IOFree(v6, 120LL);
        }
      }
    }
  }
  return (unsigned int)v4;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// C8B40: using guessed type int __fastcall ifnet_reference(_QWORD);

//----- (000000000000A006) ----------------------------------------------------
__int64 __fastcall IO80211QueueCall::ifnet_notice_master_elected(IO80211QueueCall *this, __ifnet *a2)
{
  __int64 v2; // r14@1
  __int64 result; // rax@1
  __int64 v4; // rax@2
  __int64 v5; // rbx@2

  v2 = IO80211QueueCall::io80211QueueCall(this, (unsigned __int64)a2);
  result = 22LL;
  if ( this )
  {
    LODWORD(v4) = IOMalloc(120LL);
    v5 = v4;
    result = 12LL;
    if ( v5 )
    {
      *(_DWORD *)(v5 + 16) = 3;
      *(_QWORD *)(v5 + 24) = this;
      ifnet_reference(this);
      IO80211QueueCall::addEntryToQueueAndCall(v2, v5);
      result = 0LL;
    }
  }
  return result;
}
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// C8B40: using guessed type int __fastcall ifnet_reference(_QWORD);

//----- (000000000000A068) ----------------------------------------------------
__int64 __fastcall IO80211QueueCall::kev_post_msg(void *a1, unsigned __int64 a2)
{
  __int64 v2; // r14@1
  __int64 result; // rax@1
  __int64 v4; // rax@2
  __int64 v5; // r15@2
  signed __int64 v6; // rax@3
  char *v7; // rbx@5
  signed __int64 v8; // r14@5
  int v9; // eax@5
  const void *v10; // r12@6
  int v11; // er13@7
  void *v12; // rax@8
  __int64 v13; // [sp+0h] [bp-40h]@3
  int v14; // [sp+14h] [bp-2Ch]@8

  v2 = IO80211QueueCall::io80211QueueCall((IO80211QueueCall *)a1, a2);
  result = 22LL;
  if ( a1 )
  {
    LODWORD(v4) = IOMalloc(120LL);
    v5 = v4;
    result = 12LL;
    if ( v5 )
    {
      v13 = v2;
      *(_DWORD *)(v5 + 16) = 4;
      bcopy(a1, (void *)(v5 + 24), 0x60uLL);
      v6 = 48LL;
      do
      {
        *(_QWORD *)(v5 + v6) = 0LL;
        *(_DWORD *)(v5 + v6 - 8) = 0;
        v6 += 16LL;
      }
      while ( v6 != 128 );
      v7 = (char *)a1 + 24;
      v8 = v5 + 48;
      v9 = 0;
      while ( 1 )
      {
        v10 = *(const void **)v7;
        if ( !*(_QWORD *)v7 || (v11 = *((_DWORD *)v7 - 2)) == 0 )
        {
LABEL_10:
          IO80211QueueCall::addEntryToQueueAndCall(v13, v5);
          return 0LL;
        }
        v14 = v9;
        LODWORD(v12) = IOMalloc(v11);
        if ( !v12 )
          break;
        *(_QWORD *)v8 = v12;
        *(_DWORD *)(v8 - 8) = v11;
        bcopy(v10, v12, v11);
        v7 += 16;
        v8 += 16LL;
        v9 = v14 + 1;
        if ( v14 + 1 >= 5 )
          goto LABEL_10;
      }
      IO80211QueueCall::freeEntry(v11, v5);
      result = 12LL;
    }
  }
  return result;
}
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000000A174) ----------------------------------------------------
void __fastcall IO80211QueueCall::flushQueue(IO80211QueueCall *this)
{
  __int64 v1; // r14@1
  __int64 v2; // rdi@2
  signed __int64 v3; // rbx@2
  __int64 i; // rsi@2
  __int64 v5; // rax@5

  v1 = gQueueCall;
  if ( gQueueCall )
  {
    v2 = *(_QWORD *)(gQueueCall + 32LL);
    IOLockLock(v2);
    v3 = v1 + 16;
    for ( i = *(_QWORD *)(v1 + 16); v3 != i; i = *(_QWORD *)v3 )
    {
      v5 = *(_QWORD *)i;
      if ( v3 == *(_QWORD *)i )
        *(_QWORD *)(v1 + 24) = v3;
      else
        *(_QWORD *)(v5 + 8) = v3;
      *(_QWORD *)v3 = v5;
      *(_QWORD *)i = 0LL;
      *(_QWORD *)(i + 8) = 0LL;
      IO80211QueueCall::freeEntry(v2, i);
    }
    IOLockUnlock(*(_QWORD *)(v1 + 32));
  }
}
// 84E40: using guessed type _QWORD gQueueCall;
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);

//----- (000000000000A1E0) ----------------------------------------------------
__int64 __fastcall IO80211QueueCall::MetaClass::~MetaClass(IO80211QueueCall::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000A1F0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_2()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IO80211QueueCall::gMetaClass, "IO80211QueueCall", off_7B030[0], 48LL);
  result = (__int64)off_7BBB0;
  IO80211QueueCall::gMetaClass = off_7BBB0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 7BBB0: using guessed type __int64 (__fastcall *off_7BBB0[2])(IO80211QueueCall::MetaClass *__hidden this);
// 84368: using guessed type _QWORD IO80211QueueCall::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000A230) ----------------------------------------------------
__int64 `global destructor keyed to'_a_2()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211QueueCall::gMetaClass);
}
// 84368: using guessed type _QWORD IO80211QueueCall::gMetaClass;

//----- (000000000000A250) ----------------------------------------------------
__int64 __fastcall LogManager::MetaClass::MetaClass(LogManager::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "LogManager", off_7B030[0], 96LL);
  result = (__int64)off_7BDF0;
  *(_QWORD *)this = off_7BDF0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 7BDF0: using guessed type __int64 (__fastcall *off_7BDF0[2])(LogManager::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000A282) ----------------------------------------------------
__int64 __fastcall LogManager::MetaClass::~MetaClass(LogManager::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000A28C) ----------------------------------------------------
__int64 __fastcall LogManager::LogManager(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_7BCB0;
  *(_QWORD *)a1 = off_7BCB0;
  return result;
}
// 7BCB0: using guessed type __int64 (__fastcall *off_7BCB0[2])(LogManager *__hidden this);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000A2AC) ----------------------------------------------------
__int64 __fastcall LogManager::LogManager(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_7BCB0;
  *(_QWORD *)a1 = off_7BCB0;
  return result;
}
// 7BCB0: using guessed type __int64 (__fastcall *off_7BCB0[2])(LogManager *__hidden this);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000A2CC) ----------------------------------------------------
__int64 __fastcall LogManager::~LogManager(LogManager *this)
{
  return OSObject::~OSObject(this);
}

//----- (000000000000A2D6) ----------------------------------------------------
__int64 __fastcall LogManager::~LogManager(LogManager *this)
{
  return OSObject::~OSObject(this);
}

//----- (000000000000A2E0) ----------------------------------------------------
void __fastcall LogManager::~LogManager(LogManager *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000000A302) ----------------------------------------------------
__int64 __fastcall LogManager::getMetaClass(LogManager *this)
{
  return (__int64)&LogManager::gMetaClass;
}
// 84390: using guessed type _QWORD LogManager::gMetaClass;

//----- (000000000000A310) ----------------------------------------------------
__int64 __fastcall LogManager::MetaClass::MetaClass(LogManager::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "LogManager", off_7B030[0], 96LL);
  result = (__int64)off_7BDF0;
  *(_QWORD *)this = off_7BDF0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 7BDF0: using guessed type __int64 (__fastcall *off_7BDF0[2])(LogManager::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000A342) ----------------------------------------------------
__int64 __fastcall LogManager::MetaClass::alloc(LogManager::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20.nsects, a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_7BCB0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&LogManager::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 7BCB0: using guessed type __int64 (__fastcall *off_7BCB0[2])(LogManager *__hidden this);
// 84390: using guessed type _QWORD LogManager::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000A382) ----------------------------------------------------
__int64 __fastcall LogManager::LogManager(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_7BCB0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&LogManager::gMetaClass);
}
// 7BCB0: using guessed type __int64 (__fastcall *off_7BCB0[2])(LogManager *__hidden this);
// 84390: using guessed type _QWORD LogManager::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000A3B2) ----------------------------------------------------
__int64 __fastcall LogManager::LogManager(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_7BCB0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&LogManager::gMetaClass);
}
// 7BCB0: using guessed type __int64 (__fastcall *off_7BCB0[2])(LogManager *__hidden this);
// 84390: using guessed type _QWORD LogManager::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000A3E2) ----------------------------------------------------
int __fastcall LogManager::initWithDataRadyCallback(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rax@1
  int result; // eax@2

  *(_QWORD *)(a1 + 16) = a2;
  *(_QWORD *)(a1 + 32) = a4;
  *(_QWORD *)(a1 + 24) = a3;
  *(_QWORD *)(a1 + 56) = 0LL;
  *(_QWORD *)(a1 + 64) = a1 + 56;
  LODWORD(v4) = IOMalloc(2048LL);
  *(_QWORD *)(a1 + 48) = v4;
  if ( v4 )
    result = (*(int (__fastcall **)(__int64))(off_7B068[0] + 152))(a1);
  else
    result = 0;
  return result;
}
// 7B068: using guessed type __int64 off_7B068[9];
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000000A436) ----------------------------------------------------
__int64 __fastcall LogManager::withDataReadyCallback(__int64 a1, unsigned __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1

  v3 = a3;
  v4 = OSObject::operator new((OSObject *)&stru_20.nsects, a2);
  OSObject::OSObject(v4);
  *(_QWORD *)v4 = off_7BCB0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&LogManager::gMetaClass);
  if ( v4 && !(unsigned __int8)LogManager::initWithDataRadyCallback(v4, a1, a2, v3) )
  {
    (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v4 + 40LL))(v4, a1);
    v4 = 0LL;
  }
  return v4;
}
// 20: using guessed type segment_command_64 stru_20;
// 7BCB0: using guessed type __int64 (__fastcall *off_7BCB0[2])(LogManager *__hidden this);
// 84390: using guessed type _QWORD LogManager::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000A4B6) ----------------------------------------------------
int __fastcall LogManager::terminateWriteSleepers(LogManager *this)
{
  __int64 v1; // rax@2
  __int64 v2; // r14@2
  __int64 i; // rbx@2

  if ( *((_QWORD *)this + 11) )
  {
    *((_BYTE *)this + 80) = 1;
    LODWORD(v1) = (*(int (__cdecl **)(LogManager *))(*(_QWORD *)this + 280LL))(this);
    v2 = v1;
    for ( i = *((_QWORD *)this + 11); i; i = *(_QWORD *)i )
      LODWORD(v1) = thread_wakeup_prim(i, 1LL, 0LL);
    if ( v2 )
      LODWORD(v1) = IOLockUnlock(v2);
    for ( ; *((_QWORD *)this + 11); LODWORD(v1) = thread_block(0LL) )
      assert_wait((char *)this + 80, 0LL);
    if ( v2 )
      LODWORD(v1) = IOLockLock(v2);
  }
  return v1;
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C89C0: using guessed type int __fastcall assert_wait(_QWORD, _QWORD);
// C8DA8: using guessed type int __fastcall thread_block(_QWORD);
// C8DD8: using guessed type int __fastcall thread_wakeup_prim(_QWORD, _QWORD, _QWORD);

//----- (000000000000A54E) ----------------------------------------------------
int __usercall LogManager::free@<eax>(LogManager *this@<rdi>, int a2@<eax>)
{
  __int64 v2; // rbx@1
  __int64 v3; // rsi@3
  __int64 v4; // rdi@4
  __int64 v5; // rsi@7

  v2 = (__int64)this;
  while ( 1 )
  {
    v3 = *((_QWORD *)this + 5);
    if ( !v3 )
      break;
    a2 = LogManager::freeClient(a2, (__int64)this, v3);
  }
  v4 = *((_QWORD *)this + 6);
  if ( v4 )
    IOFree(v4, 2048LL);
  while ( 1 )
  {
    v5 = *(_QWORD *)(v2 + 56);
    if ( !v5 )
      break;
    LogManager::queueNodeRelease(v2, v5);
  }
  LogManager::terminateWriteSleepers((LogManager *)v2);
  return (*(int (__fastcall **)(__int64))(off_7B068[0] + 160))(v2);
}
// 7B068: using guessed type __int64 off_7B068[9];
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (000000000000A5AC) ----------------------------------------------------
int __usercall LogManager::freeClient@<eax>(int result@<eax>, __int64 a2@<rdi>, __int64 a3@<rsi>)
{
  __int64 v3; // r15@1
  __int64 v4; // rax@2
  __int64 v5; // rsi@4
  __int64 v6; // rsi@5
  __int64 v7; // rbx@8

  v3 = a3;
  if ( a3 )
  {
    v4 = *(_QWORD *)a3;
    if ( *(_QWORD *)a3 )
      *(_QWORD *)(v4 + 8) = *(_QWORD *)(a3 + 8);
    **(_QWORD **)(a3 + 8) = v4;
    v5 = *(_QWORD *)(a3 + 24);
    if ( v5 )
    {
      LogManager::queueNodeRelease(a2, v5);
      v6 = *(_QWORD *)(v3 + 24);
      if ( v6 == *(_QWORD *)(a2 + 56) )
      {
        if ( v6 )
        {
          do
          {
            if ( *(_DWORD *)(v6 + 20) != 1 )
              break;
            v7 = *(_QWORD *)v6;
            LogManager::queueNodeRelease(a2, v6);
            v6 = v7;
          }
          while ( v7 );
        }
      }
    }
    result = IOFree(v3, 40LL);
  }
  return result;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (000000000000A634) ----------------------------------------------------
void __fastcall LogManager::queueNodeRelease(__int64 a1, __int64 a2)
{
  __int64 v2; // r14@1
  bool v3; // zf@2
  __int64 v4; // rax@3
  __int64 v5; // rcx@3
  __int64 v6; // rdi@6
  __int64 i; // rbx@9

  v2 = a1;
  if ( a2 )
  {
    v3 = (*(_DWORD *)(a2 + 20))-- == 1;
    if ( v3 )
    {
      v4 = *(_QWORD *)a2;
      v5 = *(_QWORD *)(a2 + 8);
      if ( *(_QWORD *)a2 )
      {
        *(_QWORD *)(v4 + 8) = v5;
        v5 = *(_QWORD *)(a2 + 8);
      }
      else
      {
        *(_QWORD *)(a1 + 64) = v5;
      }
      *(_QWORD *)v5 = v4;
      v6 = *(_QWORD *)(a2 + 24);
      if ( *(_BYTE *)(a2 + 16) )
        IOFreeAligned(v6, 4096LL);
      else
        IOFree(v6, 4096LL);
      IOFree(a2, 40LL);
      *(_QWORD *)(v2 + 72) -= 4096LL;
      for ( i = *(_QWORD *)(v2 + 88); i; i = *(_QWORD *)i )
      {
        if ( !*(_BYTE *)(i + 32) && (unsigned __int64)(0x100000LL - *(_QWORD *)(v2 + 72)) >= *(_QWORD *)(i + 24) )
        {
          (*(void (__fastcall **)(_QWORD, __int64, signed __int64))(**(_QWORD **)(i + 16) + 488LL))(
            *(_QWORD *)(i + 16),
            i,
            1LL);
          *(_BYTE *)(i + 32) = 1;
        }
      }
    }
  }
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C76E8: using guessed type int __fastcall IOFreeAligned(_QWORD, _QWORD);

//----- (000000000000A6E4) ----------------------------------------------------
__int64 __fastcall LogManager::hlog(LogManager *this, unsigned __int8 *a2, unsigned __int64 a3, const char *a4, __va_list_tag *a5, __int64 a6)
{
  __int64 result; // rax@2
  __int64 v7; // rdx@2
  __int64 v8; // rcx@2
  __int64 v9; // r8@2
  __int64 v10; // r9@2
  __int64 v11; // r13@4
  bool v12; // r15@5
  unsigned int v13; // er12@5
  __int64 v14; // rdx@9
  unsigned __int64 v15; // [sp+10h] [bp-30h]@1

  v15 = a3;
  if ( !a4
    || (result = LogManager::vlog(this, a4, a5), !(_DWORD)result)
    && (result = LogManager::log(this, ":\n", v7, v8, v9, v10), !(_DWORD)result) )
  {
    v11 = 0LL;
    if ( v15 )
    {
      v12 = 1;
      v13 = 0;
      while ( 1 )
      {
        if ( v12 )
        {
          result = LogManager::log(this, "[%08X] ", v13, (__int64)a4, (__int64)a5, a6);
          if ( (_DWORD)result )
            return result;
          v13 += 30;
        }
        result = LogManager::log(this, "%02X ", a2[v11], (__int64)a4, (__int64)a5, a6);
        if ( (_DWORD)result )
          break;
        ++v11;
        a4 = (const char *)2290649225;
        v12 = (unsigned int)v11 % 0x1E == 0;
        if ( !((unsigned int)v11 % 0x1E) )
        {
          result = LogManager::log(this, "\n", v14, 2290649225LL, (__int64)a5, a6);
          if ( (_DWORD)result )
            break;
        }
        if ( (unsigned int)v11 >= v15 )
        {
          result = 0LL;
          if ( (unsigned int)v11 % 0x1E )
            result = LogManager::log(this, "\n", v14, (__int64)a4, (__int64)a5, a6);
          return result;
        }
      }
    }
    else
    {
      result = 0LL;
    }
  }
  return result;
}

//----- (000000000000A808) ----------------------------------------------------
__int64 __fastcall LogManager::vlog(LogManager *this, const char *a2, struct __va_list_tag *__attribute__((__org_typedef(va_list))) a3)
{
  struct __va_list_tag *v3; // r14@1
  __int64 result; // rax@1
  int v5; // er15@2
  int v6; // er15@4
  char *v7; // rax@4
  char *v8; // rcx@4
  int v9; // eax@5
  size_t v10; // rax@7
  unsigned int v11; // ebx@7
  unsigned __int8 *v12; // r14@8
  size_t v13; // rax@8
  char *v14; // [sp+8h] [bp-38h]@5

  v3 = a3;
  result = 0LL;
  if ( *((_QWORD *)this + 5) )
  {
    v5 = vsnprintf(*((char **)this + 6), 0x800uLL, a2, a3);
    result = 22LL;
    if ( v5 >= 0 )
    {
      if ( (unsigned int)v5 < 0x800 )
      {
        v12 = (unsigned __int8 *)*((_QWORD *)this + 6);
        v13 = strlen(*((const char **)this + 6));
        result = LogManager::queueData(this, v12, v13);
      }
      else
      {
        v6 = v5 + 1;
        LODWORD(v7) = IOMalloc(v6);
        v8 = v7;
        result = 12LL;
        if ( v8 )
        {
          v14 = v8;
          v9 = vsnprintf(v8, v6, a2, v3);
          if ( v9 < 0 || v9 >= v6 )
          {
            IOFree(v14, v6);
            result = 22LL;
          }
          else
          {
            v10 = strlen(v14);
            v11 = LogManager::queueData(this, (unsigned __int8 *)v14, v10);
            IOFree(v14, v6);
            result = v11;
          }
        }
      }
    }
  }
  return result;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000000A914) ----------------------------------------------------
__int64 __fastcall LogManager::log(LogManager *this, const char *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // rbx@1
  __int64 result; // rax@1
  __int64 v8; // rcx@1
  char v9; // [sp+0h] [bp-60h]@1
  __int64 v10; // [sp+10h] [bp-50h]@1
  __int64 v11; // [sp+18h] [bp-48h]@1
  __int64 v12; // [sp+20h] [bp-40h]@1
  __int64 v13; // [sp+28h] [bp-38h]@1
  va_list v14; // [sp+30h] [bp-30h]@1
  __int64 v15; // [sp+50h] [bp-10h]@1
  char v16; // [sp+70h] [bp+10h]@0

  v13 = a6;
  v12 = a5;
  v11 = a4;
  v10 = a3;
  v6 = off_7B078[0];
  v15 = *(_QWORD *)off_7B078[0];
  v14[0].reg_save_area = &v9;
  v14[0].overflow_arg_area = &v16;
  v14[0].fp_offset = 48;
  v14[0].gp_offset = 16;
  result = LogManager::vlog(this, a2, v14);
  v8 = *(_QWORD *)v6;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000000A978) ----------------------------------------------------
int __usercall LogManager::notifyAllDataReady@<eax>(LogManager *this@<rdi>, int result@<eax>, unsigned __int8 a3@<sil>)
{
  LogManager *v3; // r15@1
  __int64 i; // rbx@1
  __int64 v5; // rax@3
  char *v6; // rax@4
  __int64 v7; // rdi@4

  v3 = this;
  for ( i = *((_QWORD *)this + 5); i; i = *(_QWORD *)i )
  {
    if ( !*(_QWORD *)(i + 24) )
    {
      v5 = *((_QWORD *)v3 + 7);
      *(_QWORD *)(i + 24) = v5;
      ++*(_DWORD *)(v5 + 20);
      *(_QWORD *)(i + 32) = *(_QWORD *)(v5 + 24);
    }
    v6 = (char *)*((_QWORD *)v3 + 3);
    v7 = *((_QWORD *)v3 + 4) + *((_QWORD *)v3 + 2);
    if ( (unsigned __int8)v6 & 1 )
      v6 = *(char **)&v6[*(_QWORD *)v7 - 1];
    result = ((int (__fastcall *)(__int64, _QWORD, _QWORD))v6)(v7, *(_QWORD *)(i + 16), a3);
  }
  return result;
}

//----- (000000000000A9E0) ----------------------------------------------------
__int64 __fastcall LogManager::queueUIO(LogManager *this, uio *a2)
{
  LogManager *v2; // r15@1
  __int64 v3; // r13@1
  __int64 v4; // rbx@2
  __int64 v5; // rax@2
  signed int v6; // ebx@3
  __int64 v7; // rax@6
  unsigned int v8; // ebx@7
  __int64 v9; // rax@7
  __int64 v10; // r12@7
  __int64 v11; // rdi@7
  signed __int64 v12; // r13@7
  int v13; // eax@10

  v2 = this;
  v3 = **(_QWORD **)(*((_QWORD *)this + 8) + 8LL);
  if ( !v3 || (v4 = *(_QWORD *)(v3 + 24), v5 = *(_QWORD *)(v3 + 32), *(_QWORD *)(v3 + 24) - v5 == -4096) )
  {
    v6 = 12;
    if ( !LogManager::allocateQueueNode(this) )
      return (unsigned int)v6;
    v3 = **(_QWORD **)(*((_QWORD *)this + 8) + 8LL);
    v4 = *(_QWORD *)(v3 + 24);
    v5 = *(_QWORD *)(v3 + 32);
  }
  LODWORD(v4) = v4 - v5;
  while ( 1 )
  {
    v8 = v4 + 4096;
    LODWORD(v9) = uio_resid(a2);
    v10 = v9;
    v11 = *(_QWORD *)(v3 + 32);
    v12 = v3 + 32;
    if ( v8 >= (unsigned int)v9 )
      break;
    uiomove(v11, v8, a2);
    *(_QWORD *)v12 += v8;
    v6 = 12;
    if ( !LogManager::allocateQueueNode(v2) )
      return (unsigned int)v6;
    v7 = *(_QWORD *)(*((_QWORD *)v2 + 8) + 8LL);
    v3 = *(_QWORD *)v7;
    v4 = *(_QWORD *)(*(_QWORD *)v7 + 24LL) - *(_QWORD *)(*(_QWORD *)v7 + 32LL);
  }
  v13 = uiomove(v11, (unsigned int)v9, a2);
  *(_QWORD *)v12 += v10;
  v6 = 0;
  LogManager::notifyAllDataReady(v2, v13, 0);
  return (unsigned int)v6;
}
// C8DE0: using guessed type int __fastcall uio_resid(_QWORD);
// C8DE8: using guessed type int __fastcall uiomove(_QWORD, _QWORD, _QWORD);

//----- (000000000000AACA) ----------------------------------------------------
char __fastcall LogManager::allocateQueueNode(LogManager *this)
{
  __int64 v1; // rbx@2
  __int64 v2; // r15@2
  __int64 v3; // r12@3
  void *v4; // rax@11
  void *v5; // rbx@11
  __int64 v6; // rax@12
  __int64 v7; // rax@15

  if ( *((_QWORD *)this + 9) >= 0x100000uLL )
  {
    v1 = *((_QWORD *)this + 5);
    v2 = *((_QWORD *)this + 7);
    if ( v1 )
    {
      v3 = *(_QWORD *)v2;
      do
      {
        if ( *(_QWORD *)(v1 + 24) == v2 )
        {
          LogManager::queueNodeRelease((__int64)this, v2);
          *(_QWORD *)(v1 + 24) = v3;
          if ( v3 )
          {
            ++*(_DWORD *)(v3 + 20);
            *(_QWORD *)(v1 + 32) = *(_QWORD *)(v3 + 24);
          }
        }
        v1 = *(_QWORD *)v1;
      }
      while ( v1 );
    }
    if ( *(_DWORD *)(v2 + 20) != 1 )
      panic("\"LogManager::allocateQueueNode: firstQueueNode->refCnt = %u.\\n\"@/SourceCache/AirPortFamily_kexts/AirPortFamily-710.55/LogManager/LogManager.cpp:579");
    LogManager::queueNodeRelease((__int64)this, v2);
  }
  LODWORD(v4) = IOMalloc(40LL);
  v5 = v4;
  if ( v4 )
  {
    bzero(v4, 0x28uLL);
    LODWORD(v6) = IOMalloc(4096LL);
    *((_QWORD *)v5 + 3) = v6;
    if ( v6 )
    {
LABEL_15:
      *((_QWORD *)v5 + 4) = v6;
      ++*((_DWORD *)v5 + 5);
      *(_QWORD *)v5 = 0LL;
      v7 = *((_QWORD *)this + 8);
      *((_QWORD *)v5 + 1) = v7;
      *(_QWORD *)v7 = v5;
      *((_QWORD *)this + 8) = v5;
      *((_QWORD *)this + 9) += 4096LL;
      return 1;
    }
    LODWORD(v6) = IOMallocAligned(4096LL, 0LL);
    *((_QWORD *)v5 + 3) = v6;
    if ( v6 )
    {
      *((_BYTE *)v5 + 16) = 1;
      goto LABEL_15;
    }
    IOFree(v5, 40LL);
  }
  return 0;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// C7740: using guessed type int __fastcall IOMallocAligned(_QWORD, _QWORD);

//----- (000000000000ABD0) ----------------------------------------------------
__int64 __fastcall LogManager::queueData(LogManager *this, unsigned __int8 *a2, size_t a3)
{
  size_t v3; // r15@1
  unsigned __int8 *v4; // r12@1
  LogManager *v5; // r14@1
  __int64 v6; // r13@1
  __int64 v7; // rbx@2
  void *v8; // rdi@2
  char v9; // cl@3
  __int64 result; // rax@3
  __int64 v11; // rax@4
  signed __int64 v12; // r13@5
  size_t v13; // rbx@5
  char v14; // cl@6
  __int64 v15; // rax@7
  int v16; // eax@8

  v3 = a3;
  v4 = a2;
  v5 = this;
  v6 = **(_QWORD **)(*((_QWORD *)this + 8) + 8LL);
  if ( !v6 || (v7 = *(_QWORD *)(v6 + 24), v8 = *(void **)(v6 + 32), *(_QWORD *)(v6 + 24) - (_QWORD)v8 == -4096LL) )
  {
    v9 = LogManager::allocateQueueNode(v5);
    result = 12LL;
    if ( !v9 )
      return result;
    v11 = *(_QWORD *)(*((_QWORD *)v5 + 8) + 8LL);
    v6 = *(_QWORD *)v11;
    v7 = *(_QWORD *)(*(_QWORD *)v11 + 24LL);
    v8 = *(void **)(*(_QWORD *)v11 + 32LL);
  }
  v12 = v6 + 32;
  v13 = (4096 - (_DWORD)v8 + (_DWORD)v7) & 0xFFFFFFFF;
  if ( v13 >= v3 )
  {
LABEL_8:
    v16 = (unsigned __int64)memcpy(v8, v4, v3);
    *(_QWORD *)v12 += v3;
    LogManager::notifyAllDataReady(v5, v16, 1u);
    result = 0LL;
  }
  else
  {
    while ( 1 )
    {
      memcpy(v8, v4, v13);
      *(_QWORD *)v12 += v13;
      v14 = LogManager::allocateQueueNode(v5);
      result = 12LL;
      if ( !v14 )
        break;
      v4 += v13;
      v3 -= v13;
      v15 = **(_QWORD **)(*((_QWORD *)v5 + 8) + 8LL);
      v8 = *(void **)(v15 + 32);
      v12 = v15 + 32;
      v13 = (unsigned int)(*(_DWORD *)(v15 + 24) + 4096 - (_DWORD)v8);
      if ( v3 <= v13 )
        goto LABEL_8;
    }
  }
  return result;
}

//----- (000000000000ACD0) ----------------------------------------------------
__int64 __fastcall LogManager::vlogBlock(LogManager *this, const char *a2, __va_list_tag *a3, void *a4, unsigned int a5)
{
  struct __va_list_tag *v5; // r15@1
  const char *v6; // r12@1
  signed int v7; // er14@1
  __int64 v8; // rax@2
  __int64 v9; // r13@2
  char *v10; // rax@3
  signed __int64 v11; // rsi@4
  int v12; // er13@4
  signed int v13; // ecx@5
  int v14; // er13@6
  char *v15; // rax@7
  int v16; // eax@8
  __int64 v17; // rbx@8
  bool v18; // cf@9
  size_t v19; // r12@10
  LogManager *v20; // r14@10
  unsigned int v21; // er15@10
  __int64 v22; // rax@11
  __int64 v23; // rax@11
  __int64 v24; // rdx@11
  __int64 v25; // rcx@12
  __int64 v26; // r14@15
  unsigned int v27; // er12@18
  int v28; // er15@18
  unsigned int v29; // eax@24
  unsigned __int8 *v30; // r15@29
  __int64 v31; // rax@39
  signed int v33; // [sp+Ch] [bp-84h]@10
  __int64 v34; // [sp+18h] [bp-78h]@14
  __int64 v35; // [sp+20h] [bp-70h]@4
  unsigned __int8 *v36; // [sp+28h] [bp-68h]@4
  LogManager *v37; // [sp+30h] [bp-60h]@4
  unsigned int v38; // [sp+3Ch] [bp-54h]@1
  __int64 v39; // [sp+40h] [bp-50h]@18
  __int64 v40; // [sp+48h] [bp-48h]@18
  unsigned int v41; // [sp+50h] [bp-40h]@18
  __int64 v42; // [sp+58h] [bp-38h]@18
  unsigned int v43; // [sp+60h] [bp-30h]@18

  v38 = a5;
  v5 = a3;
  v6 = a2;
  v7 = 0;
  if ( !*((_QWORD *)this + 5) )
    return (unsigned int)v7;
  LODWORD(v8) = OSMetaClassBase::safeMetaCast(a4, *(_QWORD *)off_7B008[0]);
  v9 = v8;
  v7 = 22;
  if ( !v8 )
    return (unsigned int)v7;
  LODWORD(v10) = IOMalloc(2048LL);
  v7 = 12;
  if ( !v10 )
    return (unsigned int)v7;
  v35 = v9;
  v37 = this;
  v11 = 2048LL;
  v36 = (unsigned __int8 *)v10;
  v12 = vsnprintf(v10, 0x800uLL, v6, v5);
  if ( v12 < 0 )
  {
    v7 = 22;
    v13 = 2048;
    v17 = 0LL;
    goto LABEL_37;
  }
  v13 = 2048;
  if ( (unsigned int)v12 < 0x800 )
    goto LABEL_10;
  IOFree(v36, 2048LL);
  v14 = v12 + 1;
  v7 = 22;
  if ( (unsigned int)v14 <= 0x100000 )
  {
    LODWORD(v15) = IOMalloc((unsigned int)v14);
    v7 = 12;
    if ( v15 )
    {
      v36 = (unsigned __int8 *)v15;
      v11 = (unsigned int)v14;
      v16 = vsnprintf(v15, (unsigned int)v14, v6, v5);
      v7 = 22;
      v17 = 0LL;
      if ( v16 < 0 )
      {
        v13 = v14;
      }
      else
      {
        v18 = v16 < (unsigned int)v14;
        v13 = v14;
        v12 = v16;
        if ( v18 )
        {
LABEL_10:
          v33 = v13;
          v19 = v12;
          v20 = this;
          v17 = 0LL;
          v21 = v38;
          if ( v12 <= (unsigned __int64)(0x100000LL - *((_QWORD *)this + 9)) )
          {
LABEL_29:
            v37 = v20;
            v30 = v36;
            v7 = LogManager::queueData(v20, v36, v19);
          }
          else
          {
            LODWORD(v22) = IOMalloc(40LL);
            v17 = v22;
            LODWORD(v23) = (*(int (__fastcall **)(LogManager *, signed __int64))(*(_QWORD *)this + 280LL))(this, v11);
            v24 = v23;
            if ( v17 )
            {
              *(_QWORD *)(v17 + 16) = v35;
              *(_QWORD *)(v17 + 24) = v12;
              v25 = *((_QWORD *)this + 11);
              *(_QWORD *)v17 = v25;
              if ( v25 )
                *(_QWORD *)(v25 + 8) = v17;
              *((_QWORD *)this + 11) = v17;
              *(_QWORD *)(v17 + 8) = (char *)this + 88;
              v34 = 0LL;
              while ( 2 )
              {
                v26 = v24;
                if ( v24 )
                  IOLockUnlock(v24);
                *(_BYTE *)(v17 + 32) = 0;
                if ( v21 )
                {
                  v27 = v21;
                  clock_interval_to_deadline(v21, 1000000000LL, &v39);
                  clock_get_system_nanotime(&v42, &v43);
                  v28 = (*(int (__fastcall **)(__int64, __int64, __int64, _QWORD))(*(_QWORD *)v35 + 496LL))(
                          v35,
                          v17,
                          v39,
                          0LL);
                  clock_get_system_nanotime(&v40, &v41);
                  v34 = v40 - v42 - (v41 < v43);
                }
                else
                {
                  v27 = 0;
                  v28 = (*(int (__fastcall **)(__int64, __int64, _QWORD))(*(_QWORD *)v35 + 480LL))(v35, v17, 0LL);
                }
                if ( v26 )
                  IOLockLock(v26);
                v24 = v26;
                v7 = -2;
                if ( !*((_BYTE *)this + 80) )
                {
                  v7 = 60;
                  switch ( v28 )
                  {
                    case 0:
                      v29 = 0;
                      if ( !v27 )
                        goto LABEL_27;
                      if ( v27 <= (unsigned __int64)v34 )
                        break;
                      v29 = v27 - v34;
LABEL_27:
                      v7 = 0;
                      if ( !*((_QWORD *)this + 5) )
                        break;
                      v20 = this;
                      v19 = v12;
                      v21 = v29;
                      if ( v12 <= (unsigned __int64)(0x100000LL - *((_QWORD *)this + 9)) )
                        goto LABEL_29;
                      continue;
                    case 1:
                      goto LABEL_33;
                    case 2:
                      v7 = 4;
                      break;
                    case 3:
                      v7 = -1;
                      break;
                    default:
                      v7 = 6;
                      break;
                  }
                }
                break;
              }
            }
            else
            {
              v7 = 12;
            }
LABEL_33:
            v30 = v36;
          }
          v36 = v30;
          v13 = v33;
          if ( !v30 )
            goto LABEL_38;
          goto LABEL_37;
        }
      }
LABEL_37:
      IOFree(v36, (unsigned int)v13);
LABEL_38:
      if ( v17 )
      {
        v31 = *(_QWORD *)v17;
        if ( *(_QWORD *)v17 )
          *(_QWORD *)(v31 + 8) = *(_QWORD *)(v17 + 8);
        **(_QWORD **)(v17 + 8) = v31;
        IOFree(v17, 40LL);
      }
      goto LABEL_42;
    }
  }
LABEL_42:
  if ( *((_BYTE *)v37 + 80) )
    thread_wakeup_prim((char *)v37 + 80, 1LL, 0LL);
  return (unsigned int)v7;
}
// 7B008: using guessed type _QWORD off_7B008[21];
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// C8A30: using guessed type int __fastcall clock_get_system_nanotime(_QWORD, _QWORD);
// C8A38: using guessed type int __fastcall clock_interval_to_deadline(_QWORD, _QWORD, _QWORD);
// C8DD8: using guessed type int __fastcall thread_wakeup_prim(_QWORD, _QWORD, _QWORD);

//----- (000000000000B054) ----------------------------------------------------
__int64 __fastcall LogManager::blog(LogManager *this, unsigned __int8 *a2, size_t a3)
{
  __int64 result; // rax@2

  if ( *((_QWORD *)this + 5) )
    result = LogManager::queueData(this, a2, a3);
  else
    result = 0LL;
  return result;
}

//----- (000000000000B06A) ----------------------------------------------------
__int64 __fastcall LogManager::writeData(LogManager *this, void *a2, uio *a3)
{
  __int64 result; // rax@2

  if ( *((_QWORD *)this + 5) )
    result = LogManager::queueUIO(this, a3);
  else
    result = 0LL;
  return result;
}

//----- (000000000000B082) ----------------------------------------------------
__int64 __fastcall LogManager::readData(LogManager *this, void *a2, uio *a3)
{
  uio *v3; // r15@1
  int v4; // er13@1
  __int64 i; // r14@3
  __int64 v6; // rax@7
  __int64 v7; // rax@12
  __int64 v8; // r12@13
  __int64 v9; // rax@14
  __int64 v10; // rax@18
  __int64 v11; // rcx@18
  __int64 v12; // rax@23
  unsigned __int64 v13; // rax@25
  unsigned __int64 v14; // rbx@25
  __int64 v15; // rax@25
  unsigned __int64 v16; // rcx@25
  bool v17; // cf@27
  bool v18; // zf@27
  __int64 v19; // rbx@33
  __int64 v20; // rax@34
  __int64 v21; // rax@36
  __int64 v22; // rcx@36

  v3 = a3;
  v4 = 22;
  if ( a2 && a3 )
  {
    for ( i = *((_QWORD *)this + 5); ; i = *(_QWORD *)i )
    {
      if ( !i )
        return (unsigned int)v4;
      if ( *(void **)(i + 16) == a2 )
        break;
    }
    v6 = *(_QWORD *)(i + 24);
    v4 = 0;
    if ( v6 )
    {
      if ( *(_DWORD *)(v6 + 32) != *(_DWORD *)(i + 32) || *(_QWORD *)v6 )
      {
        while ( 1 )
        {
          LODWORD(v7) = uio_resid(v3);
          v4 = 0;
          if ( !v7 )
          {
LABEL_33:
            v19 = *(_QWORD *)(i + 24);
            if ( v19 )
            {
              v20 = *(_QWORD *)(v19 + 32);
              if ( (_DWORD)v20 == *(_DWORD *)(i + 32) && *(_QWORD *)(v19 + 24) - v20 == -4096 )
              {
                v21 = *(_QWORD *)v19;
                *(_QWORD *)(i + 24) = *(_QWORD *)v19;
                v22 = 0LL;
                if ( v21 )
                {
                  ++*(_DWORD *)(v21 + 20);
                  v22 = *(_QWORD *)(v21 + 24);
                }
                *(_QWORD *)(i + 32) = v22;
                LogManager::queueNodeRelease((__int64)this, v19);
                if ( v19 == *((_QWORD *)this + 7) && *(_DWORD *)(v19 + 20) == 1 )
                  LogManager::queueNodeRelease((__int64)this, v19);
              }
            }
            return (unsigned int)v4;
          }
          v8 = *(_QWORD *)(i + 24);
          if ( v8 )
          {
            v9 = *(_QWORD *)(v8 + 32);
            if ( (_DWORD)v9 != *(_DWORD *)(i + 32) )
              goto LABEL_25;
          }
          else
          {
            v9 = *(_QWORD *)&stru_20;
          }
          v4 = 0;
          if ( *(_QWORD *)(v8 + 24) - v9 != -4096 )
            goto LABEL_33;
          v10 = *(_QWORD *)v8;
          *(_QWORD *)(i + 24) = *(_QWORD *)v8;
          v11 = 0LL;
          if ( v10 )
          {
            ++*(_DWORD *)(v10 + 20);
            v11 = *(_QWORD *)(v10 + 24);
          }
          *(_QWORD *)(i + 32) = v11;
          LogManager::queueNodeRelease((__int64)this, v8);
          if ( v8 == *((_QWORD *)this + 7) && *(_DWORD *)(v8 + 20) == 1 )
            LogManager::queueNodeRelease((__int64)this, v8);
          v12 = *(_QWORD *)(i + 24);
          v4 = 0;
          if ( !v12 )
            return (unsigned int)v4;
          v4 = 0;
          if ( *(_DWORD *)(v12 + 32) == *(_DWORD *)(i + 32) )
            goto LABEL_33;
LABEL_25:
          LODWORD(v13) = uio_resid(v3);
          v14 = v13;
          v15 = *(_QWORD *)(i + 24);
          v16 = 0LL;
          if ( v15 )
            v16 = (*(_DWORD *)(v15 + 32) - *(_DWORD *)(i + 32)) & 0xFFFFFFFF;
          v17 = v14 < v16;
          v18 = v14 == v16;
          if ( v14 > v16 )
            v14 = 0LL;
          if ( !v17 && !v18 && v15 )
            v14 = (unsigned int)(*(_DWORD *)(v15 + 32) - *(_DWORD *)(i + 32));
          v4 = uiomove(*(_QWORD *)(i + 32), (unsigned int)v14, v3);
          if ( v4 )
            goto LABEL_33;
          *(_QWORD *)(i + 32) += v14;
        }
      }
    }
  }
  return (unsigned int)v4;
}
// 20: using guessed type segment_command_64 stru_20;
// C8DE0: using guessed type int __fastcall uio_resid(_QWORD);
// C8DE8: using guessed type int __fastcall uiomove(_QWORD, _QWORD, _QWORD);

//----- (000000000000B278) ----------------------------------------------------
__int64 __fastcall LogManager::clientForID(LogManager *this, void *a2)
{
  __int64 v2; // rcx@1
  __int64 result; // rax@1

  v2 = *((_QWORD *)this + 5);
  result = 0LL;
  if ( v2 )
  {
    result = 0LL;
    while ( *(void **)(v2 + 16) != a2 )
    {
      v2 = *(_QWORD *)v2;
      if ( !v2 )
        return result;
    }
    result = v2;
  }
  return result;
}

//----- (000000000000B29E) ----------------------------------------------------
__int64 __fastcall LogManager::registerClient(LogManager *this, void *a2)
{
  __int64 i; // rcx@1
  __int64 result; // rax@4
  __int64 v4; // rax@6
  __int64 v5; // r15@6
  __int64 v6; // rax@7
  __int64 v7; // rcx@9

  for ( i = *((_QWORD *)this + 5); i; i = *(_QWORD *)i )
  {
    result = 16LL;
    if ( *(void **)(i + 16) == a2 )
      return result;
  }
  LODWORD(v4) = IOMalloc(40LL);
  v5 = v4;
  result = 12LL;
  if ( v5 )
  {
    bzero((void *)v5, 0x28uLL);
    *(_QWORD *)(v5 + 16) = a2;
    v6 = *((_QWORD *)this + 5);
    *(_QWORD *)v5 = *((_QWORD *)this + 5);
    if ( v6 )
      *(_QWORD *)(v6 + 8) = v5;
    *((_QWORD *)this + 5) = v5;
    *(_QWORD *)(v5 + 8) = (char *)this + 40;
    v7 = **(_QWORD **)(*((_QWORD *)this + 8) + 8LL);
    result = 0LL;
    if ( v7 )
    {
      *(_QWORD *)(v5 + 24) = v7;
      ++*(_DWORD *)(v7 + 20);
      *(_QWORD *)(v5 + 32) = *(_QWORD *)(v7 + 32);
    }
  }
  return result;
}
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000000B338) ----------------------------------------------------
__int64 __usercall LogManager::deregisterClient@<rax>(LogManager *this@<rdi>, void *a2@<rsi>, __int64 a3@<rax>)
{
  void *v3; // rcx@1
  __int64 v4; // rsi@1
  __int64 result; // rax@1
  __int64 i; // rbx@6
  __int64 v7; // [sp-8h] [bp-20h]@1

  v7 = a3;
  v3 = a2;
  v4 = *((_QWORD *)this + 5);
  result = 22LL;
  while ( v4 )
  {
    if ( *(void **)(v4 + 16) == v3 )
    {
      LogManager::freeClient(22, (__int64)this, v4);
      result = 0LL;
      if ( !*((_QWORD *)this + 5) )
      {
        for ( i = *((_QWORD *)this + 7); i; result = 0LL )
        {
          if ( *(_DWORD *)(i + 20) != 1 )
            panic(
              "\"LogManager::deregisterClient: qNode->refCnt = %u.\\n\"@/SourceCache/AirPortFamily_kexts/AirPortFamily-710.55/LogManager/LogManager.cpp:845",
              v7);
          LogManager::queueNodeRelease((__int64)this, i);
          i = *((_QWORD *)this + 7);
        }
      }
      return result;
    }
    v4 = *(_QWORD *)v4;
  }
  return result;
}

//----- (000000000000B3B6) ----------------------------------------------------
bool __fastcall LogManager::dataAvailable(LogManager *this, void *a2)
{
  __int64 i; // rax@1
  __int64 v3; // rcx@5

  for ( i = *((_QWORD *)this + 5); i; i = *(_QWORD *)i )
  {
    if ( *(void **)(i + 16) == a2 )
    {
      v3 = *(_QWORD *)(i + 24);
      if ( v3 )
        return *(_DWORD *)(v3 + 32) != *(_DWORD *)(i + 32);
      return 0;
    }
  }
  return 0;
}

//----- (000000000000B3E6) ----------------------------------------------------
__int64 __fastcall LogManager::getDataSourceLock(LogManager *this)
{
  return 0LL;
}

//----- (000000000000B3EE) ----------------------------------------------------
bool __fastcall LogManager::writeRoomAvailable(LogManager *this)
{
  return *((_QWORD *)this + 9) < 0x100000uLL;
}

//----- (000000000000B400) ----------------------------------------------------
__int64 __fastcall LogManager::MetaClass::~MetaClass(LogManager::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000B410) ----------------------------------------------------
__int64 `global constructor keyed to'_a_3()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&LogManager::gMetaClass, "LogManager", off_7B030[0], 96LL);
  result = (__int64)off_7BDF0;
  LogManager::gMetaClass = off_7BDF0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 7BDF0: using guessed type __int64 (__fastcall *off_7BDF0[2])(LogManager::MetaClass *__hidden this);
// 84390: using guessed type _QWORD LogManager::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000B450) ----------------------------------------------------
__int64 `global destructor keyed to'_a_3()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&LogManager::gMetaClass);
}
// 84390: using guessed type _QWORD LogManager::gMetaClass;

//----- (000000000000B461) ----------------------------------------------------
char *__fastcall convertApple80211ReturnToString(int a1)
{
  int v1; // eax@1
  int v2; // edi@2
  signed __int64 v3; // rdx@2
  signed __int64 v4; // rsi@2
  __int64 v5; // r8@2
  char *result; // rax@2
  signed __int64 v7; // rcx@3
  signed __int64 v8; // rcx@3
  int v9; // edi@7
  signed __int64 v10; // rdx@7
  signed __int64 v11; // rsi@7
  signed __int64 v12; // rcx@8
  unsigned int v13; // edx@12
  char **v14; // rcx@12

  v1 = a1 & 0x3E00;
  if ( v1 == 12288 )
  {
    v2 = a1 & 0x1FF;
    v3 = 0LL;
    v4 = 1LL;
    v5 = (__int64)qword_7C150;
    result = "unknown IEEE reason";
    while ( 1 )
    {
      v7 = v3;
      v3 = v4;
      v8 = 2 * v7;
      if ( LODWORD(qword_7C150[v8]) == v2 )
        break;
      ++v4;
      if ( (_DWORD)v3 == 33 )
        return result;
    }
    return *(char **)(v8 * 8 + v5 + 8);
  }
  if ( v1 == 4096 )
  {
    v9 = a1 & 0x1FF;
    v10 = 0LL;
    v11 = 1LL;
    v5 = (__int64)qword_7C370;
    result = "unknown IEEE status";
    while ( 1 )
    {
      v12 = v10;
      v10 = v11;
      v8 = 2 * v12;
      if ( LODWORD(qword_7C370[v8]) == v9 )
        break;
      ++v11;
      if ( (_DWORD)v10 == 33 )
        return result;
    }
    return *(char **)(v8 * 8 + v5 + 8);
  }
  v13 = 0;
  v14 = &off_7BED8;
  result = 0LL;
  while ( *((_DWORD *)v14 - 2) != a1 )
  {
    ++v13;
    v14 += 2;
    if ( v13 > 0x27 )
      return result;
  }
  return *v14;
}
// 7BED8: using guessed type char *off_7BED8;
// 7C150: using guessed type __int64 qword_7C150[];
// 7C370: using guessed type __int64 qword_7C370[];

//----- (000000000000B50F) ----------------------------------------------------
__int64 __fastcall convertIEEEStatusToString(int a1)
{
  signed __int64 v1; // rdx@1
  signed __int64 v2; // rsi@1
  __int64 result; // rax@1
  signed __int64 v4; // rcx@2
  signed __int64 v5; // rcx@2

  v1 = 0LL;
  v2 = 1LL;
  result = (__int64)"unknown IEEE status";
  while ( 1 )
  {
    v4 = v1;
    v1 = v2;
    v5 = 2 * v4;
    if ( LODWORD(qword_7C370[v5]) == a1 )
      break;
    ++v2;
    if ( (_DWORD)v1 == 33 )
      return result;
  }
  return qword_7C370[v5 + 1];
}
// 7C370: using guessed type __int64 qword_7C370[];

//----- (000000000000B54A) ----------------------------------------------------
__int64 __fastcall convertIEEEReasonToString(int a1)
{
  signed __int64 v1; // rdx@1
  signed __int64 v2; // rsi@1
  __int64 result; // rax@1
  signed __int64 v4; // rcx@2
  signed __int64 v5; // rcx@2

  v1 = 0LL;
  v2 = 1LL;
  result = (__int64)"unknown IEEE reason";
  while ( 1 )
  {
    v4 = v1;
    v1 = v2;
    v5 = 2 * v4;
    if ( LODWORD(qword_7C150[v5]) == a1 )
      break;
    ++v2;
    if ( (_DWORD)v1 == 33 )
      return result;
  }
  return qword_7C150[v5 + 1];
}
// 7C150: using guessed type __int64 qword_7C150[];

//----- (000000000000B585) ----------------------------------------------------
__int64 __fastcall convertApple80211ReturnToErrno(int a1)
{
  __int64 result; // rax@2
  unsigned int v2; // edx@3
  int *v3; // rcx@3

  if ( (((unsigned __int16)a1 | 0x2000) & 0x3E00) == 12288 )
  {
    result = a1 & 0x1FF;
  }
  else
  {
    v2 = 0;
    v3 = &dword_7BED4;
    while ( *(v3 - 1) != a1 )
    {
      ++v2;
      v3 += 4;
      result = 0LL;
      if ( v2 > 0x27 )
        return result;
    }
    result = (unsigned int)*v3;
  }
  return result;
}
// 7BED4: using guessed type int dword_7BED4;

//----- (000000000000B5D0) ----------------------------------------------------
__int64 __fastcall IOCharacterDevice::MetaClass::MetaClass(IOCharacterDevice::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOCharacterDevice", off_7B030[0], 64LL);
  result = (__int64)off_7C6E0;
  *(_QWORD *)this = off_7C6E0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 7C6E0: using guessed type __int64 (__fastcall *off_7C6E0[2])(IOCharacterDevice::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000B602) ----------------------------------------------------
__int64 __fastcall IOCharacterDevice::MetaClass::~MetaClass(IOCharacterDevice::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000B60C) ----------------------------------------------------
__int64 __fastcall IOCharacterDevice::IOCharacterDevice(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_7C5B0;
  *(_QWORD *)a1 = off_7C5B0;
  return result;
}
// 7C5B0: using guessed type __int64 (__fastcall *off_7C5B0[2])(IOCharacterDevice *__hidden this);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000B62C) ----------------------------------------------------
__int64 __fastcall IOCharacterDevice::IOCharacterDevice(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_7C5B0;
  *(_QWORD *)a1 = off_7C5B0;
  return result;
}
// 7C5B0: using guessed type __int64 (__fastcall *off_7C5B0[2])(IOCharacterDevice *__hidden this);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000B64C) ----------------------------------------------------
__int64 __fastcall IOCharacterDevice::~IOCharacterDevice(IOCharacterDevice *this)
{
  return OSObject::~OSObject(this);
}

//----- (000000000000B656) ----------------------------------------------------
__int64 __fastcall IOCharacterDevice::~IOCharacterDevice(IOCharacterDevice *this)
{
  return OSObject::~OSObject(this);
}

//----- (000000000000B660) ----------------------------------------------------
void __fastcall IOCharacterDevice::~IOCharacterDevice(IOCharacterDevice *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000000B682) ----------------------------------------------------
__int64 __fastcall IOCharacterDevice::getMetaClass(IOCharacterDevice *this)
{
  return (__int64)&IOCharacterDevice::gMetaClass;
}
// 843B8: using guessed type _QWORD IOCharacterDevice::gMetaClass;

//----- (000000000000B690) ----------------------------------------------------
__int64 __fastcall IOCharacterDevice::MetaClass::MetaClass(IOCharacterDevice::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOCharacterDevice", off_7B030[0], 64LL);
  result = (__int64)off_7C6E0;
  *(_QWORD *)this = off_7C6E0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 7C6E0: using guessed type __int64 (__fastcall *off_7C6E0[2])(IOCharacterDevice::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000B6C2) ----------------------------------------------------
__int64 __fastcall IOCharacterDevice::MetaClass::alloc(IOCharacterDevice::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20.vmsize, a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_7C5B0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOCharacterDevice::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 7C5B0: using guessed type __int64 (__fastcall *off_7C5B0[2])(IOCharacterDevice *__hidden this);
// 843B8: using guessed type _QWORD IOCharacterDevice::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000B702) ----------------------------------------------------
__int64 __fastcall IOCharacterDevice::IOCharacterDevice(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_7C5B0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOCharacterDevice::gMetaClass);
}
// 7C5B0: using guessed type __int64 (__fastcall *off_7C5B0[2])(IOCharacterDevice *__hidden this);
// 843B8: using guessed type _QWORD IOCharacterDevice::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000B732) ----------------------------------------------------
__int64 __fastcall IOCharacterDevice::IOCharacterDevice(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_7C5B0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOCharacterDevice::gMetaClass);
}
// 7C5B0: using guessed type __int64 (__fastcall *off_7C5B0[2])(IOCharacterDevice *__hidden this);
// 843B8: using guessed type _QWORD IOCharacterDevice::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000B762) ----------------------------------------------------
__int64 __fastcall IOCharacterDevice::withGatedDataSource(__int64 a1, unsigned __int64 a2, __int64 a3, __int64 a4, const char *a5, int a6, int a7)
{
  int v7; // er13@1
  __int64 v8; // rbx@1
  __int64 v10; // [sp+10h] [bp-40h]@1
  __int64 v11; // [sp+18h] [bp-38h]@1
  const char *v12; // [sp+20h] [bp-30h]@1

  v7 = a6;
  v12 = a5;
  v11 = a4;
  v10 = a3;
  v8 = OSObject::operator new((OSObject *)&stru_20.vmsize, a2);
  OSObject::OSObject(v8);
  *(_QWORD *)v8 = off_7C5B0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOCharacterDevice::gMetaClass);
  if ( v8 && !(unsigned __int8)IOCharacterDevice::initWithGatedDataSource(v8, a1, a2, v10, v11, v12, v7, a7) )
  {
    (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v8 + 40LL))(v8, a1);
    v8 = 0LL;
  }
  return v8;
}
// 20: using guessed type segment_command_64 stru_20;
// 7C5B0: using guessed type __int64 (__fastcall *off_7C5B0[2])(IOCharacterDevice *__hidden this);
// 843B8: using guessed type _QWORD IOCharacterDevice::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000B804) ----------------------------------------------------
int __fastcall IOCharacterDevice::initWithGatedDataSource(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, const char *a6, int a7, int a8)
{
  int result; // eax@2

  *(_QWORD *)(a1 + 16) = a2;
  *(_QWORD *)(a1 + 32) = a4;
  *(_QWORD *)(a1 + 24) = a3;
  *(_QWORD *)(a1 + 40) = a5;
  *(_DWORD *)(a1 + 56) = -1;
  *(_QWORD *)(a1 + 48) = 0LL;
  if ( (unsigned int)cdev_init(a6, a1 + 56, a7, a8, (__int64)_deviceCallback, a1) )
    result = 0;
  else
    result = (*(int (__fastcall **)(__int64, signed __int64))(off_7B068[0] + 152))(a1, a1 + 56);
  return result;
}
// 7B068: using guessed type __int64 off_7B068[9];

//----- (000000000000B86E) ----------------------------------------------------
__int64 __fastcall IOCharacterDevice::withLockedDataSource(__int64 a1, unsigned __int64 a2, __int64 a3, __int64 a4, const char *a5, int a6, int a7)
{
  int v7; // er13@1
  __int64 v8; // rbx@1
  __int64 v10; // [sp+10h] [bp-40h]@1
  __int64 v11; // [sp+18h] [bp-38h]@1
  const char *v12; // [sp+20h] [bp-30h]@1

  v7 = a6;
  v12 = a5;
  v11 = a4;
  v10 = a3;
  v8 = OSObject::operator new((OSObject *)&stru_20.vmsize, a2);
  OSObject::OSObject(v8);
  *(_QWORD *)v8 = off_7C5B0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOCharacterDevice::gMetaClass);
  if ( v8 && !(unsigned __int8)IOCharacterDevice::initWithLockedDataSource(v8, a1, a2, v10, v11, v12, v7, a7) )
  {
    (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v8 + 40LL))(v8, a1);
    v8 = 0LL;
  }
  return v8;
}
// 20: using guessed type segment_command_64 stru_20;
// 7C5B0: using guessed type __int64 (__fastcall *off_7C5B0[2])(IOCharacterDevice *__hidden this);
// 843B8: using guessed type _QWORD IOCharacterDevice::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000B910) ----------------------------------------------------
int __fastcall IOCharacterDevice::initWithLockedDataSource(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, const char *a6, int a7, int a8)
{
  int result; // eax@2

  *(_QWORD *)(a1 + 16) = a2;
  *(_QWORD *)(a1 + 32) = a4;
  *(_QWORD *)(a1 + 24) = a3;
  *(_QWORD *)(a1 + 40) = 0LL;
  *(_DWORD *)(a1 + 56) = -1;
  *(_QWORD *)(a1 + 48) = a5;
  if ( (unsigned int)cdev_init(a6, a1 + 56, a7, a8, (__int64)_deviceCallback, a1) )
    result = 0;
  else
    result = (*(int (__fastcall **)(__int64, signed __int64))(off_7B068[0] + 152))(a1, a1 + 56);
  return result;
}
// 7B068: using guessed type __int64 off_7B068[9];

//----- (000000000000B979) ----------------------------------------------------
__int64 __fastcall _deviceCallback(void *this, int a2, void *a3, void *a4)
{
  return IOCharacterDevice::deviceCallback((IOCharacterDevice *)this, a2, a3, a4);
}

//----- (000000000000B984) ----------------------------------------------------
int __fastcall IOCharacterDevice::free(IOCharacterDevice *this)
{
  IOCharacterDevice *v1; // rbx@1
  int v2; // edi@1

  v1 = this;
  *((_BYTE *)this + 60) = 1;
  v2 = *((_DWORD *)this + 14);
  if ( v2 != -1 )
    cdev_free(v2);
  return (*(int (__fastcall **)(IOCharacterDevice *))(off_7B068[0] + 160))(v1);
}
// 7B068: using guessed type __int64 off_7B068[9];

//----- (000000000000B9B4) ----------------------------------------------------
__int64 __fastcall IOCharacterDevice::deviceCallbackGated(IOCharacterDevice *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  OSObject *v6; // rbx@1
  __int64 v7; // rax@1
  __int64 v8; // rsi@1
  char *v9; // r8@1
  __int64 v10; // rdi@1

  v6 = a2;
  v7 = *(_QWORD *)a2;
  v8 = *((_DWORD *)a2 + 2);
  v9 = *(char **)(v7 + 24);
  v10 = *(_QWORD *)(v7 + 32) + *(_QWORD *)(v7 + 16);
  if ( (unsigned __int8)v9 & 1 )
    v9 = *(char **)&v9[*(_QWORD *)v10 - 1];
  *((_DWORD *)v6 + 8) = ((int (__fastcall *)(__int64, __int64, _QWORD, _QWORD, char *, void *))v9)(
                          v10,
                          v8,
                          *((_QWORD *)v6 + 2),
                          *((_QWORD *)v6 + 3),
                          v9,
                          a6);
  return 0LL;
}

//----- (000000000000B9F4) ----------------------------------------------------
int __fastcall IOCharacterDevice::dataSourceCallback(IOCharacterDevice *this, __int64 a2, void *a3, void *a4)
{
  char *v4; // r8@1
  __int64 v5; // rdi@1

  v4 = (char *)*((_QWORD *)this + 3);
  v5 = *((_QWORD *)this + 4) + *((_QWORD *)this + 2);
  if ( (unsigned __int8)v4 & 1 )
    v4 = *(char **)&v4[*(_QWORD *)v5 - 1];
  return ((int (__fastcall *)(__int64, __int64, void *, void *))v4)(v5, a2, a3, a4);
}

//----- (000000000000BA1A) ----------------------------------------------------
void __fastcall IOCharacterDevice::dataReady(IOCharacterDevice *this, void *a2, unsigned __int8 a3)
{
  cdev_data_ready((__int64)a2, a3);
}

//----- (000000000000BA2C) ----------------------------------------------------
__int64 __fastcall IOCharacterDevice::deviceCallback(IOCharacterDevice *this, int a2, void *a3, void *a4)
{
  void *v4; // r14@1
  void *v5; // r15@1
  IOCharacterDevice *v6; // rbx@1
  __int64 v7; // rdi@1
  int v8; // er13@2
  __int64 v9; // rdi@5
  char *v10; // r8@7
  __int64 v11; // rdi@7
  __int64 v12; // rdi@9
  IOCharacterDevice *v14; // [sp+0h] [bp-50h]@2
  int v15; // [sp+8h] [bp-48h]@2
  void *v16; // [sp+10h] [bp-40h]@2
  void *v17; // [sp+18h] [bp-38h]@2
  int v18; // [sp+20h] [bp-30h]@3

  v4 = a4;
  v5 = a3;
  v6 = this;
  v7 = *((_QWORD *)this + 5);
  if ( v7 )
  {
    v14 = v6;
    v15 = a2;
    v16 = a3;
    v17 = a4;
    v8 = 5;
    if ( !(*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IOCharacterDevice *__hidden, OSObject *, void *, void *, void *, void *), __int64 *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v7 + 456LL))(
            v7,
            IOCharacterDevice::deviceCallbackGated,
            &v14,
            0LL,
            0LL,
            0LL) )
      v8 = v18;
  }
  else
  {
    v8 = 6;
    if ( !*((_BYTE *)v6 + 60) )
    {
      v9 = *((_QWORD *)v6 + 6);
      if ( v9 )
        IOLockLock(v9);
      v10 = (char *)*((_QWORD *)v6 + 3);
      v11 = *((_QWORD *)v6 + 4) + *((_QWORD *)v6 + 2);
      if ( (unsigned __int8)v10 & 1 )
        v10 = *(char **)&v10[*(_QWORD *)v11 - 1];
      v8 = ((int (__fastcall *)(__int64, _QWORD, void *, void *))v10)(v11, (unsigned int)a2, v5, v4);
      v12 = *((_QWORD *)v6 + 6);
      if ( v12 )
        IOLockUnlock(v12);
    }
  }
  return (unsigned int)v8;
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);

//----- (000000000000BAF2) ----------------------------------------------------
void __fastcall IOCharacterDevice::willRelease(IOCharacterDevice *this)
{
  *((_BYTE *)this + 60) = 1;
}

//----- (000000000000BAFC) ----------------------------------------------------
__int64 __fastcall IOCharacterDevice::MetaClass::~MetaClass(IOCharacterDevice::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000BB10) ----------------------------------------------------
__int64 `global constructor keyed to'_a_4()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IOCharacterDevice::gMetaClass, "IOCharacterDevice", off_7B030[0], 64LL);
  result = (__int64)off_7C6E0;
  IOCharacterDevice::gMetaClass = off_7C6E0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 7C6E0: using guessed type __int64 (__fastcall *off_7C6E0[2])(IOCharacterDevice::MetaClass *__hidden this);
// 843B8: using guessed type _QWORD IOCharacterDevice::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000BB50) ----------------------------------------------------
__int64 `global destructor keyed to'_a_4()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOCharacterDevice::gMetaClass);
}
// 843B8: using guessed type _QWORD IOCharacterDevice::gMetaClass;

//----- (000000000000BB61) ----------------------------------------------------
__int64 __fastcall hmac_sha256_vector(void *a1, size_t a2, unsigned __int64 a3, __int64 *a4, __int64 *a5, __int64 a6)
{
  __int64 *v6; // r13@1
  __int64 *v7; // rbx@1
  unsigned __int64 v8; // r12@1
  __int64 v9; // r15@1
  __int64 result; // rax@1
  __int64 v11; // r15@5
  __int64 *v12; // rax@8
  __int64 *v13; // rcx@8
  unsigned __int64 v14; // rdx@8
  bool v15; // sf@10
  __int64 v16; // rbx@11
  __int64 v17; // rcx@15
  __int64 v18; // [sp+8h] [bp-108h]@1
  size_t v19; // [sp+10h] [bp-100h]@1
  void *v20; // [sp+18h] [bp-F8h]@1
  __int64 v21; // [sp+20h] [bp-F0h]@7
  __int64 v22; // [sp+28h] [bp-E8h]@8
  __int64 v23; // [sp+50h] [bp-C0h]@7
  __int64 v24; // [sp+58h] [bp-B8h]@8
  char v25; // [sp+80h] [bp-90h]@3
  char v26[64]; // [sp+A0h] [bp-70h]@5
  __int64 v27; // [sp+E0h] [bp-30h]@1

  v18 = a6;
  v6 = a5;
  v7 = a4;
  v8 = a3;
  v9 = off_7B078[0];
  v27 = *(_QWORD *)off_7B078[0];
  v20 = a1;
  v19 = a2;
  result = 0xFFFFFFFFLL;
  if ( a3 <= 5 )
  {
    if ( a2 >= 0x41 )
    {
      if ( (signed int)sha256_vector(1LL, (__int64)&v20, (__int64)&v19, (__int64)&v25) < 0 )
      {
        result = 0xFFFFFFFFLL;
        goto LABEL_15;
      }
      v20 = &v25;
      v19 = 32LL;
    }
    v11 = 0LL;
    memset(v26, 0, 0x40uLL);
    memcpy(v26, v20, v19);
    do
    {
      v26[v11] ^= 0x36u;
      ++v11;
    }
    while ( v11 != 64 );
    v23 = (__int64)v26;
    v21 = 64LL;
    v9 = off_7B078[0];
    if ( v8 )
    {
      v12 = &v22;
      v13 = &v24;
      v14 = v8;
      do
      {
        *v13 = *v7;
        *v12 = *v6;
        ++v7;
        ++v12;
        ++v13;
        ++v6;
        --v14;
      }
      while ( v14 );
    }
    v15 = (signed int)sha256_vector(v8 + 1, (__int64)&v23, (__int64)&v21, v18) < 0;
    result = 0xFFFFFFFFLL;
    if ( !v15 )
    {
      v16 = 0LL;
      memset(v26, 0, 0x40uLL);
      memcpy(v26, v20, v19);
      do
      {
        v26[v16] ^= 0x5Cu;
        ++v16;
      }
      while ( v16 != 64 );
      v23 = (__int64)v26;
      v21 = 64LL;
      v24 = v18;
      v22 = 32LL;
      result = sha256_vector(2LL, (__int64)&v23, (__int64)&v21, v18);
    }
  }
LABEL_15:
  v17 = *(_QWORD *)v9;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// BB61: using guessed type char var_70[64];

//----- (000000000000BD49) ----------------------------------------------------
__int64 __fastcall XX_hmac_sha256(void *a1, size_t a2, __int64 a3, __int64 a4, __int64 a5)
{
  __int64 v6; // [sp+0h] [bp-10h]@1
  __int64 v7; // [sp+8h] [bp-8h]@1

  v7 = a3;
  v6 = a4;
  return hmac_sha256_vector(a1, a2, 1uLL, &v7, &v6, a5);
}

//----- (000000000000BD77) ----------------------------------------------------
__int64 __fastcall IO8LogInit(__int64 a1, __int64 a2)
{
  __int64 v2; // rax@2
  __int64 v3; // rax@4
  __int64 v4; // rax@6
  signed int v5; // ebx@16

  if ( !_logDevLock )
  {
    LODWORD(v2) = IOLockAlloc(a1);
    _logDevLock = v2;
    if ( !v2 )
      goto LABEL_17;
  }
  if ( !_logDevMTLock )
  {
    LODWORD(v3) = IOLockAlloc(a1);
    _logDevMTLock = v3;
    if ( !v3 )
      goto LABEL_17;
  }
  if ( !_logDevTempLock )
  {
    LODWORD(v4) = IOLockAlloc(a1);
    _logDevTempLock = v4;
    if ( !v4 )
      goto LABEL_17;
  }
  IOLockLock(_logDevLock);
  if ( _logDev )
  {
    (*(void (__cdecl **)(LogManagerDevice *))(*(_QWORD *)_logDev + 32LL))(_logDev);
LABEL_10:
    IOLockUnlock(_logDevLock);
    IOLockLock(_logDevMTLock);
    if ( _logDevMT )
    {
      (*(void (__cdecl **)(LogManagerDevice *))(*(_QWORD *)_logDevMT + 32LL))(_logDevMT);
LABEL_13:
      IOLockUnlock(_logDevMTLock);
      IOLockLock(_logDevTempLock);
      if ( _logDevTemp )
      {
        (*(void (__cdecl **)(LogManagerDevice *))(*(_QWORD *)_logDevTemp + 32LL))(_logDevTemp);
LABEL_16:
        IOLockUnlock(_logDevTempLock);
        v5 = 0;
        return (unsigned int)v5;
      }
      a2 = _logDevTempLock;
      _logDevTemp = (LogManagerDevice *)LogManagerDevice::withDeviceNameAndLock(
                                          "io8logtemp",
                                          _logDevTempLock,
                                          1059,
                                          438);
      if ( _logDevTemp )
        goto LABEL_16;
      goto LABEL_17;
    }
    a2 = _logDevMTLock;
    _logDevMT = (LogManagerDevice *)LogManagerDevice::withDeviceNameAndLock("io8logmt", _logDevMTLock, 1057, 292);
    if ( _logDevMT )
      goto LABEL_13;
LABEL_17:
    if ( _logDev )
    {
      (*(void (__cdecl **)(LogManagerDevice *))(*(_QWORD *)_logDev + 40LL))(_logDev);
      _logDev = 0LL;
    }
    goto LABEL_19;
  }
  a2 = _logDevLock;
  _logDev = (LogManagerDevice *)LogManagerDevice::withDeviceNameAndLock("io8log", _logDevLock, 1059, 438);
  if ( _logDev )
    goto LABEL_10;
LABEL_19:
  if ( _logDevLock )
  {
    IOLockFree(_logDevLock);
    _logDevLock = 0LL;
  }
  if ( _logDevMT )
  {
    (*(void (__fastcall **)(LogManagerDevice *, __int64))(*(_QWORD *)_logDevMT + 40LL))(_logDevMT, a2);
    _logDevMT = 0LL;
  }
  if ( _logDevMTLock )
  {
    IOLockFree(_logDevMTLock);
    _logDevMTLock = 0LL;
  }
  if ( _logDevTemp )
  {
    (*(void (__fastcall **)(LogManagerDevice *, __int64))(*(_QWORD *)_logDevTemp + 40LL))(_logDevTemp, a2);
    _logDevTemp = 0LL;
  }
  v5 = 12;
  if ( _logDevTempLock )
  {
    IOLockFree(_logDevTempLock);
    _logDevTempLock = 0LL;
  }
  return (unsigned int)v5;
}
// 84E48: using guessed type _QWORD _logDevLock;
// 84E50: using guessed type _QWORD _logDevMTLock;
// 84E58: using guessed type _QWORD _logDevTempLock;
// C76F0: using guessed type int __cdecl IOLockAlloc(_QWORD);
// C76F8: using guessed type int __fastcall IOLockFree(_QWORD);
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);

//----- (000000000000BF9D) ----------------------------------------------------
int IO8LogDeinit()
{
  int v0; // ebx@2
  int result; // eax@2
  int v2; // ebx@5
  int v3; // ebx@8

  if ( _logDevLock )
  {
    LogManagerDevice::willRelease(_logDev);
    IOLockLock(_logDevLock);
    v0 = (*(int (__cdecl **)(LogManagerDevice *))(*(_QWORD *)_logDev + 24LL))(_logDev);
    result = (*(int (__cdecl **)(LogManagerDevice *))(*(_QWORD *)_logDev + 40LL))(_logDev);
    if ( v0 == 1 )
    {
      _logDev = 0LL;
      result = IOLockFree(_logDevLock);
      _logDevLock = 0LL;
    }
  }
  if ( _logDevMTLock )
  {
    LogManagerDevice::willRelease(_logDevMT);
    IOLockLock(_logDevMTLock);
    v2 = (*(int (__cdecl **)(LogManagerDevice *))(*(_QWORD *)_logDevMT + 24LL))(_logDevMT);
    result = (*(int (__cdecl **)(LogManagerDevice *))(*(_QWORD *)_logDevMT + 40LL))(_logDevMT);
    if ( v2 == 1 )
    {
      _logDevMT = 0LL;
      result = IOLockFree(_logDevMTLock);
      _logDevMTLock = 0LL;
    }
  }
  if ( _logDevTempLock )
  {
    LogManagerDevice::willRelease(_logDevTemp);
    IOLockLock(_logDevTempLock);
    v3 = (*(int (__cdecl **)(LogManagerDevice *))(*(_QWORD *)_logDevTemp + 24LL))(_logDevTemp);
    result = (*(int (__cdecl **)(LogManagerDevice *))(*(_QWORD *)_logDevTemp + 40LL))(_logDevTemp);
    if ( v3 == 1 )
    {
      _logDevTemp = 0LL;
      result = IOLockFree(_logDevTempLock);
      _logDevTempLock = 0LL;
    }
  }
  return result;
}
// 84E48: using guessed type _QWORD _logDevLock;
// 84E50: using guessed type _QWORD _logDevMTLock;
// 84E58: using guessed type _QWORD _logDevTempLock;
// C76F8: using guessed type int __fastcall IOLockFree(_QWORD);
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);

//----- (000000000000C0D9) ----------------------------------------------------
__int64 __fastcall IO8Log(const char *a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, char a7)
{
  __int64 v7; // rbx@1
  char v9; // [sp+0h] [bp-60h]@1
  __int64 v10; // [sp+8h] [bp-58h]@1
  __int64 v11; // [sp+10h] [bp-50h]@1
  __int64 v12; // [sp+18h] [bp-48h]@1
  __int64 v13; // [sp+20h] [bp-40h]@1
  __int64 v14; // [sp+28h] [bp-38h]@1
  va_list v15; // [sp+30h] [bp-30h]@1
  __int64 v16; // [sp+50h] [bp-10h]@1

  v14 = a6;
  v13 = a5;
  v12 = a4;
  v11 = a3;
  v10 = a2;
  v7 = off_7B078[0];
  v16 = *(_QWORD *)off_7B078[0];
  v15[0].reg_save_area = &v9;
  v15[0].overflow_arg_area = &a7;
  v15[0].fp_offset = 48;
  v15[0].gp_offset = 8;
  _vlog(a1, v15, 1, 0LL, 0);
  return *(_QWORD *)v7;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000000C14A) ----------------------------------------------------
__int64 __fastcall _vlog(const char *a1, struct __va_list_tag *__attribute__((__org_typedef(va_list))) a2, char a3, void *a4, unsigned int a5)
{
  unsigned int v5; // er15@1
  void *v6; // r12@1
  char v7; // bl@1
  const char *v8; // r13@1
  __int64 v9; // rdx@2
  __int64 v10; // rcx@2
  __int64 v11; // r8@2
  __int64 v12; // r9@2
  const char *v13; // r14@3
  size_t v14; // rax@4
  size_t v15; // rbx@4
  char *v16; // rax@4
  signed int v17; // er15@4
  size_t v18; // rax@5
  signed __int64 v19; // rbx@5
  unsigned int v21; // [sp+4h] [bp-3Ch]@4
  signed __int64 v22; // [sp+8h] [bp-38h]@4

  v5 = a5;
  v6 = a4;
  v7 = a3;
  v8 = a1;
  if ( _logDevLock )
  {
    IOLockLock(_logDevLock);
    if ( !v6 )
    {
      if ( !v7 || (v17 = LogManager::log(_logDev, "<kernel> ", v9, v10, v11, v12)) == 0 )
        v17 = LogManager::vlog(_logDev, a1, a2);
      goto LABEL_13;
    }
    v13 = 0LL;
    if ( !v7 )
    {
      v19 = 0LL;
LABEL_11:
      v17 = LogManager::vlogBlock(_logDev, v8, a2, v6, v5);
      if ( v13 )
        IOFree(v13, v19);
LABEL_13:
      IOLockUnlock(_logDevLock);
      return (unsigned int)v17;
    }
    v21 = v5;
    v14 = strlen(a1);
    v15 = v14;
    v22 = v14 + 10;
    LODWORD(v16) = IOMalloc(v14 + 10);
    v13 = v16;
    v17 = 12;
    if ( v16 )
    {
      strncpy(v16, "<kernel> ", v22);
      v18 = strlen(v13);
      strncat((char *)v13, a1, v15 + 9 - v18);
      v8 = v13;
      v5 = v21;
      v19 = v22;
      goto LABEL_11;
    }
  }
  else
  {
    IOLogv(a1);
    v17 = 6;
  }
  return (unsigned int)v17;
}
// 84E48: using guessed type _QWORD _logDevLock;
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C7730: using guessed type int __fastcall IOLogv(_QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000000C298) ----------------------------------------------------
__int64 __fastcall IO8Logq(const char *a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, char a7)
{
  __int64 v7; // rbx@1
  char v9; // [sp+0h] [bp-60h]@1
  __int64 v10; // [sp+8h] [bp-58h]@1
  __int64 v11; // [sp+10h] [bp-50h]@1
  __int64 v12; // [sp+18h] [bp-48h]@1
  __int64 v13; // [sp+20h] [bp-40h]@1
  __int64 v14; // [sp+28h] [bp-38h]@1
  va_list v15; // [sp+30h] [bp-30h]@1
  __int64 v16; // [sp+50h] [bp-10h]@1

  v14 = a6;
  v13 = a5;
  v12 = a4;
  v11 = a3;
  v10 = a2;
  v7 = off_7B078[0];
  v16 = *(_QWORD *)off_7B078[0];
  v15[0].reg_save_area = &v9;
  v15[0].overflow_arg_area = &a7;
  v15[0].fp_offset = 48;
  v15[0].gp_offset = 8;
  _vlog(a1, v15, 0, 0LL, 0);
  return *(_QWORD *)v7;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000000C306) ----------------------------------------------------
__int64 __fastcall IO8LogBlock(void *a1, unsigned int a2, char *a3, __int64 a4, __int64 a5, __int64 a6, char a7)
{
  __int64 v7; // rbx@1
  __int64 result; // rax@1
  __int64 v9; // rcx@1
  char v10; // [sp+0h] [bp-60h]@1
  __int64 v11; // [sp+18h] [bp-48h]@1
  __int64 v12; // [sp+20h] [bp-40h]@1
  __int64 v13; // [sp+28h] [bp-38h]@1
  va_list v14; // [sp+30h] [bp-30h]@1
  __int64 v15; // [sp+50h] [bp-10h]@1

  v13 = a6;
  v12 = a5;
  v11 = a4;
  v7 = off_7B078[0];
  v15 = *(_QWORD *)off_7B078[0];
  v14[0].reg_save_area = &v10;
  v14[0].overflow_arg_area = &a7;
  v14[0].fp_offset = 48;
  v14[0].gp_offset = 24;
  result = _vlog(a3, v14, 1, a1, a2);
  v9 = *(_QWORD *)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000000C37C) ----------------------------------------------------
__int64 __fastcall IO8LogqBlock(void *a1, unsigned int a2, char *a3, __int64 a4, __int64 a5, __int64 a6, char a7)
{
  __int64 v7; // rbx@1
  __int64 result; // rax@1
  __int64 v9; // rcx@1
  char v10; // [sp+0h] [bp-60h]@1
  __int64 v11; // [sp+18h] [bp-48h]@1
  __int64 v12; // [sp+20h] [bp-40h]@1
  __int64 v13; // [sp+28h] [bp-38h]@1
  va_list v14; // [sp+30h] [bp-30h]@1
  __int64 v15; // [sp+50h] [bp-10h]@1

  v13 = a6;
  v12 = a5;
  v11 = a4;
  v7 = off_7B078[0];
  v15 = *(_QWORD *)off_7B078[0];
  v14[0].reg_save_area = &v10;
  v14[0].overflow_arg_area = &a7;
  v14[0].fp_offset = 48;
  v14[0].gp_offset = 24;
  result = _vlog(a3, v14, 0, a1, a2);
  v9 = *(_QWORD *)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000000C3EF) ----------------------------------------------------
__int64 __fastcall IO8Logv(const char *a1, struct __va_list_tag *a2)
{
  return _vlog(a1, a2, 1, 0LL, 0);
}

//----- (000000000000C403) ----------------------------------------------------
__int64 __fastcall IO8Logvq(const char *a1, struct __va_list_tag *a2)
{
  return _vlog(a1, a2, 0, 0LL, 0);
}

//----- (000000000000C414) ----------------------------------------------------
__int64 __fastcall IO8Logh(unsigned __int8 *a1, unsigned __int64 a2, char *a3, __int64 a4, __int64 a5, __int64 a6, char a7)
{
  char *v7; // rbx@1
  __int64 v8; // r12@1
  __int64 v9; // rdx@2
  __int64 v10; // rcx@2
  __int64 v11; // r8@2
  __int64 v12; // r9@2
  char v14; // [sp+0h] [bp-70h]@4
  __int64 v15; // [sp+18h] [bp-58h]@1
  __int64 v16; // [sp+20h] [bp-50h]@1
  __int64 v17; // [sp+28h] [bp-48h]@1
  __va_list_tag v18; // [sp+30h] [bp-40h]@4
  __int64 v19; // [sp+48h] [bp-28h]@1

  v7 = a3;
  v17 = a6;
  v16 = a5;
  v15 = a4;
  v8 = off_7B078[0];
  v19 = *(_QWORD *)off_7B078[0];
  if ( _logDevLock )
  {
    IOLockLock(_logDevLock);
    if ( v7 )
      LogManager::log(_logDev, "<kernel> ", v9, v10, v11, v12);
    v18.reg_save_area = &v14;
    v18.overflow_arg_area = &a7;
    v18.fp_offset = 48;
    v18.gp_offset = 24;
    LogManager::hlog(_logDev, a1, a2, v7, &v18, v12);
    IOLockUnlock(_logDevLock);
  }
  return *(_QWORD *)v8;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 84E48: using guessed type _QWORD _logDevLock;
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);

//----- (000000000000C4D1) ----------------------------------------------------
int __fastcall IO8Loghv(unsigned __int8 *a1, unsigned __int64 a2, char *a3, __va_list_tag *a4)
{
  __va_list_tag *v4; // r14@1
  char *v5; // rbx@1
  __int64 v6; // rdx@2
  __int64 v7; // rcx@2
  __int64 v8; // r8@2
  __int64 v9; // r9@2
  int result; // eax@4

  v4 = a4;
  v5 = a3;
  if ( _logDevLock )
  {
    IOLockLock(_logDevLock);
    if ( v5 )
      LogManager::log(_logDev, "<kernel> ", v6, v7, v8, v9);
    LogManager::hlog(_logDev, a1, a2, v5, v4, v9);
    result = IOLockUnlock(_logDevLock);
  }
  return result;
}
// 84E48: using guessed type _QWORD _logDevLock;
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);

//----- (000000000000C548) ----------------------------------------------------
void __fastcall IO8LogMT(const char *a1, const char **a2, const char **a3, int a4)
{
  int v4; // ebx@1
  const char **v5; // r12@1
  size_t v6; // r13@2
  int v7; // er14@3
  const char **v8; // r15@3
  const char **v9; // r12@3
  int v10; // ebx@4
  void *v11; // rax@7
  void *v12; // r14@7
  size_t v13; // rsi@7
  int v14; // ecx@7
  int v15; // er13@7
  signed __int64 v16; // r12@7
  const char **v17; // rbx@7
  int v18; // ST10_4@8
  void *v19; // ST00_8@8
  size_t v20; // r14@8
  void *v21; // r14@9
  const char **v22; // ST30_8@10
  int v23; // ST2C_4@10
  const char *v24; // r13@10
  size_t v25; // r15@10
  signed __int64 v26; // r13@10
  const char *v27; // r12@10
  size_t v28; // rbx@10
  unsigned __int8 *v29; // [sp+10h] [bp-50h]@8
  void *v30; // [sp+20h] [bp-40h]@3
  int v31; // [sp+2Ch] [bp-34h]@3
  const char **v32; // [sp+30h] [bp-30h]@2

  v4 = a4;
  v5 = a3;
  if ( a1 )
  {
    v32 = a2;
    v6 = strlen(a1) + 1;
    if ( v4 )
    {
      v31 = v4;
      v7 = v4;
      v8 = v5;
      v30 = v5;
      v9 = a2;
      do
      {
        v10 = v6 + strlen(*v9) + 1;
        v6 = strlen(*v8) + (v10 & 0xFFFFFFFF) + 1;
        ++v9;
        ++v8;
        --v7;
      }
      while ( v7 );
    }
    else
    {
      v30 = v5;
      v31 = 0;
    }
    LODWORD(v11) = IOMalloc(((unsigned int)v6 & 0xFFFFFFFF) + 8LL);
    v12 = v11;
    v13 = ((unsigned int)v6 & 0xFFFFFFFF) + 8LL;
    v14 = v6;
    v15 = v31;
    v16 = (signed __int64)v30;
    v17 = v32;
    if ( v11 )
    {
      v18 = v14;
      bzero(v11, v13);
      *(_DWORD *)v12 = v18;
      *((_DWORD *)v12 + 1) = v31;
      v19 = (char *)v12 + 8;
      v29 = (unsigned __int8 *)v12;
      v20 = strlen(a1);
      memcpy(v19, a1, v20);
      if ( v31 )
      {
        v21 = &v29[v20 + 9];
        do
        {
          v22 = v17;
          v23 = v15;
          v24 = *v17;
          v25 = strlen(*v17);
          memcpy(v21, v24, v25);
          v26 = v16;
          v27 = *(const char **)v16;
          v28 = strlen(v27);
          memcpy((char *)v21 + v25 + 1, v27, v28);
          v21 = (char *)v21 + v28 + v25 + 2;
          v17 = v22 + 1;
          v16 = v26 + 8;
          v15 = v23 - 1;
        }
        while ( v23 != 1 );
      }
      if ( _logDevMTLock )
      {
        IOLockLock(_logDevMTLock);
        LogManager::blog(_logDevMT, v29, v13);
        IOLockUnlock(_logDevMTLock);
      }
      IOFree(v29, v13);
    }
  }
}
// 84E50: using guessed type _QWORD _logDevMTLock;
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000000C71D) ----------------------------------------------------
int __fastcall net80211_ioctl(__int64 a1, __int64 a2, IO80211Controller *a3, __int64 a4)
{
  __int64 v4; // r15@1
  IO80211Controller *v5; // r14@1
  __int64 v6; // rbx@1
  __int64 v7; // r13@1
  __int16 v8; // cx@1
  int result; // eax@1
  signed int v10; // edx@3
  int v11; // eax@7
  char *v12; // rdx@8
  __int64 v13; // rdx@14
  const void *v14; // rsi@14
  __int64 v15; // rcx@14
  int v16; // edx@16
  signed int v17; // eax@19
  int v18; // eax@25
  signed int v19; // eax@29
  int v20; // ecx@37
  __int64 v21; // rax@38
  __int64 *v22; // r8@38
  int v23; // eax@39
  signed __int16 v24; // cx@39
  signed int v25; // ecx@45
  int v26; // eax@47
  int v27; // ecx@47
  signed int v28; // edx@47
  int v29; // eax@49
  char *v30; // rcx@49
  char *v31; // rdx@49
  int v32; // esi@49
  int v33; // edi@50
  int v34; // esi@50
  bool v35; // zf@54
  unsigned int v36; // esi@54
  int v37; // edi@56
  int v38; // ecx@74
  __int64 v39; // rcx@80
  __int64 v40; // [sp+8h] [bp-18C8h]@37
  __int64 v41; // [sp+10h] [bp-18C0h]@37
  __int64 v42; // [sp+18h] [bp-18B8h]@19
  __int64 v43; // [sp+20h] [bp-18B0h]@19
  int v44; // [sp+28h] [bp-18A8h]@18
  unsigned __int8 v45; // [sp+2Eh] [bp-18A2h]@19
  __int64 v46; // [sp+38h] [bp-1898h]@39
  __int64 v47; // [sp+40h] [bp-1890h]@39
  int v48; // [sp+48h] [bp-1888h]@6
  int v49; // [sp+4Ch] [bp-1884h]@7
  char v50; // [sp+54h] [bp-187Ch]@8
  int v51; // [sp+650h] [bp-1280h]@43
  char v52; // [sp+65Ah] [bp-1276h]@49
  int v53; // [sp+1248h] [bp-688h]@43
  int v54; // [sp+124Ch] [bp-684h]@44
  char v55; // [sp+1258h] [bp-678h]@49
  __int64 v56; // [sp+1850h] [bp-80h]@28
  int v57; // [sp+1858h] [bp-78h]@28
  __int64 v58; // [sp+1860h] [bp-70h]@28
  __int64 v59; // [sp+1868h] [bp-68h]@28
  __int64 v60; // [sp+1870h] [bp-60h]@7
  __int64 v61; // [sp+1878h] [bp-58h]@7
  __int64 v62; // [sp+1880h] [bp-50h]@7
  __int64 v63; // [sp+1888h] [bp-48h]@7
  __int64 v64; // [sp+1890h] [bp-40h]@69
  __int64 v65; // [sp+1898h] [bp-38h]@69
  __int64 v66; // [sp+18A0h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v6 = a1;
  v7 = off_7B078[0];
  v66 = *(_QWORD *)off_7B078[0];
  v8 = *(_WORD *)(a1 + 20);
  result = 22;
  if ( v8 < 0 )
    goto LABEL_80;
  result = 102;
  if ( a2 != 3223349707LL )
  {
    if ( a2 != 2149607882LL )
      goto LABEL_80;
    v16 = *(_WORD *)(a1 + 16);
    if ( v16 != 80 )
    {
      if ( v16 != 9 )
        goto LABEL_80;
      v41 = 0LL;
      v40 = 1LL;
      v20 = *(_WORD *)(a1 + 18);
      result = 0;
      if ( (unsigned __int16)(*(_WORD *)(a1 + 18) + 1) < 2u )
        goto LABEL_80;
      HIDWORD(v41) = 8 * ((unsigned __int16)(v20 - 1) > 0xDu) + 10;
      LODWORD(v41) = v20;
      v21 = *(_QWORD *)v5;
      v22 = &v40;
LABEL_68:
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(v21 + 3216))(
                 v5,
                 2150132168LL,
                 4LL,
                 v4,
                 v22);
      goto LABEL_80;
    }
    result = 22;
    if ( v8 != 12 )
      goto LABEL_80;
    result = IO80211Controller::copyIn(v5, *(_QWORD *)(a1 + 24), &v44, 12LL);
    if ( result )
      goto LABEL_80;
    v42 = 1LL;
    v43 = v45;
    v17 = 0;
    if ( v44 & 0x80 )
    {
      HIDWORD(v43) = 8;
      v17 = 8;
    }
    if ( BYTE1(v44) & 1 )
    {
      v17 |= 0x10u;
      HIDWORD(v43) = v17;
    }
    if ( v44 & 0x60000 )
    {
      HIDWORD(v43) = v17 | 4;
      if ( !(v44 & 0x20000) )
      {
LABEL_67:
        v21 = *(_QWORD *)v5;
        v22 = &v42;
        goto LABEL_68;
      }
      v18 = v17 | 0x204;
    }
    else
    {
      v18 = v17 | 2;
    }
    HIDWORD(v43) = v18;
    goto LABEL_67;
  }
  v10 = *(_WORD *)(a1 + 16);
  if ( v10 > 79 )
  {
    if ( v10 == 80 )
    {
      result = 22;
      if ( v8 == 12 )
      {
        v59 = 0LL;
        v58 = 1LL;
        v57 = 0;
        v56 = 0LL;
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)v5 + 3216LL))(
                   v5,
                   3223873993LL,
                   4LL,
                   v4,
                   &v58);
        if ( !result )
        {
          v19 = 0;
          if ( BYTE4(v59) & 8 )
          {
            LODWORD(v56) = 224;
            v19 = 224;
          }
          if ( BYTE4(v59) & 0x10 )
          {
            v19 |= 0x140u;
            LODWORD(v56) = v19;
          }
          if ( BYTE4(v59) & 4 )
          {
            if ( BYTE5(v59) & 2 )
            {
              LODWORD(v56) = v19 | 0x20000;
              BYTE3(v57) = v59 + 4;
            }
            else
            {
              LODWORD(v56) = v19 | 0x40000;
              BYTE3(v57) = v59 - 4;
            }
          }
          else
          {
            v65 = 0LL;
            v64 = 1LL;
            if ( !(*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)v5 + 3216LL))(
                    v5,
                    3223873993LL,
                    66LL,
                    v4,
                    &v64) )
              BYTE2(v56) |= 1u;
          }
          BYTE6(v56) = v59;
          if ( BYTE4(v59) & 8 )
          {
            if ( (unsigned int)v59 > 0xD )
            {
              LOWORD(v38) = 2484;
              if ( (_DWORD)v59 != 14 )
                v38 = 20 * v59 + 2212;
            }
            else
            {
              v38 = 5 * v59 + 2407;
            }
          }
          else
          {
            v38 = 5 * v59 + 5000;
          }
          WORD2(v56) = v38;
          v13 = *(_QWORD *)(a1 + 24);
          v15 = *(_WORD *)(a1 + 20);
          v14 = &v56;
          goto LABEL_79;
        }
      }
    }
  }
  else
  {
    switch ( v10 )
    {
      case 9:
        v47 = 0LL;
        v46 = 1LL;
        v23 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, _QWORD, __int64 *))(*(_QWORD *)v5 + 3216LL))(
                v5,
                3223873993LL,
                4LL,
                v4,
                &v46);
        v24 = -1;
        if ( !v23 )
          v24 = v47;
        *(_WORD *)(a1 + 18) = v24;
        result = 0;
        break;
      case 27:
        __bzero(&v48, 1544LL);
        v48 = 1;
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)v5 + 3216LL))(
                   v5,
                   3223873993LL,
                   27LL,
                   v4,
                   &v48);
        if ( !result )
        {
          v63 = 0LL;
          v62 = 0LL;
          v61 = 0LL;
          v60 = 0LL;
          v11 = v49;
          if ( v49 )
          {
            v12 = &v50;
            do
            {
              if ( *(_DWORD *)v12 <= 0xFFu )
                *((_BYTE *)&v60 + (*(_DWORD *)v12 >> 3)) |= 1 << (*(_DWORD *)v12 & 7);
              v12 += 12;
              --v11;
            }
            while ( v11 );
          }
          if ( (unsigned int)*(_WORD *)(a1 + 20) >= 0x21 )
            *(_WORD *)(a1 + 20) = 32;
          v13 = *(_QWORD *)(a1 + 24);
          v14 = &v60;
          v15 = 32LL;
LABEL_79:
          result = IO80211Controller::copyOut(v5, v14, v13, v15);
          break;
        }
        break;
      case 42:
        __bzero(&v53, 1544LL);
        v53 = 1;
        __bzero(&v51, 3064LL);
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)v5 + 3216LL))(
                   v5,
                   3223873993LL,
                   27LL,
                   v4,
                   &v53);
        if ( !result )
        {
          v15 = 4LL;
          if ( v54 )
          {
            v25 = -2;
            if ( !v54 )
              v25 = -1;
            v26 = v54 + v25 + 256;
            v27 = v54 + v25 + 1;
            v28 = 254;
            if ( (unsigned int)v27 > 0xFE )
              v28 = v27;
            v29 = v26 - v28;
            v30 = &v52;
            v31 = &v55;
            v32 = 0;
            do
            {
              v51 = v32 + 1;
              v33 = *(_DWORD *)v31;
              v34 = *(_DWORD *)v31 & 8;
              if ( v34 )
                *(v30 - 6) |= 0xE0u;
              if ( v33 & 0x10 )
                *(_DWORD *)(v30 - 6) |= 0x140u;
              v35 = v34 == 0;
              v36 = *((_DWORD *)v31 - 1);
              if ( v35 )
              {
                v37 = 5 * v36 + 5000;
              }
              else if ( v36 > 0xD )
              {
                LOWORD(v37) = 2484;
                if ( v36 != 14 )
                  v37 = 20 * v36 + 2212;
              }
              else
              {
                v37 = 5 * v36 + 2407;
              }
              *((_WORD *)v30 - 1) = v37;
              *v30 = v36;
              v32 = v51;
              v30 += 12;
              v31 += 12;
              --v29;
            }
            while ( v29 );
            v15 = 12LL * (unsigned int)v51 + 4;
          }
          if ( v15 > (unsigned __int64)*(_WORD *)(v6 + 20) )
            v15 = *(_WORD *)(v6 + 20);
          v13 = *(_QWORD *)(v6 + 24);
          v14 = &v51;
          goto LABEL_79;
        }
        break;
    }
  }
LABEL_80:
  v39 = *(_QWORD *)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (000000000000CCB2) ----------------------------------------------------
int __fastcall getSSID(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@2
  unsigned int v7; // ecx@5
  __int64 v8; // rcx@8
  __int64 v9; // [sp+8h] [bp-48h]@1
  __int64 v10; // [sp+10h] [bp-40h]@1
  __int64 v11; // [sp+18h] [bp-38h]@1
  __int64 v12; // [sp+20h] [bp-30h]@1
  __int64 v13; // [sp+28h] [bp-28h]@1
  __int64 v14; // [sp+30h] [bp-20h]@1

  v4 = a4;
  v5 = off_7B078[0];
  v14 = *(_QWORD *)off_7B078[0];
  v13 = 0LL;
  v12 = 0LL;
  v11 = 0LL;
  v10 = 0LL;
  v9 = 0LL;
  LODWORD(v9) = 1;
  if ( a3 )
    result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
               this,
               3223873993LL,
               1LL,
               a3,
               &v9);
  else
    result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
               this,
               3223873993LL,
               1LL,
               a2,
               &v9);
  if ( !result )
  {
    v7 = HIDWORD(v9);
    if ( *(_DWORD *)(v4 + 24) < HIDWORD(v9) )
      v7 = *(_DWORD *)(v4 + 24);
    *(_DWORD *)(v4 + 24) = v7;
    result = IO80211Controller::copyOut(this, &v10, *(_QWORD *)(v4 + 32), v7);
  }
  v8 = *(_QWORD *)v5;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000000CD86) ----------------------------------------------------
int __fastcall getAuthType(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+0h] [bp-20h]@1
  int v8; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v8 = 0;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    2LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            2LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 12LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0xC )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (000000000000CE2E) ----------------------------------------------------
int __fastcall getChannel(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+0h] [bp-20h]@1
  __int64 v8; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v8 = 0LL;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    4LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            4LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 16LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x10 )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (000000000000CED8) ----------------------------------------------------
int __fastcall getPowersave(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@2
  __int64 v6; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v6 = 1LL;
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               3223873993LL,
               5LL,
               a3,
               &v6);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               5LL,
               a2,
               &v6);
  if ( !result )
  {
    *(_DWORD *)(v4 + 20) = HIDWORD(v6);
    result = 0;
  }
  return result;
}

//----- (000000000000CF42) ----------------------------------------------------
int __fastcall getProtMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@5
  __int64 v7; // [sp+0h] [bp-20h]@1
  int v8; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v8 = 0;
  v7 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = 22;
    if ( *(_DWORD *)(a4 + 24) )
    {
      if ( *(_QWORD *)(a4 + 32) )
      {
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                   this,
                   3223873993LL,
                   6LL,
                   a2,
                   &v7);
        if ( !result )
        {
          v6 = 12LL;
          if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0xC )
            v6 = *(_DWORD *)(v4 + 24);
          result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
        }
      }
    }
  }
  return result;
}

//----- (000000000000CFCD) ----------------------------------------------------
int __fastcall getTxPower(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  signed int v6; // ecx@3
  __int64 v7; // [sp+0h] [bp-20h]@1
  int v8; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v8 = 0;
  v7 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
               this,
               3223873993LL,
               7LL,
               a2,
               &v7);
    if ( !result )
    {
      v6 = 12;
      if ( *(_DWORD *)(v4 + 24) < 0xCu )
        v6 = *(_DWORD *)(v4 + 24);
      *(_DWORD *)(v4 + 24) = v6;
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), (unsigned int)v6);
    }
  }
  return result;
}

//----- (000000000000D049) ----------------------------------------------------
int __fastcall getRate(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@2
  __int64 v6; // [sp+8h] [bp-28h]@1
  __int64 v7; // [sp+10h] [bp-20h]@1
  __int64 v8; // [sp+18h] [bp-18h]@1

  v4 = a4;
  v8 = 0LL;
  v7 = 0LL;
  v6 = 1LL;
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               3223873993LL,
               8LL,
               a3,
               &v6);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               8LL,
               a2,
               &v6);
  if ( !result )
  {
    *(_DWORD *)(v4 + 20) = v7;
    result = 0;
  }
  return result;
}

//----- (000000000000D0CC) ----------------------------------------------------
int __fastcall getBSSID(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  signed int v6; // ecx@6
  __int64 v7; // [sp+0h] [bp-20h]@1
  int v8; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v8 = 0;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) >= 6u )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    9LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            9LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 6;
      if ( *(_DWORD *)(v4 + 24) < 6u )
        v6 = *(_DWORD *)(v4 + 24);
      *(_DWORD *)(v4 + 24) = v6;
      result = IO80211Controller::copyOut(this, (char *)&v7 + 4, *(_QWORD *)(v4 + 32), (unsigned int)v6);
    }
  }
  return result;
}

//----- (000000000000D170) ----------------------------------------------------
__int64 __fastcall getScanResult(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4, char a5)
{
  char v5; // r12@1
  __int64 v6; // rbx@1
  IO80211Controller *v7; // r15@1
  __int64 v8; // r13@1
  __int64 result; // rax@1
  int v10; // ecx@2
  __int64 v11; // rdi@7
  __int64 v12; // r14@9
  __int64 v13; // rbx@9
  unsigned int v14; // er12@11
  const void *v15; // rsi@14
  __int64 v16; // rcx@14
  unsigned int v17; // er12@16
  __int64 v18; // rcx@21
  __int64 v19; // [sp+0h] [bp-160h]@8
  int v20; // [sp+8h] [bp-158h]@15
  char v21; // [sp+Ch] [bp-154h]@16
  char v22; // [sp+24h] [bp-13Ch]@16
  char v23; // [sp+2Ch] [bp-134h]@16
  char v24; // [sp+69h] [bp-F7h]@16
  int v25; // [sp+8Ch] [bp-D4h]@16
  char v26; // [sp+90h] [bp-D0h]@16
  unsigned __int16 v27; // [sp+92h] [bp-CEh]@16
  unsigned __int64 v28; // [sp+94h] [bp-CCh]@10
  char v29; // [sp+9Ch] [bp-C4h]@11
  char v30; // [sp+B4h] [bp-ACh]@11
  char v31; // [sp+BCh] [bp-A4h]@11
  char v32; // [sp+F9h] [bp-67h]@11
  int v33; // [sp+11Ch] [bp-44h]@11
  char v34; // [sp+120h] [bp-40h]@11
  unsigned __int16 v35; // [sp+122h] [bp-3Eh]@11
  unsigned __int64 v36; // [sp+128h] [bp-38h]@13
  __int64 v37; // [sp+130h] [bp-30h]@1

  v5 = a5;
  v6 = a4;
  v7 = this;
  v8 = off_7B078[0];
  v37 = *(_QWORD *)off_7B078[0];
  result = 102LL;
  if ( a2 )
  {
    v10 = *(_DWORD *)(a4 + 24);
    result = 22LL;
    if ( a5 )
    {
      if ( v10 != 152 )
        goto LABEL_21;
    }
    else if ( v10 != 144 )
    {
      goto LABEL_21;
    }
    result = 22LL;
    if ( *(_QWORD *)(v6 + 32) )
    {
      v11 = *(_QWORD *)(a2 + 496);
      result = 6LL;
      if ( v11 )
      {
        result = IO80211ScanManager::getScanResult(v11, (__int64)&v19);
        if ( !(_DWORD)result )
        {
          v12 = *(_QWORD *)(v6 + 32);
          v13 = v19;
          if ( v5 )
          {
            result = IO80211Controller::copyIn(v7, v12, (char *)&v28 + 4, 152LL);
            if ( !(_DWORD)result )
            {
              HIDWORD(v28) = *(_DWORD *)v13;
              memcpy(&v29, (const void *)(v13 + 4), 0x18uLL);
              memcpy(&v30, (const void *)(v13 + 28), 7uLL);
              memcpy(&v31, (const void *)(v13 + 36), 0x3DuLL);
              memcpy(&v32, (const void *)(v13 + 97), 0x20uLL);
              v33 = *(_DWORD *)(v13 + 132);
              memcpy(&v34, (const void *)(v13 + 136), 1uLL);
              v14 = *(_WORD *)(v13 + 138);
              if ( v35 < v14 )
                LOWORD(v14) = v35;
              result = IO80211Controller::copyOut(v7, *(const void **)(v13 + 144), v36, (unsigned __int16)v14);
              if ( !(_DWORD)result )
              {
                v35 = v14;
                v15 = (char *)&v28 + 4;
                v16 = 152LL;
LABEL_20:
                result = IO80211Controller::copyOut(v7, v15, v12, v16);
                goto LABEL_21;
              }
            }
          }
          else
          {
            result = IO80211Controller::copyIn(v7, v12, &v20, 144LL);
            if ( !(_DWORD)result )
            {
              v20 = *(_DWORD *)v13;
              memcpy(&v21, (const void *)(v13 + 4), 0x18uLL);
              memcpy(&v22, (const void *)(v13 + 28), 7uLL);
              memcpy(&v23, (const void *)(v13 + 36), 0x3DuLL);
              memcpy(&v24, (const void *)(v13 + 97), 0x20uLL);
              v25 = *(_DWORD *)(v13 + 132);
              memcpy(&v26, (const void *)(v13 + 136), 1uLL);
              v17 = *(_WORD *)(v13 + 138);
              if ( v27 < v17 )
                LOWORD(v17) = v27;
              result = IO80211Controller::copyOut(
                         v7,
                         *(const void **)(v13 + 144),
                         (unsigned int)v28,
                         (unsigned __int16)v17);
              if ( !(_DWORD)result )
              {
                v27 = v17;
                v15 = &v20;
                v16 = 144LL;
                goto LABEL_20;
              }
            }
          }
        }
      }
    }
  }
LABEL_21:
  v18 = *(_QWORD *)v8;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000000D4B4) ----------------------------------------------------
int __fastcall getCardCapabilities(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  int result; // eax@1
  signed int v7; // ecx@7
  __int64 v8; // rcx@10
  __int64 v9; // [sp+0h] [bp-30h]@1
  int v10; // [sp+8h] [bp-28h]@1
  __int64 v11; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = off_7B078[0];
  v11 = *(_QWORD *)off_7B078[0];
  v10 = 0;
  v9 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    12LL,
                    a3,
                    &v9,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            12LL,
                            a2,
                            &v9);
    if ( !result )
    {
      v7 = 8;
      if ( *(_DWORD *)(v4 + 24) < 8u )
        v7 = *(_DWORD *)(v4 + 24);
      *(_DWORD *)(v4 + 24) = v7;
      result = IO80211Controller::copyOut(this, (char *)&v9 + 4, *(_QWORD *)(v4 + 32), (unsigned int)v7);
    }
  }
  v8 = *(_QWORD *)v5;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000000D57F) ----------------------------------------------------
int __fastcall getStateReq(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@2
  __int64 v6; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v6 = 1LL;
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               3223873993LL,
               13LL,
               a3,
               &v6);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               13LL,
               a2,
               &v6);
  if ( !result )
  {
    *(_DWORD *)(v4 + 20) = HIDWORD(v6);
    result = 0;
  }
  return result;
}

//----- (000000000000D5E9) ----------------------------------------------------
int __fastcall getPhyMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+0h] [bp-20h]@1
  int v8; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v8 = 0;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    14LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            14LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 12LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0xC )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (000000000000D691) ----------------------------------------------------
int __fastcall getOpMode(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@2
  __int64 v6; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v6 = 1LL;
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               3223873993LL,
               15LL,
               a3,
               &v6);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               15LL,
               a2,
               &v6);
  if ( !result )
  {
    *(_DWORD *)(v4 + 20) = HIDWORD(v6);
    result = 0;
  }
  return result;
}

//----- (000000000000D6FB) ----------------------------------------------------
int __fastcall getRSSI(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+8h] [bp-48h]@1
  __int64 v8; // [sp+10h] [bp-40h]@1
  __int64 v9; // [sp+18h] [bp-38h]@1
  __int64 v10; // [sp+20h] [bp-30h]@1
  __int64 v11; // [sp+28h] [bp-28h]@1
  __int64 v12; // [sp+30h] [bp-20h]@1
  int v13; // [sp+38h] [bp-18h]@1

  v4 = a4;
  v13 = 0;
  v12 = 0LL;
  v11 = 0LL;
  v10 = 0LL;
  v9 = 0LL;
  v8 = 0LL;
  v7 = 0LL;
  LODWORD(v7) = 1;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    16LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            16LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 52LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x34 )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (000000000000D7CD) ----------------------------------------------------
int __fastcall getNoise(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+8h] [bp-48h]@1
  __int64 v8; // [sp+10h] [bp-40h]@1
  __int64 v9; // [sp+18h] [bp-38h]@1
  __int64 v10; // [sp+20h] [bp-30h]@1
  __int64 v11; // [sp+28h] [bp-28h]@1
  __int64 v12; // [sp+30h] [bp-20h]@1
  int v13; // [sp+38h] [bp-18h]@1

  v4 = a4;
  v13 = 0;
  v12 = 0LL;
  v11 = 0LL;
  v10 = 0LL;
  v9 = 0LL;
  v8 = 0LL;
  v7 = 0LL;
  LODWORD(v7) = 1;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    17LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            17LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 52LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x34 )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (000000000000D89F) ----------------------------------------------------
int __fastcall getIntMit(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-10h]@1

  v4 = a4;
  v6 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               18LL,
               a2,
               &v6);
    if ( !result )
    {
      *(_DWORD *)(v4 + 20) = HIDWORD(v6);
      result = 0;
    }
  }
  return result;
}

//----- (000000000000D8E7) ----------------------------------------------------
int __fastcall getPower(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+8h] [bp-28h]@1
  __int64 v8; // [sp+10h] [bp-20h]@1
  __int64 v9; // [sp+18h] [bp-18h]@1

  v4 = a4;
  v9 = 0LL;
  v8 = 0LL;
  v7 = 1LL;
  result = 22;
  if ( *(_QWORD *)(a4 + 32) && *(_DWORD *)(a4 + 24) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    19LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            19LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 24LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x18 )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (000000000000D99C) ----------------------------------------------------
__int64 __fastcall getAssociateResult(__int64 a1, IO80211Interface *a2, IO80211VirtualInterface *a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 result; // rax@1
  __int64 v6; // [sp+0h] [bp-10h]@1

  v4 = a4;
  v6 = 1LL;
  result = IO80211Controller::getASSOCIATE_RESULT(a1, a2, a3, (__int64)&v6);
  if ( !(_DWORD)result )
  {
    *(_DWORD *)(v4 + 20) = HIDWORD(v6);
    result = 0LL;
  }
  return result;
}

//----- (000000000000D9C9) ----------------------------------------------------
int __fastcall getApMode(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@2
  __int64 v6; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v6 = 1LL;
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               3223873993LL,
               26LL,
               a3,
               &v6);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               26LL,
               a2,
               &v6);
  if ( !result )
  {
    *(_DWORD *)(v4 + 20) = HIDWORD(v6);
    result = 0;
  }
  return result;
}

//----- (000000000000DA33) ----------------------------------------------------
__int64 __fastcall getSupportedChannels(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r12@1
  void *v5; // rax@1
  const void *v6; // rbx@1
  signed int v7; // er15@1
  int v8; // eax@3
  signed int v9; // ecx@6
  __int64 v11; // [sp+0h] [bp-30h]@1

  v11 = a4;
  v4 = a3;
  LODWORD(v5) = IOMalloc(1544LL);
  v6 = v5;
  v7 = 12;
  if ( v5 )
  {
    bzero(v5, 0x608uLL);
    *(_DWORD *)v6 = 1;
    if ( v4 )
      v8 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, const void *))(*(_QWORD *)this + 3224LL))(
             this,
             3223873993LL,
             27LL,
             v4,
             v6);
    else
      v8 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, const void *))(*(_QWORD *)this + 3216LL))(
             this,
             3223873993LL,
             27LL,
             a2,
             v6);
    v7 = v8;
    if ( !v8 )
    {
      v9 = 1544;
      if ( *(_DWORD *)(v11 + 24) < 0x608u )
        v9 = *(_DWORD *)(v11 + 24);
      *(_DWORD *)(v11 + 24) = v9;
      v7 = IO80211Controller::copyOut(this, v6, *(_QWORD *)(v11 + 32), (unsigned int)v9);
    }
    IOFree(v6, 1544LL);
  }
  return (unsigned int)v7;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000000DB0E) ----------------------------------------------------
int __fastcall getLocale(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@2
  __int64 v6; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v6 = 1LL;
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               3223873993LL,
               28LL,
               a3,
               &v6);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               28LL,
               a2,
               &v6);
  if ( !result )
  {
    *(_DWORD *)(v4 + 20) = HIDWORD(v6);
    result = 0;
  }
  return result;
}

//----- (000000000000DB78) ----------------------------------------------------
int __fastcall getDeauth(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+0h] [bp-20h]@1
  __int64 v8; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v8 = 0LL;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    29LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            29LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 16LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x10 )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (000000000000DC22) ----------------------------------------------------
int __fastcall getFragThreshold(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-10h]@1

  v4 = a4;
  v6 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               31LL,
               a2,
               &v6);
    if ( !result )
    {
      *(_DWORD *)(v4 + 20) = HIDWORD(v6);
      result = 0;
    }
  }
  return result;
}

//----- (000000000000DC6A) ----------------------------------------------------
int __fastcall getRateSet(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  int result; // eax@1
  signed int v7; // ecx@7
  int v8; // [sp+0h] [bp-E0h]@1

  v4 = a4;
  v5 = a3;
  __bzero(&v8, 188LL);
  v8 = 1;
  result = 22;
  if ( *(_DWORD *)(v4 + 24) && *(_QWORD *)(v4 + 32) )
  {
    result = v5 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    32LL,
                    v5,
                    &v8) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                             this,
                             3223873993LL,
                             32LL,
                             a2,
                             &v8);
    if ( !result )
    {
      v7 = 188;
      if ( *(_DWORD *)(v4 + 24) < 0xBCu )
        v7 = *(_DWORD *)(v4 + 24);
      *(_DWORD *)(v4 + 24) = v7;
      result = IO80211Controller::copyOut(this, &v8, *(_QWORD *)(v4 + 32), (unsigned int)v7);
    }
  }
  return result;
}
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (000000000000DD38) ----------------------------------------------------
int __fastcall getShortSlot(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-10h]@1

  v4 = a4;
  v6 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               33LL,
               a2,
               &v6);
    if ( !result )
    {
      *(_DWORD *)(v4 + 20) = BYTE4(v6);
      result = 0;
    }
  }
  return result;
}

//----- (000000000000DD81) ----------------------------------------------------
int __fastcall getMulticastRate(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@2
  __int64 v6; // [sp+8h] [bp-28h]@1
  __int64 v7; // [sp+10h] [bp-20h]@1
  __int64 v8; // [sp+18h] [bp-18h]@1

  v4 = a4;
  v8 = 0LL;
  v7 = 0LL;
  v6 = 1LL;
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               3223873993LL,
               34LL,
               a3,
               &v6);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               34LL,
               a2,
               &v6);
  if ( !result )
  {
    *(_DWORD *)(v4 + 20) = v7;
    result = 0;
  }
  return result;
}

//----- (000000000000DE04) ----------------------------------------------------
int __fastcall getRetryLimit(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 *v6; // r8@3
  signed __int64 v7; // rdx@3
  __int64 v8; // [sp+0h] [bp-10h]@1

  v4 = a4;
  v8 = 1LL;
  result = 102;
  if ( a2 )
  {
    if ( *(_DWORD *)(a4 + 16) == 35 )
    {
      v6 = &v8;
      v7 = 35LL;
    }
    else
    {
      v6 = &v8;
      v7 = 36LL;
    }
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               v7,
               a2,
               v6);
    if ( !result )
    {
      *(_DWORD *)(v4 + 20) = HIDWORD(v8);
      result = 0;
    }
  }
  return result;
}

//----- (000000000000DE65) ----------------------------------------------------
int __fastcall getAntenna(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  int v6; // edx@4
  signed __int64 v7; // rdx@7
  __int64 v8; // rcx@11
  __int64 v9; // [sp+8h] [bp-28h]@1
  __int64 v10; // [sp+10h] [bp-20h]@1
  __int64 v11; // [sp+18h] [bp-18h]@1

  v4 = a4;
  v11 = 0LL;
  v10 = 0LL;
  v9 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = 22;
    if ( *(_DWORD *)(a4 + 24) )
    {
      if ( *(_QWORD *)(a4 + 32) )
      {
        v6 = *(_DWORD *)(a4 + 16);
        if ( v6 == 37 )
        {
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     3223873993LL,
                     37LL,
                     a2,
                     &v9);
        }
        else
        {
          if ( v6 == 38 )
            v7 = 38LL;
          else
            v7 = 39LL;
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     3223873993LL,
                     v7,
                     a2,
                     &v9);
        }
        if ( !result )
        {
          v8 = 24LL;
          if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x18 )
            v8 = *(_DWORD *)(v4 + 24);
          result = IO80211Controller::copyOut(this, &v9, *(_QWORD *)(v4 + 32), v8);
        }
      }
    }
  }
  return result;
}

//----- (000000000000DF34) ----------------------------------------------------
__int64 __fastcall getROM(IO80211Controller *a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r12@1
  int v5; // ebx@1
  __int64 v6; // r14@2
  __int64 v7; // rax@5
  __int64 v8; // r13@5
  unsigned int v9; // er14@7
  signed __int64 v11; // [sp+8h] [bp-38h]@5

  v4 = a4;
  v5 = 102;
  if ( a2 )
  {
    v6 = *(_DWORD *)(a4 + 24);
    v5 = 22;
    if ( *(_DWORD *)(a4 + 24) )
    {
      if ( (unsigned int)v6 <= 0x8000 )
      {
        if ( *(_QWORD *)(a4 + 32) )
        {
          v11 = v6 + 8;
          LODWORD(v7) = IOMalloc(v6 + 8);
          v8 = v7;
          v5 = 12;
          if ( v7 )
          {
            *(_DWORD *)v7 = 1;
            *(_DWORD *)(v7 + 4) = v6;
            v5 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64))(*(_QWORD *)a1 + 3216LL))(
                   a1,
                   3223873993LL,
                   40LL,
                   a2,
                   v7);
            if ( v5 )
              goto LABEL_16;
            v9 = *(_DWORD *)(v4 + 24);
            if ( *(_DWORD *)(v8 + 4) < v9 )
              v9 = *(_DWORD *)(v8 + 4);
            v5 = IO80211Controller::copyOut(a1, (const void *)(v8 + 8), *(_QWORD *)(v4 + 32), v9);
            if ( !v5 )
            {
              *(_DWORD *)(v4 + 24) = v9;
              v5 = 0;
            }
            if ( v8 )
LABEL_16:
              IOFree(v8, v11);
          }
        }
      }
    }
  }
  return (unsigned int)v5;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000000E029) ----------------------------------------------------
int __fastcall getDTIMInt(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@2
  __int64 v6; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v6 = 1LL;
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               3223873993LL,
               41LL,
               a3,
               &v6);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               41LL,
               a2,
               &v6);
  if ( !result )
  {
    *(_DWORD *)(v4 + 20) = HIDWORD(v6);
    result = 0;
  }
  return result;
}

//----- (000000000000E093) ----------------------------------------------------
int __fastcall getStationList(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  __int64 v6; // r12@1
  int result; // eax@1
  __int64 v8; // rsi@2
  __int64 v9; // rcx@9
  int v10; // [sp+4h] [bp-82Ch]@3
  int v11; // [sp+8h] [bp-828h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  __bzero(&v11, 2056LL);
  v11 = 1;
  result = 22;
  if ( *(_DWORD *)(v4 + 24) >= 5u )
  {
    v8 = *(_QWORD *)(v4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v10, 4LL);
      if ( !result )
      {
        result = v5 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3224LL))(
                        this,
                        3223873993LL,
                        42LL,
                        v5,
                        &v11) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                                  this,
                                  3223873993LL,
                                  42LL,
                                  v6,
                                  &v11);
        if ( !result )
        {
          result = 22;
          if ( v10 == v11 )
          {
            v9 = 2056LL;
            if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x808 )
              v9 = *(_DWORD *)(v4 + 24);
            result = IO80211Controller::copyOut(this, &v11, *(_QWORD *)(v4 + 32), v9);
          }
        }
      }
    }
  }
  return result;
}
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (000000000000E197) ----------------------------------------------------
__int64 __fastcall getVersion(IO80211Controller *a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r12@1
  void *v6; // rax@1
  void *v7; // r15@1
  signed int v8; // er13@1
  __int64 v9; // rax@6
  signed __int64 v10; // rdx@6
  int v11; // eax@9
  __int64 v12; // rax@10
  signed __int64 v13; // rdx@10
  unsigned int v14; // ecx@14
  signed int v15; // ebx@16
  IO80211Controller *v17; // [sp+8h] [bp-38h]@9

  v4 = a4;
  v5 = a3;
  LODWORD(v6) = IOMalloc(264LL);
  v7 = v6;
  v8 = 12;
  if ( v6 )
  {
    bzero(v6, 0x108uLL);
    *(_DWORD *)v7 = 1;
    v8 = 22;
    if ( !*(_DWORD *)(v4 + 24) || !*(_QWORD *)(v4 + 32) )
    {
LABEL_20:
      IOFree(v7, 264LL);
      return (unsigned int)v8;
    }
    if ( *(_DWORD *)(v4 + 16) == 43 )
    {
      if ( v5 )
      {
        v9 = *(_QWORD *)a1;
        v10 = 43LL;
LABEL_9:
        v17 = a1;
        v11 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, void *))(v9 + 3224))(
                a1,
                3223873993LL,
                v10,
                v5,
                v7);
        goto LABEL_13;
      }
      v12 = *(_QWORD *)a1;
      v13 = 43LL;
    }
    else
    {
      if ( v5 )
      {
        v9 = *(_QWORD *)a1;
        v10 = 44LL;
        goto LABEL_9;
      }
      v12 = *(_QWORD *)a1;
      v13 = 44LL;
    }
    v17 = a1;
    v11 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, void *))(v12 + 3216))(
            a1,
            3223873993LL,
            v13,
            a2,
            v7);
LABEL_13:
    v8 = v11;
    if ( !v11 )
    {
      v14 = *((_WORD *)v7 + 2);
      if ( *(_DWORD *)(v4 + 24) < v14 )
        v14 = *(_DWORD *)(v4 + 24);
      v15 = 256;
      if ( v14 < 0x100 )
        v15 = v14;
      v8 = IO80211Controller::copyOut(v17, (char *)v7 + 6, *(_QWORD *)(v4 + 32), (unsigned int)v15);
      if ( !v8 )
      {
        *(_DWORD *)(v4 + 24) = v15;
        v8 = 0;
      }
    }
    goto LABEL_20;
  }
  return (unsigned int)v8;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000000E2D8) ----------------------------------------------------
int __fastcall getRand(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-10h]@1

  v4 = a4;
  v6 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               45LL,
               a2,
               &v6);
    if ( !result )
    {
      *(_DWORD *)(v4 + 20) = HIDWORD(v6);
      result = 0;
    }
  }
  return result;
}

//----- (000000000000E320) ----------------------------------------------------
int __fastcall getRSN_IE(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r13@1
  __int64 v5; // r12@1
  int result; // eax@1
  unsigned int v7; // ebx@5
  __int64 v8; // rcx@9
  int v9; // [sp+8h] [bp-138h]@1
  unsigned __int16 v10; // [sp+Ch] [bp-134h]@5
  char v11; // [sp+Eh] [bp-132h]@7
  __int64 v12; // [sp+110h] [bp-30h]@1

  v4 = a4;
  v5 = off_7B078[0];
  v12 = *(_QWORD *)off_7B078[0];
  __bzero(&v9, 264LL);
  v9 = 1;
  result = 102;
  if ( a2 )
  {
    result = 22;
    if ( *(_DWORD *)(v4 + 24) )
    {
      if ( *(_QWORD *)(v4 + 32) )
      {
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                   this,
                   3223873993LL,
                   46LL,
                   a2,
                   &v9);
        if ( !result )
        {
          v7 = v10;
          if ( *(_DWORD *)(v4 + 24) < (unsigned int)v10 )
            v7 = *(_DWORD *)(v4 + 24);
          result = IO80211Controller::copyOut(this, &v11, *(_QWORD *)(v4 + 32), v7);
          if ( !result )
          {
            *(_DWORD *)(v4 + 24) = v7;
            result = 0;
          }
        }
      }
    }
  }
  v8 = *(_QWORD *)v5;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (000000000000E3F8) ----------------------------------------------------
__int64 __fastcall getBackgroundScan(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r15@1
  void *v5; // rax@1
  const void *v6; // r13@1
  int v7; // ebx@1
  __int64 v8; // rcx@8

  v4 = a4;
  LODWORD(v5) = IOMalloc(2388LL);
  v6 = v5;
  v7 = 12;
  if ( v5 )
  {
    bzero(v5, 0x954uLL);
    *(_DWORD *)v6 = 1;
    v7 = 102;
    if ( a2 )
    {
      v7 = 22;
      if ( *(_DWORD *)(v4 + 24) )
      {
        v7 = 12;
        if ( !*(_QWORD *)(v4 + 32) )
          v7 = 22;
        if ( *(_QWORD *)(v4 + 32) )
        {
          v7 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, const void *))(*(_QWORD *)this + 3216LL))(
                 this,
                 3223873993LL,
                 47LL,
                 a2,
                 v6);
          if ( !v7 )
          {
            v8 = 2388LL;
            if ( (unsigned __int64)*(_DWORD *)(v4 + 24) <= 0x954 )
              v8 = *(_DWORD *)(v4 + 24);
            v7 = IO80211Controller::copyOut(this, v6, *(_QWORD *)(v4 + 32), v8);
          }
        }
      }
    }
    IOFree(v6, 2388LL);
  }
  return (unsigned int)v7;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000000E4CD) ----------------------------------------------------
__int64 __fastcall getAP_IE_List(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r12@1
  int v5; // ebx@1
  __int64 v6; // rax@4
  const void *v7; // r15@4
  unsigned int v8; // er13@6
  __int64 v10; // [sp+8h] [bp-38h]@1
  __int64 v11; // [sp+10h] [bp-30h]@1

  v4 = a4;
  v11 = 0LL;
  v10 = 1LL;
  v5 = 102;
  if ( a2 )
  {
    v5 = 22;
    if ( *(_DWORD *)(a4 + 24) )
    {
      if ( *(_QWORD *)(a4 + 32) )
      {
        LODWORD(v6) = IOMalloc(1024LL);
        v7 = (const void *)v6;
        v5 = 12;
        if ( v6 )
        {
          HIDWORD(v10) = 1024;
          v11 = v6;
          v5 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                 this,
                 3223873993LL,
                 48LL,
                 a2,
                 &v10);
          if ( !v5 )
          {
            v8 = HIDWORD(v10);
            if ( *(_DWORD *)(v4 + 24) < HIDWORD(v10) )
              v8 = *(_DWORD *)(v4 + 24);
            v5 = IO80211Controller::copyOut(this, v7, *(_QWORD *)(v4 + 32), v8);
            if ( !v5 )
            {
              *(_DWORD *)(v4 + 24) = v8;
              v5 = 0;
            }
          }
          IOFree(v7, 1024LL);
        }
      }
    }
  }
  return (unsigned int)v5;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000000E5BB) ----------------------------------------------------
int __fastcall getStats(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+8h] [bp-28h]@1
  __int64 v8; // [sp+10h] [bp-20h]@1
  int v9; // [sp+18h] [bp-18h]@1

  v4 = a4;
  v9 = 0;
  v8 = 0LL;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    49LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            49LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 20LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x14 )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (000000000000E66E) ----------------------------------------------------
int __fastcall getAssociationStatus(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@2
  __int64 v6; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v6 = 1LL;
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               3223873993LL,
               50LL,
               a3,
               &v6);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               50LL,
               a2,
               &v6);
  if ( !result )
  {
    *(_DWORD *)(v4 + 20) = HIDWORD(v6);
    result = 0;
  }
  return result;
}

//----- (000000000000E6D8) ----------------------------------------------------
int __fastcall getCountryCode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v6 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) >= 3u && *(_QWORD *)(a4 + 32) )
  {
    if ( a3 )
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                 this,
                 3223873993LL,
                 51LL,
                 a3,
                 &v6,
                 a2);
    else
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                 this,
                 3223873993LL,
                 51LL,
                 a2,
                 &v6);
    if ( !result )
      result = IO80211Controller::copyOut(this, (char *)&v6 + 4, *(_QWORD *)(v4 + 32), 3LL);
  }
  return result;
}

//----- (000000000000E769) ----------------------------------------------------
__int64 __fastcall getDebugFlags(__int64 a1, IO80211Interface *a2, IO80211VirtualInterface *a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int v5; // eax@2

  v4 = a4;
  if ( a2 )
    v5 = IO80211Interface::debugFlags(a2);
  else
    v5 = IO80211VirtualInterface::debugFlags(a3);
  *(_DWORD *)(v4 + 20) = v5;
  return 0LL;
}

//----- (000000000000E795) ----------------------------------------------------
int __fastcall getLastRxPktData(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@5
  __int64 v7; // [sp+8h] [bp-28h]@1
  __int64 v8; // [sp+10h] [bp-20h]@1
  __int64 v9; // [sp+18h] [bp-18h]@1

  v4 = a4;
  v9 = 0LL;
  v8 = 0LL;
  v7 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = 22;
    if ( *(_DWORD *)(a4 + 24) )
    {
      if ( *(_QWORD *)(a4 + 32) )
      {
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                   this,
                   3223873993LL,
                   53LL,
                   a2,
                   &v7);
        if ( !result )
        {
          v6 = 24LL;
          if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x18 )
            v6 = *(_DWORD *)(v4 + 24);
          result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
        }
      }
    }
  }
  return result;
}

//----- (000000000000E82D) ----------------------------------------------------
int __fastcall getRadioInfo(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@5
  __int64 v7; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v7 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = 22;
    if ( *(_DWORD *)(a4 + 24) )
    {
      if ( *(_QWORD *)(a4 + 32) )
      {
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                   this,
                   3223873993LL,
                   54LL,
                   a2,
                   &v7);
        if ( !result )
        {
          v6 = 8LL;
          if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 8 )
            v6 = *(_DWORD *)(v4 + 24);
          result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
        }
      }
    }
  }
  return result;
}

//----- (000000000000E8AC) ----------------------------------------------------
int __fastcall getGuardInterval(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-10h]@1

  v4 = a4;
  v6 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               55LL,
               a2,
               &v6);
    if ( !result )
    {
      *(_DWORD *)(v4 + 20) = HIDWORD(v6);
      result = 0;
    }
  }
  return result;
}

//----- (000000000000E8F4) ----------------------------------------------------
int __fastcall getMimoPowersave(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-10h]@1

  v4 = a4;
  v6 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               56LL,
               a2,
               &v6);
    if ( !result )
    {
      *(_DWORD *)(v4 + 20) = HIDWORD(v6);
      result = 0;
    }
  }
  return result;
}

//----- (000000000000E93C) ----------------------------------------------------
int __fastcall getMCS(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@2
  __int64 v6; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v6 = 1LL;
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               3223873993LL,
               57LL,
               a3,
               &v6);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               57LL,
               a2,
               &v6);
  if ( !result )
  {
    *(_DWORD *)(v4 + 20) = HIDWORD(v6);
    result = 0;
  }
  return result;
}

//----- (000000000000E9A6) ----------------------------------------------------
int __fastcall getRIFS(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-10h]@1

  v4 = a4;
  v6 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               58LL,
               a2,
               &v6);
    if ( !result )
    {
      *(_DWORD *)(v4 + 20) = HIDWORD(v6);
      result = 0;
    }
  }
  return result;
}

//----- (000000000000E9EE) ----------------------------------------------------
int __fastcall getLDPC(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-10h]@1

  v4 = a4;
  v6 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               59LL,
               a2,
               &v6);
    if ( !result )
    {
      *(_DWORD *)(v4 + 20) = HIDWORD(v6);
      result = 0;
    }
  }
  return result;
}

//----- (000000000000EA36) ----------------------------------------------------
int __fastcall getMSDU(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-10h]@1

  v4 = a4;
  v6 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               60LL,
               a2,
               &v6);
    if ( !result )
    {
      *(_DWORD *)(v4 + 20) = HIDWORD(v6);
      result = 0;
    }
  }
  return result;
}

//----- (000000000000EA7E) ----------------------------------------------------
int __fastcall getMPDU(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@5
  __int64 v7; // [sp+0h] [bp-20h]@1
  int v8; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v8 = 0;
  v7 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = 22;
    if ( *(_DWORD *)(a4 + 24) )
    {
      if ( *(_QWORD *)(a4 + 32) )
      {
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                   this,
                   3223873993LL,
                   61LL,
                   a2,
                   &v7);
        if ( !result )
        {
          v6 = 12LL;
          if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0xC )
            v6 = *(_DWORD *)(v4 + 24);
          result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
        }
      }
    }
  }
  return result;
}

//----- (000000000000EB09) ----------------------------------------------------
int __fastcall getBlockAck(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@5
  __int64 v7; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v7 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = 22;
    if ( *(_DWORD *)(a4 + 24) )
    {
      if ( *(_QWORD *)(a4 + 32) )
      {
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                   this,
                   3223873993LL,
                   62LL,
                   a2,
                   &v7);
        if ( !result )
        {
          v6 = 8LL;
          if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 8 )
            v6 = *(_DWORD *)(v4 + 24);
          result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
        }
      }
    }
  }
  return result;
}

//----- (000000000000EB88) ----------------------------------------------------
int __fastcall getPLS(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-10h]@1

  v4 = a4;
  v6 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               63LL,
               a2,
               &v6);
    if ( !result )
    {
      *(_DWORD *)(v4 + 20) = HIDWORD(v6);
      result = 0;
    }
  }
  return result;
}

//----- (000000000000EBD0) ----------------------------------------------------
int __fastcall getPSMP(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-10h]@1

  v4 = a4;
  v6 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               64LL,
               a2,
               &v6);
    if ( !result )
    {
      *(_DWORD *)(v4 + 20) = HIDWORD(v6);
      result = 0;
    }
  }
  return result;
}

//----- (000000000000EC18) ----------------------------------------------------
int __fastcall getPhySubMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@1
  unsigned int v7; // ecx@2
  __int64 v8; // rsi@3
  __int64 v9; // rbx@4
  __int64 v10; // [sp+0h] [bp-30h]@1
  __int64 v11; // [sp+8h] [bp-28h]@1

  v4 = a4;
  v5 = a2;
  v11 = 0LL;
  v10 = 1LL;
  result = 102;
  if ( a2 )
  {
    v7 = *(_DWORD *)(a4 + 24);
    result = 22;
    if ( *(_DWORD *)(v4 + 24) )
    {
      v8 = *(_QWORD *)(v4 + 32);
      if ( v8 )
      {
        v9 = 16LL;
        if ( v7 < 0x10 )
          v9 = *(_DWORD *)(v4 + 24);
        result = IO80211Controller::copyIn(this, v8, &v10, v9);
        if ( !result )
        {
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     3223873993LL,
                     65LL,
                     v5,
                     &v10);
          if ( !result )
            result = IO80211Controller::copyOut(this, &v10, *(_QWORD *)(v4 + 32), v9);
        }
      }
    }
  }
  return result;
}

//----- (000000000000ECC8) ----------------------------------------------------
int __fastcall getMCSIndexSet(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rcx@7
  __int64 v8; // rcx@10
  __int64 v9; // [sp+0h] [bp-30h]@1
  __int64 v10; // [sp+8h] [bp-28h]@1
  __int64 v11; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = off_7B078[0];
  v11 = *(_QWORD *)off_7B078[0];
  v10 = 0LL;
  v9 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    66LL,
                    a3,
                    &v9,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            66LL,
                            a2,
                            &v9);
    if ( !result )
    {
      v7 = 16LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x10 )
        v7 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v9, *(_QWORD *)(v4 + 32), v7);
    }
  }
  v8 = *(_QWORD *)v5;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000000ED92) ----------------------------------------------------
signed __int64 getCacheThreshBcast()
{
  return 102LL;
}

//----- (000000000000ED9D) ----------------------------------------------------
signed __int64 getCacheThreshDirect()
{
  return 102LL;
}

//----- (000000000000EDA8) ----------------------------------------------------
__int64 __fastcall getWoWParameters(IO80211Controller *this, __int64 a2, __int64 a3, signed __int64 a4, char a5)
{
  char v5; // bl@1
  signed __int64 v6; // r13@1
  __int64 v7; // r14@1
  IO80211Controller *v8; // r12@1
  __int64 v9; // r15@1
  int v10; // eax@1
  signed int v11; // er14@3
  unsigned int v12; // eax@5
  char *v13; // rcx@6
  char *v14; // rdx@6
  __int64 v15; // rsi@6
  unsigned int v16; // edi@7
  unsigned int v17; // eax@13
  char *v18; // rcx@14
  __int64 v19; // rdx@14
  unsigned int v20; // esi@15
  __int64 v21; // rax@17
  char *v22; // rsi@18
  __int64 v23; // rcx@18
  int i; // eax@21
  __int64 v26; // rbx@27
  signed __int64 v27; // r14@27
  const void **v28; // r15@28
  unsigned int v29; // eax@38
  IO80211Controller *v30; // rdi@38
  __int64 *v31; // rcx@39
  char *v32; // rdx@39
  unsigned __int64 *v33; // rsi@39
  unsigned int v34; // eax@42
  char *v35; // rcx@43
  char *v36; // rdx@43
  unsigned __int64 *v37; // rsi@43
  __int64 v38; // [sp+0h] [bp-470h]@0
  signed __int64 v39; // [sp+8h] [bp-468h]@27
  IO80211Controller *v40; // [sp+10h] [bp-460h]@21
  char v41; // [sp+1Ch] [bp-454h]@0
  __int64 v42; // [sp+20h] [bp-450h]@3
  __int64 v43; // [sp+28h] [bp-448h]@1
  int v44; // [sp+30h] [bp-440h]@1
  char v45; // [sp+34h] [bp-43Ch]@38
  unsigned int v46; // [sp+38h] [bp-438h]@38
  unsigned int v47; // [sp+3Ch] [bp-434h]@18
  char v48; // [sp+48h] [bp-428h]@18
  int v49; // [sp+100h] [bp-370h]@1
  char v50; // [sp+104h] [bp-36Ch]@5
  int v51; // [sp+108h] [bp-368h]@5
  unsigned int v52; // [sp+10Ch] [bp-364h]@5
  char v53; // [sp+110h] [bp-360h]@6
  int v54; // [sp+1D0h] [bp-2A0h]@11
  char v55; // [sp+1D4h] [bp-29Ch]@13
  int v56; // [sp+1D8h] [bp-298h]@13
  unsigned int v57; // [sp+1DCh] [bp-294h]@12
  int v58; // [sp+1E0h] [bp-290h]@15
  int v59[23]; // [sp+1E4h] [bp-28Ch]@16
  int v60; // [sp+240h] [bp-230h]@3
  char v61; // [sp+244h] [bp-22Ch]@5
  int v62; // [sp+248h] [bp-228h]@5
  unsigned int v63; // [sp+24Ch] [bp-224h]@4
  char v64; // [sp+258h] [bp-218h]@6
  __int64 v65; // [sp+310h] [bp-160h]@38
  unsigned __int64 v66; // [sp+318h] [bp-158h]@38
  __int64 v67; // [sp+320h] [bp-150h]@42
  __int64 v68; // [sp+328h] [bp-148h]@39
  __int64 v69; // [sp+330h] [bp-140h]@42
  __int64 v70; // [sp+338h] [bp-138h]@42
  __int64 v71; // [sp+340h] [bp-130h]@42
  __int64 v72; // [sp+348h] [bp-128h]@42
  __int64 v73; // [sp+350h] [bp-120h]@42
  __int64 v74; // [sp+358h] [bp-118h]@42
  __int64 v75; // [sp+360h] [bp-110h]@42
  __int64 v76; // [sp+368h] [bp-108h]@42
  __int64 v77; // [sp+370h] [bp-100h]@42
  __int64 v78; // [sp+378h] [bp-F8h]@42
  unsigned __int64 v79; // [sp+3E0h] [bp-90h]@1
  __int64 v80; // [sp+3E8h] [bp-88h]@1
  __int64 v81; // [sp+3F0h] [bp-80h]@1
  __int64 v82; // [sp+3F8h] [bp-78h]@1
  __int64 v83; // [sp+400h] [bp-70h]@1
  __int64 v84; // [sp+408h] [bp-68h]@1
  __int64 v85; // [sp+410h] [bp-60h]@1
  __int64 v86; // [sp+418h] [bp-58h]@1
  __int64 v87; // [sp+420h] [bp-50h]@1
  __int64 v88; // [sp+428h] [bp-48h]@1
  __int64 v89; // [sp+430h] [bp-40h]@1
  __int64 v90; // [sp+438h] [bp-38h]@1
  __int64 v91; // [sp+440h] [bp-30h]@1

  v5 = a5;
  v6 = a4;
  v7 = a3;
  v43 = a2;
  v8 = this;
  v9 = off_7B078[0];
  v91 = *(_QWORD *)off_7B078[0];
  __bzero(&v49, 208LL);
  v49 = 1;
  __bzero(&v44, 208LL);
  v44 = 1;
  v90 = 0LL;
  v89 = 0LL;
  v88 = 0LL;
  v87 = 0LL;
  v86 = 0LL;
  v85 = 0LL;
  v84 = 0LL;
  v83 = 0LL;
  v82 = 0LL;
  v81 = 0LL;
  v80 = 0LL;
  v79 = 0LL;
  v10 = *(_DWORD *)(v6 + 24);
  if ( v5 )
  {
    if ( v10 != 208 )
      goto LABEL_22;
    v42 = v7;
    v41 = v5;
    v11 = IO80211Controller::copyIn(this, *(_QWORD *)(v6 + 32), &v60, 208LL);
    if ( v11 )
      goto LABEL_23;
    if ( v63 > 0xC )
      goto LABEL_22;
    v49 = v60;
    memcpy(&v50, &v61, 1uLL);
    v12 = v63;
    v51 = v62;
    v52 = v63;
    if ( v63 )
    {
      v13 = &v64;
      v14 = &v53;
      v15 = 0LL;
      do
      {
        v16 = *((_DWORD *)v13 - 2);
        if ( v16 > 0x5DC )
          goto LABEL_22;
        *(_DWORD *)v14 = v16;
        *(&v79 + v15++) = *(_QWORD *)v13;
        v13 += 16;
        v14 += 16;
      }
      while ( (unsigned int)v15 < v12 );
    }
  }
  else
  {
    if ( v10 != 112 )
      goto LABEL_22;
    v42 = v7;
    v41 = v5;
    v11 = IO80211Controller::copyIn(this, *(_QWORD *)(v6 + 32), &v54, 112LL);
    if ( v11 )
      goto LABEL_23;
    if ( v57 > 0xC )
      goto LABEL_22;
    v49 = v54;
    memcpy(&v50, &v55, 1uLL);
    v51 = v56;
    v17 = v57;
    v52 = v57;
    if ( v57 )
    {
      v18 = &v53;
      v19 = 0LL;
      while ( 1 )
      {
        v20 = *(&v58 + 2 * v19);
        if ( v20 > 0x5DC )
          break;
        *(_DWORD *)v18 = v20;
        *(&v79 + v19) = (unsigned int)v59[2 * v19];
        ++v19;
        v18 += 16;
        if ( (unsigned int)v19 >= v17 )
          goto LABEL_17;
      }
LABEL_22:
      v11 = 22;
      goto LABEL_23;
    }
  }
LABEL_17:
  LODWORD(v21) = IOMalloc(18000LL);
  v11 = 12;
  if ( !v21 )
    goto LABEL_23;
  v47 = 12;
  v22 = &v48;
  v23 = 0LL;
  do
  {
    *((_DWORD *)v22 - 2) = 1500;
    *(_QWORD *)v22 = v21 + v23;
    v22 += 16;
    v23 += 1500LL;
  }
  while ( v23 != 18000 );
  v38 = v21;
  if ( !v42 )
    goto LABEL_25;
  v40 = v8;
  for ( i = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)v8 + 3224LL))(
              v8,
              3223873993LL,
              69LL,
              v42,
              &v44);
        ;
        i = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)v8 + 3216LL))(
              v8,
              3223873993LL,
              69LL,
              v43,
              &v44) )
  {
    v11 = i;
    if ( !i )
    {
      LODWORD(v26) = 0;
      v27 = v6;
      v39 = v6;
      if ( v52 )
      {
        v28 = (const void **)&v48;
        v8 = (IO80211Controller *)&v53;
        v26 = 0LL;
        while ( (unsigned int)v26 < v47 && (unsigned int)v26 <= 0xB )
        {
          v6 = *((_DWORD *)v28 - 2);
          if ( *(_DWORD *)v8 < (unsigned int)v6 )
            v6 = *(_DWORD *)v8;
          if ( (unsigned int)v6 >= 0x5DC )
            v6 = 1500LL;
          v11 = IO80211Controller::copyOut(v40, *v28, *(&v79 + v26), (unsigned int)v6);
          if ( v11 )
            goto LABEL_46;
          ++v26;
          *(_DWORD *)v8 = v6;
          v28 += 2;
          v8 = (IO80211Controller *)((char *)v8 + 16);
          v27 = v39;
          if ( (unsigned int)v26 >= v52 )
            break;
        }
      }
      v52 = v26;
      if ( v41 )
      {
        __bzero(&v65, 208LL);
        LODWORD(v65) = v49;
        memcpy((char *)&v65 + 4, &v45, 1uLL);
        v66 = __PAIR__(v52, v46);
        v29 = v52;
        v30 = v40;
        if ( v52 )
        {
          v31 = &v68;
          v32 = &v53;
          v33 = &v79;
          do
          {
            *((_DWORD *)v31 - 2) = *(_DWORD *)v32;
            *v31 = *v33;
            ++v33;
            v31 += 2;
            v32 += 16;
            --v29;
          }
          while ( v29 );
        }
      }
      else
      {
        v78 = 0LL;
        v77 = 0LL;
        v76 = 0LL;
        v75 = 0LL;
        v74 = 0LL;
        v73 = 0LL;
        v72 = 0LL;
        v71 = 0LL;
        v70 = 0LL;
        v69 = 0LL;
        v68 = 0LL;
        v67 = 0LL;
        v65 = 0LL;
        LODWORD(v65) = v49;
        memcpy((char *)&v65 + 4, &v45, 1uLL);
        v66 = __PAIR__(v52, v46);
        v34 = v52;
        v30 = v40;
        if ( v52 )
        {
          v35 = (char *)&v67 + 4;
          v36 = &v53;
          v37 = &v79;
          do
          {
            *((_DWORD *)v35 - 1) = *(_DWORD *)v36;
            *(_DWORD *)v35 = *(_DWORD *)v37;
            ++v37;
            v35 += 8;
            v36 += 16;
            --v34;
          }
          while ( v34 );
        }
      }
      v11 = IO80211Controller::copyOut(v30, &v65, *(_QWORD *)(v27 + 32), *(_DWORD *)(v27 + 24));
    }
LABEL_46:
    IOFree(v38, 18000LL);
    v9 = off_7B078[0];
LABEL_23:
    if ( *(_QWORD *)v9 == v91 )
      break;
LABEL_25:
    v40 = v8;
  }
  return (unsigned int)v11;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);
// EDA8: using guessed type int var_28C[23];

//----- (000000000000F37A) ----------------------------------------------------
int __fastcall getWoWEnabled(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // rbx@1
  __int64 v6; // r12@1
  int result; // eax@2
  signed __int64 v8; // rbx@6
  signed __int64 v9; // rax@6
  __int64 v10; // rcx@9
  __int64 v11; // [sp+8h] [bp-38h]@1
  int v12; // [sp+10h] [bp-30h]@1
  __int64 v13; // [sp+18h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v6 = off_7B078[0];
  v13 = *(_QWORD *)off_7B078[0];
  v12 = 0;
  v11 = 1LL;
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               3223873993LL,
               12LL,
               a3,
               &v11);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               12LL,
               a2,
               &v11);
  if ( !result )
  {
    result = 102;
    if ( BYTE6(v11) & 0x10 )
    {
      v8 = v5 + 318;
      v9 = a2 + 504;
      if ( !a2 )
        v9 = v8;
      *(_DWORD *)(v4 + 20) = *(_BYTE *)v9 != 0;
      result = 0;
    }
  }
  v10 = *(_QWORD *)v6;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000000F43F) ----------------------------------------------------
int __fastcall get40MhzIntolerant(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@2
  __int64 v6; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v6 = 1LL;
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               3223873993LL,
               71LL,
               a3,
               &v6);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               71LL,
               a2,
               &v6);
  if ( !result )
  {
    *(_DWORD *)(v4 + 20) = HIDWORD(v6);
    result = 0;
  }
  return result;
}

//----- (000000000000F4A9) ----------------------------------------------------
signed __int64 __fastcall getPidLocked(__int64 a1, IO80211Interface *a2, __int64 a3, __int64 a4)
{
  signed __int64 result; // rax@1

  result = 102LL;
  if ( a2 )
  {
    *(_DWORD *)(a4 + 20) = IO80211Interface::pidLocked(a2);
    result = 0LL;
  }
  return result;
}

//----- (000000000000F4D3) ----------------------------------------------------
__int64 __fastcall getSTA_IE_LIST(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4, char a5)
{
  char v5; // r14@1
  __int64 v6; // r15@1
  __int64 v7; // r13@1
  __int64 v8; // rcx@1
  signed int v9; // er12@1
  __int64 v10; // rax@4
  void *v11; // rax@8
  void *v12; // rbx@9
  int v13; // eax@10
  int v14; // ecx@14
  __int64 v15; // rdx@17
  __int64 v16; // rcx@17
  int *v17; // rsi@17
  int v18; // ecx@18
  __int64 v20; // [sp+0h] [bp-D0h]@8
  void *v21; // [sp+8h] [bp-C8h]@9
  __int64 v22; // [sp+18h] [bp-B8h]@1
  unsigned __int64 v23; // [sp+20h] [bp-B0h]@1
  __int64 v24; // [sp+28h] [bp-A8h]@1
  __int64 v25; // [sp+30h] [bp-A0h]@1
  __int64 v26; // [sp+38h] [bp-98h]@1
  void *v27; // [sp+40h] [bp-90h]@1
  int v28; // [sp+48h] [bp-88h]@6
  char v29; // [sp+4Ch] [bp-84h]@7
  int v30; // [sp+54h] [bp-7Ch]@7
  unsigned int v31; // [sp+58h] [bp-78h]@7
  int v32; // [sp+60h] [bp-70h]@3
  char v33; // [sp+64h] [bp-6Ch]@4
  int v34; // [sp+6Ch] [bp-64h]@4
  __int64 v35; // [sp+70h] [bp-60h]@4
  int v36; // [sp+78h] [bp-58h]@18
  char v37; // [sp+7Ch] [bp-54h]@18
  int v38; // [sp+84h] [bp-4Ch]@20
  int v39; // [sp+88h] [bp-48h]@20
  int v40; // [sp+90h] [bp-40h]@14
  char v41; // [sp+94h] [bp-3Ch]@14
  int v42; // [sp+9Ch] [bp-34h]@16
  __int64 v43; // [sp+A0h] [bp-30h]@16

  v5 = a5;
  v6 = a4;
  v7 = a3;
  v27 = 0LL;
  v26 = 0LL;
  v25 = 1LL;
  v24 = 0LL;
  v23 = 0LL;
  v22 = 1LL;
  v8 = *(_DWORD *)(a4 + 24);
  v9 = 22;
  if ( a5 )
  {
    if ( (_DWORD)v8 != 24 )
      return (unsigned int)v9;
    v9 = IO80211Controller::copyIn(this, *(_QWORD *)(v6 + 32), &v32, v8);
    if ( v9 )
      return (unsigned int)v9;
    LODWORD(v22) = v32;
    memcpy((char *)&v22 + 4, &v33, 6uLL);
    HIDWORD(v23) = v34;
    v10 = v35;
  }
  else
  {
    if ( (_DWORD)v8 != 20 )
      return (unsigned int)v9;
    v9 = IO80211Controller::copyIn(this, *(_QWORD *)(v6 + 32), &v28, v8);
    if ( v9 )
      return (unsigned int)v9;
    LODWORD(v22) = v28;
    memcpy((char *)&v22 + 4, &v29, 6uLL);
    HIDWORD(v23) = v30;
    v10 = v31;
  }
  v20 = v10;
  LODWORD(v11) = IOMalloc(1024LL);
  v9 = 12;
  if ( v11 )
  {
    v12 = v11;
    v21 = v11;
    memcpy((char *)&v25 + 4, (char *)&v22 + 4, 6uLL);
    HIDWORD(v26) = 1024;
    v27 = v12;
    if ( v7 )
      v13 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
              this,
              3223873993LL,
              73LL,
              v7,
              &v25);
    else
      v13 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
              this,
              3223873993LL,
              73LL,
              a2,
              &v25);
    v9 = v13;
    if ( !v13 )
    {
      if ( v5 )
      {
        v40 = v22;
        memcpy(&v41, (char *)&v22 + 4, 6uLL);
        v14 = HIDWORD(v26);
        if ( HIDWORD(v23) < HIDWORD(v26) )
          v14 = HIDWORD(v23);
        v42 = v14;
        v43 = v20;
        v9 = IO80211Controller::copyOut(this, v27, v20, (unsigned int)v14);
        if ( v9 )
          goto LABEL_23;
        v15 = *(_QWORD *)(v6 + 32);
        v16 = *(_DWORD *)(v6 + 24);
        v17 = &v40;
      }
      else
      {
        v36 = v22;
        memcpy(&v37, (char *)&v22 + 4, 6uLL);
        v18 = HIDWORD(v26);
        if ( HIDWORD(v23) < HIDWORD(v26) )
          v18 = HIDWORD(v23);
        v38 = v18;
        v39 = v20;
        v9 = IO80211Controller::copyOut(this, v27, v20, (unsigned int)v18);
        if ( v9 )
          goto LABEL_23;
        v15 = *(_QWORD *)(v6 + 32);
        v16 = *(_DWORD *)(v6 + 24);
        v17 = &v36;
      }
      v9 = IO80211Controller::copyOut(this, v17, v15, v16);
    }
LABEL_23:
    IOFree(v21, 1024LL);
  }
  return (unsigned int)v9;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000000F797) ----------------------------------------------------
int __fastcall getRSN_Conf(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r15@1
  __int64 v5; // rbx@1
  int result; // eax@1
  int v7; // [sp+8h] [bp-C8h]@1

  v4 = a4;
  v5 = a3;
  __bzero(&v7, 164LL);
  v7 = 1;
  result = 22;
  if ( *(_DWORD *)(v4 + 24) == 164 )
  {
    if ( v5 )
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3224LL))(
                 this,
                 3223873993LL,
                 77LL,
                 v5,
                 &v7);
    else
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                 this,
                 3223873993LL,
                 77LL,
                 a2,
                 &v7);
    if ( !result )
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
  }
  return result;
}
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (000000000000F851) ----------------------------------------------------
int __fastcall getKeyRSC(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  __int64 v6; // r13@1
  int result; // eax@1
  __int64 v8; // rcx@8
  int v9; // [sp+8h] [bp-C8h]@1
  __int64 v10; // [sp+A0h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v6 = off_7B078[0];
  v10 = *(_QWORD *)off_7B078[0];
  __bzero(&v9, 148LL);
  v9 = 1;
  result = 22;
  if ( *(_DWORD *)(v4 + 24) == 148 )
  {
    result = IO80211Controller::copyIn(this, *(_QWORD *)(v4 + 32), &v9, 148LL);
    if ( !result )
    {
      if ( v5 )
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3224LL))(
                   this,
                   3223873993LL,
                   78LL,
                   v5,
                   &v9);
      else
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                   this,
                   3223873993LL,
                   78LL,
                   a2,
                   &v9);
      if ( !result )
        result = IO80211Controller::copyOut(this, &v9, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
    }
  }
  v8 = *(_QWORD *)v6;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (000000000000F947) ----------------------------------------------------
int __fastcall getSTA_Stats(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // [sp+0h] [bp-40h]@1
  __int64 v8; // [sp+8h] [bp-38h]@1
  __int64 v9; // [sp+10h] [bp-30h]@1
  int v10; // [sp+18h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v10 = 0;
  v9 = 0LL;
  v8 = 0LL;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 28 )
  {
    result = IO80211Controller::copyIn(this, *(_QWORD *)(a4 + 32), &v7, 28LL);
    if ( !result )
    {
      if ( v5 )
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                   this,
                   3223873993LL,
                   79LL,
                   v5,
                   &v7);
      else
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                   this,
                   3223873993LL,
                   79LL,
                   a2,
                   &v7);
      if ( !result )
        result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
    }
  }
  return result;
}

//----- (000000000000FA15) ----------------------------------------------------
int __fastcall getRoamThresh(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-20h]@1
  int v7; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v7 = 0;
  v6 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 12 && *(_QWORD *)(a4 + 32) )
  {
    if ( a3 )
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                 this,
                 3223873993LL,
                 80LL,
                 a3,
                 &v6,
                 a2);
    else
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                 this,
                 3223873993LL,
                 80LL,
                 a2,
                 &v6);
    if ( !result )
      result = IO80211Controller::copyOut(this, &v6, *(_QWORD *)(v4 + 32), 12LL);
  }
  return result;
}

//----- (000000000000FAB2) ----------------------------------------------------
int __fastcall getVendorDebugFlags(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v6 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) <= 1u )
  {
    if ( a3 )
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                 this,
                 3223873993LL,
                 81LL,
                 a3,
                 &v6,
                 a2);
    else
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                 this,
                 3223873993LL,
                 81LL,
                 a2,
                 &v6);
    if ( !result )
      result = IO80211Controller::copyOut(this, (char *)&v6 + 4, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
  }
  return result;
}

//----- (000000000000FB3A) ----------------------------------------------------
signed __int64 __fastcall getCacheAgeThresh(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  signed __int64 result; // rax@1
  __int64 v5; // rdx@2

  result = 102LL;
  if ( a2 )
  {
    v5 = *(_QWORD *)(a2 + 496);
    result = 6LL;
    if ( v5 )
    {
      *(_DWORD *)(a4 + 20) = *(_DWORD *)(v5 + 32);
      result = 0LL;
    }
  }
  return result;
}

//----- (000000000000FB63) ----------------------------------------------------
__int64 __fastcall getPMKCache(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r15@1
  __int64 result; // rax@1
  __int64 v6; // rax@3
  __int64 v7; // rbx@3
  unsigned int v8; // er14@7

  v4 = a4;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 2056 )
  {
    if ( *(_QWORD *)(a4 + 32) )
    {
      LODWORD(v6) = IOMalloc(2056LL);
      v7 = v6;
      result = 12LL;
      if ( v7 )
      {
        bzero((void *)v7, 0x808uLL);
        *(_DWORD *)v7 = 1;
        if ( a2 )
          IO80211Interface::getPMKSAList(a2, v7);
        else
          IO80211VirtualInterface::getPMKSAList();
        v8 = IO80211Controller::copyOut(this, (const void *)v7, *(_QWORD *)(v4 + 32), 2056LL);
        IOFree(v7, 2056LL);
        result = v8;
      }
    }
  }
  return result;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000000FC10) ----------------------------------------------------
int __fastcall getLinkQualEventParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // [sp+8h] [bp-28h]@1
  __int64 v7; // [sp+10h] [bp-20h]@1
  int v8; // [sp+18h] [bp-18h]@1

  v4 = a4;
  v8 = 0;
  v7 = 0LL;
  v6 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 20 && *(_QWORD *)(a4 + 32) )
  {
    if ( a3 )
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                 this,
                 3223873993LL,
                 84LL,
                 a3,
                 &v6,
                 a2);
    else
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                 this,
                 3223873993LL,
                 84LL,
                 a2,
                 &v6);
    if ( !result )
      result = IO80211Controller::copyOut(this, &v6, *(_QWORD *)(v4 + 32), 20LL);
  }
  return result;
}

//----- (000000000000FCB8) ----------------------------------------------------
__int64 __fastcall getIE(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4, char a5)
{
  char v5; // r15@1
  __int64 v6; // rbx@1
  __int64 v7; // r12@1
  signed int v8; // er13@3
  void *v9; // rax@6
  __int64 v10; // rsi@8
  void *v12; // rax@15
  void *v13; // rdi@18
  unsigned __int64 v14; // rax@19
  int v15; // eax@22
  const void *v16; // rsi@27
  __int64 v17; // rdx@27
  __int64 v18; // [sp+0h] [bp-D0h]@21
  void *v19; // [sp+8h] [bp-C8h]@7
  unsigned int v20; // [sp+8h] [bp-C8h]@19
  __int64 v21; // [sp+10h] [bp-C0h]@3
  __int64 v22; // [sp+18h] [bp-B8h]@1
  unsigned __int64 v23; // [sp+20h] [bp-B0h]@1
  unsigned __int64 v24; // [sp+28h] [bp-A8h]@1
  void *v25; // [sp+30h] [bp-A0h]@1
  __int64 v26; // [sp+38h] [bp-98h]@9
  unsigned __int64 v27; // [sp+40h] [bp-90h]@9
  unsigned __int64 v28; // [sp+48h] [bp-88h]@9
  __int64 v29; // [sp+50h] [bp-80h]@2
  unsigned __int64 v30; // [sp+58h] [bp-78h]@2
  __int64 v31; // [sp+60h] [bp-70h]@2
  unsigned __int64 v32; // [sp+68h] [bp-68h]@2
  __int64 v33; // [sp+70h] [bp-60h]@28
  unsigned __int64 v34; // [sp+78h] [bp-58h]@28
  int v35; // [sp+80h] [bp-50h]@28
  char v36[12]; // [sp+84h] [bp-4Ch]@26
  unsigned __int64 v37; // [sp+90h] [bp-40h]@26
  __int64 v38; // [sp+98h] [bp-38h]@26
  __int64 v39; // [sp+A0h] [bp-30h]@26

  v5 = a5;
  v6 = a4;
  v7 = a3;
  v25 = 0LL;
  v24 = 0LL;
  v23 = 0LL;
  v22 = 1LL;
  if ( a5 )
  {
    v32 = 0LL;
    v31 = 0LL;
    v30 = 0LL;
    v29 = 0LL;
    if ( *(_DWORD *)(a4 + 24) == 32 )
    {
      v21 = a2;
      v8 = IO80211Controller::copyIn(this, *(_QWORD *)(a4 + 32), &v29, 32LL);
      if ( v8 )
        return (unsigned int)v8;
      if ( (unsigned int)(v31 - 1) <= 0x7FF )
      {
        v8 = 22;
        if ( HIDWORD(v30) - 1 >= (unsigned int)v31 )
          return (unsigned int)v8;
        LODWORD(v9) = IOMalloc((unsigned int)v31);
        v8 = 12;
        if ( !v9 )
          return (unsigned int)v8;
        v19 = v9;
        v8 = IO80211Controller::copyIn(this, v32, v9, HIDWORD(v30));
        if ( v8 )
        {
          v10 = (unsigned int)v31;
LABEL_18:
          v13 = v19;
LABEL_33:
          IOFree(v13, v10);
          return (unsigned int)v8;
        }
        v25 = v19;
        v22 = v29;
        v23 = v30;
        v20 = v31;
        LODWORD(v24) = v31;
        v14 = v32;
        goto LABEL_21;
      }
    }
LABEL_12:
    v8 = 22;
    return (unsigned int)v8;
  }
  v28 = 0LL;
  v27 = 0LL;
  v26 = 0LL;
  if ( *(_DWORD *)(a4 + 24) != 24 )
    goto LABEL_12;
  v21 = a2;
  v8 = IO80211Controller::copyIn(this, *(_QWORD *)(a4 + 32), &v26, 24LL);
  if ( v8 )
    return (unsigned int)v8;
  if ( (unsigned int)(v28 - 1) > 0x7FF )
    goto LABEL_12;
  v8 = 22;
  if ( HIDWORD(v27) - 1 >= (unsigned int)v28 )
    return (unsigned int)v8;
  LODWORD(v12) = IOMalloc((unsigned int)v28);
  v8 = 12;
  if ( !v12 )
    return (unsigned int)v8;
  v19 = v12;
  v8 = IO80211Controller::copyIn(this, HIDWORD(v28), v12, HIDWORD(v27));
  if ( v8 )
  {
    v10 = (unsigned int)v28;
    goto LABEL_18;
  }
  v25 = v19;
  v22 = v26;
  v23 = v27;
  v20 = v28;
  LODWORD(v24) = v28;
  v14 = HIDWORD(v28);
LABEL_21:
  v18 = v14;
  if ( v7 )
    v15 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
            this,
            3223873993LL,
            85LL,
            v7,
            &v22);
  else
    v15 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
            this,
            3223873993LL,
            85LL,
            v21,
            &v22);
  v8 = v15;
  if ( !v15 )
  {
    if ( v5 )
    {
      v38 = 0LL;
      *(_QWORD *)&v36[4] = v22;
      v37 = v23;
      LODWORD(v38) = v24;
      v39 = v18;
      v8 = IO80211Controller::copyOut(this, &v36[4], *(_QWORD *)(v6 + 32), 32LL);
      if ( v8 )
        goto LABEL_31;
      v16 = v25;
      v17 = v39;
    }
    else
    {
      v33 = v22;
      v34 = v23;
      v35 = v24;
      *(_DWORD *)v36 = v18;
      v8 = IO80211Controller::copyOut(this, &v33, *(_QWORD *)(v6 + 32), 24LL);
      if ( v8 )
        goto LABEL_31;
      v16 = v25;
      v17 = *(unsigned int *)v36;
    }
    v8 = IO80211Controller::copyOut(this, v16, v17, (unsigned int)v24);
  }
LABEL_31:
  if ( v20 )
  {
    v13 = v25;
    v10 = v20;
    goto LABEL_33;
  }
  return (unsigned int)v8;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (00000000000100C1) ----------------------------------------------------
int __fastcall getBTCoexMode(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-10h]@1

  v4 = a4;
  v6 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               87LL,
               a2,
               &v6);
    if ( !result )
    {
      *(_DWORD *)(v4 + 20) = HIDWORD(v6);
      result = 0;
    }
  }
  return result;
}

//----- (0000000000010109) ----------------------------------------------------
int __fastcall getWoWTest(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-10h]@1

  v4 = a4;
  v6 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               88LL,
               a2,
               &v6);
    if ( !result )
    {
      *(_DWORD *)(v4 + 20) = HIDWORD(v6);
      result = 0;
    }
  }
  return result;
}

//----- (0000000000010151) ----------------------------------------------------
signed __int64 __fastcall getVirtualIfRole(__int64 a1, __int64 a2, IO80211VirtualInterface *a3, __int64 a4)
{
  signed __int64 result; // rax@1

  result = 6LL;
  if ( a3 )
  {
    *(_DWORD *)(a4 + 20) = IO80211VirtualInterface::getInterfaceRole(a3);
    result = 0LL;
  }
  return result;
}

//----- (0000000000010178) ----------------------------------------------------
__int64 __fastcall getVirtualIfParent(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // rbx@1
  IO80211Interface *v6; // rax@1
  IO80211Interface *v7; // rcx@1
  __int64 result; // rax@1
  char *v9; // rbx@3
  unsigned int v10; // er15@3

  v4 = a4;
  v5 = a3;
  LODWORD(v6) = (*(int (**)(void))(*(_QWORD *)this + 3192LL))();
  v7 = v6;
  result = 6LL;
  if ( v5 )
  {
    if ( v7 )
    {
      v9 = IO80211Interface::getBSDName(v7, 6LL);
      v10 = strlen(v9);
      result = 22LL;
      if ( v10 <= *(_DWORD *)(v4 + 24) )
      {
        result = IO80211Controller::copyOut(this, v9, *(_QWORD *)(v4 + 32), v10);
        if ( !(_DWORD)result )
        {
          *(_DWORD *)(v4 + 24) = v10;
          result = 0LL;
        }
      }
    }
  }
  return result;
}

//----- (00000000000101EE) ----------------------------------------------------
__int64 __fastcall getP2PNoAList(IO80211Controller *this, __int64 a2, IO80211VirtualInterface *a3, __int64 a4)
{
  __int64 v4; // r15@1
  IO80211VirtualInterface *v5; // r12@1
  int v6; // ebx@1
  __int64 v8; // [sp+0h] [bp-50h]@1
  __int64 v9; // [sp+8h] [bp-48h]@1
  __int64 v10; // [sp+10h] [bp-40h]@1
  __int64 v11; // [sp+18h] [bp-38h]@1
  __int64 v12; // [sp+20h] [bp-30h]@1
  int v13; // [sp+28h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v13 = 0;
  v12 = 0LL;
  v11 = 0LL;
  v10 = 0LL;
  v9 = 0LL;
  v8 = 0LL;
  LODWORD(v8) = 1;
  v6 = 6;
  if ( a3 )
  {
    if ( (unsigned int)IO80211VirtualInterface::getInterfaceRole(a3) == 3 )
    {
      v6 = 22;
      if ( *(_DWORD *)(v4 + 24) >= 0x2Cu )
      {
        if ( *(_QWORD *)(v4 + 32) )
        {
          v6 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211VirtualInterface *, __int64 *))(*(_QWORD *)this + 3224LL))(
                 this,
                 3223873993LL,
                 99LL,
                 v5,
                 &v8);
          if ( !v6 )
            v6 = IO80211Controller::copyOut(this, &v8, *(_QWORD *)(v4 + 32), 44LL);
        }
      }
    }
  }
  return (unsigned int)v6;
}

//----- (00000000000102AF) ----------------------------------------------------
__int64 __fastcall getP2POppPS(__int64 a1, __int64 a2, IO80211VirtualInterface *a3, __int64 a4)
{
  __int64 v4; // r14@1
  IO80211VirtualInterface *v5; // r15@1
  int v6; // ebx@1
  __int64 v8; // [sp+8h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v8 = 1LL;
  v6 = 6;
  if ( a3 )
  {
    if ( (unsigned int)IO80211VirtualInterface::getInterfaceRole(a3) == 3 )
    {
      v6 = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, IO80211VirtualInterface *, __int64 *))(*(_QWORD *)a1 + 3224LL))(
             a1,
             3223873993LL,
             100LL,
             v5,
             &v8);
      if ( !v6 )
      {
        *(_DWORD *)(v4 + 20) = HIDWORD(v8);
        v6 = 0;
      }
    }
  }
  return (unsigned int)v6;
}

//----- (0000000000010322) ----------------------------------------------------
__int64 __fastcall getP2PCTWindow(__int64 a1, __int64 a2, IO80211VirtualInterface *a3, __int64 a4)
{
  __int64 v4; // r14@1
  IO80211VirtualInterface *v5; // r15@1
  int v6; // ebx@1
  __int64 v8; // [sp+8h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v8 = 1LL;
  v6 = 6;
  if ( a3 )
  {
    if ( (unsigned int)IO80211VirtualInterface::getInterfaceRole(a3) == 3 )
    {
      v6 = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, IO80211VirtualInterface *, __int64 *))(*(_QWORD *)a1 + 3224LL))(
             a1,
             3223873993LL,
             101LL,
             v5,
             &v8);
      if ( !v6 )
      {
        *(_DWORD *)(v4 + 20) = HIDWORD(v8);
        v6 = 0;
      }
    }
  }
  return (unsigned int)v6;
}

//----- (0000000000010395) ----------------------------------------------------
signed __int64 getBTCoexFlags()
{
  return 102LL;
}

//----- (00000000000103A0) ----------------------------------------------------
signed __int64 getCurrentNetwork()
{
  return 102LL;
}

//----- (00000000000103AB) ----------------------------------------------------
signed __int64 getBTPower()
{
  return 102LL;
}

//----- (00000000000103B6) ----------------------------------------------------
signed __int64 getRSSIBounds()
{
  return 102LL;
}

//----- (00000000000103C1) ----------------------------------------------------
int __fastcall getTXChainPower(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+8h] [bp-68h]@1
  __int64 v8; // [sp+10h] [bp-60h]@1
  __int64 v9; // [sp+18h] [bp-58h]@1
  __int64 v10; // [sp+20h] [bp-50h]@1
  __int64 v11; // [sp+28h] [bp-48h]@1
  __int64 v12; // [sp+30h] [bp-40h]@1
  __int64 v13; // [sp+38h] [bp-38h]@1
  __int64 v14; // [sp+40h] [bp-30h]@1
  __int64 v15; // [sp+48h] [bp-28h]@1
  __int64 v16; // [sp+50h] [bp-20h]@1
  __int64 v17; // [sp+58h] [bp-18h]@1

  v4 = a4;
  v17 = 0LL;
  v16 = 0LL;
  v15 = 0LL;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 0LL;
  v11 = 0LL;
  v10 = 0LL;
  v9 = 0LL;
  v8 = 0LL;
  v7 = 0LL;
  LODWORD(v7) = 1;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    108LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            108LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 88LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x58 )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (00000000000104B4) ----------------------------------------------------
int __fastcall getCDDMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+0h] [bp-20h]@1
  int v8; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v8 = 0;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    109LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            109LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 12LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0xC )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (000000000001055C) ----------------------------------------------------
__int64 __fastcall getLastBcastScanTime(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  IO80211Controller *v5; // r14@1
  __int64 result; // rax@1
  __int64 v7; // rdi@3
  int v8; // [sp+0h] [bp-30h]@4
  int v9; // [sp+8h] [bp-28h]@4
  __int64 v10; // [sp+10h] [bp-20h]@1
  int v11; // [sp+18h] [bp-18h]@1

  v4 = a4;
  v5 = this;
  v11 = 0;
  v10 = 1LL;
  result = 102LL;
  if ( a2 )
  {
    result = 22LL;
    if ( *(_DWORD *)(a4 + 24) == 12 )
    {
      v7 = *(_QWORD *)(a2 + 496);
      result = 6LL;
      if ( v7 )
      {
        IO80211ScanManager::getTimeSinceLastBroadcastScan(v7, (__int64)&v8);
        HIDWORD(v10) = v8;
        v11 = v9;
        result = IO80211Controller::copyOut(v5, &v10, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
      }
    }
  }
  return result;
}

//----- (00000000000105D8) ----------------------------------------------------
int __fastcall getThermalThrottling(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+8h] [bp-28h]@1
  __int64 v8; // [sp+10h] [bp-20h]@1
  __int64 v9; // [sp+18h] [bp-18h]@1

  v4 = a4;
  v9 = 0LL;
  v8 = 0LL;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    111LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            111LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 24LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x18 )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (000000000001068D) ----------------------------------------------------
int __fastcall getFactoryMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    112LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            112LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 8LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 8 )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (0000000000010729) ----------------------------------------------------
signed __int64 getPowerDebugInfo()
{
  return 102LL;
}

//----- (0000000000010734) ----------------------------------------------------
signed int __fastcall getAwdlSyncParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  signed int result; // eax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-30h]@1
  __int64 v13; // [sp+8h] [bp-28h]@1
  __int64 v14; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 24 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 24LL);
      if ( !result )
      {
        result = 45;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlSyncParams(v11, &v12);
              if ( !result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000107F4) ----------------------------------------------------
__int64 __fastcall getAwdlSyncEnabled(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-28h]@1
  int v13; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v13 = 0;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 12 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 12LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlSyncEnabled(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000108A7) ----------------------------------------------------
signed int __fastcall getAwdlExtensionParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  signed int result; // eax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-30h]@1
  __int64 v13; // [sp+8h] [bp-28h]@1
  int v14; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v14 = 0;
  v13 = 0LL;
  v12 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 20 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 20LL);
      if ( !result )
      {
        result = 45;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlExtensionParams(v11, &v12);
              if ( !result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000010965) ----------------------------------------------------
__int64 __fastcall getAwdlPeerServiceParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 v7; // r12@1
  __int64 result; // rax@1
  __int64 v9; // rsi@2
  __int64 v10; // rdi@5
  __int64 v11; // rax@6
  __int64 v12; // rcx@6
  __int64 v13; // rcx@9
  __int64 v14; // [sp+8h] [bp-58h]@1
  __int64 v15; // [sp+10h] [bp-50h]@1
  __int64 v16; // [sp+18h] [bp-48h]@1
  __int64 v17; // [sp+20h] [bp-40h]@1
  __int64 v18; // [sp+28h] [bp-38h]@1
  int v19; // [sp+30h] [bp-30h]@1
  __int64 v20; // [sp+38h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v7 = off_7B078[0];
  v20 = *(_QWORD *)off_7B078[0];
  v19 = 0;
  v18 = 0LL;
  v17 = 0LL;
  v16 = 0LL;
  v15 = 0LL;
  v14 = 0LL;
  LODWORD(v14) = 1;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 44 )
  {
    v9 = *(_QWORD *)(a4 + 32);
    if ( v9 )
    {
      result = IO80211Controller::copyIn(this, v9, &v14, 44LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v10 = *(_QWORD *)(v5 + 144);
          if ( v10 )
          {
            LODWORD(v11) = OSMetaClassBase::safeMetaCast(v10, IO80211AWDLPeerManager::metaClass);
            v12 = v11;
            result = 19LL;
            if ( v12 )
            {
              result = IO80211AWDLPeerManager::getAwdlPeerServiceParams();
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v14, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  v13 = *(_QWORD *)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000010A5C) ----------------------------------------------------
__int64 __fastcall getAwdlPeerServiceRequest(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-38h]@1
  __int64 v13; // [sp+10h] [bp-30h]@1
  __int64 v14; // [sp+18h] [bp-28h]@1
  __int64 v15; // [sp+20h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v15 = 0LL;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 32 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 32LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlPeerServiceRequest();
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000010B27) ----------------------------------------------------
__int64 __fastcall getAwdlElectionId(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlElectionId(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000010BCB) ----------------------------------------------------
signed int __fastcall getAwdlMaxTreeDepth(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  signed int result; // eax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !result )
      {
        result = 45;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlMaxTreeDepth(v11, &v12);
              if ( !result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000010C6F) ----------------------------------------------------
__int64 __fastcall getAwdlGuardTime(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlGuardTime(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000010D13) ----------------------------------------------------
__int64 __fastcall getAwdlBssid(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-28h]@1
  __int64 v13; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 16 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 16LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlBssid(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000010DC8) ----------------------------------------------------
__int64 __fastcall getAwdlElectionMetric(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlElectionMetric(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000010E6C) ----------------------------------------------------
__int64 __fastcall getAwdlAvailabilityWindowApAlignment(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-28h]@1
  __int64 v13; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 16 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 16LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlAvailabilityWindowApAlignment(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000010F21) ----------------------------------------------------
__int64 __fastcall getAwdlSyncFrameApAlignment(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-28h]@1
  int v13; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v13 = 0;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 12 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 12LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlSyncFrameApAlignment();
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000010FD4) ----------------------------------------------------
__int64 __fastcall getAwdlChannelSequence(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  int v12; // [sp+8h] [bp-1A8h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  __bzero(&v12, 400LL);
  v12 = 1;
  result = 22LL;
  if ( *(_DWORD *)(v4 + 24) == 400 )
  {
    v8 = *(_QWORD *)(v4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 400LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlChannelSequence(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (00000000000110A0) ----------------------------------------------------
signed int __fastcall getAwdlMaxPeers(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  signed int result; // eax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !result )
      {
        result = 45;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlMaxPeers(v11, &v12);
              if ( !result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000011144) ----------------------------------------------------
__int64 __fastcall getAwdlOUI(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlOUI(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000111E8) ----------------------------------------------------
__int64 __fastcall getAwdlMasterChannel(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlMasterChannel(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000001128C) ----------------------------------------------------
__int64 __fastcall getAwdlTopMaster(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-28h]@1
  __int64 v13; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 16 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 16LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlTopMaster(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000011341) ----------------------------------------------------
signed int __fastcall getAwdlSyncState(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  signed int result; // eax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-30h]@1
  __int64 v13; // [sp+8h] [bp-28h]@1
  int v14; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v14 = 0;
  v13 = 0LL;
  v12 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 20 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 20LL);
      if ( !result )
      {
        result = 45;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlSyncState(v11, &v12);
              if ( !result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000113FF) ----------------------------------------------------
signed int __fastcall getAwdlElectionRssiThresholds(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  signed int result; // eax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-30h]@1
  __int64 v13; // [sp+8h] [bp-28h]@1
  int v14; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v14 = 0;
  v13 = 0LL;
  v12 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 20 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 20LL);
      if ( !result )
      {
        result = 45;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlElectionRssiThresholds(v11, &v12);
              if ( !result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000114BD) ----------------------------------------------------
signed int __fastcall getAwdlPresenceMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  signed int result; // eax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !result )
      {
        result = 45;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlPresenceMode(v11, &v12);
              if ( !result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000011561) ----------------------------------------------------
signed int __fastcall getAwdlElectionMasterCounts(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  signed int result; // eax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-28h]@1
  __int64 v13; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v13 = 0LL;
  v12 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 16 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 16LL);
      if ( !result )
      {
        result = 45;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlElectionMasterCounts(v11, &v12);
              if ( !result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000011616) ----------------------------------------------------
__int64 __fastcall getAwdlSyncFramePacketLifetime(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlSyncFramePacketLifetime(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000116BA) ----------------------------------------------------
__int64 __fastcall getAwdlMasterSyncFramePeriod(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlMasterSyncFramePeriod(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000001175E) ----------------------------------------------------
__int64 __fastcall getAwdlNonElectionMasterSyncFramePeriod(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlNonElectionMasterSyncFramePeriod(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000011802) ----------------------------------------------------
__int64 __fastcall getAwdlBtCoexProtectedPeriodLength(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlBtCoexProtectedPeriodLength(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000118A6) ----------------------------------------------------
__int64 __fastcall getAwdlStrategy(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-30h]@1
  __int64 v13; // [sp+8h] [bp-28h]@1
  __int64 v14; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 24 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 24LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlStrategy(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000011966) ----------------------------------------------------
__int64 __fastcall getAwdlMaxNoMasterPeriods(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlMaxNoMasterPeriods(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000011A0A) ----------------------------------------------------
__int64 __fastcall getLogFlags(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r12@1
  __int64 v5; // r15@1
  __int64 v6; // rbx@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  signed __int64 v9; // rbx@7
  __int64 v10; // [sp+8h] [bp-38h]@1
  __int64 v11; // [sp+10h] [bp-30h]@1
  __int64 v12; // [sp+18h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v12 = 0LL;
  v11 = 0LL;
  v10 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 24 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v10, 24LL);
      if ( !(_DWORD)result )
      {
        if ( v5 || (result = 45LL, v6 != 0) )
        {
          if ( v6 )
          {
            v9 = v6 + 328;
          }
          else
          {
            result = 19LL;
            if ( !v5 )
              return result;
            v9 = v5 + 144;
          }
          result = 19LL;
          if ( *(_QWORD *)v9 )
          {
            result = IO80211PeerManager::getLogFlags(*(IO80211PeerManager **)v9, (__int64)&v10);
            if ( !(_DWORD)result )
              result = IO80211Controller::copyOut(this, &v10, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
          }
        }
      }
    }
  }
  return result;
}

//----- (0000000000011AE9) ----------------------------------------------------
__int64 __fastcall getPeerStats(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 result; // rax@1
  __int64 v6; // rsi@2
  __int64 v7; // r15@4
  __int64 v8; // [sp+8h] [bp-38h]@1
  __int64 v9; // [sp+10h] [bp-30h]@1
  __int64 v10; // [sp+18h] [bp-28h]@1
  int v11; // [sp+20h] [bp-20h]@1

  v4 = a4;
  v11 = 0;
  v10 = 0LL;
  v9 = 0LL;
  v8 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 28 )
  {
    v6 = *(_QWORD *)(a4 + 32);
    if ( v6 )
    {
      result = 45LL;
      if ( a3 )
      {
        v7 = *(_QWORD *)(a3 + 144);
        result = 19LL;
        if ( v7 )
        {
          result = IO80211Controller::copyIn(this, v6, &v8, 28LL);
          if ( !(_DWORD)result )
          {
            result = IO80211PeerManager::getPeerStats(v7, (__int64)&v8);
            if ( !(_DWORD)result )
              result = IO80211Controller::copyOut(this, &v8, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
          }
        }
      }
    }
  }
  return result;
}

//----- (0000000000011B98) ----------------------------------------------------
__int64 __fastcall getHtCapabilityIE(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r12@1
  __int64 v5; // r15@1
  __int64 v6; // rbx@1
  __int64 v7; // r13@1
  __int64 result; // rax@1
  __int64 v9; // rsi@2
  signed __int64 v10; // rbx@7
  __int64 v11; // rcx@13
  __int64 v12; // [sp+0h] [bp-50h]@1
  __int64 v13; // [sp+8h] [bp-48h]@1
  __int64 v14; // [sp+10h] [bp-40h]@1
  __int64 v15; // [sp+18h] [bp-38h]@1
  __int64 v16; // [sp+20h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = off_7B078[0];
  v16 = *(_QWORD *)off_7B078[0];
  v15 = 0LL;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 32 )
  {
    v9 = *(_QWORD *)(a4 + 32);
    if ( v9 )
    {
      result = IO80211Controller::copyIn(this, v9, &v12, 32LL);
      if ( !(_DWORD)result )
      {
        if ( v5 || (result = 45LL, v6 != 0) )
        {
          if ( v6 )
          {
            v10 = v6 + 328;
          }
          else
          {
            result = 19LL;
            if ( !v5 )
              goto LABEL_13;
            v10 = v5 + 144;
          }
          result = 19LL;
          if ( *(_QWORD *)v10 )
          {
            result = IO80211PeerManager::getHtCapabilityIE(*(IO80211PeerManager **)v10, &v12);
            if ( !(_DWORD)result )
              result = IO80211Controller::copyOut(this, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
          }
        }
      }
    }
  }
LABEL_13:
  v11 = *(_QWORD *)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000011CA4) ----------------------------------------------------
__int64 __fastcall getAwdlElectionParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-50h]@1
  __int64 v13; // [sp+8h] [bp-48h]@1
  __int64 v14; // [sp+10h] [bp-40h]@1
  __int64 v15; // [sp+18h] [bp-38h]@1
  __int64 v16; // [sp+20h] [bp-30h]@1
  __int64 v17; // [sp+28h] [bp-28h]@1
  __int64 v18; // [sp+30h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v18 = 0LL;
  v17 = 0LL;
  v16 = 0LL;
  v15 = 0LL;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 0LL;
  LODWORD(v12) = 1;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 56 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 56LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlElectionParams(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000011D82) ----------------------------------------------------
int __fastcall getAwdlCtl(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r12@1
  __int64 v5; // r15@1
  __int64 v6; // rbx@1
  __int64 v7; // r13@1
  int result; // eax@1
  __int64 v9; // rsi@2
  __int64 v10; // rdx@3
  __int64 v11; // rcx@3
  signed __int64 v12; // rbx@7
  __int64 v13; // rcx@13
  int v14; // [sp+8h] [bp-D8h]@1
  __int64 v15; // [sp+B0h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = off_7B078[0];
  v15 = *(_QWORD *)off_7B078[0];
  __bzero(&v14, 168LL);
  v14 = 1;
  result = 22;
  if ( *(_DWORD *)(v4 + 24) == 168 )
  {
    v9 = *(_QWORD *)(v4 + 32);
    if ( v9 )
    {
      result = IO80211Controller::copyIn(this, v9, &v14, 168LL);
      if ( !result )
      {
        LOBYTE(v11) = v6 == 0;
        if ( v5 || (result = 45, !(_BYTE)v11) )
        {
          if ( v6 )
          {
            v12 = v6 + 328;
          }
          else
          {
            result = 19;
            if ( !v5 )
              goto LABEL_13;
            v12 = v5 + 144;
          }
          result = 19;
          if ( *(_QWORD *)v12 )
          {
            result = (*(int (__fastcall **)(_QWORD, int *, __int64, __int64))(**(_QWORD **)v12 + 368LL))(
                       *(_QWORD *)v12,
                       &v14,
                       v10,
                       v11);
            if ( !result )
              result = IO80211Controller::copyOut(this, &v14, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
          }
        }
      }
    }
  }
LABEL_13:
  v13 = *(_QWORD *)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000011E97) ----------------------------------------------------
__int64 __fastcall getAwdlSocialTimeSlots(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlSocialTimeSlots(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000011F3B) ----------------------------------------------------
__int64 __fastcall getAwdlPeerTrafficRegistration(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 v7; // r12@1
  __int64 result; // rax@1
  __int64 v9; // rsi@2
  __int64 v10; // rdi@5
  IO80211PeerManager *v11; // rax@6
  IO80211PeerManager *v12; // rcx@6
  __int64 v13; // rcx@9
  __int64 v14; // [sp+8h] [bp-78h]@1
  __int64 v15; // [sp+10h] [bp-70h]@1
  __int64 v16; // [sp+18h] [bp-68h]@1
  __int64 v17; // [sp+20h] [bp-60h]@1
  __int64 v18; // [sp+28h] [bp-58h]@1
  __int64 v19; // [sp+30h] [bp-50h]@1
  __int64 v20; // [sp+38h] [bp-48h]@1
  __int64 v21; // [sp+40h] [bp-40h]@1
  __int64 v22; // [sp+48h] [bp-38h]@1
  __int64 v23; // [sp+50h] [bp-30h]@1
  __int64 v24; // [sp+58h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v7 = off_7B078[0];
  v24 = *(_QWORD *)off_7B078[0];
  v23 = 0LL;
  v22 = 0LL;
  v21 = 0LL;
  v20 = 0LL;
  v19 = 0LL;
  v18 = 0LL;
  v17 = 0LL;
  v16 = 0LL;
  v15 = 0LL;
  v14 = 0LL;
  LODWORD(v14) = 1;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 80 )
  {
    v9 = *(_QWORD *)(a4 + 32);
    if ( v9 )
    {
      result = IO80211Controller::copyIn(this, v9, &v14, 80LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v10 = *(_QWORD *)(v5 + 144);
          if ( v10 )
          {
            LODWORD(v11) = OSMetaClassBase::safeMetaCast(v10, IO80211AWDLPeerManager::metaClass);
            v12 = v11;
            result = 19LL;
            if ( v12 )
            {
              result = IO80211AWDLPeerManager::getAwdlPeerTrafficRegistration(v12, (__int64)&v14);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v14, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  v13 = *(_QWORD *)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000012053) ----------------------------------------------------
int __fastcall getBeaconPeriod(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v6 = 1LL;
  result = 102;
  if ( a2 )
  {
    if ( a3 )
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                 this,
                 3223873993LL,
                 166LL,
                 a3,
                 &v6);
    else
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                 this,
                 3223873993LL,
                 166LL,
                 a2,
                 &v6);
    if ( !result )
      result = IO80211Controller::copyOut(this, &v6, *(_QWORD *)(v4 + 32), 8LL);
  }
  return result;
}

//----- (00000000000120DD) ----------------------------------------------------
int __fastcall getACLPolicy(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) >= 8u && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    169LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            169LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 8LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 8 )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (0000000000012179) ----------------------------------------------------
int __fastcall getACLList(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rcx@7
  int v8; // [sp+8h] [bp-328h]@1

  v4 = a4;
  v5 = a3;
  __bzero(&v8, 776LL);
  v8 = 1;
  result = 22;
  if ( *(_DWORD *)(v4 + 24) >= 0x308u && *(_QWORD *)(v4 + 32) )
  {
    result = v5 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    173LL,
                    v5,
                    &v8) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                             this,
                             3223873993LL,
                             173LL,
                             a2,
                             &v8);
    if ( !result )
    {
      v7 = 776LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x308 )
        v7 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v8, *(_QWORD *)(v4 + 32), v7);
    }
  }
  return result;
}
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000012247) ----------------------------------------------------
int __fastcall getChainAck(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+8h] [bp-28h]@1
  __int64 v8; // [sp+10h] [bp-20h]@1
  __int64 v9; // [sp+18h] [bp-18h]@1

  v4 = a4;
  v9 = 0LL;
  v8 = 0LL;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    174LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            174LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 24LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x18 )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (00000000000122FC) ----------------------------------------------------
int __fastcall getDesense(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+0h] [bp-20h]@1
  __int64 v8; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v8 = 0LL;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    175LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            175LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 16LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x10 )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (00000000000123A6) ----------------------------------------------------
int __fastcall getOffloadScanning(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rcx@7
  int v8; // [sp+0h] [bp-8D0h]@1

  v4 = a4;
  v5 = a3;
  __bzero(&v8, 2220LL);
  v8 = 1;
  result = 22;
  if ( *(_DWORD *)(v4 + 24) && *(_QWORD *)(v4 + 32) )
  {
    result = v5 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    176LL,
                    v5,
                    &v8) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                             this,
                             3223873993LL,
                             176LL,
                             a2,
                             &v8);
    if ( !result )
    {
      v7 = 2220LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x8AC )
        v7 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v8, *(_QWORD *)(v4 + 32), v7);
    }
  }
  return result;
}
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000012471) ----------------------------------------------------
int __fastcall getOffloadRSN(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    177LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            177LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 8LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 8 )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (000000000001250D) ----------------------------------------------------
int __fastcall getOffloadCountryCode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    178LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            178LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 8LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 8 )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (00000000000125A9) ----------------------------------------------------
int __fastcall getOffloadKeepAliveL2(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+0h] [bp-20h]@1
  int v8; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v8 = 0;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    179LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            179LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 12LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0xC )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (0000000000012651) ----------------------------------------------------
int __fastcall getOffloadArpNdp(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rcx@7
  __int64 v8; // rcx@10
  __int64 v9; // [sp+0h] [bp-40h]@1
  __int64 v10; // [sp+8h] [bp-38h]@1
  __int64 v11; // [sp+10h] [bp-30h]@1
  int v12; // [sp+18h] [bp-28h]@1
  __int64 v13; // [sp+20h] [bp-20h]@1

  v4 = a4;
  v5 = off_7B078[0];
  v13 = *(_QWORD *)off_7B078[0];
  v12 = 0;
  v11 = 0LL;
  v10 = 0LL;
  v9 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    180LL,
                    a3,
                    &v9,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            180LL,
                            a2,
                            &v9);
    if ( !result )
    {
      v7 = 28LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x1C )
        v7 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v9, *(_QWORD *)(v4 + 32), v7);
    }
  }
  v8 = *(_QWORD *)v5;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000001272F) ----------------------------------------------------
int __fastcall getVHTMCSIndexSet(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    181LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            181LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 8LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 8 )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (00000000000127CB) ----------------------------------------------------
__int64 __fastcall getDWDS(IO80211Controller *this, __int64 a2, IO80211VirtualInterface *a3, __int64 a4)
{
  __int64 v4; // r15@1
  IO80211VirtualInterface *v5; // r12@1
  signed int v6; // ebx@2
  int v7; // eax@7
  __int64 v8; // rcx@10
  __int64 v10; // [sp+0h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v10 = 1LL;
  if ( a2 || (v6 = 102, a3) && (unsigned int)IO80211VirtualInterface::getInterfaceRole(a3) == 5 )
  {
    v6 = 22;
    if ( *(_DWORD *)(v4 + 24) && *(_QWORD *)(v4 + 32) )
    {
      v7 = v5 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211VirtualInterface *, __int64 *))(*(_QWORD *)this + 3224LL))(
                  this,
                  3223873993LL,
                  182LL,
                  v5,
                  &v10) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            182LL,
                            a2,
                            &v10);
      v6 = v7;
      if ( !v7 )
      {
        v8 = 8LL;
        if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 8 )
          v8 = *(_DWORD *)(v4 + 24);
        v6 = IO80211Controller::copyOut(this, &v10, *(_QWORD *)(v4 + 32), v8);
      }
    }
  }
  return (unsigned int)v6;
}

//----- (000000000001289B) ----------------------------------------------------
int __fastcall getInterruptStats(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // rbx@1
  int result; // eax@1
  int v7; // [sp+0h] [bp-2430h]@1

  v4 = a4;
  v5 = a3;
  __bzero(&v7, 9232LL);
  v7 = 1;
  result = 102;
  if ( a2 )
  {
    result = 22;
    if ( *(_DWORD *)(v4 + 24) >= 0x2410u )
    {
      if ( v5 )
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3224LL))(
                   this,
                   3223873993LL,
                   183LL,
                   v5,
                   &v7);
      else
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                   this,
                   3223873993LL,
                   183LL,
                   a2,
                   &v7);
      if ( !result )
        result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), 9232LL);
    }
  }
  return result;
}
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000012960) ----------------------------------------------------
int __fastcall getTimerStats(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // rbx@1
  int result; // eax@1
  int v7; // [sp+0h] [bp-2C30h]@1

  v4 = a4;
  v5 = a3;
  __bzero(&v7, 11280LL);
  v7 = 1;
  result = 102;
  if ( a2 )
  {
    result = 22;
    if ( *(_DWORD *)(v4 + 24) >= 0x2C10u )
    {
      if ( v5 )
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3224LL))(
                   this,
                   3223873993LL,
                   185LL,
                   v5,
                   &v7);
      else
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                   this,
                   3223873993LL,
                   185LL,
                   a2,
                   &v7);
      if ( !result )
        result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), 11280LL);
    }
  }
  return result;
}
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000012A25) ----------------------------------------------------
int __fastcall getOffloadStats(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // rbx@1
  int result; // eax@1
  int v7; // [sp+0h] [bp-2830h]@1

  v4 = a4;
  v5 = a3;
  __bzero(&v7, 10256LL);
  v7 = 1;
  result = 102;
  if ( a2 )
  {
    result = 22;
    if ( *(_DWORD *)(v4 + 24) >= 0x2810u )
    {
      if ( v5 )
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3224LL))(
                   this,
                   3223873993LL,
                   187LL,
                   v5,
                   &v7);
      else
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                   this,
                   3223873993LL,
                   187LL,
                   a2,
                   &v7);
      if ( !result )
        result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), 10256LL);
    }
  }
  return result;
}
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000012AEA) ----------------------------------------------------
int __fastcall getOffloadBeacons(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    189LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            189LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 8LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 8 )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (0000000000012B86) ----------------------------------------------------
int __fastcall getRoaming(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    190LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            190LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 8LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 8 )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (0000000000012C22) ----------------------------------------------------
int __fastcall getOffloadArp(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+0h] [bp-20h]@1
  int v8; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v8 = 0;
  v7 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    191LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            191LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 12LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0xC )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (0000000000012CCA) ----------------------------------------------------
int __fastcall getOffloadNdp(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rcx@7
  __int64 v7; // [sp+8h] [bp-58h]@1
  __int64 v8; // [sp+10h] [bp-50h]@1
  __int64 v9; // [sp+18h] [bp-48h]@1
  __int64 v10; // [sp+20h] [bp-40h]@1
  __int64 v11; // [sp+28h] [bp-38h]@1
  __int64 v12; // [sp+30h] [bp-30h]@1
  __int64 v13; // [sp+38h] [bp-28h]@1
  __int64 v14; // [sp+40h] [bp-20h]@1
  __int64 v15; // [sp+48h] [bp-18h]@1

  v4 = a4;
  v15 = 0LL;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 0LL;
  v11 = 0LL;
  v10 = 0LL;
  v9 = 0LL;
  v8 = 0LL;
  v7 = 0LL;
  LODWORD(v7) = 1;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) && *(_QWORD *)(a4 + 32) )
  {
    result = a3 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    192LL,
                    a3,
                    &v7,
                    a2) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                            this,
                            3223873993LL,
                            192LL,
                            a2,
                            &v7);
    if ( !result )
    {
      v6 = 72LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x48 )
        v6 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v6);
    }
  }
  return result;
}

//----- (0000000000012DAD) ----------------------------------------------------
int __fastcall getOffloadScan(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rcx@7
  int v8; // [sp+0h] [bp-880h]@1

  v4 = a4;
  v5 = a3;
  __bzero(&v8, 2140LL);
  v8 = 1;
  result = 22;
  if ( *(_DWORD *)(v4 + 24) && *(_QWORD *)(v4 + 32) )
  {
    result = v5 ? (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3224LL))(
                    this,
                    3223873993LL,
                    193LL,
                    v5,
                    &v8) : (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                             this,
                             3223873993LL,
                             193LL,
                             a2,
                             &v8);
    if ( !result )
    {
      v7 = 2140LL;
      if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0x85C )
        v7 = *(_DWORD *)(v4 + 24);
      result = IO80211Controller::copyOut(this, &v8, *(_QWORD *)(v4 + 32), v7);
    }
  }
  return result;
}
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000012E78) ----------------------------------------------------
int __fastcall getDesenseLevel(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@1
  __int64 v6; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v6 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
               this,
               3223873993LL,
               194LL,
               a2,
               &v6);
    if ( !result )
    {
      result = 22;
      if ( *(_DWORD *)(v4 + 24) >= 8u )
        result = IO80211Controller::copyOut(this, &v6, *(_QWORD *)(v4 + 32), 8LL);
    }
  }
  return result;
}

//----- (0000000000012EE6) ----------------------------------------------------
int __fastcall getMcsVht(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@1
  __int64 v6; // [sp+8h] [bp-28h]@1
  __int64 v7; // [sp+10h] [bp-20h]@1
  int v8; // [sp+18h] [bp-18h]@1

  v4 = a4;
  v8 = 0;
  v7 = 0LL;
  v6 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) >= 0x14u )
  {
    if ( a3 )
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                 this,
                 3223873993LL,
                 195LL,
                 a3,
                 &v6,
                 a2);
    else
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                 this,
                 3223873993LL,
                 195LL,
                 a2,
                 &v6);
    if ( !result )
      result = IO80211Controller::copyOut(this, &v6, *(_QWORD *)(v4 + 32), 20LL);
  }
  return result;
}

//----- (0000000000012F88) ----------------------------------------------------
int __fastcall getTxNss(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@1
  __int64 v6; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v6 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) >= 8u )
  {
    if ( a3 )
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *, __int64))(*(_QWORD *)this + 3224LL))(
                 this,
                 3223873993LL,
                 196LL,
                 a3,
                 &v6,
                 a2);
    else
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                 this,
                 3223873993LL,
                 196LL,
                 a2,
                 &v6);
    if ( !result )
      result = IO80211Controller::copyOut(this, &v6, *(_QWORD *)(v4 + 32), 8LL);
  }
  return result;
}

//----- (0000000000013013) ----------------------------------------------------
int __fastcall getGASResults(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  void *v6; // r12@4
  __int64 v7; // r14@5
  void *v8; // [sp+0h] [bp-40h]@1
  char v9; // [sp+8h] [bp-38h]@5
  __int16 v10; // [sp+Ch] [bp-34h]@6
  unsigned __int16 v11; // [sp+Eh] [bp-32h]@6
  char v12; // [sp+10h] [bp-30h]@6
  unsigned __int64 v13; // [sp+18h] [bp-28h]@6

  v4 = a4;
  v8 = 0LL;
  result = 102;
  if ( a2 )
  {
    result = 22;
    if ( *(_QWORD *)(a4 + 32) )
    {
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, void **))(*(_QWORD *)this + 3216LL))(
                 this,
                 3223873993LL,
                 200LL,
                 a2,
                 &v8);
      if ( !result )
      {
        v6 = v8;
        result = 22;
        if ( v8 )
        {
          v7 = *(_QWORD *)(v4 + 32);
          result = IO80211Controller::copyIn(this, *(_QWORD *)(v4 + 32), &v9, 24LL);
          if ( !result )
          {
            memcpy(&v9, v6, 2uLL);
            v10 = *((_WORD *)v6 + 2);
            v11 = *((_WORD *)v6 + 3);
            memcpy(&v12, (char *)v6 + 8, 6uLL);
            result = IO80211Controller::copyOut(this, *((const void **)v6 + 2), v13, v11);
            if ( !result )
              result = IO80211Controller::copyOut(this, &v9, v7, 24LL);
          }
        }
      }
    }
  }
  return result;
}

//----- (0000000000013113) ----------------------------------------------------
__int64 __fastcall getAwdlBtleStateParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-38h]@1
  __int64 v13; // [sp+10h] [bp-30h]@1
  __int64 v14; // [sp+18h] [bp-28h]@1
  int v15; // [sp+20h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v15 = 0;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 28 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 28LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlBtleStateParams(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000131DC) ----------------------------------------------------
__int64 __fastcall getAwdlPeerDatabase(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  int v12; // [sp+0h] [bp-1020h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  __bzero(&v12, 4104LL);
  v12 = 1;
  result = 22LL;
  if ( *(_DWORD *)(v4 + 24) == 4104 )
  {
    v8 = *(_QWORD *)(v4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 4104LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlPeerDatabase(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (00000000000132A8) ----------------------------------------------------
__int64 __fastcall getAwdlSecondaryMasterChannel(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlSecondaryMasterChannel(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000001334C) ----------------------------------------------------
__int64 __fastcall getAwdlAfTxMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlAfTxMode(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000133F0) ----------------------------------------------------
__int64 __fastcall getErrorString(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r15@1
  __int64 v5; // r13@1
  __int64 v6; // rbx@1
  __int64 result; // rax@3
  const char *v8; // rax@4
  const char *v9; // rcx@4
  __int64 v10; // rcx@6
  int v11; // [sp+8h] [bp-108h]@1
  unsigned int v12; // [sp+Ch] [bp-104h]@4
  int v13; // [sp+10h] [bp-100h]@5
  char v14; // [sp+14h] [bp-FCh]@5
  __int64 v15; // [sp+E0h] [bp-30h]@1

  v4 = a4;
  v5 = off_7B078[0];
  v15 = *(_QWORD *)off_7B078[0];
  v6 = 216LL;
  __bzero(&v11, 216LL);
  v11 = 1;
  if ( (unsigned __int64)*(_DWORD *)(v4 + 24) < 0xD8 )
    v6 = *(_DWORD *)(v4 + 24);
  result = IO80211Controller::copyIn(this, *(_QWORD *)(v4 + 32), &v11, v6);
  if ( !(_DWORD)result )
  {
    LODWORD(v8) = (*(int (__fastcall **)(IO80211Controller *, _QWORD))(*(_QWORD *)this + 1920LL))(this, v12);
    v9 = v8;
    result = 0LL;
    if ( v9 )
    {
      v13 = strlcpy(&v14, v9, 0xC9uLL);
      result = IO80211Controller::copyOut(this, &v11, *(_QWORD *)(v4 + 32), v6);
    }
  }
  v10 = *(_QWORD *)v5;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (00000000000134CD) ----------------------------------------------------
__int64 __fastcall getErrorNo(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r15@1
  __int64 v5; // rbx@1
  __int64 result; // rax@3
  __int64 v7; // [sp+8h] [bp-28h]@1
  __int64 v8; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v8 = 0LL;
  v7 = 1LL;
  v5 = 16LL;
  if ( (unsigned __int64)*(_DWORD *)(a4 + 24) < 0x10 )
    v5 = *(_DWORD *)(a4 + 24);
  result = IO80211Controller::copyIn(this, *(_QWORD *)(a4 + 32), &v7, v5);
  if ( !(_DWORD)result )
  {
    HIDWORD(v8) = (*(int (__fastcall **)(IO80211Controller *, _QWORD))(*(_QWORD *)this + 1928LL))(this, HIDWORD(v7));
    result = IO80211Controller::copyOut(this, &v7, *(_QWORD *)(v4 + 32), v5);
  }
  return result;
}

//----- (000000000001354B) ----------------------------------------------------
__int64 __fastcall getAwdlPrivateElectionId(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-28h]@1
  int v13; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v13 = 0;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 12 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 12LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlPrivateElectionId(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000135FE) ----------------------------------------------------
__int64 __fastcall getVhtCapabilityIE(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r12@1
  __int64 v5; // r15@1
  __int64 v6; // rbx@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  signed __int64 v9; // rbx@7
  __int64 v10; // [sp+8h] [bp-38h]@1
  __int64 v11; // [sp+10h] [bp-30h]@1
  int v12; // [sp+18h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v12 = 0;
  v11 = 0LL;
  v10 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 20 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v10, 20LL);
      if ( !(_DWORD)result )
      {
        if ( v5 || (result = 45LL, v6 != 0) )
        {
          if ( v6 )
          {
            v9 = v6 + 328;
          }
          else
          {
            result = 19LL;
            if ( !v5 )
              return result;
            v9 = v5 + 144;
          }
          result = 19LL;
          if ( *(_QWORD *)v9 )
          {
            result = IO80211PeerManager::getVHtCapabilityIE(*(IO80211PeerManager **)v9, &v10);
            if ( !(_DWORD)result )
              result = IO80211Controller::copyOut(this, &v10, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
          }
        }
      }
    }
  }
  return result;
}

//----- (00000000000136DB) ----------------------------------------------------
int __fastcall getBGScanCacheResults(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@1
  void *v6; // [sp+8h] [bp-18h]@1

  v4 = a4;
  v6 = 0LL;
  result = 102;
  if ( a2 )
  {
    result = 22;
    if ( *(_QWORD *)(a4 + 32) )
    {
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, void **))(*(_QWORD *)this + 3216LL))(
                 this,
                 3223873993LL,
                 215LL,
                 a2,
                 &v6);
      if ( !result )
      {
        result = 22;
        if ( v6 )
          result = IO80211Controller::copyOut(this, v6, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
      }
    }
  }
  return result;
}

//----- (0000000000013752) ----------------------------------------------------
int __fastcall getRoamProfile(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  __int64 v6; // r12@1
  int result; // eax@1
  __int64 v8; // rsi@2
  __int64 v9; // [sp+0h] [bp-70h]@1
  __int64 v10; // [sp+8h] [bp-68h]@1
  __int64 v11; // [sp+10h] [bp-60h]@1
  __int64 v12; // [sp+18h] [bp-58h]@1
  __int64 v13; // [sp+20h] [bp-50h]@1
  __int64 v14; // [sp+28h] [bp-48h]@1
  __int64 v15; // [sp+30h] [bp-40h]@1
  __int64 v16; // [sp+38h] [bp-38h]@1
  __int64 v17; // [sp+40h] [bp-30h]@1
  int v18; // [sp+48h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v18 = 0;
  v17 = 0LL;
  v16 = 0LL;
  v15 = 0LL;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 0LL;
  v11 = 0LL;
  v10 = 0LL;
  v9 = 0LL;
  LODWORD(v9) = 1;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 76 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v9, 76LL);
      if ( !result )
      {
        if ( v5 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     3223873993LL,
                     216LL,
                     v5,
                     &v9);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     3223873993LL,
                     216LL,
                     v6,
                     &v9);
        if ( !result )
          result = IO80211Controller::copyOut(this, &v9, *(_QWORD *)(v4 + 32), 76LL);
      }
    }
  }
  return result;
}

//----- (0000000000013853) ----------------------------------------------------
__int64 __fastcall getAwdlOperatingMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlOperatingMode(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000138F7) ----------------------------------------------------
__int64 __usercall getAwdlRestorDefaults@<rax>(IO80211Controller *this@<rdi>, __int64 a2@<rax>, __int64 a3@<rdx>, __int64 a4@<rcx>)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211AWDLPeerManager *v10; // rax@6
  IO80211AWDLPeerManager *v11; // rcx@6
  __int64 v12; // [sp-4h] [bp-20h]@1

  v12 = a2;
  v4 = a4;
  v5 = a3;
  v6 = this;
  HIDWORD(v12) = 0;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 4 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, (char *)&v12 + 4, 4LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlRestoreDefaults(v11, (unsigned int *)&v12 + 1);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, (char *)&v12 + 4, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000001399A) ----------------------------------------------------
__int64 __fastcall getAwdlEncryptType(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlEncryptType(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000013A3E) ----------------------------------------------------
int __fastcall getBTCoexProfiles(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  __int64 v6; // r12@1
  int result; // eax@1
  __int64 v8; // rsi@2
  int v9; // [sp+0h] [bp-260h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  __bzero(&v9, 572LL);
  v9 = 1;
  result = 22;
  if ( *(_DWORD *)(v4 + 24) == 572 )
  {
    v8 = *(_QWORD *)(v4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v9, 572LL);
      if ( !result )
      {
        if ( v5 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3224LL))(
                     this,
                     3223873993LL,
                     221LL,
                     v5,
                     &v9);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                     this,
                     3223873993LL,
                     221LL,
                     v6,
                     &v9);
        if ( !result )
          result = IO80211Controller::copyOut(this, &v9, *(_QWORD *)(v4 + 32), 572LL);
      }
    }
  }
  return result;
}
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000013B1D) ----------------------------------------------------
int __fastcall getBTCoexConfig(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  __int64 v6; // r12@1
  int result; // eax@1
  __int64 v8; // rsi@2
  __int64 v9; // [sp+8h] [bp-38h]@1
  __int64 v10; // [sp+10h] [bp-30h]@1
  int v11; // [sp+18h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v11 = 0;
  v10 = 0LL;
  v9 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 20 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v9, 20LL);
      if ( !result )
      {
        if ( v5 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     3223873993LL,
                     222LL,
                     v5,
                     &v9);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     3223873993LL,
                     222LL,
                     v6,
                     &v9);
        if ( !result )
          result = IO80211Controller::copyOut(this, &v9, *(_QWORD *)(v4 + 32), 20LL);
      }
    }
  }
  return result;
}

//----- (0000000000013BE7) ----------------------------------------------------
__int64 __fastcall getAwdlStatistics(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  int v12; // [sp+8h] [bp-F8h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  __bzero(&v12, 224LL);
  v12 = 1;
  result = 22LL;
  if ( *(_DWORD *)(v4 + 24) == 224 )
  {
    v8 = *(_QWORD *)(v4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 224LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::getAwdlStatistics(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000013CB3) ----------------------------------------------------
int __fastcall setSSID(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r14@1
  __int64 v6; // r15@1
  __int64 v7; // r13@1
  __int64 v8; // rcx@1
  int result; // eax@1
  __int64 v10; // rsi@2
  __int64 v11; // rcx@7
  __int64 v12; // [sp+8h] [bp-58h]@1
  __int64 v13; // [sp+10h] [bp-50h]@1
  __int64 v14; // [sp+18h] [bp-48h]@1
  __int64 v15; // [sp+20h] [bp-40h]@1
  __int64 v16; // [sp+28h] [bp-38h]@1
  __int64 v17; // [sp+30h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = off_7B078[0];
  v17 = *(_QWORD *)off_7B078[0];
  v16 = 0LL;
  v15 = 0LL;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 0LL;
  LODWORD(v12) = 1;
  v8 = *(_DWORD *)(a4 + 24);
  result = 22;
  if ( (unsigned __int64)v8 <= 0x20 )
  {
    v10 = *(_QWORD *)(v4 + 32);
    if ( v10 )
    {
      result = IO80211Controller::copyIn(this, v10, &v13, v8);
      if ( !result )
      {
        HIDWORD(v12) = *(_DWORD *)(v4 + 24);
        if ( v5 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     1LL,
                     v5,
                     &v12);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     1LL,
                     v6,
                     &v12);
      }
    }
  }
  v11 = *(_QWORD *)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000013D9C) ----------------------------------------------------
int __fastcall setAuthType(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  __int64 v6; // rdx@1
  int result; // eax@1
  __int64 v8; // rsi@2
  __int64 v9; // rcx@3
  __int64 v10; // [sp+8h] [bp-28h]@1
  int v11; // [sp+10h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v11 = 0;
  v10 = 1LL;
  v6 = *(_DWORD *)(a4 + 24);
  result = 22;
  if ( *(_DWORD *)(a4 + 24) )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      v9 = 12LL;
      if ( (unsigned int)v6 < 0xC )
        v9 = v6;
      result = IO80211Controller::copyIn(this, v8, &v10, v9);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     2LL,
                     v4,
                     &v10);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     2LL,
                     v5,
                     &v10);
      }
    }
  }
  return result;
}

//----- (0000000000013E44) ----------------------------------------------------
__int64 __fastcall setCipherKey(IO80211Controller *this, IO80211Interface *a2, IO80211VirtualInterface *a3, __int64 a4)
{
  __int64 v4; // rbx@1
  IO80211VirtualInterface *v5; // r15@1
  IO80211Interface *v6; // r14@1
  signed int v7; // er13@1
  __int64 v8; // rsi@2
  int v9; // eax@9
  bool v10; // al@14
  char v11; // al@25
  unsigned __int8 v12; // al@32
  __int64 result; // rax@36
  int v14; // [sp+8h] [bp-C8h]@1
  unsigned __int64 v15; // [sp+Ch] [bp-C4h]@4
  unsigned __int8 v16; // [sp+18h] [bp-B8h]@16
  ether_addr v17; // [sp+64h] [bp-6Ch]@21
  __int64 v18; // [sp+A0h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v18 = *(_QWORD *)off_7B078[0];
  __bzero(&v14, 148LL);
  v14 = 1;
  v7 = 22;
  if ( *(_DWORD *)(v4 + 24) != 148 )
    goto LABEL_36;
  v8 = *(_QWORD *)(v4 + 32);
  if ( !v8 )
    goto LABEL_36;
  v7 = IO80211Controller::copyIn(this, v8, &v14, 148LL);
  if ( v7 )
    goto LABEL_36;
  if ( (HIDWORD(v15) & 0xFFFFFFFE) != 6 )
  {
    if ( v5 )
    {
LABEL_9:
      v9 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211VirtualInterface *, int *))(*(_QWORD *)this + 3224LL))(
             this,
             2150132168LL,
             3LL,
             v5,
             &v14);
      goto LABEL_18;
    }
    goto LABEL_17;
  }
  if ( !v5 )
  {
    if ( (unsigned __int8)(*(int (__fastcall **)(IO80211Controller *, IO80211Interface *))(*(_QWORD *)this + 3256LL))(
                            this,
                            v6) )
      goto LABEL_11;
LABEL_17:
    v9 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211Interface *, int *))(*(_QWORD *)this + 3216LL))(
           this,
           2150132168LL,
           3LL,
           v6,
           &v14);
LABEL_18:
    v7 = v9;
    if ( !v6 )
      goto LABEL_36;
    goto LABEL_24;
  }
  if ( !(unsigned __int8)(*(int (__fastcall **)(IO80211Controller *, IO80211VirtualInterface *))(*(_QWORD *)this + 3264LL))(
                           this,
                           v5) )
    goto LABEL_9;
LABEL_11:
  if ( HIDWORD(v15) != 6 )
  {
    if ( !v6 )
    {
      v7 = IO80211VirtualInterface::cachePMKSA(v5, &v16, (unsigned int)v15, &v17);
      goto LABEL_36;
    }
    v7 = IO80211Interface::cachePMKSA(v6, &v16, (unsigned int)v15, &v17);
    goto LABEL_24;
  }
  if ( !(_DWORD)v15 )
  {
    if ( !v6 )
    {
      IO80211VirtualInterface::resetSupplicant(v5);
      v7 = 0;
      goto LABEL_36;
    }
    IO80211Interface::resetSupplicant(v6);
    v7 = 0;
    goto LABEL_24;
  }
  if ( v6 )
  {
    v10 = IO80211Interface::supplicantInitialized(v6);
    v7 = 6;
    if ( (_DWORD)v15 != 32 || !v10 )
      goto LABEL_36;
    IO80211Interface::setPMK(v6, &v16);
    v7 = 0;
LABEL_24:
    if ( v5 )
      v11 = (*(int (__fastcall **)(IO80211Controller *, IO80211VirtualInterface *))(*(_QWORD *)this + 3264LL))(this, v5);
    else
      v11 = (*(int (__fastcall **)(IO80211Controller *, IO80211Interface *))(*(_QWORD *)this + 3256LL))(this, v6);
    if ( !v11 )
    {
      if ( v17.octet[0] & 1 )
        *((_DWORD *)v6 + 142) = HIDWORD(v15);
      else
        *((_DWORD *)v6 + 141) = HIDWORD(v15);
    }
    goto LABEL_36;
  }
  v12 = IO80211VirtualInterface::supplicantInitialized(v5);
  v7 = 6;
  if ( (_DWORD)v15 == 32 && !(v12 ^ 1) )
  {
    IO80211VirtualInterface::setPMK(v5, &v16);
    v7 = 0;
  }
LABEL_36:
  result = *(_QWORD *)off_7B078[0];
  if ( *(_QWORD *)off_7B078[0] == v18 )
    result = (unsigned int)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (00000000000140AE) ----------------------------------------------------
__int64 __fastcall setChannel(IO80211Controller *this, IO80211Interface *a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r15@1
  IO80211Interface *v5; // r14@1
  __int64 v6; // rax@1
  signed int v7; // ebx@1
  __int64 v8; // rsi@2
  __int64 v9; // rcx@3
  int v10; // eax@7
  __int64 v12; // [sp+0h] [bp-30h]@1
  __int64 v13; // [sp+8h] [bp-28h]@1

  v4 = a3;
  v5 = a2;
  v13 = 0LL;
  v12 = 1LL;
  v6 = *(_DWORD *)(a4 + 24);
  v7 = 22;
  if ( *(_DWORD *)(a4 + 24) )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      v9 = 16LL;
      if ( (unsigned int)v6 < 0x10 )
        v9 = v6;
      v7 = IO80211Controller::copyIn(this, v8, &v12, v9);
      if ( !v7 )
      {
        if ( v4 )
          v10 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                  this,
                  2150132168LL,
                  4LL,
                  v4,
                  &v12);
        else
          v10 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211Interface *, __int64 *))(*(_QWORD *)this + 3216LL))(
                  this,
                  2150132168LL,
                  4LL,
                  v5,
                  &v12);
        v7 = v10;
        if ( !v10 )
        {
          v7 = 0;
          if ( v5 )
            IO80211Interface::updateChannelProperty(v5);
        }
      }
    }
  }
  return (unsigned int)v7;
}

//----- (0000000000014177) ----------------------------------------------------
int __fastcall setPowersave(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@2
  __int64 v5; // [sp+8h] [bp-8h]@1

  v5 = 1LL;
  HIDWORD(v5) = *(_DWORD *)(a4 + 20);
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               2150132168LL,
               5LL,
               a3,
               &v5);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               5LL,
               a2,
               &v5);
  return result;
}

//----- (00000000000141D5) ----------------------------------------------------
int __fastcall setProtMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@1
  __int64 v6; // rdx@2
  __int64 v7; // rsi@3
  __int64 v8; // rcx@4
  __int64 v9; // [sp+0h] [bp-20h]@1
  int v10; // [sp+8h] [bp-18h]@1

  v4 = a2;
  v10 = 0;
  v9 = 1LL;
  result = 102;
  if ( a2 )
  {
    v6 = *(_DWORD *)(a4 + 24);
    result = 22;
    if ( *(_DWORD *)(a4 + 24) )
    {
      v7 = *(_QWORD *)(a4 + 32);
      if ( v7 )
      {
        v8 = 12LL;
        if ( (unsigned int)v6 < 0xC )
          v8 = v6;
        result = IO80211Controller::copyIn(this, v7, &v9, v8);
        if ( !result )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     6LL,
                     v4,
                     &v9);
      }
    }
  }
  return result;
}

//----- (000000000001425C) ----------------------------------------------------
int __fastcall setTxPower(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@1
  __int64 v5; // rax@2
  __int64 v6; // [sp+0h] [bp-20h]@1
  int v7; // [sp+8h] [bp-18h]@1

  v7 = 0;
  v6 = 1LL;
  result = 102;
  if ( a2 )
  {
    v5 = 12LL;
    if ( (unsigned __int64)*(_DWORD *)(a4 + 24) < 0xC )
      v5 = *(_DWORD *)(a4 + 24);
    result = IO80211Controller::copyIn(this, *(_QWORD *)(a4 + 32), &v6, v5);
    if ( !result )
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                 this,
                 2150132168LL,
                 7LL,
                 a2,
                 &v6);
  }
  return result;
}

//----- (00000000000142D8) ----------------------------------------------------
int __fastcall setRate(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@2
  __int64 v5; // [sp+8h] [bp-18h]@1
  __int64 v6; // [sp+10h] [bp-10h]@1
  __int64 v7; // [sp+18h] [bp-8h]@1

  v7 = 0LL;
  v6 = 0LL;
  v5 = 1LL;
  HIDWORD(v5) = 1;
  v6 = *(_DWORD *)(a4 + 20);
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               2150132168LL,
               8LL,
               a3,
               &v5);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               8LL,
               a2,
               &v5);
  return result;
}

//----- (0000000000014356) ----------------------------------------------------
int __fastcall setBSSID(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@1
  __int64 v6; // [sp+8h] [bp-28h]@1
  int v7; // [sp+10h] [bp-20h]@1

  v4 = a3;
  v7 = 0;
  v6 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 6 )
  {
    result = IO80211Controller::copyIn(this, *(_QWORD *)(a4 + 32), (char *)&v6 + 4, 6LL);
    if ( !result )
    {
      if ( v4 )
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                   this,
                   2150132168LL,
                   9LL,
                   v4,
                   &v6);
      else
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                   this,
                   2150132168LL,
                   9LL,
                   a2,
                   &v6);
    }
  }
  return result;
}

//----- (00000000000143F0) ----------------------------------------------------
__int64 __fastcall setScanRequest(IO80211Controller *this, IO80211Interface *a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r13@1
  IO80211Interface *v5; // r14@1
  void *v6; // rax@1
  __int64 v7; // r12@1
  signed int v8; // ebx@1
  __int64 v9; // rsi@5
  __int64 v10; // rcx@6
  int v11; // ebx@11
  bool v12; // zf@11
  IO80211ScanManager *v13; // rdi@12

  v4 = a4;
  v5 = a2;
  LODWORD(v6) = IOMalloc(2388LL);
  v7 = (__int64)v6;
  v8 = 12;
  if ( v6 )
  {
    bzero(v6, 0x954uLL);
    *(_DWORD *)v7 = 1;
    v8 = 102;
    if ( a2 )
    {
      v8 = 16;
      if ( !IO80211Interface::netBooting(a2) )
      {
        v8 = 22;
        if ( *(_DWORD *)(v4 + 24) )
        {
          v9 = *(_QWORD *)(v4 + 32);
          if ( v9 )
          {
            v10 = 2388LL;
            if ( *(_DWORD *)(v4 + 24) < 0x954u )
              v10 = *(_DWORD *)(v4 + 24);
            v8 = IO80211Controller::copyIn(this, v9, (void *)v7, v10);
            if ( !v8 )
            {
              if ( *(_DWORD *)(v7 + 52) == 3
                || !IO80211Interface::pidLocked(v5)
                || (v11 = *((_DWORD *)v5 + 127), v12 = v11 == proc_selfpid(v5, v9), v8 = 16, v12) )
              {
                v13 = (IO80211ScanManager *)*((_QWORD *)v5 + 62);
                v8 = 6;
                if ( v13 )
                  v8 = IO80211ScanManager::startScan(v13, v7);
              }
            }
          }
        }
      }
    }
    IOFree(v7, 2388LL);
  }
  return (unsigned int)v8;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// C8D20: using guessed type int __fastcall proc_selfpid(_QWORD, _QWORD);

//----- (00000000000144EE) ----------------------------------------------------
int __fastcall setPhyMode(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@1
  __int64 v5; // [sp+0h] [bp-10h]@1
  int v6; // [sp+8h] [bp-8h]@1

  v6 = 0;
  v5 = 1LL;
  result = 102;
  if ( a2 )
  {
    HIDWORD(v5) = *(_DWORD *)(a4 + 20);
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               14LL,
               a2,
               &v5);
  }
  return result;
}

//----- (000000000001453D) ----------------------------------------------------
__int64 __fastcall setIntMit(__int64 a1, IO80211Interface *a2, __int64 a3, __int64 a4)
{
  signed int v4; // ebx@1
  __int64 v5; // rax@2
  __int64 v7; // [sp+8h] [bp-18h]@1

  v7 = 1LL;
  v4 = 102;
  if ( a2 )
  {
    HIDWORD(v7) = *(_DWORD *)(a4 + 20);
    LODWORD(v5) = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, IO80211Interface *, __int64 *))(*(_QWORD *)a1 + 3216LL))(
                    a1,
                    2150132168LL,
                    18LL,
                    a2,
                    &v7);
    v4 = v5;
    if ( !(_DWORD)v5 )
    {
      v4 = 0;
      IO80211Interface::postMessage(a2, 0LL, v5, 0LL, 7);
    }
  }
  return (unsigned int)v4;
}

//----- (00000000000145A1) ----------------------------------------------------
__int64 __fastcall setPower(IO80211Controller *this, IO80211Interface *a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  IO80211Interface *v5; // r14@1
  __int64 v6; // r13@1
  int v7; // er12@2
  __int64 v8; // rsi@4
  IO80211AWDLPeerManager *v9; // rbx@7
  __int64 v10; // rax@12
  char v11; // bl@13
  __int64 v12; // rax@16
  __int64 result; // rax@20
  __int64 v14; // [sp+0h] [bp-80h]@1
  __int64 v15; // [sp+8h] [bp-78h]@1
  __int64 v16; // [sp+10h] [bp-70h]@1
  __int64 v17; // [sp+18h] [bp-68h]@1
  __int64 v18; // [sp+20h] [bp-60h]@1
  int v19; // [sp+28h] [bp-58h]@1
  __int64 v20; // [sp+30h] [bp-50h]@1
  __int64 v21; // [sp+38h] [bp-48h]@1
  __int64 v22; // [sp+40h] [bp-40h]@1
  __int64 v23; // [sp+48h] [bp-38h]@1
  __int64 v24; // [sp+50h] [bp-30h]@1

  v4 = a3;
  v5 = a2;
  v6 = off_7B078[0];
  v24 = *(_QWORD *)off_7B078[0];
  v23 = 0LL;
  v22 = 0LL;
  v21 = 0LL;
  v20 = 1LL;
  v19 = 0;
  v18 = 0LL;
  v17 = 1LL;
  v16 = 0LL;
  v15 = 0LL;
  v14 = 1LL;
  if ( a2 || (v7 = 102, a3) )
  {
    v7 = 22;
    if ( *(_DWORD *)(a4 + 24) >= 0x18u )
    {
      v8 = *(_QWORD *)(a4 + 32);
      if ( v8 )
      {
        if ( !(unsigned int)IO80211Controller::copyIn(this, v8, &v14, 24LL) )
        {
          if ( v4 )
          {
            v9 = *(IO80211AWDLPeerManager **)(v4 + 144);
            if ( v9
              && !(unsigned int)IO80211PeerManager::getHtCapabilityIE(v9, &v20)
              && !(unsigned int)IO80211PeerManager::getVHtCapabilityIE(v9, &v17) )
            {
              v7 = 0;
              IO80211AWDLPeerManager::updateAndSendMI(v9, 0);
            }
          }
          else
          {
            v7 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211Interface *, __int64 *))(*(_QWORD *)this + 3216LL))(
                   this,
                   2150132168LL,
                   19LL,
                   v5,
                   &v14);
            if ( !v7 )
            {
              v10 = 0LL;
              while ( 1 )
              {
                v11 = 1;
                if ( *((_DWORD *)&v15 + v10) == 1 )
                  break;
                ++v10;
                if ( (signed int)v10 > 3 )
                {
                  v11 = 0;
                  break;
                }
              }
              (*(void (__fastcall **)(IO80211Interface *, _QWORD))(*(_QWORD *)v5 + 2720LL))(v5, (unsigned __int8)v11);
              LOBYTE(v12) = IO80211Interface::netBooting(v5);
              if ( !(_BYTE)v12 )
                IO80211Interface::postMessage(v5, 0LL, v12, 0LL, 1);
              v7 = 0;
              if ( !v11 )
              {
                v7 = 0;
                IO80211Interface::setNetBooting(v5, 0);
              }
            }
          }
        }
      }
    }
  }
  result = *(_QWORD *)v6;
  if ( *(_QWORD *)v6 == v24 )
    result = (unsigned int)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000014767) ----------------------------------------------------
__int64 __fastcall setAssociateRequest(IO80211Controller *this, IO80211Interface *a2, IO80211VirtualInterface *a3, __int64 a4)
{
  __int64 v4; // r13@1
  IO80211VirtualInterface *v5; // r14@1
  IO80211Interface *v6; // r15@1
  signed int v7; // ebx@1
  __int64 v8; // rsi@2
  int v9; // er14@5
  __int64 v10; // r14@6
  __int64 v11; // rcx@7
  int v12; // eax@15
  IO80211VirtualInterface *v13; // r14@19
  int v14; // eax@19
  __int64 v15; // rax@22
  IO80211VirtualInterface *v16; // rsi@23
  signed int v17; // ecx@24
  IO80211VirtualInterface *v18; // r14@28
  char v19; // al@28
  __int64 v20; // rsi@34
  IO80211Interface *v21; // r15@35
  char v22; // al@35
  char v23; // al@40
  __int64 result; // rax@45
  IO80211VirtualInterface *v25; // [sp+0h] [bp-230h]@2
  IO80211Interface *v26; // [sp+8h] [bp-228h]@4
  __int64 v27; // [sp+10h] [bp-220h]@34
  __int64 v28; // [sp+20h] [bp-210h]@14
  int v29; // [sp+28h] [bp-208h]@14
  int v30; // [sp+30h] [bp-200h]@1
  unsigned __int16 v31; // [sp+38h] [bp-1F8h]@22
  int v32; // [sp+70h] [bp-1C0h]@38
  unsigned __int8 v33; // [sp+78h] [bp-1B8h]@40
  unsigned __int8 v34; // [sp+FEh] [bp-132h]@35
  char v35; // [sp+1FFh] [bp-31h]@13
  __int64 v36; // [sp+200h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v36 = *(_QWORD *)off_7B078[0];
  __bzero(&v30, 464LL);
  v30 = 1;
  v7 = 22;
  if ( !*(_DWORD *)(v4 + 24) )
    goto LABEL_45;
  v25 = v5;
  v8 = *(_QWORD *)(v4 + 32);
  if ( !v8 )
    goto LABEL_45;
  if ( v6 )
  {
    v26 = v6;
    if ( IO80211Interface::pidLocked(v6) )
    {
      v9 = *((_DWORD *)v6 + 127);
      v7 = 16;
      if ( v9 != proc_selfpid(v6, v8) )
        goto LABEL_45;
    }
    v10 = *(_DWORD *)(v4 + 24);
    v7 = 16;
    if ( IO80211Interface::netBooting(v6) )
      goto LABEL_45;
    v11 = 464LL;
    if ( (unsigned int)v10 < 0x1D0 )
      v11 = v10;
    v8 = *(_QWORD *)(v4 + 32);
  }
  else
  {
    v26 = 0LL;
    v11 = 464LL;
    if ( *(_DWORD *)(v4 + 24) < 0x1D0u )
      v11 = *(_DWORD *)(v4 + 24);
  }
  v7 = IO80211Controller::copyIn(this, v8, &v30, v11);
  if ( !v7 )
  {
    if ( !(v35 & 1)
      || ((v29 = 0, v28 = 1LL, !v25) ? (v12 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211Interface *, __int64 *))(*(_QWORD *)this + 3216LL))(
                                                this,
                                                3223873993LL,
                                                9LL,
                                                v26,
                                                &v28)) : (v12 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211VirtualInterface *, __int64 *))(*(_QWORD *)this + 3224LL))(
                                                                  this,
                                                                  3223873993LL,
                                                                  9LL,
                                                                  v25,
                                                                  &v28)),
          v7 = 37,
          v12) )
    {
      IO80211Controller::joinStarted((__int64)this, 5LL);
      if ( v25 )
      {
        v13 = v25;
        v14 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211VirtualInterface *, int *))(*(_QWORD *)this + 3224LL))(
                this,
                2150132168LL,
                20LL,
                v25,
                &v30);
      }
      else
      {
        v13 = 0LL;
        v14 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211Interface *, int *))(*(_QWORD *)this + 3216LL))(
                this,
                2150132168LL,
                20LL,
                v26,
                &v30);
      }
      v7 = v14;
      if ( !v14 )
      {
        v15 = (unsigned int)(signed __int16)v31;
        if ( (signed int)v15 > 2047 )
        {
          v15 = v31;
          v16 = v13;
          if ( v31 != 2048 )
            goto LABEL_29;
        }
        else
        {
          v16 = v13;
          if ( v31 > 8u || (v17 = 278, !_bittest((const unsigned int *)&v17, v15)) )
          {
LABEL_29:
            v7 = 0;
            if ( !(v35 & 0x10) )
            {
              if ( v26 )
                IO80211Interface::terminateSupplicant(v26, v15);
              else
                IO80211VirtualInterface::terminateSupplicant(v16);
            }
            goto LABEL_45;
          }
        }
        if ( v16 )
        {
          v18 = v16;
          v19 = (*(int (__fastcall **)(IO80211Controller *))(*(_QWORD *)this + 3264LL))(this);
        }
        else
        {
          v18 = 0LL;
          v19 = (*(int (__fastcall **)(IO80211Controller *, IO80211Interface *))(*(_QWORD *)this + 3256LL))(this, v26);
        }
        if ( !v19
          || ((io80211_get_calendar_time((__int64)&v27), v20 = v27 + 15, !v26) ? (v21 = 0LL,
                                                                                  IO80211VirtualInterface::setAuthTimeout(
                                                                                    v18,
                                                                                    v20),
                                                                                  v22 = IO80211VirtualInterface::initSupplicant(
                                                                                          v18,
                                                                                          &v34)) : (IO80211Interface::setAuthTimeout(v26, v20),
                                                                                                    v21 = v26,
                                                                                                    v22 = IO80211Interface::initSupplicant(v26, &v34, 1u)),
              (v7 = 6, v22)
           && (v32 != 6
            || (!v21 ? (v23 = IO80211VirtualInterface::setPMK(v18, &v33)) : (v23 = IO80211Interface::setPMK(v21, &v33)),
                v7 = 6,
                v23))) )
          v7 = 0;
      }
    }
  }
LABEL_45:
  result = *(_QWORD *)off_7B078[0];
  if ( *(_QWORD *)off_7B078[0] == v36 )
    result = (unsigned int)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);
// C8D20: using guessed type int __fastcall proc_selfpid(_QWORD, _QWORD);

//----- (0000000000014AC1) ----------------------------------------------------
__int64 __fastcall setDisassociate(__int64 a1, IO80211Interface *a2, IO80211VirtualInterface *a3)
{
  IO80211VirtualInterface *v3; // r15@1
  int v4; // eax@2
  unsigned int v5; // ebx@4
  __int64 v6; // rax@6
  __int64 v7; // rax@10
  __int64 v9; // [sp+8h] [bp-28h]@1

  v3 = a3;
  v9 = 1LL;
  if ( a3 )
    v4 = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, IO80211VirtualInterface *, __int64 *))(*(_QWORD *)a1 + 3224LL))(
           a1,
           3223873993LL,
           15LL,
           a3,
           &v9);
  else
    v4 = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, IO80211Interface *, __int64 *))(*(_QWORD *)a1 + 3216LL))(
           a1,
           3223873993LL,
           15LL,
           a2,
           &v9);
  v5 = v4;
  if ( !v4 )
  {
    LODWORD(v6) = v3 ? (*(int (__fastcall **)(__int64, signed __int64, signed __int64, IO80211VirtualInterface *, _QWORD))(*(_QWORD *)a1 + 3224LL))(
                         a1,
                         2150132168LL,
                         22LL,
                         v3,
                         0LL) : (*(int (__fastcall **)(__int64, signed __int64, signed __int64, IO80211Interface *, _QWORD))(*(_QWORD *)a1 + 3216LL))(
                                  a1,
                                  2150132168LL,
                                  22LL,
                                  a2,
                                  0LL);
    v5 = v6;
    if ( !(_DWORD)v6 )
    {
      if ( a2 )
        LODWORD(v7) = IO80211Interface::terminateSupplicant(a2, v6);
      else
        IO80211VirtualInterface::terminateSupplicant(v3);
      v5 = 0;
      if ( BYTE4(v9) & 2 )
      {
        v5 = 0;
        if ( a2 )
          IO80211Interface::postMessage(a2, 0LL, v7, 0LL, 8);
        else
          IO80211VirtualInterface::postMessage(v3, 8uLL, 0LL, 0LL);
      }
    }
  }
  return v5;
}

//----- (0000000000014BC5) ----------------------------------------------------
__int64 __fastcall setIBSS_Or_HostAP_Mode(IO80211Controller *this, IO80211Interface *a2, IO80211VirtualInterface *a3, __int64 a4, unsigned int a5)
{
  __int64 v5; // r14@1
  __int64 v6; // r13@1
  IO80211Interface *v7; // r12@1
  IO80211Controller *v8; // r15@1
  signed int v9; // ebx@2
  int v10; // eax@4
  __int64 v11; // rax@7
  signed __int64 v12; // rdx@7
  void *v13; // rax@15
  __int64 v14; // rsi@17
  __int64 v15; // rax@19
  void *v16; // rax@25
  unsigned __int8 *v18; // rdi@39
  char *v19; // rsi@39
  __int64 v20; // rax@42
  __int64 v21; // rax@44
  __int64 v22; // rax@49
  IO80211VirtualInterface *v23; // rbx@54
  IO80211VirtualInterface *v24; // [sp+8h] [bp-5E8h]@1
  int v25; // [sp+10h] [bp-5E0h]@1
  __int16 v26; // [sp+14h] [bp-5DCh]@39
  __int16 v27; // [sp+16h] [bp-5DAh]@39
  __int16 v28; // [sp+18h] [bp-5D8h]@39
  char v29; // [sp+1Ch] [bp-5D4h]@39
  int v30; // [sp+28h] [bp-5C8h]@39
  char v31; // [sp+2Ch] [bp-5C4h]@39
  char v32; // [sp+4Ch] [bp-5A4h]@39
  int v33; // [sp+54h] [bp-59Ch]@48
  unsigned __int8 v34; // [sp+5Ch] [bp-594h]@51
  unsigned __int8 v35; // [sp+E4h] [bp-50Ch]@39
  unsigned int v36; // [sp+1E8h] [bp-408h]@39
  __int64 v37; // [sp+1F0h] [bp-400h]@38
  int v38; // [sp+1F8h] [bp-3F8h]@20
  __int16 v39; // [sp+1FCh] [bp-3F4h]@41
  __int16 v40; // [sp+1FEh] [bp-3F2h]@41
  __int16 v41; // [sp+200h] [bp-3F0h]@41
  char v42; // [sp+204h] [bp-3ECh]@41
  size_t v43; // [sp+210h] [bp-3E0h]@41
  char v44; // [sp+234h] [bp-3BCh]@41
  char v45; // [sp+2CCh] [bp-324h]@41
  unsigned __int64 v46; // [sp+3D0h] [bp-220h]@22
  int v47; // [sp+3D8h] [bp-218h]@10
  __int16 v48; // [sp+3DEh] [bp-212h]@39
  __int16 v49; // [sp+3E0h] [bp-210h]@39
  char v50; // [sp+3E4h] [bp-20Ch]@39
  size_t v51; // [sp+3F0h] [bp-200h]@39
  char v52; // [sp+414h] [bp-1DCh]@39
  char v53; // [sp+4ACh] [bp-144h]@39
  unsigned __int64 v54; // [sp+5B0h] [bp-40h]@12
  unsigned __int64 v55; // [sp+5B8h] [bp-38h]@14
  __int64 v56; // [sp+5C0h] [bp-30h]@1

  v5 = a5;
  v6 = a4;
  v24 = a3;
  v7 = a2;
  v8 = this;
  v56 = *(_QWORD *)off_7B078[0];
  __bzero(&v25, 488LL);
  v25 = 1;
  if ( !a2 )
  {
    v9 = 102;
    if ( !v24 || (unsigned int)IO80211VirtualInterface::getInterfaceRole(v24) != 5 )
      goto LABEL_36;
  }
  v10 = *(_DWORD *)(v6 + 20);
  if ( v10 != 2 )
  {
    if ( v10 == 1 )
    {
      if ( (_BYTE)v5 )
      {
        __bzero(&v47, 488LL);
        if ( *(_DWORD *)(v6 + 24) == 488 )
        {
          v9 = IO80211Controller::copyIn(this, *(_QWORD *)(v6 + 32), &v47, 488LL);
          if ( v9 )
            goto LABEL_36;
          if ( !(_DWORD)v54 )
            goto LABEL_39;
          if ( (unsigned int)v54 <= 0x400 && v55 )
          {
            LODWORD(v13) = IOMalloc((unsigned int)v54);
            v5 = (__int64)v13;
            v9 = 12;
            if ( !v13 )
              goto LABEL_36;
            v9 = IO80211Controller::copyIn(this, v55, v13, (unsigned int)v54);
            if ( !v9 )
              goto LABEL_38;
            v14 = (unsigned int)v54;
            goto LABEL_28;
          }
        }
      }
      else
      {
        __bzero(&v38, 480LL);
        if ( *(_DWORD *)(v6 + 24) == 480 )
        {
          v9 = IO80211Controller::copyIn(this, *(_QWORD *)(v6 + 32), &v38, 480LL);
          if ( v9 )
            goto LABEL_36;
          if ( (_DWORD)v46 )
          {
            if ( (unsigned int)v46 > 0x400 || !HIDWORD(v46) )
              goto LABEL_29;
            LODWORD(v16) = IOMalloc((unsigned int)v46);
            v5 = (__int64)v16;
            v9 = 12;
            if ( !v16 )
              goto LABEL_36;
            v9 = IO80211Controller::copyIn(this, HIDWORD(v46), v16, (unsigned int)v46);
            if ( v9 )
            {
              v14 = (unsigned int)v46;
LABEL_28:
              IOFree(v5, v14);
              goto LABEL_36;
            }
            v37 = v5;
          }
          v25 = v38;
          v26 = v39;
          v27 = v40;
          v28 = v41;
          memcpy(&v29, &v42, 0xCuLL);
          v30 = v43;
          memcpy(&v31, (char *)&v43 + 4, (unsigned int)v43);
          memcpy(&v32, &v44, 0x94uLL);
          v36 = v46;
          v18 = &v35;
          v19 = &v45;
          goto LABEL_42;
        }
      }
    }
LABEL_29:
    v9 = 22;
    goto LABEL_36;
  }
  if ( *(_DWORD *)(v6 + 16) == 24 )
  {
    v9 = 102;
    if ( !a2 )
      goto LABEL_36;
    v11 = *(_QWORD *)this;
    v12 = 24LL;
  }
  else
  {
    if ( v24 )
    {
      LODWORD(v15) = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211VirtualInterface *, _QWORD))(*(_QWORD *)this + 3224LL))(
                       this,
                       2150132168LL,
                       25LL,
                       v24,
                       0LL);
      goto LABEL_32;
    }
    v11 = *(_QWORD *)this;
    v12 = 25LL;
  }
  LODWORD(v15) = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211Interface *, _QWORD))(v11 + 3216))(
                   this,
                   2150132168LL,
                   v12,
                   a2,
                   0LL);
LABEL_32:
  v9 = v15;
  if ( !(_DWORD)v15 )
  {
    v9 = 0;
    if ( a2 )
      IO80211Interface::postMessage(a2, 0LL, v15, 0LL, 8);
    else
      IO80211VirtualInterface::postMessage(v24, 8uLL, 0LL, 0LL);
  }
LABEL_36:
  while ( *(_QWORD *)off_7B078[0] != v56 )
  {
LABEL_38:
    v37 = v5;
LABEL_39:
    v25 = v47;
    v26 = *(_QWORD *)&v47 >> 32;
    v27 = v48;
    v28 = v49;
    memcpy(&v29, &v50, 0xCuLL);
    v30 = v51;
    memcpy(&v31, (char *)&v51 + 4, (unsigned int)v51);
    memcpy(&v32, &v52, 0x94uLL);
    v36 = v54;
    v18 = &v35;
    v19 = &v53;
LABEL_42:
    v20 = (__int64)memcpy(v18, v19, 0x101uLL);
    if ( *(_DWORD *)(v6 + 16) != 24 )
    {
      if ( v7 )
      {
        IO80211Interface::terminateSupplicant(v7, v20);
        v23 = v24;
      }
      else
      {
        v23 = v24;
        IO80211VirtualInterface::terminateSupplicant(v24);
      }
      if ( v23 )
      {
        v24 = v23;
        LODWORD(v22) = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211VirtualInterface *, int *))(*(_QWORD *)v8 + 3224LL))(
                         v8,
                         2150132168LL,
                         25LL,
                         v23,
                         &v25);
      }
      else
      {
        v24 = 0LL;
        LODWORD(v22) = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211Interface *, int *))(*(_QWORD *)v8 + 3216LL))(
                         v8,
                         2150132168LL,
                         25LL,
                         v7,
                         &v25);
      }
      v8 = (IO80211Controller *)(unsigned int)v22;
      if ( v36 )
        LODWORD(v22) = IOFree(v37, v36);
      goto LABEL_62;
    }
    v9 = 102;
    if ( v7 )
    {
      LODWORD(v21) = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211Interface *, int *))(*(_QWORD *)v8 + 3216LL))(
                       v8,
                       2150132168LL,
                       24LL,
                       v7,
                       &v25);
      v9 = v21;
      if ( v36 )
        LODWORD(v21) = IOFree(v37, v36);
      if ( !v9 )
      {
        if ( !(v28 & 8) )
        {
          LODWORD(v22) = IO80211Interface::terminateSupplicant(v7, v21);
          v8 = 0LL;
          goto LABEL_62;
        }
        v9 = 22;
        if ( v33 == 6 )
        {
          LODWORD(v22) = (*(int (__fastcall **)(IO80211Controller *, IO80211Interface *))(*(_QWORD *)v8 + 3256LL))(
                           v8,
                           v7);
          v8 = 0LL;
          if ( !(_BYTE)v22
            || (v9 = 6, IO80211Interface::initSupplicant(v7, &v35, 2u))
            && (LOBYTE(v22) = IO80211Interface::setPMK(v7, &v34), (_BYTE)v22) )
          {
LABEL_62:
            if ( v7 )
            {
              IO80211Interface::postMessage(v7, 0LL, v22, 0LL, 8);
              v9 = (signed int)v8;
            }
            else
            {
              IO80211VirtualInterface::postMessage(v24, 8uLL, 0LL, 0LL);
              v9 = (signed int)v8;
            }
          }
        }
      }
    }
  }
  return (unsigned int)v9;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000015168) ----------------------------------------------------
int __fastcall setApMode(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@2
  __int64 v5; // [sp+8h] [bp-8h]@1

  v5 = 1LL;
  HIDWORD(v5) = *(_DWORD *)(a4 + 20);
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               2150132168LL,
               26LL,
               a3,
               &v5);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               26LL,
               a2,
               &v5);
  return result;
}

//----- (00000000000151C6) ----------------------------------------------------
int __fastcall setLocale(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@2
  __int64 v5; // [sp+8h] [bp-8h]@1

  v5 = 1LL;
  HIDWORD(v5) = *(_DWORD *)(a4 + 20);
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               2150132168LL,
               28LL,
               a3,
               &v5);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               28LL,
               a2,
               &v5);
  return result;
}

//----- (0000000000015224) ----------------------------------------------------
int __fastcall setDeauth(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  __int64 v6; // rdx@1
  int result; // eax@1
  __int64 v8; // rsi@2
  __int64 v9; // rcx@3
  __int64 v10; // [sp+8h] [bp-28h]@1
  __int64 v11; // [sp+10h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v11 = 0LL;
  v10 = 1LL;
  v6 = *(_DWORD *)(a4 + 24);
  result = 22;
  if ( *(_DWORD *)(a4 + 24) )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      v9 = 16LL;
      if ( (unsigned int)v6 < 0x10 )
        v9 = v6;
      result = IO80211Controller::copyIn(this, v8, &v10, v9);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     29LL,
                     v4,
                     &v10);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     29LL,
                     v5,
                     &v10);
      }
    }
  }
  return result;
}

//----- (00000000000152CE) ----------------------------------------------------
int __fastcall setCounterMeasures(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@1
  __int64 v5; // [sp+8h] [bp-8h]@1

  v5 = 1LL;
  result = 102;
  if ( a2 )
  {
    HIDWORD(v5) = *(_DWORD *)(a4 + 20);
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               30LL,
               a2,
               &v5);
  }
  return result;
}

//----- (0000000000015311) ----------------------------------------------------
int __fastcall setFragThreshold(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@1
  __int64 v5; // [sp+8h] [bp-8h]@1

  v5 = 1LL;
  result = 102;
  if ( a2 )
  {
    HIDWORD(v5) = *(_DWORD *)(a4 + 20);
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               31LL,
               a2,
               &v5);
  }
  return result;
}

//----- (0000000000015354) ----------------------------------------------------
int __fastcall setRateSet(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r14@1
  int result; // eax@1
  __int64 v7; // rsi@3
  __int64 v8; // rcx@4
  int v9; // [sp+8h] [bp-D8h]@1

  v4 = a4;
  v5 = a2;
  __bzero(&v9, 188LL);
  v9 = 1;
  result = 102;
  if ( a2 )
  {
    result = 22;
    if ( *(_DWORD *)(v4 + 24) )
    {
      v7 = *(_QWORD *)(v4 + 32);
      if ( v7 )
      {
        v8 = 188LL;
        if ( *(_DWORD *)(v4 + 24) < 0xBCu )
          v8 = *(_DWORD *)(v4 + 24);
        result = IO80211Controller::copyIn(this, v7, &v9, v8);
        if ( !result )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     32LL,
                     v5,
                     &v9);
      }
    }
  }
  return result;
}
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (00000000000153F8) ----------------------------------------------------
int __fastcall setShortSlot(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@1
  __int64 v5; // [sp+8h] [bp-8h]@1

  v5 = 1LL;
  result = 102;
  if ( a2 )
  {
    BYTE4(v5) = *(_BYTE *)(a4 + 20);
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               33LL,
               a2,
               &v5);
  }
  return result;
}

//----- (000000000001543B) ----------------------------------------------------
int __fastcall setMulticastRate(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@2
  __int64 v5; // [sp+8h] [bp-18h]@1
  __int64 v6; // [sp+10h] [bp-10h]@1
  __int64 v7; // [sp+18h] [bp-8h]@1

  v7 = 0LL;
  v6 = 0LL;
  v5 = 1LL;
  HIDWORD(v5) = 1;
  v6 = *(_DWORD *)(a4 + 20);
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               2150132168LL,
               34LL,
               a3,
               &v5);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               34LL,
               a2,
               &v5);
  return result;
}

//----- (00000000000154B9) ----------------------------------------------------
int __fastcall setRetryLimit(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@1
  __int64 *v5; // r8@3
  signed __int64 v6; // rdx@3
  __int64 v7; // [sp+8h] [bp-8h]@1

  v7 = 1LL;
  result = 102;
  if ( a2 )
  {
    HIDWORD(v7) = *(_DWORD *)(a4 + 20);
    if ( *(_DWORD *)(a4 + 16) == 35 )
    {
      v5 = &v7;
      v6 = 35LL;
    }
    else
    {
      v5 = &v7;
      v6 = 36LL;
    }
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               v6,
               a2,
               v5);
  }
  return result;
}

//----- (0000000000015515) ----------------------------------------------------
int __fastcall setAntenna(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rsi@3
  __int64 v7; // [sp+8h] [bp-28h]@1
  __int64 v8; // [sp+10h] [bp-20h]@1
  __int64 v9; // [sp+18h] [bp-18h]@1

  v4 = a2;
  v9 = 0LL;
  v8 = 0LL;
  v7 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = 22;
    if ( *(_DWORD *)(a4 + 24) >= 0x18u )
    {
      v6 = *(_QWORD *)(a4 + 32);
      if ( v6 )
      {
        result = IO80211Controller::copyIn(this, v6, &v7, 24LL);
        if ( !result )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     37LL,
                     v4,
                     &v7);
      }
    }
  }
  return result;
}

//----- (00000000000155A0) ----------------------------------------------------
int __fastcall setAntennaDiversity(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  __int64 v6; // rsi@3
  __int64 v7; // [sp+8h] [bp-28h]@1
  __int64 v8; // [sp+10h] [bp-20h]@1
  __int64 v9; // [sp+18h] [bp-18h]@1

  v4 = a2;
  v9 = 0LL;
  v8 = 0LL;
  v7 = 1LL;
  result = 102;
  if ( a2 )
  {
    result = 22;
    if ( *(_DWORD *)(a4 + 24) >= 0x18u )
    {
      v6 = *(_QWORD *)(a4 + 32);
      if ( v6 )
      {
        result = IO80211Controller::copyIn(this, v6, &v7, 24LL);
        if ( !result )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     39LL,
                     v4,
                     &v7);
      }
    }
  }
  return result;
}

//----- (000000000001562B) ----------------------------------------------------
int __fastcall setDTIMInt(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@1
  __int64 v5; // [sp+8h] [bp-8h]@1

  v5 = 1LL;
  result = 102;
  if ( a2 )
  {
    HIDWORD(v5) = *(_DWORD *)(a4 + 20);
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               41LL,
               a2,
               &v5);
  }
  return result;
}

//----- (000000000001566E) ----------------------------------------------------
int __fastcall setRSN_IE(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r14@1
  __int64 v6; // r15@1
  __int64 v7; // r13@1
  unsigned int v8; // ecx@1
  int result; // eax@1
  __int64 v10; // rsi@2
  signed __int16 v11; // ax@3
  __int64 v12; // rcx@9
  int v13; // [sp+8h] [bp-138h]@1
  __int16 v14; // [sp+Ch] [bp-134h]@5
  char v15; // [sp+Eh] [bp-132h]@5
  __int64 v16; // [sp+110h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = off_7B078[0];
  v16 = *(_QWORD *)off_7B078[0];
  __bzero(&v13, 264LL);
  v13 = 1;
  v8 = *(_DWORD *)(v4 + 24);
  result = 22;
  if ( v8 )
  {
    v10 = *(_QWORD *)(v4 + 32);
    if ( v10 )
    {
      v11 = 257;
      if ( v8 <= 0x101 )
        v11 = *(_DWORD *)(v4 + 24);
      v14 = v11;
      result = IO80211Controller::copyIn(this, v10, &v15, (unsigned __int16)v11);
      if ( !result )
      {
        if ( v5 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     46LL,
                     v5,
                     &v13);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     46LL,
                     v6,
                     &v13);
      }
    }
  }
  v12 = *(_QWORD *)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000015762) ----------------------------------------------------
__int64 __fastcall setBackgroundScan(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r13@1
  __int64 v5; // r14@1
  void *v6; // rax@1
  void *v7; // r12@1
  int v8; // ebx@1
  __int64 v9; // rsi@4
  __int64 v10; // rcx@5

  v4 = a4;
  v5 = a2;
  LODWORD(v6) = IOMalloc(2388LL);
  v7 = v6;
  v8 = 12;
  if ( v6 )
  {
    bzero(v6, 0x954uLL);
    *(_DWORD *)v7 = 1;
    v8 = 102;
    if ( a2 )
    {
      v8 = 22;
      if ( *(_DWORD *)(v4 + 24) )
      {
        v9 = *(_QWORD *)(v4 + 32);
        if ( v9 )
        {
          v10 = 2388LL;
          if ( *(_DWORD *)(v4 + 24) <= 0x954u )
            v10 = *(_DWORD *)(v4 + 24);
          v8 = IO80211Controller::copyIn(this, v9, v7, v10);
          if ( !v8 )
            v8 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, void *))(*(_QWORD *)this + 3216LL))(
                   this,
                   2150132168LL,
                   47LL,
                   v5,
                   v7);
        }
      }
    }
    IOFree(v7, 2388LL);
  }
  return (unsigned int)v8;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (0000000000015825) ----------------------------------------------------
int __fastcall setCountryCode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  __int64 v6; // rdx@1
  int result; // eax@1
  __int64 v8; // rsi@2
  __int64 v9; // rcx@3
  __int64 v10; // [sp+0h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v10 = 1LL;
  v6 = *(_DWORD *)(a4 + 24);
  result = 22;
  if ( *(_DWORD *)(a4 + 24) )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      v9 = 8LL;
      if ( (unsigned int)v6 < 8 )
        v9 = v6;
      result = IO80211Controller::copyIn(this, v8, &v10, v9);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     51LL,
                     v4,
                     &v10);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     51LL,
                     v5,
                     &v10);
      }
    }
  }
  return result;
}

//----- (00000000000158BE) ----------------------------------------------------
__int64 __fastcall setDebugFlags(__int64 a1, IO80211Interface *a2, IO80211VirtualInterface *a3, __int64 a4)
{
  __int64 v4; // rcx@1
  signed int v5; // ebx@5

  v4 = *(_DWORD *)(a4 + 20);
  if ( !v4 || v4 & 1 || v4 & 2 || v4 & 4 || (v5 = 22, (unsigned __int64)(v4 & 8)) )
  {
    v5 = 0;
    if ( a2 )
      IO80211Interface::setDebugFlags(a2, (unsigned int)v4);
    else
      IO80211VirtualInterface::setDebugFlags(a3, (unsigned int)v4);
  }
  return (unsigned int)v5;
}

//----- (000000000001591C) ----------------------------------------------------
int __fastcall setGuardInterval(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@1
  __int64 v5; // [sp+8h] [bp-8h]@1

  v5 = 1LL;
  result = 102;
  if ( a2 )
  {
    HIDWORD(v5) = *(_DWORD *)(a4 + 20);
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               55LL,
               a2,
               &v5);
  }
  return result;
}

//----- (000000000001595F) ----------------------------------------------------
int __fastcall setMCS(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@2
  __int64 v5; // [sp+8h] [bp-8h]@1

  v5 = 1LL;
  HIDWORD(v5) = *(_DWORD *)(a4 + 20);
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               2150132168LL,
               57LL,
               a3,
               &v5);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               57LL,
               a2,
               &v5);
  return result;
}

//----- (00000000000159BD) ----------------------------------------------------
int __fastcall setRIFS(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@1
  __int64 v5; // [sp+8h] [bp-8h]@1

  v5 = 1LL;
  result = 102;
  if ( a2 )
  {
    HIDWORD(v5) = *(_DWORD *)(a4 + 20);
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               58LL,
               a2,
               &v5);
  }
  return result;
}

//----- (0000000000015A00) ----------------------------------------------------
int __fastcall setLDPC(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@1
  __int64 v5; // [sp+8h] [bp-8h]@1

  v5 = 1LL;
  result = 102;
  if ( a2 )
  {
    HIDWORD(v5) = *(_DWORD *)(a4 + 20);
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               59LL,
               a2,
               &v5);
  }
  return result;
}

//----- (0000000000015A43) ----------------------------------------------------
int __fastcall setMSDU(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@1
  __int64 v5; // [sp+8h] [bp-8h]@1

  v5 = 1LL;
  result = 102;
  if ( a2 )
  {
    HIDWORD(v5) = *(_DWORD *)(a4 + 20);
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               60LL,
               a2,
               &v5);
  }
  return result;
}

//----- (0000000000015A86) ----------------------------------------------------
int __fastcall setMPDU(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@1
  __int64 v6; // rdx@2
  __int64 v7; // rsi@3
  __int64 v8; // rcx@4
  __int64 v9; // [sp+0h] [bp-20h]@1
  int v10; // [sp+8h] [bp-18h]@1

  v4 = a2;
  v10 = 0;
  v9 = 1LL;
  result = 102;
  if ( a2 )
  {
    v6 = *(_DWORD *)(a4 + 24);
    result = 22;
    if ( *(_DWORD *)(a4 + 24) )
    {
      v7 = *(_QWORD *)(a4 + 32);
      if ( v7 )
      {
        v8 = 12LL;
        if ( (unsigned int)v6 < 0xC )
          v8 = v6;
        result = IO80211Controller::copyIn(this, v7, &v9, v8);
        if ( !result )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     61LL,
                     v4,
                     &v9);
      }
    }
  }
  return result;
}

//----- (0000000000015B0D) ----------------------------------------------------
int __fastcall setBlockAck(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@1
  __int64 v6; // rdx@2
  __int64 v7; // rsi@3
  __int64 v8; // rcx@4
  __int64 v9; // [sp+8h] [bp-18h]@1

  v4 = a2;
  v9 = 1LL;
  result = 102;
  if ( a2 )
  {
    v6 = *(_DWORD *)(a4 + 24);
    result = 22;
    if ( *(_DWORD *)(a4 + 24) )
    {
      v7 = *(_QWORD *)(a4 + 32);
      if ( v7 )
      {
        v8 = 8LL;
        if ( (unsigned int)v6 < 8 )
          v8 = v6;
        result = IO80211Controller::copyIn(this, v7, &v9, v8);
        if ( !result )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     62LL,
                     v4,
                     &v9);
      }
    }
  }
  return result;
}

//----- (0000000000015B88) ----------------------------------------------------
int __fastcall setPLS(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@1
  __int64 v5; // [sp+8h] [bp-8h]@1

  v5 = 1LL;
  result = 102;
  if ( a2 )
  {
    HIDWORD(v5) = *(_DWORD *)(a4 + 20);
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               63LL,
               a2,
               &v5);
  }
  return result;
}

//----- (0000000000015BCB) ----------------------------------------------------
int __fastcall setPSMP(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@1
  __int64 v5; // [sp+8h] [bp-8h]@1

  v5 = 1LL;
  result = 102;
  if ( a2 )
  {
    HIDWORD(v5) = *(_DWORD *)(a4 + 20);
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               64LL,
               a2,
               &v5);
  }
  return result;
}

//----- (0000000000015C0E) ----------------------------------------------------
int __fastcall setPhySubMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@1
  __int64 v6; // rdx@2
  __int64 v7; // rsi@3
  __int64 v8; // rcx@4
  __int64 v9; // [sp+0h] [bp-20h]@1
  __int64 v10; // [sp+8h] [bp-18h]@1

  v4 = a2;
  v10 = 0LL;
  v9 = 1LL;
  result = 102;
  if ( a2 )
  {
    v6 = *(_DWORD *)(a4 + 24);
    result = 22;
    if ( *(_DWORD *)(a4 + 24) )
    {
      v7 = *(_QWORD *)(a4 + 32);
      if ( v7 )
      {
        v8 = 16LL;
        if ( (unsigned int)v6 < 0x10 )
          v8 = v6;
        result = IO80211Controller::copyIn(this, v7, &v9, v8);
        if ( !result )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     65LL,
                     v4,
                     &v9);
      }
    }
  }
  return result;
}

//----- (0000000000015C97) ----------------------------------------------------
int __fastcall setMCSIndexSet(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  __int64 v6; // r12@1
  __int64 v7; // rdx@1
  int result; // eax@1
  __int64 v9; // rsi@2
  __int64 v10; // rcx@3
  __int64 v11; // rcx@9
  __int64 v12; // [sp+8h] [bp-38h]@1
  __int64 v13; // [sp+10h] [bp-30h]@1
  __int64 v14; // [sp+18h] [bp-28h]@1

  v4 = a3;
  v5 = a2;
  v6 = off_7B078[0];
  v14 = *(_QWORD *)off_7B078[0];
  v13 = 0LL;
  v12 = 1LL;
  v7 = *(_DWORD *)(a4 + 24);
  result = 22;
  if ( *(_DWORD *)(a4 + 24) )
  {
    v9 = *(_QWORD *)(a4 + 32);
    if ( v9 )
    {
      v10 = 16LL;
      if ( (unsigned int)v7 < 0x10 )
        v10 = v7;
      result = IO80211Controller::copyIn(this, v9, &v12, v10);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     66LL,
                     v4,
                     &v12);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     66LL,
                     v5,
                     &v12);
      }
    }
  }
  v11 = *(_QWORD *)v6;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000015D63) ----------------------------------------------------
signed __int64 setCacheThreshBcast()
{
  return 102LL;
}

//----- (0000000000015D6E) ----------------------------------------------------
signed __int64 setCacheThreshDirect()
{
  return 102LL;
}

//----- (0000000000015D79) ----------------------------------------------------
__int64 __fastcall setWoWParameters(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4, char a5)
{
  char v5; // r15@1
  __int64 v6; // rbx@1
  __int64 v7; // r13@1
  __int64 v8; // r14@1
  int v9; // eax@1
  signed int v10; // er13@3
  unsigned int v11; // eax@5
  char *v12; // rcx@6
  int v13[2]; // rdx@6
  __int64 v14; // rsi@6
  unsigned int v15; // edi@7
  int v16[2]; // rcx@14
  __int64 v17; // rdx@14
  unsigned int v18; // esi@15
  void *v19; // rax@20
  __int64 v20; // r15@20
  int i; // eax@24
  __int64 v23; // rbx@31
  IO80211Controller *v24; // [sp+0h] [bp-2C0h]@0
  __int64 v25; // [sp+8h] [bp-2B8h]@20
  __int64 v26; // [sp+10h] [bp-2B0h]@3
  __int64 v27; // [sp+18h] [bp-2A8h]@1
  int v28; // [sp+20h] [bp-2A0h]@1
  char v29; // [sp+24h] [bp-29Ch]@5
  int v30; // [sp+28h] [bp-298h]@5
  unsigned int v31; // [sp+2Ch] [bp-294h]@5
  int v32[2]; // [sp+30h] [bp-290h]@6
  __int64 v33[23]; // [sp+38h] [bp-288h]@22
  int v34; // [sp+F0h] [bp-1D0h]@11
  char v35; // [sp+F4h] [bp-1CCh]@13
  int v36; // [sp+F8h] [bp-1C8h]@13
  unsigned int v37; // [sp+FCh] [bp-1C4h]@12
  int v38; // [sp+100h] [bp-1C0h]@15
  int v39[23]; // [sp+104h] [bp-1BCh]@16
  int v40; // [sp+160h] [bp-160h]@3
  char v41; // [sp+164h] [bp-15Ch]@5
  int v42; // [sp+168h] [bp-158h]@5
  unsigned int v43; // [sp+16Ch] [bp-154h]@4
  char v44; // [sp+178h] [bp-148h]@6
  unsigned __int64 v45; // [sp+230h] [bp-90h]@1
  __int64 v46; // [sp+238h] [bp-88h]@1
  __int64 v47; // [sp+240h] [bp-80h]@1
  __int64 v48; // [sp+248h] [bp-78h]@1
  __int64 v49; // [sp+250h] [bp-70h]@1
  __int64 v50; // [sp+258h] [bp-68h]@1
  __int64 v51; // [sp+260h] [bp-60h]@1
  __int64 v52; // [sp+268h] [bp-58h]@1
  __int64 v53; // [sp+270h] [bp-50h]@1
  __int64 v54; // [sp+278h] [bp-48h]@1
  __int64 v55; // [sp+280h] [bp-40h]@1
  __int64 v56; // [sp+288h] [bp-38h]@1
  __int64 v57; // [sp+290h] [bp-30h]@1

  v5 = a5;
  v6 = a4;
  v7 = a3;
  v27 = a2;
  v8 = off_7B078[0];
  v57 = *(_QWORD *)off_7B078[0];
  v56 = 0LL;
  v55 = 0LL;
  v54 = 0LL;
  v53 = 0LL;
  v52 = 0LL;
  v51 = 0LL;
  v50 = 0LL;
  v49 = 0LL;
  v48 = 0LL;
  v47 = 0LL;
  v46 = 0LL;
  v45 = 0LL;
  __bzero(&v28, 208LL);
  v28 = 1;
  v9 = *(_DWORD *)(v6 + 24);
  if ( v5 )
  {
    if ( v9 != 208 )
      goto LABEL_25;
    v26 = v7;
    v10 = IO80211Controller::copyIn(this, *(_QWORD *)(v6 + 32), &v40, 208LL);
    if ( v10 )
      goto LABEL_26;
    if ( v43 > 0xC )
      goto LABEL_25;
    v24 = this;
    v28 = v40;
    memcpy(&v29, &v41, 1uLL);
    v11 = v43;
    v30 = v42;
    v31 = v43;
    LODWORD(v8) = 0;
    if ( v43 )
    {
      v12 = &v44;
      *(_QWORD *)v13 = v32;
      v14 = 0LL;
      v8 = off_7B078[0];
      while ( 1 )
      {
        v15 = *((_DWORD *)v12 - 2);
        if ( v15 > 0x5DC )
          break;
        **(_DWORD **)v13 = v15;
        *(&v45 + v14++) = *(_QWORD *)v12;
        v12 += 16;
        *(_QWORD *)v13 += 16LL;
        if ( (unsigned int)v14 >= v11 )
          goto LABEL_17;
      }
LABEL_25:
      v10 = 22;
      goto LABEL_26;
    }
  }
  else
  {
    if ( v9 != 112 )
      goto LABEL_25;
    v26 = v7;
    v10 = IO80211Controller::copyIn(this, *(_QWORD *)(v6 + 32), &v34, 112LL);
    if ( v10 )
      goto LABEL_26;
    if ( v37 > 0xC )
      goto LABEL_25;
    v24 = this;
    v28 = v34;
    memcpy(&v29, &v35, 1uLL);
    v30 = v36;
    v11 = v37;
    v31 = v37;
    LODWORD(v8) = 0;
    if ( v37 )
    {
      *(_QWORD *)v16 = v32;
      v17 = 0LL;
      v8 = off_7B078[0];
      do
      {
        v18 = *(&v38 + 2 * v17);
        if ( v18 > 0x5DC )
          goto LABEL_25;
        **(_DWORD **)v16 = v18;
        *(&v45 + v17) = (unsigned int)v39[2 * v17];
        ++v17;
        *(_QWORD *)v16 += 16LL;
      }
      while ( (unsigned int)v17 < v11 );
LABEL_17:
      v10 = 22;
      if ( v11 > 0xC )
        goto LABEL_26;
      LODWORD(v8) = 0;
      if ( v11 )
      {
        v10 = 12;
        do
        {
          v25 = (unsigned int)v32[4 * (unsigned int)v8];
          LODWORD(v19) = IOMalloc(v25);
          v20 = (__int64)v19;
          if ( !v19 )
            goto LABEL_30;
          if ( (unsigned int)IO80211Controller::copyIn(v24, *(&v45 + (unsigned int)v8), v19, v25) )
          {
            IOFree(v20, v25);
            v10 = 22;
            goto LABEL_30;
          }
          v33[2 * (unsigned __int64)(unsigned int)v8] = v20;
          LODWORD(v8) = v8 + 1;
        }
        while ( (unsigned int)v8 < v31 );
      }
    }
  }
  if ( !v26 )
    goto LABEL_28;
  for ( i = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)v24 + 3224LL))(
              v24,
              2150132168LL,
              69LL,
              v26,
              &v28);
        ;
        i = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)v24 + 3216LL))(
              v24,
              2150132168LL,
              69LL,
              v27,
              &v28) )
  {
    v10 = i;
LABEL_30:
    if ( (_DWORD)v8 )
    {
      v23 = (__int64)v33;
      do
      {
        IOFree(*(_QWORD *)v23, *(_DWORD *)(v23 - 8));
        v23 += 16LL;
        LODWORD(v8) = v8 - 1;
      }
      while ( (_DWORD)v8 );
    }
    v8 = off_7B078[0];
LABEL_26:
    if ( *(_QWORD *)v8 == v57 )
      break;
LABEL_28:
    ;
  }
  return (unsigned int)v10;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);
// 15D79: using guessed type int var_290[2];
// 15D79: using guessed type int var_1BC[23];
// 15D79: using guessed type __int64 var_288[23];

//----- (0000000000016123) ----------------------------------------------------
int __fastcall setWoWEnabled(__int64 a1, IO80211Interface *a2, IO80211VirtualInterface *a3, __int64 a4)
{
  __int64 v4; // r15@1
  IO80211VirtualInterface *v5; // rbx@1
  __int64 v6; // r12@1
  int result; // eax@2
  __int64 v8; // rcx@10
  __int64 v9; // [sp+8h] [bp-38h]@1
  int v10; // [sp+10h] [bp-30h]@1
  __int64 v11; // [sp+18h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v6 = off_7B078[0];
  v11 = *(_QWORD *)off_7B078[0];
  v10 = 0;
  v9 = 1LL;
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, IO80211VirtualInterface *, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               3223873993LL,
               12LL,
               a3,
               &v9);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, IO80211Interface *, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               3223873993LL,
               12LL,
               a2,
               &v9);
  if ( !result )
  {
    result = 102;
    if ( BYTE6(v9) & 0x10 )
    {
      if ( a2 )
        IO80211Interface::setWoWEnabled(a2, *(_DWORD *)(v4 + 20) != 0);
      else
        IO80211VirtualInterface::setWoWEnabled(v5);
      result = 0;
    }
  }
  v8 = *(_QWORD *)v6;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (00000000000161F1) ----------------------------------------------------
int __fastcall set40MhzIntolerant(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@2
  __int64 v5; // [sp+8h] [bp-8h]@1

  v5 = 1LL;
  HIDWORD(v5) = *(_DWORD *)(a4 + 20);
  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3224LL))(
               a1,
               2150132168LL,
               71LL,
               a3,
               &v5);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               71LL,
               a2,
               &v5);
  return result;
}

//----- (000000000001624F) ----------------------------------------------------
__int64 __fastcall setPidLock(__int64 a1, IO80211Interface *a2, __int64 a3, __int64 a4)
{
  __int64 result; // rax@2

  if ( a2 )
    result = IO80211Interface::setPidLock(a2, *(_DWORD *)(a4 + 20) != 0, a3, a4);
  else
    result = 102LL;
  return result;
}

//----- (0000000000016274) ----------------------------------------------------
int __fastcall setSTA_Authorize(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-30h]@1
  __int64 v7; // [sp+8h] [bp-28h]@1
  int v8; // [sp+10h] [bp-20h]@1

  v4 = a3;
  v8 = 0;
  v7 = 0LL;
  v6 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 20 )
  {
    result = IO80211Controller::copyIn(this, *(_QWORD *)(a4 + 32), &v6, 20LL);
    if ( !result )
    {
      if ( v4 )
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                   this,
                   2150132168LL,
                   74LL,
                   v4,
                   &v6);
      else
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                   this,
                   2150132168LL,
                   74LL,
                   a2,
                   &v6);
    }
  }
  return result;
}

//----- (0000000000016319) ----------------------------------------------------
int __fastcall setSTA_DissasociateOrDeauth(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r14@1
  int result; // eax@1
  __int64 v7; // rax@5
  __int64 *v8; // r8@5
  signed __int64 v9; // rdx@5
  __int64 v10; // rax@9
  __int64 *v11; // r8@9
  signed __int64 v12; // rdx@9
  __int64 v13; // [sp+0h] [bp-30h]@1
  __int64 v14; // [sp+8h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v14 = 0LL;
  v13 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 16 )
  {
    result = IO80211Controller::copyIn(this, *(_QWORD *)(a4 + 32), &v13, 16LL);
    if ( !result )
    {
      if ( *(_DWORD *)(v4 + 16) == 75 )
      {
        if ( v5 )
        {
          v7 = *(_QWORD *)this;
          v8 = &v13;
          v9 = 75LL;
          return (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(v7 + 3224))(
                   this,
                   2150132168LL,
                   v9,
                   v5,
                   v8);
        }
        v10 = *(_QWORD *)this;
        v11 = &v13;
        v12 = 75LL;
      }
      else
      {
        if ( v5 )
        {
          v7 = *(_QWORD *)this;
          v8 = &v13;
          v9 = 76LL;
          return (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(v7 + 3224))(
                   this,
                   2150132168LL,
                   v9,
                   v5,
                   v8);
        }
        v10 = *(_QWORD *)this;
        v11 = &v13;
        v12 = 76LL;
      }
      result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(v10 + 3216))(
                 this,
                 2150132168LL,
                 v12,
                 a2,
                 v11);
    }
  }
  return result;
}

//----- (00000000000163F5) ----------------------------------------------------
int __fastcall setRSN_Conf(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r14@1
  int result; // eax@1
  int v7; // [sp+8h] [bp-C8h]@1

  v4 = a4;
  v5 = a3;
  __bzero(&v7, 164LL);
  v7 = 1;
  result = 22;
  if ( *(_DWORD *)(v4 + 24) == 164 )
  {
    result = IO80211Controller::copyIn(this, *(_QWORD *)(v4 + 32), &v7, 164LL);
    if ( !result )
    {
      if ( v5 )
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3224LL))(
                   this,
                   2150132168LL,
                   77LL,
                   v5,
                   &v7);
      else
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                   this,
                   2150132168LL,
                   77LL,
                   a2,
                   &v7);
    }
  }
  return result;
}
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (00000000000164B1) ----------------------------------------------------
int __fastcall setRoamThresh(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rsi@2
  __int64 v8; // [sp+8h] [bp-28h]@1
  int v9; // [sp+10h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v9 = 0;
  v8 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 12 )
  {
    v7 = *(_QWORD *)(a4 + 32);
    if ( v7 )
    {
      result = IO80211Controller::copyIn(this, v7, &v8, 12LL);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     80LL,
                     v4,
                     &v8);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     80LL,
                     v5,
                     &v8);
      }
    }
  }
  return result;
}

//----- (0000000000016550) ----------------------------------------------------
int __fastcall setVendorDebugFlags(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r14@1
  __int64 v6; // rcx@1
  int result; // eax@1
  __int64 v8; // [sp+8h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v8 = 1LL;
  v6 = *(_DWORD *)(a4 + 24);
  result = 22;
  if ( (unsigned __int64)v6 <= 1 )
  {
    result = IO80211Controller::copyIn(this, *(_QWORD *)(v4 + 32), (char *)&v8 + 4, v6);
    if ( !result )
    {
      if ( v5 )
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                   this,
                   2150132168LL,
                   81LL,
                   v5,
                   &v8);
      else
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                   this,
                   2150132168LL,
                   81LL,
                   a2,
                   &v8);
    }
  }
  return result;
}

//----- (00000000000165E5) ----------------------------------------------------
__int64 __fastcall setCacheAgeThresh(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 result; // rax@1
  IO80211ScanManager *v5; // rdi@2

  result = 102LL;
  if ( a2 )
  {
    v5 = *(IO80211ScanManager **)(a2 + 496);
    result = 6LL;
    if ( v5 )
      result = IO80211ScanManager::setCacheAgeThreshold(v5, *(_DWORD *)(a4 + 20), a3, a4);
  }
  return result;
}

//----- (000000000001660F) ----------------------------------------------------
__int64 __fastcall setLinkQualEventParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r13@1
  __int64 v5; // r14@1
  __int64 v6; // r15@1
  signed int v7; // ebx@1
  __int64 v8; // rsi@3
  int v9; // eax@6
  __int64 v11; // [sp+0h] [bp-40h]@1
  __int64 v12; // [sp+8h] [bp-38h]@1
  int v13; // [sp+10h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v13 = 0;
  v12 = 0LL;
  v11 = 1LL;
  v7 = 1;
  if ( procIsSuperuser((__int64)this, a2, a3, a4) )
  {
    v7 = 22;
    if ( *(_DWORD *)(v4 + 24) == 20 )
    {
      v8 = *(_QWORD *)(v4 + 32);
      if ( v8 )
      {
        v7 = IO80211Controller::copyIn(this, v8, &v11, 20LL);
        if ( !v7 )
        {
          if ( v5 )
            v9 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                   this,
                   2150132168LL,
                   84LL,
                   v5,
                   &v11);
          else
            v9 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                   this,
                   2150132168LL,
                   84LL,
                   v6,
                   &v11);
          v7 = v9;
        }
      }
    }
  }
  return (unsigned int)v7;
}

//----- (00000000000166DB) ----------------------------------------------------
__int64 __fastcall setIE(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4, char a5)
{
  __int64 v5; // r14@1
  signed int v6; // ebx@3
  void *v7; // rax@6
  __int64 v8; // r13@6
  __int64 v9; // rsi@8
  void *v11; // rax@15
  __int64 v12; // rdi@18
  int v13; // eax@19
  int v14; // eax@22
  __int64 v15; // [sp+0h] [bp-80h]@1
  __int64 v16; // [sp+8h] [bp-78h]@1
  __int64 v17; // [sp+10h] [bp-70h]@1
  __int64 v18; // [sp+18h] [bp-68h]@1
  __int64 v19; // [sp+20h] [bp-60h]@9
  __int64 v20; // [sp+28h] [bp-58h]@9
  unsigned __int64 v21; // [sp+30h] [bp-50h]@9
  __int64 v22; // [sp+38h] [bp-48h]@2
  __int64 v23; // [sp+40h] [bp-40h]@2
  unsigned __int64 v24; // [sp+48h] [bp-38h]@2
  unsigned __int64 v25; // [sp+50h] [bp-30h]@2

  v5 = a3;
  v18 = 0LL;
  v17 = 0LL;
  v16 = 0LL;
  v15 = 1LL;
  if ( a5 )
  {
    v25 = 0LL;
    v24 = 0LL;
    v23 = 0LL;
    v22 = 0LL;
    if ( *(_DWORD *)(a4 + 24) == 32 )
    {
      v6 = IO80211Controller::copyIn(this, *(_QWORD *)(a4 + 32), &v22, 32LL);
      if ( v6 )
        return (unsigned int)v6;
      if ( (unsigned int)(v24 - 1) <= 0x7FF )
      {
        v6 = 22;
        if ( HIDWORD(v23) - 1 >= (unsigned int)v24 )
          return (unsigned int)v6;
        LODWORD(v7) = IOMalloc((unsigned int)v24);
        v8 = (__int64)v7;
        v6 = 12;
        if ( !v7 )
          return (unsigned int)v6;
        v6 = IO80211Controller::copyIn(this, v25, v7, (unsigned int)v24);
        if ( v6 )
        {
          v9 = (unsigned int)v24;
LABEL_18:
          v12 = v8;
LABEL_26:
          IOFree(v12, v9);
          return (unsigned int)v6;
        }
        v18 = v8;
        v15 = v22;
        v16 = v23;
        v13 = v24;
        goto LABEL_21;
      }
    }
LABEL_12:
    v6 = 22;
    return (unsigned int)v6;
  }
  v21 = 0LL;
  v20 = 0LL;
  v19 = 0LL;
  if ( *(_DWORD *)(a4 + 24) != 24 )
    goto LABEL_12;
  v6 = IO80211Controller::copyIn(this, *(_QWORD *)(a4 + 32), &v19, 24LL);
  if ( v6 )
    return (unsigned int)v6;
  if ( (unsigned int)(v21 - 1) > 0x7FF )
    goto LABEL_12;
  v6 = 22;
  if ( HIDWORD(v20) - 1 >= (unsigned int)v21 )
    return (unsigned int)v6;
  LODWORD(v11) = IOMalloc((unsigned int)v21);
  v8 = (__int64)v11;
  v6 = 12;
  if ( !v11 )
    return (unsigned int)v6;
  v6 = IO80211Controller::copyIn(this, HIDWORD(v21), v11, (unsigned int)v21);
  if ( v6 )
  {
    v9 = (unsigned int)v21;
    goto LABEL_18;
  }
  v18 = v8;
  v15 = v19;
  v16 = v20;
  v13 = v21;
LABEL_21:
  LODWORD(v17) = v13;
  if ( v5 )
    v14 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
            this,
            2150132168LL,
            85LL,
            v5,
            &v15);
  else
    v14 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
            this,
            2150132168LL,
            85LL,
            a2,
            &v15);
  v6 = v14;
  v9 = (unsigned int)v17;
  if ( (_DWORD)v17 )
  {
    v12 = v18;
    goto LABEL_26;
  }
  return (unsigned int)v6;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000001690C) ----------------------------------------------------
__int64 __fastcall setScanRequestMultiple(IO80211Controller *this, IO80211Interface *a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  IO80211Interface *v5; // r15@1
  __int64 result; // rax@1
  char v7; // cl@2
  __int64 v8; // rsi@4
  int v9; // ebx@8
  bool v10; // zf@8
  IO80211ScanManager *v11; // rdi@9
  int v12; // [sp+0h] [bp-920h]@1
  int v13; // [sp+2F0h] [bp-630h]@6

  v4 = a4;
  v5 = a2;
  __bzero(&v12, 2312LL);
  v12 = 1;
  result = 102LL;
  if ( a2 )
  {
    v7 = IO80211Interface::netBooting(a2);
    result = 16LL;
    if ( !v7 )
    {
      result = 22LL;
      if ( *(_DWORD *)(v4 + 24) == 2312 )
      {
        v8 = *(_QWORD *)(v4 + 32);
        if ( v8 )
        {
          result = IO80211Controller::copyIn(this, v8, &v12, 2312LL);
          if ( !(_DWORD)result )
          {
            if ( v13 == 3
              || !IO80211Interface::pidLocked(v5)
              || (v9 = *((_DWORD *)v5 + 127), v10 = v9 == proc_selfpid(v5, v8), result = 16LL, v10) )
            {
              v11 = (IO80211ScanManager *)*((_QWORD *)v5 + 62);
              result = 6LL;
              if ( v11 )
                result = IO80211ScanManager::startScanMultiple(v11, &v12);
            }
          }
        }
      }
    }
  }
  return result;
}
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);
// C8D20: using guessed type int __fastcall proc_selfpid(_QWORD, _QWORD);

//----- (00000000000169E5) ----------------------------------------------------
int __fastcall setBTCoexMode(__int64 a1, IO80211Interface *a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rax@1
  __int64 v6; // [sp+0h] [bp-10h]@1

  v6 = 1LL;
  LODWORD(v4) = 102;
  if ( a2 )
  {
    HIDWORD(v6) = *(_DWORD *)(a4 + 20);
    LODWORD(v4) = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, IO80211Interface *, __int64 *))(*(_QWORD *)a1 + 3216LL))(
                    a1,
                    2150132168LL,
                    87LL,
                    a2,
                    &v6);
    if ( !(_DWORD)v4 )
    {
      IO80211Interface::postMessage(a2, (ether_addr *)((char *)&v6 + 4), v4, 4LL, 21);
      LODWORD(v4) = 0;
    }
  }
  return v4;
}

//----- (0000000000016A43) ----------------------------------------------------
int __fastcall setWoWTest(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@1
  __int64 v5; // [sp+8h] [bp-8h]@1

  v5 = 1LL;
  result = 102;
  if ( a2 )
  {
    HIDWORD(v5) = *(_DWORD *)(a4 + 20);
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               88LL,
               a2,
               &v5);
  }
  return result;
}

//----- (0000000000016A86) ----------------------------------------------------
signed __int64 __fastcall setClearPMKCache(__int64 a1, IO80211Interface *a2)
{
  signed __int64 result; // rax@1

  result = 102LL;
  if ( a2 )
  {
    IO80211Interface::freePMKSACache(a2, 102);
    result = 0LL;
  }
  return result;
}

//----- (0000000000016AA0) ----------------------------------------------------
int __fastcall setScanCacheClear(__int64 a1, __int64 a2)
{
  int result; // eax@1

  result = 102;
  if ( a2 )
  {
    IO80211ScanManager::cachePurge(*(IO80211ScanManager **)(a2 + 496), 1LL);
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, _QWORD))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               90LL,
               a2,
               0LL);
    if ( result == 102 )
      result = 0;
  }
  return result;
}

//----- (0000000000016AFC) ----------------------------------------------------
int __fastcall setP2PListen(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@1
  __int64 v6; // rdx@2
  __int64 v7; // rsi@3
  __int64 v8; // rcx@4
  __int64 v9; // [sp+8h] [bp-28h]@1
  __int64 v10; // [sp+10h] [bp-20h]@1
  int v11; // [sp+18h] [bp-18h]@1

  v4 = a3;
  v11 = 0;
  v10 = 0LL;
  v9 = 1LL;
  result = 102;
  if ( a3 )
  {
    v6 = *(_DWORD *)(a4 + 24);
    result = 22;
    if ( *(_DWORD *)(a4 + 24) )
    {
      v7 = *(_QWORD *)(a4 + 32);
      if ( v7 )
      {
        v8 = 20LL;
        if ( (unsigned int)v6 < 0x14 )
          v8 = v6;
        result = IO80211Controller::copyIn(this, v7, &v9, v8);
        if ( !result )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     92LL,
                     v4,
                     &v9);
      }
    }
  }
  return result;
}

//----- (0000000000016B8E) ----------------------------------------------------
__int64 __fastcall setP2PScan(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r13@1
  __int64 v5; // r14@1
  void *v6; // rax@1
  void *v7; // r12@1
  int v8; // ebx@1
  __int64 v9; // rsi@4
  __int64 v10; // rcx@5

  v4 = a4;
  v5 = a3;
  LODWORD(v6) = IOMalloc(2388LL);
  v7 = v6;
  v8 = 12;
  if ( v6 )
  {
    bzero(v6, 0x954uLL);
    *(_DWORD *)v7 = 1;
    v8 = 102;
    if ( v5 )
    {
      v8 = 22;
      if ( *(_DWORD *)(v4 + 24) )
      {
        v9 = *(_QWORD *)(v4 + 32);
        if ( v9 )
        {
          v10 = 2388LL;
          if ( *(_DWORD *)(v4 + 24) < 0x954u )
            v10 = *(_DWORD *)(v4 + 24);
          v8 = IO80211Controller::copyIn(this, v9, v7, v10);
          if ( !v8 )
            v8 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, void *))(*(_QWORD *)this + 3224LL))(
                   this,
                   2150132168LL,
                   93LL,
                   v5,
                   v7);
        }
      }
    }
    IOFree(v7, 2388LL);
  }
  return (unsigned int)v8;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (0000000000016C51) ----------------------------------------------------
int __fastcall setVirtualInterfaceCreate(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r12@1
  __int64 v6; // r13@1
  __int64 v7; // rcx@1
  int result; // eax@1
  __int64 v9; // rsi@2
  __int64 v10; // rbx@3
  __int64 v11; // rcx@11
  __int64 v12; // [sp+8h] [bp-58h]@2
  __int64 v13; // [sp+10h] [bp-50h]@1
  __int64 v14; // [sp+18h] [bp-48h]@1
  __int64 v15; // [sp+20h] [bp-40h]@1
  __int64 v16; // [sp+28h] [bp-38h]@1
  __int64 v17; // [sp+30h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v6 = off_7B078[0];
  v17 = *(_QWORD *)off_7B078[0];
  v16 = 0LL;
  v15 = 0LL;
  v14 = 0LL;
  v13 = 1LL;
  v7 = *(_DWORD *)(a4 + 24);
  result = 22;
  if ( v7 )
  {
    v12 = a2;
    v9 = *(_QWORD *)(v4 + 32);
    if ( v9 )
    {
      v10 = 32LL;
      if ( (unsigned int)v7 < 0x20 )
        v10 = v7;
      result = IO80211Controller::copyIn(this, v9, &v13, v10);
      if ( !result )
      {
        if ( v5 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     94LL,
                     v5,
                     &v13);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     94LL,
                     v12,
                     &v13);
        if ( !result )
          result = IO80211Controller::copyOut(this, &v13, *(_QWORD *)(v4 + 32), v10);
      }
    }
  }
  v11 = *(_QWORD *)v6;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000016D5B) ----------------------------------------------------
int __fastcall setVirtualInterfaceDelete(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  __int64 v6; // r12@1
  __int64 v7; // rdx@1
  int result; // eax@1
  __int64 v9; // rsi@2
  __int64 v10; // rcx@3
  __int64 v11; // rcx@9
  __int64 v12; // [sp+0h] [bp-40h]@1
  __int64 v13; // [sp+8h] [bp-38h]@1
  int v14; // [sp+10h] [bp-30h]@1
  __int64 v15; // [sp+18h] [bp-28h]@1

  v4 = a3;
  v5 = a2;
  v6 = off_7B078[0];
  v15 = *(_QWORD *)off_7B078[0];
  v14 = 0;
  v13 = 0LL;
  v12 = 1LL;
  v7 = *(_DWORD *)(a4 + 24);
  result = 22;
  if ( *(_DWORD *)(a4 + 24) )
  {
    v9 = *(_QWORD *)(a4 + 32);
    if ( v9 )
    {
      v10 = 20LL;
      if ( (unsigned int)v7 < 0x14 )
        v10 = v7;
      result = IO80211Controller::copyIn(this, v9, &v12, v10);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     95LL,
                     v4,
                     &v12);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     95LL,
                     v5,
                     &v12);
      }
    }
  }
  v11 = *(_QWORD *)v6;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000016E30) ----------------------------------------------------
__int64 __fastcall setP2PGroupOwnerConfigure(IO80211Controller *this, __int64 a2, IO80211VirtualInterface *a3, __int64 a4)
{
  __int64 v4; // r12@1
  IO80211VirtualInterface *v5; // r15@1
  __int64 v6; // r13@1
  int v7; // ebx@1
  __int64 v8; // rsi@4
  __int64 result; // rax@7
  __int64 v10; // [sp+0h] [bp-70h]@1
  __int64 v11; // [sp+8h] [bp-68h]@1
  __int64 v12; // [sp+10h] [bp-60h]@1
  __int64 v13; // [sp+18h] [bp-58h]@1
  __int64 v14; // [sp+20h] [bp-50h]@1
  __int64 v15; // [sp+28h] [bp-48h]@1
  __int64 v16; // [sp+30h] [bp-40h]@1
  int v17; // [sp+38h] [bp-38h]@1
  __int64 v18; // [sp+40h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v6 = off_7B078[0];
  v18 = *(_QWORD *)off_7B078[0];
  v17 = 0;
  v16 = 0LL;
  v15 = 0LL;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 0LL;
  v11 = 0LL;
  v10 = 0LL;
  LODWORD(v10) = 1;
  v7 = 102;
  if ( a3 )
  {
    if ( (unsigned int)IO80211VirtualInterface::getInterfaceRole(a3) == 3 )
    {
      v7 = 22;
      if ( *(_DWORD *)(v4 + 24) == 60 )
      {
        v8 = *(_QWORD *)(v4 + 32);
        if ( v8 )
        {
          v7 = IO80211Controller::copyIn(this, v8, &v10, 60LL);
          if ( !v7 )
            v7 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211VirtualInterface *, __int64 *))(*(_QWORD *)this + 3224LL))(
                   this,
                   2150132168LL,
                   98LL,
                   v5,
                   &v10);
        }
      }
    }
  }
  result = *(_QWORD *)v6;
  if ( *(_QWORD *)v6 == v18 )
    result = (unsigned int)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000016F23) ----------------------------------------------------
__int64 __fastcall setP2POppPS(__int64 a1, __int64 a2, IO80211VirtualInterface *a3, __int64 a4)
{
  __int64 v4; // r12@1
  IO80211VirtualInterface *v5; // rbx@1
  int v6; // er15@1
  __int64 v8; // [sp+8h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v8 = 1LL;
  v6 = 102;
  if ( a3 && (unsigned int)IO80211VirtualInterface::getInterfaceRole(a3) == 3 )
  {
    HIDWORD(v8) = *(_DWORD *)(v4 + 20);
    v6 = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, IO80211VirtualInterface *, __int64 *))(*(_QWORD *)a1 + 3224LL))(
           a1,
           2150132168LL,
           100LL,
           v5,
           &v8);
  }
  return (unsigned int)v6;
}

//----- (0000000000016F93) ----------------------------------------------------
__int64 __fastcall setP2PCTWindow(__int64 a1, __int64 a2, IO80211VirtualInterface *a3, __int64 a4)
{
  __int64 v4; // r12@1
  IO80211VirtualInterface *v5; // rbx@1
  int v6; // er15@1
  __int64 v8; // [sp+8h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v8 = 1LL;
  v6 = 102;
  if ( a3 && (unsigned int)IO80211VirtualInterface::getInterfaceRole(a3) == 3 )
  {
    HIDWORD(v8) = *(_DWORD *)(v4 + 20);
    v6 = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, IO80211VirtualInterface *, __int64 *))(*(_QWORD *)a1 + 3224LL))(
           a1,
           2150132168LL,
           101LL,
           v5,
           &v8);
  }
  return (unsigned int)v6;
}

//----- (0000000000017003) ----------------------------------------------------
signed __int64 setBTCoexFlags()
{
  return 102LL;
}

//----- (000000000001700E) ----------------------------------------------------
signed __int64 setBTPower()
{
  return 102LL;
}

//----- (0000000000017019) ----------------------------------------------------
int __fastcall setRoam(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rsi@2
  __int64 v8; // [sp+8h] [bp-28h]@1
  int v9; // [sp+10h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v9 = 0;
  v8 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 12 )
  {
    v7 = *(_QWORD *)(a4 + 32);
    if ( v7 )
    {
      result = IO80211Controller::copyIn(this, v7, &v8, 12LL);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     107LL,
                     v4,
                     &v8);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     107LL,
                     v5,
                     &v8);
      }
    }
  }
  return result;
}

//----- (00000000000170B8) ----------------------------------------------------
int __fastcall setTXChainPower(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rsi@2
  __int64 v8; // [sp+0h] [bp-30h]@1
  __int64 v9; // [sp+8h] [bp-28h]@1
  __int64 v10; // [sp+10h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v10 = 0LL;
  v9 = 0LL;
  v8 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 24 )
  {
    v7 = *(_QWORD *)(a4 + 32);
    if ( v7 )
    {
      result = IO80211Controller::copyIn(this, v7, &v8, 24LL);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     108LL,
                     v4,
                     &v8);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     108LL,
                     v5,
                     &v8);
      }
    }
  }
  return result;
}

//----- (0000000000017164) ----------------------------------------------------
int __fastcall setCDDMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rsi@2
  __int64 v8; // [sp+8h] [bp-28h]@1
  int v9; // [sp+10h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v9 = 0;
  v8 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 12 )
  {
    v7 = *(_QWORD *)(a4 + 32);
    if ( v7 )
    {
      result = IO80211Controller::copyIn(this, v7, &v8, 12LL);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     109LL,
                     v4,
                     &v8);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     109LL,
                     v5,
                     &v8);
      }
    }
  }
  return result;
}

//----- (0000000000017203) ----------------------------------------------------
int __fastcall setThermalThrottling(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rsi@2
  __int64 v8; // [sp+0h] [bp-30h]@1
  __int64 v9; // [sp+8h] [bp-28h]@1
  __int64 v10; // [sp+10h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v10 = 0LL;
  v9 = 0LL;
  v8 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 24 )
  {
    v7 = *(_QWORD *)(a4 + 32);
    if ( v7 )
    {
      result = IO80211Controller::copyIn(this, v7, &v8, 24LL);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     111LL,
                     v4,
                     &v8);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     111LL,
                     v5,
                     &v8);
      }
    }
  }
  return result;
}

//----- (00000000000172AF) ----------------------------------------------------
int __fastcall setFactoryMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rsi@2
  __int64 v8; // [sp+0h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v8 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v7 = *(_QWORD *)(a4 + 32);
    if ( v7 )
    {
      result = IO80211Controller::copyIn(this, v7, &v8, 8LL);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     112LL,
                     v4,
                     &v8);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     112LL,
                     v5,
                     &v8);
      }
    }
  }
  return result;
}

//----- (000000000001733F) ----------------------------------------------------
int __fastcall setReassociate(__int64 a1, __int64 a2, __int64 a3)
{
  int result; // eax@2

  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, _QWORD))(*(_QWORD *)a1 + 3224LL))(
               a1,
               2150132168LL,
               113LL,
               a3,
               0LL);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, _QWORD))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               113LL,
               a2,
               0LL);
  return result;
}

//----- (0000000000017386) ----------------------------------------------------
__int64 __fastcall setAwdlSyncParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-30h]@1
  __int64 v13; // [sp+8h] [bp-28h]@1
  __int64 v14; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 24 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 24LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlSyncParams(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000017446) ----------------------------------------------------
__int64 __fastcall setAwdlSyncEnabled(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211AWDLPeerManager *v10; // rax@6
  IO80211AWDLPeerManager *v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-28h]@1
  int v13; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v13 = 0;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 12 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 12LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlSyncEnabled(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000174F9) ----------------------------------------------------
__int64 __fastcall setAwdlExtensionParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-30h]@1
  __int64 v13; // [sp+8h] [bp-28h]@1
  int v14; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v14 = 0;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 20 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 20LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlExtensionParams(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000175B7) ----------------------------------------------------
__int64 __fastcall setAwdlPeerServiceParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 v7; // r12@1
  __int64 result; // rax@1
  __int64 v9; // rsi@2
  __int64 v10; // rdi@5
  __int64 v11; // rax@6
  __int64 v12; // rcx@6
  __int64 v13; // rcx@9
  __int64 v14; // [sp+8h] [bp-58h]@1
  __int64 v15; // [sp+10h] [bp-50h]@1
  __int64 v16; // [sp+18h] [bp-48h]@1
  __int64 v17; // [sp+20h] [bp-40h]@1
  __int64 v18; // [sp+28h] [bp-38h]@1
  int v19; // [sp+30h] [bp-30h]@1
  __int64 v20; // [sp+38h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v7 = off_7B078[0];
  v20 = *(_QWORD *)off_7B078[0];
  v19 = 0;
  v18 = 0LL;
  v17 = 0LL;
  v16 = 0LL;
  v15 = 0LL;
  v14 = 0LL;
  LODWORD(v14) = 1;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 44 )
  {
    v9 = *(_QWORD *)(a4 + 32);
    if ( v9 )
    {
      result = IO80211Controller::copyIn(this, v9, &v14, 44LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v10 = *(_QWORD *)(v5 + 144);
          if ( v10 )
          {
            LODWORD(v11) = OSMetaClassBase::safeMetaCast(v10, IO80211AWDLPeerManager::metaClass);
            v12 = v11;
            result = 19LL;
            if ( v12 )
            {
              result = IO80211AWDLPeerManager::setAwdlPeerServiceParams(v12, (__int64)&v14);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v14, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  v13 = *(_QWORD *)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000176AE) ----------------------------------------------------
__int64 __fastcall setAwdlPeerServiceRequest(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211AWDLPeerManager *v10; // rax@6
  IO80211AWDLPeerManager *v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-38h]@1
  __int64 v13; // [sp+10h] [bp-30h]@1
  __int64 v14; // [sp+18h] [bp-28h]@1
  __int64 v15; // [sp+20h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v15 = 0LL;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 32 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 32LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlPeerServiceRequest(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000017779) ----------------------------------------------------
__int64 __fastcall setAwdlElectionId(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlElectionId(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000001781D) ----------------------------------------------------
__int64 __fastcall setAwdlMaxTreeDepth(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlMaxTreeDepth(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000178C1) ----------------------------------------------------
__int64 __fastcall setAwdlGuardTime(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlGuardTime(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000017965) ----------------------------------------------------
__int64 __fastcall setAwdlBssid(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-28h]@1
  __int64 v13; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 16 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 16LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlBssid(v11, &v12, 19LL);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000017A1A) ----------------------------------------------------
__int64 __fastcall setAwdlElectionMetric(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlElectionMetric(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000017ABE) ----------------------------------------------------
__int64 __fastcall setAwdlAvailabilityWindowApAlignment(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-28h]@1
  __int64 v13; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 16 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 16LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlAvailabilityWindowApAlignment(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000017B73) ----------------------------------------------------
__int64 __fastcall setAwdlSyncFrameApAlignment(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-28h]@1
  int v13; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v13 = 0;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 12 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 12LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlSyncFrameApAlignment();
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000017C26) ----------------------------------------------------
__int64 __fastcall setAwdlChannelSequence(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r15@1
  __int64 v5; // r14@1
  __int64 v6; // rsi@1
  signed int v7; // ebx@1
  signed int v8; // eax@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  int v12; // [sp+0h] [bp-1B0h]@1

  v4 = a4;
  v5 = a3;
  __bzero(&v12, 400LL);
  v12 = 1;
  v6 = *(_QWORD *)(v4 + 32);
  v7 = 22;
  if ( v6 )
  {
    v8 = IO80211Controller::copyIn(this, v6, &v12, 400LL);
    if ( *(_DWORD *)(v4 + 24) == 400 )
    {
      v7 = v8;
      if ( !v8 )
      {
        v7 = 45;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v7 = 19;
            if ( v10 )
              v7 = IO80211AWDLPeerManager::setAwdlChannelSequence(v10, &v12);
          }
        }
      }
    }
  }
  return (unsigned int)v7;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000017CE0) ----------------------------------------------------
__int64 __fastcall setAwdlMaxPeers(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlMaxPeers(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000017D84) ----------------------------------------------------
__int64 __fastcall setAwdlOUI(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlOUI(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000017E28) ----------------------------------------------------
__int64 __fastcall setAwdlMasterChannel(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlMasterChannel(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000017ECC) ----------------------------------------------------
__int64 __fastcall setAwdlTopMaster(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-28h]@1
  __int64 v13; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 16 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 16LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlTopMaster();
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000017F81) ----------------------------------------------------
__int64 __fastcall setAwdlSyncState(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211AWDLPeerManager *v10; // rax@6
  IO80211AWDLPeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-30h]@1
  __int64 v13; // [sp+8h] [bp-28h]@1
  int v14; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v14 = 0;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 20 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 20LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlSyncState(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000001803F) ----------------------------------------------------
__int64 __fastcall setAwdlElectionRssiThresholds(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-30h]@1
  __int64 v13; // [sp+8h] [bp-28h]@1
  int v14; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v14 = 0;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 20 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 20LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlElectionRssiThresholds(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000180FD) ----------------------------------------------------
__int64 __fastcall setAwdlPresenceMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlPresenceMode(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000181A1) ----------------------------------------------------
__int64 __fastcall setAwdlElectionMasterCounts(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-28h]@1
  __int64 v13; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 16 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 16LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlElectionMasterCounts(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000018256) ----------------------------------------------------
__int64 __fastcall setAwdlSyncFramePacketLifetime(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlSyncFramePacketLifetime(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000182FA) ----------------------------------------------------
__int64 __fastcall setAwdlMasterSyncFramePeriod(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlMasterSyncFramePeriod();
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000001839E) ----------------------------------------------------
signed int __fastcall setAwdlNonElectionMasterSyncFramePeriod(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  signed int result; // eax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !result )
      {
        result = 45;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlNonElectionMasterSyncFramePeriod(v11, (__int64)&v12);
              if ( !result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000018442) ----------------------------------------------------
__int64 __fastcall setPeerCacheControl(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r13@1
  __int64 v5; // r15@1
  __int64 v6; // r12@1
  __int64 v7; // rcx@1
  signed int v8; // ebx@1
  __int64 v9; // rsi@2
  __int64 v10; // rbx@3
  signed int v11; // eax@3
  signed __int64 v12; // r15@6
  IO80211PeerManager **v13; // rax@6
  __int64 v14; // r12@9
  signed int v15; // eax@9
  __int64 result; // rax@11
  __int64 v17; // [sp+0h] [bp-70h]@1
  __int64 v18; // [sp+8h] [bp-68h]@1
  __int64 v19; // [sp+10h] [bp-60h]@1
  __int64 v20; // [sp+18h] [bp-58h]@1
  __int64 v21; // [sp+20h] [bp-50h]@1
  __int64 v22; // [sp+28h] [bp-48h]@1
  __int64 v23; // [sp+30h] [bp-40h]@1
  int v24; // [sp+38h] [bp-38h]@1
  __int64 v25; // [sp+40h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = off_7B078[0];
  v25 = *(_QWORD *)off_7B078[0];
  v24 = 0;
  v23 = 0LL;
  v22 = 0LL;
  v21 = 0LL;
  v20 = 0LL;
  v19 = 0LL;
  v18 = 0LL;
  v17 = 0LL;
  LODWORD(v17) = 1;
  v8 = 22;
  if ( *(_DWORD *)(v4 + 24) == 60 )
  {
    v9 = *(_QWORD *)(v4 + 32);
    if ( v9 )
    {
      v10 = off_7B078[0];
      v11 = IO80211Controller::copyIn(this, v9, &v17, 60LL);
      v7 = v10;
      v8 = v11;
      if ( !v11 )
      {
        if ( v5 || (v8 = 45, v6) )
        {
          v12 = v5 + 144;
          v13 = (IO80211PeerManager **)(v6 + 328);
          if ( !v6 )
            v13 = (IO80211PeerManager **)v12;
          v8 = 19;
          if ( *v13 )
          {
            v14 = v7;
            v8 = IO80211PeerManager::setPeerCacheControl(*v13, (__int64)&v17);
            v15 = IO80211Controller::copyOut(this, &v17, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            v7 = v14;
            if ( v15 )
              v8 = v15;
          }
        }
      }
    }
  }
  result = *(_QWORD *)v7;
  if ( *(_QWORD *)v7 == v25 )
    result = (unsigned int)v8;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000018566) ----------------------------------------------------
__int64 __fastcall setAwdlBtCoexProtectedPeriodLength(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlBtCoexProtectedPeriodLength(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000001860A) ----------------------------------------------------
__int64 __fastcall setAwdlStrategy(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-30h]@1
  __int64 v13; // [sp+8h] [bp-28h]@1
  __int64 v14; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 24 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 24LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlStrategy(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000186CA) ----------------------------------------------------
signed int __fastcall setAwdlMaxNoMasterPeriods(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  signed int result; // eax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !result )
      {
        result = 45;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlMaxNoMasterPeriods(v11, (__int64)&v12);
              if ( !result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000001876E) ----------------------------------------------------
__int64 __fastcall setAwdlSyncFrameTemplate(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-28h]@1
  __int64 v13; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 16 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 16LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlSyncFrameTemplate();
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000018823) ----------------------------------------------------
__int64 __fastcall setLogFlags(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r15@1
  __int64 v5; // rbx@1
  __int64 v6; // r12@1
  IO80211Controller *v7; // r14@1
  __int64 result; // rax@1
  __int64 v9; // rsi@2
  signed __int64 v10; // rbx@6
  signed __int64 v11; // rax@6
  IO80211PeerManager *v12; // rdi@8
  unsigned int v13; // ebx@9
  unsigned int v14; // eax@9
  __int64 v15; // [sp+8h] [bp-38h]@1
  __int64 v16; // [sp+10h] [bp-30h]@1
  __int64 v17; // [sp+18h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = this;
  v17 = 0LL;
  v16 = 0LL;
  v15 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 24 )
  {
    v9 = *(_QWORD *)(a4 + 32);
    if ( v9 )
    {
      result = IO80211Controller::copyIn(this, v9, &v15, 24LL);
      if ( !(_DWORD)result )
      {
        if ( v5 || (result = 45LL, v6) )
        {
          v10 = v5 + 144;
          v11 = v6 + 328;
          if ( !v6 )
            v11 = v10;
          v12 = *(IO80211PeerManager **)v11;
          result = 19LL;
          if ( v12 )
          {
            v13 = IO80211PeerManager::setLogFlags(v12, (__int64)&v15);
            v14 = IO80211Controller::copyOut(v7, &v15, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            if ( v14 )
              v13 = v14;
            result = v13;
          }
        }
      }
    }
  }
  return result;
}

//----- (00000000000188F0) ----------------------------------------------------
__int64 __fastcall setPeerStats(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 result; // rax@1
  __int64 v6; // rsi@2
  __int64 v7; // r15@4
  __int64 v8; // [sp+8h] [bp-38h]@1
  __int64 v9; // [sp+10h] [bp-30h]@1
  __int64 v10; // [sp+18h] [bp-28h]@1
  int v11; // [sp+20h] [bp-20h]@1

  v4 = a4;
  v11 = 0;
  v10 = 0LL;
  v9 = 0LL;
  v8 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 28 )
  {
    v6 = *(_QWORD *)(a4 + 32);
    if ( v6 )
    {
      result = 45LL;
      if ( a3 )
      {
        v7 = *(_QWORD *)(a3 + 144);
        result = 19LL;
        if ( v7 )
        {
          result = IO80211Controller::copyIn(this, v6, &v8, 28LL);
          if ( !(_DWORD)result )
          {
            result = IO80211PeerManager::getPeerStats(v7, (__int64)&v8);
            if ( !(_DWORD)result )
              result = IO80211Controller::copyOut(this, &v8, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
          }
        }
      }
    }
  }
  return result;
}

//----- (000000000001899F) ----------------------------------------------------
__int64 __fastcall setHTCapability(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 v7; // r12@1
  __int64 result; // rax@1
  __int64 v9; // rsi@2
  __int64 v10; // rdi@5
  IO80211PeerManager *v11; // rax@6
  IO80211PeerManager *v12; // rcx@6
  __int64 v13; // rcx@9
  __int64 v14; // [sp+8h] [bp-48h]@1
  __int64 v15; // [sp+10h] [bp-40h]@1
  __int64 v16; // [sp+18h] [bp-38h]@1
  __int64 v17; // [sp+20h] [bp-30h]@1
  __int64 v18; // [sp+28h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v7 = off_7B078[0];
  v18 = *(_QWORD *)off_7B078[0];
  v17 = 0LL;
  v16 = 0LL;
  v15 = 0LL;
  v14 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 32 )
  {
    v9 = *(_QWORD *)(a4 + 32);
    if ( v9 )
    {
      result = IO80211Controller::copyIn(this, v9, &v14, 32LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v10 = *(_QWORD *)(v5 + 144);
          if ( v10 )
          {
            LODWORD(v11) = OSMetaClassBase::safeMetaCast(v10, IO80211AWDLPeerManager::metaClass);
            v12 = v11;
            result = 19LL;
            if ( v12 )
            {
              result = IO80211PeerManager::setHtCapabilityIE(v12, &v14);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v14, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  v13 = *(_QWORD *)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000018A8C) ----------------------------------------------------
__int64 __fastcall setAwdlElectionParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-50h]@1
  __int64 v13; // [sp+8h] [bp-48h]@1
  __int64 v14; // [sp+10h] [bp-40h]@1
  __int64 v15; // [sp+18h] [bp-38h]@1
  __int64 v16; // [sp+20h] [bp-30h]@1
  __int64 v17; // [sp+28h] [bp-28h]@1
  __int64 v18; // [sp+30h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v18 = 0LL;
  v17 = 0LL;
  v16 = 0LL;
  v15 = 0LL;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 0LL;
  LODWORD(v12) = 1;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 56 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 56LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlElectionParams(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000018B6A) ----------------------------------------------------
__int64 __fastcall setDebugInfo(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r15@1
  signed __int64 v5; // r14@1
  void *v6; // rax@1
  void *v7; // rbx@1
  signed int v8; // er12@1
  __int64 v9; // rsi@5
  __int64 v11; // [sp+0h] [bp-30h]@1

  v4 = a4;
  v11 = a3;
  v5 = 1472LL;
  LODWORD(v6) = IOMalloc(1472LL);
  v7 = v6;
  v8 = 0;
  if ( !v6 )
    v5 = (signed __int64)v6;
  if ( v6 )
  {
    v8 = 22;
    if ( *(_DWORD *)(v4 + 24) == 1472 )
    {
      v9 = *(_QWORD *)(v4 + 32);
      if ( v9 )
      {
        v8 = IO80211Controller::copyIn(this, v9, v6, 1472LL);
        if ( !v8 )
        {
          v8 = 0;
          if ( v11 )
            (*(void (__fastcall **)(__int64, void *))(*(_QWORD *)v11 + 2208LL))(v11, v7);
        }
      }
    }
    IOFree(v7, v5);
  }
  return (unsigned int)v8;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (0000000000018C07) ----------------------------------------------------
__int64 __fastcall setAwdlScanReservedTime(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlScanReservedTime(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000018CAB) ----------------------------------------------------
__int64 __fastcall setAwdlCtl(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r13@1
  __int64 v5; // r15@1
  __int64 v6; // r12@1
  int v7; // ebx@1
  __int64 v8; // rsi@2
  signed __int64 v9; // r15@6
  signed __int64 v10; // rax@6
  int v11; // eax@9
  __int64 result; // rax@11
  int v13; // [sp+8h] [bp-D8h]@1
  __int64 v14; // [sp+B0h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v14 = *(_QWORD *)off_7B078[0];
  __bzero(&v13, 168LL);
  v13 = 1;
  v7 = 22;
  if ( *(_DWORD *)(v4 + 24) == 168 )
  {
    v8 = *(_QWORD *)(v4 + 32);
    if ( v8 )
    {
      v7 = IO80211Controller::copyIn(this, v8, &v13, 168LL);
      if ( !v7 )
      {
        if ( v5 || (v7 = 45, v6) )
        {
          v9 = v5 + 144;
          v10 = v6 + 328;
          if ( !v6 )
            v10 = v9;
          v7 = 19;
          if ( *(_QWORD *)v10 )
          {
            v7 = (*(int (__fastcall **)(_QWORD, int *))(**(_QWORD **)v10 + 328LL))(*(_QWORD *)v10, &v13);
            v11 = IO80211Controller::copyOut(this, &v13, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            if ( v11 )
              v7 = v11;
          }
        }
      }
    }
  }
  result = *(_QWORD *)off_7B078[0];
  if ( *(_QWORD *)off_7B078[0] == v14 )
    result = (unsigned int)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000018DB2) ----------------------------------------------------
__int64 __fastcall setAwdlSocialTimeSlots(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlSocialTimeSlots(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000018E56) ----------------------------------------------------
__int64 __fastcall setAwdlPeerTrafficRegistration(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 v7; // r12@1
  __int64 result; // rax@1
  __int64 v9; // rsi@2
  __int64 v10; // rdi@5
  IO80211AWDLPeerManager *v11; // rax@6
  IO80211AWDLPeerManager *v12; // rcx@6
  __int64 v13; // rcx@9
  __int64 v14; // [sp+8h] [bp-78h]@1
  __int64 v15; // [sp+10h] [bp-70h]@1
  __int64 v16; // [sp+18h] [bp-68h]@1
  __int64 v17; // [sp+20h] [bp-60h]@1
  __int64 v18; // [sp+28h] [bp-58h]@1
  __int64 v19; // [sp+30h] [bp-50h]@1
  __int64 v20; // [sp+38h] [bp-48h]@1
  __int64 v21; // [sp+40h] [bp-40h]@1
  __int64 v22; // [sp+48h] [bp-38h]@1
  __int64 v23; // [sp+50h] [bp-30h]@1
  __int64 v24; // [sp+58h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v7 = off_7B078[0];
  v24 = *(_QWORD *)off_7B078[0];
  v23 = 0LL;
  v22 = 0LL;
  v21 = 0LL;
  v20 = 0LL;
  v19 = 0LL;
  v18 = 0LL;
  v17 = 0LL;
  v16 = 0LL;
  v15 = 0LL;
  v14 = 0LL;
  LODWORD(v14) = 1;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 80 )
  {
    v9 = *(_QWORD *)(a4 + 32);
    if ( v9 )
    {
      result = IO80211Controller::copyIn(this, v9, &v14, 80LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v10 = *(_QWORD *)(v5 + 144);
          if ( v10 )
          {
            LODWORD(v11) = OSMetaClassBase::safeMetaCast(v10, IO80211AWDLPeerManager::metaClass);
            v12 = v11;
            result = 19LL;
            if ( v12 )
            {
              result = IO80211AWDLPeerManager::setAwdlPeerTrafficRegistration(v12, &v14);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v14, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  v13 = *(_QWORD *)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000018F6E) ----------------------------------------------------
__int64 __fastcall setAwdlForcedRoamConfig(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211AWDLPeerManager *v10; // rax@6
  IO80211AWDLPeerManager *v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-28h]@1
  int v13; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v13 = 0;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 12 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 12LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlForcedRoamConfig(v11, (ether_addr *)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000019021) ----------------------------------------------------
int __fastcall setACLPolicy(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-20h]@1

  v4 = a3;
  v6 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    result = IO80211Controller::copyIn(this, *(_QWORD *)(a4 + 32), &v6, 8LL);
    if ( !result )
    {
      if ( v4 )
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                   this,
                   2150132168LL,
                   169LL,
                   v4,
                   &v6);
      else
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                   this,
                   2150132168LL,
                   169LL,
                   a2,
                   &v6);
    }
  }
  return result;
}

//----- (00000000000190AC) ----------------------------------------------------
int __fastcall setACLAdd(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r14@1
  int result; // eax@1
  int v7; // [sp+8h] [bp-328h]@1

  v4 = a4;
  v5 = a3;
  __bzero(&v7, 776LL);
  v7 = 1;
  result = 22;
  if ( *(_DWORD *)(v4 + 24) == 776 )
  {
    result = IO80211Controller::copyIn(this, *(_QWORD *)(v4 + 32), &v7, 776LL);
    if ( !result )
    {
      if ( v5 )
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3224LL))(
                   this,
                   2150132168LL,
                   170LL,
                   v5,
                   &v7);
      else
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                   this,
                   2150132168LL,
                   170LL,
                   a2,
                   &v7);
    }
  }
  return result;
}
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000019168) ----------------------------------------------------
int __fastcall setACLRemove(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r14@1
  int result; // eax@1
  int v7; // [sp+8h] [bp-328h]@1

  v4 = a4;
  v5 = a3;
  __bzero(&v7, 776LL);
  v7 = 1;
  result = 22;
  if ( *(_DWORD *)(v4 + 24) == 776 )
  {
    result = IO80211Controller::copyIn(this, *(_QWORD *)(v4 + 32), &v7, 776LL);
    if ( !result )
    {
      if ( v5 )
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3224LL))(
                   this,
                   2150132168LL,
                   171LL,
                   v5,
                   &v7);
      else
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                   this,
                   2150132168LL,
                   171LL,
                   a2,
                   &v7);
    }
  }
  return result;
}
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000019224) ----------------------------------------------------
int __fastcall setACLFlush(__int64 a1, __int64 a2, __int64 a3)
{
  int result; // eax@2

  if ( a3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, _QWORD))(*(_QWORD *)a1 + 3224LL))(
               a1,
               2150132168LL,
               172LL,
               a3,
               0LL);
  else
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, _QWORD))(*(_QWORD *)a1 + 3216LL))(
               a1,
               2150132168LL,
               172LL,
               a2,
               0LL);
  return result;
}

//----- (000000000001926B) ----------------------------------------------------
int __fastcall setChainAck(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rsi@2
  __int64 v8; // [sp+0h] [bp-30h]@1
  __int64 v9; // [sp+8h] [bp-28h]@1
  __int64 v10; // [sp+10h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v10 = 0LL;
  v9 = 0LL;
  v8 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 24 )
  {
    v7 = *(_QWORD *)(a4 + 32);
    if ( v7 )
    {
      result = IO80211Controller::copyIn(this, v7, &v8, 24LL);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     174LL,
                     v4,
                     &v8);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     174LL,
                     v5,
                     &v8);
      }
    }
  }
  return result;
}

//----- (0000000000019317) ----------------------------------------------------
int __fastcall setDesense(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rsi@2
  __int64 v8; // [sp+8h] [bp-28h]@1
  __int64 v9; // [sp+10h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v9 = 0LL;
  v8 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 16 )
  {
    v7 = *(_QWORD *)(a4 + 32);
    if ( v7 )
    {
      result = IO80211Controller::copyIn(this, v7, &v8, 16LL);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     175LL,
                     v4,
                     &v8);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     175LL,
                     v5,
                     &v8);
      }
    }
  }
  return result;
}

//----- (00000000000193B8) ----------------------------------------------------
int __fastcall setOffloadScanning(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r14@1
  __int64 v6; // r15@1
  int result; // eax@1
  __int64 v8; // rsi@2
  int v9; // [sp+0h] [bp-8D0h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  __bzero(&v9, 2220LL);
  v9 = 1;
  result = 22;
  if ( *(_DWORD *)(v4 + 24) == 2220 )
  {
    v8 = *(_QWORD *)(v4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v9, 2220LL);
      if ( !result )
      {
        if ( v5 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     176LL,
                     v5,
                     &v9);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     176LL,
                     v6,
                     &v9);
      }
    }
  }
  return result;
}
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000019479) ----------------------------------------------------
int __fastcall setOffloadRSN(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rsi@2
  __int64 v8; // [sp+0h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v8 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v7 = *(_QWORD *)(a4 + 32);
    if ( v7 )
    {
      result = IO80211Controller::copyIn(this, v7, &v8, 8LL);
      if ( !result )
      {
        if ( v5 )
        {
          *(_DWORD *)(v5 + 336) = HIDWORD(v8);
          if ( !v4 )
            return (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     177LL,
                     v5,
                     &v8);
        }
        else
        {
          if ( !v4 )
            return (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     177LL,
                     v5,
                     &v8);
          *(_DWORD *)(v4 + 136) = HIDWORD(v8);
        }
        return (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                 this,
                 2150132168LL,
                 177LL,
                 v4,
                 &v8);
      }
    }
  }
  return result;
}

//----- (0000000000019529) ----------------------------------------------------
int __fastcall setOffloadCountryCode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rsi@2
  __int64 v8; // [sp+0h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v8 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v7 = *(_QWORD *)(a4 + 32);
    if ( v7 )
    {
      result = IO80211Controller::copyIn(this, v7, &v8, 8LL);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     178LL,
                     v4,
                     &v8);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     178LL,
                     v5,
                     &v8);
      }
    }
  }
  return result;
}

//----- (00000000000195B9) ----------------------------------------------------
int __fastcall setOffloadKeepAliveL2(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rsi@2
  __int64 v8; // [sp+8h] [bp-28h]@1
  int v9; // [sp+10h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v9 = 0;
  v8 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 12 )
  {
    v7 = *(_QWORD *)(a4 + 32);
    if ( v7 )
    {
      result = IO80211Controller::copyIn(this, v7, &v8, 12LL);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     179LL,
                     v4,
                     &v8);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     179LL,
                     v5,
                     &v8);
      }
    }
  }
  return result;
}

//----- (0000000000019658) ----------------------------------------------------
int __fastcall setOffloadArpNdp(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  __int64 v6; // r12@1
  int result; // eax@1
  __int64 v8; // rsi@2
  __int64 v9; // rcx@7
  __int64 v10; // [sp+8h] [bp-48h]@1
  __int64 v11; // [sp+10h] [bp-40h]@1
  __int64 v12; // [sp+18h] [bp-38h]@1
  int v13; // [sp+20h] [bp-30h]@1
  __int64 v14; // [sp+28h] [bp-28h]@1

  v4 = a3;
  v5 = a2;
  v6 = off_7B078[0];
  v14 = *(_QWORD *)off_7B078[0];
  v13 = 0;
  v12 = 0LL;
  v11 = 0LL;
  v10 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 28 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v10, 28LL);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     180LL,
                     v4,
                     &v10);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     180LL,
                     v5,
                     &v10);
      }
    }
  }
  v9 = *(_QWORD *)v6;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000001972F) ----------------------------------------------------
__int64 __fastcall setDWDS(IO80211Controller *this, __int64 a2, IO80211VirtualInterface *a3, __int64 a4)
{
  __int64 v4; // r13@1
  IO80211VirtualInterface *v5; // r12@1
  __int64 v6; // r15@1
  signed int v7; // ebx@2
  __int64 v8; // rsi@5
  int v9; // eax@8
  __int64 v11; // [sp+0h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v11 = 1LL;
  if ( a2 || (v7 = 102, a3) && (unsigned int)IO80211VirtualInterface::getInterfaceRole(a3) == 5 )
  {
    v7 = 22;
    if ( *(_DWORD *)(v4 + 24) == 8 )
    {
      v8 = *(_QWORD *)(v4 + 32);
      if ( v8 )
      {
        v7 = IO80211Controller::copyIn(this, v8, &v11, 8LL);
        if ( !v7 )
        {
          if ( v5 )
            v9 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211VirtualInterface *, __int64 *))(*(_QWORD *)this + 3224LL))(
                   this,
                   2150132168LL,
                   182LL,
                   v5,
                   &v11);
          else
            v9 = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                   this,
                   2150132168LL,
                   182LL,
                   v6,
                   &v11);
          v7 = v9;
        }
      }
    }
  }
  return (unsigned int)v7;
}

//----- (00000000000197ED) ----------------------------------------------------
int __fastcall setInterruptStatsReset(__int64 a1, __int64 a2, __int64 a3)
{
  int result; // eax@3

  if ( a2 )
  {
    if ( a3 )
      result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, _QWORD))(*(_QWORD *)a1 + 3224LL))(
                 a1,
                 2150132168LL,
                 184LL,
                 a3,
                 0LL);
    else
      result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, _QWORD))(*(_QWORD *)a1 + 3216LL))(
                 a1,
                 2150132168LL,
                 184LL,
                 a2,
                 0LL);
  }
  else
  {
    result = 22;
  }
  return result;
}

//----- (0000000000019840) ----------------------------------------------------
int __fastcall setTimerStatsReset(__int64 a1, __int64 a2, __int64 a3)
{
  int result; // eax@3

  if ( a2 )
  {
    if ( a3 )
      result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, _QWORD))(*(_QWORD *)a1 + 3224LL))(
                 a1,
                 2150132168LL,
                 186LL,
                 a3,
                 0LL);
    else
      result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, _QWORD))(*(_QWORD *)a1 + 3216LL))(
                 a1,
                 2150132168LL,
                 186LL,
                 a2,
                 0LL);
  }
  else
  {
    result = 22;
  }
  return result;
}

//----- (0000000000019893) ----------------------------------------------------
int __fastcall setOffloadStatsReset(__int64 a1, __int64 a2, __int64 a3)
{
  int result; // eax@3

  if ( a2 )
  {
    if ( a3 )
      result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, _QWORD))(*(_QWORD *)a1 + 3224LL))(
                 a1,
                 2150132168LL,
                 188LL,
                 a3,
                 0LL);
    else
      result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, _QWORD))(*(_QWORD *)a1 + 3216LL))(
                 a1,
                 2150132168LL,
                 188LL,
                 a2,
                 0LL);
  }
  else
  {
    result = 22;
  }
  return result;
}

//----- (00000000000198E6) ----------------------------------------------------
int __fastcall setOffloadBeacons(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rsi@2
  __int64 v8; // [sp+0h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v8 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v7 = *(_QWORD *)(a4 + 32);
    if ( v7 )
    {
      result = IO80211Controller::copyIn(this, v7, &v8, 8LL);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     189LL,
                     v4,
                     &v8);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     189LL,
                     v5,
                     &v8);
      }
    }
  }
  return result;
}

//----- (0000000000019976) ----------------------------------------------------
int __fastcall setRoaming(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rsi@2
  __int64 v8; // [sp+0h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v8 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v7 = *(_QWORD *)(a4 + 32);
    if ( v7 )
    {
      result = IO80211Controller::copyIn(this, v7, &v8, 8LL);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     190LL,
                     v4,
                     &v8);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     190LL,
                     v5,
                     &v8);
      }
    }
  }
  return result;
}

//----- (0000000000019A06) ----------------------------------------------------
int __fastcall setOffloadArp(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rsi@2
  __int64 v8; // [sp+8h] [bp-28h]@1
  int v9; // [sp+10h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v9 = 0;
  v8 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 12 )
  {
    v7 = *(_QWORD *)(a4 + 32);
    if ( v7 )
    {
      result = IO80211Controller::copyIn(this, v7, &v8, 12LL);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     191LL,
                     v4,
                     &v8);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     191LL,
                     v5,
                     &v8);
      }
    }
  }
  return result;
}

//----- (0000000000019AA5) ----------------------------------------------------
int __fastcall setOffloadNdp(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rsi@2
  __int64 v8; // [sp+0h] [bp-60h]@1
  __int64 v9; // [sp+8h] [bp-58h]@1
  __int64 v10; // [sp+10h] [bp-50h]@1
  __int64 v11; // [sp+18h] [bp-48h]@1
  __int64 v12; // [sp+20h] [bp-40h]@1
  __int64 v13; // [sp+28h] [bp-38h]@1
  __int64 v14; // [sp+30h] [bp-30h]@1
  __int64 v15; // [sp+38h] [bp-28h]@1
  __int64 v16; // [sp+40h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v16 = 0LL;
  v15 = 0LL;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 0LL;
  v11 = 0LL;
  v10 = 0LL;
  v9 = 0LL;
  v8 = 0LL;
  LODWORD(v8) = 1;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 72 )
  {
    v7 = *(_QWORD *)(a4 + 32);
    if ( v7 )
    {
      result = IO80211Controller::copyIn(this, v7, &v8, 72LL);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     192LL,
                     v4,
                     &v8);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     192LL,
                     v5,
                     &v8);
      }
    }
  }
  return result;
}

//----- (0000000000019B7F) ----------------------------------------------------
int __fastcall setOffloadScan(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r14@1
  __int64 v6; // r15@1
  int result; // eax@1
  __int64 v8; // rsi@2
  int v9; // [sp+0h] [bp-880h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  __bzero(&v9, 2140LL);
  v9 = 1;
  result = 22;
  if ( *(_DWORD *)(v4 + 24) == 2140 )
  {
    v8 = *(_QWORD *)(v4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v9, 2140LL);
      if ( !result )
      {
        if ( v5 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     193LL,
                     v5,
                     &v9);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     193LL,
                     v6,
                     &v9);
      }
    }
  }
  return result;
}
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000019C40) ----------------------------------------------------
int __fastcall setDesenseLevel(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-20h]@1

  v4 = a3;
  v6 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) >= 8u )
  {
    result = IO80211Controller::copyIn(this, *(_QWORD *)(a4 + 32), &v6, 8LL);
    if ( !result )
    {
      if ( v4 )
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                   this,
                   2150132168LL,
                   194LL,
                   v4,
                   &v6);
      else
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                   this,
                   2150132168LL,
                   194LL,
                   a2,
                   &v6);
    }
  }
  return result;
}

//----- (0000000000019CCB) ----------------------------------------------------
int __fastcall setMcsVht(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-30h]@1
  __int64 v7; // [sp+8h] [bp-28h]@1
  int v8; // [sp+10h] [bp-20h]@1

  v4 = a3;
  v8 = 0;
  v7 = 0LL;
  v6 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) >= 0x14u )
  {
    result = IO80211Controller::copyIn(this, *(_QWORD *)(a4 + 32), &v6, 20LL);
    if ( !result )
    {
      if ( v4 )
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                   this,
                   2150132168LL,
                   195LL,
                   v4,
                   &v6);
      else
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                   this,
                   2150132168LL,
                   195LL,
                   a2,
                   &v6);
    }
  }
  return result;
}

//----- (0000000000019D70) ----------------------------------------------------
int __fastcall setTxNss(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int result; // eax@1
  __int64 v6; // [sp+0h] [bp-20h]@1

  v4 = a3;
  v6 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) >= 8u )
  {
    result = IO80211Controller::copyIn(this, *(_QWORD *)(a4 + 32), &v6, 8LL);
    if ( !result )
    {
      if ( v4 )
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                   this,
                   2150132168LL,
                   196LL,
                   v4,
                   &v6);
      else
        result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                   this,
                   2150132168LL,
                   196LL,
                   a2,
                   &v6);
    }
  }
  return result;
}

//----- (0000000000019DFB) ----------------------------------------------------
__int64 setGASReq()
{
  return 0LL;
}

//----- (0000000000019E03) ----------------------------------------------------
__int64 setGASQuery()
{
  return 0LL;
}

//----- (0000000000019E0B) ----------------------------------------------------
__int64 setGASPeer()
{
  return 0LL;
}

//----- (0000000000019E13) ----------------------------------------------------
__int64 __fastcall setAwdlBtlePeerIndication(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-38h]@1
  __int64 v13; // [sp+10h] [bp-30h]@1
  __int64 v14; // [sp+18h] [bp-28h]@1
  __int64 v15; // [sp+20h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v15 = 0LL;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 32 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 32LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlBtlePeerIndication(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000019EDE) ----------------------------------------------------
__int64 __fastcall setAwdlBtleEnableSynchWithParams(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211AWDLPeerManager *v10; // rax@6
  IO80211AWDLPeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-30h]@1
  __int64 v13; // [sp+8h] [bp-28h]@1
  int v14; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v14 = 0;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 20 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 20LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlBtleEnableSynchWithParams(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000019F9C) ----------------------------------------------------
__int64 __fastcall setAwdlSecondaryMasterChannel(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlSecondaryMasterChannel(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000001A040) ----------------------------------------------------
__int64 setPhyStats()
{
  return 0LL;
}

//----- (000000000001A048) ----------------------------------------------------
__int64 __fastcall setAwdlAfTxMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlAfTxMode(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000001A0EC) ----------------------------------------------------
__int64 __fastcall setAwdlPrivateElectionId(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+8h] [bp-28h]@1
  int v13; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v13 = 0;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 12 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 12LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlPrivateElectionId(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000001A19F) ----------------------------------------------------
__int64 __fastcall setVHTCapability(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-30h]@1
  __int64 v13; // [sp+8h] [bp-28h]@1
  int v14; // [sp+10h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v14 = 0;
  v13 = 0LL;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 20 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 20LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211PeerManager::setVHtCapabilityIE(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000001A25D) ----------------------------------------------------
int __fastcall setRoamProfile(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rsi@2
  __int64 v8; // [sp+8h] [bp-68h]@1
  __int64 v9; // [sp+10h] [bp-60h]@1
  __int64 v10; // [sp+18h] [bp-58h]@1
  __int64 v11; // [sp+20h] [bp-50h]@1
  __int64 v12; // [sp+28h] [bp-48h]@1
  __int64 v13; // [sp+30h] [bp-40h]@1
  __int64 v14; // [sp+38h] [bp-38h]@1
  __int64 v15; // [sp+40h] [bp-30h]@1
  __int64 v16; // [sp+48h] [bp-28h]@1
  int v17; // [sp+50h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v17 = 0;
  v16 = 0LL;
  v15 = 0LL;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 0LL;
  v11 = 0LL;
  v10 = 0LL;
  v9 = 0LL;
  v8 = 0LL;
  LODWORD(v8) = 1;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 76 )
  {
    v7 = *(_QWORD *)(a4 + 32);
    if ( v7 )
    {
      result = IO80211Controller::copyIn(this, v7, &v8, 76LL);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     216LL,
                     v4,
                     &v8);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     216LL,
                     v5,
                     &v8);
      }
    }
  }
  return result;
}

//----- (000000000001A33E) ----------------------------------------------------
__int64 __fastcall setAwdlOperatingMode(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211AWDLPeerManager *v10; // rax@6
  IO80211AWDLPeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlOperatingMode(v11, (__int64)&v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000001A3E2) ----------------------------------------------------
__int64 __fastcall setAwdlKey(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 v7; // r12@1
  __int64 result; // rax@1
  __int64 v9; // rsi@2
  __int64 v10; // rdi@5
  IO80211PeerManager *v11; // rax@6
  IO80211PeerManager *v12; // rcx@6
  __int64 v13; // rcx@9
  int v14; // [sp+0h] [bp-C0h]@1
  __int64 v15; // [sp+98h] [bp-28h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v7 = off_7B078[0];
  v15 = *(_QWORD *)off_7B078[0];
  __bzero(&v14, 148LL);
  v14 = 1;
  result = 22LL;
  if ( *(_DWORD *)(v4 + 24) == 148 )
  {
    v9 = *(_QWORD *)(v4 + 32);
    if ( v9 )
    {
      result = IO80211Controller::copyIn(this, v9, &v14, 148LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v10 = *(_QWORD *)(v5 + 144);
          if ( v10 )
          {
            LODWORD(v11) = OSMetaClassBase::safeMetaCast(v10, IO80211AWDLPeerManager::metaClass);
            v12 = v11;
            result = 19LL;
            if ( v12 )
            {
              result = IO80211AWDLPeerManager::setAwdlKey(v12, &v14);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v14, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  v13 = *(_QWORD *)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (000000000001A4D0) ----------------------------------------------------
__int64 __fastcall setAwdlEncryptType(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  IO80211PeerManager *v10; // rax@6
  IO80211PeerManager *v11; // rcx@6
  __int64 v12; // [sp+0h] [bp-20h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  v12 = 1LL;
  result = 22LL;
  if ( *(_DWORD *)(a4 + 24) == 8 )
  {
    v8 = *(_QWORD *)(a4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 8LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::setAwdlEncryptType(v11, &v12);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000001A574) ----------------------------------------------------
int __fastcall setBTCoexProfiles(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r14@1
  __int64 v6; // r15@1
  int result; // eax@1
  __int64 v8; // rsi@2
  int v9; // [sp+0h] [bp-260h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  __bzero(&v9, 572LL);
  v9 = 1;
  result = 22;
  if ( *(_DWORD *)(v4 + 24) == 572 )
  {
    v8 = *(_QWORD *)(v4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v9, 572LL);
      if ( !result )
      {
        if ( v5 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     221LL,
                     v5,
                     &v9);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     221LL,
                     v6,
                     &v9);
      }
    }
  }
  return result;
}
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (000000000001A635) ----------------------------------------------------
int __fastcall setBTCoexConfig(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  int result; // eax@1
  __int64 v7; // rsi@2
  __int64 v8; // [sp+0h] [bp-30h]@1
  __int64 v9; // [sp+8h] [bp-28h]@1
  int v10; // [sp+10h] [bp-20h]@1

  v4 = a3;
  v5 = a2;
  v10 = 0;
  v9 = 0LL;
  v8 = 1LL;
  result = 22;
  if ( *(_DWORD *)(a4 + 24) == 20 )
  {
    v7 = *(_QWORD *)(a4 + 32);
    if ( v7 )
    {
      result = IO80211Controller::copyIn(this, v7, &v8, 20LL);
      if ( !result )
      {
        if ( v4 )
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3224LL))(
                     this,
                     2150132168LL,
                     222LL,
                     v4,
                     &v8);
        else
          result = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                     this,
                     2150132168LL,
                     222LL,
                     v5,
                     &v8);
      }
    }
  }
  return result;
}

//----- (000000000001A6DF) ----------------------------------------------------
__int64 __fastcall clearAwdlStatistics(IO80211Controller *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  IO80211Controller *v6; // r14@1
  __int64 result; // rax@1
  __int64 v8; // rsi@2
  __int64 v9; // rdi@5
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  int v12; // [sp+8h] [bp-F8h]@1

  v4 = a4;
  v5 = a3;
  v6 = this;
  __bzero(&v12, 224LL);
  v12 = 1;
  result = 22LL;
  if ( *(_DWORD *)(v4 + 24) == 224 )
  {
    v8 = *(_QWORD *)(v4 + 32);
    if ( v8 )
    {
      result = IO80211Controller::copyIn(this, v8, &v12, 224LL);
      if ( !(_DWORD)result )
      {
        result = 45LL;
        if ( v5 )
        {
          v9 = *(_QWORD *)(v5 + 144);
          if ( v9 )
          {
            LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, IO80211AWDLPeerManager::metaClass);
            v11 = v10;
            result = 19LL;
            if ( v11 )
            {
              result = IO80211AWDLPeerManager::clearAwdlStatistics(v11);
              if ( !(_DWORD)result )
                result = IO80211Controller::copyOut(v6, &v12, *(_QWORD *)(v4 + 32), *(_DWORD *)(v4 + 24));
            }
          }
        }
      }
    }
  }
  return result;
}
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (000000000001A7B0) ----------------------------------------------------
__int64 __fastcall IO80211AWDLMulticastPeer::MetaClass::MetaClass(IO80211AWDLMulticastPeer::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211AWDLMulticastPeer", &IO80211Peer::gMetaClass, 1160LL);
  result = (__int64)off_7C990;
  *(_QWORD *)this = off_7C990;
  return result;
}
// 7C990: using guessed type __int64 (__fastcall *off_7C990[2])(IO80211AWDLMulticastPeer::MetaClass *__hidden this);
// 84458: using guessed type _QWORD IO80211Peer::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001A7E2) ----------------------------------------------------
__int64 __fastcall IO80211AWDLMulticastPeer::MetaClass::~MetaClass(IO80211AWDLMulticastPeer::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000001A7EC) ----------------------------------------------------
__int64 __fastcall IO80211AWDLMulticastPeer::IO80211AWDLMulticastPeer(__int64 a1)
{
  __int64 result; // rax@1

  IO80211Peer::IO80211Peer(a1);
  result = (__int64)off_7C7E0;
  *(_QWORD *)a1 = off_7C7E0;
  return result;
}
// 7C7E0: using guessed type __int64 (__fastcall *off_7C7E0[2])(IO80211AWDLMulticastPeer *__hidden this);

//----- (000000000001A80C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLMulticastPeer::IO80211AWDLMulticastPeer(__int64 a1)
{
  __int64 result; // rax@1

  IO80211Peer::IO80211Peer(a1);
  result = (__int64)off_7C7E0;
  *(_QWORD *)a1 = off_7C7E0;
  return result;
}
// 7C7E0: using guessed type __int64 (__fastcall *off_7C7E0[2])(IO80211AWDLMulticastPeer *__hidden this);

//----- (000000000001A82C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLMulticastPeer::~IO80211AWDLMulticastPeer(IO80211AWDLMulticastPeer *this)
{
  return IO80211Peer::~IO80211Peer(this);
}

//----- (000000000001A836) ----------------------------------------------------
__int64 __fastcall IO80211AWDLMulticastPeer::~IO80211AWDLMulticastPeer(IO80211AWDLMulticastPeer *this)
{
  return IO80211Peer::~IO80211Peer(this);
}

//----- (000000000001A840) ----------------------------------------------------
void __fastcall IO80211AWDLMulticastPeer::~IO80211AWDLMulticastPeer(IO80211AWDLMulticastPeer *this)
{
  IO80211Peer::~IO80211Peer(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000001A862) ----------------------------------------------------
__int64 __fastcall IO80211AWDLMulticastPeer::getMetaClass(IO80211AWDLMulticastPeer *this)
{
  return (__int64)&IO80211AWDLMulticastPeer::gMetaClass;
}
// 843E0: using guessed type _QWORD IO80211AWDLMulticastPeer::gMetaClass;

//----- (000000000001A870) ----------------------------------------------------
__int64 __fastcall IO80211AWDLMulticastPeer::MetaClass::MetaClass(IO80211AWDLMulticastPeer::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211AWDLMulticastPeer", &IO80211Peer::gMetaClass, 1160LL);
  result = (__int64)off_7C990;
  *(_QWORD *)this = off_7C990;
  return result;
}
// 7C990: using guessed type __int64 (__fastcall *off_7C990[2])(IO80211AWDLMulticastPeer::MetaClass *__hidden this);
// 84458: using guessed type _QWORD IO80211Peer::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001A8A2) ----------------------------------------------------
__int64 __fastcall IO80211AWDLMulticastPeer::MetaClass::alloc(IO80211AWDLMulticastPeer::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)stru_480.uuid, a2);
  IO80211Peer::IO80211Peer(v2);
  *(_QWORD *)v2 = off_7C7E0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211AWDLMulticastPeer::gMetaClass);
  return v2;
}
// 480: using guessed type uuid_command stru_480;
// 7C7E0: using guessed type __int64 (__fastcall *off_7C7E0[2])(IO80211AWDLMulticastPeer *__hidden this);
// 843E0: using guessed type _QWORD IO80211AWDLMulticastPeer::gMetaClass;

//----- (000000000001A8E2) ----------------------------------------------------
__int64 __fastcall IO80211AWDLMulticastPeer::IO80211AWDLMulticastPeer(__int64 a1)
{
  IO80211Peer::IO80211Peer(a1);
  *(_QWORD *)a1 = off_7C7E0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211AWDLMulticastPeer::gMetaClass);
}
// 7C7E0: using guessed type __int64 (__fastcall *off_7C7E0[2])(IO80211AWDLMulticastPeer *__hidden this);
// 843E0: using guessed type _QWORD IO80211AWDLMulticastPeer::gMetaClass;

//----- (000000000001A912) ----------------------------------------------------
__int64 __fastcall IO80211AWDLMulticastPeer::IO80211AWDLMulticastPeer(__int64 a1)
{
  IO80211Peer::IO80211Peer(a1);
  *(_QWORD *)a1 = off_7C7E0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211AWDLMulticastPeer::gMetaClass);
}
// 7C7E0: using guessed type __int64 (__fastcall *off_7C7E0[2])(IO80211AWDLMulticastPeer *__hidden this);
// 843E0: using guessed type _QWORD IO80211AWDLMulticastPeer::gMetaClass;

//----- (000000000001A942) ----------------------------------------------------
__int64 __fastcall IO80211AWDLMulticastPeer::withAddressAndManager(IO80211AWDLMulticastPeer *this, IO80211AWDLPeerManager *a2, IO80211AWDLPeerManager *a3)
{
  __int64 v3; // rbx@1
  __int64 result; // rax@1

  v3 = OSObject::operator new((OSObject *)stru_480.uuid, (unsigned __int64)a2);
  IO80211Peer::IO80211Peer(v3);
  *(_QWORD *)v3 = off_7C7E0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211AWDLMulticastPeer::gMetaClass);
  result = 0LL;
  if ( v3 )
  {
    if ( IO80211AWDLMulticastPeer::initWithAddressAndManager(
           (IO80211AWDLMulticastPeer *)v3,
           (const unsigned __int8 *)this,
           a2) )
    {
      *(_DWORD *)(v3 + 224) = 5000;
      result = v3;
    }
    else
    {
      (*(void (__fastcall **)(__int64, IO80211AWDLMulticastPeer *))(*(_QWORD *)v3 + 40LL))(v3, this);
      result = 0LL;
    }
  }
  return result;
}
// 480: using guessed type uuid_command stru_480;
// 7C7E0: using guessed type __int64 (__fastcall *off_7C7E0[2])(IO80211AWDLMulticastPeer *__hidden this);
// 843E0: using guessed type _QWORD IO80211AWDLMulticastPeer::gMetaClass;

//----- (000000000001A9C0) ----------------------------------------------------
char __fastcall IO80211AWDLMulticastPeer::initWithAddressAndManager(IO80211AWDLMulticastPeer *this, const unsigned __int8 *a2, IO80211AWDLPeerManager *a3)
{
  IO80211AWDLPeerManager *v3; // r12@1
  char v4; // r14@1
  OSMetaClass *v5; // rax@3
  __int64 v6; // rax@3
  int v7; // ST20_4@3
  int v8; // ST18_4@3
  int v9; // ST10_4@3
  int v10; // ST08_4@3
  int v11; // ST00_4@3

  v3 = a3;
  v4 = ((int (*)(void))`vtable for'IO80211Peer[42])();
  if ( v3 && IO80211PeerManager::shouldLog(v3, 0x2000000000LL) )
  {
    LODWORD(v5) = (*(int (__fastcall **)(IO80211AWDLMulticastPeer *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    0x2000000000LL);
    v6 = OSMetaClass::getClassName(v5);
    v7 = a2[5];
    v8 = a2[4];
    v9 = a2[3];
    v10 = a2[2];
    v11 = a2[1];
    IO80211PeerManager::logDebug(
      v3,
      0x2000000000LL,
      "%s::%s %02X:%02X:%02X:%02X:%02X:%02X\n",
      v6,
      (__int64)"initWithAddressAndManager",
      *a2);
  }
  return v4;
}
// 7D300: using guessed type __int64 `vtable for'IO80211Peer[2];

//----- (000000000001AA76) ----------------------------------------------------
bool __fastcall IO80211AWDLMulticastPeer::canTransmit(IO80211AWDLMulticastPeer *this)
{
  __int64 v1; // r14@1
  char v2; // r12@1
  unsigned int v3; // ST80_4@2
  unsigned int v4; // ST84_4@2
  unsigned int v5; // ST7C_4@2
  int v6; // ST78_4@2
  int v7; // ST74_4@2
  int v8; // ST70_4@2
  int v9; // ST64_4@2
  int v10; // ST60_4@2
  __int64 v11; // rax@2
  int v12; // ST50_4@2
  unsigned int v13; // eax@6
  bool v14; // dl@6
  unsigned int v15; // ecx@6
  bool v16; // bl@6
  bool result; // al@6

  v1 = *((_QWORD *)this + 5);
  v2 = ((int (*)(void))`vtable for'IO80211Peer[50])();
  if ( IO80211PeerManager::shouldLog((IO80211PeerManager *)v1, 0x4000000000000LL) )
  {
    v3 = *((_BYTE *)this + 32);
    v4 = *((_BYTE *)this + 33);
    v5 = *((_BYTE *)this + 34);
    v6 = *((_BYTE *)this + 35);
    v7 = *((_BYTE *)this + 36);
    v8 = *((_BYTE *)this + 37);
    v9 = *(_WORD *)(v1 + 7602) != 0;
    v10 = *(_DWORD *)(v1 + 1032) != 0;
    v11 = *(_DWORD *)(v1 + 1440);
    *(_BYTE *)(v1 + 1518);
    LOBYTE(v11) = *(_DWORD *)(v1 + 1488) != 0;
    v12 = IO80211AWDLPeerManager::inMulticastTimeslot((IO80211AWDLPeerManager *)v1, v11);
    IO80211Peer::logDebug(
      this,
      0x4000000000000LL,
      "canTransmit %02X:%02X:%02X:%02X:%02X:%02X ac=%d sup=%d cs=%d txa=%d me=%d memc=%d ss=%d mcts=%d \n",
      v3,
      v4,
      v5);
  }
  if ( !v2 || !*(_WORD *)(v1 + 7602) || !*(_DWORD *)(v1 + 1032) )
    return 0;
  v13 = *(_BYTE *)(v1 + 1518);
  v14 = v13 == 0;
  v15 = *(_DWORD *)(v1 + 1440);
  v16 = v15 < v13;
  result = 0;
  if ( (v14 || v16) && v15 <= 6 )
  {
    if ( *(_DWORD *)(v1 + 1488) )
      return IO80211AWDLPeerManager::inMulticastTimeslot((IO80211AWDLPeerManager *)v1, 0LL);
    return 0;
  }
  return result;
}
// 7D300: using guessed type __int64 `vtable for'IO80211Peer[2];

//----- (000000000001AC32) ----------------------------------------------------
__int64 __fastcall IO80211AWDLMulticastPeer::getPacket(__int64 a1, __int64 a2)
{
  if ( (unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 384LL))(
                          a1,
                          *(_BYTE *)(a2 + 16),
                          0LL) )
    JUMPOUT(__CS__, `vtable for'IO80211Peer[48]);
  return 0LL;
}
// 7D300: using guessed type __int64 `vtable for'IO80211Peer[2];

//----- (000000000001AC72) ----------------------------------------------------
char __fastcall IO80211AWDLMulticastPeer::prepareForTransmit(IO80211AWDLMulticastPeer *this, IO80211PacketDescriptor *a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rax@4
  unsigned __int8 v4; // cl@6
  unsigned __int8 v5; // al@13
  __int16 v6; // ax@15
  unsigned __int8 v7; // al@16
  __int16 v8; // ax@18
  int v9; // eax@19
  __int16 v10; // ax@21
  __int16 v12; // ax@24

  v2 = *((_QWORD *)this + 5);
  if ( !*(_DWORD *)(v2 + 1488) )
    return 0;
  if ( !IO80211AWDLPeerManager::multicastAllowedOnInfra(*((IO80211AWDLPeerManager **)this + 5)) )
    *((_BYTE *)a2 + 61) |= 4u;
  LOBYTE(v3) = *(_BYTE *)(v2 + 1532);
  if ( !(_BYTE)v3 )
    *((_BYTE *)a2 + 61) |= 1u;
  v4 = *(_BYTE *)(v2 + 1533);
  if ( !v4 )
    *((_BYTE *)a2 + 61) |= 2u;
  v3 = (unsigned __int8)v3;
  if ( v4 == (unsigned __int8)v3 )
    *((_BYTE *)a2 + 61) |= 2u;
  if ( *(_DWORD *)(v2 + 3624) )
    *((_BYTE *)a2 + 61) |= 2u;
  if ( !IO80211AWDLPeerManager::inMulticastTimeslot((IO80211AWDLPeerManager *)v2, v3) )
    return 0;
  v5 = *(_BYTE *)(v2 + 1532);
  if ( v5 && *(_BYTE *)(v2 + 7585) == v5 && (v6 = *((_WORD *)a2 + 30), !(HIBYTE(v6) & 1)) )
  {
    v12 = v6 | 0x100;
  }
  else
  {
    v7 = *(_BYTE *)(v2 + 1533);
    if ( v7 && *(_BYTE *)(v2 + 7585) == v7 && (v8 = *((_WORD *)a2 + 30), !(HIBYTE(v8) & 2)) )
    {
      v12 = v8 | 0x200;
    }
    else
    {
      v9 = *(_DWORD *)(v2 + 104);
      if ( !v9 )
        return 0;
      if ( *(_BYTE *)(v2 + 7585) != v9 )
        return 0;
      v10 = *((_WORD *)a2 + 30);
      if ( HIBYTE(v10) & 4 )
        return 0;
      v12 = v10 | 0x400;
    }
  }
  *((_WORD *)a2 + 30) = v12;
  IO80211AWDLPeerManager::adjustAwdlSnapHeader((IO80211AWDLPeerManager *)v2, a2, this);
  return 1;
}

//----- (000000000001AD82) ----------------------------------------------------
char __fastcall IO80211AWDLMulticastPeer::transmitSuccess(IO80211Peer *this, __int64 a2)
{
  OSMetaClass *v2; // rax@1
  __int64 v3; // rax@1
  int v4; // ST00_4@1
  char v5; // bl@1
  int v6; // eax@2
  OSMetaClass *v7; // rax@4
  __int64 v8; // rax@4
  int v9; // ST00_4@4
  OSMetaClass *v10; // rax@5
  __int64 v11; // rax@5

  LODWORD(v2) = (*(int (__cdecl **)(IO80211Peer *))(*(_QWORD *)this + 56LL))(this);
  v3 = OSMetaClass::getClassName(v2);
  v4 = *(_WORD *)(a2 + 60);
  v5 = 0;
  IO80211Peer::logDebug(
    this,
    2048LL,
    "%s::%s(): Transmit success for %d: %x\n",
    v3,
    (__int64)"transmitSuccess",
    *(_WORD *)(a2 + 56));
  if ( (*(_WORD *)(a2 + 60) & 0x700) == 1792 )
  {
    v6 = *((_DWORD *)this + 288);
    if ( v6 && *(_WORD *)(a2 + 56) - v6 != 1 )
    {
      LODWORD(v7) = (*(int (__fastcall **)(IO80211Peer *, signed __int64))(*(_QWORD *)this + 56LL))(this, 2048LL);
      v8 = OSMetaClass::getClassName(v7);
      v9 = *(_WORD *)(a2 + 56);
      IO80211Peer::logDebug(
        this,
        2048LL,
        "%s::%s():  Alert.  Expecting to receive tx status for sequence %u, got %u\n",
        v8,
        (__int64)"transmitSuccess",
        (unsigned int)(*((_DWORD *)this + 288) + 1));
    }
    *((_DWORD *)this + 288) = *(_WORD *)(a2 + 56);
    LODWORD(v10) = (*(int (__fastcall **)(IO80211Peer *, signed __int64))(*(_QWORD *)this + 56LL))(this, 2048LL);
    v11 = OSMetaClass::getClassName(v10);
    IO80211Peer::logDebug(
      this,
      2048LL,
      "%s::%s(): Freeing pkt %d\n",
      v11,
      (__int64)"transmitSuccess",
      *(_WORD *)(a2 + 56));
    v5 = 1;
  }
  return v5;
}

//----- (000000000001AE90) ----------------------------------------------------
__int64 __fastcall IO80211AWDLMulticastPeer::inputPacket(__int64 a1, __int64 a2)
{
  mbuf_data(a2);
  return 0LL;
}
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);

//----- (000000000001AEA0) ----------------------------------------------------
void __fastcall IO80211Peer::print(IO80211Peer *this)
{
  ;
}

//----- (000000000001AEA6) ----------------------------------------------------
__int64 __fastcall IO80211AWDLMulticastPeer::MetaClass::~MetaClass(IO80211AWDLMulticastPeer::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000001AEB0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_5()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(
    &IO80211AWDLMulticastPeer::gMetaClass,
    "IO80211AWDLMulticastPeer",
    &IO80211Peer::gMetaClass,
    1160LL);
  result = (__int64)off_7C990;
  IO80211AWDLMulticastPeer::gMetaClass = off_7C990;
  return result;
}
// 7C990: using guessed type __int64 (__fastcall *off_7C990[2])(IO80211AWDLMulticastPeer::MetaClass *__hidden this);
// 843E0: using guessed type _QWORD IO80211AWDLMulticastPeer::gMetaClass;
// 84458: using guessed type _QWORD IO80211Peer::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001AEF0) ----------------------------------------------------
__int64 `global destructor keyed to'_a_5()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211AWDLMulticastPeer::gMetaClass);
}
// 843E0: using guessed type _QWORD IO80211AWDLMulticastPeer::gMetaClass;

//----- (000000000001AF10) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::MetaClass::MetaClass(IO80211AWDLPeer::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211AWDLPeer", &IO80211Peer::gMetaClass, 1896LL);
  result = (__int64)off_7CC40;
  *(_QWORD *)this = off_7CC40;
  return result;
}
// 7CC40: using guessed type __int64 (__fastcall *off_7CC40[2])(IO80211AWDLPeer::MetaClass *__hidden this);
// 84458: using guessed type _QWORD IO80211Peer::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001AF42) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::MetaClass::~MetaClass(IO80211AWDLPeer::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000001AF4C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::IO80211AWDLPeer(__int64 a1)
{
  __int64 result; // rax@1

  IO80211Peer::IO80211Peer(a1);
  result = (__int64)off_7CA90;
  *(_QWORD *)a1 = off_7CA90;
  return result;
}
// 7CA90: using guessed type __int64 (__fastcall *off_7CA90[2])(IO80211AWDLPeer *__hidden this);

//----- (000000000001AF6C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::IO80211AWDLPeer(__int64 a1)
{
  __int64 result; // rax@1

  IO80211Peer::IO80211Peer(a1);
  result = (__int64)off_7CA90;
  *(_QWORD *)a1 = off_7CA90;
  return result;
}
// 7CA90: using guessed type __int64 (__fastcall *off_7CA90[2])(IO80211AWDLPeer *__hidden this);

//----- (000000000001AF8C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::~IO80211AWDLPeer(IO80211AWDLPeer *this)
{
  return IO80211Peer::~IO80211Peer(this);
}

//----- (000000000001AF96) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::~IO80211AWDLPeer(IO80211AWDLPeer *this)
{
  return IO80211Peer::~IO80211Peer(this);
}

//----- (000000000001AFA0) ----------------------------------------------------
void __fastcall IO80211AWDLPeer::~IO80211AWDLPeer(IO80211AWDLPeer *this)
{
  IO80211Peer::~IO80211Peer(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000001AFC2) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::getMetaClass(IO80211AWDLPeer *this)
{
  return (__int64)&IO80211AWDLPeer::gMetaClass;
}
// 84408: using guessed type _QWORD IO80211AWDLPeer::gMetaClass;

//----- (000000000001AFD0) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::MetaClass::MetaClass(IO80211AWDLPeer::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211AWDLPeer", &IO80211Peer::gMetaClass, 1896LL);
  result = (__int64)off_7CC40;
  *(_QWORD *)this = off_7CC40;
  return result;
}
// 7CC40: using guessed type __int64 (__fastcall *off_7CC40[2])(IO80211AWDLPeer::MetaClass *__hidden this);
// 84458: using guessed type _QWORD IO80211Peer::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001B002) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::MetaClass::alloc(IO80211AWDLPeer::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&qword_4B8[86], a2);
  IO80211Peer::IO80211Peer(v2);
  *(_QWORD *)v2 = off_7CA90;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211AWDLPeer::gMetaClass);
  return v2;
}
// 4B8: using guessed type __int64 qword_4B8[483];
// 7CA90: using guessed type __int64 (__fastcall *off_7CA90[2])(IO80211AWDLPeer *__hidden this);
// 84408: using guessed type _QWORD IO80211AWDLPeer::gMetaClass;

//----- (000000000001B042) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::IO80211AWDLPeer(__int64 a1)
{
  IO80211Peer::IO80211Peer(a1);
  *(_QWORD *)a1 = off_7CA90;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211AWDLPeer::gMetaClass);
}
// 7CA90: using guessed type __int64 (__fastcall *off_7CA90[2])(IO80211AWDLPeer *__hidden this);
// 84408: using guessed type _QWORD IO80211AWDLPeer::gMetaClass;

//----- (000000000001B072) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::IO80211AWDLPeer(__int64 a1)
{
  IO80211Peer::IO80211Peer(a1);
  *(_QWORD *)a1 = off_7CA90;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211AWDLPeer::gMetaClass);
}
// 7CA90: using guessed type __int64 (__fastcall *off_7CA90[2])(IO80211AWDLPeer *__hidden this);
// 84408: using guessed type _QWORD IO80211AWDLPeer::gMetaClass;

//----- (000000000001B0A2) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::withAddressAndManager(IO80211AWDLPeer *this, const unsigned __int8 *a2, IO80211AWDLPeerManager *a3)
{
  __int64 v3; // rbx@1
  char v4; // al@2

  v3 = OSObject::operator new((OSObject *)&qword_4B8[86], (unsigned __int64)a2);
  IO80211Peer::IO80211Peer(v3);
  *(_QWORD *)v3 = off_7CA90;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211AWDLPeer::gMetaClass);
  if ( v3 )
  {
    v4 = ((int (__fastcall *)(__int64, IO80211AWDLPeer *, const unsigned __int8 *))`vtable for'IO80211Peer[42])(
           v3,
           this,
           a2);
    *(_WORD *)(v3 + 1888) = 1;
    *(_BYTE *)(v3 + 522) = 0;
    if ( !v4 )
    {
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
      v3 = 0LL;
    }
  }
  return v3;
}
// 4B8: using guessed type __int64 qword_4B8[483];
// 7CA90: using guessed type __int64 (__fastcall *off_7CA90[2])(IO80211AWDLPeer *__hidden this);
// 7D300: using guessed type __int64 `vtable for'IO80211Peer[2];
// 84408: using guessed type _QWORD IO80211AWDLPeer::gMetaClass;

//----- (000000000001B12A) ----------------------------------------------------
int __fastcall IO80211AWDLPeer::initWithAddressAndManager(IO80211AWDLPeer *this, const unsigned __int8 *a2, IO80211AWDLPeerManager *a3)
{
  int result; // eax@1

  result = ((int (__fastcall *)(IO80211AWDLPeer *, const unsigned __int8 *, IO80211AWDLPeerManager *))`vtable for'IO80211Peer[42])(
             this,
             a2,
             a3);
  *((_WORD *)this + 944) = 1;
  *((_BYTE *)this + 522) = 0;
  return result;
}
// 7D300: using guessed type __int64 `vtable for'IO80211Peer[2];

//----- (000000000001B158) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::doMonitoring(IO80211AWDLPeer *a1, __int64 a2)
{
  IO80211AWDLPeer *v2; // r15@1
  __int64 v3; // r13@1
  __int64 v4; // rbx@1
  __int64 v5; // rbx@1
  __int64 v6; // rbx@1
  unsigned __int64 v7; // r12@1
  __int64 v8; // rbx@1
  __int64 v9; // rax@1
  __int64 v10; // rbx@1
  unsigned __int64 v11; // r13@3
  int v12; // eax@3
  int v13; // eax@5
  unsigned __int64 v14; // r14@8
  unsigned int v15; // er12@8
  int v16; // eax@10
  signed __int64 v17; // rcx@10
  unsigned __int64 v18; // r13@11
  int v19; // eax@11
  OSMetaClass *v20; // rax@19
  int v21; // STD8_4@19
  int v22; // STD4_4@19
  int v23; // STD0_4@19
  int v24; // STCC_4@19
  int v25; // STC8_4@19
  int v26; // STC0_4@19
  int v27; // STBC_4@19
  int v28; // STB8_4@19
  int v29; // STB4_4@19
  int v30; // STB0_4@19
  int v31; // ebx@19
  int v32; // eax@19
  int v33; // ecx@19
  signed __int64 v34; // rdx@19
  int v35; // STA0_4@21
  int v36; // ST98_4@21
  __int64 v37; // r12@26
  __int64 v38; // rbx@26
  __int64 v39; // rax@26
  __int64 v40; // rcx@28
  bool v41; // cf@28
  __int64 v42; // rax@28
  signed __int64 v43; // rcx@28
  unsigned int v44; // er12@31
  __int64 v45; // r13@32
  __int64 v46; // r13@38
  unsigned __int64 v47; // rax@40
  signed __int64 v48; // rax@41
  __int64 v49; // r14@42
  __int64 v50; // rdi@49
  IO80211PeerManager *v51; // ST100_8@54
  OSMetaClass *v52; // rax@54
  __int64 v53; // STE8_8@54
  unsigned int v54; // STF0_4@54
  int v55; // STE0_4@54
  int v56; // STDC_4@54
  int v57; // STD8_4@54
  int v58; // STD4_4@54
  int v59; // STD0_4@54
  int v60; // STCC_4@54
  int v61; // STC8_4@54
  __int64 v62; // STC0_8@54
  __int64 v63; // rbx@54
  unsigned __int64 v64; // r12@54
  __int64 v65; // rbx@54
  unsigned __int64 v66; // r14@54
  __int64 v67; // rbx@54
  unsigned __int64 v68; // r13@54
  int v69; // STBC_4@54
  int v70; // eax@54
  int v71; // ecx@54
  int v72; // edx@54
  int v73; // ST80_4@54
  unsigned int v75; // [sp+DCh] [bp-54h]@19
  __int64 v76; // [sp+E0h] [bp-50h]@19
  unsigned __int64 v77; // [sp+E8h] [bp-48h]@8
  unsigned __int64 v78; // [sp+F0h] [bp-40h]@1
  IO80211PeerManager *v79; // [sp+F8h] [bp-38h]@19
  unsigned __int64 v80; // [sp+100h] [bp-30h]@1
  IO80211PeerManager *v81; // [sp+100h] [bp-30h]@8

  v2 = a1;
  v3 = *((_QWORD *)a1 + 5);
  v4 = *((_QWORD *)a1 + 158);
  v80 = (unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v4)) >> 64;
  v5 = *((_QWORD *)a1 + 16);
  v78 = (unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v5)) >> 64;
  v6 = *((_QWORD *)a1 + 19);
  v7 = (unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v6)) >> 64;
  v8 = *((_QWORD *)a1 + 155);
  v9 = getAbsoluteTime() - v8;
  v10 = v3;
  if ( *(_BYTE *)(v3 + 7396) & 0xC )
  {
    *((_QWORD *)a1 + 158) = getAbsoluteTime();
  }
  else
  {
    v11 = (unsigned __int128)(4835703278458516699LL * v9) >> 64;
    v12 = *(_DWORD *)(v10 + 7544);
    if ( !v12 )
    {
      if ( *((_WORD *)a1 + 944) )
        v13 = *((_WORD *)a1 + 944) * *((_WORD *)a1 + 644);
      else
        v13 = *((_WORD *)a1 + 644);
      v12 = 160 * v13;
    }
    v81 = (IO80211PeerManager *)(v80 >> 18);
    v14 = v78 >> 18;
    v77 = v7 >> 18;
    v15 = 10000;
    if ( (unsigned int)v12 >= 0x2710 )
      v15 = v12;
    v16 = IO80211Peer::getPacketStats(a1);
    v17 = 498LL;
    if ( v16 )
      goto LABEL_59;
    v18 = v11 >> 18;
    v19 = 0;
    do
      v19 += *((_WORD *)a1 + v17++);
    while ( v17 != 506 );
    if ( v19
      || (unsigned int)v81 <= v15
      || (unsigned int)v14 <= v15
      || (unsigned int)v77 <= v15
      || (unsigned int)v18 <= v15 )
    {
LABEL_59:
      if ( !(unsigned int)IO80211Peer::getPacketStats(a1) && (unsigned int)v81 >= 0x1D4C1 )
        *((_BYTE *)a1 + 1278) &= 0xFDu;
      if ( !*((_BYTE *)a1 + 1203)
        || (v37 = v10,
            v38 = *((_QWORD *)a1 + 155),
            v39 = getAbsoluteTime() - v38,
            v10 = v37,
            (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * v39) >> 64) >> 18) >= 0x1D4C1) )
        *((_BYTE *)a1 + 1278) &= 0xFEu;
      v40 = *((_QWORD *)a1 + 5);
      v41 = *((_DWORD *)a1 + 132) < *(_DWORD *)(v40 + 516);
      v42 = v40 + 508;
      v43 = v40 + 512;
      if ( v41 )
        v42 = v43;
      if ( *((_BYTE *)a1 + 522) )
      {
        v44 = *(_DWORD *)v42;
        IO80211AWDLPeerManager::awdlStatsCountPeersBand((IO80211AWDLPeerManager *)v10, v42, *((_BYTE *)a1 + 1203));
        if ( *((_BYTE *)a1 + 522) )
        {
          v45 = *((_QWORD *)a1 + 22);
          if ( (!v45
             || (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v45)) >> 64) >> 18) > v44)
            && (!*((_QWORD *)a1 + 16) || (unsigned int)v14 > v44)
            && (!*((_QWORD *)a1 + 19) || (unsigned int)v77 > v44) )
          {
            v46 = *((_QWORD *)a1 + 23);
            if ( !v46
              || (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v46)) >> 64) >> 18) > v44 )
            {
              v47 = *(_DWORD *)(a2 + 4);
              if ( v47 <= 0xF )
              {
                *((_BYTE *)a1 + 477) = 0;
                *((_BYTE *)a1 + 522) = 0;
                *(_DWORD *)(a2 + 4) = v47 + 1;
                v48 = 3 * v47;
                *(_WORD *)(a2 + 2 * v48 + 12) = *((_WORD *)a1 + 18);
                *(_DWORD *)(a2 + 2 * v48 + 8) = *((_DWORD *)a1 + 8);
              }
            }
          }
        }
      }
      v49 = *((_QWORD *)a1 + 153);
      if ( v49
        && (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v49)) >> 64) >> 18) >= 0xEA61 )
        *((_WORD *)a1 + 596) = 0;
      if ( *(_DWORD *)(v10 + 7532) )
      {
        if ( *((_BYTE *)a1 + 1203) )
        {
          if ( memcmp(&null_address, (char *)a1 + 1210, 6uLL) )
          {
            if ( (unsigned int)IO80211Peer::getPacketStats(a1) >= 0x10 )
            {
              v50 = *((_QWORD *)a1 + 5);
              if ( !(*(_BYTE *)(v50 + 648) & 3) )
                IO80211AWDLPeerManager::peerDoInfraPing((IO80211AWDLPeerManager *)v50, v2);
            }
          }
        }
      }
      IO80211AWDLPeer::evaluateRoute(v2);
      if ( *((_BYTE *)v2 + 1200) )
        IO80211AWDLPeerManager::doNeighborMonitoring((IO80211AWDLPeerManager *)v10, v2);
      if ( IO80211PeerManager::shouldLog((IO80211PeerManager *)v10, 0x100000000LL) )
      {
        v51 = (IO80211PeerManager *)*((_QWORD *)v2 + 5);
        LODWORD(v52) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)v2 + 56LL))(
                         v2,
                         0x100000000LL);
        v53 = OSMetaClass::getClassName(v52);
        v54 = *((_BYTE *)v2 + 32);
        v55 = *((_BYTE *)v2 + 33);
        v56 = *((_BYTE *)v2 + 34);
        v57 = *((_BYTE *)v2 + 35);
        v58 = *((_BYTE *)v2 + 36);
        v59 = *((_BYTE *)v2 + 37);
        v60 = IO80211Peer::getPacketStats(v2);
        v61 = *((_BYTE *)v2 + 1278);
        v62 = v10;
        v63 = *((_QWORD *)v2 + 158);
        v64 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v63)) >> 64) >> 18;
        v65 = *((_QWORD *)v2 + 16);
        v66 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v65)) >> 64) >> 18;
        v67 = *((_QWORD *)v2 + 19);
        v68 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v67)) >> 64) >> 18;
        v69 = *((_BYTE *)v2 + 1276);
        LODWORD(v67) = *((_BYTE *)v2 + 1277);
        v70 = (char)IO80211Peer::getRssi(v2);
        v71 = *((_WORD *)v2 + 931);
        v72 = *(_DWORD *)(v62 + 4100);
        *((_BYTE *)v2 + 1194);
        v73 = *((_DWORD *)v2 + 132);
        IO80211PeerManager::logDebug(
          v51,
          0x100000000LL,
          "%s::%s %02X:%02X:%02X:%02X:%02X:%02X pkt %u reach %x [%u %u %u] ch %u/%u RSSI %d infraRSSI %d myInfraRSSI %d %s _numTxRxPacketsSinceCache=%u\n",
          v53,
          (__int64)"doMonitoring",
          v54);
      }
      ((void (__fastcall *)(IO80211AWDLPeer *, __int64))`vtable for'IO80211Peer[46])(v2, a2);
    }
    else
    {
      *(_BYTE *)a2 = 1;
      if ( IO80211PeerManager::shouldLog((IO80211PeerManager *)v10, 0x200000000LL) )
      {
        v79 = (IO80211PeerManager *)*((_QWORD *)a1 + 5);
        LODWORD(v20) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)a1 + 56LL))(
                         a1,
                         0x200000000LL);
        v76 = OSMetaClass::getClassName(v20);
        v75 = *((_BYTE *)a1 + 32);
        v21 = *((_BYTE *)a1 + 33);
        v22 = *((_BYTE *)a1 + 34);
        v23 = *((_BYTE *)a1 + 35);
        v24 = *((_BYTE *)a1 + 36);
        v25 = *((_BYTE *)a1 + 37);
        v26 = *((_BYTE *)a1 + 1204);
        v27 = *((_BYTE *)a1 + 1205);
        v28 = *((_BYTE *)a1 + 1206);
        v29 = *((_BYTE *)a1 + 1207);
        v30 = *((_BYTE *)a1 + 1208);
        v31 = *((_BYTE *)a1 + 1209);
        v32 = IO80211Peer::getPacketStats(a1);
        v33 = 0;
        v34 = 498LL;
        do
          v33 += *((_WORD *)a1 + v34++);
        while ( v34 != 506 );
        v35 = *((_WORD *)a1 + 644);
        v36 = *((_WORD *)a1 + 944);
        IO80211PeerManager::logDebug(
          v79,
          0x200000000LL,
          "%s::%s REMOVE %02X:%02X:%02X:%02X:%02X:%02X infra [%02X:%02X:%02X:%02X:%02X:%02X] pkt %u infraTx %u sync %ums rxu %ums out %ums iid %ums peer=%p, idletimeout(%d) pm %u awperiod %u\n",
          v76,
          (__int64)"doMonitoring",
          v75);
      }
    }
  }
  return 0LL;
}
// 77FDC: using guessed type int null_address;
// 7D300: using guessed type __int64 `vtable for'IO80211Peer[2];

//----- (000000000001B840) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::getInfraDataPacketsTxAttemps(IO80211AWDLPeer *this)
{
  __int64 v1; // rcx@1
  __int64 result; // rax@1

  v1 = 0LL;
  LODWORD(result) = 0;
  do
    result = (unsigned int)result + *((_WORD *)this + v1++ + 498);
  while ( v1 != 8 );
  return result;
}

//----- (000000000001B860) ----------------------------------------------------
char __fastcall IO80211AWDLPeer::evaluateRoute(IO80211AWDLPeer *this)
{
  __int64 v1; // rax@1
  char v2; // cl@1
  int v3; // edx@2
  int v4; // eax@9
  int v5; // er14@9
  char result; // al@12

  *(_WORD *)((char *)this + 1201) = 0;
  v1 = *((_QWORD *)this + 5);
  v2 = *((_BYTE *)this + 1278);
  if ( v2 & 1 )
  {
    v3 = *(_BYTE *)(v1 + 3767) + 10;
    if ( *((_BYTE *)this + 1194) != 1 )
      v3 = *(_BYTE *)(v1 + 3767);
    if ( *(_DWORD *)(v1 + 4100) > v3 && *((_WORD *)this + 931) && *((_WORD *)this + 931) > v3 )
      *((_BYTE *)this + 1202) = 1;
  }
  if ( v2 & 2 )
  {
    v4 = *(_BYTE *)(v1 + 3766);
    v5 = v4 + 10;
    if ( *((_BYTE *)this + 1194) != 2 )
      v5 = v4;
    if ( (char)IO80211Peer::getRssi(this) <= v5 )
    {
      result = *((_BYTE *)this + 1201);
    }
    else
    {
      *((_BYTE *)this + 1201) = 1;
      result = 1;
    }
  }
  else
  {
    result = 0;
  }
  if ( *((_BYTE *)this + 1202) <= (unsigned int)(unsigned __int8)result )
  {
    if ( result )
      *((_BYTE *)this + 1194) = 1;
    else
      *((_BYTE *)this + 1194) = 0;
  }
  else
  {
    *((_BYTE *)this + 1194) = 2;
  }
  return result;
}

//----- (000000000001B92A) ----------------------------------------------------
void __fastcall IO80211AWDLPeer::setPresenceMode(IO80211AWDLPeer *this, __int16 a2)
{
  *((_WORD *)this + 944) = a2;
}

//----- (000000000001B938) ----------------------------------------------------
__int64 IO80211AWDLPeer::compareServiceParams()
{
  return 0LL;
}

//----- (000000000001B940) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::buildAwdlInviteTLV(IO80211AWDLPeer *this, unsigned __int8 *a2, __int64 a3, unsigned __int8 a4, char a5)
{
  signed int v5; // er14@1
  __int64 v6; // rdx@2
  __int16 v7; // ax@2
  int v8; // ecx@4
  signed __int16 v9; // r12@5

  v5 = 0;
  if ( a2 )
  {
    v6 = *((_QWORD *)this + 5);
    *a2 = a4;
    a2[1] = 0;
    v7 = *((_WORD *)this + 929) + 1;
    *((_WORD *)this + 929) = v7;
    *((_WORD *)a2 + 2) = v7;
    v5 = 6;
    if ( a5 & 1 && *(_DWORD *)(v6 + 104) && (v8 = *(_DWORD *)(v6 + 4100)) != 0 )
    {
      *((_WORD *)a2 + 3) = v8;
      v5 = 8;
      v9 = 1;
    }
    else
    {
      v9 = 0;
    }
    if ( a5 & 2 && (unsigned __int8)IO80211Peer::getRssi(this) )
    {
      v9 |= 2u;
      memcpy(a2, (char *)this + 32, 6uLL);
      *(_WORD *)&a2[v5 + 6] = (char)IO80211Peer::getRssi(this);
      v5 += 8;
    }
    *((_WORD *)a2 + 1) = v9;
  }
  return (unsigned int)v5;
}

//----- (000000000001BA0C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::handle11zPacket(IO80211AWDLPeer *this, __int64 *a2)
{
  IO80211AWDLPeer *v2; // r15@1
  __int64 v3; // r12@1
  __int64 *v4; // rax@1
  __int64 *v5; // rbx@1
  int v6; // er13@1
  signed __int64 v7; // rsi@1
  IO80211PeerManager *v8; // r14@2
  OSMetaClass *v9; // rax@2
  __int64 v10; // rbx@2
  __int64 v11; // rcx@2
  __int64 v12; // r8@2
  __int64 v13; // r9@2
  IO80211PeerManager *v14; // rdi@2
  int v15; // ebx@3
  __int64 *v16; // r13@3
  IO80211PeerManager *v17; // r14@9
  OSMetaClass *v18; // rax@9
  __int64 v19; // r15@9
  int v20; // eax@9
  __int64 v21; // r9@9
  const char *v22; // rsi@9
  __int64 v23; // rcx@9
  __int64 v24; // rdx@9
  IO80211PeerManager *v25; // rdi@9
  __int64 v26; // r8@9
  unsigned int v27; // er14@10
  int v28; // eax@11
  int v29; // er12@12
  signed int v30; // eax@13
  signed int v31; // edx@14
  unsigned int v32; // er14@14
  unsigned int v33; // er13@14
  __int64 v34; // rbx@19
  unsigned int v35; // eax@19
  __int64 v36; // rdx@19
  unsigned int v37; // ebx@19
  int v38; // eax@22
  IO80211PeerManager *v39; // r14@22
  IO80211PeerManager *v40; // ST38_8@25
  OSMetaClass *v41; // rax@25
  __int64 v42; // rax@25
  int v43; // ST30_4@25
  int v44; // ST28_4@25
  int v45; // ST20_4@25
  int v46; // ST18_4@25
  int v47; // ST10_4@25
  int v48; // ST08_4@25
  int v49; // ST00_4@25
  IO80211PeerManager *v50; // rbx@26
  signed int v51; // ST48_4@26
  OSMetaClass *v52; // rax@26
  __int64 v53; // rax@26
  char v54; // ST38_1@27
  OSMetaClass *v55; // rax@27
  __int64 v56; // rax@27
  int v57; // ST28_4@27
  int v58; // ST20_4@27
  int v59; // ST18_4@27
  int v60; // ST10_4@27
  int v61; // ST08_4@27
  int v62; // ST00_4@27
  IO80211PeerManager *v63; // rdi@27
  char v64; // ST38_1@30
  OSMetaClass *v65; // rax@30
  __int64 v66; // rax@30
  int v67; // ST30_4@30
  int v68; // ST28_4@30
  int v69; // ST20_4@30
  int v70; // ST18_4@30
  int v71; // ST10_4@30
  int v72; // ST08_4@30
  int v73; // ST00_4@30
  IO80211PeerManager *v74; // rdi@30
  char v75; // al@39
  __int64 v76; // rax@42
  IO80211PeerManager *v77; // rbx@43
  OSMetaClass *v78; // rax@43
  __int64 v79; // rax@43
  IO80211PeerManager *v81; // rbx@45
  OSMetaClass *v82; // rax@45
  OSMetaClass *v83; // rax@46
  IO80211PeerManager *v84; // r14@20
  OSMetaClass *v85; // rax@20
  signed int v86; // [sp+44h] [bp-4Ch]@12
  int v87; // [sp+48h] [bp-48h]@3
  signed int v88; // [sp+48h] [bp-48h]@24
  __int64 *v89; // [sp+50h] [bp-40h]@1
  __int64 *v90; // [sp+58h] [bp-38h]@1
  bool v91; // [sp+67h] [bp-29h]@1

  v89 = a2;
  v2 = this;
  v3 = *a2;
  LODWORD(v4) = mbuf_data(*a2);
  v5 = v4;
  v90 = v4;
  v6 = mbuf_len(v3);
  v91 = 0;
  v7 = 0x4000000LL;
  if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)this + 5), 0x4000000LL) )
  {
    v90 = v5;
    v8 = (IO80211PeerManager *)*((_QWORD *)this + 5);
    LODWORD(v9) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)this + 56LL))(this, 0x4000000LL);
    v10 = OSMetaClass::getClassName(v9);
    mbuf_len(v3);
    IO80211PeerManager::logDebug(v8, 0x4000000LL, "%s::%s m=%p len %u\n", v10, (__int64)"handle11zPacket", v3);
    v14 = (IO80211PeerManager *)*((_QWORD *)this + 5);
    if ( v6 )
    {
      v15 = v6;
      v87 = v6;
      v16 = v90;
      do
      {
        IO80211PeerManager::logDebug(v14, 0x4000000LL, "%02X ", *(_BYTE *)v16, v12, v13);
        v14 = (IO80211PeerManager *)*((_QWORD *)v2 + 5);
        v16 = (__int64 *)((char *)v16 + 1);
        --v15;
      }
      while ( v15 );
    }
    else
    {
      v87 = 0;
    }
    v7 = 0x4000000LL;
    IO80211PeerManager::logDebug(v14, 0x4000000LL, "\n", v11, v12, v13);
    v5 = v90;
    v6 = v87;
  }
  if ( (unsigned int)v6 <= 0x15 )
  {
    v17 = (IO80211PeerManager *)*((_QWORD *)v2 + 5);
    LODWORD(v18) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)v2 + 56LL))(v2, 0x4000000LL);
    v19 = OSMetaClass::getClassName(v18);
    v20 = mbuf_len(v3);
    v22 = "%s::%s invalid length %u\n";
    v23 = (__int64)"handle11zPacket";
    v24 = v19;
    v25 = v17;
    v26 = (unsigned int)v20;
    goto LABEL_10;
  }
  ++*((_DWORD *)v2 + 296);
  *((_QWORD *)v2 + 155) = getAbsoluteTime();
  v28 = *((_BYTE *)v5 + 19);
  if ( v28 != 7 )
  {
    v27 = 0;
    if ( (unsigned __int8)v28 == 8 )
    {
      v76 = (unsigned int)mbuf_get_traffic_class(v3);
      *((_DWORD *)v2 + v76 + 99) = *((_WORD *)v5 + 10) & 0x3FF;
      *((_BYTE *)v89 + 9) = 1;
      ++*((_DWORD *)v2 + v76 + 410);
    }
    return v27;
  }
  v29 = v6 - 22;
  v86 = 0;
  if ( (unsigned int)(v6 - 22) < 3 )
  {
LABEL_36:
    if ( memcmp((char *)v2 + 32, &null_address, 6uLL) )
    {
      memcpy((char *)v89 + 19, (char *)v2 + 32, 6uLL);
      *((_BYTE *)v89 + 11) = 1;
    }
    v27 = 0;
    if ( v86 )
    {
      v75 = *((_BYTE *)v2 + 1203);
      if ( v75 )
      {
        *((_BYTE *)v89 + 10) = 1;
        *((_BYTE *)v89 + 12) = v75;
        memcpy((char *)v89 + 13, (char *)v2 + 1204, 6uLL);
      }
    }
    return v27;
  }
  v30 = 22;
  v86 = 0;
  while ( 1 )
  {
    v31 = v30;
    v32 = *((_BYTE *)v5 + (unsigned int)v30);
    v33 = *(_WORD *)((char *)v5 + (unsigned int)(v30 + 1));
    if ( v33 > v29 - 3 )
    {
      v77 = (IO80211PeerManager *)*((_QWORD *)v2 + 5);
      LODWORD(v78) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)v2 + 56LL))(v2, v7);
      v79 = OSMetaClass::getClassName(v78);
      IO80211PeerManager::logDebug(
        v77,
        "%s::%s invalid tlv length type %u len %u tlv_len %u\n",
        v79,
        (__int64)"handle11zPacket",
        v32,
        (unsigned int)v29);
      return -1;
    }
    if ( !(_WORD)v33 )
      goto LABEL_36;
    if ( v32 != 12 )
    {
      if ( v32 == 10 )
      {
        v38 = *((_BYTE *)v5 + (unsigned int)(v30 + 3));
        LOWORD(v39) = *(_WORD *)((char *)v5 + (unsigned int)(v31 + 5));
        *((_WORD *)v2 + 930) = *(_WORD *)((char *)v5 + (unsigned int)(v31 + 7));
        if ( v38 == 5 )
        {
          v88 = v31;
          *((_BYTE *)v2 + 1278) |= 1u;
          v54 = (char)v39;
          v39 = (IO80211PeerManager *)*((_QWORD *)v2 + 5);
          LODWORD(v55) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)v2 + 56LL))(v2, v7);
          v56 = OSMetaClass::getClassName(v55);
          v57 = *((_DWORD *)v2 + 297);
          v58 = *((_DWORD *)v2 + 296);
          v59 = *((_BYTE *)v5 + 11);
          v60 = *((_BYTE *)v5 + 10);
          v61 = *((_BYTE *)v5 + 9);
          v62 = *((_BYTE *)v5 + 8);
          v63 = v39;
          LOBYTE(v39) = v54;
          v7 = (signed __int64)"%s::%s infra got ROAM REQUEST [%02X:%02X:%02X:%02X:%02X:%02X] Rx %u Tx %u\n";
          IO80211PeerManager::logDebug(
            v63,
            "%s::%s infra got ROAM REQUEST [%02X:%02X:%02X:%02X:%02X:%02X] Rx %u Tx %u\n",
            v56,
            (__int64)"handle11zPacket",
            *((_BYTE *)v5 + 6),
            *((_BYTE *)v5 + 7));
          v86 = 1;
        }
        else if ( (unsigned __int8)v38 == 1 )
        {
          v88 = v31;
          *((_BYTE *)v2 + 1278) |= 1u;
          v7 = 0x4000000LL;
          if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)v2 + 5), 0x4000000LL) )
          {
            v40 = (IO80211PeerManager *)*((_QWORD *)v2 + 5);
            LODWORD(v41) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)v2 + 56LL))(
                             v2,
                             0x4000000LL);
            v42 = OSMetaClass::getClassName(v41);
            v43 = *((_DWORD *)v2 + 297);
            v44 = *((_DWORD *)v2 + 296);
            v45 = *((_BYTE *)v5 + 11);
            v46 = *((_BYTE *)v5 + 10);
            v47 = *((_BYTE *)v5 + 9);
            v48 = *((_BYTE *)v5 + 8);
            v49 = *((_BYTE *)v5 + 7);
            v7 = 0x4000000LL;
            IO80211PeerManager::logDebug(
              v40,
              0x4000000LL,
              "%s::%s infra got AWDL_INVITE_OPCODE_SUCCESS [%02X:%02X:%02X:%02X:%02X:%02X] Rx %u Tx %u\n",
              v42,
              (__int64)"handle11zPacket",
              *((_BYTE *)v5 + 6));
          }
        }
        else if ( (_BYTE)v38 )
        {
          v88 = v31;
        }
        else
        {
          v88 = v31;
          v7 = 0x4000000LL;
          if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)v2 + 5), 0x4000000LL) )
          {
            v64 = (char)v39;
            v39 = (IO80211PeerManager *)*((_QWORD *)v2 + 5);
            LODWORD(v65) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)v2 + 56LL))(
                             v2,
                             0x4000000LL);
            v66 = OSMetaClass::getClassName(v65);
            v67 = *((_DWORD *)v2 + 297);
            v68 = *((_DWORD *)v2 + 296);
            v69 = *((_BYTE *)v5 + 11);
            v70 = *((_BYTE *)v5 + 10);
            v71 = *((_BYTE *)v5 + 9);
            v72 = *((_BYTE *)v5 + 8);
            v73 = *((_BYTE *)v5 + 7);
            v7 = 0x4000000LL;
            v74 = v39;
            LOBYTE(v39) = v64;
            IO80211PeerManager::logDebug(
              v74,
              0x4000000LL,
              "%s::%s infra got AWDL_INVITE_OPCODE_AWDL_PING [%02X:%02X:%02X:%02X:%02X:%02X] Rx %u Tx %u\n",
              v66,
              (__int64)"handle11zPacket",
              *((_BYTE *)v5 + 6));
          }
          *((_BYTE *)v89 + 8) = 1;
          *((_BYTE *)v89 + 73) = 1;
        }
        LODWORD(v36) = v88;
        if ( (unsigned __int8)v39 & 1 )
          *((_WORD *)v2 + 931) = *(_WORD *)((char *)v90 + (unsigned int)(v88 + 9));
      }
      else
      {
        v50 = (IO80211PeerManager *)*((_QWORD *)v2 + 5);
        v51 = v30;
        LODWORD(v52) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)v2 + 56LL))(v2, v7);
        v53 = OSMetaClass::getClassName(v52);
        v7 = (signed __int64)"%s::%s unknown tlv %u tlv_len %u\n";
        IO80211PeerManager::logDebug(
          v50,
          "%s::%s unknown tlv %u tlv_len %u\n",
          v53,
          (__int64)"handle11zPacket",
          v32,
          v33);
        LODWORD(v36) = v51;
      }
      goto LABEL_35;
    }
    if ( v33 >= 0xC0 )
    {
      v81 = (IO80211PeerManager *)*((_QWORD *)v2 + 5);
      LODWORD(v82) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)v2 + 56LL))(v2, v7);
      v24 = OSMetaClass::getClassName(v82);
      v22 = "%s::%s AWDL_DATA_PATH_STATE_TLV tlv too large %u\n";
      goto LABEL_47;
    }
    if ( v33 <= 1 )
      break;
    v7 = (signed __int64)((char *)v5 + (unsigned int)v30 + 3);
    v34 = (unsigned int)v30;
    v35 = IO80211AWDLPeer::parseAwdlDataPathTLV(v2, (unsigned __int8 *)v7, v33, &v91, "Enc");
    v36 = v34;
    v37 = v35;
    if ( v35 )
    {
      v84 = (IO80211PeerManager *)*((_QWORD *)v2 + 5);
      LODWORD(v85) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64, __int64))(*(_QWORD *)v2 + 56LL))(
                       v2,
                       v7,
                       v36);
      v24 = OSMetaClass::getClassName(v85);
      v22 = "%s::%s error parsing data path state %d\n";
      v23 = (__int64)"handle11zPacket";
      v25 = v84;
      v26 = v37;
      goto LABEL_10;
    }
LABEL_35:
    v29 -= v33 + 3;
    v30 = v33 + v36 + 3;
    v5 = v90;
    if ( (unsigned int)v29 <= 2 )
      goto LABEL_36;
  }
  v81 = (IO80211PeerManager *)*((_QWORD *)v2 + 5);
  LODWORD(v83) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)v2 + 56LL))(v2, v7);
  v24 = OSMetaClass::getClassName(v83);
  v22 = "%s::%s AWDL_DATA_PATH_STATE_TLV too short %u\n";
LABEL_47:
  v23 = (__int64)"handle11zPacket";
  v25 = v81;
  v26 = v33;
LABEL_10:
  IO80211PeerManager::logDebug(v25, v22, v24, v23, v26, v21);
  return -1;
}
// 77FDC: using guessed type int null_address;
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C30: using guessed type int __fastcall mbuf_get_traffic_class(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);

//----- (000000000001C03E) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::parseAwdlDataPathTLV(IO80211AWDLPeer *this, unsigned __int8 *a2, unsigned int a3, bool *a4, char *a5)
{
  __int64 result; // rax@1
  unsigned __int16 v6; // r14@4
  unsigned __int16 v7; // cx@4
  signed __int64 v8; // r15@4
  unsigned __int16 v9; // r15@5
  char v10; // ST108_1@10
  char v11; // ST10C_1@10
  char v12; // ST110_1@10
  char v13; // ST114_1@10
  char v14; // ST118_1@10
  char v15; // ST11C_1@10
  IO80211PeerManager *v16; // r13@12
  OSMetaClass *v17; // rax@12
  __int64 v18; // rax@12
  int v19; // ST28_4@12
  int v20; // ST20_4@12
  int v21; // ST18_4@12
  int v22; // ST10_4@12
  int v23; // ST08_4@12
  int v24; // ST00_4@12
  char v25; // dl@13
  char v26; // ST114_1@14
  int v27; // eax@16
  __int64 v28; // rbx@19
  char v29; // al@20
  IO80211PeerManager *v30; // rbx@28
  OSMetaClass *v31; // rax@28
  __int64 v32; // rax@28
  __int64 v33; // r8@28
  __int64 v34; // r9@28
  const void *v35; // rsi@32
  IO80211PeerManager *v36; // ST130_8@36
  OSMetaClass *v37; // rax@36
  __int64 v38; // ST120_8@36
  int v39; // ST104_4@36
  int v40; // STF8_4@36
  int v41; // STF4_4@36
  int v42; // STF0_4@36
  int v43; // STEC_4@36
  int v44; // ST11C_4@36
  int v45; // ST118_4@36
  int v46; // STE8_4@36
  int v47; // STE4_4@36
  int v48; // STE0_4@36
  __int64 v49; // r13@36
  int v50; // STC8_4@36
  int v51; // STB8_4@36
  int v52; // STB0_4@36
  int v53; // STA8_4@36
  int v54; // STA0_4@36
  int v55; // ST98_4@36
  int v56; // ST90_4@36
  int v57; // ST88_4@36
  bool *v58; // [sp+F8h] [bp-68h]@4
  bool v59; // [sp+120h] [bp-40h]@14
  char v60; // [sp+12Ch] [bp-34h]@8
  unsigned __int8 *v61; // [sp+130h] [bp-30h]@9

  result = 0xFFFFFFFFLL;
  if ( a3 < 2 )
    return result;
  if ( a4 )
    *a4 = 0;
  v58 = a4;
  v6 = *(_WORD *)a2;
  v7 = *(_WORD *)a2;
  *((_BYTE *)this + 1160) = ((unsigned __int8)*(_WORD *)a2 >> 5) & 1;
  v8 = 2LL;
  if ( HIBYTE(v7) & 1 )
  {
    v9 = v7;
    memcpy((char *)this + 1216, a2 + 2, 3uLL);
    v7 = v9;
    v8 = 5LL;
  }
  if ( HIBYTE(v7) & 2 )
  {
    *((_BYTE *)this + 1298) = *(_WORD *)&a2[v8];
    v8 = (unsigned int)(v8 + 2);
  }
  v60 = v7;
  if ( v7 & 1 )
  {
    v61 = a2;
    if ( !memcmp((char *)this + 1204, &a2[v8], 6uLL) )
    {
      v25 = 0;
    }
    else
    {
      *((_QWORD *)this + 148) = 0LL;
      v10 = *((_BYTE *)this + 1204);
      v11 = *((_BYTE *)this + 1205);
      v12 = *((_BYTE *)this + 1206);
      v13 = *((_BYTE *)this + 1207);
      v14 = *((_BYTE *)this + 1208);
      v15 = *((_BYTE *)this + 1209);
      memcpy((char *)this + 1204, &a2[v8], 6uLL);
      if ( !memcmp(&null_address, (char *)this + 1204, 6uLL) && *((_BYTE *)this + 1203) )
      {
        v16 = (IO80211PeerManager *)*((_QWORD *)this + 5);
        LODWORD(v17) = (*(int (__fastcall **)(IO80211AWDLPeer *, char *))(*(_QWORD *)this + 56LL))(
                         this,
                         (char *)this + 1204);
        v18 = OSMetaClass::getClassName(v17);
        v19 = *((_BYTE *)this + 1203);
        v20 = *((_BYTE *)this + 1215);
        v21 = *((_BYTE *)this + 1214);
        v22 = *((_BYTE *)this + 1213);
        v23 = *((_BYTE *)this + 1212);
        v24 = *((_BYTE *)this + 1211);
        IO80211PeerManager::logDebug(
          v16,
          0x10000LL,
          "%s::%s Peer link loss on infra [%02X:%02X:%02X:%02X:%02X:%02X] ch %u \n",
          v18,
          (__int64)"parseAwdlDataPathTLV",
          *((_BYTE *)this + 1210));
        *((_BYTE *)this + 1203) = 0;
      }
      *((_BYTE *)this + 1278) &= 0xFEu;
      *((_BYTE *)this + 1193) = 0;
      v25 = 1;
    }
    v27 = *(_WORD *)&a2[(unsigned int)(v8 + 6)];
    if ( *((_BYTE *)this + 1203) != v27 )
      v25 = 1;
    v59 = v25;
    *((_BYTE *)this + 1203) = v27;
    LODWORD(v8) = v8 + 8;
    if ( (_BYTE)v27 )
    {
      v28 = *((_QWORD *)this + 153);
      if ( (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v28)) >> 64) >> 18) >= 0x3E9 )
      {
        v29 = v60;
        if ( !(*((_BYTE *)this + 1278) & 1) && *((_DWORD *)this + 297) <= 3u && v58 )
          *v58 = 1;
        goto LABEL_25;
      }
    }
  }
  else
  {
    v61 = a2;
    v59 = *((_BYTE *)this + 1203) != 0;
    *((_BYTE *)this + 1203) = 0;
    v26 = (unsigned __int64)memset((char *)this + 1204, 0, 6uLL);
  }
  v29 = v60;
LABEL_25:
  if ( v29 & 2 )
  {
    if ( !memcmp(&v61[(unsigned int)v8], &null_address, 6uLL) )
    {
      v30 = (IO80211PeerManager *)*((_QWORD *)this + 5);
      LODWORD(v31) = (*(int (__fastcall **)(IO80211AWDLPeer *, int *))(*(_QWORD *)this + 56LL))(this, &null_address);
      v32 = OSMetaClass::getClassName(v31);
      IO80211PeerManager::logDebug(
        v30,
        "%s::%s received null infra address\n",
        v32,
        (__int64)"parseAwdlDataPathTLV",
        v33,
        v34);
      v6 &= 0xFFFDu;
    }
    else
    {
      memcpy((char *)this + 1210, &v61[(unsigned int)v8], 6uLL);
      LODWORD(v8) = v8 + 6;
    }
  }
  if ( (v6 & 3) == 1 )
    memcpy((char *)this + 1210, (char *)this + 32, 6uLL);
  if ( v6 & 4 )
  {
    v35 = &v61[(unsigned int)v8];
    if ( memcmp((char *)this + 32, v35, 6uLL) )
      memcpy((char *)this + 32, v35, 6uLL);
  }
  if ( v59 )
  {
    if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)this + 5), 0x200000000LL) )
    {
      v36 = (IO80211PeerManager *)*((_QWORD *)this + 5);
      LODWORD(v37) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       0x200000000LL);
      v38 = OSMetaClass::getClassName(v37);
      v39 = *((_BYTE *)this + 33);
      v40 = *((_BYTE *)this + 34);
      v41 = *((_BYTE *)this + 35);
      v42 = *((_BYTE *)this + 36);
      v43 = *((_BYTE *)this + 37);
      v44 = *((_BYTE *)this + 1204);
      v45 = *((_BYTE *)this + 1205);
      v46 = *((_BYTE *)this + 1206);
      v47 = *((_BYTE *)this + 1207);
      v48 = *((_BYTE *)this + 1208);
      v49 = *((_BYTE *)this + 1209);
      v50 = *((_BYTE *)this + 1278);
      v51 = *((_BYTE *)this + 1203);
      v52 = *((_BYTE *)this + 1215);
      v53 = *((_BYTE *)this + 1214);
      v54 = *((_BYTE *)this + 1213);
      v55 = *((_BYTE *)this + 1212);
      v56 = *((_BYTE *)this + 1211);
      v57 = *((_BYTE *)this + 1210);
      IO80211PeerManager::logDebug(
        v36,
        0x200000000LL,
        "%s::%s peer awdl=[%02X:%02X:%02X:%02X:%02X:%02X] has new BSSID=[%02X:%02X:%02X:%02X:%02X:%02X] was [%02X:%02X:%02X:%02X:%02X:%02X] for infra address =[%02X:%02X:%02X:%02X:%02X:%02X] channel %u flags %x reach %u %s\n",
        v38,
        (__int64)"parseAwdlDataPathTLV",
        *((_BYTE *)this + 32));
    }
    if ( *((_BYTE *)this + 522) )
      (*(void (__fastcall **)(_QWORD, IO80211AWDLPeer *))(**((_QWORD **)this + 5) + 376LL))(*((_QWORD *)this + 5), this);
  }
  *((_BYTE *)this + 1161) = ((unsigned __int8)v6 >> 6) & 1;
  *((_BYTE *)this + 1163) = ((unsigned int)v6 >> 10) & 1;
  *((_BYTE *)this + 1162) = (unsigned __int8)v6 >> 7;
  return 0LL;
}
// 77FDC: using guessed type int null_address;

//----- (000000000001C67A) ----------------------------------------------------
char __fastcall IO80211AWDLPeer::printTlv(__int64 a1, __int64 a2)
{
  __int64 *v2; // r15@1
  __int64 v3; // r14@1
  char result; // al@1
  __int64 v5; // r9@2
  int v6; // ebx@3
  unsigned __int64 v7; // rax@3
  char v8[8]; // rcx@4
  __int64 v9; // r8@7
  __int64 v10; // r9@7
  IO80211PeerManager *v11; // rdi@7
  int v12; // ebx@7
  __int64 v13; // rcx@8

  v2 = (__int64 *)a2;
  v3 = a1;
  result = IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(a1 + 40), 0x10000LL);
  if ( result )
  {
    result = IO80211PeerManager::shouldVerboseLog(*(IO80211PeerManager **)(a1 + 40), 0x10000LL);
    if ( result )
    {
      v6 = *(_WORD *)(a2 + 1);
      v7 = *(_BYTE *)a2;
      if ( v7 > 0x12 )
        *(_QWORD *)v8 = "UNKNOWN";
      else
        *(_QWORD *)v8 = off_7CD20[v7];
      IO80211PeerManager::logDebug(
        *(IO80211PeerManager **)(a1 + 40),
        0x10000LL,
        "   %s len %u [",
        *(__int64 *)v8,
        *(_WORD *)(a2 + 1),
        v5);
      v11 = *(IO80211PeerManager **)(a1 + 40);
      v12 = v6 + 3;
      do
      {
        IO80211PeerManager::logDebug(v11, 0x10000LL, "%02X ", *(_BYTE *)v2, v9, v10);
        v11 = *(IO80211PeerManager **)(v3 + 40);
        v2 = (__int64 *)((char *)v2 + 1);
        --v12;
      }
      while ( v12 );
      result = IO80211PeerManager::logDebug(v11, 0x10000LL, "]\n", v13, v9, v10);
    }
  }
  return result;
}
// 7CD20: using guessed type char *off_7CD20[19];

//----- (000000000001C73C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::tlvCheckBounds(__int64 a1, __int64 a2, unsigned int a3, unsigned int a4, __int64 a5)
{
  __int64 v5; // r13@1
  __int64 v6; // r14@1
  signed int v7; // er15@1
  __int64 result; // rax@1
  signed int v9; // ebx@2
  unsigned int v10; // er9@2
  unsigned int v11; // er12@14
  __int64 v12; // r15@14
  OSMetaClass *v13; // rax@15
  __int64 v14; // rcx@15
  __int64 v15; // r9@15
  char *v16; // rax@18
  __int64 v17; // rbx@21
  OSMetaClass *v18; // rax@22
  char *v19; // rax@25
  const char *v20; // rdx@26
  IO80211PeerManager *v21; // r15@30
  OSMetaClass *v22; // rax@30
  __int64 v23; // rcx@30
  unsigned __int64 v24; // rax@30
  char v25[8]; // r9@31
  signed int v26; // ebx@33
  __int64 v27; // rcx@35
  __int64 v28; // r8@35
  __int64 v29; // r9@35
  IO80211PeerManager *v30; // rdi@35
  __int64 *v31; // r13@36
  unsigned int v32; // er9@41
  signed int v33; // er12@41
  unsigned int v34; // esi@42
  __int64 v35; // rbx@43
  IO80211PeerManager *v36; // r15@44
  OSMetaClass *v37; // rax@44
  __int64 v38; // rcx@44
  __int64 v39; // r9@44
  IO80211PeerManager *v40; // [sp+20h] [bp-40h]@15
  unsigned int v41; // [sp+28h] [bp-38h]@21
  unsigned int v42; // [sp+30h] [bp-30h]@14
  signed int v43; // [sp+34h] [bp-2Ch]@14

  v5 = a2;
  v6 = a1;
  v7 = 1024;
  result = 0LL;
  if ( a4 - 1 <= 0x11 )
  {
    v9 = 5;
    v10 = 260;
    switch ( a4 )
    {
      case 1u:
        v9 = 6;
        goto LABEL_11;
      case 2u:
        v9 = 9;
        v10 = 4096;
        goto LABEL_13;
      case 4u:
        if ( a3 >= 3 )
        {
          v32 = *(_BYTE *)(a2 + 36);
          v33 = 3;
          if ( v32 > 0x1F || (v34 = *(_BYTE *)(a2 + 37), v33 = 4, v34 > 3) )
          {
            v35 = a5;
            v42 = a3;
            if ( IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(a1 + 40), 98304LL) )
            {
              v36 = *(IO80211PeerManager **)(a1 + 40);
              LODWORD(v37) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)a1 + 56LL))(a1, 98304LL);
              v38 = OSMetaClass::getClassName(v37);
              v39 = (__int64)&byte_690F5;
              if ( v35 )
                v39 = v35;
              IO80211PeerManager::logDebug(
                v36,
                98304LL,
                "%s::%s %s %s parse error %u len %u\n",
                v38,
                (__int64)"tlvCheckBounds",
                v39);
            }
            v43 = v33;
            goto LABEL_29;
          }
          v10 = (((1 - (((unsigned __int8)v34 < 1u) - 1)) * (v32 + 1) + 45) & 0xFFFFFFFC) - 3;
          v9 = 3;
        }
        else
        {
          v10 = 1024;
          v9 = 3;
        }
LABEL_13:
        if ( v9 <= a3 )
        {
          v7 = v10;
          goto LABEL_20;
        }
        v11 = a4;
        v12 = a5;
        v42 = a3;
        v43 = 1;
        if ( !IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(a1 + 40), 98304LL) )
          goto LABEL_29;
        v40 = *(IO80211PeerManager **)(a1 + 40);
        LODWORD(v13) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)a1 + 56LL))(a1, 98304LL);
        v14 = OSMetaClass::getClassName(v13);
        v15 = (__int64)&byte_690F5;
        if ( v12 )
          v15 = v12;
        if ( v11 <= 0x12 )
          v16 = off_7CD20[v11];
        v20 = "%s::%s %s %s too short len %u min %u max %u\n";
        break;
      case 5u:
        v9 = 21;
        v10 = 37;
        goto LABEL_13;
      case 6u:
        v9 = 9;
        v10 = 41;
        goto LABEL_13;
      case 0xCu:
        v9 = 2;
        v10 = 191;
        goto LABEL_13;
      case 0x11u:
        v9 = 3;
LABEL_11:
        v10 = 1024;
        goto LABEL_13;
      case 0x12u:
        v9 = 3;
        v10 = 67;
        goto LABEL_13;
      case 0x10u:
        goto LABEL_13;
      case 3u:
      case 7u:
      case 8u:
      case 9u:
      case 0xAu:
      case 0xBu:
      case 0xDu:
      case 0xEu:
      case 0xFu:
        goto LABEL_20;
    }
    goto LABEL_28;
  }
LABEL_20:
  if ( v7 >= a3 )
    return result;
  v41 = a4;
  v17 = a5;
  v42 = a3;
  v43 = 2;
  if ( IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(a1 + 40), 98304LL) )
  {
    v40 = *(IO80211PeerManager **)(a1 + 40);
    LODWORD(v18) = (*(int (__fastcall **)(_QWORD, signed __int64))(*(_QWORD *)a1 + 56LL))(a1, 98304LL);
    v14 = OSMetaClass::getClassName(v18);
    v15 = (__int64)&byte_690F5;
    if ( v17 )
      v15 = v17;
    if ( v41 <= 0x12 )
      v19 = off_7CD20[v41];
    v20 = "%s::%s %s %s too large len %u min %u max %u\n";
LABEL_28:
    IO80211PeerManager::logDebug(v40, 98304LL, v20, v14, (__int64)"tlvCheckBounds", v15);
  }
LABEL_29:
  if ( IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(a1 + 40), 0x10000LL) )
  {
    v21 = *(IO80211PeerManager **)(a1 + 40);
    LODWORD(v22) = (*(int (__fastcall **)(_QWORD, signed __int64))(*(_QWORD *)a1 + 56LL))(a1, 0x10000LL);
    v23 = OSMetaClass::getClassName(v22);
    v24 = *(_BYTE *)v5;
    if ( v24 > 0x12 )
      *(_QWORD *)v25 = "UNKNOWN";
    else
      *(_QWORD *)v25 = off_7CD20[v24];
    v26 = 128;
    if ( v42 <= 0x80 )
      v26 = (unsigned __int16)v42;
    IO80211PeerManager::logDebug(
      v21,
      0x10000LL,
      "%s::%s ERROR: %s (%u) len %u [",
      v23,
      (__int64)"tlvCheckBounds",
      *(__int64 *)v25);
    v30 = *(IO80211PeerManager **)(a1 + 40);
    if ( v26 )
    {
      v31 = (__int64 *)(v5 + 3);
      do
      {
        IO80211PeerManager::logDebug(v30, 0x10000LL, "%02X ", *(_BYTE *)v31, v28, v29);
        v30 = *(IO80211PeerManager **)(v6 + 40);
        v31 = (__int64 *)((char *)v31 + 1);
        --v26;
      }
      while ( v26 );
    }
    IO80211PeerManager::logDebug(v30, 0x10000LL, "]\n", v27, v28, v29);
  }
  return (unsigned int)v43;
}
// 690F5: using guessed type char byte_690F5;
// 7CD20: using guessed type char *off_7CD20[19];

//----- (000000000001CB34) ----------------------------------------------------
char __fastcall IO80211AWDLPeer::actionFrameReport(IO80211AWDLPeer *a1, __int64 a2)
{
  __int64 v2; // r15@1
  IO80211PeerManager *v3; // rbx@1
  __int64 v4; // r13@1
  __int64 v5; // rax@1
  __int64 v6; // r14@1
  signed __int64 v7; // rax@1
  signed __int64 v8; // r12@1
  int v9; // eax@1
  unsigned int v10; // ebx@4
  IO80211PeerManager *v11; // r14@5
  __int64 v12; // rax@5
  __int64 v13; // r8@5
  __int64 v14; // r9@5
  __int64 v15; // rcx@7
  __int64 v16; // r8@7
  __int64 v17; // r9@7
  __int64 v18; // rax@8
  __int64 v19; // rbx@8
  unsigned int i; // eax@8
  unsigned __int64 v21; // r14@10
  unsigned __int64 v22; // rax@10
  __int64 v23; // rcx@10
  __int64 v24; // r8@10
  __int64 v25; // r9@10
  bool v26; // cf@10
  bool v27; // zf@10
  signed __int64 v28; // rax@10
  IO80211PeerManager *v29; // rdi@12
  signed int v30; // eax@15
  __int64 v31; // rcx@16
  signed __int64 v32; // rsi@19
  unsigned int v33; // ecx@19
  signed int v34; // ebx@20
  __int64 v35; // rdx@21
  __int64 v36; // r15@21
  __int64 v37; // r13@21
  size_t v38; // r14@21
  __int64 v39; // rbx@22
  int v40; // eax@22
  __int64 v41; // r8@23
  __int64 v42; // r9@23
  __int64 v43; // rax@23
  __int64 v44; // rcx@23
  __int64 v45; // rdx@23
  __int64 v46; // rbx@26
  unsigned int v47; // ecx@29
  unsigned int v48; // er12@31
  IO80211PeerManager *v49; // r14@31
  unsigned int v50; // ecx@35
  __int64 v51; // r15@37
  __int64 v52; // r14@38
  char *v53; // r12@38
  __int64 v54; // rdi@39
  unsigned int v55; // ecx@41
  __int64 v56; // r9@43
  signed __int64 v57; // r12@44
  __int64 *v58; // r15@44
  unsigned int v59; // ecx@46
  int v60; // eax@50
  __int64 v61; // r14@50
  OSMetaClass *v62; // rax@53
  __int64 v63; // rax@53
  __int64 v64; // r9@53
  __int64 v65; // rdi@54
  unsigned int v66; // ecx@55
  unsigned __int8 *v67; // rsi@57
  __int64 v68; // rdx@57
  __int64 v69; // rcx@57
  __int64 v70; // r8@57
  __int64 v71; // r9@57
  unsigned int v72; // er12@57
  IO80211PeerManager *v73; // r14@57
  char v74; // al@58
  __int64 v75; // rbx@58
  IO80211PeerManager *v76; // r14@60
  OSMetaClass *v77; // rax@60
  __int64 v78; // rax@60
  __int64 v79; // r12@62
  size_t v80; // rsi@62
  unsigned int v81; // eax@62
  IO80211PeerManager *v82; // r14@63
  OSMetaClass *v83; // rax@63
  __int64 v84; // rax@63
  __int64 v85; // r9@63
  unsigned int v86; // ecx@65
  __int64 v87; // r15@68
  __int64 v88; // rax@68
  __int64 v89; // r13@68
  __int64 v90; // r12@68
  IO80211PeerManager *v91; // STD8_8@69
  OSMetaClass *v92; // rax@69
  __int64 v93; // rax@69
  const void *v94; // rbx@70
  size_t v95; // rsi@72
  int v96; // er13@72
  void *v97; // rax@74
  IO80211PeerManager *v98; // STD8_8@76
  OSMetaClass *v99; // rax@76
  __int64 v100; // rax@76
  __int64 v101; // rax@77
  __int64 v102; // r14@80
  __int64 v103; // r8@80
  __int64 v104; // r9@80
  signed __int64 v105; // rax@83
  __int64 v106; // r14@83
  OSMetaClass *v107; // rax@87
  __int64 v108; // rax@87
  signed int v109; // eax@90
  IO80211AWDLPeer *v110; // rdi@95
  __int64 v111; // rbx@95
  int v112; // eax@95
  IO80211PeerManager *v113; // r14@99
  OSMetaClass *v114; // rax@99
  __int64 v115; // rax@99
  __int64 v116; // rcx@103
  __int64 v117; // rdi@104
  __int64 v118; // rcx@105
  OSMetaClass *v119; // rax@108
  __int64 v120; // rax@108
  __int64 v121; // r9@108
  __int64 v122; // rdi@113
  int v123; // er14@116
  __int64 v124; // rcx@116
  unsigned int v125; // edx@116
  OSMetaClass *v126; // rax@128
  __int64 v127; // rax@128
  __int64 v128; // r9@128
  OSMetaClass *v129; // rax@131
  __int64 v130; // rax@131
  __int64 v131; // r9@131
  unsigned int v132; // er14@135
  int v133; // eax@136
  char v134; // cl@136
  int v135; // eax@138
  bool v136; // r12@140
  int v137; // edx@140
  int v138; // er14@142
  unsigned int v139; // er13@147
  __int64 v140; // rbx@147
  __int64 v141; // r12@152
  OSMetaClass *v142; // rax@152
  __int64 v143; // rax@152
  IO80211PeerManager *v144; // ST178_8@153
  OSMetaClass *v145; // rax@153
  __int64 v146; // rax@153
  __int64 v147; // rcx@153
  __int64 v148; // r8@153
  __int64 v149; // r9@153
  __int64 v150; // r9@155
  IO80211PeerManager *v151; // rdi@155
  signed __int64 v152; // rbx@155
  __int64 v153; // rcx@156
  __int64 v154; // rcx@158
  __int64 v155; // r8@158
  int v156; // eax@165
  OSMetaClass *v157; // rax@173
  __int64 v158; // rax@173
  __int64 v159; // rsi@173
  __int64 v160; // rbx@173
  OSMetaClass *v161; // rax@176
  __int64 v162; // rcx@176
  int v163; // eax@176
  unsigned int v164; // ebx@183
  IO80211PeerManager *v165; // r14@184
  OSMetaClass *v166; // rax@184
  __int64 v167; // rax@184
  char v168; // r15@184
  __int64 v169; // r9@184
  __int64 v170; // rbx@185
  char v171; // r14@185
  int v172; // eax@187
  int v173; // edx@187
  unsigned __int8 v174; // of@187
  int v175; // edx@187
  __int64 v176; // r14@195
  unsigned int v177; // ST178_4@195
  unsigned int v178; // ST170_4@195
  int v179; // ST168_4@195
  int v180; // ST154_4@195
  int v181; // ST150_4@195
  int v182; // ST140_4@195
  int v183; // ST138_4@195
  int v184; // ST130_4@195
  int v185; // ST128_4@195
  int v186; // ST120_4@195
  int v187; // ST110_4@195
  int v188; // ST108_4@195
  int v189; // ST100_4@195
  int v190; // STF8_4@195
  int v191; // STF0_4@195
  int v192; // STE8_4@195
  int v193; // STE0_4@195
  int v194; // STD8_4@195
  int v195; // STD0_4@195
  int v196; // er12@195
  int v197; // ebx@195
  int v198; // er13@195
  int v199; // STA8_4@195
  signed __int64 v200; // rsi@197
  int v201; // eax@199
  IO80211PeerManager *v202; // r14@210
  OSMetaClass *v203; // rax@210
  __int64 v204; // rax@210
  __int64 v205; // r9@210
  IO80211PeerManager *v206; // r14@96
  OSMetaClass *v207; // rax@96
  __int64 v208; // rax@96
  OSMetaClass *v209; // rax@211
  __int64 v210; // rax@211
  IO80211PeerManager *v211; // rbx@213
  OSMetaClass *v212; // rax@213
  __int64 v213; // rax@213
  IO80211PeerManager *v214; // rbx@218
  OSMetaClass *v215; // rax@218
  __int64 v216; // rax@218
  IO80211PeerManager *v217; // r14@225
  OSMetaClass *v218; // rax@225
  __int64 v219; // rcx@225
  char v220[8]; // r9@225
  unsigned __int64 v221; // rax@226
  __int64 v222; // ST08_8@228
  int v223; // ST00_4@228
  __int64 v224; // rax@230
  __int64 v226; // [sp+0h] [bp-240h]@0
  __int64 v227; // [sp+8h] [bp-238h]@0
  __int64 v228; // [sp+10h] [bp-230h]@0
  signed __int64 v229; // [sp+18h] [bp-228h]@0
  __int64 v230; // [sp+20h] [bp-220h]@0
  __int64 v231; // [sp+28h] [bp-218h]@0
  __int64 v232; // [sp+30h] [bp-210h]@0
  __int64 v233; // [sp+38h] [bp-208h]@0
  __int64 v234; // [sp+40h] [bp-200h]@0
  __int64 v235; // [sp+48h] [bp-1F8h]@0
  __int64 v236; // [sp+50h] [bp-1F0h]@0
  __int64 v237; // [sp+58h] [bp-1E8h]@0
  __int64 v238; // [sp+60h] [bp-1E0h]@0
  char *v239; // [sp+68h] [bp-1D8h]@0
  signed __int64 v240; // [sp+E0h] [bp-160h]@20
  __int64 v241; // [sp+E8h] [bp-158h]@20
  signed __int64 v242; // [sp+F0h] [bp-150h]@20
  void *v243; // [sp+F8h] [bp-148h]@20
  void *v244; // [sp+100h] [bp-140h]@20
  __int64 v245; // [sp+108h] [bp-138h]@40
  __int64 v246; // [sp+108h] [bp-138h]@70
  const void *v247; // [sp+110h] [bp-130h]@20
  __int64 v248; // [sp+120h] [bp-120h]@20
  IO80211PeerManager *v249; // [sp+128h] [bp-118h]@20
  unsigned int v250; // [sp+130h] [bp-110h]@20
  unsigned __int8 *v251; // [sp+138h] [bp-108h]@20
  __int64 v252; // [sp+140h] [bp-100h]@20
  char v253; // [sp+148h] [bp-F8h]@20
  unsigned int v254; // [sp+150h] [bp-F0h]@4
  unsigned int v255; // [sp+154h] [bp-ECh]@8
  unsigned int v256; // [sp+154h] [bp-ECh]@20
  unsigned int v257; // [sp+158h] [bp-E8h]@19
  __int64 v258; // [sp+160h] [bp-E0h]@1
  signed __int64 v259; // [sp+168h] [bp-D8h]@1
  unsigned __int16 v260; // [sp+170h] [bp-D0h]@1
  __int16 v261; // [sp+170h] [bp-D0h]@21
  IO80211PeerManager *v262; // [sp+178h] [bp-C8h]@1
  char v263; // [sp+178h] [bp-C8h]@138
  __int64 v264; // [sp+180h] [bp-C0h]@72
  int v265; // [sp+188h] [bp-B8h]@72
  unsigned __int8 v266; // [sp+18Eh] [bp-B2h]@57
  bool v267; // [sp+18Fh] [bp-B1h]@1
  char v268; // [sp+190h] [bp-B0h]@38
  char v269[4]; // [sp+1D0h] [bp-70h]@4
  char v270; // [sp+1D4h] [bp-6Ch]@135
  char v271; // [sp+1D5h] [bp-6Bh]@178
  char v272; // [sp+1D6h] [bp-6Ah]@25
  char v273; // [sp+1DCh] [bp-64h]@182
  char v274[32]; // [sp+1F0h] [bp-50h]@1
  __int64 v275; // [sp+210h] [bp-30h]@1

  v258 = a2;
  v2 = (__int64)a1;
  v275 = *(_QWORD *)off_7B078[0];
  v3 = *(IO80211PeerManager **)a2;
  v262 = *(IO80211PeerManager **)a2;
  v4 = *(_QWORD *)(a2 + 8);
  v267 = 0;
  bzero(v274, 0x20uLL);
  LODWORD(v5) = mbuf_data(v3);
  v6 = v5;
  LODWORD(v7) = mbuf_data(v3);
  v8 = v7;
  v259 = v7;
  v260 = mbuf_len(v3);
  v9 = *(_DWORD *)(v4 + 16);
  *((_BYTE *)a1 + 1622) = v9;
  if ( (unsigned __int8)v9 > 0xEu )
    ++*((_DWORD *)a1 + 467);
  else
    ++*((_DWORD *)a1 + 466);
  v254 = *(_DWORD *)(v6 + 8);
  v10 = *(_DWORD *)(v6 + 12);
  memset(v269, 0, 0x13uLL);
  if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)a1 + 5), 0x10000LL) )
  {
    v11 = (IO80211PeerManager *)*((_QWORD *)a1 + 5);
    LODWORD(v12) = mbuf_len(v262);
    LODWORD(v230) = *(_BYTE *)(v4 + 5);
    LODWORD(v229) = *(_BYTE *)(v4 + 4);
    LODWORD(v228) = *(_BYTE *)(v4 + 3);
    LODWORD(v227) = *(_BYTE *)(v4 + 2);
    LODWORD(v226) = *(_BYTE *)(v4 + 1);
    IO80211PeerManager::logDebug(
      v11,
      0x10000LL,
      ">AF len %lu RSSI %d [%02x:%02x:%02x:%02x:%02x:%02x]",
      v12,
      *(_DWORD *)(v4 + 44),
      *(_BYTE *)v4);
    if ( v254 | v10 )
      IO80211PeerManager::logDebug(*((IO80211PeerManager **)a1 + 5), 0x10000LL, "phy %5uus ", v254 - v10, v13, v14);
    if ( IO80211PeerManager::shouldVerboseLog(*((IO80211PeerManager **)a1 + 5), 0x10000LL) )
    {
      v255 = v10;
      v259 = v8;
      IO80211PeerManager::logDebug(*((IO80211PeerManager **)a1 + 5), 0x10000LL, "[", v15, v16, v17);
      LODWORD(v18) = mbuf_data(v262);
      v19 = v18;
      for ( i = 0; ; i = v21 + 1 )
      {
        v21 = i;
        LODWORD(v22) = mbuf_len(v262);
        v26 = v22 < 0xF;
        v27 = v22 == 15;
        v28 = 16LL;
        if ( v26 || v27 )
          LODWORD(v28) = mbuf_len(v262);
        v29 = *(IO80211PeerManager **)(v2 + 40);
        if ( v21 >= v28 )
          break;
        IO80211PeerManager::logDebug(v29, 0x10000LL, "%02X ", *(_BYTE *)(v19 + v21), v24, v25);
      }
      IO80211PeerManager::logDebug(v29, 0x10000LL, "]", v23, v24, v25);
      v10 = v255;
    }
    IO80211PeerManager::logDebug(*(IO80211PeerManager **)(v2 + 40), 0x10000LL, "\n", v15, v16, v17);
  }
  v30 = *(_DWORD *)(v4 + 44);
  if ( !*(_BYTE *)(v2 + 1279) )
  {
    v31 = *(_QWORD *)(v2 + 40);
    if ( v30 > *(_BYTE *)(v31 + 3766) || *(_DWORD *)(v31 + 3968) == 1 )
      *(_BYTE *)(v2 + 1279) = 1;
  }
  v32 = (unsigned int)(char)v30;
  IO80211Peer::reportRssi(v2, v30, *(_QWORD *)(v4 + 12), *(_DWORD *)(v4 + 20));
  v33 = v260;
  v257 = v260;
  if ( v260 < 0x11u )
  {
    v251 = 0LL;
    v256 = v10;
    v253 = 0;
    v248 = 0LL;
    v249 = 0LL;
    v252 = 0LL;
    v250 = 0;
LABEL_135:
    v132 = v256;
    if ( v270 )
    {
      v133 = *(_DWORD *)(v2 + 1880);
      v134 = 1;
      if ( v133 )
        v134 = v253;
      v263 = v134;
      *(_DWORD *)(v2 + 1880) = v133 + 1;
      *(_WORD *)(v2 + 1888) = *(_BYTE *)(v248 + 30);
      *(_QWORD *)(v2 + 1264) = getAbsoluteTime();
      v135 = *(_BYTE *)(v248 + 3);
      *(_BYTE *)(v2 + 1276) = v135;
      if ( v135 != *(_BYTE *)(v2 + 1286) )
      {
        *(_BYTE *)(v2 + 1277) = v135;
        ++*(_DWORD *)(v2 + 1280);
      }
      v136 = v256 != 0 && v254 != 0;
      v137 = 0;
      if ( (unsigned __int8)-(v256 < v254) & v136 )
        v137 = v254 - v256;
      *(_DWORD *)(v2 + 1256) = v137;
      *(_WORD *)(v2 + 1284) = *(_WORD *)(v248 + 4);
      *(_WORD *)(v2 + 1288) = *(_WORD *)(v248 + 8);
      *(_WORD *)(v2 + 1290) = *(_WORD *)(v248 + 10);
      *(_WORD *)(v2 + 1296) = *(_WORD *)(v248 + 16);
      *(_BYTE *)(v2 + 1622) = *(_BYTE *)(v248 + 3);
      v138 = *(_WORD *)(v248 + 18);
      if ( *(_WORD *)(v248 + 18) )
        *(_WORD *)(v2 + 1428) = v138;
      v32 = v248 + 24;
      memcpy((void *)(v2 + 1430), (const void *)(v248 + 24), 6uLL);
      *(_BYTE *)(v2 + 1673) = *(_BYTE *)(v248 + 20);
      *(_BYTE *)(v2 + 1674) = *(_BYTE *)(v248 + 21);
      *(_BYTE *)(v2 + 1675) = *(_BYTE *)(v248 + 22);
      *(_BYTE *)(v2 + 1676) = *(_BYTE *)(v248 + 23);
      if ( (_WORD)v138 )
      {
        if ( v136 )
          v138 += v256 - v254;
        v139 = v254;
        v140 = v252;
        if ( v138 <= 0 )
          *(_WORD *)(v2 + 1872) = 0;
        else
          *(_WORD *)(v2 + 1872) = v138;
        v132 = v256;
        goto LABEL_163;
      }
      v132 = v256;
    }
    else
    {
      v263 = v253;
    }
    v139 = v254;
    v140 = v252;
LABEL_163:
    if ( v272 && v140 )
    {
      v156 = *(_WORD *)(v140 + 4);
      if ( *(_WORD *)(v140 + 4) )
      {
        if ( v132 && v139 )
          v156 += v132 - v139;
        if ( v156 <= 0 )
          *(_WORD *)(v2 + 1872) = 0;
        else
          *(_WORD *)(v2 + 1872) = v156;
      }
      if ( *(_DWORD *)(*(_QWORD *)(v2 + 40) + 4024LL) >= 3u )
      {
        LODWORD(v157) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 56LL))(v2, v32);
        v158 = OSMetaClass::getClassName(v157);
        v159 = (__int64)"%s::%s SUI %u flags %x ssth ssth_present ssth_done : ";
        IO80211Peer::logDebug(
          (IO80211Peer *)v2,
          "%s::%s SUI %u flags %x ssth ssth_present ssth_done : ",
          v158,
          (__int64)"actionFrameReport",
          *(_WORD *)(v2 + 1678),
          *(_BYTE *)(v140 + 3));
        v160 = 0LL;
        do
        {
          if ( *(_BYTE *)(v2 + v160 + 1680) || v274[v160] )
          {
            LODWORD(v161) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v2 + 56LL))(v2, v159);
            v162 = OSMetaClass::getClassName(v161);
            v163 = (unsigned __int8)v274[v160];
            v159 = (__int64)"%s::%s (%u) %02x %02x%s";
            IO80211Peer::logDebug(
              (IO80211Peer *)v2,
              "%s::%s (%u) %02x %02x%s",
              v162,
              (__int64)"actionFrameReport",
              (unsigned int)v160,
              *(_BYTE *)(v2 + v160 + 1680));
          }
          ++v160;
        }
        while ( v160 != 32 );
      }
    }
    if ( v271 )
    {
      *(_DWORD *)(v2 + 1164) = *((_WORD *)v249 + 2);
      *(_DWORD *)(v2 + 1168) = *(_DWORD *)((char *)v249 + 18);
      *(_DWORD *)(v2 + 1172) = *(_DWORD *)((char *)v249 + 14);
      *(_BYTE *)(v2 + 1176) = *((_BYTE *)v249 + 6);
      memcpy((void *)(v2 + 1436), (char *)v249 + 8, 6uLL);
      *(_DWORD *)(v2 + 1448) = !memcmp((const void *)(v2 + 1436), (const void *)(*(_QWORD *)(v2 + 40) + 3692LL), 6uLL);
    }
    if ( v273 && (v164 = IO80211AWDLPeer::parseAwdlDataPathTLV((IO80211AWDLPeer *)v2, v251, v250, &v267, "AF")) != 0 )
    {
      v165 = *(IO80211PeerManager **)(v2 + 40);
      LODWORD(v166) = (*(int (__fastcall **)(__int64, unsigned __int8 *))(*(_QWORD *)v2 + 56LL))(v2, v251);
      v167 = OSMetaClass::getClassName(v166);
      v168 = 0;
      IO80211PeerManager::logDebug(
        v165,
        "%s::%s error parsing data path state %d\n",
        v167,
        (__int64)"actionFrameReport",
        v164,
        v169);
    }
    else
    {
      IO80211AWDLPeer::peerAwdlReachability((IO80211AWDLPeer *)v2);
      v170 = *(_QWORD *)(v2 + 160);
      v171 = 1;
      if ( v170 )
      {
        if ( (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v170)) >> 64) >> 18) < 0x3E8 )
        {
          v171 = v263;
        }
        else
        {
          v172 = (char)IO80211Peer::getRssi((IO80211Peer *)v2);
          v173 = *(_DWORD *)(v2 + 1088);
          v174 = __OFSUB__(v173, (char)v172);
          v175 = v173 - (char)v172;
          if ( (unsigned __int8)((v175 < 0) ^ v174) | (v175 == 0) || v175 <= 10 )
          {
            v171 = 1;
            if ( v172 <= *(_DWORD *)(v2 + 1088) || v172 - *(_DWORD *)(v2 + 1088) <= 10 )
              v171 = v263;
          }
        }
      }
      if ( *(_BYTE *)(v2 + 1278) & 2 && v171 & 1 )
      {
        if ( IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(v2 + 40), 0x10000000LL) )
        {
          v176 = *(_QWORD *)(v2 + 40);
          v177 = *(_BYTE *)(v2 + 32);
          v178 = *(_BYTE *)(v2 + 33);
          v179 = *(_BYTE *)(v2 + 34);
          v180 = *(_BYTE *)(v2 + 35);
          v181 = *(_BYTE *)(v2 + 36);
          v182 = *(_BYTE *)(v2 + 37);
          v183 = *(_DWORD *)(v176 + 3716);
          v184 = *(_BYTE *)(v176 + 112);
          v185 = *(_BYTE *)(v176 + 113);
          v186 = *(_BYTE *)(v176 + 114);
          v187 = *(_BYTE *)(v176 + 115);
          v188 = *(_BYTE *)(v176 + 116);
          v189 = *(_BYTE *)(v176 + 117);
          v190 = *(_DWORD *)(v2 + 1164);
          v191 = *(_BYTE *)(v2 + 1204);
          v192 = *(_BYTE *)(v2 + 1205);
          v193 = *(_BYTE *)(v2 + 1206);
          v194 = *(_BYTE *)(v2 + 1207);
          v195 = *(_BYTE *)(v2 + 1208);
          v196 = *(_BYTE *)(v2 + 1209);
          v197 = *(_WORD *)(v2 + 1678);
          v198 = *(_BYTE *)(v2 + 1278);
          v199 = (char)IO80211Peer::getRssi((IO80211Peer *)v2);
          IO80211PeerManager::logDebug(
            (IO80211PeerManager *)v176,
            0x10000000LL,
            "<%s> Peer Presence: [%02X:%02X:%02X:%02X:%02X:%02X] %s my: eid %x BSSID [%02X:%02X:%02X:%02X:%02X:%02X] peer: eid %x BSSID [%02X:%02X:%02X:%02X:%02X:%02X] SUI %u reach %u RSSI %d\n",
            v2 + 1728,
            v177,
            v178);
        }
        memset((void *)(v258 + 40), 0, 0x30uLL);
        *(_WORD *)(v258 + 42) = *(_WORD *)(v2 + 1678);
        *(_WORD *)(v258 + 40) = 1;
        memcpy((void *)(v258 + 44), (const void *)(v2 + 1680), 0x20uLL);
        if ( !memcmp(&null_address, (const void *)(v2 + 1436), 6uLL) )
          v200 = v2 + 1430;
        else
          v200 = v2 + 1436;
        memcpy((void *)(v258 + 76), (const void *)v200, 6uLL);
        *(_QWORD *)(v2 + 160) = getAbsoluteTime();
        v201 = (char)IO80211Peer::getRssi((IO80211Peer *)v2);
        *(_DWORD *)(v2 + 1088) = (char)v201;
        *(_DWORD *)(v258 + 36) = (char)v201;
        *(_BYTE *)(v258 + 33) = 1;
      }
      if ( v253 & 1 )
        *(_BYTE *)(v258 + 34) = 1;
      v168 = 1;
      if ( v267 )
        *(_BYTE *)(v258 + 32) = 1;
    }
    goto LABEL_230;
  }
  v256 = v10;
  v247 = (const void *)(v2 + 1436);
  v243 = (void *)(v2 + 1442);
  v244 = (void *)(v2 + 1680);
  v242 = v2 + 1728;
  v241 = v2 + 32;
  v240 = v8 + 5;
  v34 = 16;
  v253 = 0;
  v248 = 0LL;
  v249 = 0LL;
  v252 = 0LL;
  v251 = 0LL;
  v250 = 0;
  while ( 2 )
  {
    if ( v33 < v34 + 3 )
      goto LABEL_160;
    v261 = v34 + 3;
    v35 = v2;
    v36 = (unsigned int)v34;
    v37 = v8 + (unsigned int)v34;
    v38 = *(_WORD *)(v8 + (unsigned int)v34 + 1);
    if ( v33 - v34 < (signed int)v38 + 3 )
    {
      v141 = v35;
      LODWORD(v142) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v35 + 56LL))(v35, v32);
      v143 = OSMetaClass::getClassName(v142);
      IO80211Peer::logDebug(
        (IO80211Peer *)v141,
        "%s::%s   ERROR: tlv %u len %u - totLength %u offset %u\n",
        v143,
        (__int64)"actionFrameReport",
        *(_BYTE *)v37,
        (unsigned int)v38);
      if ( IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(v141 + 40), 0x10000LL) )
      {
        v144 = *(IO80211PeerManager **)(v141 + 40);
        LODWORD(v145) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v141 + 56LL))(v141, 0x10000LL);
        v146 = OSMetaClass::getClassName(v145);
        IO80211PeerManager::logDebug(
          v144,
          0x10000LL,
          "%s::%s   Error: tlv %u len %u - totLength %u offset %u\n",
          v146,
          (__int64)"actionFrameReport",
          *(_BYTE *)v37);
        if ( (unsigned int)v34 >= 0x20 )
          v259 = (unsigned int)v34 + v259 - 32;
        IO80211PeerManager::logDebug(*(IO80211PeerManager **)(v141 + 40), 0x10000LL, "[", v147, v148, v149);
        v151 = *(IO80211PeerManager **)(v141 + 40);
        v152 = -48LL;
        do
        {
          v153 = (__int64)" ";
          if ( (_DWORD)v152 == -16 )
            v153 = (__int64)" . ";
          IO80211PeerManager::logDebug(v151, 0x10000LL, "%s%02X", v153, *(_BYTE *)(v259 + v152 + 48), v150);
          v151 = *(IO80211PeerManager **)(v141 + 40);
          ++v152;
        }
        while ( v152 );
        IO80211PeerManager::logDebug(v151, 0x10000LL, "]\n", v154, v155, v150);
      }
LABEL_160:
      *(_DWORD *)(v258 + 20) = 1;
LABEL_229:
      v168 = 0;
      goto LABEL_230;
    }
    v39 = v35;
    v40 = IO80211AWDLPeer::tlvCheckBounds(v35, v37, v38, *(_BYTE *)v37, (__int64)"actionFrameReport");
    *(_DWORD *)(v258 + 20) = v40;
    if ( v40 )
      goto LABEL_224;
    v32 = v37;
    IO80211AWDLPeer::printTlv(v39, v37);
    v43 = *(_BYTE *)v37;
    v44 = (unsigned int)*(_BYTE *)v37 - 1;
    v45 = v36;
    v2 = v39;
    switch ( *(_BYTE *)v37 )
    {
      case 1:
        ++*(_DWORD *)(v258 + 92);
        goto LABEL_125;
      case 2:
        if ( v272 )
        {
          v46 = v45;
          if ( *(_DWORD *)(*(_QWORD *)(v2 + 40) + 3784LL) )
          {
            ++*(_DWORD *)(v258 + 88);
            v32 = v37;
            IO80211AWDLPeer::handleServiceResponseTLV(
              (IO80211AWDLPeer *)v2,
              (unsigned __int8 *)v37,
              v38 + 3,
              v44,
              v41,
              v42);
          }
          goto LABEL_98;
        }
        *(_DWORD *)(v258 + 20) = 10;
        *(_QWORD *)(v258 + 24) = "ServiceResp-no-ServiceParam";
        goto LABEL_216;
      case 4:
        if ( !v37 )
          goto LABEL_31;
        v47 = (unsigned __int8)v269[v43];
        if ( v47 >= 2 )
          goto LABEL_206;
        v269[v43] = v47 + 1;
LABEL_31:
        v46 = v45;
        *(_WORD *)(v2 + 1888) = *(_BYTE *)(v45 + v259 + 30);
        v48 = IO80211AWDLPeer::parseAwdlChanSeqFromSyncParamsTLV((IO80211AWDLPeer *)v2, v37);
        v49 = *(IO80211PeerManager **)(v2 + 40);
        if ( v48 )
        {
          LODWORD(v209) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v2 + 56LL))(v2, v37);
          v210 = OSMetaClass::getClassName(v209);
          v168 = 0;
          IO80211PeerManager::logDebug(
            v49,
            0x10000LL,
            "%s::%s   Error: parsing ch sequence %d\n",
            v210,
            (__int64)"actionFrameReport",
            v48);
          *(_DWORD *)(v258 + 20) = 4;
          goto LABEL_230;
        }
        v32 = 0x10000LL;
        if ( IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(v2 + 40), 0x10000LL) )
        {
          LODWORD(v232) = *(_BYTE *)(v259 + v46 + 30);
          LODWORD(v231) = *(_BYTE *)(v259 + v46 + 6);
          LODWORD(v230) = *(_BYTE *)(v259 + v46 + 3);
          LODWORD(v229) = *(_WORD *)(v259 + v46 + 18);
          LODWORD(v228) = *(_WORD *)(v259 + v46 + 4);
          LODWORD(v227) = *(_BYTE *)(v259 + v46 + 22);
          LODWORD(v226) = *(_BYTE *)(v259 + v46 + 21);
          v32 = 0x10000LL;
          IO80211PeerManager::logDebug(
            *(IO80211PeerManager **)(v2 + 40),
            0x10000LL,
            "   sn=%u ext(%u/%u/%u/%u) dc=%u rem=%u tchan=%u mchan=%u pm=%u\n",
            *(_WORD *)(v259 + v46 + 32),
            *(_BYTE *)(v259 + v46 + 20),
            *(_BYTE *)(v259 + v46 + 23));
          v45 = v46;
          v248 = v37;
          goto LABEL_125;
        }
        v248 = v37;
        goto LABEL_98;
      case 5:
        if ( !v37 )
          goto LABEL_37;
        v50 = (unsigned __int8)v269[v43];
        if ( v50 >= 2 )
          goto LABEL_206;
        v269[v43] = v50 + 1;
LABEL_37:
        v51 = v45;
        if ( !memcmp(v247, (const void *)(v45 + v259 + 8), 6uLL) )
        {
          v53 = &v268;
          snprintf(
            &v268,
            0x32uLL,
            "remained the same",
            v226,
            v227,
            v228,
            v229,
            v230,
            v231,
            v232,
            v233,
            v234,
            v235,
            v236,
            v237,
            v238,
            v239);
          v52 = v39;
        }
        else
        {
          v52 = v39;
          LODWORD(v228) = *(_BYTE *)(v39 + 1441);
          LODWORD(v227) = *(_BYTE *)(v39 + 1440);
          LODWORD(v226) = *(_BYTE *)(v39 + 1439);
          v53 = &v268;
          snprintf(
            &v268,
            0x32uLL,
            "changed from %02X:%02X:%02X:%02X:%02X:%02X",
            *(_BYTE *)(v39 + 1436),
            *(_BYTE *)(v39 + 1437),
            *(_BYTE *)(v39 + 1438),
            v226,
            v227,
            v228,
            v229,
            v230,
            v231,
            v232,
            v233,
            v234,
            v235,
            v236,
            v237,
            v238,
            v239);
        }
        v239 = v53;
        LODWORD(v238) = *(_BYTE *)(v259 + v51 + 13);
        LODWORD(v237) = *(_BYTE *)(v259 + v51 + 12);
        LODWORD(v236) = *(_BYTE *)(v259 + v51 + 11);
        LODWORD(v235) = *(_BYTE *)(v259 + v51 + 10);
        LODWORD(v234) = *(_BYTE *)(v259 + v51 + 9);
        LODWORD(v233) = *(_BYTE *)(v259 + v51 + 8);
        LODWORD(v232) = *(_DWORD *)(v259 + v51 + 14);
        LODWORD(v231) = *(_BYTE *)(v259 + v51 + 6);
        LODWORD(v230) = *(_DWORD *)(v259 + v51 + 18);
        LODWORD(v229) = *(_WORD *)(v259 + v51 + 4);
        LODWORD(v228) = *(_BYTE *)(v52 + 37);
        LODWORD(v227) = *(_BYTE *)(v52 + 36);
        LODWORD(v226) = *(_BYTE *)(v52 + 35);
        v32 = 98304LL;
        IO80211PeerManager::logDebug(
          *(IO80211PeerManager **)(v52 + 40),
          98304LL,
          "  Peer%02X:%02X:%02X:%02X:%02X:%02X election_id %u self_metric 0x%x dist %u TM metric 0x%x TM %02X:%02X:%02X:%02X:%02X:%02X %s \n",
          *(_BYTE *)(v52 + 32),
          *(_BYTE *)(v52 + 33),
          *(_BYTE *)(v52 + 34));
        v45 = v51;
        if ( *(_BYTE *)(v259 + v51 + 3) & 1 )
        {
          v116 = *(_DWORD *)(v51 + v259 + 34);
          *(_DWORD *)(v52 + 1180) = v116;
          LODWORD(v231) = *(_BYTE *)(v51 + v259 + 29);
          LODWORD(v230) = *(_BYTE *)(v51 + v259 + 28);
          LODWORD(v229) = *(_BYTE *)(v51 + v259 + 27);
          LODWORD(v228) = *(_BYTE *)(v51 + v259 + 26);
          LODWORD(v227) = *(_BYTE *)(v51 + v259 + 25);
          LODWORD(v226) = *(_BYTE *)(v51 + v259 + 24);
          IO80211PeerManager::logDebug(
            *(IO80211PeerManager **)(v52 + 40),
            0x10000LL,
            "_private eid %d  metric 0x%x dist %u priv top master %02X:%02X:%02X:%02X:%02X:%02X \n",
            v116,
            *(_DWORD *)(v51 + v259 + 30),
            *(_BYTE *)(v51 + v259 + 38));
          if ( *(_BYTE *)(v52 + 522) )
          {
            v117 = *(_QWORD *)(v52 + 40);
            if ( *(_BYTE *)(v117 + 3720) & 1 )
            {
              v118 = *(_DWORD *)(v52 + 1180);
              if ( (unsigned int)v118 > *(_DWORD *)(v117 + 3736) )
              {
                *(_DWORD *)(v117 + 3736) = v118;
                *(_BYTE *)(v117 + 3746) = 1;
                IO80211PeerManager::logDebug(
                  (IO80211PeerManager *)v117,
                  0x10000LL,
                  "Updating Priv Eid to %u from peer %X:%X \n",
                  v118,
                  *(_BYTE *)(v52 + 36),
                  *(_BYTE *)(v52 + 37));
              }
            }
          }
          v32 = v51 + v259 + 24;
          memcpy(v243, (const void *)v32, 6uLL);
          v45 = v51;
          *(_BYTE *)(v52 + 1177) = *(_BYTE *)(v259 + v51 + 38);
        }
        else
        {
          *(_DWORD *)(v52 + 1180) = 0;
        }
        v249 = (IO80211PeerManager *)v37;
        v2 = v52;
        goto LABEL_125;
      case 6:
        v54 = *(_QWORD *)(v39 + 40);
        if ( !*(_DWORD *)(v54 + 3784) )
          goto LABEL_125;
        v245 = v45;
        if ( !v37 )
          goto LABEL_43;
        v55 = (unsigned __int8)v269[v43];
        if ( v55 < 2 )
        {
          v269[v43] = v55 + 1;
LABEL_43:
          if ( IO80211PeerManager::shouldLog((IO80211PeerManager *)v54, 0x10000LL) )
          {
            v57 = v259;
            v58 = (__int64 *)(v245 + v259 + 6);
            IO80211PeerManager::logDebug(
              *(IO80211PeerManager **)(v39 + 40),
              0x10000LL,
              "   service params SUI %u was %u\n",
              *(_WORD *)v58,
              *(_WORD *)(v39 + 1678),
              v56);
          }
          else
          {
            v57 = v259;
            v58 = (__int64 *)(v245 + v259 + 6);
          }
          if ( *(_WORD *)(v39 + 1678) != *(_WORD *)v58 )
          {
            LODWORD(v231) = *(_WORD *)v58;
            LODWORD(v230) = *(_WORD *)(v39 + 1678);
            v229 = v242;
            LODWORD(v228) = *(_BYTE *)(v39 + 37);
            LODWORD(v227) = *(_BYTE *)(v39 + 36);
            LODWORD(v226) = *(_BYTE *)(v39 + 35);
            IO80211Peer::logDebug(
              (IO80211Peer *)v39,
              268500992LL,
              "[%02x:%02x:%02x:%02x:%02x:%02x] %s SUI change %u -> %u\n",
              *(_BYTE *)(v39 + 32),
              *(_BYTE *)(v39 + 33),
              *(_BYTE *)(v39 + 34));
            *(_WORD *)(v39 + 1678) = *(_WORD *)v58;
            v122 = *(_QWORD *)(v39 + 1416);
            if ( v122 )
            {
              kfree(v122, *(_DWORD *)(v39 + 1424));
              *(_QWORD *)(v39 + 1416) = 0LL;
              *(_DWORD *)(v39 + 1424) = 0;
            }
            *(_BYTE *)(v39 + 1760) = 0;
            *(_BYTE *)(v39 + 1728) = 0;
            v253 = 1;
          }
          bzero(v244, 0x20uLL);
          v123 = v38 - 5;
          v2 = v245;
          v124 = 0LL;
          v125 = 0;
          while ( 1 )
          {
            v32 = *(_DWORD *)(v57 + v245 + 8);
            if ( _bittest((const unsigned int *)&v32, v124) )
            {
              if ( !v123 )
              {
                *(_QWORD *)(v258 + 24) = "serviceParam Bad ssth length";
                if ( v258 )
                  goto LABEL_223;
                goto LABEL_224;
              }
              v32 = v39;
              *(_BYTE *)(v39 + v124 + 1680) = *(_BYTE *)(v57 + v245 + 12 + v125);
              --v123;
              ++v125;
            }
            ++v124;
            if ( (signed int)v124 >= 32 )
            {
              v259 = v57;
              if ( !*(_QWORD *)(v39 + 1416) )
                IO80211AWDLPeer::makeBrowseList((IO80211AWDLPeer *)v39);
              v252 = v37;
LABEL_124:
              v45 = v2;
              v2 = v39;
              goto LABEL_125;
            }
          }
        }
        *(_QWORD *)(v258 + 24) = "multiple";
        if ( !v258 )
          goto LABEL_224;
        goto LABEL_223;
      case 7:
        if ( !v37 )
          goto LABEL_48;
        v59 = (unsigned __int8)v269[v43];
        if ( v59 >= 2 )
          goto LABEL_206;
        v269[v43] = v59 + 1;
LABEL_48:
        if ( (unsigned int)v38 >= 0x1F )
        {
          if ( IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(v39 + 40), 0x10000LL) )
          {
            v211 = *(IO80211PeerManager **)(v39 + 40);
            LODWORD(v212) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 56LL))(v2, 0x10000LL);
            v213 = OSMetaClass::getClassName(v212);
            IO80211PeerManager::logDebug(
              v211,
              0x10000LL,
              "%s::%s wrong ht cap len %u \n",
              v213,
              (__int64)"actionFrameReport",
              (unsigned int)v38);
          }
          *(_DWORD *)(v258 + 20) = 5;
        }
        else
        {
          if ( (unsigned int)v38 > 2 )
          {
            v46 = v45;
            v60 = IO80211Peer::parseHTCapTLV(
                    (IO80211Peer *)v2,
                    (unsigned __int8 *)(v45 + v259 + 5),
                    (signed int)v38 - 2);
            v61 = *(_QWORD *)(v2 + 40);
            if ( v60 > 0 && *(_DWORD *)(v61 + 756) )
              *(_BYTE *)(v2 + 476) = 1;
            LODWORD(v62) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v2 + 56LL))(v2);
            v63 = OSMetaClass::getClassName(v62);
            v32 = 327680LL;
            IO80211PeerManager::logDebug(
              (IO80211PeerManager *)v61,
              327680LL,
              "%s::%s Master Indication received\n",
              v63,
              (__int64)"actionFrameReport",
              v64);
            goto LABEL_98;
          }
          if ( IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(v39 + 40), 0x10000LL) )
          {
            v214 = *(IO80211PeerManager **)(v39 + 40);
            LODWORD(v215) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 56LL))(v2, 0x10000LL);
            v216 = OSMetaClass::getClassName(v215);
            IO80211PeerManager::logDebug(
              v214,
              0x10000LL,
              "%s::%s wrong ht cap len %u \n",
              v216,
              (__int64)"actionFrameReport",
              (unsigned int)v38);
          }
          *(_DWORD *)(v258 + 20) = 6;
        }
        goto LABEL_229;
      case 0xA:
        v65 = v39;
        if ( !v37 )
          goto LABEL_57;
        v66 = (unsigned __int8)v269[v43];
        if ( v66 < 2 )
        {
          v269[v43] = v66 + 1;
LABEL_57:
          v266 = 0;
          v67 = (unsigned __int8 *)(v45 + v259 + 3);
          v2 = v45;
          v72 = IO80211AWDLPeer::parseAwdlInviteTLV((IO80211AWDLPeer *)v39, v67, v38, &v266);
          v73 = *(IO80211PeerManager **)(v39 + 40);
          if ( (v72 & 0x80000000) != 0 )
          {
            LODWORD(v119) = (*(int (__cdecl **)(__int64, unsigned __int8 *, __int64, __int64, __int64, __int64, __int64, __int64, __int64, signed __int64, __int64, __int64, __int64, __int64))(*(_QWORD *)v39 + 56LL))(
                              v39,
                              v67,
                              v68,
                              v69,
                              v70,
                              v71,
                              v226,
                              v227,
                              v228,
                              v229,
                              v230,
                              v231,
                              v232,
                              v233);
            v120 = OSMetaClass::getClassName(v119);
            v32 = (signed __int64)"%s::%s error parsing invite TLV %d\n";
            IO80211PeerManager::logDebug(
              v73,
              "%s::%s error parsing invite TLV %d\n",
              v120,
              (__int64)"actionFrameReport",
              v72,
              v121);
            goto LABEL_124;
          }
          v32 = 8590000128LL;
          v74 = IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(v39 + 40), 8590000128LL);
          v75 = v266;
          if ( v74 && v266 <= 6u )
          {
            v76 = *(IO80211PeerManager **)(v65 + 40);
            LODWORD(v77) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v65 + 56LL))(v65, 8590000128LL);
            v78 = OSMetaClass::getClassName(v77);
            v32 = 8590000128LL;
            IO80211PeerManager::logDebug(
              v76,
              8590000128LL,
              "%s::%s got INVITE_TLV opcode %s\n",
              v78,
              (__int64)"actionFrameReport",
              (__int64)stringFromOpcode[v75]);
          }
          v45 = v2;
          v2 = v65;
LABEL_125:
          v8 = v259;
          v34 = (unsigned __int16)(*(_WORD *)(v45 + v259 + 1) + v261);
          v33 = v257;
          if ( v257 <= v34 )
            goto LABEL_135;
          continue;
        }
        *(_QWORD *)(v258 + 24) = "multiple";
        if ( v258 )
LABEL_223:
          *(_DWORD *)(v258 + 20) = 1;
LABEL_224:
        ++*(_DWORD *)(v39 + 1884);
        *(_BYTE *)(v258 + 33) = 0;
        if ( !IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(v39 + 40), 0x10000LL) )
          goto LABEL_229;
        v217 = *(IO80211PeerManager **)(v39 + 40);
        LODWORD(v218) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v39 + 56LL))(v39, 0x10000LL);
        v219 = OSMetaClass::getClassName(v218);
        *(_QWORD *)v220 = "UNKNOWN";
        if ( v37 )
        {
          v221 = *(_BYTE *)v37;
          if ( v221 <= 0x12 )
            *(_QWORD *)v220 = off_7CD20[v221];
        }
        v222 = *(_QWORD *)(v258 + 24);
        v223 = *(_DWORD *)(v258 + 20);
        v168 = 0;
        IO80211PeerManager::logDebug(
          v217,
          0x10000LL,
          "%s::%s error parsing %s reason (%u) %s\n",
          v219,
          (__int64)"actionFrameReport",
          *(__int64 *)v220);
LABEL_230:
        v224 = *(_QWORD *)off_7B078[0];
        if ( *(_QWORD *)off_7B078[0] == v275 )
          LOBYTE(v224) = v168;
        return v224;
      case 0xB:
        v79 = v45 + v259 + 3;
        v80 = v38;
        v2 = v45;
        v81 = strnlen((const char *)v79, v38);
        if ( v81 < (unsigned int)v38 )
        {
          *(_BYTE *)(v259 + v2 + v81 + 3) = 0;
          v82 = *(IO80211PeerManager **)(v39 + 40);
          LODWORD(v83) = (*(int (__fastcall **)(__int64, size_t))(*(_QWORD *)v39 + 56LL))(v39, v80);
          v84 = OSMetaClass::getClassName(v83);
          v32 = (signed __int64)"%s::%s Got Dbg String: <%s>\n";
          IO80211PeerManager::logDebug(
            v82,
            "%s::%s Got Dbg String: <%s>\n",
            v84,
            (__int64)"actionFrameReport",
            v79,
            v85);
          goto LABEL_124;
        }
        if ( !IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(v39 + 40), 0x10000LL) )
          goto LABEL_229;
        v202 = *(IO80211PeerManager **)(v39 + 40);
        LODWORD(v203) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v39 + 56LL))(v39, 0x10000LL);
        v204 = OSMetaClass::getClassName(v203);
        v205 = *(_WORD *)(v2 + v259 + 1);
        v168 = 0;
        IO80211PeerManager::logDebug(
          v202,
          0x10000LL,
          "%s::%s dbg string tlv too long %u\n",
          v204,
          (__int64)"actionFrameReport",
          v205);
        goto LABEL_230;
      case 0xC:
        v32 = v259;
        if ( !v37 )
          goto LABEL_67;
        v86 = (unsigned __int8)v269[v43];
        if ( v86 < 2 )
        {
          v269[v43] = v86 + 1;
LABEL_67:
          v251 = (unsigned __int8 *)(v45 + v259 + 3);
          v250 = v38;
          goto LABEL_125;
        }
LABEL_206:
        *(_QWORD *)(v258 + 24) = "multiple";
        if ( !v258 )
          goto LABEL_224;
        goto LABEL_223;
      case 0xD:
        v87 = v45;
        LODWORD(v88) = mbuf_data(v262);
        v89 = v88;
        v90 = v39;
        if ( IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(v39 + 40), 8590000128LL) )
        {
          v91 = *(IO80211PeerManager **)(v39 + 40);
          LODWORD(v92) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v39 + 56LL))(v39, 8590000128LL);
          v93 = OSMetaClass::getClassName(v92);
          LODWORD(v230) = *(_BYTE *)(v89 + 5);
          LODWORD(v229) = *(_BYTE *)(v89 + 4);
          LODWORD(v228) = *(_BYTE *)(v89 + 3);
          LODWORD(v227) = *(_BYTE *)(v89 + 2);
          LODWORD(v226) = *(_BYTE *)(v89 + 1);
          IO80211PeerManager::logDebug(
            v91,
            8590000128LL,
            "%s::%s got AWDL_ENCAPSULATED_IP_TLV to %02X:%02X:%02X:%02X:%02X:%02X\n",
            v93,
            (__int64)"actionFrameReport",
            *(_BYTE *)v89);
        }
        v246 = v87;
        v94 = (const void *)(v87 + v259 + 3);
        v2 = v90;
        if ( *(_BYTE *)v94 & 1 || (v32 = *(_QWORD *)(v90 + 40) + 3680LL, !memcpy((void *)v94, (const void *)v32, 6uLL)) )
        {
          v265 = 1;
          v264 = 0LL;
          v95 = v38;
          v96 = mbuf_allocpacket(0LL, v38, &v265, &v264);
          if ( v96 || !v264 )
          {
            v113 = *(IO80211PeerManager **)(v90 + 40);
            LODWORD(v114) = (*(int (__fastcall **)(__int64, size_t))(*(_QWORD *)v90 + 56LL))(v90, v95);
            v115 = OSMetaClass::getClassName(v114);
            v32 = (signed __int64)"%s::%s cannot allocate mbuf size %u err %d\n";
            IO80211PeerManager::logDebug(
              v113,
              "%s::%s cannot allocate mbuf size %u err %d\n",
              v115,
              (__int64)"actionFrameReport",
              512LL,
              (unsigned int)v96);
          }
          else
          {
            LODWORD(v97) = mbuf_data(v264);
            memcpy(v97, v94, v38);
            v32 = v38;
            mbuf_setlen(v264, v38);
            *(_QWORD *)(v258 + 96) = v264;
          }
        }
        v45 = v246;
        goto LABEL_125;
      case 0x10:
        v46 = v45;
        v32 = 0x10000LL;
        if ( IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(v2 + 40), 0x10000LL) )
        {
          v98 = *(IO80211PeerManager **)(v2 + 40);
          LODWORD(v99) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 56LL))(v2, 0x10000LL);
          v100 = OSMetaClass::getClassName(v99);
          LODWORD(v234) = *(_BYTE *)(v46 + v259 + 12);
          LODWORD(v233) = *(_BYTE *)(v46 + v259 + 11);
          LODWORD(v232) = *(_BYTE *)(v46 + v259 + 10);
          LODWORD(v231) = *(_BYTE *)(v46 + v259 + 9);
          LODWORD(v230) = *(_BYTE *)(v46 + v259 + 8);
          LODWORD(v229) = *(_BYTE *)(v46 + v259 + 7);
          LODWORD(v228) = *(_BYTE *)(v46 + v259 + 6);
          LODWORD(v227) = *(_BYTE *)(v46 + v259 + 5);
          LODWORD(v226) = *(_BYTE *)(v46 + v259 + 4);
          v32 = 0x10000LL;
          IO80211PeerManager::logDebug(
            v98,
            0x10000LL,
            "%s::%s got AWDL_ARPA_TLV _ip6_arpa_done %u len %u %c%c%c%c%c%c%c%c\n",
            v100,
            (__int64)"actionFrameReport",
            *(_BYTE *)(v2 + 1760));
        }
        v101 = *(_QWORD *)(v2 + 40);
        if ( !*(_DWORD *)(v101 + 3784) )
          goto LABEL_98;
        v45 = v46;
        if ( (unsigned int)*(_BYTE *)(v2 + 1760) > 3 || !*(_QWORD *)(v101 + 3800) )
          goto LABEL_125;
        v102 = OSObject::operator new((OSObject *)stru_68.segname, 0x10000uLL);
        IO80211ServiceRequestDescriptor::IO80211ServiceRequestDescriptor(v102);
        if ( v102 && IO80211ServiceRequestDescriptor::initWithArpaTLV(v102, v37, v241, 0LL, v103, v104) )
        {
          ++*(_DWORD *)(v258 + 88);
          *(_BYTE *)(v102 + 12) = 0;
          if ( IO80211CommandQueue::lockEnqueue(
                 *(IO80211CommandQueue **)(*(_QWORD *)(v2 + 40) + 3800LL),
                 (IO80211QueueDescriptor *)v102) )
          {
            ++*(_BYTE *)(v2 + 1760);
            v105 = v240 + v46;
            v106 = 0LL;
            do
            {
              if ( (unsigned __int8)(*(_BYTE *)(v105 + v106) - 32) > 0x9Fu )
                break;
              *(_BYTE *)(v2 + v106 + 1728) = *(_BYTE *)(v105 + v106);
              ++v106;
            }
            while ( (unsigned int)v106 < 0x1F );
            v32 = 0x10000LL;
            if ( IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(v2 + 40), 0x10000LL) )
            {
              LODWORD(v107) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 56LL))(v2, 0x10000LL);
              v108 = OSMetaClass::getClassName(v107);
              v32 = (signed __int64)"%s::%s did enqueue .ip6.arpa service descriptor size %u name_len %u\n";
              IO80211Peer::logDebug(
                (IO80211Peer *)v2,
                "%s::%s did enqueue .ip6.arpa service descriptor size %u name_len %u\n",
                v108,
                (__int64)"actionFrameReport",
                *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(v2 + 40) + 3800LL) + 52LL),
                (unsigned int)v106);
            }
            *(_BYTE *)(v2 + (unsigned int)v106 + 1728) = 0;
          }
          else
          {
            (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v102 + 288LL))(v102, v102);
            (*(void (__fastcall **)(__int64))(*(_QWORD *)v102 + 40LL))(v102);
            LODWORD(v129) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v2 + 56LL))(v2);
            v130 = OSMetaClass::getClassName(v129);
            v32 = (signed __int64)"%s::%s can't enqueue .ip6.arpa service descriptor size %u\n";
            IO80211Peer::logDebug(
              (IO80211Peer *)v2,
              "%s::%s can't enqueue .ip6.arpa service descriptor size %u\n",
              v130,
              (__int64)"actionFrameReport",
              *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(v2 + 40) + 3800LL) + 52LL),
              v131);
          }
        }
        else
        {
          v32 = 8590000128LL;
          if ( IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(v2 + 40), 8590000128LL) )
          {
            LODWORD(v126) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 56LL))(v2, 8590000128LL);
            v127 = OSMetaClass::getClassName(v126);
            v32 = (signed __int64)"%s::%s can't build ARPA service descriptor srv=%p\n";
            IO80211Peer::logDebug(
              (IO80211Peer *)v2,
              "%s::%s can't build ARPA service descriptor srv=%p\n",
              v127,
              (__int64)"actionFrameReport",
              v102,
              v128);
          }
          if ( v102 )
            (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v102 + 40LL))(v102, v32);
        }
        goto LABEL_98;
      case 0x11:
        v32 = v259;
        if ( *(_BYTE *)(v45 + v259 + 3) != 191 )
          goto LABEL_125;
        v109 = -191;
        if ( *(_BYTE *)(v45 + v259 + 4) == 12 )
        {
          v32 = v45 + v259 + 3;
          v46 = v45;
          v109 = IO80211Peer::parseVhtCapTLV((IO80211Peer *)v2, (void *)v32);
          if ( v109 >= 0 )
          {
            if ( v109 )
            {
              v45 = v46;
              if ( *(_DWORD *)(*(_QWORD *)(v2 + 40) + 756LL) )
                *(_BYTE *)(v2 + 476) = 1;
              goto LABEL_125;
            }
LABEL_98:
            v45 = v46;
            goto LABEL_125;
          }
        }
        *(_DWORD *)(v258 + 20) = -v109;
LABEL_216:
        v39 = v2;
        goto LABEL_224;
      case 0x12:
        v110 = (IO80211AWDLPeer *)v39;
        v32 = v37;
        v111 = v45;
        v112 = IO80211AWDLPeer::parseAwdlChanSeqFromChanSeqTLV(v110, v37);
        v45 = v111;
        if ( !v112 )
          goto LABEL_125;
        v206 = *(IO80211PeerManager **)(v2 + 40);
        LODWORD(v207) = (*(int (__fastcall **)(__int64, __int64, __int64))(*(_QWORD *)v2 + 56LL))(v2, v37, v111);
        v208 = OSMetaClass::getClassName(v207);
        IO80211PeerManager::logDebug(
          v206,
          0x10000LL,
          "%s::%s   Error: parsing ch sequence from %d, error: %d\n",
          v208,
          (__int64)"actionFrameReport",
          18LL);
        *(_DWORD *)(v258 + 20) = 18;
        goto LABEL_216;
      case 3:
      case 8:
      case 9:
      case 0xE:
      case 0xF:
        goto LABEL_125;
      default:
        goto LABEL_124;
    }
  }
}
// 68: using guessed type section_64 stru_68;
// 77FDC: using guessed type int null_address;
// 7B078: using guessed type __int64 off_7B078[7];
// 7CD20: using guessed type char *off_7CD20[19];
// 84170: using guessed type char *stringFromOpcode[7];
// C8BC8: using guessed type int __fastcall kfree(_QWORD, _QWORD);
// C8BE8: using guessed type int __fastcall mbuf_allocpacket(_QWORD, _QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8CB0: using guessed type int __fastcall mbuf_setlen(_QWORD, _QWORD);
// 1CB34: using guessed type char var_50[32];
// 1CB34: using guessed type char var_70[4];

//----- (000000000001E8AC) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::parseAwdlChanSeqFromSyncParamsTLV(IO80211AWDLPeer *a1, __int64 a2)
{
  __int64 v2; // rbx@1
  IO80211AWDLPeer *v3; // r14@1
  __int64 v4; // r15@1
  unsigned __int8 v5; // cl@1
  __int64 result; // rax@1
  unsigned int v7; // edx@2
  unsigned int v8; // eax@3
  signed int v9; // ecx@3
  __int16 v10; // dx@5
  int v11; // edi@5
  __int64 v12; // rdx@9
  __int16 v13; // si@9
  char v14; // dl@13
  __int64 v15; // rsi@13
  __int64 v16; // rcx@18
  unsigned __int16 v17; // [sp+8h] [bp-48h]@1
  char v18; // [sp+Ah] [bp-46h]@2
  char v19; // [sp+Bh] [bp-45h]@2
  __int16 v20; // [sp+Ch] [bp-44h]@2
  char v21[34]; // [sp+Eh] [bp-42h]@9
  __int64 v22; // [sp+30h] [bp-20h]@1

  v2 = a2;
  v3 = a1;
  v4 = off_7B078[0];
  v22 = *(_QWORD *)off_7B078[0];
  memset(&v17, 0, 0x26uLL);
  v5 = *(_BYTE *)(a2 + 36) + 1;
  LOBYTE(v17) = v5;
  result = 0xFFFFFFFFLL;
  if ( v5 <= 0x20u )
  {
    LOBYTE(v7) = *(_BYTE *)(a2 + 37);
    HIBYTE(v17) = *(_BYTE *)(a2 + 37);
    v18 = *(_BYTE *)(a2 + 38);
    v19 = *(_BYTE *)(a2 + 39);
    v20 = *(_WORD *)(a2 + 40);
    if ( v5 )
    {
      v8 = 0;
      v9 = 1;
      do
      {
        if ( (unsigned __int8)v7 != 1 )
        {
          if ( (_BYTE)v7 )
          {
            v14 = *(_BYTE *)(v2 + (unsigned int)(v9 - 1) + 42);
            v15 = v8;
            v21[v15] = v14;
            *((_BYTE *)v3 + 2 * v15 + 1558) = v14;
            *((_BYTE *)v3 + 2 * v15 + 1559) = *(_BYTE *)(v2 + (unsigned int)v9 + 42);
          }
          else
          {
            v12 = v8;
            v13 = *(_BYTE *)(v2 + v8 + 42);
            v21[v12] = v13;
            *((_WORD *)v3 + v12 + 747) = v13;
          }
          goto LABEL_16;
        }
        v10 = __ROL2__(*(_WORD *)(v2 + (unsigned int)(v9 - 1) + 42), 8);
        *((_WORD *)v3 + v8 + 747) = v10;
        v11 = v10 & 0x300;
        if ( v11 == 256 )
        {
          if ( (unsigned __int8)v10 <= 2u )
            goto LABEL_12;
          LOBYTE(v10) = v10 - 2;
        }
        else if ( v11 == 512 )
        {
          if ( (v10 & 0xFEu) < 0xDE )
          {
            LOBYTE(v10) = v10 + 2;
            goto LABEL_15;
          }
LABEL_12:
          LOBYTE(v10) = 0;
          goto LABEL_15;
        }
LABEL_15:
        v21[v8] = v10;
LABEL_16:
        ++v8;
        v7 = (unsigned int)v17 >> 8;
        v9 += 2;
      }
      while ( v8 < (unsigned __int8)v17 );
    }
    result = IO80211AWDLPeer::updateAwdlChanSeq(v3, (__int64)&v17);
  }
  v16 = *(_QWORD *)v4;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 1E8AC: using guessed type char var_42[34];

//----- (000000000001E9FA) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::makeBrowseList(IO80211AWDLPeer *this)
{
  __int64 v1; // r13@1
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1
  signed int v4; // er12@3
  __int64 v5; // rax@4
  __int64 v6; // r8@9
  __int64 v7; // r9@9
  unsigned int v8; // ebx@9
  int v9; // eax@10
  __int64 v10; // rcx@10
  size_t v11; // rdx@15
  void *v12; // rdi@16
  signed __int64 v13; // rsi@18
  __int64 v14; // r8@18
  __int64 v15; // r9@18
  __int64 v16; // r15@20
  unsigned int v17; // ebx@20
  __int64 v18; // rcx@20
  __int64 v19; // r8@20
  __int64 v20; // r9@20
  IO80211PeerManager *v21; // rdi@20
  __int64 v22; // rdi@23
  __int64 v23; // r9@25
  char v24; // cl@25
  char v25; // bl@26
  bool v26; // zf@29
  __int64 result; // rax@34
  signed __int64 v28; // [sp+8h] [bp-148h]@9
  __int64 v29; // [sp+10h] [bp-140h]@3
  __int64 v30; // [sp+18h] [bp-138h]@3
  __int64 v31; // [sp+20h] [bp-130h]@3
  __int64 v32; // [sp+28h] [bp-128h]@3
  __int64 v33; // [sp+30h] [bp-120h]@3
  __int64 v34; // [sp+38h] [bp-118h]@3
  __int64 v35; // [sp+40h] [bp-110h]@3
  __int64 v36; // [sp+48h] [bp-108h]@3
  __int64 v37; // [sp+50h] [bp-100h]@3
  __int64 v38; // [sp+58h] [bp-F8h]@3
  __int64 v39; // [sp+60h] [bp-F0h]@3
  __int64 v40; // [sp+68h] [bp-E8h]@3
  __int64 v41; // [sp+70h] [bp-E0h]@3
  __int64 v42; // [sp+78h] [bp-D8h]@3
  __int64 v43; // [sp+80h] [bp-D0h]@3
  __int64 v44; // [sp+88h] [bp-C8h]@3
  __int64 v45; // [sp+90h] [bp-C0h]@3
  __int64 v46; // [sp+98h] [bp-B8h]@3
  __int64 v47; // [sp+A0h] [bp-B0h]@3
  __int64 v48; // [sp+A8h] [bp-A8h]@3
  __int64 v49; // [sp+B0h] [bp-A0h]@3
  void *v50; // [sp+B8h] [bp-98h]@3
  __int64 v51; // [sp+C0h] [bp-90h]@3
  __int64 v52; // [sp+C8h] [bp-88h]@3
  __int64 v53; // [sp+D0h] [bp-80h]@3
  __int64 v54; // [sp+D8h] [bp-78h]@3
  __int64 v55; // [sp+E0h] [bp-70h]@3
  __int64 v56; // [sp+E8h] [bp-68h]@3
  __int64 v57; // [sp+F0h] [bp-60h]@3
  __int64 v58; // [sp+F8h] [bp-58h]@3
  __int64 v59; // [sp+100h] [bp-50h]@3
  __int64 v60; // [sp+108h] [bp-48h]@3
  __int64 v61; // [sp+110h] [bp-40h]@3
  __int64 v62; // [sp+118h] [bp-38h]@3
  __int64 v63; // [sp+120h] [bp-30h]@1

  v1 = (__int64)this;
  v2 = off_7B078[0];
  v63 = *(_QWORD *)off_7B078[0];
  v3 = *((_QWORD *)this + 177);
  if ( v3 )
  {
    kfree(v3, *(_DWORD *)(v1 + 1424));
    *(_DWORD *)(v1 + 1424) = 0;
    *(_QWORD *)(v1 + 1416) = 0LL;
  }
  v62 = 0LL;
  v61 = 0LL;
  v60 = 0LL;
  v59 = 0LL;
  v58 = 0LL;
  v57 = 0LL;
  v56 = 0LL;
  v55 = 0LL;
  v54 = 0LL;
  v53 = 0LL;
  v52 = 0LL;
  v51 = 0LL;
  v50 = 0LL;
  memcpy(&v55, (const void *)(v1 + 1680), 0x20uLL);
  LODWORD(v53) = 1;
  LOWORD(v54) = 257;
  v49 = 0LL;
  v48 = 0LL;
  v47 = 0LL;
  v46 = 0LL;
  v45 = 0LL;
  v44 = 0LL;
  v43 = 0LL;
  v42 = 0LL;
  v41 = 0LL;
  v40 = 0LL;
  v39 = 0LL;
  v38 = 0LL;
  v37 = 0LL;
  v36 = 0LL;
  v35 = 0LL;
  v34 = 0LL;
  v33 = 0LL;
  v32 = 0LL;
  v31 = 0LL;
  v30 = 0LL;
  v29 = (__int64)&v39;
  IO80211PeerManager::initUserPrintContext(*(IO80211PeerManager **)(v1 + 40), (__int64)&v39, 0LL, 0);
  IO80211CommandQueue::lock(*(IO80211CommandQueue **)(*(_QWORD *)(v1 + 40) + 3808LL), 0LL, 0);
  v4 = -1;
  IO80211CommandQueue::map(
    *(_QWORD *)(*(_QWORD *)(v1 + 40) + 3808LL),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_copyTLV,
    v1,
    (__int64)&v50,
    (__int64)&v29,
    -1);
  if ( v51 )
  {
    LODWORD(v5) = kalloc(v51);
    *(_QWORD *)(v1 + 1416) = v5;
    if ( !v5 )
    {
LABEL_33:
      IO80211CommandQueue::unlock(*(IO80211CommandQueue **)(*(_QWORD *)(v1 + 40) + 3808LL), 0LL);
      goto LABEL_34;
    }
    *(_DWORD *)(v1 + 1424) = v51;
  }
  else
  {
    v5 = *(_QWORD *)(v1 + 1416);
  }
  v4 = 0;
  if ( !v5 )
    goto LABEL_33;
  if ( IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(v1 + 40), 0x10000LL) )
  {
    v28 = v1 + 1424;
    IO80211PeerManager::logDebug(
      *(IO80211PeerManager **)(v1 + 40),
      0x10000LL,
      "   %s list length %u list %p hashes :",
      (__int64)"makeBrowseList",
      *(_DWORD *)(v1 + 1424),
      *(_QWORD *)(v1 + 1416));
    v8 = 0;
    do
    {
      v9 = *((_BYTE *)&v55 + (v8 >> 3));
      v10 = v8 & 7;
      if ( _bittest((const unsigned int *)&v9, v10) )
        IO80211PeerManager::logDebug(*(IO80211PeerManager **)(v1 + 40), 0x10000LL, " 0x%02x", v8, v6, v7);
      ++v8;
    }
    while ( v8 != 256 );
    IO80211PeerManager::logDebug(*(IO80211PeerManager **)(v1 + 40), 0x10000LL, "\n", v10, v6, v7);
    v2 = off_7B078[0];
  }
  else
  {
    v28 = v1 + 1424;
  }
  bzero(&v50, 0x68uLL);
  memcpy(&v55, (const void *)(v1 + 1680), 0x20uLL);
  LODWORD(v53) = 1;
  LOWORD(v54) = 257;
  v50 = *(void **)(v1 + 1416);
  v52 = *(_DWORD *)(v1 + 1424);
  IO80211PeerManager::initUserPrintContext(*(IO80211PeerManager **)(v1 + 40), v29, 0LL, 0);
  IO80211CommandQueue::map(
    *(_QWORD *)(*(_QWORD *)(v1 + 40) + 3808LL),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_copyTLV,
    v1,
    (__int64)&v50,
    (__int64)&v29,
    -1);
  IO80211CommandQueue::unlock(*(IO80211CommandQueue **)(*(_QWORD *)(v1 + 40) + 3808LL), 0LL);
  v11 = *(_DWORD *)(v1 + 1424);
  v4 = -3;
  if ( !*(_DWORD *)(v1 + 1424) )
    goto LABEL_33;
  v12 = *(void **)(v1 + 1416);
  if ( !v12 )
    goto LABEL_33;
  if ( v11 != v51 )
  {
    if ( (_DWORD)v11 )
    {
      kfree(v12, *(_DWORD *)(v1 + 1424));
      *(_QWORD *)(v1 + 1416) = 0LL;
      *(_DWORD *)(v1 + 1424) = 0;
    }
    goto LABEL_33;
  }
  memcpy(v12, v50, v11);
  v13 = 0x10000LL;
  if ( IO80211PeerManager::shouldLog(*(IO80211PeerManager **)(v1 + 40), 0x10000LL) && *(_QWORD *)(v1 + 1416) )
  {
    v16 = v2;
    v17 = 0;
    IO80211PeerManager::logDebug(
      *(IO80211PeerManager **)(v1 + 40),
      0x10000LL,
      " Browse List (%u): ",
      *(_DWORD *)(v1 + 1424),
      v14,
      v15);
    v21 = *(IO80211PeerManager **)(v1 + 40);
    if ( *(_DWORD *)(v1 + 1424) >= 4u )
    {
      do
      {
        IO80211PeerManager::logDebug(v21, 0x10000LL, " %u", *(_DWORD *)(*(_QWORD *)(v1 + 1416) + 4LL * v17++), v19, v20);
        v21 = *(IO80211PeerManager **)(v1 + 40);
      }
      while ( v17 < *(_DWORD *)(v1 + 1424) >> 2 );
    }
    v13 = 0x10000LL;
    IO80211PeerManager::logDebug(v21, 0x10000LL, "\n", v18, v19, v20);
    v2 = v16;
  }
  v22 = *(_QWORD *)(v1 + 1720);
  v4 = 0;
  if ( v22 )
  {
    if ( *(_DWORD *)v28 < 4u )
      goto LABEL_38;
    v23 = v2;
    v13 = 0LL;
    v24 = 0;
    do
    {
      v25 = 1;
      if ( *(_DWORD *)(*(_QWORD *)(v1 + 1416) + 4 * v13) != *(_DWORD *)(v22 + 32) )
        v25 = v24;
      ++v13;
      v24 = v25;
    }
    while ( (unsigned int)v13 < *(_DWORD *)v28 >> 2 );
    v4 = 0;
    v26 = (v25 & 1) == 0;
    v2 = v23;
    if ( v26 )
    {
LABEL_38:
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v22 + 288LL))(v22, v13);
      (*(void (**)(void))(**(_QWORD **)(v1 + 1720) + 40LL))();
      *(_QWORD *)(v1 + 1720) = 0LL;
      v4 = 0;
    }
  }
LABEL_34:
  result = *(_QWORD *)v2;
  if ( *(_QWORD *)v2 == v63 )
    result = (unsigned int)v4;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C8BB8: using guessed type int __fastcall kalloc(_QWORD);
// C8BC8: using guessed type int __fastcall kfree(_QWORD, _QWORD);

//----- (000000000001EF82) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::handleServiceResponseTLV(IO80211AWDLPeer *this, unsigned __int8 *a2, unsigned int a3, __int64 a4, __int64 a5, __int64 a6)
{
  unsigned int v6; // er15@1
  __int64 v7; // r13@1
  IO80211AWDLPeer *v8; // r12@1
  __int64 v9; // r14@1
  signed int v10; // ebx@1
  int v11; // ebx@4
  char v12; // al@4
  IO80211PeerManager *v13; // r14@6
  OSMetaClass *v14; // rax@6
  __int64 v15; // r10@6
  __int64 v16; // r9@6
  int v17; // er8@6
  int v18; // er11@6
  int v19; // esi@6
  int v20; // edi@6
  int v21; // ebx@6
  IO80211PeerManager *v22; // r15@8
  OSMetaClass *v23; // rax@8
  __int64 v24; // rax@8
  int v25; // ST20_4@8
  int v26; // ST18_4@8
  int v27; // ST10_4@8
  int v28; // ST08_4@8
  int v29; // ST00_4@8
  OSMetaClass *v30; // rax@10
  __int64 v31; // r10@10
  __int64 v32; // r9@10
  int v33; // er8@10
  int v34; // edx@10
  int v35; // esi@10
  int v36; // edi@10
  int v37; // ebx@10
  unsigned int v38; // er15@11
  __int64 v39; // rcx@11
  __int64 v40; // r8@11
  __int64 v41; // r9@11
  IO80211PeerManager *v42; // rdi@11
  __int64 v43; // rcx@12
  unsigned int v44; // eax@16
  unsigned int v45; // eax@17
  signed int v46; // er15@17
  __int64 v47; // rsi@17
  signed int v48; // edi@18
  __int64 v49; // rdi@23
  __int64 v50; // rcx@23
  int v51; // eax@24
  __int64 v52; // rdi@27
  unsigned __int64 v53; // rsi@28
  int v54; // ST9C_4@30
  OSMetaClass *v55; // rax@30
  int v56; // ST98_4@32
  int v57; // ST94_4@32
  int v58; // ST90_4@32
  int v59; // ST8C_4@32
  int v60; // ecx@32
  int v61; // eax@32
  IO80211PeerManager *v62; // r15@34
  OSMetaClass *v63; // rax@34
  __int64 v64; // r10@34
  int v65; // er8@34
  int v66; // edx@34
  int v67; // esi@34
  int v68; // edi@34
  int v69; // ebx@34
  unsigned int v70; // ebx@35
  __int64 v71; // rcx@35
  __int64 v72; // r8@35
  __int64 v73; // r9@35
  IO80211PeerManager *v74; // rdi@35
  __int64 v75; // rcx@36
  int v77; // er10@43
  unsigned int v78; // ebx@43
  __int64 v79; // r8@43
  __int64 v80; // rcx@44
  __int64 v81; // r8@44
  __int64 v82; // r9@44
  __int64 v83; // rbx@47
  __int64 v84; // rcx@48
  __int64 v85; // r8@48
  __int64 v86; // r9@48
  __int64 v87; // rdi@51
  int v88; // ebx@57
  OSMetaClass *v89; // rax@57
  __int64 v90; // rax@57
  int v91; // ecx@57
  int v92; // er13@57
  int v93; // er11@57
  OSMetaClass *v94; // rax@60
  __int64 v95; // rax@60
  __int64 v96; // r9@60
  OSMetaClass *v97; // rax@61
  __int64 v98; // rax@61
  signed __int64 v99; // rsi@61
  __int64 v100; // r9@61
  OSMetaClass *v101; // rax@65
  __int64 v102; // r8@65
  int v103; // er10@65
  int v104; // er11@65
  int v105; // esi@65
  int v106; // edi@65
  int v107; // ebx@65
  int v108; // ecx@65
  int v109; // esi@57
  char v110; // bl@67
  char v111; // al@67
  __int64 v112; // r15@70
  int v113; // er14@70
  OSMetaClass *v114; // rax@70
  __int64 v115; // r10@70
  int v116; // er8@70
  int v117; // er11@70
  int v118; // esi@70
  int v119; // edi@70
  int v120; // ecx@70
  __int64 v121; // r15@73
  int v122; // er14@73
  OSMetaClass *v123; // rax@73
  __int64 v124; // r10@73
  int v125; // er8@73
  int v126; // edx@73
  int v127; // esi@73
  int v128; // edi@73
  int v129; // ecx@73
  int v130; // ST40_4@70
  __int64 v131; // [sp+A0h] [bp-190h]@0
  unsigned int v132; // [sp+A8h] [bp-188h]@0
  int v133; // [sp+ACh] [bp-184h]@0
  __int64 v134; // [sp+B0h] [bp-180h]@0
  IO80211PeerManager *v135; // [sp+B8h] [bp-178h]@0
  unsigned int v136; // [sp+C4h] [bp-16Ch]@0
  unsigned int v137; // [sp+C4h] [bp-16Ch]@11
  char v138; // [sp+C8h] [bp-168h]@3
  int v139; // [sp+ECh] [bp-144h]@4
  char v140[256]; // [sp+F0h] [bp-140h]@12
  unsigned int v141; // [sp+1F0h] [bp-40h]@11
  unsigned __int8 v142; // [sp+1FBh] [bp-35h]@4
  char v143; // [sp+1FCh] [bp-34h]@4
  __int64 v144; // [sp+200h] [bp-30h]@1

  v6 = a3;
  v7 = (__int64)a2;
  v8 = this;
  v9 = off_7B078[0];
  v144 = *(_QWORD *)off_7B078[0];
  v10 = -1;
  if ( a3 < 3 || !a2 )
    goto LABEL_41;
  __bzero(&v138, 312LL);
  if ( !_service_response_init_context((__int64)&v138, (__int64)a2, v6) )
  {
    v7 = v6;
    if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)this + 5), 0x10000LL) )
    {
      v22 = (IO80211PeerManager *)*((_QWORD *)this + 5);
      LODWORD(v23) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       0x10000LL);
      v24 = OSMetaClass::getClassName(v23);
      v25 = *((_BYTE *)this + 37);
      v26 = *((_BYTE *)this + 36);
      v27 = *((_BYTE *)this + 35);
      v28 = *((_BYTE *)this + 34);
      v29 = *((_BYTE *)this + 33);
      IO80211PeerManager::logDebug(
        v22,
        0x10000LL,
        "%s::%s Parse Error from %02x:%02x:%02x:%02x:%02x:%02x tlv length %u\n",
        v24,
        (__int64)"handleServiceResponseTLV",
        *((_BYTE *)this + 32));
    }
    goto LABEL_40;
  }
  v143 = 1;
  IO80211CommandQueue::lockMap(
    *(IO80211CommandQueue **)(*((_QWORD *)this + 5) + 3808LL),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_findTLV,
    (__int64)this,
    (__int64)&v138,
    0LL,
    v142);
  v11 = v139;
  v12 = IO80211PeerManager::shouldLog(*((IO80211PeerManager **)this + 5), 0x10000LL);
  if ( !v11 )
  {
    if ( v12 )
    {
      v135 = (IO80211PeerManager *)*((_QWORD *)this + 5);
      LODWORD(v30) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       0x10000LL);
      v31 = OSMetaClass::getClassName(v30);
      v32 = *((_BYTE *)this + 32);
      v33 = *((_BYTE *)this + 33);
      v34 = *((_BYTE *)this + 34);
      v35 = *((_BYTE *)this + 35);
      v36 = *((_BYTE *)this + 36);
      v37 = *((_BYTE *)v8 + 37);
      v7 = v9;
      v70 = 0;
      IO80211PeerManager::logDebug(
        v135,
        0x10000LL,
        "%s::%s Not browsing for TLV from %02x:%02x:%02x:%02x:%02x:%02x tlv length %u hash 0x%x %s [",
        v31,
        (__int64)"handleServiceResponseTLV",
        v32);
      v74 = (IO80211PeerManager *)*((_QWORD *)v8 + 5);
      if ( v141 )
      {
        do
        {
          v75 = (unsigned __int8)v140[v70];
          if ( (unsigned __int8)(v140[v70] - 32) >= 0x5Fu )
            v75 = 46LL;
          IO80211PeerManager::logDebug(v74, 0x10000LL, "%c", v75, v72, v73);
          ++v70;
          v74 = (IO80211PeerManager *)*((_QWORD *)v8 + 5);
        }
        while ( v70 < v141 );
      }
      IO80211PeerManager::logDebug(v74, 0x10000LL, "]\n", v71, v72, v73);
    }
    goto LABEL_40;
  }
  if ( v12 )
  {
    v13 = (IO80211PeerManager *)*((_QWORD *)this + 5);
    LODWORD(v14) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)this + 56LL))(this, 0x10000LL);
    v15 = OSMetaClass::getClassName(v14);
    v16 = *((_BYTE *)this + 32);
    v17 = *((_BYTE *)this + 33);
    v18 = *((_BYTE *)this + 34);
    v19 = *((_BYTE *)this + 35);
    v20 = *((_BYTE *)this + 36);
    v21 = *((_BYTE *)v8 + 37);
    v137 = v6;
    v38 = 0;
    IO80211PeerManager::logDebug(
      v13,
      0x10000LL,
      "%s::%s Found TLV from %02x:%02x:%02x:%02x:%02x:%02x tlv length %u hash 0x%x %s allocCount %u [",
      v15,
      (__int64)"handleServiceResponseTLV",
      v16);
    v42 = (IO80211PeerManager *)*((_QWORD *)v8 + 5);
    if ( v141 )
    {
      do
      {
        v43 = (unsigned __int8)v140[v38];
        if ( (unsigned __int8)(v140[v38] - 32) >= 0x5Fu )
          v43 = 46LL;
        IO80211PeerManager::logDebug(v42, 0x10000LL, "%c", v43, v40, v41);
        ++v38;
        v42 = (IO80211PeerManager *)*((_QWORD *)v8 + 5);
      }
      while ( v38 < v141 );
    }
    IO80211PeerManager::logDebug(v42, 0x10000LL, "]\n", v39, v40, v41);
    v9 = off_7B078[0];
    v6 = v137;
  }
  v136 = v6;
  v44 = *((_DWORD *)v8 + 356);
  if ( v44 < 4 )
    goto LABEL_78;
  v45 = v44 >> 2;
  v46 = -1;
  v47 = 0LL;
  do
  {
    v48 = v46;
    v46 = v47;
    if ( (v139 ^ *(_DWORD *)(*((_QWORD *)v8 + 177) + 4 * v47)) & 0xFFFFFF )
      v46 = v48;
    ++v47;
  }
  while ( (unsigned int)v47 < v45 && v46 < 0 );
  if ( v46 == -1 )
  {
LABEL_78:
    v10 = -2;
    if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)v8 + 5), 0x10000LL) )
    {
      v62 = (IO80211PeerManager *)*((_QWORD *)v8 + 5);
      LODWORD(v63) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)v8 + 56LL))(v8, 0x10000LL);
      v64 = OSMetaClass::getClassName(v63);
      v65 = *((_BYTE *)v8 + 33);
      v66 = *((_BYTE *)v8 + 34);
      v67 = *((_BYTE *)v8 + 35);
      v68 = *((_BYTE *)v8 + 36);
      v69 = *((_BYTE *)v8 + 37);
      IO80211PeerManager::logDebug(
        v62,
        0x10000LL,
        "%s::%s Not browsing for TLV from %02x:%02x:%02x:%02x:%02x:%02x tlv length %u hash 0x%02x %s\n",
        v64,
        (__int64)"handleServiceResponseTLV",
        *((_BYTE *)v8 + 32));
      v10 = -2;
    }
    goto LABEL_41;
  }
  v49 = *((_QWORD *)v8 + 215);
  v50 = 0LL;
  if ( v49 )
  {
    v51 = IO80211ServiceRequestDescriptor::compare(v49, (__int64)&v138);
    v10 = 0;
    v50 = 0LL;
    if ( v51 )
    {
      v50 = *((_QWORD *)v8 + 215);
      if ( !*(_BYTE *)(v50 + 74) )
        goto LABEL_41;
      *((_QWORD *)v8 + 215) = 0LL;
    }
  }
  v52 = *((_QWORD *)v8 + 5);
  if ( *(_DWORD *)(*((_QWORD *)v8 + 177) + 4LL * v46) >> 24 >= *(_DWORD *)(v52 + 3628) )
    goto LABEL_71;
  v132 = *(_DWORD *)(*((_QWORD *)v8 + 177) + 4LL * v46) >> 24;
  v133 = *(_DWORD *)(v52 + 3628);
  v134 = v46;
  v135 = (IO80211PeerManager *)v50;
  v53 = 64LL;
  if ( !IO80211PeerManager::shouldLog((IO80211PeerManager *)v52, 64LL) )
    goto LABEL_47;
  v53 = 64LL;
  if ( !IO80211PeerManager::shouldVerboseLog(*((IO80211PeerManager **)v8 + 5), 64LL) )
    goto LABEL_47;
  v54 = *(_DWORD *)(*(_QWORD *)(*((_QWORD *)v8 + 5) + 3800LL) + 52LL);
  LODWORD(v55) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)v8 + 56LL))(v8, 64LL);
  v131 = OSMetaClass::getClassName(v55);
  a6 = (__int64)"Allocating new response";
  if ( v135 )
    a6 = (__int64)"Found Response";
  v56 = *((_BYTE *)v8 + 32);
  v57 = *((_BYTE *)v8 + 33);
  v58 = *((_BYTE *)v8 + 34);
  v59 = *((_BYTE *)v8 + 35);
  v60 = *((_BYTE *)v8 + 36);
  v61 = *((_BYTE *)v8 + 37);
  do
  {
    v77 = *(_DWORD *)(*((_QWORD *)v8 + 177) + 4 * v134);
    *((_BYTE *)v8 + 1728);
    v78 = 0;
    v53 = 64LL;
    IO80211Peer::logDebug(
      v8,
      64LL,
      "%s::%s %s from %02x:%02x:%02x:%02x:%02x:%02x receiving queue size %u hash 0x%02x %s index %d reportcount %u 0x%x %s%s%s\n",
      v131,
      (__int64)"handleServiceResponseTLV",
      a6);
    v9 = off_7B078[0];
    if ( *(_DWORD *)(*((_QWORD *)v8 + 5) + 3780LL) )
    {
      IO80211Peer::logDebug(v8, 0LL, " browse_list (%u) : ", *((_DWORD *)v8 + 356), v79, a6);
      if ( *((_DWORD *)v8 + 356) >= 4u )
      {
        do
          IO80211Peer::logDebug(v8, 0LL, " 0x%x", *(_DWORD *)(*((_QWORD *)v8 + 177) + 4LL * v78++), v81, v82);
        while ( v78 < *((_DWORD *)v8 + 356) >> 2 );
      }
      v53 = 0LL;
      IO80211Peer::logDebug(v8, 0LL, " \n", v80, v81, v82);
    }
LABEL_47:
    v83 = (__int64)v135;
    if ( v135 )
      goto LABEL_79;
    v83 = OSObject::operator new((OSObject *)stru_68.segname, v53);
    IO80211ServiceRequestDescriptor::IO80211ServiceRequestDescriptor(v83);
    if ( !v83 )
    {
      LODWORD(v94) = (*(int (__fastcall **)(IO80211AWDLPeer *))(*(_QWORD *)v8 + 56LL))(v8);
      v95 = OSMetaClass::getClassName(v94);
      IO80211Peer::logDebug(
        v8,
        "%s::%s can't allocate service descriptor len %u \n",
        v95,
        (__int64)"handleServiceResponseTLV",
        v136,
        v96);
      goto LABEL_40;
    }
    if ( !IO80211ServiceRequestDescriptor::initWithTLVData(v83, v7, 0LL, v84, v85, v86) )
    {
      LODWORD(v97) = (*(int (__fastcall **)(IO80211AWDLPeer *, __int64))(*(_QWORD *)v8 + 56LL))(v8, v7);
      v98 = OSMetaClass::getClassName(v97);
      v99 = (signed __int64)"%s::%s can't allocate service descriptor len %u \n";
      IO80211Peer::logDebug(
        v8,
        "%s::%s can't allocate service descriptor len %u \n",
        v98,
        (__int64)"handleServiceResponseTLV",
        v136,
        v100);
      goto LABEL_75;
    }
    v53 = (unsigned __int64)((char *)v8 + 32);
    memcpy((void *)(v83 + 97), (char *)v8 + 32, 6uLL);
    *(_DWORD *)(v83 + 32) = v139;
    if ( *(_BYTE *)(v83 + 74) )
    {
LABEL_79:
      v87 = *((_QWORD *)v8 + 5);
      if ( !*(_QWORD *)(v87 + 3800) || !v83 || v133 - 1 < v132 )
      {
        if ( v83 )
        {
          (*(void (__fastcall **)(__int64, unsigned __int64))(*(_QWORD *)v83 + 288LL))(v83, v53);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v83 + 40LL))(v83);
        }
        goto LABEL_71;
      }
      *(_DWORD *)(*((_QWORD *)v8 + 177) + 4 * v134) += 0x1000000;
      if ( *(_DWORD *)(v87 + 3780)
        && IO80211PeerManager::shouldLog((IO80211PeerManager *)v87, 64LL)
        && IO80211PeerManager::shouldVerboseLog(*((IO80211PeerManager **)v8 + 5), 64LL) )
      {
        v135 = (IO80211PeerManager *)v83;
        v88 = *(_DWORD *)(*(_QWORD *)(*((_QWORD *)v8 + 5) + 3800LL) + 52LL);
        LODWORD(v89) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)v8 + 56LL))(v8, 64LL);
        v90 = OSMetaClass::getClassName(v89);
        v91 = *((_BYTE *)v8 + 33);
        v92 = *((_BYTE *)v8 + 34);
        v93 = *((_BYTE *)v8 + 35);
        LODWORD(v131) = v142;
        v132 = *((_BYTE *)v8 + 37);
        v133 = *((_BYTE *)v8 + 36);
        v136 = *((_BYTE *)v8 + 32);
        v109 = *(_DWORD *)(*((_QWORD *)v8 + 177) + 4 * v134);
        *((_BYTE *)v8 + 1728);
        IO80211Peer::logDebug(
          v8,
          64LL,
          "%s::%s increasing report count from %02x:%02x:%02x:%02x:%02x:%02x receiving queue size %u hash 0x%02x %s index %d reportcount %u 0x%x %s%s%s\n",
          v90,
          (__int64)"handleServiceResponseTLV",
          *((_BYTE *)v8 + 32));
        v9 = off_7B078[0];
        v83 = (__int64)v135;
      }
      *(_BYTE *)(v83 + 12) = 0;
      v7 = v83;
      v110 = IO80211CommandQueue::lockEnqueue(
               *(IO80211CommandQueue **)(*((_QWORD *)v8 + 5) + 3800LL),
               (IO80211QueueDescriptor *)v83);
      v99 = 64LL;
      v111 = IO80211PeerManager::shouldLog(*((IO80211PeerManager **)v8 + 5), 64LL);
      if ( !v110 )
      {
        if ( v111 )
        {
          v121 = v9;
          v122 = *(_DWORD *)(*(_QWORD *)(*((_QWORD *)v8 + 5) + 3800LL) + 52LL);
          LODWORD(v123) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)v8 + 56LL))(v8, 64LL);
          v124 = OSMetaClass::getClassName(v123);
          v125 = *((_BYTE *)v8 + 33);
          v126 = *((_BYTE *)v8 + 34);
          v127 = *((_BYTE *)v8 + 35);
          v128 = *((_BYTE *)v8 + 36);
          v129 = *((_BYTE *)v8 + 37);
          v99 = 64LL;
          IO80211Peer::logDebug(
            v8,
            64LL,
            "%s::%s Cannot Enqueue from %02x:%02x:%02x:%02x:%02x:%02x num %u hash 0x%02x %s\n",
            v124,
            (__int64)"handleServiceResponseTLV",
            *((_BYTE *)v8 + 32));
          v9 = v121;
        }
        v83 = v7;
        (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v7 + 288LL))(v7, 64LL);
LABEL_75:
        (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v83 + 40LL))(v83, v99);
LABEL_40:
        v10 = -1;
        continue;
      }
      if ( !v111 )
        goto LABEL_71;
      v10 = 0;
      if ( IO80211PeerManager::shouldVerboseLog(*((IO80211PeerManager **)v8 + 5), 64LL) )
      {
        v112 = v9;
        v113 = *(_DWORD *)(*(_QWORD *)(*((_QWORD *)v8 + 5) + 3800LL) + 52LL);
        LODWORD(v114) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)v8 + 56LL))(v8, 64LL);
        v115 = OSMetaClass::getClassName(v114);
        v116 = *((_BYTE *)v8 + 33);
        v117 = *((_BYTE *)v8 + 34);
        v118 = *((_BYTE *)v8 + 35);
        v119 = *((_BYTE *)v8 + 36);
        v120 = *((_BYTE *)v8 + 37);
        v130 = *(_BYTE *)(v7 + 74);
        v10 = 0;
        IO80211Peer::logDebug(
          v8,
          64LL,
          "%s::%s Did Enqueue from %02x:%02x:%02x:%02x:%02x:%02x num %u hash 0x%02x %s complete %u\n",
          v115,
          (__int64)"handleServiceResponseTLV",
          *((_BYTE *)v8 + 32));
        v9 = v112;
      }
    }
    else
    {
      if ( !*((_QWORD *)v8 + 215) )
      {
        *((_QWORD *)v8 + 215) = v83;
LABEL_71:
        v10 = 0;
        continue;
      }
      (*(void (__fastcall **)(__int64, unsigned __int64))(*(_QWORD *)v83 + 288LL))(v83, v53);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v83 + 40LL))(v83);
      v10 = -1;
      if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)v8 + 5), 64LL)
        && IO80211PeerManager::shouldLog(*((IO80211PeerManager **)v8 + 5), 64LL) )
      {
        LODWORD(v101) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)v8 + 56LL))(v8, 64LL);
        v102 = OSMetaClass::getClassName(v101);
        v103 = *((_BYTE *)v8 + 33);
        v104 = *((_BYTE *)v8 + 34);
        v105 = *((_BYTE *)v8 + 35);
        v106 = *((_BYTE *)v8 + 36);
        v107 = *((_BYTE *)v8 + 37);
        v108 = *(_DWORD *)(*(_QWORD *)(*((_QWORD *)v8 + 5) + 3800LL) + 52LL);
        IO80211Peer::logDebug(
          v8,
          64LL,
          "%s::%s Dropping reassembly from %02x:%02x:%02x:%02x:%02x:%02x num %u hash 0x%02x %s\n",
          v102,
          (__int64)"handleServiceResponseTLV",
          *((_BYTE *)v8 + 32));
        goto LABEL_40;
      }
    }
LABEL_41:
    ;
  }
  while ( *(_QWORD *)v9 != v144 );
  return (unsigned int)v10;
}
// 68: using guessed type section_64 stru_68;
// 7B078: using guessed type __int64 off_7B078[7];
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);
// 1EF82: using guessed type char var_140[256];

//----- (00000000000201B4) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::parseAwdlInviteTLV(IO80211AWDLPeer *this, unsigned __int8 *a2, unsigned int a3, unsigned __int8 *a4)
{
  unsigned __int8 *v4; // r15@1
  unsigned int v5; // er13@1
  unsigned __int8 *v6; // r14@1
  IO80211PeerManager *v7; // rbx@1
  OSMetaClass *v8; // rax@1
  __int64 v9; // rax@1
  __int64 v10; // r8@1
  __int64 v11; // r9@1
  __int64 result; // rax@1
  __int16 v13; // cx@2
  int v14; // er13@3
  signed int v15; // eax@10

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = (IO80211PeerManager *)*((_QWORD *)this + 5);
  LODWORD(v8) = (*(int (__cdecl **)(IO80211AWDLPeer *))(*(_QWORD *)this + 56LL))(this);
  v9 = OSMetaClass::getClassName(v8);
  IO80211PeerManager::logDebug(v7, "%s::%s \n", v9, (__int64)"parseAwdlInviteTLV", v10, v11);
  result = 0xFFFFFFFFLL;
  if ( v5 >= 6 )
  {
    *v4 = *a2;
    v13 = *((_WORD *)a2 + 1);
    if ( v13 & 1 )
    {
      v14 = v5 - 8;
      if ( v14 < 0 )
        return result;
      *((_WORD *)this + 931) = *((_WORD *)a2 + 3);
      v6 = a2 + 2;
    }
    else
    {
      v14 = v5 - 6;
    }
    if ( v13 & 2 )
    {
      if ( v14 - 8 < 0 )
        return result;
      if ( !memcmp((char *)this + 32, v6, 6uLL) && *v4 == 6 )
      {
        v15 = *((_WORD *)v6 + 3);
        *((_WORD *)this + 262) = v15;
        if ( v15 < *(_BYTE *)(*((_QWORD *)this + 5) + 3766LL) )
          *((_BYTE *)this + 1278) |= 4u;
      }
    }
    result = 0LL;
  }
  return result;
}

//----- (000000000002029C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::parseAwdlIEEE80211CntnrTLV(IO80211Peer *a1, __int64 a2)
{
  __int64 result; // rax@1
  signed __int64 v3; // rsi@2

  result = 0LL;
  if ( *(_BYTE *)(a2 + 3) == 191 )
  {
    v3 = a2 + 3;
    result = 4294967105LL;
    if ( *(_BYTE *)(v3 + 1) == 12 )
      result = IO80211Peer::parseVhtCapTLV(a1, (void *)v3);
  }
  return result;
}

//----- (00000000000202C8) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::parseAwdlChanSeqFromChanSeqTLV(IO80211AWDLPeer *a1, __int64 a2)
{
  __int64 v2; // r15@1
  unsigned int v3; // ebx@1
  unsigned __int8 v4; // cl@1
  __int64 result; // rax@1
  signed int v6; // eax@3
  char v7; // cl@4
  __int64 v8; // rdx@4
  __int64 v9; // rcx@6
  unsigned __int8 v10; // [sp+0h] [bp-50h]@1
  char v11; // [sp+1h] [bp-4Fh]@2
  char v12; // [sp+2h] [bp-4Eh]@2
  char v13; // [sp+3h] [bp-4Dh]@2
  __int16 v14; // [sp+4h] [bp-4Ch]@2
  char v15[34]; // [sp+6h] [bp-4Ah]@4
  __int64 v16; // [sp+28h] [bp-28h]@1

  v2 = off_7B078[0];
  v16 = *(_QWORD *)off_7B078[0];
  v3 = 0;
  memset(&v10, 0, 0x26uLL);
  v4 = *(_BYTE *)(a2 + 3) + 1;
  v10 = v4;
  result = 0xFFFFFFFFLL;
  if ( v4 <= 0x20u )
  {
    v11 = *(_BYTE *)(a2 + 4);
    v12 = *(_BYTE *)(a2 + 5);
    v13 = *(_BYTE *)(a2 + 6);
    v14 = *(_WORD *)(a2 + 7);
    if ( v4 )
    {
      v6 = 1;
      do
      {
        v7 = *(_BYTE *)(a2 + (unsigned int)(v6 - 1) + 9);
        v8 = v3;
        v15[v8] = v7;
        *((_BYTE *)a1 + 2 * v8 + 1558) = v7;
        *((_BYTE *)a1 + 2 * v8 + 1559) = *(_BYTE *)(a2 + (unsigned int)v6 + 9);
        ++v3;
        v6 += 2;
      }
      while ( v3 < v10 );
    }
    result = IO80211AWDLPeer::updateAwdlChanSeq(a1, (__int64)&v10);
  }
  v9 = *(_QWORD *)v2;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 202C8: using guessed type char var_4A[34];

//----- (0000000000020398) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::peerAwdlReachability(IO80211AWDLPeer *this)
{
  char v1; // al@3
  __int64 v2; // rcx@5
  char v3; // al@6
  char v4; // al@9

  if ( memcmp((char *)this + 1204, (const void *)(*((_QWORD *)this + 5) + 112LL), 6uLL)
    || !memcmp((char *)this + 1204, &null_address, 6uLL) )
    v1 = *((_BYTE *)this + 1278) & 0xF7;
  else
    v1 = *((_BYTE *)this + 1278) | 8;
  *((_BYTE *)this + 1278) = v1;
  v2 = *((_QWORD *)this + 5);
  if ( *((_DWORD *)this + 291) == *(_DWORD *)(v2 + 3716) )
    v3 = v1 & 0xEF;
  else
    v3 = v1 | 0x10;
  if ( *((_DWORD *)this + 295) == *(_DWORD *)(v2 + 3736) )
    v4 = v3 & 0xDD;
  else
    v4 = v3 | 0x20;
  *((_BYTE *)this + 1278) = v4 | 2;
  return 0LL;
}
// 77FDC: using guessed type int null_address;

//----- (000000000002042E) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::copyServiceRequestTlv(IO80211AWDLPeer *this, unsigned __int8 *a2)
{
  return 0LL;
}

//----- (0000000000020436) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::seq2ChanNum(IO80211AWDLPeer *this, unsigned __int16 a2, unsigned int *a3)
{
  unsigned int *v3; // r8@1
  unsigned int v4; // er10@1
  int v5; // er9@2
  int v6; // er9@3
  int v7; // ecx@4
  int v8; // esi@6
  int v9; // edx@8
  unsigned int v10; // edx@9
  int v11; // ecx@12
  unsigned int v12; // er9@13
  int v13; // eax@16

  v3 = a3;
  v4 = *((_BYTE *)this + 1457);
  if ( *((_BYTE *)this + 1457) )
  {
    v5 = *((_DWORD *)this + 407);
    if ( v5 )
      v6 = a2 & (v5 + 0xFFFF);
    else
      v6 = (unsigned __int16)(a2 % *((_WORD *)this + 727));
    v8 = *((_BYTE *)this + 1458);
    if ( !*((_BYTE *)this + 1458)
      || (v7 = *((_WORD *)this + 730), v7 == 0xFFFF)
      || ((v9 = *((_DWORD *)this + 408)) == 0 ? (v10 = v6 % (unsigned int)(v8 + 1)) : (v10 = v6 & (v9 - 1)), !v10) )
    {
      v11 = *((_DWORD *)this + 409);
      if ( v11 )
        v12 = (unsigned int)v6 >> v11;
      else
        v12 = v6 / (unsigned int)(v8 + 1);
      if ( v12 >= v4 )
      {
        v13 = *((_DWORD *)this + 406);
        if ( v13 )
          v12 &= v13 - 1;
        else
          v12 %= v4;
      }
      if ( v3 )
        *v3 = v12;
      LOBYTE(v7) = *((_BYTE *)this + v12 + 1462);
    }
  }
  else
  {
    LOBYTE(v7) = 0;
  }
  return (unsigned __int8)v7;
}

//----- (000000000002050A) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::print(IO80211AWDLPeer *this)
{
  IO80211PeerManager *v1; // r14@1
  unsigned int v2; // eax@1
  int v3; // ST08_4@1
  int v4; // ST00_4@1
  __int64 v5; // r9@1

  v1 = (IO80211PeerManager *)*((_QWORD *)this + 5);
  v2 = IO80211AWDLPeer::getPresenceMode(this);
  v3 = *((_WORD *)this + 936);
  v4 = *((_DWORD *)this + 314);
  IO80211PeerManager::logDebug(
    v1,
    "           [%p] presenceMode %u _down_counter %u _aw_remain %u sc=%u _serviceDwellTime %u last_sync %llu.%03llu\n",
    (__int64)this,
    v2,
    *((_WORD *)this + 642),
    *((_WORD *)this + 714));
  return IO80211PeerManager::logDebug(
           *((IO80211PeerManager **)this + 5),
           "       _aw_period %u _aw_length %u _pm %u\n",
           *((_WORD *)this + 644),
           *((_WORD *)this + 648),
           *((_WORD *)this + 944),
           v5);
}

//----- (00000000000205DC) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::getPresenceMode(IO80211AWDLPeer *this)
{
  __int64 result; // rax@1
  __int64 v2; // r14@2

  LOWORD(result) = *((_WORD *)this + 944);
  if ( !(_WORD)result )
  {
    v2 = *((_QWORD *)this + 16);
    if ( (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v2)) >> 64) >> 18) <= 0xBB8 )
    {
      LOWORD(result) = *((_WORD *)this + 944);
    }
    else
    {
      *((_WORD *)this + 944) = 1;
      LOWORD(result) = 1;
    }
  }
  return (unsigned __int16)result;
}

//----- (0000000000020638) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::printChannelSequence(__int64 a1, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 v3; // rbx@1
  int v4; // ST08_4@1
  __int64 v5; // r13@1
  __int64 v6; // rdx@1
  unsigned __int64 v7; // rcx@1
  __int64 v8; // r8@1
  __int64 v9; // r9@1
  int v10; // eax@4
  int v11; // eax@6
  int *v12; // rax@7
  __int64 v13; // rdi@15
  char *v14; // rsi@15
  char v16; // [sp+0h] [bp-40h]@1

  v2 = a2;
  v3 = a1;
  v4 = *(_BYTE *)(a1 + 1457);
  LODWORD(v5) = 0;
  _userPrint(
    a2,
    "       channel sequence len %u enc %u duplicate %u step %u fill %x  [ %u : ",
    *(_WORD *)(a1 + 1454),
    *(_BYTE *)(a1 + 1456),
    *(_BYTE *)(a1 + 1459),
    *(_BYTE *)(a1 + 1458),
    *(_WORD *)(a1 + 1460));
  if ( *(_BYTE *)(a1 + 1457) )
  {
    do
    {
      v5 = (unsigned int)v5;
      _userPrint(v2, " %u", *(_BYTE *)(v3 + (unsigned int)v5 + 1462), v7, v8, v9, v16);
      if ( *(_BYTE *)(v3 + (unsigned int)v5 + 1462) )
      {
        v11 = *(_BYTE *)(v3 + 1456);
        if ( v11 != 3 )
        {
          if ( (unsigned __int8)v11 != 1 )
            goto LABEL_23;
          v7 = *(_WORD *)(v3 + 2 * v5 + 1494) & 0xC00;
          if ( (_DWORD)v7 != 3072 )
            goto LABEL_23;
          v10 = (*(_WORD *)(v3 + 2 * v5 + 1494) & 0x300) == 512;
          goto LABEL_14;
        }
        LOBYTE(v6) = *(_BYTE *)(v3 + 2 * v5 + 1559);
        LOBYTE(v8) = *(_BYTE *)(v3 + 2 * v5 + 1558);
        v12 = &dword_77E94;
        v7 = 0LL;
        while ( *((_BYTE *)v12 - 4) != (unsigned __int8)v6 )
        {
          ++v7;
          v12 = (int *)((char *)v12 + 5);
          if ( (unsigned int)v7 > 0x10 )
            goto LABEL_23;
        }
        v6 = (unsigned __int8)v8;
        if ( *((_BYTE *)v12 - 1) < (unsigned int)(unsigned __int8)v8
          || *((_BYTE *)v12 - 2) > (unsigned int)(unsigned __int8)v8
          || v12 == &dword_4 )
          goto LABEL_23;
        if ( (_DWORD)v7 == 16 )
        {
          v13 = v2;
          v14 = "++";
LABEL_22:
          _userPrint(v13, v14, v6, v7, v8, v9, v16);
          goto LABEL_23;
        }
        v6 = 121708LL;
        if ( _bittest((const unsigned __int64 *)&v6, v7) )
        {
          v10 = *(_BYTE *)v12;
LABEL_14:
          if ( v10 == 1 )
          {
            v13 = v2;
            v14 = "-";
          }
          else
          {
            v13 = v2;
            v14 = "+";
          }
          goto LABEL_22;
        }
      }
LABEL_23:
      LODWORD(v5) = v5 + 1;
    }
    while ( (unsigned int)v5 < *(_BYTE *)(v3 + 1457) );
  }
  _userPrint(v2, "]\n", v6, v7, v8, v9, v16);
  return 0LL;
}
// 4: using guessed type int;
// 77E94: using guessed type int dword_77E94;

//----- (00000000000207EA) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::print(IO80211AWDLPeer *this, unsigned __int64 a2)
{
  IO80211AWDLPeer *v2; // r12@1
  __int64 v3; // rbx@1
  signed __int64 v4; // r15@1
  unsigned __int64 v5; // r14@1
  __int64 v6; // rbx@1
  unsigned __int64 v7; // rdx@1
  __int64 v8; // rbx@3
  unsigned __int64 v9; // ST1D8_8@4
  __int64 v10; // rbx@5
  unsigned __int64 v11; // rdx@5
  unsigned __int64 v12; // r14@7
  __int64 v13; // rbx@7
  __int64 v14; // rbx@9
  int v15; // ecx@9
  int v16; // ST190_4@10
  int v17; // ST188_4@10
  int v18; // ST178_4@10
  int v19; // ST170_4@10
  int v20; // ST16C_4@10
  int v21; // ST168_4@10
  int v22; // ST164_4@10
  int v23; // ST160_4@10
  int v24; // ST158_4@10
  int v25; // ST15C_4@10
  int v26; // ST154_4@10
  int v27; // ST150_4@10
  int v28; // ST14C_4@10
  int v29; // ST148_4@10
  int v30; // ST144_4@10
  int v31; // ST140_4@10
  int v32; // ST13C_4@10
  int v33; // ST138_4@10
  int v34; // ST134_4@10
  int v35; // ST130_4@10
  int v36; // eax@10
  int v37; // ecx@10
  int v38; // esi@10
  int v39; // edi@10
  int v40; // er8@10
  int v41; // er11@14
  int v42; // ebx@14
  __int64 v43; // rdx@16
  __int64 v44; // rcx@16
  __int64 v45; // r8@16
  __int64 v46; // r9@16
  unsigned int v47; // ebx@17
  __int64 v48; // rdx@17
  __int64 v49; // rcx@17
  __int64 v50; // r8@17
  __int64 v51; // r9@17
  __int64 v52; // rdx@18
  __int64 v53; // r14@22
  char v54; // al@23
  __int64 v55; // r15@23
  IO80211PeerManager *v56; // r14@25
  OSMetaClass *v57; // rax@25
  __int64 v58; // rax@25
  __int64 v59; // r8@25
  __int64 v60; // r9@25
  OSMetaClass *v61; // rax@26
  __int64 v62; // rax@26
  __int64 v63; // r8@26
  __int64 v64; // r9@26
  __int64 v65; // rbx@28
  unsigned __int64 v66; // r14@28
  __int64 v67; // rbx@28
  unsigned __int64 v68; // rax@28
  int v69; // ST19C_4@28
  int v70; // ST188_4@28
  int v71; // ST180_4@28
  int v72; // er9@28
  int v73; // er13@28
  int v74; // er10@28
  __int64 v75; // r13@28
  int v76; // ST10_4@29
  int v77; // ST08_4@29
  int v78; // eax@30
  __int64 v79; // rdx@30
  __int64 v80; // r8@30
  __int64 v81; // r9@30
  __int64 v82; // rcx@30
  unsigned int v83; // ST1B0_4@31
  unsigned int v84; // ST1B8_4@31
  unsigned int v85; // ST1AC_4@31
  int v86; // ST1A8_4@31
  int v87; // ST1A0_4@31
  int v88; // ST19C_4@31
  int v89; // ST1C0_4@31
  int v90; // er13@31
  int v91; // er15@31
  int v92; // ST40_4@31
  int v93; // ST20_4@31
  int v94; // ST18_4@31
  int v95; // ST10_4@31
  int v96; // ST08_4@31
  int v97; // ST18_4@31
  int v98; // ST10_4@31
  int v99; // ST08_4@31
  __int64 v100; // rcx@31
  __int64 v101; // r8@31
  __int64 v102; // r9@31
  signed __int64 v103; // rbx@31
  __int64 v104; // rdx@32
  __int64 v105; // rbx@36
  int v106; // ST18_4@41
  int v107; // ST10_4@41
  int v108; // ST08_4@41
  __int16 v109; // bx@41
  __int64 v110; // ST1A0_8@41
  __int64 v111; // ST188_8@41
  int v112; // ST1A8_4@41
  int v113; // ST19C_4@41
  int v114; // ST190_4@41
  int v115; // ST180_4@41
  __int64 v116; // ST178_8@41
  int v117; // ST80_4@41
  int v118; // ST78_4@41
  int v119; // ST70_4@41
  int v120; // ST68_4@41
  unsigned int v121; // ST28_4@41
  unsigned int v122; // ST20_4@41
  signed __int64 v123; // rax@42
  signed __int64 v124; // rax@44
  int v125; // ST08_4@46
  char v126; // ST00_1@46
  unsigned int v127; // ebx@46
  __int64 v128; // r14@46
  __int64 v129; // r15@46
  __int64 v130; // rax@46
  __int64 v131; // r8@46
  __int64 v132; // r9@46
  char v133; // ST00_1@46
  __int64 v134; // r9@46
  char v135; // ST00_1@46
  char v136; // ST00_1@46
  __int64 v137; // rdx@47
  __int64 v138; // rcx@47
  __int64 v139; // r8@47
  __int64 v140; // r9@47
  __int64 v141; // rdx@48
  __int64 result; // rax@53
  char v143; // [sp+0h] [bp-220h]@16
  char v144; // [sp+0h] [bp-220h]@17
  char v145; // [sp+0h] [bp-220h]@28
  char v146; // [sp+0h] [bp-220h]@31
  char v147; // [sp+0h] [bp-220h]@41
  char v148; // [sp+0h] [bp-220h]@47
  char v149; // [sp+19Ch] [bp-84h]@10
  unsigned int v150; // [sp+1A0h] [bp-80h]@10
  unsigned int v151; // [sp+1A8h] [bp-78h]@10
  unsigned int v152; // [sp+1ACh] [bp-74h]@10
  unsigned int v153; // [sp+1B0h] [bp-70h]@7
  unsigned int v154; // [sp+1B8h] [bp-68h]@3
  __int64 v155; // [sp+1C0h] [bp-60h]@22
  __int64 v156; // [sp+1C8h] [bp-58h]@10
  unsigned __int64 v157; // [sp+1D0h] [bp-50h]@5
  int v158; // [sp+1D0h] [bp-50h]@28
  IO80211ActionFrameDescriptor *v159; // [sp+1D8h] [bp-48h]@24
  unsigned __int64 v160; // [sp+1E0h] [bp-40h]@36
  __int64 v161; // [sp+1E8h] [bp-38h]@36
  __int64 v162; // [sp+1F0h] [bp-30h]@1

  v2 = this;
  v162 = *(_QWORD *)off_7B078[0];
  v3 = *((_QWORD *)this + 158);
  v4 = 4835703278458516699LL;
  v5 = (unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v3)) >> 64;
  v6 = *((_QWORD *)this + 16);
  LODWORD(v7) = 0;
  if ( v6 )
    v7 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v6)) >> 64) >> 18;
  v154 = v7;
  v8 = *((_QWORD *)this + 17);
  if ( v8 )
    v9 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v8)) >> 64) >> 18;
  v10 = *((_QWORD *)this + 19);
  LODWORD(v157) = 0;
  LODWORD(v11) = 0;
  if ( v10 )
    v11 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v10)) >> 64) >> 18;
  v153 = v11;
  v12 = v5 >> 18;
  v13 = *((_QWORD *)this + 22);
  if ( v13 )
    v157 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v13)) >> 64) >> 18;
  v14 = *((_QWORD *)this + 5);
  v15 = *(_DWORD *)(a2 + 48);
  if ( v15 & 4 )
  {
    v156 = a2;
    *((_DWORD *)this + 362) = memcmp((char *)this + 1436, (const void *)(v14 + 3692), 6uLL) == 0;
    v152 = *((_BYTE *)this + 32);
    v151 = *((_BYTE *)this + 33);
    v150 = *((_BYTE *)this + 34);
    v149 = *((_BYTE *)this + 35);
    v16 = *((_BYTE *)this + 36);
    v17 = *((_BYTE *)this + 37);
    *((_BYTE *)this + 522);
    *(_DWORD *)(v14 + 7396);
    v18 = *((_DWORD *)this + 466);
    v19 = *((_DWORD *)this + 467);
    v20 = *((_BYTE *)this + 1276);
    v21 = (char)IO80211Peer::getRssi(this);
    v22 = (char)IO80211Peer::getRssi_2_4(this);
    v23 = (char)IO80211Peer::getRssi_5(this);
    v24 = *((_DWORD *)this + 291);
    v25 = *((_DWORD *)this + 292);
    *((_DWORD *)this + 362);
    v26 = *((_BYTE *)this + 1436);
    v27 = *((_BYTE *)this + 1437);
    v28 = *((_BYTE *)this + 1438);
    v29 = *((_BYTE *)this + 1439);
    v30 = *((_BYTE *)this + 1440);
    v31 = *((_BYTE *)this + 1441);
    v32 = *((_BYTE *)this + 1176);
    v33 = *((_BYTE *)this + 1442);
    v34 = *((_BYTE *)this + 1443);
    v35 = *((_BYTE *)this + 1444);
    v36 = *((_BYTE *)this + 1445);
    v37 = *((_BYTE *)this + 1446);
    v38 = *((_BYTE *)this + 1447);
    v39 = *((_DWORD *)this + 295);
    v40 = *((_BYTE *)v2 + 1177);
    *((_BYTE *)v2 + 1728);
    if ( *((_BYTE *)v2 + 1161) )
      *((_BYTE *)v2 + 1163);
    v42 = 0;
    _userPrint(
      v156,
      "%s%02X:%02X:%02X:%02X:%02X:%02X %s sync %3u.%03u(s)%s AFcount 2.4G=%-4u 5G=%-4u ch=%-3u RSSI=%-4d (2.4G=%-3d 5G=%-3d) metric=%-4u (%s %02X:%02X:%02X:%02X:%02X:%02X eid %u hop %u priv: %02X:%02X:%02X:%02X:%02X:%02X eid %u hop %u) %s%s%s%s %s\n",
      (__int64)"\x1B[1;30;48m",
      v152,
      v151,
      v150,
      v149);
    if ( *(_DWORD *)(v156 + 52) )
    {
      v42 = 0;
      _userPrint(
        v156,
        "       Traffic: Queue %3u.%03u(s) Output %3u.%03u(s) RxU %3u.%03u(s) RxM %3u.%03u(s)\n",
        (unsigned int)v157 / 0x3E8uLL,
        (unsigned int)v157 % 0x3E8,
        v153 / 0x3E8uLL,
        v153 % 0x3E8,
        v154 / 0x3E8);
      if ( *((_QWORD *)v2 + 177) )
      {
        v47 = 0;
        _userPrint(v156, "       Browse list: ", v43, v44, v45, v46, v143);
        if ( *((_DWORD *)v2 + 356) >= 4u )
        {
          do
          {
            v52 = (__int64)&byte_690F5;
            if ( *(_DWORD *)(*((_QWORD *)v2 + 177) + 4LL * v47) & 0xFFFFFF )
              v52 = (__int64)"(Done)";
            _userPrint(v156, " %s%d", v52, *(_DWORD *)(*((_QWORD *)v2 + 177) + 4LL * v47++) & 0xFFFFFF, v50, v51, v144);
          }
          while ( v47 < *((_DWORD *)v2 + 356) >> 2 );
        }
        v42 = 0;
        _userPrint(v156, "\n", v48, v49, v50, v51, v144);
      }
    }
  }
  else if ( *((_DWORD *)this + 291) == *(_DWORD *)(v14 + 3716) || v15 & 1 )
  {
    v155 = v12;
    v53 = OSObject::operator new((OSObject *)&stru_20.nsects, a2);
    IO80211ActionFrameDescriptor::IO80211ActionFrameDescriptor(v53);
    if ( v53 )
    {
      v54 = IO80211ActionFrameDescriptor::initWithAddr(
              (IO80211ActionFrameDescriptor *)v53,
              (ether_addr *)((char *)this + 32));
      v55 = *((_QWORD *)this + 5);
      if ( v54 )
      {
        *(_BYTE *)(v53 + 52) = *(_BYTE *)(v55 + 1532);
        v159 = (IO80211ActionFrameDescriptor *)v53;
      }
      else
      {
        LODWORD(v61) = (*(int (__fastcall **)(IO80211AWDLPeer *, char *))(*(_QWORD *)this + 56LL))(
                         this,
                         (char *)this + 32);
        v62 = OSMetaClass::getClassName(v61);
        v159 = 0LL;
        IO80211PeerManager::logDebug(
          (IO80211PeerManager *)v55,
          "%s::%s can't allocate af descriptor\n",
          v62,
          (__int64)"print",
          v63,
          v64);
        (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v53 + 40LL))(v53, "%s::%s can't allocate af descriptor\n");
      }
      v4 = 4835703278458516699LL;
    }
    else
    {
      v56 = (IO80211PeerManager *)*((_QWORD *)this + 5);
      LODWORD(v57) = (*(int (__fastcall **)(IO80211AWDLPeer *))(*(_QWORD *)this + 56LL))(this);
      v58 = OSMetaClass::getClassName(v57);
      v159 = 0LL;
      IO80211PeerManager::logDebug(v56, "%s::%s can't allocate af descriptor\n", v58, (__int64)"print", v59, v60);
    }
    v158 = ((int (__fastcall *)(IO80211AWDLPeer *, unsigned __int64))`vtable for'IO80211Peer[37])(this, a2);
    v65 = *((_QWORD *)this + 153);
    v66 = (unsigned __int64)((unsigned __int64)v4 * (unsigned __int128)(unsigned __int64)(getAbsoluteTime() - v65) >> 64) >> 18;
    v67 = *((_QWORD *)this + 155);
    v68 = (unsigned __int64)((unsigned __int64)v4 * (unsigned __int128)(unsigned __int64)(getAbsoluteTime() - v67) >> 64) >> 18;
    *((_BYTE *)this + 1728);
    *((_BYTE *)this + 1279);
    v69 = *((_BYTE *)this + 1215);
    v70 = *((_BYTE *)this + 1203);
    v71 = *((_BYTE *)this + 1278);
    v72 = *((_DWORD *)this + 296);
    v73 = *((_DWORD *)this + 297);
    v74 = *((_BYTE *)this + 1192);
    *((_BYTE *)this + 1194);
    v75 = a2;
    _userPrint(
      a2,
      "       infra address  %02X:%02X:%02X:%02X:%02X:%02X %s%s%s CC (%s) ch %u reach %u sent %u.%03u rx %u.%03u Rx %u Tx %u Invite %u %s %s\n",
      *((_BYTE *)this + 1210),
      *((_BYTE *)this + 1211),
      *((_BYTE *)this + 1212),
      *((_BYTE *)this + 1213),
      *((_BYTE *)this + 1214));
    if ( *((_BYTE *)this + 1203) )
    {
      v76 = *((_BYTE *)this + 1209);
      v77 = *((_BYTE *)this + 1208);
      _userPrint(
        a2,
        "       infra rssi %d BSSID %02X:%02X:%02X:%02X:%02X:%02X \n",
        *((_WORD *)this + 931),
        *((_BYTE *)this + 1204),
        *((_BYTE *)this + 1205),
        *((_BYTE *)this + 1206),
        *((_BYTE *)this + 1207));
    }
    v78 = memcmp((char *)this + 32, &null_address, 6uLL);
    v82 = v155;
    if ( v78 )
    {
      v83 = *((_WORD *)this + 944);
      v84 = *((_WORD *)this + 642);
      v85 = *((_WORD *)this + 714);
      v86 = *((_WORD *)this + 936);
      v87 = *((_BYTE *)this + 1276);
      v88 = *((_BYTE *)this + 1277);
      v89 = *((_DWORD *)this + 314);
      v90 = *((_DWORD *)this + 320);
      v91 = *((_BYTE *)this + 1673);
      v92 = IO80211AWDLPeer::nextServiceRequest(this, v159);
      _userPrint(
        a2,
        "           [%p] presenceMode %u _down_counter %u _aw_remain %u lastContention=%u _serviceDwellTime %u last_sync %u.%u(s) last_sync_ch %u (%u/%u) minExt %u _next %d\n",
        (__int64)this,
        v83,
        v84,
        v85,
        v89);
      v93 = *((_DWORD *)this + 291);
      v94 = *((_BYTE *)this + 1435);
      v95 = *((_BYTE *)this + 1434);
      v96 = *((_BYTE *)this + 1433);
      _userPrint(
        a2,
        "       _aw_period %u _aw_length %u master %02X:%02X:%02X:%02X:%02X:%02X electionId %u\n",
        *((_WORD *)this + 644),
        *((_WORD *)this + 648),
        *((_BYTE *)this + 1430),
        *((_BYTE *)this + 1431),
        *((_BYTE *)this + 1432));
      v97 = *((_WORD *)this + 839);
      v98 = *((_DWORD *)this + 362);
      v99 = *((_BYTE *)this + 1441);
      _userPrint(
        a2,
        "       topMaster %02X:%02X:%02X:%02X:%02X:%02X sameTree %u SUI %u ssth [",
        *((_BYTE *)this + 1436),
        *((_BYTE *)this + 1437),
        *((_BYTE *)this + 1438),
        *((_BYTE *)this + 1439),
        *((_BYTE *)this + 1440));
      v103 = 1680LL;
      do
      {
        v104 = *((_BYTE *)this + v103);
        if ( *((_BYTE *)this + v103) )
          _userPrint(a2, " x%02x", v104, v100, v101, v102, v146);
        else
          _userPrint(a2, ".", v104, v100, v101, v102, v146);
        ++v103;
      }
      while ( v103 != 1712 );
      v105 = 0LL;
      _userPrint(a2, "] _ip6_arpa_done %u\n", *((_BYTE *)this + 1760), v100, v101, v102, v146);
      v161 = 0LL;
      v160 = 0LL;
      do
      {
        if ( *(_DWORD *)((char *)this + v105 + 1400) )
          *(_DWORD *)((char *)&v160 + v105) = *(_QWORD *)((char *)this + 2 * v105 + 1368)
                                            / (unsigned __int64)*(_DWORD *)((char *)this + v105 + 1400);
        else
          *(_DWORD *)((char *)&v160 + v105) = 0;
        v105 += 4LL;
      }
      while ( v105 != 16 );
      v106 = *((_DWORD *)this + 98);
      v107 = *((_DWORD *)this + 97);
      v108 = *((_DWORD *)this + 96);
      v109 = 0;
      _userPrint(
        a2,
        "         AWDL Rx Sequences %u %u %u %u mcast %u %u %u %u\n",
        *((_DWORD *)this + 99),
        *((_DWORD *)this + 100),
        *((_DWORD *)this + 101),
        *((_DWORD *)this + 102),
        *((_DWORD *)this + 95));
      v110 = *((_DWORD *)this + 339);
      v111 = *((_DWORD *)this + 340);
      v112 = *((_DWORD *)this + 329);
      v113 = *((_DWORD *)this + 330);
      v114 = *((_DWORD *)this + 331);
      v115 = *((_DWORD *)this + 332);
      v116 = *((_QWORD *)this + 167);
      v117 = *((_DWORD *)this + 328) & 0xFFFFFF;
      v118 = *((_DWORD *)this + 327) & 0xFFFFFF;
      v119 = *((_DWORD *)this + 326) & 0xFFFFFF;
      v120 = *((_DWORD *)this + 325) & 0xFFFFFF;
      v121 = *((_DWORD *)this + 338) / 0x3E8u;
      v122 = *((_DWORD *)this + 337) / 0x3E8u;
      v75 = a2;
      _userPrint(
        a2,
        "           latency  : avg(ms) [%u.%03u %u.%03u %u.%03u %u.%03u] max(ms) [%u %u %u %u] ooo [%u %u %u %u] diff %lld rxpid [%u %u %u %u]\n ",
        (unsigned int)v160 / 0x3E8uLL,
        (unsigned int)v160 % 0x3E8,
        274877907 * (v160 >> 32) >> 38,
        HIDWORD(v160) - 1000 * (274877907 * (v160 >> 32) >> 38),
        (unsigned int)v161 / 0x3E8);
      if ( *(_DWORD *)(*((_QWORD *)this + 5) + 3600LL) )
      {
        v123 = -16LL;
        do
        {
          *(_DWORD *)((char *)this + v123 + 1416) = 0;
          *(_DWORD *)((char *)this + v123 + 1364) = 0;
          *(_QWORD *)((char *)this + 2 * v123 + 1400) = 0LL;
          v123 += 4LL;
        }
        while ( v123 );
      }
      _userPrint(
        a2,
        "           infraInput  : [%u %u %u %u]   ",
        *((_DWORD *)this + 410),
        *((_DWORD *)this + 411),
        *((_DWORD *)this + 412),
        *((_DWORD *)this + 413),
        v147);
      v124 = 498LL;
      do
        v109 += *((_WORD *)this + v124++);
      while ( v124 != 506 );
      v125 = *((_DWORD *)this + 299);
      v126 = v109;
      v127 = 0;
      _userPrint(
        a2,
        "           infraOutput : [%u %u %u %u] txAttempt %u _totNumCapturedPkts %u\n",
        *((_DWORD *)this + 414),
        *((_DWORD *)this + 415),
        *((_DWORD *)this + 416),
        *((_DWORD *)this + 417),
        v126);
      v128 = *((_QWORD *)this + 20);
      LODWORD(v128) = (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL
                                                                          * (getAbsoluteTime() - v128)) >> 64) >> 18)
                    / 0x3E8;
      v129 = *((_QWORD *)this + 20);
      v130 = getAbsoluteTime();
      _userPrint(
        a2,
        "           lastPeerPresence %u.%03u\n",
        (unsigned int)v128,
        (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (v130 - v129)) >> 64) >> 18)
      % 0x3E8,
        v131,
        v132,
        v133);
      _userPrint(
        a2,
        "       dualband %u airplaySink %u data_channel %u\n",
        *((_BYTE *)this + 1160),
        *((_BYTE *)this + 1161),
        *((_BYTE *)this + 1298),
        v134,
        v135);
      IO80211AWDLPeer::printChannelSequence((__int64)this, a2);
      _userPrint(
        a2,
        "     Masks: coded_length 0x%x length 0x%x step 0x%x shift %u\n",
        *((_DWORD *)this + 406),
        *((_DWORD *)this + 407),
        *((_DWORD *)this + 408),
        *((_DWORD *)this + 409),
        v136);
      if ( *((_QWORD *)this + 177) )
      {
        _userPrint(a2, "      browse list: ", v79, v82, v80, v81, v145);
        if ( *((_DWORD *)this + 356) >= 4u )
        {
          do
          {
            v141 = (__int64)&byte_690F5;
            if ( *(_DWORD *)(*((_QWORD *)this + 177) + 4LL * v127) & 0xFFFFFF )
              v141 = (__int64)"(Done)";
            _userPrint(
              a2,
              " %s%d",
              v141,
              *(_DWORD *)(*((_QWORD *)this + 177) + 4LL * v127++) & 0xFFFFFF,
              v139,
              v140,
              v148);
          }
          while ( v127 < *((_DWORD *)this + 356) >> 2 );
        }
        _userPrint(a2, "\n", v137, v138, v139, v140, v148);
      }
    }
    _userPrint(v75, "      --\n", v79, v82, v80, v81, v145);
    IO80211ActionFrameDescriptor::freeResources(v159, 1u);
    (*(void (__fastcall **)(IO80211ActionFrameDescriptor *, signed __int64))(*(_QWORD *)v159 + 40LL))(v159, 1LL);
    v42 = v158;
  }
  else
  {
    v41 = *((_BYTE *)this + 37);
    *((_BYTE *)this + 1728);
    v42 = 0;
    _userPrint(
      a2,
      "    (%02x:%02x:%02x:%02x:%02x:%02x electionID %x - skip) %s%s%s\n",
      *((_BYTE *)this + 32),
      *((_BYTE *)this + 33),
      *((_BYTE *)this + 34),
      *((_BYTE *)this + 35),
      *((_BYTE *)this + 36));
  }
  result = *(_QWORD *)off_7B078[0];
  if ( *(_QWORD *)off_7B078[0] == v162 )
    result = (unsigned int)v42;
  return result;
}
// 20: using guessed type segment_command_64 stru_20;
// 690F5: using guessed type char byte_690F5;
// 77FDC: using guessed type int null_address;
// 7B078: using guessed type __int64 off_7B078[7];
// 7D300: using guessed type __int64 `vtable for'IO80211Peer[2];

//----- (000000000002193C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::nextServiceRequest(IO80211AWDLPeer *this, IO80211ActionFrameDescriptor *a2)
{
  IO80211ActionFrameDescriptor *v2; // r12@1
  IO80211AWDLPeer *v3; // r14@1
  signed int v4; // er15@1
  __int64 v5; // r8@3
  __int64 v6; // rax@3
  int v7; // er10@3
  unsigned int v8; // er9@4
  signed int v9; // edi@5
  signed __int64 v11; // rcx@7
  signed __int64 v12; // rax@7
  bool v13; // cf@7
  signed __int64 v14; // rax@7
  unsigned __int64 v15; // rdx@8
  unsigned int v16; // ecx@10
  unsigned int v17; // esi@10
  int v18; // er13@10
  unsigned int v19; // eax@10
  int v20; // ecx@11
  int v21; // ebx@11
  int v22; // er11@12
  unsigned int v23; // er13@17
  int v24; // ebx@18
  int v25; // er9@18
  unsigned int v26; // ecx@18
  __int64 v27; // rdx@19
  __int64 v28; // [sp+0h] [bp-30h]@11

  v2 = a2;
  v3 = this;
  *((_QWORD *)a2 + 5) = 0LL;
  *((_DWORD *)a2 + 12) = -1;
  v4 = 6;
  if ( *((_BYTE *)a2 + 52) )
    v4 = *((_BYTE *)a2 + 52);
  v5 = getAbsoluteTime();
  v6 = *((_WORD *)this + 642);
  v7 = *((_WORD *)this + 944);
  if ( *((_WORD *)this + 944) && (v8 = *((_WORD *)this + 644), v8 > 0x18) )
  {
    v11 = *((_QWORD *)this + 158) + 1000000 * v6;
    v12 = *((_QWORD *)this + 158) + 1000000 * v6;
    v13 = v12 < (unsigned __int64)v5;
    v14 = v12 - v5;
    if ( v13 )
      LODWORD(v15) = -(signed __int64)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (v5 - v11)) >> 64) >> 18);
    else
      v15 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * v14) >> 64) >> 18;
    v16 = *((_DWORD *)this + 314);
    v9 = v15 - *((_DWORD *)this + 314) / 0x3E8u;
    *((_WORD *)a2 + 28) = 0;
    v17 = *((_BYTE *)v3 + 1452);
    v18 = *((_DWORD *)v2 + 15);
    v19 = 0;
    if ( v9 >= v18 )
    {
      v21 = 0;
    }
    else
    {
      v28 = v16;
      v20 = v8 * v7 + v15 - v16 / 0x3E8;
      v21 = 0;
      do
      {
        ++v21;
        v22 = v20 + v19;
        v19 += v8 * v7;
        v17 += v7;
      }
      while ( v22 < v18 && v19 < 0x2710 );
      *((_WORD *)v2 + 28) = v21;
      v9 = v19 + v15 - ((unsigned __int64)(274877907 * v28) >> 38);
    }
    if ( v9 < 0 )
    {
      *((_DWORD *)v2 + 12) = -2;
      v9 = -2;
    }
    else
    {
      v23 = *((_WORD *)v3 + 727);
      if ( *((_WORD *)v3 + 727) )
      {
        v24 = v21 + 1;
        v25 = v7 * v8;
        v26 = 0;
        while ( 1 )
        {
          v27 = v17 % v23;
          if ( *((_BYTE *)v3 + v27 + 1462) == v4 && *((_WORD *)v2 + 27) == (_DWORD)v27 )
            break;
          *((_WORD *)v2 + 28) = v24++;
          v26 += v7 + 1;
          v9 += v25;
          v17 += v7;
          if ( v26 >= v23 )
            return (unsigned int)v9;
        }
        v9 += 10;
        *((_DWORD *)v2 + 12) = v9;
        *((_QWORD *)v2 + 5) = v5 + 1000000LL * v9;
      }
    }
  }
  else
  {
    *((_DWORD *)a2 + 12) = -3;
    v9 = -3;
  }
  return (unsigned int)v9;
}

//----- (0000000000021B12) ----------------------------------------------------
void __fastcall IO80211AWDLPeer::freeResources(IO80211AWDLPeer *this)
{
  IO80211AWDLPeer *v1; // rbx@1
  __int64 v2; // rdi@1
  __int64 v3; // rdi@3

  v1 = this;
  v2 = *((_QWORD *)this + 177);
  if ( v2 )
  {
    kfree(v2, *((_DWORD *)v1 + 356));
    *((_DWORD *)v1 + 356) = 0;
    *((_QWORD *)v1 + 177) = 0LL;
  }
  v3 = *((_QWORD *)v1 + 215);
  if ( v3 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v3 + 288LL))(v3);
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 215) + 40LL))(*((_QWORD *)v1 + 215));
    *((_QWORD *)v1 + 215) = 0LL;
  }
  JUMPOUT(__CS__, `vtable for'IO80211Peer[38]);
}
// 7D300: using guessed type __int64 `vtable for'IO80211Peer[2];
// C8BC8: using guessed type int __fastcall kfree(_QWORD, _QWORD);

//----- (0000000000021B8A) ----------------------------------------------------
bool __fastcall IO80211AWDLPeer::canTransmit(IO80211AWDLPeer *this, unsigned int a2, unsigned int a3)
{
  unsigned int v3; // er14@1
  __int64 v4; // r12@1
  unsigned __int8 v5; // r15@1
  char v6; // r14@1
  int v7; // ST6C_4@2
  int v8; // ST68_4@2
  int v9; // ST64_4@2
  bool v10; // r8@2
  bool v11; // r9@2
  int v12; // ST30_4@6
  int v13; // ST28_4@6
  bool result; // al@8
  unsigned int v15; // ecx@16
  unsigned int v16; // [sp+7Ch] [bp-34h]@1
  unsigned __int8 v17; // [sp+83h] [bp-2Dh]@1
  unsigned int v18; // [sp+84h] [bp-2Ch]@1

  v3 = a3;
  v4 = *((_QWORD *)this + 5);
  v16 = *(_DWORD *)(v4 + 1468);
  v5 = *(_BYTE *)(v4 + 7585);
  v18 = 0xFFFF;
  v17 = IO80211AWDLPeer::seq2ChanNum(this, v16, &v18);
  v6 = ((int (__fastcall *)(IO80211AWDLPeer *, _QWORD, _QWORD))`vtable for'IO80211Peer[50])(this, a2, v3);
  if ( IO80211PeerManager::shouldLog((IO80211PeerManager *)v4, 0x4000000000000LL) )
  {
    v7 = *((_BYTE *)this + 35);
    v8 = *((_BYTE *)this + 36);
    v9 = *((_BYTE *)this + 37);
    v10 = *((_WORD *)this + 648) == *(_DWORD *)(v4 + 1496);
    v11 = *((_WORD *)this + 644) == *(_DWORD *)(v4 + 1492);
    if ( !*((_BYTE *)this + 1161)
      && *(_DWORD *)(v4 + 4976) != 4
      && *(_DWORD *)(v4 + 1440) <= (unsigned int)*((_BYTE *)this + 1673) )
      *((_WORD *)this + 944);
    v12 = *(_DWORD *)(v4 + 1032) != 0;
    v13 = *(_WORD *)(v4 + 7602) != 0;
    IO80211Peer::logDebug(
      this,
      0x4000000000000LL,
      "canTransmit %02X:%02X:%02X:%02X:%02X:%02X ac=%d sup=%d cs=%d txa=%d awl=%d awp=%d me=%d ch=%d\n",
      *((_BYTE *)this + 32),
      *((_BYTE *)this + 33),
      *((_BYTE *)this + 34));
  }
  if ( !v6 )
    return 0;
  result = 1;
  if ( !*(_BYTE *)(v4 + 156) )
    return result;
  if ( !*(_WORD *)(v4 + 7602)
    || !*(_DWORD *)(v4 + 1032)
    || *((_WORD *)this + 648) != *(_DWORD *)(v4 + 1496)
    || *((_WORD *)this + 644) != *(_DWORD *)(v4 + 1492) )
    return 0;
  if ( *((_BYTE *)this + 1161) || *(_DWORD *)(v4 + 4976) == 4 )
    goto LABEL_25;
  if ( *(_DWORD *)(v4 + 1440) > (unsigned int)*((_BYTE *)this + 1673) )
    return 0;
  v15 = *((_WORD *)this + 944);
  if ( v15 < 2 )
  {
LABEL_25:
    if ( !v17 )
      return 0;
    goto LABEL_22;
  }
  result = 0;
  if ( !(v16 % v15) && v17 )
LABEL_22:
    result = v17 == v5;
  return result;
}
// 7D300: using guessed type __int64 `vtable for'IO80211Peer[2];

//----- (0000000000021E08) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::getPacket(IO80211AWDLPeer *this, __int64 a2)
{
  IO80211AWDLPeer *v2; // rbx@1
  __int64 v3; // r14@1
  IO80211PeerManager *v4; // ST78_8@3
  OSMetaClass *v5; // rax@3
  __int64 v6; // ST70_8@3
  __int64 v7; // r13@3
  int v8; // ST50_4@3
  int v9; // ST48_4@3
  int v10; // ST40_4@3
  int v11; // ST38_4@3
  int v12; // ST30_4@3
  int v13; // ST28_4@3
  int v14; // ST20_4@3
  int v15; // ST18_4@3
  int v16; // ST10_4@3
  int v17; // ST08_4@3
  int v18; // ST00_4@3
  int v19; // er12@4
  unsigned int v20; // er15@5
  unsigned __int8 v21; // r12@5
  unsigned int v22; // ecx@7
  int v23; // ST10_4@11
  int v24; // ST08_4@11
  int v25; // ST00_4@11
  unsigned int v26; // er14@12
  int v27; // ST10_4@15
  int v28; // ST08_4@15
  int v29; // ST00_4@15
  __int64 v30; // r9@15
  IO80211PeerManager *v31; // rdi@15
  __int64 v32; // r15@16
  __int64 v33; // rcx@17
  int v34; // ST20_4@20
  int v35; // ST18_4@20
  int v36; // ST08_4@20
  int v37; // ST00_4@20
  unsigned int v39; // [sp+78h] [bp-38h]@5
  unsigned int v40; // [sp+84h] [bp-2Ch]@5

  v2 = this;
  v3 = *((_QWORD *)this + 5);
  if ( (unsigned __int8)(*(int (__fastcall **)(IO80211AWDLPeer *, _QWORD, _QWORD))(*(_QWORD *)this + 384LL))(
                          this,
                          *(_BYTE *)(a2 + 16),
                          0LL) )
  {
    if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)this + 5), 0x40000000000LL) )
    {
      v4 = (IO80211PeerManager *)*((_QWORD *)this + 5);
      LODWORD(v5) = (*(int (__fastcall **)(IO80211AWDLPeer *, signed __int64))(*(_QWORD *)this + 56LL))(
                      this,
                      0x40000000000LL);
      v6 = OSMetaClass::getClassName(v5);
      v7 = *((_WORD *)this + 944);
      v8 = *((_BYTE *)this + 37);
      v9 = *((_BYTE *)this + 36);
      v10 = *((_BYTE *)this + 35);
      v11 = *((_BYTE *)this + 34);
      v12 = *((_BYTE *)this + 33);
      v13 = *((_BYTE *)this + 32);
      v14 = *(_DWORD *)(a2 + 16);
      v15 = *(_BYTE *)(v3 + 7585);
      v16 = *((_BYTE *)this + 1673);
      v17 = *(_DWORD *)(v3 + 1440);
      v18 = *(_DWORD *)(v3 + 1468);
      IO80211PeerManager::logDebug(
        v4,
        0x40000000000LL,
        "%s::%s txav %u seq %u eid %u minExt %u ch %u ac %u  (%02x:%02x:%02x:%02x:%02x:%02x) pm %u\n",
        v6,
        (__int64)"getPacket",
        *(_DWORD *)(v3 + 1032));
    }
    v19 = ((int (__fastcall *)(IO80211AWDLPeer *, __int64))`vtable for'IO80211Peer[48])(this, a2);
  }
  else
  {
    v39 = *(_DWORD *)(v3 + 1468);
    v20 = *(_BYTE *)(v3 + 7585);
    v40 = 0xFFFF;
    v21 = IO80211AWDLPeer::seq2ChanNum(this, v39, &v40);
    if ( *((_BYTE *)this + 1161)
      || *(_DWORD *)(v3 + 1440) <= (unsigned int)*((_BYTE *)this + 1673)
      && ((v22 = *((_WORD *)this + 944), v22 < 2) || !(v39 % v22)) )
    {
      if ( !v21 || v21 != (unsigned __int8)v20 )
      {
        v23 = *((_BYTE *)this + 37);
        v24 = *((_BYTE *)this + 36);
        v25 = *((_BYTE *)this + 35);
        IO80211PeerManager::logDebug(
          *((IO80211PeerManager **)this + 5),
          0x40000000000LL,
          "getPacket() %02x:%02x:%02x:%02x:%02x:%02x my_channel(%d), peer(%d)\n",
          *((_BYTE *)this + 32),
          *((_BYTE *)this + 33),
          *((_BYTE *)this + 34));
      }
    }
    v26 = v21;
    v19 = 0;
    if ( v26 != v20
      && IO80211PeerManager::shouldLog(*((IO80211PeerManager **)this + 5), 0x40000000000LL)
      && IO80211PeerManager::shouldVerboseLog(*((IO80211PeerManager **)this + 5), 0x40000000000LL) )
    {
      v19 = 0;
      IO80211PeerManager::logDebug(
        *((IO80211PeerManager **)this + 5),
        0x40000000000LL,
        "IO80211AWDLPeer::getPacket() ac %u chan mismatch (this:Peer %d:%d seq=%d) ",
        *(_DWORD *)(a2 + 16),
        v20,
        v26);
      v27 = *((_BYTE *)this + 37);
      v28 = *((_BYTE *)this + 36);
      v29 = *((_BYTE *)this + 35);
      IO80211PeerManager::logDebug(
        *((IO80211PeerManager **)this + 5),
        0x40000000000LL,
        " (%02x:%02x:%02x:%02x:%02x:%02x) peer's chseq [",
        *((_BYTE *)this + 32),
        *((_BYTE *)this + 33),
        *((_BYTE *)this + 34));
      v31 = (IO80211PeerManager *)*((_QWORD *)this + 5);
      if ( *((_BYTE *)v2 + 1457) )
      {
        v32 = 0LL;
        do
        {
          v33 = (__int64)&byte_690F5;
          if ( (_DWORD)v32 )
            v33 = (__int64)" ";
          IO80211PeerManager::logDebug(v31, 0x40000000000LL, "%s%d", v33, *((_BYTE *)v2 + v32++ + 1462), v30);
          v31 = (IO80211PeerManager *)*((_QWORD *)v2 + 5);
        }
        while ( (signed int)v32 < *((_BYTE *)v2 + 1457) );
      }
      v34 = *((_WORD *)v2 + 730);
      v35 = *((_WORD *)v2 + 727);
      v36 = *((_BYTE *)v2 + 1459);
      v37 = *((_BYTE *)v2 + 1458);
      IO80211PeerManager::logDebug(
        v31,
        0x40000000000LL,
        "] _aw_period %u _aw_length %u _pm %u step %u duplicate %u offset %u length %u fill %x\n",
        *((_WORD *)v2 + 644),
        *((_WORD *)v2 + 648),
        *((_WORD *)v2 + 944));
    }
  }
  return (unsigned int)v19;
}
// 690F5: using guessed type char byte_690F5;
// 7D300: using guessed type __int64 `vtable for'IO80211Peer[2];

//----- (0000000000022166) ----------------------------------------------------
void __fastcall IO80211AWDLPeer::dumpTxPacket(IO80211AWDLPeer *this, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rcx@2
  unsigned int v5; // eax@2
  signed __int64 v6; // rax@2
  __int16 v7; // [sp+8h] [bp-28h]@2
  __int16 v8; // [sp+Ah] [bp-26h]@2
  __int16 v9; // [sp+Ch] [bp-24h]@2
  __int16 v10; // [sp+Eh] [bp-22h]@2
  __int16 v11; // [sp+10h] [bp-20h]@2
  __int16 v12; // [sp+12h] [bp-1Eh]@2
  __int16 v13; // [sp+14h] [bp-1Ch]@2
  __int16 v14; // [sp+16h] [bp-1Ah]@2

  v3 = a3;
  if ( a3 )
  {
    v4 = *((_QWORD *)this + 5);
    v5 = *(_DWORD *)(v4 + 1468) % (unsigned int)*(_WORD *)(v4 + 7602);
    v7 = v5;
    v8 = *(_WORD *)(v4 + 1440);
    v9 = *(_BYTE *)(v4 + 1518);
    v10 = *((_BYTE *)this + 1673);
    v11 = *(_BYTE *)(v4 + 1512);
    v12 = *((_WORD *)this + 944);
    v13 = *(_BYTE *)(v4 + 7585);
    v14 = (unsigned __int8)IO80211AWDLPeer::seq2ChanNum(this, v5, 0LL);
    v6 = 16LL * *(_DWORD *)(v3 + 28);
    *(_WORD *)(v3 + v6 + 32) = 5;
    *(_WORD *)(v3 + v6 + 34) = 16;
    *(_QWORD *)(v3 + v6 + 40) = &v7;
    ++*(_DWORD *)(v3 + 28);
    ((void (__fastcall *)(IO80211AWDLPeer *, __int64, __int64))`vtable for'IO80211Peer[41])(this, a2, v3);
  }
}
// 7D300: using guessed type __int64 `vtable for'IO80211Peer[2];

//----- (000000000002223A) ----------------------------------------------------
unsigned __int64 __fastcall IO80211AWDLPeer::serviceRequestRemainingTime(IO80211AWDLPeer *this, int a2)
{
  __int64 v2; // rcx@1
  unsigned __int64 result; // rax@1
  signed __int64 v4; // rdx@2
  bool v5; // cf@2
  signed __int64 v6; // rdx@2

  v2 = getAbsoluteTime();
  result = 0LL;
  if ( *((_BYTE *)this + 1622) == a2 )
  {
    v4 = 1000000LL * *((_WORD *)this + 936) + *((_DWORD *)this + 318);
    v5 = v4 < (unsigned __int64)v2;
    v6 = v4 - v2;
    if ( !v5 && v6 != 0 )
      result = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * v6) >> 64) >> 18;
  }
  return result;
}

//----- (0000000000022296) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::isSynchronized(IO80211AWDLPeer *this)
{
  IO80211AWDLPeer *v1; // rbx@1
  char *v2; // r14@1
  char *v3; // rdi@2
  char *v4; // rsi@2
  char v6; // [sp+8h] [bp-18h]@2

  v1 = this;
  v2 = (char *)this + 1436;
  if ( !memcmp(&null_address, (char *)this + 1436, 6uLL) )
  {
    v4 = (char *)this + 1430;
    v3 = &v6;
  }
  else
  {
    v3 = &v6;
    v4 = v2;
  }
  memcpy(v3, v4, 6uLL);
  return memcmp(v2, (const void *)(*((_QWORD *)v1 + 5) + 3692LL), 6uLL) != 0;
}
// 77FDC: using guessed type int null_address;

//----- (0000000000022310) ----------------------------------------------------
char __fastcall IO80211AWDLPeer::prepareForTransmit(IO80211AWDLPeer *this, IO80211PacketDescriptor *a2)
{
  IO80211AWDLPeer *v2; // rax@1
  IO80211AWDLPeerManager *v3; // rdi@1

  v2 = this;
  v3 = (IO80211AWDLPeerManager *)*((_QWORD *)this + 5);
  if ( v3 )
    IO80211AWDLPeerManager::adjustAwdlSnapHeader(v3, a2, v2);
  return 1;
}

//----- (000000000002232C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::updateAwdlChanSeq(IO80211AWDLPeer *a1, __int64 a2)
{
  __int64 v2; // rbx@1
  char *v3; // r15@2
  __int16 v4; // si@5
  unsigned int v5; // ecx@5
  __int64 result; // rax@5
  __int16 v7; // ax@6
  __int16 v8; // dx@6
  __int16 v9; // dx@6
  unsigned int v10; // eax@7
  char v11; // dl@7
  unsigned int v12; // eax@10
  unsigned int v13; // esi@10
  unsigned int v14; // edx@11
  int v15; // ecx@16
  unsigned int v16; // edx@17
  int v17; // esi@22
  unsigned int v18; // ecx@22
  signed int v19; // edx@22
  bool v20; // zf@25
  unsigned int v21; // esi@25

  v2 = a2;
  if ( *((_BYTE *)a1 + 522) )
  {
    v3 = (char *)a1 + 1457;
    if ( memcmp((char *)a1 + 1462, (const void *)(a2 + 6), *((_BYTE *)a1 + 1457)) )
      IO80211AWDLPeerManager::cachedPeerHasChangedChannelSequence(*((IO80211AWDLPeerManager **)a1 + 5), a1);
  }
  else
  {
    v3 = (char *)a1 + 1457;
  }
  v4 = *(_BYTE *)a2;
  v5 = *(_BYTE *)v2;
  *v3 = v4;
  result = 0xFFFFFFFFLL;
  if ( v5 <= 0x20 )
  {
    v7 = *(_BYTE *)(v2 + 3);
    *((_BYTE *)a1 + 1458) = v7;
    *((_BYTE *)a1 + 1456) = *(_BYTE *)(v2 + 1);
    v8 = *(_BYTE *)(v2 + 2);
    *((_BYTE *)a1 + 1459) = v8;
    *((_WORD *)a1 + 730) = *(_WORD *)(v2 + 4);
    v9 = (v7 + 1) * v4 * (v8 + 1);
    *((_WORD *)a1 + 727) = v9;
    result = 4294967294LL;
    if ( (unsigned __int16)(v9 - 1) <= 0x1FFu )
    {
      v10 = 0;
      v11 = 0;
      if ( (_BYTE)v4 )
      {
        do
        {
          *((_BYTE *)a1 + v10 + 1462) = *(_BYTE *)(v2 + v10 + 6);
          ++v10;
          v11 = *v3;
          v5 = (unsigned __int8)*v3;
        }
        while ( v10 < v5 );
      }
      result = 4294967293LL;
      if ( *((_BYTE *)a1 + 1462) )
      {
        v12 = 0;
        v13 = 0;
        if ( v11 )
        {
          v14 = 2147483648;
          do
            v14 >>= 1;
          while ( v14 && !(v5 & v14) );
          v13 = 0;
          if ( !((v14 + 255) & v5) )
            v13 = v14;
        }
        *((_DWORD *)a1 + 406) = v13;
        v15 = *((_WORD *)a1 + 727);
        if ( *((_WORD *)a1 + 727) )
        {
          v16 = 2147483648;
          do
            v16 >>= 1;
          while ( v16 && !(v15 & v16) );
          v12 = 0;
          if ( !((v16 + 0xFFFF) & v15) )
            v12 = v16;
        }
        *((_DWORD *)a1 + 407) = v12;
        v17 = *((_BYTE *)a1 + 1458) + 1;
        v18 = 2147483648;
        v19 = 31;
        do
        {
          v18 >>= 1;
          --v19;
        }
        while ( v18 && !(v17 & v18) );
        result = 0LL;
        v20 = ((v18 + 0x7FFFFFFF) & v17) == 0;
        v21 = 0;
        if ( v20 )
        {
          *((_DWORD *)a1 + 409) = v19;
          v21 = v18;
        }
        *((_DWORD *)a1 + 408) = v21;
      }
    }
  }
  return result;
}

//----- (00000000000224D0) ----------------------------------------------------
char __fastcall IO80211AWDLPeer::awdlLllcInput(__int64 a1, __mbuf *a2, __int64 a3)
{
  __int64 v3; // r13@1
  IO80211Peer *v4; // r14@1
  __int64 v5; // rax@1
  __int64 v6; // r12@1
  int v7; // eax@1
  int v8; // er15@1
  IO80211PeerManager *v9; // r12@2
  OSMetaClass *v10; // rax@2
  __int64 v11; // rax@2
  char v12; // r14@2
  __int64 v13; // rbx@2
  unsigned int v14; // er15@3
  unsigned int v15; // er11@3
  __int64 v16; // rdx@3
  signed __int64 v17; // rsi@3
  signed __int64 v18; // rbx@4
  signed __int64 v19; // r9@6
  signed __int64 v20; // r10@8
  int v21; // edi@8
  int v22; // er12@8
  int v23; // edx@8
  int v24; // eax@10
  __int64 v25; // rdx@13
  char v26; // r12@13
  unsigned int v27; // er15@14
  int v28; // ebx@14
  __int64 *v29; // rdx@14
  signed __int64 v30; // r9@16
  __int64 v31; // rax@16
  char v32; // al@20
  __int64 v33; // rcx@20
  __int64 v34; // rdx@20
  unsigned int v35; // er15@22
  signed __int64 v36; // r9@22
  __int64 v37; // rax@22
  __int16 v38; // r15@28
  signed __int64 v39; // r12@28
  int v40; // er15@28
  int v41; // eax@29
  unsigned int v42; // er13@31
  __int64 v43; // r14@31
  unsigned int v44; // ebx@33
  unsigned int v45; // eax@37
  __int64 v46; // rbx@38
  unsigned __int64 v47; // rdx@38
  unsigned __int64 v48; // rax@38
  unsigned int v49; // edx@42
  __int64 v50; // rdi@49
  int v51; // eax@49
  bool v52; // al@50
  unsigned int v53; // ebx@54
  IO80211PeerManager *v54; // r13@56
  OSMetaClass *v55; // rax@56
  __int64 v56; // rax@56
  IO80211PeerManager *v57; // r14@72
  OSMetaClass *v58; // rax@72
  __int64 v59; // rcx@72
  const char *v60; // rdx@72
  __int64 v61; // r8@72
  IO80211PeerManager *v62; // rdi@72
  __int64 v63; // r9@72
  IO80211PeerManager *v64; // r14@74
  OSMetaClass *v65; // rax@74
  OSMetaClass *v66; // rax@76
  OSMetaClass *v67; // rax@78
  IO80211PeerManager *v68; // r14@84
  OSMetaClass *v69; // rax@84
  __int64 v70; // rax@84
  IO80211PeerManager *v71; // r15@87
  OSMetaClass *v72; // rax@87
  IO80211PeerManager *v73; // rdi@91
  int v74; // eax@91
  bool v75; // al@92
  __int64 v76; // rcx@92
  char *v77; // rcx@96
  __int64 v78; // rax@100
  __int64 v80; // [sp+20h] [bp-130h]@38
  __int64 v81; // [sp+30h] [bp-120h]@9
  __mbuf *v82; // [sp+38h] [bp-118h]@3
  signed __int64 v83; // [sp+40h] [bp-110h]@9
  char v84; // [sp+40h] [bp-110h]@28
  char v85; // [sp+4Ch] [bp-104h]@9
  unsigned int v86; // [sp+50h] [bp-100h]@3
  __int64 v87; // [sp+58h] [bp-F8h]@4
  __int64 v88; // [sp+58h] [bp-F8h]@28
  int v89; // [sp+64h] [bp-ECh]@9
  __int64 v90; // [sp+68h] [bp-E8h]@4
  __int64 v91; // [sp+68h] [bp-E8h]@28
  IO80211Peer *v92; // [sp+70h] [bp-E0h]@9
  IO80211Peer *v93; // [sp+70h] [bp-E0h]@28
  bool v94; // [sp+7Fh] [bp-D1h]@3
  char v95; // [sp+80h] [bp-D0h]@96
  __int64 v96; // [sp+C0h] [bp-90h]@13
  __int64 v97; // [sp+C8h] [bp-88h]@13
  __mbuf *v98; // [sp+D0h] [bp-80h]@49
  int v99; // [sp+D8h] [bp-78h]@49
  int v100; // [sp+DCh] [bp-74h]@49
  __int64 v101; // [sp+E0h] [bp-70h]@49
  __int64 v102; // [sp+E8h] [bp-68h]@49
  __int64 v103; // [sp+F0h] [bp-60h]@49
  __int64 v104; // [sp+F8h] [bp-58h]@49
  __int64 v105; // [sp+100h] [bp-50h]@49
  __int64 v106; // [sp+108h] [bp-48h]@49
  __int64 v107; // [sp+110h] [bp-40h]@49
  __int64 v108; // [sp+118h] [bp-38h]@49
  __int64 v109; // [sp+120h] [bp-30h]@1

  v3 = a3;
  v4 = (IO80211Peer *)a1;
  v109 = *(_QWORD *)off_7B078[0];
  LODWORD(v5) = mbuf_data(a2);
  v6 = v5;
  v7 = mbuf_len(a2);
  v8 = v7;
  if ( (unsigned int)v7 <= 0x1B )
  {
    v9 = *(IO80211PeerManager **)(a1 + 40);
    LODWORD(v10) = (*(int (__fastcall **)(__int64))(*(_QWORD *)a1 + 56LL))(a1);
    v11 = OSMetaClass::getClassName(v10);
    v12 = 0;
    IO80211PeerManager::logDebug(
      v9,
      0x40000000LL,
      "%s::%s short mbuf len %u\n",
      v11,
      (__int64)"awdlLllcInput",
      (unsigned int)v8);
    *(_DWORD *)(v3 + 20) = 11;
    v13 = off_7B078[0];
    goto LABEL_100;
  }
  v86 = v7;
  v82 = a2;
  v94 = 0;
  v14 = *(_WORD *)(v6 + 24);
  v15 = v14 >> 12;
  v16 = (v14 >> 12) & 3;
  v17 = *(_WORD *)(v6 + 24) & 0xFFF;
  if ( *(_BYTE *)v6 & 1 )
  {
    v87 = v6;
    v90 = v3;
    v18 = a1 + 4 * v16 + 380;
  }
  else
  {
    v87 = v6;
    v90 = v3;
    v18 = a1 + 4 * v16 + 396;
  }
  v19 = a1 + 252;
  if ( *(_BYTE *)v6 & 1 )
    v19 = a1 + 316;
  v20 = v19 + 16 * v16;
  v21 = *(_DWORD *)v18;
  v22 = v14 - *(_DWORD *)v18;
  v23 = ((_WORD)v14 - (unsigned __int16)*(_DWORD *)v18) & 0xFFF;
  if ( v23 == 1 )
  {
    v83 = v18;
    v89 = v17;
    v81 = (v14 >> 12) & 3;
    v92 = v4;
    v85 = 0;
LABEL_13:
    v97 = 0LL;
    v96 = 0LL;
    v25 = (unsigned int)v23 >> 5;
    v26 = v22 & 0x1F;
    *((_DWORD *)&v96 + v25) = *(_DWORD *)v20 << v26;
    if ( (unsigned int)(v25 + 1) <= 3 )
    {
      v17 = v19 + 16LL * (v15 & 3);
      v27 = (((_WORD)v14 - (_WORD)v21) & 0xFE0u) >> 5;
      v28 = 3 - v27;
      v29 = &v96;
      do
      {
        *((_DWORD *)v29 + v27 + 1) = (*(_DWORD *)(v17 + 4LL * (v27 + 1)) << v26) | ((1 << v26) - 1) & (*(_DWORD *)v17 >> (32 - v26));
        v17 += 4LL;
        v29 = (__int64 *)((char *)v29 + 4);
        --v28;
      }
      while ( v28 );
    }
    v30 = 16LL * (v15 & 3) + v19;
    v31 = 0LL;
    v4 = v92;
    do
    {
      *(_DWORD *)(v30 + 4 * v31) = *((_DWORD *)&v96 + v31);
      ++v31;
    }
    while ( v31 != 4 );
    *(_DWORD *)v83 = v89;
    *(_BYTE *)v20 |= 1u;
    goto LABEL_27;
  }
  ++*((_DWORD *)v4 + ((v14 >> 12) & 3) + 329);
  v81 = (v14 >> 12) & 3;
  v24 = *(_DWORD *)v18 + 1;
  if ( v23 )
  {
    if ( (unsigned int)v23 < 0x80 )
    {
      v83 = v18;
      v89 = v17;
      v85 = 1;
      v92 = v4;
      goto LABEL_13;
    }
    v35 = v14 >> 12;
    v36 = 16LL * (v35 & 3) + v19;
    v37 = 0LL;
    do
      *(_DWORD *)(v36 + 4 * v37++) = 0;
    while ( v37 != 4 );
    *(_DWORD *)v20 = 1;
    *(_DWORD *)v18 = v17;
  }
  else
  {
    if ( *(_DWORD *)v20 & 1 )
    {
      v85 = 1;
      v32 = 1;
      v33 = v90;
      v34 = v87;
      if ( *(_DWORD *)(*((_QWORD *)v4 + 5) + 460LL) )
      {
        *(_DWORD *)(v90 + 20) = 3;
        goto LABEL_82;
      }
      goto LABEL_28;
    }
    *(_DWORD *)v20 |= 1u;
  }
  v85 = 1;
LABEL_27:
  v32 = 0;
  v33 = v90;
  v34 = v87;
LABEL_28:
  v84 = v32;
  v88 = v34;
  v93 = v4;
  v91 = v33;
  *((_BYTE *)v4 + 1673) = *(_BYTE *)(v34 + 22);
  *((_WORD *)v4 + 944) = *(_BYTE *)(v34 + 23);
  v38 = *(_WORD *)(v34 + 26);
  *(_WORD *)(v33 + 30) = v38;
  v39 = v34 + 28;
  v40 = v38 & 0xF;
  if ( !v40 )
  {
LABEL_63:
    if ( v86 > (signed int)v39 - (signed int)v88
      && v86 - ((_DWORD)v39 - (_DWORD)v88) >= 0x33uLL
      && *(_WORD *)v39 == 56710
      && *(_BYTE *)(v39 + 8) == 17
      && *(_WORD *)(v39 + 44) == 59668
      && *(_WORD *)(v39 + 42) == 59668 )
    {
      *(_DWORD *)(v91 + 56) = 1;
      if ( *(_BYTE *)v88 & 1 )
        ++*((_DWORD *)v93 + 135);
      else
        ++*((_DWORD *)v93 + 133);
    }
    v13 = off_7B078[0];
    if ( (unsigned __int8)(v84 | v85) == 1
      && IO80211PeerManager::shouldLog(*((IO80211PeerManager **)v93 + 5), 0x1000000000000LL) )
    {
      LOBYTE(v96) = 0;
      HIDWORD(v96) = 0;
      LODWORD(v97) = 0;
      v98 = v82;
      v99 = *(_DWORD *)(v91 + 52);
      v100 = 0;
      v108 = 0LL;
      v107 = 0LL;
      v106 = 0LL;
      v105 = 0LL;
      v104 = 0LL;
      v103 = 0LL;
      v102 = 0LL;
      v101 = 0LL;
      v73 = (IO80211PeerManager *)*((_QWORD *)v93 + 5);
      v74 = 0;
      if ( v73 )
      {
        v75 = IO80211PeerManager::shouldVerboseLog(v73, 0x1000000000000LL);
        v76 = *((_QWORD *)v93 + 5);
        if ( v75 )
        {
          v74 = *(_DWORD *)(v76 + 432);
        }
        else
        {
          v74 = *(_DWORD *)(v76 + 424);
          if ( !*(_DWORD *)(v76 + 424) )
            v74 = getLengthBeforeSensitivePayload(0, v98);
        }
      }
      HIDWORD(v96) = v74;
      bzero(&v95, 0x40uLL);
      v77 = &byte_690F5;
      if ( v84 )
        v77 = "!";
      snprintf(&v95, 0x40uLL, "OutOfOrder%s (ac=%d,%d)", v77, v81);
      IO80211PeerManager::dumpPacket(*((_QWORD *)v93 + 5), 0x1000000000000LL, &v95, (__int64)&v96);
      v13 = off_7B078[0];
    }
    memcpy((void *)(v91 + 32), (char *)v93 + 1210, 6uLL);
    v12 = 1;
    goto LABEL_100;
  }
  v41 = v86 - 28;
  while ( 1 )
  {
    if ( (unsigned int)v41 <= 1 )
    {
      if ( !IO80211PeerManager::shouldLog(*((IO80211PeerManager **)v93 + 5), 0x40000000LL) )
        goto LABEL_81;
      v57 = (IO80211PeerManager *)*((_QWORD *)v93 + 5);
      LODWORD(v58) = (*(int (__fastcall **)(IO80211Peer *, signed __int64))(*(_QWORD *)v93 + 56LL))(v93, 0x40000000LL);
      v59 = OSMetaClass::getClassName(v58);
      v60 = "%s::%s not enough space for tlv len %u remain %u\n";
      v61 = (__int64)"awdlLllcInput";
      v62 = v57;
      v63 = (unsigned int)v40;
      goto LABEL_80;
    }
    v42 = *(_BYTE *)(v39 + 1);
    v43 = v42 + 2;
    if ( v41 < (unsigned int)v43 )
    {
      if ( !IO80211PeerManager::shouldLog(*((IO80211PeerManager **)v93 + 5), 0x40000000LL) )
        goto LABEL_81;
      v64 = (IO80211PeerManager *)*((_QWORD *)v93 + 5);
      LODWORD(v65) = (*(int (__fastcall **)(IO80211Peer *, signed __int64))(*(_QWORD *)v93 + 56LL))(v93, 0x40000000LL);
      v59 = OSMetaClass::getClassName(v65);
      v60 = "%s::%s not enough space for tlv len %u remain %u\n";
      goto LABEL_79;
    }
    if ( !(_BYTE)v42 )
      goto LABEL_63;
    v44 = *(_BYTE *)v39;
    if ( v44 == 7 )
    {
      if ( v42 >= 0x1F || v42 <= 2 )
      {
        if ( !IO80211PeerManager::shouldLog(*((IO80211PeerManager **)v93 + 5), 0x40000000LL) )
          goto LABEL_81;
        v64 = (IO80211PeerManager *)*((_QWORD *)v93 + 5);
        LODWORD(v67) = (*(int (__fastcall **)(IO80211Peer *, signed __int64))(*(_QWORD *)v93 + 56LL))(v93, 0x40000000LL);
        v59 = OSMetaClass::getClassName(v67);
        v60 = "%s::%s wrong ht cap len %u \n";
LABEL_79:
        v61 = (__int64)"awdlLllcInput";
        v62 = v64;
        v63 = v42;
LABEL_80:
        IO80211PeerManager::logDebug(v62, 0x40000000LL, v60, v59, v61, v63);
        goto LABEL_81;
      }
      v17 = v39 + 4;
      if ( (signed int)IO80211Peer::parseHTCapTLV(v93, (unsigned __int8 *)(v39 + 4), v42 - 2) > 0 )
      {
        v17 = 0x200000000LL;
        if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)v93 + 5), 0x200000000LL) )
        {
          LOBYTE(v96) = 0;
          HIDWORD(v96) = 0;
          LODWORD(v97) = 0;
          v98 = v82;
          v99 = (signed int)v82;
          v100 = 0;
          v108 = 0LL;
          v107 = 0LL;
          v106 = 0LL;
          v105 = 0LL;
          v104 = 0LL;
          v103 = 0LL;
          v102 = 0LL;
          v101 = 0LL;
          v50 = 0LL;
          v51 = 0;
          if ( *((_QWORD *)v93 + 5) )
          {
            v52 = IO80211PeerManager::shouldVerboseLog(*((IO80211PeerManager **)v93 + 5), 0x200000000LL);
            v50 = *((_QWORD *)v93 + 5);
            if ( v52 )
            {
              v51 = *(_DWORD *)(v50 + 432);
            }
            else
            {
              v51 = *(_DWORD *)(v50 + 424);
              if ( !*(_DWORD *)(v50 + 424) )
              {
                v51 = getLengthBeforeSensitivePayload(0, v98);
                v50 = *((_QWORD *)v93 + 5);
              }
            }
          }
          HIDWORD(v96) = v51;
          v17 = 0x200000000LL;
          IO80211PeerManager::dumpPacket(v50, 0x200000000LL, "new", (__int64)&v96);
        }
        if ( *(_DWORD *)(*((_QWORD *)v93 + 5) + 756LL) )
          *((_BYTE *)v93 + 476) = 1;
      }
      goto LABEL_62;
    }
    if ( v44 == 14 )
    {
      if ( v42 >= 0x41 || v42 <= 2 )
      {
        if ( !IO80211PeerManager::shouldLog(*((IO80211PeerManager **)v93 + 5), 0x40000000LL) )
          goto LABEL_81;
        v64 = (IO80211PeerManager *)*((_QWORD *)v93 + 5);
        LODWORD(v66) = (*(int (__fastcall **)(IO80211Peer *, signed __int64))(*(_QWORD *)v93 + 56LL))(v93, 0x40000000LL);
        v59 = OSMetaClass::getClassName(v66);
        v60 = "%s::%s wrong dbg tlv len %u \n";
        goto LABEL_79;
      }
      v45 = _byteswap_ulong(*(_DWORD *)(v39 + 8));
      *(_DWORD *)(v91 + 52) = v45;
      if ( v45 <= 0x3FFFFFF )
      {
        v80 = v45 >> 24;
        v46 = _byteswap_ulong(*(_DWORD *)(v39 + 20));
        *((_DWORD *)v93 + v80 + 325) = v45 & 0xFFFFFF;
        v47 = ((2361183241434822607LL * ((unsigned __int64)getAbsoluteTime() >> 3) >> 64 >> 4) & 0xFFFFFFFF) - v46;
        v48 = *((_QWORD *)v93 + 167);
        if ( !v48 || (signed __int64)v48 > (signed __int64)v47 )
        {
          *((_QWORD *)v93 + 167) = v47;
          v48 = v47;
        }
        if ( v48 )
        {
          *(_QWORD *)(v91 + 40) = v48;
          v49 = v47 - v48;
          *(_DWORD *)(v91 + 48) = v49;
          v17 = (signed __int64)v93;
          if ( v49 > *((_DWORD *)v93 + v80 + 337) )
          {
            *((_DWORD *)v93 + v80 + 337) = v49;
            v49 = *(_DWORD *)(v91 + 48);
          }
          *((_QWORD *)v93 + v80 + 171) += v49;
          ++*((_DWORD *)v93 + v80 + 350);
        }
      }
      goto LABEL_62;
    }
    if ( v44 != 12 )
    {
      v54 = (IO80211PeerManager *)*((_QWORD *)v93 + 5);
      LODWORD(v55) = (*(int (__fastcall **)(IO80211Peer *, signed __int64))(*(_QWORD *)v93 + 56LL))(v93, v17);
      v56 = OSMetaClass::getClassName(v55);
      v17 = 0x40000000LL;
      IO80211PeerManager::logDebug(
        v54,
        0x40000000LL,
        "%s::%s invalid TLV in snap header type %u skip\n",
        v56,
        (__int64)"awdlLllcInput",
        v44);
      *(_DWORD *)(v91 + 20) = 4;
      goto LABEL_62;
    }
    if ( v42 <= 1 )
    {
      if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)v93 + 5), 0x40000000LL) )
      {
        v68 = (IO80211PeerManager *)*((_QWORD *)v93 + 5);
        LODWORD(v69) = (*(int (__fastcall **)(IO80211Peer *, signed __int64))(*(_QWORD *)v93 + 56LL))(v93, 0x40000000LL);
        v70 = OSMetaClass::getClassName(v69);
        IO80211PeerManager::logDebug(
          v68,
          0x40000000LL,
          "%s::%s wrong dp state len %u \n",
          v70,
          (__int64)"awdlLllcInput",
          v42);
      }
      memset((char *)v93 + 1462, 0, 0x20uLL);
      *((_BYTE *)v93 + 1457) = 0;
      goto LABEL_81;
    }
    v17 = v39 + 2;
    v53 = IO80211AWDLPeer::parseAwdlDataPathTLV(v93, (unsigned __int8 *)(v39 + 2), *(_BYTE *)(v39 + 1), &v94, "LLC");
    if ( v53 )
      break;
LABEL_62:
    v39 += v43;
    --v40;
    v41 = v86 - 28;
    if ( !v40 )
      goto LABEL_63;
  }
  if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)v93 + 5), 0x40000000LL) )
  {
    v71 = (IO80211PeerManager *)*((_QWORD *)v93 + 5);
    LODWORD(v72) = (*(int (__fastcall **)(IO80211Peer *, signed __int64))(*(_QWORD *)v93 + 56LL))(v93, 0x40000000LL);
    v59 = OSMetaClass::getClassName(v72);
    v60 = "%s::%s error parsing data path state %d\n";
    v61 = (__int64)"awdlLllcInput";
    v62 = v71;
    v63 = v53;
    goto LABEL_80;
  }
LABEL_81:
  *(_DWORD *)(v91 + 20) = 4;
LABEL_82:
  v13 = off_7B078[0];
  v12 = 0;
LABEL_100:
  v78 = *(_QWORD *)v13;
  if ( *(_QWORD *)v13 == v109 )
    LOBYTE(v78) = v12;
  return v78;
}
// 690F5: using guessed type char byte_690F5;
// 7B078: using guessed type __int64 off_7B078[7];
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);

//----- (0000000000022FCC) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::inputPacket(__int64 a1, __mbuf *a2, __int64 a3)
{
  __int64 v3; // r15@1
  int v4; // eax@2
  __int64 v5; // rax@4
  __int64 v6; // r13@4
  unsigned int v7; // eax@10
  char v8; // bl@11
  __int64 v9; // rax@11
  __int64 result; // rax@14
  unsigned int v11; // [sp+0h] [bp-2Ch]@4

  v3 = a3;
  if ( *(_BYTE *)(a3 + 28) )
    goto LABEL_20;
  v4 = *(_BYTE *)(a1 + 1278);
  if ( !(v4 & 2) )
  {
    *(_DWORD *)(a3 + 20) = 9;
    *(_DWORD *)(a3 + 24) = v4;
    return 0LL;
  }
  if ( *(_BYTE *)(a1 + 1279) )
  {
LABEL_20:
    LODWORD(v5) = mbuf_data(a2);
    v6 = v5;
    LOBYTE(v5) = 1;
    v11 = v5;
    if ( *(_BYTE *)(v6 + 14) == 170
      && *(_BYTE *)(v6 + 15) == 170
      && *(_BYTE *)(v6 + 16) == 3
      && !*(_BYTE *)(v6 + 17)
      && *(_BYTE *)(v6 + 18) == 23
      && *(_BYTE *)(v6 + 19) == 242 )
    {
      LOBYTE(v7) = IO80211AWDLPeer::awdlLllcInput(a1, a2, v3);
      v11 = v7;
    }
    *(_BYTE *)(v3 + 17) = *(_DWORD *)(a1 + 1448) == 0;
    v8 = *(_BYTE *)v6;
    v9 = getAbsoluteTime();
    if ( v8 & 1 )
    {
      *(_QWORD *)(a1 + 136) = v9;
      *(_QWORD *)(*(_QWORD *)(a1 + 40) + 1008LL) = v9;
    }
    else
    {
      *(_QWORD *)(a1 + 128) = v9;
      *(_QWORD *)(*(_QWORD *)(a1 + 40) + 1000LL) = v9;
    }
    ((void (__fastcall *)(__int64, __mbuf *, __int64))`vtable for'IO80211Peer[43])(a1, a2, v3);
    result = v11;
  }
  else
  {
    *(_DWORD *)(a3 + 20) = 10;
    result = 0LL;
  }
  return result;
}
// 7D300: using guessed type __int64 `vtable for'IO80211Peer[2];
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);

//----- (00000000000230F4) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeer::MetaClass::~MetaClass(IO80211AWDLPeer::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000023100) ----------------------------------------------------
__int64 `global constructor keyed to'_a_6()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IO80211AWDLPeer::gMetaClass, "IO80211AWDLPeer", &IO80211Peer::gMetaClass, 1896LL);
  result = (__int64)off_7CC40;
  IO80211AWDLPeer::gMetaClass = off_7CC40;
  return result;
}
// 7CC40: using guessed type __int64 (__fastcall *off_7CC40[2])(IO80211AWDLPeer::MetaClass *__hidden this);
// 84408: using guessed type _QWORD IO80211AWDLPeer::gMetaClass;
// 84458: using guessed type _QWORD IO80211Peer::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000023140) ----------------------------------------------------
__int64 `global destructor keyed to'_a_6()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211AWDLPeer::gMetaClass);
}
// 84408: using guessed type _QWORD IO80211AWDLPeer::gMetaClass;

//----- (0000000000023160) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::MetaClass::MetaClass(IO80211AWDLPeerManager::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211AWDLPeerManager", &IO80211PeerManager::gMetaClass, 8512LL);
  result = (__int64)off_7D020;
  *(_QWORD *)this = off_7D020;
  return result;
}
// 7D020: using guessed type __int64 (__fastcall *off_7D020[2])(IO80211AWDLPeerManager::MetaClass *__hidden this);
// 84480: using guessed type _QWORD IO80211PeerManager::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000023192) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::MetaClass::~MetaClass(IO80211AWDLPeerManager::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000002319C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::IO80211AWDLPeerManager(__int64 a1)
{
  __int64 result; // rax@1

  IO80211PeerManager::IO80211PeerManager(a1);
  result = (__int64)off_7CDE0;
  *(_QWORD *)a1 = off_7CDE0;
  *(_DWORD *)(a1 + 7444) = 10;
  return result;
}
// 7CDE0: using guessed type __int64 (__fastcall *off_7CDE0[2])(IO80211AWDLPeerManager *__hidden this);

//----- (00000000000231C6) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::IO80211AWDLPeerManager(__int64 a1)
{
  __int64 result; // rax@1

  IO80211PeerManager::IO80211PeerManager(a1);
  result = (__int64)off_7CDE0;
  *(_QWORD *)a1 = off_7CDE0;
  *(_DWORD *)(a1 + 7444) = 10;
  return result;
}
// 7CDE0: using guessed type __int64 (__fastcall *off_7CDE0[2])(IO80211AWDLPeerManager *__hidden this);

//----- (00000000000231F0) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::~IO80211AWDLPeerManager(IO80211AWDLPeerManager *this)
{
  return IO80211PeerManager::~IO80211PeerManager(this);
}

//----- (00000000000231FA) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::~IO80211AWDLPeerManager(IO80211AWDLPeerManager *this)
{
  return IO80211PeerManager::~IO80211PeerManager(this);
}

//----- (0000000000023204) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::~IO80211AWDLPeerManager(IO80211AWDLPeerManager *this)
{
  IO80211PeerManager::~IO80211PeerManager(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000023226) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getMetaClass(IO80211AWDLPeerManager *this)
{
  return (__int64)&IO80211AWDLPeerManager::gMetaClass;
}
// 84430: using guessed type _QWORD IO80211AWDLPeerManager::gMetaClass;

//----- (0000000000023234) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::MetaClass::MetaClass(IO80211AWDLPeerManager::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211AWDLPeerManager", &IO80211PeerManager::gMetaClass, 8512LL);
  result = (__int64)off_7D020;
  *(_QWORD *)this = off_7D020;
  return result;
}
// 7D020: using guessed type __int64 (__fastcall *off_7D020[2])(IO80211AWDLPeerManager::MetaClass *__hidden this);
// 84480: using guessed type _QWORD IO80211PeerManager::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000023266) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::MetaClass::alloc(IO80211AWDLPeerManager::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)((char *)&loc_213D + 3), a2);
  IO80211PeerManager::IO80211PeerManager(v2);
  *(_QWORD *)v2 = off_7CDE0;
  *(_DWORD *)(v2 + 7444) = 10;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211AWDLPeerManager::gMetaClass);
  return v2;
}
// 7CDE0: using guessed type __int64 (__fastcall *off_7CDE0[2])(IO80211AWDLPeerManager *__hidden this);
// 84430: using guessed type _QWORD IO80211AWDLPeerManager::gMetaClass;

//----- (00000000000232B0) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::IO80211AWDLPeerManager(__int64 a1)
{
  IO80211PeerManager::IO80211PeerManager(a1);
  *(_QWORD *)a1 = off_7CDE0;
  *(_DWORD *)(a1 + 7444) = 10;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211AWDLPeerManager::gMetaClass);
}
// 7CDE0: using guessed type __int64 (__fastcall *off_7CDE0[2])(IO80211AWDLPeerManager *__hidden this);
// 84430: using guessed type _QWORD IO80211AWDLPeerManager::gMetaClass;

//----- (00000000000232EA) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::IO80211AWDLPeerManager(__int64 a1)
{
  IO80211PeerManager::IO80211PeerManager(a1);
  *(_QWORD *)a1 = off_7CDE0;
  *(_DWORD *)(a1 + 7444) = 10;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211AWDLPeerManager::gMetaClass);
}
// 7CDE0: using guessed type __int64 (__fastcall *off_7CDE0[2])(IO80211AWDLPeerManager *__hidden this);
// 84430: using guessed type _QWORD IO80211AWDLPeerManager::gMetaClass;

//----- (0000000000023324) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::withInterface(IO80211AWDLPeerManager *this, IO80211VirtualInterface *a2, ether_addr *a3, ether_addr *a4)
{
  ether_addr *v4; // r14@1
  __int64 v5; // rbx@1

  v4 = a3;
  v5 = OSObject::operator new((OSObject *)((char *)&loc_213D + 3), (unsigned __int64)a2);
  IO80211PeerManager::IO80211PeerManager(v5);
  *(_QWORD *)v5 = off_7CDE0;
  *(_DWORD *)(v5 + 7444) = 10;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211AWDLPeerManager::gMetaClass);
  if ( v5 && !IO80211AWDLPeerManager::initWithInterface((IO80211AWDLPeerManager *)v5, this, a2, v4) )
  {
    (*(void (__fastcall **)(__int64, IO80211AWDLPeerManager *))(*(_QWORD *)v5 + 40LL))(v5, this);
    v5 = 0LL;
  }
  return v5;
}
// 7CDE0: using guessed type __int64 (__fastcall *off_7CDE0[2])(IO80211AWDLPeerManager *__hidden this);
// 84430: using guessed type _QWORD IO80211AWDLPeerManager::gMetaClass;

//----- (00000000000233AE) ----------------------------------------------------
char __fastcall IO80211AWDLPeerManager::initWithInterface(IO80211AWDLPeerManager *this, IO80211VirtualInterface *a2, IO80211Interface *a3, ether_addr *a4)
{
  ether_addr *v4; // r14@1
  IO80211AWDLPeerManager *v5; // rbx@1
  OSMetaClass *v6; // rax@3
  __int64 v7; // rax@3
  __int64 v8; // r8@3
  __int64 v9; // r9@3
  OSMetaClass *v10; // rax@6
  __int64 v11; // rax@6
  __int64 v12; // r8@6
  __int64 v13; // r9@6
  OSMetaClass *v14; // rax@10
  __int64 v15; // rax@10
  __int64 v16; // r8@10
  __int64 v17; // r9@10
  int v18; // ecx@11
  int v19; // eax@11
  OSMetaClass *v20; // rax@12
  __int64 v21; // rax@12
  __int64 v22; // r8@12
  __int64 v23; // r9@12
  __int64 v24; // rax@14
  OSMetaClass *v25; // rax@14
  __int64 v26; // rax@14
  __int64 v27; // r8@14
  __int64 v28; // r9@14
  OSMetaClass *v29; // rax@16
  __int64 v30; // rax@16
  __int64 v31; // r8@16
  __int64 v32; // r9@16
  OSMetaClass *v33; // rax@18
  __int64 v34; // rax@18
  __int64 v35; // r8@18
  __int64 v36; // r9@18
  OSMetaClass *v37; // rax@20
  __int64 v38; // rax@20
  __int64 v39; // r8@20
  __int64 v40; // r9@20
  OSMetaClass *v41; // rax@22
  __int64 v42; // rax@22
  __int64 v43; // r8@22
  __int64 v44; // r9@22
  OSMetaClass *v45; // rax@24
  __int64 v46; // rax@24
  __int64 v47; // r8@24
  __int64 v48; // r9@24
  OSMetaClass *v49; // rax@26
  __int64 v50; // rax@26
  __int64 v51; // r8@26
  __int64 v52; // r9@26
  OSMetaClass *v53; // rax@28
  __int64 v54; // rax@28
  __int64 v55; // r8@28
  __int64 v56; // r9@28
  unsigned __int64 v57; // rsi@30
  OSMetaClass *v58; // rax@30
  __int64 v59; // rax@30
  __int64 v60; // r8@30
  __int64 v61; // r9@30
  unsigned __int64 v62; // rsi@32
  OSMetaClass *v63; // rax@32
  __int64 v64; // rax@32
  __int64 v65; // r8@32
  __int64 v66; // r9@32
  unsigned __int64 *v67; // rsi@33
  OSMetaClass *v68; // rax@35
  __int64 v69; // rax@35
  int v70; // ST20_4@35
  int v71; // ST18_4@35
  int v72; // ST10_4@35
  int v73; // ST08_4@35
  __int64 v74; // rax@35
  __int64 v75; // rax@36
  __int64 v76; // rax@37
  __int64 v77; // rax@38
  IO80211AWDLPeerManager *v78; // rax@40
  __int64 v79; // rax@40
  __int64 v80; // rax@41
  __int64 v81; // rax@41
  __int64 v82; // rax@41
  __int64 v83; // rax@41
  __int64 v84; // rax@41
  __int64 v85; // rax@41
  __int64 v86; // rax@41
  IO80211AWDLPeerManager *v87; // rax@41
  IO80211CommandQueue *v88; // rax@43
  IO80211CommandQueue *v89; // rax@45
  OSMetaClass *v90; // rax@46
  __int64 v91; // rax@46
  __int64 v92; // r8@46
  __int64 v93; // r9@46
  IO80211AWDLPeerManager *v94; // rax@48
  __int64 v95; // rax@51
  IO80211CommandQueue *v96; // rax@54
  IO80211CommandQueue *v97; // rax@56
  IO80211CommandQueue *v98; // rax@58
  __int64 v99; // r8@59
  __int64 v100; // r9@59
  __int64 v101; // rcx@60
  __int64 v102; // r8@61
  __int64 v103; // r9@61
  unsigned int v104; // eax@62
  __int64 v105; // rcx@63
  char v106; // r14@64
  OSMetaClass *v107; // rax@65
  __int64 v108; // rdx@65
  __int64 v109; // r8@65
  __int64 v110; // r9@65
  const char *v111; // rsi@65
  OSMetaClass *v112; // rax@66
  OSMetaClass *v113; // rax@67
  OSMetaClass *v114; // rax@68
  OSMetaClass *v115; // rax@69
  unsigned int v117; // edx@73
  OSMetaClass *v118; // rax@77
  __int64 v119; // rax@77
  __int64 v120; // r9@77
  OSMetaClass *v121; // rax@78
  __int64 v122; // rdx@78
  __int64 v123; // r8@78
  __int64 v124; // r9@78
  const char *v125; // rsi@78
  OSMetaClass *v126; // rax@79
  OSMetaClass *v127; // rax@80
  __int16 v128; // [sp+2Ch] [bp-34h]@76
  char v129; // [sp+2Eh] [bp-32h]@76
  unsigned __int64 v130; // [sp+30h] [bp-30h]@29
  unsigned int v131; // [sp+3Ch] [bp-24h]@21
  unsigned int v132; // [sp+40h] [bp-20h]@7
  unsigned int v133; // [sp+44h] [bp-1Ch]@2

  v4 = a4;
  v5 = this;
  *((_DWORD *)this + 98) = 128;
  if ( !IO80211PeerManager::initWithInterface(this, a2, a3) )
    return 0;
  *((_DWORD *)this + 1851) = 1;
  *((_DWORD *)this + 259) = 1;
  *((_DWORD *)this + 1885) = 1;
  v133 = 0;
  if ( PE_parse_boot_argn("awdl_enable", &v133, 4LL) )
  {
    *((_DWORD *)this + 1885) = 0;
    LODWORD(v6) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v133);
    v7 = OSMetaClass::getClassName(v6);
    IOLog("%s::%s bootarg override _mdns_trigger -> %u\n", v7, "initWithInterface", *((_DWORD *)this + 1885), v8, v9);
  }
  if ( PE_parse_boot_argn("awdl_oper_mode", &v133, 4LL) && v133 == 1 )
  {
    *((_DWORD *)this + 259) = 3;
    *((_DWORD *)this + 1885) = 0;
    *((_DWORD *)this + 996) = 0;
    LODWORD(v10) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, unsigned int *))(*(_QWORD *)this + 56LL))(
                     this,
                     &v133);
    v11 = OSMetaClass::getClassName(v10);
    IOLog("%s::%s bootarg override _mdns_trigger -> %u\n", v11, "initWithInterface", *((_DWORD *)this + 1885), v12, v13);
  }
  v132 = 2;
  if ( PE_parse_boot_argn("awdl_slow", &v132, 4LL) )
  {
    if ( !v132 )
      v132 = 1;
    LODWORD(v14) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v132);
    v15 = OSMetaClass::getClassName(v14);
    IOLog("%s::%s bootarg override awdl_slow %u \n", v15, "initWithInterface", v132, v16, v17);
  }
  v18 = 180 * v132;
  v19 = 16 * v132;
  *((_DWORD *)this + 997) = 16 * v132;
  *((_DWORD *)this + 998) = v19 - 1;
  *((_DWORD *)this + 901) = v18;
  *((_DWORD *)this + 902) = v18;
  *((_DWORD *)this + 259) = 1;
  if ( PE_parse_boot_argn("awdl_infra_switch", &v133, 4LL) )
  {
    *((_DWORD *)this + 1883) = v133;
    LODWORD(v20) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, unsigned int *))(*(_QWORD *)this + 56LL))(
                     this,
                     &v133);
    v21 = OSMetaClass::getClassName(v20);
    IOLog(
      "%s::%s bootarg override _awdl_infra_interface_switching -> %u\n",
      v21,
      "initWithInterface",
      *((_DWORD *)this + 1883),
      v22,
      v23);
  }
  if ( PE_parse_boot_argn("infra_awdl_switch", &v133, 4LL) )
  {
    v24 = IO80211PeerManager::getController(this);
    *(_BYTE *)(v24 + 312) = v133 != 0;
    LODWORD(v25) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, unsigned int *))(*(_QWORD *)this + 56LL))(
                     this,
                     &v133);
    v26 = OSMetaClass::getClassName(v25);
    IOLog("%s::%s bootarg override infra->awdl redirect -> %u\n", v26, "initWithInterface", v133, v27, v28);
  }
  if ( PE_parse_boot_argn("enable_forced_roam", &v133, 4LL) )
  {
    *((_DWORD *)this + 1887) = v133;
    LODWORD(v29) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, unsigned int *))(*(_QWORD *)this + 56LL))(
                     this,
                     &v133);
    v30 = OSMetaClass::getClassName(v29);
    IOLog(
      "%s::%s bootarg override _enable_force_roam -> %u\n",
      v30,
      "initWithInterface",
      *((_DWORD *)this + 1887),
      v31,
      v32);
  }
  if ( PE_parse_boot_argn("awdl_insert_debug_tlv", &v133, 4LL) )
  {
    *((_DWORD *)this + 1008) = v133;
    LODWORD(v33) = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 56LL))(this, &v133);
    v34 = OSMetaClass::getClassName(v33);
    IOLog(
      "%s::%s bootarg override _insert_debug_tlv -> %u\n",
      v34,
      "initWithInterface",
      *((_DWORD *)this + 1008),
      v35,
      v36);
  }
  if ( PE_parse_boot_argn("_discard_airplay_records", &v133, 4LL) )
  {
    *((_DWORD *)this + 908) = v133;
    LODWORD(v37) = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 56LL))(this, &v133);
    v38 = OSMetaClass::getClassName(v37);
    IOLog(
      "%s::%s bootarg override _discard_airplay_records -> %u\n",
      v38,
      "initWithInterface",
      *((_DWORD *)this + 908),
      v39,
      v40);
  }
  v131 = 3;
  if ( PE_parse_boot_argn("awdl_mdns_mode", &v131, 4LL) )
  {
    LODWORD(v41) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v131);
    v42 = OSMetaClass::getClassName(v41);
    IOLog("%s::%s bootarg set mdns_mode -> %u\n", v42, "initWithInterface", v131, v43, v44);
  }
  *((_DWORD *)this + 947) = (v131 >> 1) & 1;
  if ( PE_parse_boot_argn("awdl_bonjour_offload", &v133, 4LL) )
  {
    *((_DWORD *)this + 947) = v133 != 0;
    LODWORD(v45) = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 56LL))(this, &v133);
    v46 = OSMetaClass::getClassName(v45);
    IOLog(
      "%s::%s bootarg set awdl_bonjour_offload -> %u\n",
      v46,
      "initWithInterface",
      *((_DWORD *)this + 947),
      v47,
      v48);
  }
  *((_DWORD *)this + 946) = (v131 >> 1) & 1;
  if ( PE_parse_boot_argn("awdl_mdns_direct_path", &v133, 4LL) )
  {
    *((_DWORD *)this + 946) = v133 != 0;
    LODWORD(v49) = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 56LL))(this, &v133);
    v50 = OSMetaClass::getClassName(v49);
    IOLog("%s::%s bootarg set _mdns_direct_path -> %u\n", v50, "initWithInterface", *((_DWORD *)this + 946), v51, v52);
  }
  *((_DWORD *)this + 123) = ~(_BYTE)v131 & 1;
  if ( PE_parse_boot_argn("awdl_block_mdns", &v133, 4LL) )
  {
    *((_DWORD *)this + 123) = v133 != 0;
    LODWORD(v53) = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 56LL))(this, &v133);
    v54 = OSMetaClass::getClassName(v53);
    IOLog("%s::%s bootarg set _block_mdns -> %u\n", v54, "initWithInterface", *((_DWORD *)this + 123), v55, v56);
  }
  v130 = 0LL;
  if ( PE_parse_boot_argn("awdl_log_flags", &v130, 8LL) )
  {
    v57 = v130;
    IO80211PeerManager::setPeerManagerLogFlags(this);
    LODWORD(v58) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, unsigned __int64))(*(_QWORD *)this + 56LL))(
                     this,
                     v57);
    v59 = OSMetaClass::getClassName(v58);
    IOLog("%s::%s bootarg set _logFlags -> 0x%llx\n", v59, "initWithInterface", v130, v60, v61);
  }
  if ( PE_parse_boot_argn("awdl_log_flags_verbose", &v130, 8LL) )
  {
    v62 = v130;
    IO80211PeerManager::setPeerManagerVerboseLogFlags(this, v130);
    LODWORD(v63) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, unsigned __int64))(*(_QWORD *)this + 56LL))(
                     this,
                     v62);
    v64 = OSMetaClass::getClassName(v63);
    IOLog("%s::%s bootarg set _logFlags _verbose -> 0x%llx\n", v64, "initWithInterface", v130, v65, v66);
  }
  v67 = &v130;
  if ( PE_parse_boot_argn("awdl_log_flags_config", &v130, 8LL) )
  {
    IO80211PeerManager::setPeerManagerVerboseLogFlags(this, 146042519584LL);
    v67 = (unsigned __int64 *)13631520;
    IO80211PeerManager::setPeerManagerLogFlags(this);
  }
  LODWORD(v68) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, unsigned __int64 *))(*(_QWORD *)this + 56LL))(
                   this,
                   v67);
  v69 = OSMetaClass::getClassName(v68);
  v70 = v4->octet[5];
  v71 = v4->octet[4];
  v72 = v4->octet[3];
  v73 = v4->octet[2];
  IO80211PeerManager::logDebug(
    this,
    0x2000000000LL,
    "%s::%s AWDL init with [%02X:%02X:%02X:%02X:%02X:%02X]\n",
    v69,
    (__int64)"initWithInterface",
    v4->octet[0]);
  memcpy((char *)this + 3680, v4, 6uLL);
  LODWORD(v74) = IOTimerEventSource::timerEventSource(this, IO80211AWDLPeerManager::handleServiceTimer);
  *((_QWORD *)this + 615) = v74;
  if ( !v74 )
  {
    LODWORD(v107) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64 (__fastcall *)(IO80211AWDLPeerManager *)))(*(_QWORD *)this + 56LL))(
                      this,
                      IO80211AWDLPeerManager::handleServiceTimer);
    v108 = OSMetaClass::getClassName(v107);
    v111 = "%s::%s  Unable to instantiate service timer\n";
LABEL_70:
    v106 = 0;
    IO80211PeerManager::logDebug(v5, v111, v108, (__int64)"initWithInterface", v109, v110);
    return v106;
  }
  LODWORD(v75) = IOTimerEventSource::timerEventSource(this, IO80211AWDLPeerManager::handleInfraRequestTimer);
  *((_QWORD *)this + 616) = v75;
  if ( !v75 )
  {
    LODWORD(v112) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, void (__fastcall *)(IO80211PeerManager *)))(*(_QWORD *)this + 56LL))(
                      this,
                      IO80211AWDLPeerManager::handleInfraRequestTimer);
    v108 = OSMetaClass::getClassName(v112);
    v111 = "%s::%s  Unable to instantiate fInfraRequestTimer timer\n";
    goto LABEL_70;
  }
  LODWORD(v76) = IOTimerEventSource::timerEventSource(this, IO80211AWDLPeerManager::handleAwServiceTimer);
  *((_QWORD *)this + 617) = v76;
  if ( !v76 )
  {
    LODWORD(v113) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, void (*)()))(*(_QWORD *)this + 56LL))(
                      this,
                      IO80211AWDLPeerManager::handleAwServiceTimer);
    v108 = OSMetaClass::getClassName(v113);
    v111 = "%s::%s  Unable to instantiate aw service timer\n";
    goto LABEL_70;
  }
  LODWORD(v77) = IOTimerEventSource::timerEventSource(this, IO80211AWDLPeerManager::handleMasterIndicationTimer);
  *((_QWORD *)this + 618) = v77;
  if ( !v77 )
  {
    LODWORD(v114) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, void (__fastcall *)(IO80211AWDLPeerManager *)))(*(_QWORD *)this + 56LL))(
                      this,
                      IO80211AWDLPeerManager::handleMasterIndicationTimer);
    v108 = OSMetaClass::getClassName(v114);
    v111 = "%s::%s  Unable to instantiate master indication timer\n";
    goto LABEL_70;
  }
  if ( IO80211PeerManager::getController(this) )
  {
    v78 = (IO80211AWDLPeerManager *)IO80211PeerManager::getController(this);
    this = v78;
    LODWORD(v79) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, void (__fastcall *)(IO80211AWDLPeerManager *)))(*(_QWORD *)v78 + 1672LL))(
                     v78,
                     IO80211AWDLPeerManager::handleMasterIndicationTimer);
    if ( v79 )
    {
      v80 = IO80211PeerManager::getController(v5);
      LODWORD(v81) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v80 + 1672LL))(v80);
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v81 + 320LL))(v81, *((_QWORD *)v5 + 615));
      v82 = IO80211PeerManager::getController(v5);
      LODWORD(v83) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v82 + 1672LL))(v82);
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v83 + 320LL))(v83, *((_QWORD *)v5 + 617));
      v84 = IO80211PeerManager::getController(v5);
      LODWORD(v85) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v84 + 1672LL))(v84);
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v85 + 320LL))(v85, *((_QWORD *)v5 + 618));
      v86 = IO80211PeerManager::getController(v5);
      LODWORD(v87) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v86 + 1672LL))(v86);
      this = v87;
      (*(void (__fastcall **)(IO80211AWDLPeerManager *, _QWORD))(*(_QWORD *)v87 + 320LL))(v87, *((_QWORD *)v5 + 616));
    }
  }
  if ( !*((_QWORD *)v5 + 477) )
  {
    this = (IO80211AWDLPeerManager *)*((_QWORD *)v5 + 8);
    v88 = IO80211CommandQueue::withGateAndCapacity(this, (IOCommandGate *)&stru_68.segname[8], 1);
    *((_QWORD *)v5 + 477) = v88;
    if ( !v88 )
    {
      LODWORD(v115) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)v5 + 56LL))(
                        v5,
                        128LL);
      v108 = OSMetaClass::getClassName(v115);
      v111 = "%s::%s can't allocate _oobFrames list\n";
      goto LABEL_70;
    }
  }
  if ( !*((_QWORD *)v5 + 478) )
  {
    this = (IO80211AWDLPeerManager *)*((_QWORD *)v5 + 8);
    v89 = IO80211CommandQueue::withGateAndCapacity(this, (IOCommandGate *)&stru_68.segname[8], 1);
    *((_QWORD *)v5 + 478) = v89;
    if ( !v89 )
    {
      LODWORD(v90) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)v5 + 56LL))(v5, 128LL);
      v91 = OSMetaClass::getClassName(v90);
      this = v5;
      IO80211PeerManager::logDebug(
        v5,
        "%s::%s can't allocate _oobFrames list\n",
        v91,
        (__int64)"initWithInterface",
        v92,
        v93);
    }
  }
  *((_DWORD *)v5 + 1888) = 0;
  if ( !*((_QWORD *)v5 + 484) )
  {
    LODWORD(v94) = IOSimpleLockAlloc(this);
    *((_QWORD *)v5 + 484) = v94;
    if ( !v94 )
      return 0;
    this = v94;
    IOSimpleLockInit(v94);
  }
  if ( !*((_QWORD *)v5 + 485) )
  {
    LODWORD(v95) = IOLockAlloc(this);
    *((_QWORD *)v5 + 485) = v95;
    if ( v95 )
    {
      IOLockInitWithState(v95, 0LL);
      goto LABEL_53;
    }
    return 0;
  }
LABEL_53:
  if ( !*((_QWORD *)v5 + 476) )
  {
    v96 = IO80211CommandQueue::withGateAndCapacity(
            *((IO80211CommandQueue **)v5 + 8),
            (IOCommandGate *)&stru_68.segname[8],
            256);
    *((_QWORD *)v5 + 476) = v96;
    if ( !v96 )
    {
      LODWORD(v121) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)v5 + 56LL))(
                        v5,
                        128LL);
      v122 = OSMetaClass::getClassName(v121);
      v125 = "%s::%s can't allocate _serviceRequests list\n";
LABEL_81:
      IO80211PeerManager::logDebug(v5, v125, v122, (__int64)"initWithInterface", v123, v124);
      return 1;
    }
  }
  if ( !*((_QWORD *)v5 + 475) )
  {
    v97 = IO80211CommandQueue::withGateAndCapacity(
            *((IO80211CommandQueue **)v5 + 8),
            (IOCommandGate *)&stru_68.segname[8],
            1);
    *((_QWORD *)v5 + 475) = v97;
    if ( !v97 )
    {
      LODWORD(v126) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)v5 + 56LL))(
                        v5,
                        128LL);
      v122 = OSMetaClass::getClassName(v126);
      v125 = "%s::%s can't allocate _serviceResponsesReceiving list\n";
      goto LABEL_81;
    }
  }
  if ( !*((_QWORD *)v5 + 515) )
  {
    v98 = IO80211CommandQueue::withGateAndCapacity(
            *((IO80211CommandQueue **)v5 + 8),
            (IOCommandGate *)&stru_68.segname[8],
            256);
    *((_QWORD *)v5 + 515) = v98;
    if ( !v98 )
    {
      LODWORD(v127) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)v5 + 56LL))(
                        v5,
                        128LL);
      v122 = OSMetaClass::getClassName(v127);
      v125 = "%s::%s can't allocate _infraPeerList list\n";
      goto LABEL_81;
    }
  }
  *((_DWORD *)v5 + 2030) = 0;
  v133 = 0;
  if ( PE_parse_boot_argn("awdl_allow_40", &v133, 4LL) )
  {
    v101 = v133 == 0;
    *((_DWORD *)v5 + 2030) = v101;
    IO80211PeerManager::logDebug(
      v5,
      "%s: boot-args awdl_allow_40: max_bw: %d \n",
      (__int64)"initWithInterface",
      v101,
      v99,
      v100);
  }
  v133 = 0;
  if ( PE_parse_boot_argn("awdl_max_bw", &v133, 4LL) )
  {
    *((_DWORD *)v5 + 2030) = 0;
    v104 = v133;
    if ( v133 < 0x51 )
    {
      v105 = 0LL;
      if ( v133 >= 0x14 )
      {
        do
        {
          v117 = v104;
          v104 >>= 1;
          v105 = (unsigned int)(v105 + 1);
        }
        while ( v117 > 0x27 );
        v133 = v104;
        *((_DWORD *)v5 + 2030) = v105;
      }
    }
    else
    {
      v133 = 0;
      v105 = 0LL;
    }
    IO80211PeerManager::logDebug(
      v5,
      "%s: boot-args awdl_max_bw: max_bw: %d \n",
      (__int64)"initWithInterface",
      v105,
      v102,
      v103);
  }
  v129 = 0;
  v128 = 0;
  v106 = 1;
  if ( PE_parse_boot_argn("forcecountry", &v128, 3LL) )
  {
    memcpy((char *)v5 + 7383, &v128, 3uLL);
    LODWORD(v118) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int16 *))(*(_QWORD *)v5 + 56LL))(v5, &v128);
    v119 = OSMetaClass::getClassName(v118);
    IO80211PeerManager::logDebug(
      v5,
      "%s::%s forcing intial country code %s\n",
      v119,
      (__int64)"initWithInterface",
      (__int64)((char *)v5 + 1456),
      v120);
    *((_DWORD *)v5 + 1844) = 5;
  }
  return v106;
}
// 68: using guessed type section_64 stru_68;
// C76F0: using guessed type int __cdecl IOLockAlloc(_QWORD);
// C7700: using guessed type int __fastcall IOLockInitWithState(_QWORD, _QWORD);
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7768: using guessed type int __fastcall IOSimpleLockAlloc(_QWORD);
// C7778: using guessed type int __fastcall IOSimpleLockInit(_QWORD);
// C77D8: using guessed type int __fastcall PE_parse_boot_argn(_QWORD, _QWORD, _QWORD);
// C7C78: using guessed type int __fastcall IOTimerEventSource::timerEventSource(_QWORD, _QWORD);

//----- (0000000000023EDC) ----------------------------------------------------
char __fastcall IO80211AWDLPeerManager::captureInfraPacket(IO80211AWDLPeerManager *this, __mbuf **a2)
{
  __mbuf **v2; // r14@1
  __int64 v3; // rax@2
  __int64 v4; // r15@2
  __mbuf *v5; // rsi@5
  __int64 v6; // rax@5
  int v7; // ecx@6
  char v8; // bl@8
  OSMetaClass *v10; // rax@11
  __int64 v11; // rax@11
  __int64 v12; // r8@11
  __int64 v13; // r9@11

  v2 = a2;
  if ( *((_DWORD *)this + 1884) )
  {
    LODWORD(v3) = mbuf_data(*a2);
    v4 = v3;
    if ( !(*(_BYTE *)v3 & 1) && *((_DWORD *)this + 372) && *((_BYTE *)this + 7396) & 2 )
    {
      IO80211PeerManager::lockDataPath(this);
      v5 = (__mbuf *)v4;
      v6 = IO80211AWDLPeerManager::findInfraPeer(this, (unsigned __int8 *)v4);
      if ( v6 )
      {
        v7 = *((_DWORD *)this + 162);
        ++*(_WORD *)(v6 + 2LL * (v7 & 7) + 996);
        ++*(_DWORD *)(v6 + 1196);
        if ( *(_BYTE *)(v6 + 1278) & 2 )
        {
          if ( *(_BYTE *)(v6 + 1194) == 1 )
          {
            memcpy((void *)v4, (const void *)(v6 + 32), 6uLL);
            memcpy((void *)(v4 + 6), (char *)this + 3680, 6uLL);
            v5 = *v2;
            *v2 = IO80211AWDLPeerManager::addAwdlSnapHeader(this, *v2, 16);
            v8 = 1;
LABEL_14:
            IO80211PeerManager::unlockDataPath(this, (__int64)v5);
            return v8;
          }
        }
        else
        {
          v5 = (__mbuf *)v6;
          IO80211AWDLPeerManager::peerDoInfraPing(this, (IO80211AWDLPeer *)v6);
        }
        v8 = 0;
        goto LABEL_14;
      }
      LODWORD(v10) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64))(*(_QWORD *)this + 56LL))(this, v4);
      v11 = OSMetaClass::getClassName(v10);
      v5 = (__mbuf *)"%s::%s try to capture and no peer\n";
      v8 = 0;
      IO80211PeerManager::logDebug(
        this,
        "%s::%s try to capture and no peer\n",
        v11,
        (__int64)"captureInfraPacket",
        v12,
        v13);
      goto LABEL_14;
    }
  }
  return 0;
}
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);

//----- (000000000002401C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::findInfraPeer(IO80211AWDLPeerManager *this, unsigned __int8 *a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // r12@1
  __int64 v4; // rdi@1
  __int64 v5; // r13@3
  OSMetaClass *v6; // rax@5
  __int64 v7; // rax@5
  int v8; // ST28_4@5
  int v9; // ST20_4@5
  int v10; // ST18_4@5
  int v11; // ST10_4@5
  int v12; // ST08_4@5
  int v13; // ST00_4@5
  IO80211AWDLPeerManager *v14; // rdx@7
  IO80211QueueDescriptor *v15; // r13@8
  OSMetaClass *v16; // rax@13
  __int64 v17; // r10@13
  __int64 v18; // r9@13
  int v19; // ST38_4@15
  int v20; // ST28_4@15
  int v21; // ST20_4@15
  int v22; // ST18_4@15
  int v23; // ST10_4@15
  int v24; // ST08_4@15
  int v25; // ST00_4@15

  v2 = (__int64)this;
  v3 = IO80211CommandQueue::map(
         *((_QWORD *)this + 11),
         (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_infraAddressEqual,
         (__int64)this,
         (__int64)a2,
         0LL,
         -1);
  v4 = *((_QWORD *)this + 515);
  if ( v3 )
  {
    if ( *(_DWORD *)(v4 + 52) )
    {
      v5 = IO80211CommandQueue::map(
             v4,
             (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_infraAddressEqualAndRemove,
             v2,
             (__int64)a2,
             0LL,
             -1);
      if ( v5 )
      {
        if ( IO80211PeerManager::shouldLog((IO80211PeerManager *)v2, 0x200000000LL) )
        {
          LODWORD(v6) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 56LL))(v2, 0x200000000LL);
          v7 = OSMetaClass::getClassName(v6);
          v8 = a2[5];
          v9 = a2[4];
          v10 = a2[3];
          v11 = a2[2];
          v12 = a2[1];
          v13 = *a2;
          IO80211PeerManager::logDebug(
            (IO80211PeerManager *)v2,
            0x200000000LL,
            "%s::%s removing infra peer  Qsize %u %02X:%02X:%02X:%02X:%02X:%02X\n",
            v7,
            (__int64)"findInfraPeer",
            *(_DWORD *)(*(_QWORD *)(v2 + 4120) + 52LL));
        }
        (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v5 + 40LL))(v5, 0x200000000LL);
      }
    }
  }
  else
  {
    v3 = IO80211CommandQueue::map(
           v4,
           (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_infraAddressEqual,
           v2,
           (__int64)a2,
           0LL,
           -1);
    if ( !v3 )
    {
      v15 = (IO80211QueueDescriptor *)IO80211AWDLPeer::withAddressAndManager(
                                        (IO80211AWDLPeer *)&null_address,
                                        (const unsigned __int8 *)v2,
                                        v14);
      memcpy((char *)v15 + 1210, a2, 6uLL);
      v3 = 0LL;
      if ( v15 )
      {
        if ( IO80211CommandQueue::lockEnqueue(*(IO80211CommandQueue **)(v2 + 4120), v15) )
        {
          v3 = (__int64)v15;
        }
        else
        {
          (*(void (__fastcall **)(IO80211QueueDescriptor *, IO80211QueueDescriptor *))(*(_QWORD *)v15 + 40LL))(v15, v15);
          v3 = 0LL;
        }
      }
      if ( IO80211PeerManager::shouldLog((IO80211PeerManager *)v2, 0x200000000LL) )
      {
        LODWORD(v16) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 56LL))(v2, 0x200000000LL);
        v17 = OSMetaClass::getClassName(v16);
        v18 = (__int64)"NOK";
        if ( v3 )
          v18 = (__int64)"OK";
        v19 = *(_DWORD *)(*(_QWORD *)(v2 + 4120) + 52LL);
        v20 = a2[5];
        v21 = a2[4];
        v22 = a2[3];
        v23 = a2[2];
        v24 = a2[1];
        v25 = *a2;
        IO80211PeerManager::logDebug(
          (IO80211PeerManager *)v2,
          0x200000000LL,
          "%s::%s ADD infra peer %s %02X:%02X:%02X:%02X:%02X:%02X peer=%p size %u\n",
          v17,
          (__int64)"findInfraPeer",
          v18);
      }
    }
  }
  return v3;
}
// 77FDC: using guessed type int null_address;

//----- (0000000000024260) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::peerDoInfraInvite(IO80211AWDLPeerManager *this, IO80211AWDLPeer *a2)
{
  return 0xFFFFFFFFLL;
}

//----- (000000000002426C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::peerDoInfraPing(IO80211AWDLPeerManager *this, IO80211AWDLPeer *a2)
{
  __int64 v2; // rbx@1
  unsigned __int64 v3; // rbx@1
  signed int v4; // er15@1
  unsigned __int64 v5; // rbx@2
  unsigned __int64 v6; // r13@11
  OSMetaClass *v7; // rax@12
  __int64 v8; // ST80_8@12
  __int64 v9; // r15@12
  int v10; // ST7C_4@12
  int v11; // ST78_4@12
  int v12; // ST74_4@12
  int v13; // ST70_4@12
  int v14; // ST6C_4@12
  int v15; // ST68_4@12
  int v16; // ST64_4@12
  int v17; // ST60_4@12
  __int64 v18; // r13@12
  int v19; // eax@12
  int v20; // ST58_4@12
  int v21; // er15@13
  OSMetaClass *v22; // rax@18
  __int64 v23; // rax@18
  __int64 v24; // r9@18
  OSMetaClass *v25; // rax@19
  __int64 v26; // rax@19
  int v28; // [sp+8Ch] [bp-34h]@1
  __mbuf *v29; // [sp+90h] [bp-30h]@1

  v29 = 0LL;
  v28 = 1;
  v2 = *((_QWORD *)a2 + 153);
  v3 = (unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v2)) >> 64;
  v4 = 0;
  if ( *((_DWORD *)this + 26) )
  {
    v5 = v3 >> 18;
    if ( *((_BYTE *)a2 + 1278) & 1 )
    {
      if ( *((_BYTE *)a2 + 1195) )
      {
        if ( (unsigned int)v5 < 0x3E9 )
          return (unsigned int)v4;
      }
      else if ( (unsigned int)IO80211Peer::getPacketStats(a2) < 0x15 || (unsigned int)v5 <= 0x3E8 )
      {
        return (unsigned int)v4;
      }
    }
    else if ( (unsigned int)v5 < 0x3E9 || (unsigned int)*((_BYTE *)a2 + 1193) >= 4 )
    {
      return (unsigned int)v4;
    }
    v6 = getAbsoluteTime();
    if ( IO80211PeerManager::shouldLog(this, 0x4000000LL) )
    {
      LODWORD(v7) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                      this,
                      0x4000000LL);
      v8 = OSMetaClass::getClassName(v7);
      v9 = 19342813113834067LL * (v6 >> 9) >> 64 >> 11;
      v10 = *((_BYTE *)a2 + 1203);
      v11 = *((_BYTE *)a2 + 32);
      v12 = *((_BYTE *)a2 + 33);
      v13 = *((_BYTE *)a2 + 34);
      v14 = *((_BYTE *)a2 + 35);
      v15 = *((_BYTE *)a2 + 36);
      v16 = *((_BYTE *)a2 + 37);
      v17 = *((_DWORD *)this + 26);
      v18 = *((_BYTE *)a2 + 1193);
      v19 = IO80211Peer::getPacketStats(a2);
      v20 = *((_BYTE *)a2 + 1195);
      IO80211PeerManager::logDebug(
        this,
        0x4000000LL,
        "%s::%s %llu.%03llu ch %u [%02X:%02X:%02X:%02X:%02X:%02X] mych %u _infraPacketsTxPingCounter %u pktstats %u primary %u\n",
        v8,
        (__int64)"peerDoInfraPing",
        v9);
    }
    v21 = mbuf_allocpacket(1LL, 128LL, &v28, &v29);
    if ( v21 || !v29 )
    {
      LODWORD(v25) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
      v26 = OSMetaClass::getClassName(v25);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s cannot allocate mbuf size %u err %d\n",
        v26,
        (__int64)"peerDoInfraPing",
        128LL,
        (unsigned int)v21);
      v4 = -1;
    }
    else
    {
      v4 = IO80211AWDLPeerManager::buildInfraIdPacket(this, a2, 0, 1, v29);
      if ( v4 )
      {
        if ( v29 )
          mbuf_free(v29, a2);
        LODWORD(v22) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, IO80211AWDLPeer *))(*(_QWORD *)this + 56LL))(
                         this,
                         a2);
        v23 = OSMetaClass::getClassName(v22);
        IO80211PeerManager::logDebug(
          this,
          "%s::%s cannot build infra Id packet ret %d\n",
          v23,
          (__int64)"peerDoInfraPing",
          (unsigned int)v4,
          v24);
      }
      else
      {
        IO80211AWDLPeerManager::queueInfraPacket(this, v29);
        ++*((_DWORD *)a2 + 297);
        ++*((_BYTE *)a2 + 1193);
        *((_QWORD *)a2 + 153) = getAbsoluteTime();
        v4 = 0;
      }
    }
  }
  return (unsigned int)v4;
}
// C8BE8: using guessed type int __fastcall mbuf_allocpacket(_QWORD, _QWORD, _QWORD, _QWORD);
// C8C18: using guessed type int __fastcall mbuf_free(_QWORD, _QWORD);

//----- (0000000000024560) ----------------------------------------------------
__mbuf *__fastcall IO80211AWDLPeerManager::addAwdlSnapHeader(IO80211AWDLPeerManager *this, __mbuf *a2, __int16 a3)
{
  __int16 v3; // r12@1
  __mbuf *v4; // rbx@1
  int v5; // eax@1
  unsigned int v6; // er15@1
  int v7; // er13@2
  __int64 v8; // rax@4
  __mbuf *v9; // rax@7
  OSMetaClass *v10; // rax@12
  __int64 v11; // rax@12
  __mbuf *v12; // rbx@12
  __int64 v13; // r9@12
  __int64 v14; // rsi@13
  bool v15; // al@14
  int v16; // eax@18
  const void *v17; // rax@18
  const void *v18; // r15@18
  void *v19; // rax@18
  void *v20; // rbx@18
  __int64 v21; // rax@18
  __mbuf *v22; // rax@19
  __mbuf *v23; // rbx@19
  OSMetaClass *v24; // rax@20
  __int64 v25; // rax@20
  __int64 v26; // r9@20
  __mbuf *v27; // rsi@22
  __mbuf *v28; // rbx@23
  __int64 v29; // rax@24
  __int64 v30; // r15@24
  __int64 v31; // rax@25
  __int64 v32; // rax@28
  __mbuf *v33; // rax@29
  __mbuf *v34; // rbx@30
  __int64 v35; // rax@30
  int v37; // [sp+8h] [bp-A8h]@3
  int v38; // [sp+14h] [bp-9Ch]@14
  char v39; // [sp+18h] [bp-98h]@6
  int v40; // [sp+1Ch] [bp-94h]@6
  int v41; // [sp+20h] [bp-90h]@6
  __mbuf *v42; // [sp+28h] [bp-88h]@6
  int v43; // [sp+30h] [bp-80h]@6
  int v44; // [sp+34h] [bp-7Ch]@6
  __int64 v45; // [sp+38h] [bp-78h]@6
  __int64 v46; // [sp+40h] [bp-70h]@6
  __int64 v47; // [sp+48h] [bp-68h]@6
  __int64 v48; // [sp+50h] [bp-60h]@6
  __int64 v49; // [sp+58h] [bp-58h]@6
  __int64 v50; // [sp+60h] [bp-50h]@6
  __int64 v51; // [sp+68h] [bp-48h]@6
  __int64 v52; // [sp+70h] [bp-40h]@6
  __mbuf *v53; // [sp+78h] [bp-38h]@1
  __mbuf *v54; // [sp+80h] [bp-30h]@1

  v3 = a3;
  v4 = a2;
  v54 = a2;
  v53 = 0LL;
  mbuf_data(a2);
  v5 = mbuf_len(a2);
  v6 = v5;
  if ( *((_DWORD *)this + 121) )
  {
    v7 = 0;
    if ( a2 )
    {
      v37 = v5;
      v7 = 0;
      do
      {
        LODWORD(v8) = mbuf_len(v4);
        if ( !v8 && *((_DWORD *)this + 119) )
        {
          v39 = 1;
          v40 = 80;
          v41 = 0;
          v42 = v54;
          v43 = 0;
          v44 = 0;
          v52 = 0LL;
          v51 = 0LL;
          v50 = 0LL;
          v49 = 0LL;
          v48 = 0LL;
          v47 = 0LL;
          v46 = 0LL;
          v45 = 0LL;
          a2 = (__mbuf *)"tx null";
          IO80211PeerManager::dumpPacket((__int64)this, (signed __int64)"tx null", (__int64)&v39);
        }
        v7 += mbuf_len(v4);
        LODWORD(v9) = mbuf_next(v4, a2);
        v4 = v9;
      }
      while ( v9 );
      v6 = v37;
    }
  }
  else
  {
    v7 = mbuf_pkthdr_len(a2);
  }
  if ( v6 <= 0xB && mbuf_pullup(&v54, 12LL) )
  {
    LODWORD(v10) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                     this,
                     12LL);
    v11 = OSMetaClass::getClassName(v10);
    v12 = 0LL;
    IO80211PeerManager::logDebug(
      this,
      "%s::%s cannot pullup %u bytes !!\n",
      v11,
      (__int64)"addAwdlSnapHeader",
      12LL,
      v13);
  }
  else
  {
    v14 = *((_DWORD *)this + 98);
    if ( *((_DWORD *)this + 98) )
    {
      v38 = 1;
      ++*((_DWORD *)this + 103);
      v15 = mbuf_allocpacket(0LL, v14, &v38, &v53) != 0;
    }
    else
    {
      v15 = 0;
    }
    if ( v15 || !v53 )
    {
      LODWORD(v24) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
      v25 = OSMetaClass::getClassName(v24);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s cannot allocate llc mbuf size %u\n",
        v25,
        (__int64)"addAwdlSnapHeader",
        *((_DWORD *)this + 98),
        v26);
      v12 = v54;
    }
    else
    {
      v16 = mbuf_get_traffic_class(v54);
      mbuf_set_traffic_class(v53, (unsigned int)v16);
      LODWORD(v17) = mbuf_data(v54);
      v18 = v17;
      LODWORD(v19) = mbuf_data(v53);
      v20 = v19;
      memcpy(v19, v18, 0xCuLL);
      *(_QWORD *)((char *)v20 + 14) = 2517980412095146LL;
      *((_BYTE *)v20 + 22) = *((_BYTE *)this + 1518);
      *((_BYTE *)v20 + 23) = *((_BYTE *)this + 1512);
      *((_WORD *)v20 + 12) = 0;
      *((_WORD *)v20 + 13) = v3;
      *((_BYTE *)v20 + 13) = v7 + 2;
      *((_BYTE *)v20 + 12) = (unsigned __int16)(v7 + 2) >> 8;
      LODWORD(v21) = mbuf_len(v54);
      if ( v21 == 12 )
      {
        LODWORD(v22) = mbuf_next(v54, v18);
        v23 = v22;
        mbuf_setnext(v54, 0LL);
        mbuf_free(v54, 0LL);
        v54 = v23;
      }
      else
      {
        mbuf_adj(v54, 12LL);
      }
      mbuf_setlen(v53, 28LL);
      v27 = v54;
      mbuf_setnext(v53, v54);
      if ( *((_DWORD *)this + 121) )
      {
        v28 = v53;
        if ( v53 )
        {
          do
          {
            LODWORD(v29) = mbuf_next(v28, v27);
            v30 = v29;
            if ( v29 )
            {
              LODWORD(v31) = mbuf_len(v29);
              if ( !v31 )
              {
                if ( *((_DWORD *)this + 119) )
                {
                  v39 = 1;
                  v40 = 80;
                  v41 = 0;
                  v42 = v53;
                  v43 = 0;
                  v44 = 0;
                  v52 = 0LL;
                  v51 = 0LL;
                  v50 = 0LL;
                  v49 = 0LL;
                  v48 = 0LL;
                  v47 = 0LL;
                  v46 = 0LL;
                  v45 = 0LL;
                  v27 = (__mbuf *)"added null";
                  IO80211PeerManager::dumpPacket((__int64)this, (signed __int64)"added null", (__int64)&v39);
                }
                LODWORD(v32) = mbuf_next(v30, v27);
                mbuf_setnext(v28, v32);
                v27 = 0LL;
                mbuf_setnext(v30, 0LL);
                mbuf_freem(v30);
              }
            }
            mbuf_len(v28);
            LODWORD(v33) = mbuf_next(v28, v27);
            v28 = v33;
          }
          while ( v33 );
        }
      }
      v34 = v53;
      LODWORD(v35) = mbuf_data(v53);
      mbuf_pkthdr_setheader(v34, v35);
      mbuf_pkthdr_setlen(v53, (unsigned int)(v7 + 14));
      v12 = v53;
    }
  }
  return v12;
}
// C8BE0: using guessed type int __fastcall mbuf_adj(_QWORD, _QWORD);
// C8BE8: using guessed type int __fastcall mbuf_allocpacket(_QWORD, _QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C18: using guessed type int __fastcall mbuf_free(_QWORD, _QWORD);
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);
// C8C30: using guessed type int __fastcall mbuf_get_traffic_class(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C58: using guessed type int __fastcall mbuf_next(_QWORD, _QWORD);
// C8C68: using guessed type int __fastcall mbuf_pkthdr_len(_QWORD);
// C8C78: using guessed type int __fastcall mbuf_pkthdr_setheader(_QWORD, _QWORD);
// C8C80: using guessed type int __fastcall mbuf_pkthdr_setlen(_QWORD, _QWORD);
// C8C90: using guessed type int __fastcall mbuf_pullup(_QWORD, _QWORD);
// C8C98: using guessed type int __fastcall mbuf_set_traffic_class(_QWORD, _QWORD);
// C8CB0: using guessed type int __fastcall mbuf_setlen(_QWORD, _QWORD);
// C8CB8: using guessed type int __fastcall mbuf_setnext(_QWORD, _QWORD);

//----- (00000000000249C8) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::setAwdlManualMode(IO80211AWDLPeerManager *this)
{
  *((_DWORD *)this + 259) = 3;
  *((_DWORD *)this + 1885) = 0;
  *((_DWORD *)this + 996) = 0;
}

//----- (00000000000249EC) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::handleServiceTimer(IO80211AWDLPeerManager *this)
{
  OSMetaClass *v1; // rax@2
  __int64 v2; // rcx@2
  __int64 v3; // r9@2
  int v4; // ST10_4@4
  __int64 i; // rbx@5

  if ( IO80211PeerManager::shouldLog(this, 0x100000LL) )
  {
    getAbsoluteTime();
    LODWORD(v1) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    0x100000LL);
    v2 = OSMetaClass::getClassName(v1);
    v3 = (__int64)"si";
    if ( *((_DWORD *)this + 372) == 1 )
      v3 = (__int64)"SI";
    v4 = *((_DWORD *)this + 257);
    IO80211PeerManager::logDebug(
      this,
      0x100000LL,
      "%s::%s %s %llu.%03llu avail %u\n",
      v2,
      (__int64)"handleServiceTimer",
      v3);
  }
  for ( i = IO80211CommandQueue::lockMap(
              *((IO80211CommandQueue **)this + 477),
              (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_sendOobFrame,
              0LL,
              (__int64)this,
              0LL,
              -1);
        i;
        i = IO80211CommandQueue::lockMap(
              *((IO80211CommandQueue **)this + 477),
              (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_sendOobFrame,
              0LL,
              (__int64)this,
              0LL,
              -1) )
  {
    if ( *(_QWORD *)(i + 40) )
    {
      IO80211AWDLPeerManager::sendOobFrame(this, (IO80211ActionFrameDescriptor *)i);
    }
    else
    {
      IO80211ActionFrameDescriptor::freeResources((IO80211ActionFrameDescriptor *)i, 1u);
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)i + 40LL))(i, 1LL);
    }
  }
  return IO80211AWDLPeerManager::updateServiceTimer(this);
}

//----- (0000000000024B40) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::handleInfraRequestTimer(IO80211PeerManager *this)
{
  IO80211PeerManager *v1; // r15@1
  __int64 i; // rbx@1
  __int64 v3; // rax@2
  OSMetaClass *v4; // rax@5
  __int64 v5; // r12@5
  __int64 v6; // rax@5
  __int64 v7; // rax@5
  __int64 v8; // rcx@5
  __int64 v9; // r8@5
  __int64 v10; // r9@5
  __int64 v11; // r12@5
  IO80211PeerManager *v12; // rbx@5
  signed int v13; // er13@6
  unsigned __int64 v14; // r15@6
  unsigned __int64 v15; // rax@7
  IO80211Controller *v16; // rax@9
  __int64 v17; // [sp+10h] [bp-30h]@5

  v1 = this;
  for ( i = *((_QWORD *)this + 479); i; i = *((_QWORD *)v1 + 479) )
  {
    LODWORD(v3) = mbuf_nextpkt(i);
    *((_QWORD *)v1 + 479) = v3;
    if ( !v3 )
      *((_QWORD *)v1 + 480) = 0LL;
    mbuf_setnextpkt(i, 0LL);
    if ( IO80211PeerManager::shouldLog(v1, 0x4000000LL) )
    {
      LODWORD(v4) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)v1 + 56LL))(
                      v1,
                      0x4000000LL);
      v5 = OSMetaClass::getClassName(v4);
      mbuf_len(i);
      IO80211PeerManager::logDebug(v1, 0x4000000LL, "%s::%s m=%p len %lu\n", v5, (__int64)"handleInfraRequestTimer", i);
      LODWORD(v6) = mbuf_data(i);
      v17 = v6;
      LODWORD(v7) = mbuf_len(i);
      v11 = i;
      v12 = v1;
      if ( v7 )
      {
        v13 = 1;
        v14 = 0LL;
        do
        {
          IO80211PeerManager::logDebug(v12, 0x4000000LL, "%02X ", *(_BYTE *)(v17 + v14), v9, v10);
          v14 = (unsigned int)v13;
          LODWORD(v15) = mbuf_len(v11);
          ++v13;
        }
        while ( v14 < v15 );
      }
      IO80211PeerManager::logDebug(v12, 0x4000000LL, "\n", v8, v9, v10);
      v1 = v12;
      i = v11;
    }
    v16 = (IO80211Controller *)IO80211PeerManager::getController(v1);
    IO80211Controller::awdlSendInfraPacket(v16, (__mbuf *)i);
  }
}
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C60: using guessed type int __fastcall mbuf_nextpkt(_QWORD);
// C8CC0: using guessed type int __fastcall mbuf_setnextpkt(_QWORD, _QWORD);

//----- (0000000000024C90) ----------------------------------------------------
void IO80211AWDLPeerManager::handleAwServiceTimer()
{
  ;
}

//----- (0000000000024C96) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::handleMasterIndicationTimer(IO80211AWDLPeerManager *a1)
{
  IO80211AWDLPeerManager::updateAndSendMI(a1, 1);
}

//----- (0000000000024CA6) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::initParamsToDefaults(IO80211AWDLPeerManager *this)
{
  int v1; // eax@1
  __int64 result; // rax@1

  *((_DWORD *)this + 1017) = 0;
  *((_DWORD *)this + 1891) = 0;
  *((_DWORD *)this + 1892) = 1;
  *((_DWORD *)this + 1014) = 1;
  *((_DWORD *)this + 1013) = 1;
  *((_DWORD *)this + 373) = 16;
  *((_DWORD *)this + 374) = 16;
  *((_DWORD *)this + 375) = 16;
  *((_DWORD *)this + 376) = 110;
  *((_DWORD *)this + 377) = 430;
  *((_DWORD *)this + 910) = 0;
  *((_DWORD *)this + 903) = 150;
  *((_QWORD *)this + 494) = 0LL;
  *((_BYTE *)this + 3644) = 0;
  *((_DWORD *)this + 912) = 0;
  *((_DWORD *)this + 380) = 6;
  *((_DWORD *)this + 381) = 149;
  *((_DWORD *)this + 382) = 44;
  *((_BYTE *)this + 1532) = 6;
  *((_BYTE *)this + 1533) = 6;
  *((_DWORD *)this + 384) = 30000;
  *((_DWORD *)this + 26) = 0;
  *((_DWORD *)this + 1016) = 1;
  *((_BYTE *)this + 553) = 1;
  *((_BYTE *)this + 552) = 1;
  *((_DWORD *)this + 1895) = 1;
  *((_BYTE *)this + 7604) = 0;
  v1 = *((_DWORD *)this + 998);
  *((_BYTE *)this + 7605) = v1;
  *((_BYTE *)this + 7584) = 2;
  *((_BYTE *)this + 7600) = 0;
  *((_BYTE *)this + 7601) = -1;
  *((_DWORD *)this + 945) = 1;
  *((_DWORD *)this + 232) = 1;
  *((_DWORD *)this + 254) = 1;
  *((_DWORD *)this + 233) = 0;
  *((_DWORD *)this + 234) = 0;
  *((_DWORD *)this + 235) = 0;
  *((_DWORD *)this + 236) = 0;
  *((_DWORD *)this + 237) = 0;
  *((_DWORD *)this + 238) = 0;
  *((_DWORD *)this + 240) = 0;
  *((_DWORD *)this + 239) = 0;
  *((_WORD *)this + 3801) = 2 * (unsigned __int8)v1 + 2;
  result = getAbsoluteTime();
  *((_QWORD *)this + 486) = result;
  *((_DWORD *)this + 999) = 10000;
  *((_DWORD *)this + 1002) = 20000;
  *((_DWORD *)this + 1003) = 10000;
  *((_DWORD *)this + 1000) = 5000;
  *((_DWORD *)this + 1005) = 1000;
  *((_DWORD *)this + 938) = -50;
  *((_DWORD *)this + 937) = -70;
  *((_DWORD *)this + 940) = -55;
  *((_DWORD *)this + 939) = -45;
  *((_BYTE *)this + 3764) = 5;
  *((_BYTE *)this + 3765) = 12;
  *((_BYTE *)this + 3779) = -128;
  *((_DWORD *)this + 931) = 4;
  *((_DWORD *)this + 362) = 3;
  *((_DWORD *)this + 913) = 30000;
  *((_DWORD *)this + 929) = 0;
  *((_DWORD *)this + 933) = 0xFFFF;
  if ( *((_BYTE *)this + 7584) )
  {
    result = 0LL;
    do
      *((_BYTE *)this + result++ + 7606) = *((_BYTE *)this + 1532);
    while ( (signed int)result < *((_BYTE *)this + 7584) );
  }
  *((_DWORD *)this + 130) = 1;
  *((_DWORD *)this + 189) = 1;
  *((_DWORD *)this + 926) = 0;
  *((_DWORD *)this + 928) = 2;
  *((_DWORD *)this + 927) = 4;
  *((_BYTE *)this + 1518) = 7;
  *((_BYTE *)this + 1517) = 3;
  *((_BYTE *)this + 1515) = 3;
  *((_BYTE *)this + 1516) = 3;
  *((_DWORD *)this + 1010) = 1;
  *((_DWORD *)this + 1009) = 1;
  *((_DWORD *)this + 916) = 0;
  *((_DWORD *)this + 915) = 0;
  *((_BYTE *)this + 3776) = 0;
  *((_BYTE *)this + 3777) = 23;
  *((_BYTE *)this + 3778) = -14;
  *((_BYTE *)this + 3668) = 0;
  *((_BYTE *)this + 3669) = 37;
  *((_BYTE *)this + 3670) = 0;
  *((_BYTE *)this + 3671) = -1;
  *((_BYTE *)this + 3672) = -108;
  *((_BYTE *)this + 3673) = 115;
  *((_BYTE *)this + 3674) = 0;
  *((_BYTE *)this + 3675) = 37;
  *((_BYTE *)this + 3676) = 0;
  *((_BYTE *)this + 3677) = -1;
  *((_BYTE *)this + 3678) = -108;
  *((_BYTE *)this + 3679) = 116;
  *((_BYTE *)this + 3766) = -70;
  *((_BYTE *)this + 3767) = -75;
  *((_DWORD *)this + 908) = 0;
  *((_DWORD *)this + 907) = 4;
  *((_DWORD *)this + 1004) = 3;
  *((_DWORD *)this + 365) = -60;
  *((_DWORD *)this + 1238) = 1;
  *((_DWORD *)this + 1243) = 7;
  *((_DWORD *)this + 172) = 1000;
  *((_DWORD *)this + 173) = 0;
  *((_DWORD *)this + 1241) = 3;
  *((_DWORD *)this + 1242) = 2;
  *((_BYTE *)this + 1484) = 0;
  *((_BYTE *)this + 7572) = 0;
  return result;
}

//----- (000000000002507F) ----------------------------------------------------
signed __int64 __fastcall _infraAddressEqual(__int64 a1, __int64 a2, const void *a3)
{
  signed __int64 result; // rax@1
  bool v4; // zf@3

  result = 1LL;
  if ( a2 && a3 )
  {
    v4 = memcmp(a3, (const void *)(a2 + 1210), 6uLL) == 0;
    result = 17LL;
    if ( !v4 )
      result = 0LL;
  }
  return result;
}

//----- (00000000000250B7) ----------------------------------------------------
signed __int64 __fastcall _infraAddressEqualAndRemove(__int64 a1, __int64 a2, const void *a3)
{
  signed __int64 result; // rax@1

  result = 1LL;
  if ( a2 )
  {
    if ( a3 )
      result = 5 * (unsigned int)(memcmp(a3, (const void *)(a2 + 1210), 6uLL) == 0);
  }
  return result;
}

//----- (00000000000250EE) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::addPeer(IO80211AWDLPeerManager *this, IO80211AWDLPeer *a2)
{
  IO80211AWDLPeer *v2; // r15@1
  __int64 v3; // r14@1
  __int64 v4; // rdi@1
  int v5; // ecx@1
  __int64 v6; // rbx@1
  IO80211AWDLPeerManager *v7; // rdx@3
  IO80211QueueDescriptor *v8; // rax@4
  __int64 v9; // r12@4
  IO80211QueueDescriptor *v10; // rsi@5
  int v11; // ST28_4@10
  int v12; // ST18_4@10
  int v13; // ST10_4@10
  int v14; // ST08_4@10
  int v15; // ST00_4@10

  v2 = a2;
  v3 = (__int64)this;
  v4 = *((_QWORD *)this + 11);
  v5 = *(_DWORD *)(v4 + 48);
  v6 = 0LL;
  if ( v5 != 0x1000000 && *(_DWORD *)(v4 + 52) >= (unsigned int)(*(_DWORD *)(v4 + 68) * v5) )
    return v6;
  v6 = IO80211CommandQueue::map(
         v4,
         (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_macAddressEqual,
         v3,
         (__int64)a2,
         0LL,
         -1);
  if ( !v6 )
  {
    v8 = (IO80211QueueDescriptor *)IO80211AWDLPeer::withAddressAndManager(a2, (const unsigned __int8 *)v3, v7);
    v6 = (__int64)v8;
    v9 = (__int64)"NOK";
    if ( v8 )
    {
      v10 = v8;
      if ( IO80211CommandQueue::enqueue(*(IO80211CommandQueue **)(v3 + 88), v8) )
      {
        v9 = (__int64)"OK";
        if ( *(_DWORD *)(v3 + 3968) )
          *(_BYTE *)(v6 + 1279) = 1;
        goto LABEL_10;
      }
      (*(void (__fastcall **)(__int64, IO80211QueueDescriptor *))(*(_QWORD *)v6 + 40LL))(v6, v10);
    }
    v6 = 0LL;
LABEL_10:
    v11 = *(_DWORD *)(*(_QWORD *)(v3 + 88) + 52LL);
    v12 = *((_BYTE *)v2 + 5);
    v13 = *((_BYTE *)v2 + 4);
    v14 = *((_BYTE *)v2 + 3);
    v15 = *((_BYTE *)v2 + 2);
    IO80211PeerManager::logDebug(
      (IO80211PeerManager *)v3,
      0x200000000LL,
      "AddPeer %s %02X:%02X:%02X:%02X:%02X:%02X peer=%p num %u\n",
      v9,
      *(_BYTE *)v2,
      *((_BYTE *)v2 + 1));
  }
  if ( v6 )
  {
    *(_QWORD *)(v6 + 192) = getAbsoluteTime();
    ++*(_BYTE *)(v3 + 8278);
  }
  return v6;
}

//----- (000000000002521C) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::awdlStatsIncrementPeer(IO80211AWDLPeerManager *this)
{
  ++*((_BYTE *)this + 8278);
}

//----- (0000000000025228) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::addInfraPeer(IO80211AWDLPeerManager *this, unsigned __int8 *a2)
{
  unsigned __int8 *v2; // r15@1
  __int64 v3; // rcx@1
  int v4; // edx@1
  __int64 v5; // rbx@1
  __int64 v6; // rbx@3
  OSMetaClass *v7; // rax@5
  __int64 v8; // rax@5
  int v9; // ST20_4@5
  int v10; // ST18_4@5
  int v11; // ST10_4@5
  int v12; // ST08_4@5
  int v13; // ST00_4@5
  IO80211AWDLPeerManager *v14; // rdx@7
  __int64 v15; // r13@8
  OSMetaClass *v16; // rax@12
  __int64 v17; // r10@12
  __int64 v18; // r9@12
  int v19; // ST28_4@14
  int v20; // ST20_4@14
  int v21; // ST18_4@14
  int v22; // ST10_4@14
  int v23; // ST08_4@14
  int v24; // ST00_4@14

  v2 = a2;
  v3 = *((_QWORD *)this + 11);
  v4 = *(_DWORD *)(v3 + 48);
  v5 = 0LL;
  if ( v4 == 0x1000000 || *(_DWORD *)(v3 + 52) < (unsigned int)(*(_DWORD *)(v3 + 68) * v4) )
  {
    v6 = IO80211CommandQueue::map(
           *((_QWORD *)this + 515),
           (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_infraAddressEqualAndRemove,
           (__int64)this,
           (__int64)a2,
           0LL,
           -1);
    if ( v6 )
    {
      if ( IO80211PeerManager::shouldLog(this, 0x200000000LL) )
      {
        LODWORD(v7) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                        this,
                        0x200000000LL);
        v8 = OSMetaClass::getClassName(v7);
        v9 = a2[5];
        v10 = a2[4];
        v11 = a2[3];
        v12 = a2[2];
        v13 = a2[1];
        IO80211PeerManager::logDebug(
          this,
          0x200000000LL,
          "%s::%s Found %02X:%02X:%02X:%02X:%02X:%02X peer=%p on infraPeerList ->remove\n",
          v8,
          (__int64)"addInfraPeer",
          *a2);
      }
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v6 + 40LL))(v6, 0x200000000LL);
    }
    v5 = IO80211CommandQueue::map(
           *((_QWORD *)this + 11),
           (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_infraAddressEqual,
           (__int64)this,
           (__int64)a2,
           0LL,
           -1);
    if ( !v5 )
    {
      v15 = IO80211AWDLPeer::withAddressAndManager((IO80211AWDLPeer *)&null_address, (const unsigned __int8 *)this, v14);
      memcpy((void *)(v15 + 1210), a2, 6uLL);
      v5 = 0LL;
      if ( v15 )
      {
        a2 = (unsigned __int8 *)v15;
        if ( IO80211CommandQueue::enqueue(*((IO80211CommandQueue **)this + 11), (IO80211QueueDescriptor *)v15) )
        {
          v5 = v15;
        }
        else
        {
          (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v15 + 40LL))(v15, v15);
          v5 = 0LL;
        }
      }
      LODWORD(v16) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, unsigned __int8 *))(*(_QWORD *)this + 56LL))(
                       this,
                       a2);
      v17 = OSMetaClass::getClassName(v16);
      v18 = (__int64)"NOK";
      if ( v5 )
        v18 = (__int64)"OK";
      v19 = v2[5];
      v20 = v2[4];
      v21 = v2[3];
      v22 = v2[2];
      v23 = v2[1];
      v24 = *v2;
      IO80211PeerManager::logDebug(
        this,
        0x200000000LL,
        "%s::%s AWDL %s infra=%02X:%02X:%02X:%02X:%02X:%02X peer=%p\n",
        v17,
        (__int64)"addInfraPeer",
        v18);
    }
  }
  return v5;
}
// 77FDC: using guessed type int null_address;

//----- (0000000000025428) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::failToEnable(IO80211AWDLPeerManager *this)
{
  *((_DWORD *)this + 1849) = 0;
  *((_BYTE *)this + 3960) = 0;
  IO80211PeerManager::removeAllPeers(this);
  IO80211PeerManager::flushFreeMbufs(this);
  JUMPOUT(__CS__, `vtable for'IO80211PeerManager[54]);
}
// 7D5B0: using guessed type __int64 `vtable for'IO80211PeerManager[2];

//----- (0000000000025466) ----------------------------------------------------
int __fastcall IO80211AWDLPeerManager::doEnable(IO80211AWDLPeerManager *this, char *a2)
{
  OSMetaClass *v2; // rax@3
  __int64 v3; // rax@3
  __int64 v4; // r9@3
  unsigned int v5; // er12@4
  OSMetaClass *v6; // rax@5
  __int64 v7; // rax@5
  OSMetaClass *v9; // rax@6
  __int64 v10; // rax@6
  __int64 v11; // r9@6

  if ( *((_BYTE *)this + 7396) & 1 )
  {
    if ( IO80211PeerManager::shouldLog(this, 0x2000000000LL) )
    {
      LODWORD(v2) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                      this,
                      0x2000000000LL);
      v3 = OSMetaClass::getClassName(v2);
      IO80211PeerManager::logDebug(this, 0x2000000000LL, "%s::%s is configured\n", v3, (__int64)"doEnable", v4);
    }
  }
  else
  {
    v5 = IO80211AWDLPeerManager::configure(this);
    if ( v5 )
    {
      LODWORD(v6) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
      v7 = OSMetaClass::getClassName(v6);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s cannot configure AWDL after enabling interface!! ret=%x _enabling %u\n",
        v7,
        (__int64)"doEnable",
        v5,
        *((_BYTE *)this + 653));
      return (*(int (__fastcall **)(IO80211AWDLPeerManager *, _QWORD))(*(_QWORD *)this + 416LL))(
               this,
               "%s::%s cannot configure AWDL after enabling interface!! ret=%x _enabling %u\n");
    }
  }
  ((void (__fastcall *)(IO80211AWDLPeerManager *, char *))`vtable for'IO80211PeerManager[52])(this, a2);
  *((_BYTE *)this + 96) = 0;
  (*(void (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 320LL))(this, 7LL);
  LODWORD(v9) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
  v10 = OSMetaClass::getClassName(v9);
  return IO80211PeerManager::logDebug(
           this,
           0x2000000000LL,
           "%s::%s AWDL doEnable Done\n",
           v10,
           (__int64)"doEnable",
           v11);
}
// 7D5B0: using guessed type __int64 `vtable for'IO80211PeerManager[2];

//----- (0000000000025588) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::configure(IO80211AWDLPeerManager *this)
{
  __int64 v1; // r12@1
  OSMetaClass *v2; // rax@2
  __int64 v3; // rax@2
  __int64 v4; // r9@2
  int v5; // er15@5
  OSMetaClass *v6; // rax@6
  __int64 v7; // rdx@6
  __int64 v8; // r9@6
  const char *v9; // rsi@6
  int v10; // er15@7
  OSMetaClass *v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // r9@8
  OSMetaClass *v14; // rax@10
  __int64 v15; // rax@10
  __int64 v16; // r8@10
  __int64 v17; // r9@10
  int v18; // eax@11
  __int16 v19; // ax@13
  int v20; // er15@15
  OSMetaClass *v21; // rax@16
  __int64 v22; // rax@16
  __int64 v23; // r9@16
  int v24; // er15@18
  OSMetaClass *v25; // rax@19
  __int64 v26; // rax@19
  __int64 v27; // r9@19
  int v28; // er15@20
  OSMetaClass *v29; // rax@21
  __int64 v30; // rax@21
  __int64 v31; // r9@21
  int *v32; // rsi@22
  int v33; // eax@23
  int v34; // eax@24
  int v35; // eax@26
  OSMetaClass *v36; // rax@28
  OSMetaClass *v37; // rax@31
  __int64 v38; // rcx@31
  __int64 v39; // r9@31
  const char *v40; // rdx@31
  __int64 v41; // r8@31
  OSMetaClass *v43; // rax@36
  __int64 v44; // rax@36
  OSMetaClass *v45; // rax@38
  int v46; // er15@39
  OSMetaClass *v47; // rax@40
  __int64 v48; // rax@40
  __int64 v49; // r9@40
  OSMetaClass *v50; // rax@42
  __int64 v51; // rsi@43
  __int64 v52; // rdx@43
  OSMetaClass *v53; // rax@44
  OSMetaClass *v54; // rax@46
  OSMetaClass *v55; // rax@48
  __int64 v56; // [sp+8h] [bp-128h]@13
  __int64 v57; // [sp+10h] [bp-120h]@13
  int v58; // [sp+18h] [bp-118h]@13
  __int64 v59; // [sp+20h] [bp-110h]@3
  __int64 v60; // [sp+28h] [bp-108h]@3
  __int64 v61; // [sp+30h] [bp-100h]@3
  __int64 v62; // [sp+38h] [bp-F8h]@3
  __int64 v63; // [sp+40h] [bp-F0h]@3
  __int64 v64; // [sp+48h] [bp-E8h]@3
  __int64 v65; // [sp+50h] [bp-E0h]@3
  int v66; // [sp+58h] [bp-D8h]@3
  __int64 v67; // [sp+60h] [bp-D0h]@3
  __int64 v68; // [sp+68h] [bp-C8h]@3
  __int64 v69; // [sp+70h] [bp-C0h]@3
  __int64 v70; // [sp+78h] [bp-B8h]@3
  int v71; // [sp+80h] [bp-B0h]@3
  __int64 v72; // [sp+88h] [bp-A8h]@3
  __int64 v73; // [sp+90h] [bp-A0h]@3
  __int64 v74; // [sp+98h] [bp-98h]@3
  __int64 v75; // [sp+A0h] [bp-90h]@3
  __int64 v76; // [sp+A8h] [bp-88h]@3
  __int64 v77; // [sp+B0h] [bp-80h]@3
  int v78; // [sp+B8h] [bp-78h]@3
  int v79; // [sp+C0h] [bp-70h]@5
  int v80; // [sp+C4h] [bp-6Ch]@5
  __int64 *v81; // [sp+C8h] [bp-68h]@5
  __int64 v82; // [sp+D8h] [bp-58h]@13
  __int64 v83; // [sp+E0h] [bp-50h]@13
  __int64 v84; // [sp+E8h] [bp-48h]@13
  __int64 v85; // [sp+F0h] [bp-40h]@13
  __int64 v86; // [sp+F8h] [bp-38h]@3
  int v87; // [sp+100h] [bp-30h]@3
  __int64 v88; // [sp+108h] [bp-28h]@1

  v1 = off_7B078[0];
  v88 = *(_QWORD *)off_7B078[0];
  if ( IO80211PeerManager::shouldLog(this, 0x2000000000LL) )
  {
    LODWORD(v2) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    0x2000000000LL);
    v3 = OSMetaClass::getClassName(v2);
    IO80211PeerManager::logDebug(this, 0x2000000000LL, "%s::%s configure start! \n", v3, (__int64)"configure", v4);
  }
  *((_BYTE *)this + 3960) = 0;
  *((_BYTE *)this + 560) = 1;
  v78 = 0;
  v77 = 0LL;
  v76 = 1LL;
  v75 = 0LL;
  v74 = 1LL;
  v73 = 1LL;
  v72 = 1LL;
  v71 = 0;
  v70 = 1LL;
  v69 = 0LL;
  v68 = 1LL;
  v67 = 1LL;
  v66 = 0;
  v65 = 0LL;
  v64 = 1LL;
  v63 = 1LL;
  v62 = 1LL;
  v61 = 1LL;
  v60 = 1LL;
  v87 = 0;
  v86 = 1LL;
  v59 = 1LL;
  if ( *((_DWORD *)this + 1844) != 5 )
    *((_DWORD *)this + 1844) = 0;
  IO80211AWDLPeerManager::initParamsToDefaults(this);
  v79 = -2144835128;
  v80 = 125;
  v81 = &v74;
  memcpy((char *)&v74 + 4, (char *)this + 3668, 6uLL);
  memcpy((char *)&v75 + 2, (char *)this + 3674, 6uLL);
  v5 = IO80211PeerManager::ioctl_internal(this, (__int64)&v79);
  if ( v5 )
  {
    LODWORD(v6) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v79);
    v7 = OSMetaClass::getClassName(v6);
    v9 = "%s::%s  Unable to set BSSID ret %x\n";
  }
  else
  {
    v79 = -1071093303;
    v80 = 12;
    v81 = &v86;
    v10 = IO80211PeerManager::ioctl_internal(this, (__int64)&v79);
    if ( v10 )
    {
      LODWORD(v11) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v79);
      v12 = OSMetaClass::getClassName(v11);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s  Unable to get card caps %x\n",
        v12,
        (__int64)"configure",
        (unsigned int)v10,
        v13);
    }
    else if ( SBYTE1(v87) >= 0 )
    {
      LODWORD(v14) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v79);
      v15 = OSMetaClass::getClassName(v14);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s Dynamic country code not supported on this device\n",
        v15,
        (__int64)"configure",
        v16,
        v17);
      *((_DWORD *)this + 1892) = 0;
    }
    *((_BYTE *)this + 7441) = 1;
    *((_DWORD *)this + 259) = 1;
    *((_DWORD *)this + 1012) = 1;
    *((_DWORD *)this + 994) = *((_DWORD *)this + 993) & 2;
    IO80211AWDLPeerManager::configureValidNANChannels(this);
    v18 = *((_DWORD *)this + 381);
    if ( !v18 )
      v18 = *((_DWORD *)this + 382);
    *((_BYTE *)this + 1533) = v18;
    *((_BYTE *)this + 1534) = v18;
    v85 = 0LL;
    v84 = 0LL;
    v83 = 0LL;
    v82 = 1LL;
    IO80211PeerManager::getHtCapabilityIE(this, &v82);
    v58 = 0;
    v57 = 0LL;
    v56 = 1LL;
    IO80211PeerManager::getVHtCapabilityIE(this, &v56);
    v19 = *((_WORD *)this + 167);
    if ( *((_DWORD *)this + 2030) == 1 )
    {
      v19 &= 0xFFFDu;
      *((_WORD *)this + 167) = v19;
    }
    *((_WORD *)this + 167) = v19 & 0xFFEF;
    v80 = 130;
    v81 = &v67;
    v20 = IO80211PeerManager::ioctl_internal(this, (__int64)&v79);
    if ( v20 )
    {
      LODWORD(v21) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v79);
      v22 = OSMetaClass::getClassName(v21);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s  Unable to get max peer cache size %x\n",
        v22,
        (__int64)"configure",
        (unsigned int)v20,
        v23);
      *((_DWORD *)this + 40) = 255;
    }
    else
    {
      *((_DWORD *)this + 40) = HIDWORD(v67);
    }
    HIDWORD(v69) = *((_DWORD *)this + 926);
    HIDWORD(v68) = *((_DWORD *)this + 927);
    LODWORD(v69) = *((_DWORD *)this + 928);
    v79 = -2144835128;
    v80 = 137;
    v81 = &v68;
    v24 = IO80211PeerManager::ioctl_internal(this, (__int64)&v79);
    if ( v24 )
    {
      LODWORD(v25) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v79);
      v26 = OSMetaClass::getClassName(v25);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s  Unable to set master count params ret %x\n",
        v26,
        (__int64)"configure",
        (unsigned int)v24,
        v27);
    }
    HIDWORD(v62) = *((_DWORD *)this + 931);
    v79 = -2144835128;
    v80 = 123;
    v81 = &v62;
    v28 = IO80211PeerManager::ioctl_internal(this, (__int64)&v79);
    if ( v28 )
    {
      LODWORD(v29) = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 56LL))(this, &v79);
      v30 = OSMetaClass::getClassName(v29);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s  Unable to set max tree depth: ret %x\n",
        v30,
        (__int64)"configure",
        (unsigned int)v28,
        v31);
    }
    HIDWORD(v72) = *((_DWORD *)this + 929);
    v79 = -2144835128;
    v80 = 122;
    v81 = &v72;
    v32 = &v79;
    v5 = IO80211PeerManager::ioctl_internal(this, (__int64)&v79);
    if ( !v5 )
    {
      *((_DWORD *)this + 1850) = 0;
      v33 = 8 * (unsigned __int8)*((_DWORD *)this + 993) & 0x10;
      v34 = *((_DWORD *)this + 992) ? v33 ^ 0x50 : v33 ^ 0x70;
      HIDWORD(v59) = v34;
      IO80211AWDLPeerManager::setAwdlElectionMetric(this, (__int64)&v59);
      v35 = *((_DWORD *)this + 930);
      if ( !(v35 & 1) )
        goto LABEL_35;
      v71 = *((_DWORD *)this + 934);
      BYTE4(v70) = v35;
      v79 = -2144835128;
      v80 = 212;
      v81 = &v70;
      v32 = &v79;
      v5 = IO80211PeerManager::ioctl_internal(this, (__int64)&v79);
      if ( !v5 )
        goto LABEL_35;
    }
    LODWORD(v36) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, v32);
    v7 = OSMetaClass::getClassName(v36);
    v9 = "%s::%s  Unable to set election id params ret %x\n";
  }
LABEL_29:
  IO80211PeerManager::logDebug(this, v9, v7, (__int64)"configure", (unsigned int)v5, v8);
LABEL_30:
  if ( !IO80211PeerManager::shouldLog(this, 0x2000000000LL) )
    goto LABEL_33;
  LODWORD(v37) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                   this,
                   0x2000000000LL);
  v38 = OSMetaClass::getClassName(v37);
  v40 = "%s::%s configure error!! :(\n ";
  v41 = (__int64)"configure";
LABEL_32:
  IO80211PeerManager::logDebug(this, 0x2000000000LL, v40, v38, v41, v39);
LABEL_33:
  while ( *(_QWORD *)v1 != v88 )
  {
LABEL_35:
    HIDWORD(v73) = *((_BYTE *)this + 1532);
    v79 = -2144835128;
    v80 = 132;
    v81 = &v73;
    v5 = IO80211PeerManager::ioctl_internal(this, (__int64)&v79);
    if ( v5 )
    {
      LODWORD(v43) = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 56LL))(this, &v79);
      v44 = OSMetaClass::getClassName(v43);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s  Unable to set master channel %u ret %x\n",
        v44,
        (__int64)"configure",
        *((_BYTE *)this + 1532),
        (unsigned int)v5);
      goto LABEL_30;
    }
    v66 = *((_DWORD *)this + 940);
    LODWORD(v65) = *((_DWORD *)this + 938);
    HIDWORD(v64) = *((_DWORD *)this + 937);
    HIDWORD(v65) = *((_DWORD *)this + 939);
    v79 = -2144835128;
    v80 = 135;
    v81 = &v64;
    v5 = IO80211PeerManager::ioctl_internal(this, (__int64)&v79);
    if ( v5 )
    {
      LODWORD(v45) = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 56LL))(this, &v79);
      v7 = OSMetaClass::getClassName(v45);
      v9 = "%s::%s  Unable to set RSSI election thresholds ret %x\n";
      goto LABEL_29;
    }
    BYTE4(v61) = *((_BYTE *)this + 3765);
    v79 = -2144835128;
    v80 = 213;
    v81 = &v61;
    v46 = IO80211PeerManager::ioctl_internal(this, (__int64)&v79);
    if ( v46 )
    {
      LODWORD(v47) = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 56LL))(this, &v79);
      v48 = OSMetaClass::getClassName(v47);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s Unable to set AWDL min rate %x\n",
        v48,
        (__int64)"configure",
        (unsigned int)v46,
        v49);
    }
    HIDWORD(v60) = *((_BYTE *)this + 3779);
    v79 = -2144835128;
    v80 = 150;
    v81 = &v60;
    v5 = IO80211PeerManager::ioctl_internal(this, (__int64)&v79);
    if ( v5 )
    {
      LODWORD(v50) = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 56LL))(this, &v79);
      v7 = OSMetaClass::getClassName(v50);
      v9 = "%s::%s Unable to set AWDL max no master periods %x\n";
      goto LABEL_29;
    }
    IO80211AWDLPeerManager::setChannelSequenceUnconditional(this, 0);
    *((_DWORD *)this + 1244) = 7;
    *((_BYTE *)this + 1512) = 0;
    v51 = *((_DWORD *)this + 997);
    IO80211AWDLPeerManager::setPresenceMode(this, v51);
    IO80211AWDLPeerManager::setMinExt(this, v51, v52);
    v79 = -2144835128;
    v80 = 140;
    v81 = &v63;
    HIDWORD(v63) = *((_DWORD *)this + 377);
    v5 = IO80211PeerManager::ioctl_internal(this, (__int64)&v79);
    if ( v5 )
    {
      LODWORD(v53) = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 56LL))(this, &v79);
      v7 = OSMetaClass::getClassName(v53);
      v9 = "%s::%s  AWDL can't SET NE PERIOD ret %x\n";
      goto LABEL_29;
    }
    v79 = -2144835128;
    v80 = 134;
    v81 = &v76;
    v78 = 1;
    HIDWORD(v76) = 1;
    v5 = IO80211PeerManager::ioctl_internal(this, (__int64)&v79);
    if ( v5 )
    {
      LODWORD(v54) = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 56LL))(this, &v79);
      v7 = OSMetaClass::getClassName(v54);
      v9 = "%s::%s  AWDL can't DISABLE ret %x\n";
      goto LABEL_29;
    }
    (*(void (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 432LL))(this, &v79);
    *((_BYTE *)this + 7396) |= 1u;
    *((_BYTE *)this + 96) = 0;
    v5 = 0;
    if ( IO80211PeerManager::shouldLog(this, 0x2000000000LL) )
    {
      LODWORD(v55) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       0x2000000000LL);
      v38 = OSMetaClass::getClassName(v55);
      v40 = "%s::%s configure done! \n ";
      v41 = (__int64)"configure";
      v5 = 0;
      goto LABEL_32;
    }
  }
  return (unsigned int)v5;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000025EBE) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::configureValidNANChannels(IO80211AWDLPeerManager *this)
{
  IO80211AWDLPeerManager *v1; // r12@1
  IO80211VirtualInterface *v2; // rdi@1
  char v3; // al@4
  signed __int64 v4; // r13@5
  signed __int64 v5; // r14@5
  OSMetaClass *v6; // rax@6
  __int64 v7; // rcx@6
  __int64 v8; // r9@6
  int v9; // ST08_4@6
  int v10; // ST00_4@6
  const char *v11; // rdx@6
  __int64 v12; // r8@6
  IO80211PeerManager *v13; // rdi@6
  __int64 v14; // rsi@6
  __int64 v15; // rax@7
  bool v16; // r15@7
  OSMetaClass *v17; // rax@9
  __int64 v18; // rax@9
  char *v19; // rsi@10
  unsigned int v20; // er14@11
  signed int v21; // eax@12
  OSMetaClass *v22; // rax@13
  __int64 v23; // rcx@13
  __int64 v24; // r9@13
  OSMetaClass *v25; // rax@17
  __int64 v26; // rax@17
  __int64 v27; // r9@17
  OSMetaClass *v28; // rax@19
  __int64 v29; // rax@19
  __int64 v30; // r9@19
  int v31; // er13@22
  OSMetaClass *v32; // rax@23
  __int64 v33; // rax@23
  OSMetaClass *v34; // rax@25
  __int64 v35; // rax@25
  OSMetaClass *v36; // rax@26
  int v37; // ST08_4@26
  int v38; // ST00_4@26
  OSMetaClass *v40; // rax@29
  __int64 v41; // rax@29
  signed __int64 v42; // rsi@50
  OSMetaClass *v43; // rax@51
  __int64 v44; // rcx@51
  __int64 v45; // r9@51
  const char *v46; // rdx@51
  OSMetaClass *v47; // rax@52
  char v48; // bl@53
  OSMetaClass *v49; // rax@53
  __int64 v50; // rcx@53
  __int64 v51; // r9@53
  const char *v52; // rdx@54
  int v53; // [sp+18h] [bp-48h]@24
  char v54; // [sp+1Dh] [bp-43h]@10
  int v55; // [sp+20h] [bp-40h]@3
  int v56; // [sp+24h] [bp-3Ch]@22
  IO80211AWDLPeerManager *v57; // [sp+28h] [bp-38h]@22

  v1 = this;
  *((_BYTE *)this + 7604) = 0;
  v2 = (IO80211VirtualInterface *)*((_QWORD *)this + 16);
  if ( v2 && IO80211VirtualInterface::dualBandCapable(v2) )
  {
    v55 = -1071093303;
    memset((char *)v1 + 1540, 0, 0x80CuLL);
    *((_DWORD *)v1 + 385) = 1;
    if ( *((_DWORD *)v1 + 1844) == 5 )
    {
      v3 = IO80211PeerManager::shouldLog(v1, 0x2000000000LL);
    }
    else
    {
      memset((char *)v1 + 1452, 0, 8uLL);
      *((_DWORD *)v1 + 363) = 1;
      v15 = IO80211PeerManager::getController(v1);
      v16 = IO80211Controller::getCountryCode(v15, (char *)v1 + 1452);
      v3 = IO80211PeerManager::shouldLog(v1, 0x2000000000LL);
      if ( !v16 )
      {
        if ( v3 )
        {
          LODWORD(v28) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)v1 + 56LL))(
                           v1,
                           0x2000000000LL);
          v29 = OSMetaClass::getClassName(v28);
          IO80211PeerManager::logDebug(
            v1,
            0x2000000000LL,
            "%s::%s  Unable to get country code\n",
            v29,
            (__int64)"configureValidNANChannels",
            v30);
        }
        v19 = " ";
        memcpy((char *)v1 + 1456, " ", 1uLL);
        goto LABEL_26;
      }
    }
    if ( v3 )
    {
      LODWORD(v17) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)v1 + 56LL))(
                       v1,
                       0x2000000000LL);
      v18 = OSMetaClass::getClassName(v17);
      IO80211PeerManager::logDebug(
        v1,
        0x2000000000LL,
        "%s::%s country code %s\n",
        v18,
        (__int64)"configureValidNANChannels",
        (__int64)((char *)v1 + 1456));
    }
    memset(&v54, 0, 3uLL);
    v19 = &v54;
    if ( !memcmp((char *)v1 + 1456, &v54, 3uLL) )
    {
      if ( *((_DWORD *)v1 + 1892) && *((_DWORD *)v1 + 1844) != 5 )
      {
        LODWORD(v25) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, char *))(*(_QWORD *)v1 + 56LL))(v1, &v54);
        v26 = OSMetaClass::getClassName(v25);
        v19 = 0;
        IO80211PeerManager::logDebug(
          v1,
          0x2000000000LL,
          "%s::%s We don't have a country code, setting internal state to request for CC from an AWDL peer\n",
          v26,
          (__int64)"configureValidNANChannels",
          v27);
        *((_DWORD *)v1 + 1844) = 2;
      }
    }
    else
    {
      v20 = *((_DWORD *)v1 + 1844);
      if ( v20 > 5 || (v21 = 50, !_bittest((const unsigned int *)&v21, v20)) )
      {
        LODWORD(v22) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, char *))(*(_QWORD *)v1 + 56LL))(v1, &v54);
        v23 = OSMetaClass::getClassName(v22);
        if ( v20 == 3 )
        {
          IO80211PeerManager::logDebug(
            v1,
            0x2000000000LL,
            "%s::%s Country code successfully changed from a peer\n",
            v23,
            (__int64)"configureValidNANChannels",
            v24);
          *((_DWORD *)v1 + 1844) = 4;
        }
        else
        {
          IO80211PeerManager::logDebug(
            v1,
            0x2000000000LL,
            "%s::%s Valid host determined country code\n",
            v23,
            (__int64)"configureValidNANChannels",
            v24);
          *((_DWORD *)v1 + 1844) = 1;
        }
      }
      v56 = 207;
      v57 = (IO80211AWDLPeerManager *)((char *)v1 + 1540);
      v31 = IO80211PeerManager::ioctl_internal(v1, (__int64)&v55);
      if ( v31 )
      {
        LODWORD(v32) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)v1 + 56LL))(v1, &v55);
        v33 = OSMetaClass::getClassName(v32);
        IO80211PeerManager::logDebug(
          v1,
          0x2000000000LL,
          "%s::%s  Unable to get non DFS 40MHz channels ret %d\n",
          v33,
          (__int64)"configureValidNANChannels",
          (unsigned int)v31);
        v4 = (signed __int64)((char *)v1 + 1524);
        v5 = (signed __int64)((char *)v1 + 1528);
        goto LABEL_6;
      }
      v53 = 0;
      if ( (unsigned __int16)(*((_WORD *)v1 + 774) - 1) < 0x80u )
      {
        if ( !(unsigned int)IO80211AWDLPeerManager::isValidChannel(
                              v1,
                              (__int64)((char *)v1 + 1540),
                              *((_DWORD *)v1 + 380),
                              0,
                              (__int64)&v53) )
        {
          LODWORD(v40) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)v1 + 56LL))(
                           v1,
                           (char *)v1 + 1540);
          v41 = OSMetaClass::getClassName(v40);
          IO80211PeerManager::logDebug(
            v1,
            0x2000000000LL,
            "%s::%s %d not a valid channel defaulting to %d\n",
            v41,
            (__int64)"configureValidNANChannels",
            *((_DWORD *)v1 + 380));
          *((_DWORD *)v1 + 380) = 6;
        }
        v4 = (signed __int64)((char *)v1 + 1524);
        if ( (unsigned int)IO80211AWDLPeerManager::isValidChannel(
                             v1,
                             (__int64)((char *)v1 + 1540),
                             *((_DWORD *)v1 + 381),
                             0,
                             (__int64)&v53) )
        {
          if ( *((_DWORD *)v1 + 2030) != 1 && v53 & 0x18 )
            *((_BYTE *)v1 + 7604) = 1;
        }
        else if ( (unsigned int)IO80211AWDLPeerManager::isValidChannel(
                                  v1,
                                  (__int64)((char *)v1 + 1540),
                                  149,
                                  0,
                                  (__int64)&v53) )
        {
          if ( *((_DWORD *)v1 + 2030) != 1 && v53 & 0x18 )
            *((_BYTE *)v1 + 7604) = 1;
          *(_DWORD *)v4 = 149;
        }
        else
        {
          *(_DWORD *)v4 = 0;
        }
        v5 = (signed __int64)((char *)v1 + 1528);
        if ( (unsigned int)IO80211AWDLPeerManager::isValidChannel(
                             v1,
                             (__int64)((char *)v1 + 1540),
                             *((_DWORD *)v1 + 382),
                             0,
                             (__int64)&v53) )
        {
          if ( *((_DWORD *)v1 + 2030) != 1 && v53 & 0x18 )
            *((_BYTE *)v1 + 7604) = 1;
        }
        else if ( (unsigned int)IO80211AWDLPeerManager::isValidChannel(
                                  v1,
                                  (__int64)((char *)v1 + 1540),
                                  44,
                                  0,
                                  (__int64)&v53) )
        {
          if ( *((_DWORD *)v1 + 2030) != 1 && v53 & 0x18 )
            *((_BYTE *)v1 + 7604) = 1;
          *(_DWORD *)v5 = 44;
        }
        else
        {
          *(_DWORD *)v5 = 0;
        }
        v42 = (signed __int64)((char *)v1 + 1540);
        if ( (unsigned int)IO80211AWDLPeerManager::isValidChannel(
                             v1,
                             (__int64)((char *)v1 + 1540),
                             *((_DWORD *)v1 + 26),
                             1,
                             (__int64)&v53) )
        {
          *((_BYTE *)v1 + 3636) = 1;
          LODWORD(v43) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)v1 + 56LL))(
                           v1,
                           v42);
          v44 = OSMetaClass::getClassName(v43);
          v45 = *((_DWORD *)v1 + 26);
          v46 = "%s::%s Associated on DFS channel %u!\n";
        }
        else
        {
          *((_BYTE *)v1 + 3636) = 0;
          LODWORD(v47) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)v1 + 56LL))(
                           v1,
                           v42);
          v44 = OSMetaClass::getClassName(v47);
          v45 = *((_DWORD *)v1 + 26);
          v46 = "%s::%s Associated on NON-DFS channel %u!\n";
        }
        IO80211PeerManager::logDebug(v1, 0x2000000000LL, v46, v44, (__int64)"configureValidNANChannels", v45);
        v48 = *((_BYTE *)v1 + 7604);
        LODWORD(v49) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)v1 + 56LL))(
                         v1,
                         0x2000000000LL);
        v50 = OSMetaClass::getClassName(v49);
        if ( v48 )
          v52 = "%s::%s AWDL is allowed to use 40MHz+\n";
        else
          v52 = "%s::%s AWDL is allowed to use only 20MHz\n";
        IO80211PeerManager::logDebug(v1, 0x2000000000LL, v52, v50, (__int64)"configureValidNANChannels", v51);
        goto LABEL_6;
      }
      LODWORD(v34) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)v1 + 56LL))(v1, &v55);
      v35 = OSMetaClass::getClassName(v34);
      v19 = 0;
      IO80211PeerManager::logDebug(
        v1,
        0x2000000000LL,
        "%s::%s ERROR! invalid number of chanspecs %d\n",
        v35,
        (__int64)"configureValidNANChannels",
        *((_WORD *)v1 + 774));
    }
LABEL_26:
    *(_QWORD *)((char *)v1 + 1524) = 0LL;
    LODWORD(v36) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, char *))(*(_QWORD *)v1 + 56LL))(v1, v19);
    v7 = OSMetaClass::getClassName(v36);
    v8 = *((_DWORD *)v1 + 380);
    v37 = *((_DWORD *)v1 + 382);
    v38 = *((_DWORD *)v1 + 381);
    v11 = "%s::%s cannot use 5G; social channel 2G: %u on 5G: %u 5G Alt: %u country code: %s\n";
    v12 = (__int64)"configureValidNANChannels";
    v13 = v1;
    v14 = 0x2000000000LL;
    return IO80211PeerManager::logDebug(v13, v14, v11, v7, v12, v8);
  }
  v4 = (signed __int64)((char *)v1 + 1524);
  *(_QWORD *)((char *)v1 + 1524) = 0LL;
  v5 = (signed __int64)((char *)v1 + 1528);
LABEL_6:
  LODWORD(v6) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)v1 + 56LL))(v1);
  v7 = OSMetaClass::getClassName(v6);
  v8 = *((_DWORD *)v1 + 380);
  v9 = *(_DWORD *)v5;
  v10 = *(_DWORD *)v4;
  v11 = "%s::%s social channel 2G: %u on 5G: %u 5G Alt: %u country code: %s\n";
  v12 = (__int64)"configureValidNANChannels";
  v13 = v1;
  v14 = 0x2000000000LL;
  return IO80211PeerManager::logDebug(v13, v14, v11, v7, v12, v8);
}

//----- (000000000002658C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setElectionMetricsToDefault(__int64 a1, __int64 a2)
{
  int v2; // eax@1
  __int64 result; // rax@2

  *(_DWORD *)(a1 + 7400) = 0;
  v2 = 8 * (unsigned __int8)*(_DWORD *)(a1 + 3972) & 0x10;
  if ( *(_DWORD *)(a1 + 3968) )
    result = v2 ^ 0x50u;
  else
    result = v2 ^ 0x70u;
  *(_DWORD *)(a2 + 4) = result;
  return result;
}

//----- (00000000000265BC) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlElectionMetric(IO80211PeerManager *this, __int64 a2)
{
  int v2; // er14@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rcx@2
  __int64 v5; // r9@2
  int v6; // ST00_4@4
  int v7; // er12@4
  OSMetaClass *v8; // rax@5
  __int64 v9; // rax@5
  __int64 v10; // r9@5
  __int64 v11; // r15@6
  unsigned int v12; // er12@6
  unsigned int v13; // er13@6
  int v14; // ST00_4@6
  int v16; // [sp+10h] [bp-40h]@2
  int v17; // [sp+14h] [bp-3Ch]@2
  __int64 v18; // [sp+18h] [bp-38h]@2

  v2 = 0;
  if ( *((_DWORD *)this + 932) != *(_DWORD *)(a2 + 4) )
  {
    v16 = -2144835128;
    v17 = 126;
    v18 = a2;
    LODWORD(v3) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
    v4 = OSMetaClass::getClassName(v3);
    v5 = (__int64)"!_airplaySink";
    if ( *((_DWORD *)this + 992) )
      v5 = (__int64)"_airplaySink";
    v6 = *(_DWORD *)(a2 + 4);
    v2 = 0;
    IO80211PeerManager::logDebug(
      this,
      137447342080LL,
      "%s::%s setting metric %s -> %u\n",
      v4,
      (__int64)"setAwdlElectionMetric",
      v5);
    v7 = IO80211PeerManager::ioctl_internal(this, (__int64)&v16);
    if ( v7 )
    {
      LODWORD(v8) = (*(int (__fastcall **)(IO80211PeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v16);
      v9 = OSMetaClass::getClassName(v8);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s can't set election metric ret=%d\n",
        v9,
        (__int64)"setAwdlElectionMetric",
        (unsigned int)v7,
        v10);
      v2 = v7;
    }
    else
    {
      *((_DWORD *)this + 932) = *(_DWORD *)(a2 + 4);
      v11 = getAbsoluteTime();
      *((_QWORD *)this + 492) = v11;
      v12 = *((_DWORD *)this + 932);
      v13 = *((_DWORD *)this + 1850);
      v14 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v11)) >> 64) >> 18;
      IO80211PeerManager::logDebug(this, 0x800000LL, "%d: met %x   flags %x _lastTimeSince %u\n", 10262LL, v12, v13);
    }
  }
  return (unsigned int)v2;
}

//----- (0000000000026710) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setChannelSequenceUnconditional(IO80211AWDLPeerManager *this, char a2)
{
  char v2; // r15@1
  IO80211AWDLPeerManager *v3; // r12@1
  __int64 v4; // r14@1
  unsigned __int8 v5; // cl@1
  unsigned __int8 v6; // dl@1
  unsigned __int8 v7; // al@1
  char *v8; // rsi@2
  __int64 v9; // rdi@2
  int v10; // er15@5
  unsigned int v11; // er13@7
  size_t v12; // rsi@7
  unsigned int v13; // er14@8
  char *v14; // rcx@11
  __int64 v15; // r8@13
  OSMetaClass *v16; // rax@14
  __int64 v17; // r10@14
  unsigned __int64 v18; // rcx@14
  char *v19; // rbx@15
  unsigned __int64 v20; // rcx@16
  char *v21; // rdi@17
  int v22; // ST10_4@18
  int v23; // ST08_4@18
  int v24; // ST00_4@18
  unsigned int v25; // ebx@18
  __int64 v26; // rcx@18
  __int64 v27; // r8@18
  __int64 v28; // r9@18
  OSMetaClass *v29; // rax@21
  __int64 v30; // rdx@21
  unsigned __int64 v31; // rsi@21
  char *v32; // rsi@22
  int v33; // ST08_4@24
  int v34; // ST00_4@24
  unsigned int v35; // ebx@24
  __int64 v36; // rdx@24
  __int64 v37; // rcx@24
  __int64 v38; // r8@24
  __int64 v39; // r9@24
  __int64 result; // rax@28
  int v41; // [sp+38h] [bp-2D8h]@1
  char v42; // [sp+3Ch] [bp-2D4h]@4
  unsigned __int8 v43; // [sp+3Dh] [bp-2D3h]@1
  char v44; // [sp+3Eh] [bp-2D2h]@1
  char v45; // [sp+3Fh] [bp-2D1h]@1
  char v46; // [sp+40h] [bp-2D0h]@1
  char v47; // [sp+41h] [bp-2CFh]@1
  char v48; // [sp+48h] [bp-2C8h]@2
  int v49; // [sp+1C8h] [bp-148h]@1
  int v50; // [sp+1CCh] [bp-144h]@20
  int *v51; // [sp+1D0h] [bp-140h]@20
  char v52[256]; // [sp+1E0h] [bp-130h]@7
  __int64 v53; // [sp+2E0h] [bp-30h]@1

  v2 = a2;
  v3 = this;
  v4 = off_7B078[0];
  v53 = *(_QWORD *)off_7B078[0];
  memset(&v49, 0, 0x18uLL);
  __bzero(&v41, 400LL);
  v41 = 1;
  v44 = *((_BYTE *)this + 7604);
  v5 = *((_BYTE *)this + 7584);
  v43 = v5;
  v6 = *((_BYTE *)this + 7605);
  v45 = *((_BYTE *)this + 7605);
  v7 = *((_BYTE *)this + 7600);
  v46 = *((_BYTE *)this + 7600);
  v47 = *((_BYTE *)this + 7601);
  if ( v5 )
  {
    v8 = &v48;
    v9 = 0LL;
    do
    {
      *(_DWORD *)v8 = *((_BYTE *)v3 + v9++ + 7606);
      v8 += 12;
    }
    while ( (signed int)v9 < v43 );
  }
  v42 = *((_BYTE *)v3 + 8120);
  if ( v2 )
  {
    v10 = 0;
    if ( !memcmp((char *)v3 + 1040, &v41, 0x190uLL) )
      goto LABEL_28;
    v5 = *((_BYTE *)v3 + 7584);
    v7 = *((_BYTE *)v3 + 7600);
    v6 = *((_BYTE *)v3 + 7605);
  }
  *((_WORD *)v3 + 3801) = v5 * (v6 + 1) * (v7 + 1);
  v11 = 0;
  v12 = 0LL;
  memset(v52, 0, 0x100uLL);
  if ( *((_BYTE *)v3 + 7584) )
  {
    v13 = 0;
    do
    {
      v12 = 0LL;
      if ( v13 <= 0xFE )
        v12 = 255 - v13;
      v14 = &byte_690F5;
      if ( v11 )
        v14 = " ";
      v15 = *((_BYTE *)v3 + v11 + 7606);
      v13 += snprintf(&v52[v13], v12, "%s%u", v14);
      ++v11;
    }
    while ( v11 < *((_BYTE *)v3 + 7584) );
  }
  LODWORD(v16) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, size_t))(*(_QWORD *)v3 + 56LL))(v3, v12);
  v17 = OSMetaClass::getClassName(v16);
  v18 = *((_DWORD *)v3 + 259);
  if ( v18 <= 3 )
    v19 = off_7D180[v18];
  v20 = *((_DWORD *)v3 + 1244);
  if ( v20 <= 0xB )
    v21 = off_7D120[v20];
  v22 = *((_BYTE *)v3 + 7604);
  v23 = *((_BYTE *)v3 + 7605);
  v24 = *((_WORD *)v3 + 3801);
  v25 = 0;
  IO80211PeerManager::logDebug(
    v3,
    0x2000000000LL,
    "%s::%s coded length %u length %u step %u encoding %u (%s %s) [%s]\n",
    v17,
    (__int64)"setChannelSequenceUnconditional",
    *((_BYTE *)v3 + 7584));
  if ( *((_BYTE *)v3 + 7584) )
  {
    do
      IO80211PeerManager::logDebug(v3, 0x2000000000LL, "%u ", *((_BYTE *)v3 + v25++ + 7606), v27, v28);
    while ( v25 < *((_BYTE *)v3 + 7584) );
  }
  IO80211PeerManager::logDebug(v3, 0x2000000000LL, "\n", v26, v27, v28);
  v49 = -2144835128;
  v50 = 129;
  v51 = &v41;
  v10 = IO80211PeerManager::ioctl_internal(v3, (__int64)&v49);
  if ( v10 )
  {
    LODWORD(v29) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)v3 + 56LL))(v3, &v49);
    v30 = OSMetaClass::getClassName(v29);
    v31 = *((_DWORD *)v3 + 1244);
    if ( v31 <= 0xB )
      v32 = off_7D120[v31];
    v33 = *((_BYTE *)v3 + 7601);
    v34 = *((_BYTE *)v3 + 7605);
    v35 = 0;
    IO80211PeerManager::logDebug(
      v3,
      "%s::%s : Couldn't set channel sequence! coded length %u length %u step %u fill %x (%s):\n",
      v30,
      (__int64)"setChannelSequenceUnconditional",
      *((_BYTE *)v3 + 7584),
      *((_WORD *)v3 + 3801));
    if ( *((_BYTE *)v3 + 7584) )
    {
      do
        IO80211PeerManager::logDebug(v3, "%u ", *((_BYTE *)v3 + v35++ + 7606), v37, v38, v39);
      while ( v35 < *((_BYTE *)v3 + 7584) );
    }
    IO80211PeerManager::logDebug(v3, "\n", v36, v37, v38, v39);
    bzero((char *)v3 + 1040, 0x190uLL);
  }
  else
  {
    memcpy((char *)v3 + 1040, &v41, 0x190uLL);
  }
  IO80211AWDLPeerManager::updateAndSendMI(v3, 0);
  v4 = off_7B078[0];
LABEL_28:
  result = *(_QWORD *)v4;
  if ( *(_QWORD *)v4 == v53 )
    result = (unsigned int)v10;
  return result;
}
// 690F5: using guessed type char byte_690F5;
// 7B078: using guessed type __int64 off_7B078[7];
// 7D120: using guessed type char *off_7D120[33];
// 7D180: using guessed type char *off_7D180[21];
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);
// 26710: using guessed type char var_130[256];

//----- (0000000000026B48) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setPresenceMode(IO80211AWDLPeerManager *this, unsigned int a2)
{
  int v2; // er12@1
  int v3; // er15@2
  OSMetaClass *v4; // rax@3
  __int64 v5; // rax@3
  int v7; // [sp+0h] [bp-40h]@2
  int v8; // [sp+4h] [bp-3Ch]@1
  __int64 *v9; // [sp+8h] [bp-38h]@1
  __int64 v10; // [sp+18h] [bp-28h]@1

  v10 = 1LL;
  v8 = 136;
  v9 = &v10;
  v2 = 0;
  if ( *((_BYTE *)this + 1512) != a2 )
  {
    v7 = -2144835128;
    HIDWORD(v10) = a2;
    v3 = IO80211PeerManager::ioctl_internal(this, (__int64)&v7);
    if ( v3 )
    {
      LODWORD(v4) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v7);
      v5 = OSMetaClass::getClassName(v4);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s mode %u fail %x\n",
        v5,
        (__int64)"setPresenceMode",
        a2,
        (unsigned int)v3);
      v2 = v3;
    }
    else
    {
      *((_BYTE *)this + 1512) = a2;
    }
  }
  return (unsigned int)v2;
}

//----- (0000000000026BF0) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::setMinExt(IO80211AWDLPeerManager *this, __int64 a2, __int64 a3)
{
  IO80211AWDLPeerManager *v3; // rbx@1
  signed __int64 v4; // rcx@1
  signed __int64 v5; // rsi@4
  char *v6; // r15@5
  int v7; // eax@5
  unsigned int v8; // er14@6
  __int64 v9; // rdx@17
  __int64 v10; // rsi@17
  OSMetaClass *v11; // rax@17
  __int64 v12; // r10@17
  unsigned __int64 v13; // rax@17
  char v14[8]; // r9@18
  int v15; // ST28_4@20
  int v16; // ST18_4@20
  unsigned int v17; // ST10_4@20
  int v18; // ST00_4@20
  OSMetaClass *v19; // rax@21
  __int64 v20; // r10@21
  __int64 v21; // r9@21
  int v22; // er8@21
  int v23; // edx@21
  int v24; // esi@21
  int v25; // edi@21
  unsigned __int64 v26; // rcx@21
  char *v27; // rcx@22
  int v28; // er14@23
  OSMetaClass *v29; // rax@24
  __int64 v30; // rax@24
  __int64 v31; // r9@24
  IO80211VirtualInterface *v32; // rdi@25
  int v33; // [sp+38h] [bp-48h]@23
  int v34; // [sp+3Ch] [bp-44h]@23
  __int64 *v35; // [sp+40h] [bp-40h]@23
  __int64 v36; // [sp+50h] [bp-30h]@23
  int v37; // [sp+58h] [bp-28h]@23
  int v38; // [sp+5Ch] [bp-24h]@23
  int v39; // [sp+60h] [bp-20h]@23

  v3 = this;
  v4 = *((_DWORD *)this + 375);
  if ( !(_DWORD)v4 )
  {
    *((_DWORD *)this + 375) = 16;
    v4 = 16LL;
  }
  if ( !*((_DWORD *)this + 1007) )
  {
    v5 = *((_BYTE *)this + 1512);
    if ( *((_BYTE *)this + 1512) )
    {
      v6 = (char *)this + 4976;
      v7 = *((_DWORD *)this + 1244);
      if ( v7 == 7 )
      {
        if ( *((_DWORD *)this + 114) )
          v8 = *((_DWORD *)this + 902);
        else
          v8 = *((_DWORD *)this + 901);
      }
      else
      {
        v8 = 0;
        if ( v7 == 4 )
        {
          if ( (*((_DWORD *)this + 259) & 0xFFFFFFFE) == 2 )
          {
            if ( *((_DWORD *)this + 26) )
            {
              v8 = 75;
              if ( (unsigned int)(v5 * *((_DWORD *)this + 373)) >= 0x191 )
                v8 = *((_DWORD *)this + 903);
            }
          }
          goto LABEL_17;
        }
        if ( v7 == 1 )
        {
          *((_BYTE *)this + 1518) = *((_BYTE *)this + 4972);
          goto LABEL_21;
        }
      }
LABEL_17:
      v9 = *((_DWORD *)this + 373) % (unsigned int)v4;
      v10 = (*((_DWORD *)this + 373) - *((_DWORD *)this + 374)) / (unsigned int)v4
          - v8 / (unsigned int)v4
          + *((_DWORD *)this + 373) / (unsigned int)v4 * ((_DWORD)v5 - 1);
      *((_BYTE *)this + 1518) = v10;
      LODWORD(v11) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64, __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       v10,
                       v9);
      v12 = OSMetaClass::getClassName(v11);
      v13 = *((_DWORD *)this + 1244);
      if ( v13 > 0xB )
        *(_QWORD *)v14 = "unknown";
      else
        *(_QWORD *)v14 = off_7D120[v13];
      v15 = *((_DWORD *)this + 114);
      v16 = *((_BYTE *)this + 1512);
      v17 = (unsigned int)(*((_DWORD *)this + 373) - *((_DWORD *)this + 374)) / *((_DWORD *)this + 375);
      v18 = *((_BYTE *)this + 1518);
      v5 = 0x800000LL;
      IO80211PeerManager::logDebug(
        this,
        0x800000LL,
        "%s::%s %s _minExt %u reserved %u numE %u pm %u div %u scanlvl %u\n",
        v12,
        (__int64)"setMinExt",
        *(__int64 *)v14);
      goto LABEL_21;
    }
    *((_BYTE *)this + 1518) = 1;
    v6 = (char *)this + 4976;
LABEL_21:
    LODWORD(v19) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64, __int64, signed __int64))(*(_QWORD *)this + 56LL))(
                     this,
                     v5,
                     a3,
                     v4);
    v20 = OSMetaClass::getClassName(v19);
    v21 = *((_BYTE *)this + 1518);
    v22 = *((_DWORD *)this + 373);
    v23 = *((_DWORD *)this + 374);
    v24 = *((_DWORD *)this + 375);
    v25 = *((_BYTE *)this + 1512);
    v26 = *(_DWORD *)v6;
    if ( v26 <= 0xB )
      v27 = off_7D120[v26];
    IO80211PeerManager::logDebug(
      v3,
      0x800000LL,
      "%s::%s _minExt=%u aw_period %u aw_length %u ext_len %u pm=%u %s\n",
      v20,
      (__int64)"setMinExt",
      v21);
    v37 = 0;
    v36 = 1LL;
    v33 = -2144835128;
    v34 = 118;
    v35 = &v36;
    v39 = *((_BYTE *)v3 + 1518);
    v37 = *((_BYTE *)v3 + 1515);
    v38 = *((_BYTE *)v3 + 1517);
    HIDWORD(v36) = *((_BYTE *)v3 + 1516);
    v28 = IO80211PeerManager::ioctl_internal(v3, (__int64)&v33);
    if ( v28 )
    {
      LODWORD(v29) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)v3 + 56LL))(v3, &v33);
      v30 = OSMetaClass::getClassName(v29);
      IO80211PeerManager::logDebug(
        v3,
        "%s::%s  Unable to set extension params ret %d\n",
        v30,
        (__int64)"setMinExt",
        (unsigned int)v28,
        v31);
    }
    v32 = (IO80211VirtualInterface *)*((_QWORD *)v3 + 16);
    if ( v32 )
      IO80211VirtualInterface::postSyncStateChanged(v32);
  }
}
// 7D120: using guessed type char *off_7D120[33];

//----- (0000000000026ED6) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::reset(IO80211AWDLPeerManager *this)
{
  OSMetaClass *v1; // rax@3
  __int64 v2; // rax@3
  __int64 v3; // r9@3

  IO80211PeerManager::lockDataPath(this);
  *((_DWORD *)this + 257) = 0;
  *((_DWORD *)this + 258) = 0;
  *((_BYTE *)this + 7408) = 0;
  *((_QWORD *)this + 927) = 0LL;
  (*(void (__cdecl **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 424LL))(this);
  memset((char *)this + 100, 0, 0xCuLL);
  if ( *((_DWORD *)this + 1844) != 5 )
    *((_DWORD *)this + 1844) = 0;
  *((_BYTE *)this + 3960) = 0;
  *((_DWORD *)this + 372) = 0;
  *((_DWORD *)this + 1849) = 0;
  LODWORD(v1) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, _QWORD))(*(_QWORD *)this + 56LL))(this, 0LL);
  v2 = OSMetaClass::getClassName(v1);
  IO80211PeerManager::logDebug(this, "%s::%s state %x\n", v2, (__int64)"reset", *((_DWORD *)this + 1849), v3);
  *((_DWORD *)this + 1245) = 0;
  IO80211CommandQueue::map(
    *((_QWORD *)this + 11),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_resetPeers,
    (__int64)this,
    0LL,
    0LL,
    -1);
  IO80211PeerManager::unlockDataPath(this, (__int64)_resetPeers);
  return 0LL;
}

//----- (0000000000026FC0) ----------------------------------------------------
__int64 __fastcall _resetPeers(__int64 a1, IO80211Peer *a2)
{
  IO80211Peer::reset(a2);
  return 0LL;
}

//----- (0000000000026FD0) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::doAwdlDisable(IO80211AWDLPeerManager *this, int a2)
{
  int v2; // eax@1
  int v3; // eax@2
  unsigned int v4; // er15@4
  unsigned int v5; // er12@4
  __int64 v6; // r13@4
  int v7; // ST00_4@4
  int v8; // eax@4
  int v9; // er15@5
  OSMetaClass *v10; // rax@6
  __int64 v11; // rax@6
  __int64 v12; // r9@6
  int v14; // [sp+8h] [bp-58h]@5
  int v15; // [sp+Ch] [bp-54h]@5
  __int64 *v16; // [sp+10h] [bp-50h]@5
  __int64 v17; // [sp+20h] [bp-40h]@5
  int v18; // [sp+28h] [bp-38h]@5
  __int64 v19; // [sp+30h] [bp-30h]@1

  v19 = 1LL;
  (*(void (**)(void))(*(_QWORD *)this + 424LL))();
  *((_DWORD *)this + 372) = 0;
  *((_DWORD *)this + 1850) = 0;
  v2 = 8 * (unsigned __int8)*((_DWORD *)this + 993) & 0x10;
  if ( *((_DWORD *)this + 992) )
    v3 = v2 ^ 0x50;
  else
    v3 = v2 ^ 0x70;
  HIDWORD(v19) = v3;
  IO80211AWDLPeerManager::setAwdlElectionMetric(this, (__int64)&v19);
  v4 = *((_DWORD *)this + 932);
  v5 = *((_DWORD *)this + 1850);
  v6 = *((_QWORD *)this + 492);
  v7 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v6)) >> 64) >> 18;
  IO80211PeerManager::logDebug(
    this,
    0x800000LL,
    "%d: met %x   flags %x _lastTimeSince %u; Time going to 0 \n",
    1677LL,
    v4,
    v5);
  *((_QWORD *)this + 492) = 0LL;
  v8 = *((_DWORD *)this + 1849);
  if ( v8 & 2 )
  {
    *((_DWORD *)this + 1849) = v8 & 0xFFFFFFFD;
    *((_DWORD *)this + 1245) = 0;
    v17 = 1LL;
    v18 = 0;
    v14 = -2144835128;
    v15 = 117;
    v16 = &v17;
    v9 = IO80211PeerManager::ioctl_internal(this, (__int64)&v14);
    if ( v9 )
    {
      LODWORD(v10) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v14);
      v11 = OSMetaClass::getClassName(v10);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s  AWDLcan't DISABLE!! %d\n",
        v11,
        (__int64)"doAwdlDisable",
        (unsigned int)v9,
        v12);
    }
  }
  *((_DWORD *)this + 1849) &= ~a2 & 0xFFFFFFFB;
  *((_DWORD *)this + 257) = 0;
  *((_DWORD *)this + 258) = 0;
  *((_BYTE *)this + 7408) = 0;
  *((_QWORD *)this + 927) = 0LL;
  memset((char *)this + 100, 0, 0xCuLL);
  IO80211PeerManager::removeAllPeers(this);
  IO80211PeerManager::flushFreeMbufs(this);
  return IO80211AWDLPeerManager::awdlStatsPostMetrics(this, 0LL);
}

//----- (000000000002718C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::awdlStatsPostMetrics(IO80211AWDLPeerManager *this, __int64 a2)
{
  IO80211AWDLPeerManager *v2; // rbx@1
  unsigned int v3; // ecx@1
  __int64 v4; // r14@3
  __int64 v5; // r15@3
  int v6; // eax@3
  __int64 v7; // rcx@3
  __int64 v8; // rdx@3
  __int64 v9; // r8@3
  __int64 v10; // r9@3
  __int64 result; // rax@3
  __int64 v12; // rdi@3

  v2 = this;
  v3 = *((_DWORD *)this + 2065) | 1;
  if ( *((_BYTE *)this + 1456) != 88 )
    v3 = *((_DWORD *)this + 2065) & 0xFFFFFFFE;
  *((_DWORD *)this + 2065) = v3;
  v4 = *((_QWORD *)this + 1060);
  v5 = *((_DWORD *)this + 1244);
  *((_QWORD *)this + 2 * v5 + 1037) += (unsigned __int64)((unsigned __int128)(4835703278458516699LL
                                                                            * (getAbsoluteTime() - v4)) >> 64) >> 18;
  v6 = *((_DWORD *)this + 209);
  *((_DWORD *)this + 2066) += *((_DWORD *)this + 209) - *((_DWORD *)this + 2122);
  v7 = *((_DWORD *)this + 208);
  v8 = (unsigned int)(*((_DWORD *)this + 208) - *((_DWORD *)this + 2123));
  *((_DWORD *)this + 2067) += v8;
  *((_DWORD *)this + 2122) = v6;
  *((_DWORD *)this + 2123) = v7;
  result = IO80211AWDLPeerManager::awdlStatsPrintMetric(this, a2, v8, v7, v9, v10);
  v12 = *((_QWORD *)this + 16);
  if ( v12 )
    result = IO80211VirtualInterface::postAwdlStatistics(v12, (char *)v2 + 8256);
  return result;
}

//----- (000000000002725A) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::doDisable(IO80211AWDLPeerManager *this, char *a2)
{
  IO80211AWDLPeerManager::doAwdlDisable(this, 8);
  *((_BYTE *)this + 3960) = 0;
  JUMPOUT(__CS__, `vtable for'IO80211PeerManager[53]);
}
// 7D5B0: using guessed type __int64 `vtable for'IO80211PeerManager[2];

//----- (0000000000027290) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::disableWorkLoopSources(IO80211AWDLPeerManager *this)
{
  IO80211AWDLPeerManager *v1; // rbx@1
  __int64 v2; // rdi@1
  __int64 v3; // rdi@3
  __int64 v4; // rdi@5
  __int64 v5; // rdi@7
  __int64 v6; // rdi@9

  v1 = this;
  v2 = *((_QWORD *)this + 615);
  if ( v2 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v2 + 536LL))(v2);
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 615) + 344LL))(*((_QWORD *)v1 + 615));
  }
  v3 = *((_QWORD *)v1 + 617);
  if ( v3 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v3 + 536LL))(v3);
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 617) + 344LL))(*((_QWORD *)v1 + 617));
  }
  v4 = *((_QWORD *)v1 + 618);
  if ( v4 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v4 + 536LL))(v4);
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 618) + 344LL))(*((_QWORD *)v1 + 618));
  }
  v5 = *((_QWORD *)v1 + 616);
  if ( v5 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v5 + 536LL))(v5);
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 616) + 344LL))(*((_QWORD *)v1 + 616));
  }
  v6 = *((_QWORD *)v1 + 79);
  if ( v6 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v6 + 536LL))(v6);
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 79) + 344LL))(*((_QWORD *)v1 + 79));
  }
  JUMPOUT(__CS__, `vtable for'IO80211PeerManager[55]);
}
// 7D5B0: using guessed type __int64 `vtable for'IO80211PeerManager[2];

//----- (0000000000027368) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::enableWorkLoopSources(IO80211AWDLPeerManager *this)
{
  IO80211AWDLPeerManager *v1; // rbx@1
  __int64 v2; // rdi@1
  __int64 v3; // rdi@3
  __int64 v4; // rdi@5
  __int64 v5; // rdi@7
  __int64 v6; // rdi@9

  v1 = this;
  v2 = *((_QWORD *)this + 615);
  if ( v2 )
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v2 + 336LL))(v2);
  v3 = *((_QWORD *)v1 + 617);
  if ( v3 )
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v3 + 336LL))(v3);
  v4 = *((_QWORD *)v1 + 618);
  if ( v4 )
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v4 + 336LL))(v4);
  v5 = *((_QWORD *)v1 + 616);
  if ( v5 )
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v5 + 336LL))(v5);
  v6 = *((_QWORD *)v1 + 79);
  if ( v6 )
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v6 + 336LL))(v6);
  JUMPOUT(__CS__, `vtable for'IO80211PeerManager[56]);
}
// 7D5B0: using guessed type __int64 `vtable for'IO80211PeerManager[2];

//----- (00000000000273F0) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::setScanningState(IO80211PeerManager *this, __int64 a2, unsigned __int8 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int v5; // eax@5
  int v6; // eax@7
  OSMetaClass *v7; // rax@8
  __int64 v8; // rax@8
  __int64 v9; // r9@8
  unsigned int v10; // esi@8
  OSMetaClass *v11; // rax@11
  __int64 v12; // rax@11
  __int64 v13; // r8@11
  __int64 v14; // r9@11
  OSMetaClass *v15; // rax@13
  __int64 v16; // rax@13

  v4 = a4;
  ((void (__fastcall *)(IO80211PeerManager *, __int64, _QWORD))`vtable for'IO80211PeerManager[44])(this, a2, a3);
  if ( *((_DWORD *)this + 1238) && (!*((_DWORD *)this + 914) || *((_DWORD *)this + 139)) && *((_BYTE *)this + 7396) & 2 )
  {
    v5 = *((_DWORD *)this + 259);
    if ( *((_DWORD *)this + 139) )
    {
      if ( !v5 )
        goto LABEL_21;
      v6 = *((_DWORD *)this + 1244);
      if ( !v6 )
      {
        LODWORD(v7) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
        v8 = OSMetaClass::getClassName(v7);
        IO80211PeerManager::logDebug(
          this,
          0x800000LL,
          "%s::%s Scan requested while in MinimumFast, moving to minimum\n",
          v8,
          (__int64)"setScanningState",
          v9);
        v10 = 1;
LABEL_22:
        IO80211AWDLPeerManager::setScheduleState(this, v10, 0);
        return;
      }
      if ( v6 == 4 )
      {
        if ( *((_DWORD *)this + 1891) && IO80211AWDLPeerManager::usePiggybackScan(this, v4) )
        {
          *(_BYTE *)(v4 + 1608) |= 4u;
          memcpy((char *)this + 4984, (const void *)v4, 0x954uLL);
          *((_DWORD *)this + 1245) = 1;
          return;
        }
LABEL_21:
        v10 = 7;
        goto LABEL_22;
      }
    }
    else
    {
      if ( !v5 )
        goto LABEL_25;
      if ( *((_DWORD *)this + 1245) == 1 )
      {
        LODWORD(v11) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
        v12 = OSMetaClass::getClassName(v11);
        IO80211PeerManager::logDebug(
          this,
          "%s::%s Driver didn't ack piggyback scan request, resetting state\n",
          v12,
          (__int64)"setScanningState",
          v13,
          v14);
        *((_DWORD *)this + 1245) = 0;
      }
      if ( *((_BYTE *)this + 1514) )
      {
        LODWORD(v15) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
        v16 = OSMetaClass::getClassName(v15);
        IO80211PeerManager::logDebug(
          this,
          0x800000LL,
          "%s::%s Scan completed, restoring PM to %d\n",
          v16,
          (__int64)"setScanningState",
          *((_BYTE *)this + 1513));
        IO80211AWDLPeerManager::setPresenceMode(this, *((_BYTE *)this + 1513));
        *((_BYTE *)this + 1514) = 0;
      }
      if ( *((_DWORD *)this + 1244) == 7 )
      {
LABEL_25:
        v10 = 4;
        goto LABEL_22;
      }
    }
  }
}
// 7D5B0: using guessed type __int64 `vtable for'IO80211PeerManager[2];

//----- (00000000000275A8) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::setScheduleState(IO80211AWDLPeerManager *this, unsigned int a2, char a3)
{
  signed int v3; // er15@1
  IO80211AWDLPeerManager *v4; // r12@1
  int v5; // er13@6
  __int64 v6; // r14@8
  OSMetaClass *v7; // rax@8
  __int64 v8; // r10@8
  unsigned __int64 v9; // rax@8
  char v10[8]; // r9@8
  unsigned __int64 v11; // rax@10
  char *v12; // r8@11
  char *v13; // r11@13
  __int64 v14; // r14@14
  int v15; // ST48_4@14
  int v16; // ST40_4@14
  int v17; // ST38_4@14
  int v18; // ST30_4@14
  __int64 v19; // rbx@15
  __int64 v20; // r14@16
  __int64 v21; // rax@17
  __int64 v22; // r8@17
  __int64 v23; // r9@17
  int v24; // eax@17
  __int64 v25; // rax@19
  char v26; // cl@21
  signed __int64 v27; // rsi@27
  int v28; // ecx@28
  signed __int64 i; // rax@29
  OSMetaClass *v30; // rax@33
  __int64 v31; // rax@33
  __int64 v32; // r9@33
  __int64 v33; // rdx@38
  int v34; // er14@41
  OSMetaClass *v35; // rax@42
  __int64 v36; // rax@42
  __int64 v37; // r9@42
  OSMetaClass *v38; // rax@43
  __int64 v39; // rcx@43
  __int64 v40; // r9@43
  const char *v41; // rdx@43
  __int64 v42; // r8@43
  OSMetaClass *v43; // rax@44
  __int64 v44; // r14@44
  __int64 v45; // rbx@44
  __int64 v46; // rax@44
  OSMetaClass *v47; // rax@49
  __int64 v48; // rax@49
  __int64 v49; // r9@49
  OSMetaClass *v50; // rax@51
  __int64 v51; // rax@51
  __int64 v52; // r9@51
  unsigned int v53; // er13@53
  signed int v54; // ebx@53
  char v55; // cl@54
  char v56; // al@54
  char v57; // al@56
  char v58; // al@59
  char v59; // al@60
  char v60; // al@63
  char v61; // al@67
  char v62; // cl@67
  char v63; // dl@67
  char v64; // al@68
  OSMetaClass *v65; // rax@69
  __int64 v66; // rax@69
  char v67; // al@74
  char v68; // cl@74
  char v69; // al@78
  int v70; // ecx@79
  char v71; // al@80
  char v72; // cl@80
  char v73; // al@81
  OSMetaClass *v74; // rax@82
  __int64 v75; // rax@82
  bool v76; // zf@83
  signed int v77; // ecx@85
  char v78; // al@88
  char v79; // al@90
  char v80; // al@96
  char v81; // al@98
  char v82; // al@101
  char v83; // al@104
  int v84; // eax@106
  char v85; // cl@107
  char v86; // al@111
  char v87; // al@114
  char v88; // cl@116
  char v89; // al@116
  __int64 v90; // rax@118
  bool v91; // cl@120
  char v92; // cl@121
  char v93; // cl@123
  int v94; // ecx@89
  int v95; // ecx@127
  char v96; // cl@128
  char v97; // cl@130
  char v98; // cl@134
  char v99; // al@137
  char v100; // al@140
  char v101; // al@143
  char v102; // di@146
  char v103; // dl@146
  char v104; // cl@148
  char v105; // cl@152
  int v106; // edx@153
  bool v107; // zf@158
  signed int v108; // eax@158
  signed int v109; // ecx@158
  char v110; // bl@168
  char v111; // bl@170
  int v112; // esi@147
  char v113; // dl@173
  int v114; // eax@178
  char v115; // cl@183
  char v116; // cl@185
  int v117; // ecx@162
  int v118; // ecx@195
  int v119; // edx@200
  char v120; // bl@202
  int v121; // eax@208
  bool v122; // zf@211
  signed int v123; // ecx@213
  int v124; // er15@217
  int v125; // ebx@219
  OSMetaClass *v126; // rax@220
  __int64 v127; // rax@220
  __int64 v128; // r9@220
  char v129; // dl@228
  char v130; // dl@230
  char v131; // dl@234
  int v132; // esi@239
  int v133; // ecx@243
  char v134; // bl@245
  char v135; // bl@252
  char v136; // si@256
  char v137; // si@259
  int v138; // esi@253
  int v139; // ecx@265
  char v140; // cl@271
  __int64 v141; // [sp+60h] [bp-60h]@221
  int v142; // [sp+68h] [bp-58h]@219
  int v143; // [sp+6Ch] [bp-54h]@219
  __int64 *v144; // [sp+70h] [bp-50h]@219
  __int64 v145; // [sp+80h] [bp-40h]@219
  int v146; // [sp+88h] [bp-38h]@219
  int v147; // [sp+8Ch] [bp-34h]@219
  int v148; // [sp+90h] [bp-30h]@219

  v3 = a2;
  v4 = this;
  if ( !*((_BYTE *)this + 3960)
    || !(*((_BYTE *)this + 7396) & 1)
    || *((_DWORD *)this + 259) == 3
    || *((_DWORD *)this + 1244) == a2 && !a3 )
    return;
  v5 = *((_DWORD *)this + 904);
  if ( IO80211PeerManager::shouldLog(this, 0x800000LL) && *((_DWORD *)this + 1244) != a2 )
  {
    v6 = *((_QWORD *)this + 938);
    getAbsoluteTime();
    LODWORD(v7) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    0x800000LL);
    v8 = OSMetaClass::getClassName(v7);
    v9 = *((_DWORD *)this + 259);
    *(_QWORD *)v10 = "unknown";
    if ( v9 <= 3 )
      *(_QWORD *)v10 = off_7D180[v9];
    v11 = *((_DWORD *)this + 1244);
    if ( v11 <= 0xB )
      v12 = off_7D120[v11];
    if ( a2 <= 0xB )
      v13 = off_7D120[a2];
    v14 = *((_DWORD *)this + 1849);
    v15 = *((_BYTE *)this + 3636);
    v16 = *((_DWORD *)this + 1245);
    v17 = *((_DWORD *)this + 904);
    v18 = *((_BYTE *)this + 652);
    IO80211PeerManager::logDebug(
      this,
      0x800000LL,
      "%s::%s %s: %s -> %s %llu.%03llu %s syncState %x _enabled %u, aftx_mode: %d, piggybackScanState:%d infraOnDFS %u\n",
      v8,
      (__int64)"setScheduleState",
      *(__int64 *)v10);
  }
  v19 = *((_QWORD *)this + 1060);
  if ( v19 )
  {
    v20 = *((_DWORD *)this + 1244);
    *((_QWORD *)this + 2 * v20 + 1037) += (unsigned __int64)((unsigned __int128)(4835703278458516699LL
                                                                               * (getAbsoluteTime() - v19)) >> 64) >> 18;
  }
  ++*((_DWORD *)this + 4 * a2 + 2072);
  v21 = getAbsoluteTime();
  *((_QWORD *)this + 938) = v21;
  *((_QWORD *)this + 1060) = v21;
  *((_DWORD *)this + 1244) = a2;
  v24 = *((_DWORD *)this + 259);
  if ( !v24 )
  {
    v28 = *((_DWORD *)this + 26);
    if ( v28 )
    {
      *((_BYTE *)this + 7584) = 16;
      *((_BYTE *)this + 7605) = 3;
      for ( i = 7606LL; ; ++i )
      {
        *((_BYTE *)this + i) = v28;
        if ( (signed int)i - 7605 >= *((_BYTE *)this + 7584) )
          break;
        v28 = *((_DWORD *)this + 26);
      }
      *((_BYTE *)this + 1518) = 3;
      *((_DWORD *)this + 1882) = 0xFFFF;
      if ( *((_DWORD *)this + 139) )
      {
        LODWORD(v30) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                         this,
                         0x800000LL);
        v31 = OSMetaClass::getClassName(v30);
        IO80211PeerManager::logDebug(
          this,
          0x800000LL,
          "%s::%s FollowsInfra mode: Inserting 0's for scan\n",
          v31,
          (__int64)"setScheduleState",
          v32);
        *(_WORD *)((char *)this + 7611) = 0;
        *((_BYTE *)this + 7613) = 0;
        *((_BYTE *)this + 7619) = 0;
        *((_BYTE *)this + 7620) = 0;
        *((_BYTE *)this + 7621) = 0;
      }
      if ( *((_BYTE *)this + 3960) && *((_BYTE *)this + 7396) & 1 )
        IO80211AWDLPeerManager::setChannelSequenceUnconditional(this, 1);
      v27 = 4LL;
      goto LABEL_38;
    }
    LODWORD(v43) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                     this,
                     0x800000LL);
    v44 = OSMetaClass::getClassName(v43);
    v45 = *((_QWORD *)this + 491);
    v46 = getAbsoluteTime();
    v41 = "%s::%s  WARNING: In FollowsInfra mode without an infrastructure connection for %u ms\n";
    v42 = (__int64)"setScheduleState";
    v39 = v44;
    v40 = (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (v46 - v45)) >> 64) >> 18);
    goto LABEL_45;
  }
  if ( v24 == 2 )
  {
    *((_BYTE *)this + 7584) = 2;
    *((_BYTE *)this + 7605) = *((_BYTE *)this + 3992);
    v25 = 0LL;
    do
    {
      if ( !(v25 & 1) || (v26 = *((_BYTE *)this + 1533)) == 0 )
        v26 = *((_BYTE *)this + 1532);
      *((_BYTE *)this + v25++ + 7606) = v26;
    }
    while ( (signed int)v25 < *((_BYTE *)this + 7584) );
    if ( *((_BYTE *)this + 3960) )
    {
      if ( *((_BYTE *)this + 7396) & 1 )
        IO80211AWDLPeerManager::setChannelSequenceUnconditional(this, 1);
    }
    v27 = *((_DWORD *)this + 997);
LABEL_38:
    IO80211AWDLPeerManager::setPresenceMode(this, v27);
    IO80211AWDLPeerManager::setMinExt(this, v27, v33);
    return;
  }
  if ( v24 != 1 )
  {
    LODWORD(v38) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                     this,
                     0x800000LL);
    v39 = OSMetaClass::getClassName(v38);
    v40 = *((_DWORD *)this + 259);
    v41 = "%s::%s ch sequence %u, do nothing\n";
    v42 = (__int64)"setScheduleState";
LABEL_45:
    IO80211PeerManager::logDebug(this, 0x800000LL, v41, v39, v42, v40);
    return;
  }
  *((_DWORD *)this + 905) = 0;
  if ( *((_BYTE *)this + 7408) )
  {
    v34 = v5;
    if ( a2 == 7 )
    {
      LODWORD(v35) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       0x800000LL);
      v36 = OSMetaClass::getClassName(v35);
      IO80211PeerManager::logDebug(
        this,
        0x800000LL,
        "%s::%s  Setting AlwaysAvailable Real Time With Scans mode\n",
        v36,
        (__int64)"setScheduleState",
        v37);
      v3 = 8;
    }
    else if ( a2 == 4 )
    {
      LODWORD(v47) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       0x800000LL);
      v48 = OSMetaClass::getClassName(v47);
      IO80211PeerManager::logDebug(
        this,
        0x800000LL,
        "%s::%s  Setting AlwaysAvailable Real Time mode\n",
        v48,
        (__int64)"setScheduleState",
        v49);
      v3 = 6;
    }
    else if ( a2 <= 1 )
    {
      LODWORD(v50) = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 56LL))(this, 0x800000LL);
      v51 = OSMetaClass::getClassName(v50);
      IO80211PeerManager::logDebug(
        this,
        0x800000LL,
        "%s::%s  Setting Real Time Minimum mode\n",
        v51,
        (__int64)"setScheduleState",
        v52);
      v3 = 9;
    }
    IO80211AWDLPeerManager::calculateDataChannelsForAlwaysAvailable(this);
  }
  else
  {
    v34 = v5;
  }
  v53 = 0;
  v54 = 110;
  switch ( v3 )
  {
    case 0:
      *((_BYTE *)this + 7584) = 16;
      v55 = *((_BYTE *)this + 1532);
      *((_BYTE *)this + 7606) = v55;
      *((_BYTE *)this + 7607) = v55;
      v56 = *((_BYTE *)this + 1533);
      if ( v56 )
      {
        *((_BYTE *)this + 7608) = v56;
        *((_BYTE *)this + 7609) = v56;
        *((_BYTE *)this + 7610) = v56;
      }
      else
      {
        *((_BYTE *)this + 7608) = v55;
        *((_BYTE *)this + 7609) = v55;
        *((_BYTE *)this + 7610) = v55;
        v56 = v55;
      }
      *((_BYTE *)this + 7611) = v56;
      if ( IO80211AWDLPeerManager::addInfraToMinimumChannelSequence(this) )
        v86 = *((_BYTE *)this + 104);
      else
        v86 = 0;
      *((_BYTE *)this + 7612) = v86;
      if ( IO80211AWDLPeerManager::addInfraToMinimumChannelSequence(this) )
        v87 = *((_BYTE *)this + 104);
      else
        v87 = 0;
      *((_BYTE *)this + 7613) = v87;
      v88 = *((_BYTE *)this + 1532);
      *((_BYTE *)this + 7614) = v88;
      *((_BYTE *)this + 7615) = v88;
      v89 = *((_BYTE *)this + 1533);
      if ( v89 )
      {
        *((_BYTE *)this + 7616) = v89;
        *((_BYTE *)this + 7617) = v89;
        *((_BYTE *)this + 7618) = v89;
      }
      else
      {
        *((_BYTE *)this + 7616) = v88;
        *((_BYTE *)this + 7617) = v88;
        *((_BYTE *)this + 7618) = v88;
        v89 = v88;
      }
      *((_BYTE *)this + 7619) = v89;
      if ( IO80211AWDLPeerManager::addInfraToMinimumChannelSequence(this) )
        v99 = *((_BYTE *)this + 104);
      else
        v99 = 0;
      *((_BYTE *)this + 7620) = v99;
      if ( IO80211AWDLPeerManager::addInfraToMinimumChannelSequence(this) )
        v100 = *((_BYTE *)this + 104);
      else
        v100 = 0;
      *((_BYTE *)this + 7621) = v100;
      *((_BYTE *)this + 1518) = 3;
      *((_BYTE *)this + 7605) = 3;
      if ( *((_DWORD *)this + 1014) )
      {
        v101 = *((_BYTE *)this + 1533);
        if ( v101 )
        {
          *((_BYTE *)this + 7607) = v101;
        }
        else
        {
          *((_BYTE *)this + 7607) = *((_BYTE *)this + 1532);
          v101 = *((_BYTE *)this + 1532);
        }
        *((_BYTE *)this + 7615) = v101;
      }
      if ( *((_DWORD *)this + 26) && !*((_BYTE *)this + 3636) )
        *((_DWORD *)this + 1882) = 0xFFFF;
      else
        *((_DWORD *)this + 1882) = 16191;
      goto LABEL_189;
    case 1:
      *((_BYTE *)this + 7584) = 16;
      v57 = *((_BYTE *)this + 1532);
      *((_BYTE *)this + 7606) = v57;
      *((_BYTE *)this + 7607) = 0;
      if ( *((_BYTE *)this + 1533) )
        v57 = *((_BYTE *)this + 1533);
      *((_BYTE *)this + 7608) = v57;
      *((_BYTE *)this + 7609) = 0;
      *((_BYTE *)this + 7610) = 0;
      *((_BYTE *)this + 7611) = 0;
      if ( IO80211AWDLPeerManager::addInfraToMinimumChannelSequence(this) )
        v58 = *((_BYTE *)this + 104);
      else
        v58 = 0;
      *((_BYTE *)this + 7612) = v58;
      if ( IO80211AWDLPeerManager::addInfraToMinimumChannelSequence(this) )
        v80 = *((_BYTE *)this + 104);
      else
        v80 = 0;
      *((_BYTE *)this + 7613) = v80;
      v81 = *((_BYTE *)this + 1532);
      *((_BYTE *)this + 7614) = v81;
      *((_BYTE *)this + 7615) = 0;
      if ( *((_BYTE *)this + 1533) )
        v81 = *((_BYTE *)this + 1533);
      *((_BYTE *)this + 7616) = v81;
      *((_BYTE *)this + 7617) = 0;
      *((_BYTE *)this + 7618) = 0;
      *((_BYTE *)this + 7619) = 0;
      if ( IO80211AWDLPeerManager::addInfraToMinimumChannelSequence(this) )
        v82 = *((_BYTE *)this + 104);
      else
        v82 = 0;
      *((_BYTE *)this + 7620) = v82;
      if ( IO80211AWDLPeerManager::addInfraToMinimumChannelSequence(this) )
        v83 = *((_BYTE *)this + 104);
      else
        v83 = 0;
      *((_BYTE *)this + 7621) = v83;
      v84 = *((_DWORD *)this + 1014);
      if ( v84 )
      {
        v85 = *((_BYTE *)this + 1533);
        if ( v85 )
        {
          *((_BYTE *)this + 7607) = v85;
        }
        else
        {
          *((_BYTE *)this + 7607) = *((_BYTE *)this + 1532);
          v85 = *((_BYTE *)this + 1532);
        }
        *((_BYTE *)this + 7615) = v85;
      }
      *((_BYTE *)this + 1518) = 3;
      *((_BYTE *)this + 7605) = 3;
      if ( *((_DWORD *)this + 26) && !*((_BYTE *)this + 3636) )
      {
        v107 = v84 == 0;
        v108 = 51143;
        v109 = 50629;
      }
      else
      {
        v107 = v84 == 0;
        v108 = 1799;
        v109 = 1285;
      }
      if ( !v107 )
        v109 = v108;
      *((_DWORD *)this + 1882) = v109;
LABEL_189:
      *((_DWORD *)this + 904) = 0;
      goto LABEL_190;
    case 2:
      *((_BYTE *)this + 7584) = 8;
      v59 = *((_BYTE *)this + 1532);
      *((_BYTE *)this + 7606) = v59;
      *((_BYTE *)this + 7607) = 0;
      if ( *((_BYTE *)this + 1533) )
        v59 = *((_BYTE *)this + 1533);
      *((_BYTE *)this + 7608) = v59;
      *((_BYTE *)this + 7609) = 0;
      *((_BYTE *)this + 7610) = 0;
      *((_BYTE *)this + 7611) = 0;
      *((_BYTE *)this + 7612) = 0;
      *((_BYTE *)this + 7613) = 0;
      goto LABEL_66;
    case 3:
      *((_BYTE *)this + 7584) = 16;
      v60 = *((_BYTE *)this + 1532);
      *((_BYTE *)this + 7606) = v60;
      *((_BYTE *)this + 7607) = 0;
      if ( *((_BYTE *)this + 1533) )
        v60 = *((_BYTE *)this + 1533);
      *((_BYTE *)this + 7608) = v60;
      *((_BYTE *)this + 7609) = 0;
      *((_BYTE *)this + 7610) = 0;
      *((_BYTE *)this + 7611) = 0;
      *((_BYTE *)this + 7612) = 0;
      *((_BYTE *)this + 7613) = 0;
      *((_BYTE *)this + 7614) = 0;
      *((_BYTE *)this + 7615) = 0;
      *((_BYTE *)this + 7616) = 0;
      *((_BYTE *)this + 7617) = 0;
      *((_BYTE *)this + 7618) = 0;
      *((_BYTE *)this + 7619) = 0;
      *((_BYTE *)this + 7620) = 0;
      *((_BYTE *)this + 7621) = 0;
LABEL_66:
      *((_BYTE *)this + 1518) = 3;
      *((_BYTE *)this + 7605) = 3;
      *((_DWORD *)this + 1882) = 5;
LABEL_190:
      *((_BYTE *)this + 3720) &= 0xFEu;
      *((_DWORD *)this + 934) = 0;
      IO80211PeerManager::logDebug(this, 0x10000LL, "Disabling Priv Eid: %u \n", 0LL, v22, v23);
      IO80211AWDLPeerManager::updateAWDLPrivateElectionID(this);
      v53 = 4;
      goto LABEL_217;
    case 4:
      *(_QWORD *)((char *)this + 4956) = 0LL;
      IO80211AWDLPeerManager::calculateDataChannelsForAlwaysAvailable(this);
      *((_BYTE *)this + 7584) = 16;
      v61 = *((_BYTE *)this + 1532);
      *((_BYTE *)this + 7606) = v61;
      v62 = *((_BYTE *)this + 1534);
      *((_BYTE *)this + 7607) = v62;
      *((_BYTE *)this + 7608) = v62;
      *((_BYTE *)this + 7609) = v62;
      *((_BYTE *)this + 7610) = v62;
      *((_BYTE *)this + 7611) = v62;
      v63 = *((_BYTE *)this + 1535);
      *((_BYTE *)this + 7612) = v63;
      *((_BYTE *)this + 7613) = v63;
      *((_BYTE *)this + 7614) = v61;
      *((_BYTE *)this + 7615) = v62;
      *((_BYTE *)this + 7616) = v62;
      *((_BYTE *)this + 7617) = v62;
      *((_BYTE *)this + 7618) = v62;
      *((_BYTE *)this + 7619) = v62;
      *((_BYTE *)this + 7620) = v63;
      *((_BYTE *)this + 7621) = v63;
      if ( *((_DWORD *)this + 1013) )
      {
        v64 = *((_BYTE *)this + 1533);
        if ( v64 )
        {
          *((_BYTE *)this + 7614) = v64;
          *((_BYTE *)this + 7606) = v64;
          LODWORD(v65) = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 56LL))(this, 0x800000LL);
          v66 = OSMetaClass::getClassName(v65);
          IO80211PeerManager::logDebug(
            this,
            0x800000LL,
            "%s::%s _aa_use_secondary_only -> Overwriting slots[0/2] (%d)\n",
            v66,
            (__int64)"setScheduleState",
            *((_BYTE *)this + 1533));
        }
      }
      *((_DWORD *)this + 904) = 3;
      goto LABEL_71;
    case 5:
      IO80211AWDLPeerManager::calculateDataChannelsForAlwaysAvailable(this);
      *((_BYTE *)this + 7584) = 4;
      v67 = *((_BYTE *)this + 1534);
      *((_BYTE *)this + 7606) = v67;
      v68 = *((_BYTE *)this + 1533);
      if ( !v68 )
        v68 = *((_BYTE *)this + 1532);
      *((_BYTE *)this + 7607) = v68;
      *((_BYTE *)this + 7608) = v67;
      *((_BYTE *)this + 7609) = v67;
      *((_BYTE *)this + 7610) = v67;
      *((_BYTE *)this + 7611) = v67;
      *((_BYTE *)this + 7612) = v67;
      *((_BYTE *)this + 7613) = v67;
      *((_BYTE *)this + 1518) = 7;
      *((_BYTE *)this + 7605) = 7;
      *((_DWORD *)this + 1882) = 3;
      IO80211AWDLPeerManager::enablePrivateElectionID(this);
      v53 = 8;
      goto LABEL_217;
    case 6:
      *(_QWORD *)((char *)this + 4956) = 0LL;
      if ( *((_DWORD *)this + 1015) )
      {
        v69 = *((_BYTE *)this + 7443);
        if ( v69 )
        {
          *((_BYTE *)this + 7606) = *((_BYTE *)this + 104);
          v70 = *((_DWORD *)this + 26);
        }
        else
        {
          v104 = *((_BYTE *)this + 1533);
          if ( !v104 )
            v104 = *((_BYTE *)this + 1532);
          *((_BYTE *)this + 7606) = v70;
          LOBYTE(v70) = *((_BYTE *)this + 1533);
          if ( !(_BYTE)v70 )
            LOBYTE(v70) = *((_BYTE *)this + 1532);
        }
        *((_BYTE *)this + 7607) = v70;
        v105 = *((_BYTE *)this + 1534);
        *((_BYTE *)this + 7608) = v105;
        *((_BYTE *)this + 7609) = v105;
        *((_BYTE *)this + 7610) = v105;
        *((_BYTE *)this + 7611) = v105;
        *((_BYTE *)this + 7612) = v105;
        *((_BYTE *)this + 7613) = v105;
        if ( v69 )
        {
          *((_BYTE *)this + 7614) = *((_BYTE *)this + 104);
          v106 = *((_DWORD *)this + 26);
        }
        else
        {
          v113 = *((_BYTE *)this + 1533);
          if ( !v113 )
            v113 = *((_BYTE *)this + 1532);
          *((_BYTE *)this + 7614) = v106;
          LOBYTE(v106) = *((_BYTE *)this + 1533);
          if ( !(_BYTE)v106 )
            LOBYTE(v106) = *((_BYTE *)this + 1532);
        }
        *((_BYTE *)this + 7615) = v106;
        *((_BYTE *)this + 7616) = v105;
        *((_BYTE *)this + 7617) = v105;
        *((_BYTE *)this + 7618) = v105;
        *((_BYTE *)this + 7619) = v105;
        if ( v69 )
        {
          *((_BYTE *)this + 7620) = *((_BYTE *)this + 104);
          v114 = *((_DWORD *)this + 26);
        }
        else
        {
          *((_BYTE *)this + 7620) = *((_BYTE *)this + 1535);
          LOBYTE(v114) = *((_BYTE *)this + 1535);
        }
        *((_BYTE *)this + 7621) = v114;
      }
      else
      {
        LOBYTE(v90) = IO80211AWDLPeerManager::isDFSChannel(this, (unsigned int)v3, *((_BYTE *)this + 1534));
        if ( (_BYTE)v90 && IO80211AWDLPeerManager::isDFSChannel(this, v90, *((_BYTE *)this + 1535)) )
          v91 = *((_BYTE *)this + 1534) == *((_BYTE *)this + 1535);
        else
          v91 = 0;
        v102 = *((_BYTE *)this + 1535);
        v103 = *((_BYTE *)v4 + 7443);
        if ( v103 )
        {
          *((_BYTE *)v4 + 7606) = *((_BYTE *)v4 + 104);
          *((_BYTE *)v4 + 7607) = *((_BYTE *)v4 + 104);
          v112 = *((_DWORD *)v4 + 26);
        }
        else
        {
          v110 = *((_BYTE *)v4 + 1533);
          if ( !v110 )
            v110 = *((_BYTE *)v4 + 1532);
          *((_BYTE *)v4 + 7606) = v110;
          v111 = *((_BYTE *)v4 + 1533);
          if ( !v111 )
            v111 = *((_BYTE *)v4 + 1532);
          *((_BYTE *)v4 + 7607) = v111;
          if ( v91 )
          {
            v120 = *((_BYTE *)v4 + 1534);
          }
          else
          {
            v120 = *((_BYTE *)v4 + 1533);
            if ( !v120 )
              v120 = *((_BYTE *)v4 + 1532);
          }
          LOBYTE(v112) = v120;
        }
        *((_BYTE *)v4 + 7608) = v112;
        if ( v103 )
        {
          v132 = *((_DWORD *)v4 + 26);
        }
        else
        {
          if ( v91 )
          {
            v134 = *((_BYTE *)v4 + 1534);
          }
          else
          {
            v134 = *((_BYTE *)v4 + 1533);
            if ( !v134 )
              v134 = *((_BYTE *)v4 + 1532);
          }
          LOBYTE(v132) = v134;
        }
        *((_BYTE *)v4 + 7609) = v132;
        v135 = *((_BYTE *)v4 + 1534);
        *((_BYTE *)v4 + 7610) = v135;
        *((_BYTE *)v4 + 7611) = v135;
        *((_BYTE *)v4 + 7612) = v135;
        *((_BYTE *)v4 + 7613) = v135;
        if ( v103 )
        {
          *((_BYTE *)v4 + 7614) = *((_BYTE *)v4 + 104);
          *((_BYTE *)v4 + 7615) = *((_BYTE *)v4 + 104);
          v138 = *((_DWORD *)v4 + 26);
        }
        else
        {
          v136 = *((_BYTE *)v4 + 1533);
          if ( v136 )
            *((_BYTE *)v4 + 7614) = v136;
          else
            *((_BYTE *)v4 + 7614) = *((_BYTE *)v4 + 1532);
          v137 = *((_BYTE *)v4 + 1533);
          if ( !v137 )
            v137 = *((_BYTE *)v4 + 1532);
          *((_BYTE *)v4 + 7615) = v138;
          LOBYTE(v138) = v135;
          if ( !v91 )
          {
            LOBYTE(v138) = *((_BYTE *)v4 + 1533);
            if ( !(_BYTE)v138 )
              LOBYTE(v138) = *((_BYTE *)v4 + 1532);
          }
        }
        *((_BYTE *)v4 + 7616) = v138;
        if ( v103 )
        {
          v139 = *((_DWORD *)v4 + 26);
        }
        else
        {
          if ( !v91 )
          {
            v135 = *((_BYTE *)v4 + 1533);
            if ( !v135 )
              v135 = *((_BYTE *)v4 + 1532);
          }
          LOBYTE(v139) = v135;
        }
        *((_BYTE *)v4 + 7617) = v139;
        if ( v102 )
        {
          *((_BYTE *)v4 + 7618) = v102;
          v140 = v102;
        }
        else
        {
          v140 = *((_BYTE *)v4 + 1533);
          if ( v140 )
          {
            *((_BYTE *)v4 + 7618) = v140;
            v102 = 0;
          }
          else
          {
            *((_BYTE *)v4 + 7618) = *((_BYTE *)v4 + 1532);
            v140 = *((_BYTE *)v4 + 1532);
            v102 = 0;
          }
        }
        *((_BYTE *)v4 + 7619) = v140;
        *((_BYTE *)v4 + 7620) = v102;
        *((_BYTE *)v4 + 7621) = v102;
      }
      *((_BYTE *)v4 + 7584) = 16;
      *((_QWORD *)v4 + 452) = 21474836483LL;
LABEL_71:
      v54 = 110;
      if ( !*((_DWORD *)v4 + 992) )
        v54 = 440;
      *((_BYTE *)v4 + 1518) = 3;
      *((_BYTE *)v4 + 7605) = 3;
      *((_DWORD *)v4 + 1882) = 0xFFFF;
      goto LABEL_216;
    case 7:
      IO80211AWDLPeerManager::calculateDataChannelsForAlwaysAvailable(this);
      *((_BYTE *)this + 7584) = 16;
      v71 = *((_BYTE *)this + 1532);
      *((_BYTE *)this + 7606) = v71;
      v72 = *((_BYTE *)this + 1534);
      *((_BYTE *)this + 7607) = v72;
      *((_BYTE *)this + 7608) = v72;
      *((_BYTE *)this + 7609) = v72;
      *((_BYTE *)this + 7610) = v72;
      *((_BYTE *)this + 7611) = 0;
      *((_BYTE *)this + 7612) = 0;
      *((_BYTE *)this + 7613) = 0;
      *((_BYTE *)this + 7614) = v71;
      *((_BYTE *)this + 7615) = v72;
      *((_BYTE *)this + 7616) = v72;
      *((_BYTE *)this + 7617) = v72;
      *((_BYTE *)this + 7618) = v72;
      *((_BYTE *)this + 7619) = 0;
      *((_BYTE *)this + 7620) = 0;
      *((_BYTE *)this + 7621) = 0;
      if ( *((_DWORD *)this + 1013) )
      {
        v73 = *((_BYTE *)this + 1533);
        if ( v73 )
        {
          *((_BYTE *)this + 7614) = v73;
          *((_BYTE *)this + 7606) = v73;
          LODWORD(v74) = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 56LL))(this, 0x800000LL);
          v75 = OSMetaClass::getClassName(v74);
          IO80211PeerManager::logDebug(
            this,
            0x800000LL,
            "%s::%s _aa_use_secondary_only -> Overwriting slots[0/2] (%d)\n",
            v75,
            (__int64)"setScheduleState",
            *((_BYTE *)this + 1533));
        }
      }
      v76 = *((_DWORD *)this + 992) == 0;
      v54 = 110;
      if ( !*((_DWORD *)this + 992) )
        v54 = 440;
      *((_BYTE *)this + 1518) = 3;
      *((_BYTE *)this + 7605) = 3;
      v77 = 17733;
      if ( v76 )
        v77 = 1285;
      *((_DWORD *)this + 1882) = v77;
      *((_DWORD *)this + 904) = 3;
      goto LABEL_216;
    case 8:
      v78 = *((_BYTE *)this + 7443);
      if ( v78 )
      {
        *((_BYTE *)this + 7606) = *((_BYTE *)this + 104);
        *((_BYTE *)this + 7607) = *((_BYTE *)this + 104);
        v94 = *((_DWORD *)this + 26);
      }
      else
      {
        v92 = *((_BYTE *)this + 1533);
        if ( !v92 )
          v92 = *((_BYTE *)this + 1532);
        *((_BYTE *)this + 7606) = v92;
        v93 = *((_BYTE *)this + 1533);
        if ( !v93 )
          v93 = *((_BYTE *)this + 1532);
        *((_BYTE *)this + 7607) = v93;
        LOBYTE(v94) = *((_BYTE *)this + 1533);
        if ( !(_BYTE)v94 )
          LOBYTE(v94) = *((_BYTE *)this + 1532);
      }
      *((_BYTE *)this + 7608) = v94;
      if ( v78 )
      {
        v95 = *((_DWORD *)this + 26);
      }
      else
      {
        LOBYTE(v95) = *((_BYTE *)this + 1533);
        if ( !(_BYTE)v95 )
          LOBYTE(v95) = *((_BYTE *)this + 1532);
      }
      *((_BYTE *)this + 7609) = v95;
      *((_BYTE *)this + 7610) = *((_BYTE *)this + 1534);
      *((_BYTE *)this + 7611) = 0;
      *((_BYTE *)this + 7612) = 0;
      *((_BYTE *)this + 7613) = 0;
      if ( v78 )
      {
        *((_BYTE *)this + 7614) = *((_BYTE *)this + 104);
        *((_BYTE *)this + 7615) = *((_BYTE *)this + 104);
        v117 = *((_DWORD *)this + 26);
      }
      else
      {
        v115 = *((_BYTE *)this + 1533);
        if ( !v115 )
          v115 = *((_BYTE *)this + 1532);
        *((_BYTE *)this + 7614) = v115;
        v116 = *((_BYTE *)this + 1533);
        if ( !v116 )
          v116 = *((_BYTE *)this + 1532);
        *((_BYTE *)this + 7615) = v116;
        LOBYTE(v117) = *((_BYTE *)this + 1533);
        if ( !(_BYTE)v117 )
          LOBYTE(v117) = *((_BYTE *)this + 1532);
      }
      *((_BYTE *)this + 7616) = v117;
      if ( v78 )
      {
        v121 = *((_DWORD *)this + 26);
      }
      else
      {
        LOBYTE(v121) = *((_BYTE *)this + 1533);
        if ( !(_BYTE)v121 )
          LOBYTE(v121) = *((_BYTE *)this + 1532);
      }
      *((_BYTE *)this + 7617) = v121;
      *((_BYTE *)this + 7618) = *((_BYTE *)this + 1535);
      *((_BYTE *)this + 7619) = 0;
      *((_BYTE *)this + 7620) = 0;
      *((_BYTE *)this + 7621) = 0;
      v122 = *((_DWORD *)this + 992) == 0;
      v54 = 110;
      if ( !*((_DWORD *)this + 992) )
        v54 = 440;
      *((_BYTE *)this + 1518) = 3;
      *((_BYTE *)this + 7605) = 3;
      v123 = 17733;
      if ( v122 )
        v123 = 1285;
      *((_DWORD *)this + 1882) = v123;
      *((_QWORD *)this + 452) = 21474836483LL;
LABEL_216:
      IO80211AWDLPeerManager::enablePrivateElectionID(v4);
      v53 = 4;
      goto LABEL_217;
    case 9:
      *((_BYTE *)this + 7584) = 16;
      v79 = *((_BYTE *)this + 7443);
      if ( v79 )
      {
        *((_BYTE *)this + 7606) = *((_BYTE *)this + 104);
        *((_BYTE *)this + 7607) = *((_BYTE *)this + 104);
        *((_BYTE *)this + 7608) = *((_BYTE *)this + 104);
        *((_BYTE *)this + 7609) = *((_BYTE *)this + 104);
        *((_BYTE *)this + 7610) = *((_BYTE *)this + 104);
        if ( v79 )
        {
          v98 = *((_BYTE *)this + 104);
          goto LABEL_195;
        }
      }
      else
      {
        *((_BYTE *)this + 7606) = *((_BYTE *)this + 1532);
        v96 = *((_BYTE *)this + 1533);
        if ( !v96 )
          v96 = *((_BYTE *)this + 1532);
        *((_BYTE *)this + 7607) = v96;
        v97 = *((_BYTE *)this + 1533);
        if ( !v97 )
          v97 = *((_BYTE *)this + 1532);
        *((_BYTE *)this + 7608) = v97;
        *(_WORD *)((char *)this + 7609) = 0;
      }
      v98 = 0;
LABEL_195:
      *((_BYTE *)this + 7611) = v98;
      v118 = *((_DWORD *)this + 992);
      if ( v118 )
      {
        *((_BYTE *)this + 7612) = *((_BYTE *)this + 104);
        *((_BYTE *)this + 7613) = *((_BYTE *)this + 104);
        if ( !v79 )
          goto LABEL_225;
LABEL_200:
        v119 = *((_DWORD *)this + 26);
        goto LABEL_226;
      }
      if ( v79 )
      {
        *((_BYTE *)this + 7612) = *((_BYTE *)this + 104);
        *((_BYTE *)this + 7613) = *((_BYTE *)this + 104);
        goto LABEL_200;
      }
      *((_WORD *)this + 3806) = 0;
LABEL_225:
      LOBYTE(v119) = *((_BYTE *)this + 1532);
LABEL_226:
      *((_BYTE *)this + 7614) = v119;
      if ( !v79 )
      {
        v129 = *((_BYTE *)this + 1533);
        if ( !v129 )
          v129 = *((_BYTE *)this + 1532);
        *((_BYTE *)this + 7615) = v129;
        v130 = *((_BYTE *)this + 1533);
        if ( !v130 )
          v130 = *((_BYTE *)this + 1532);
        *((_BYTE *)this + 7616) = v130;
        *(_WORD *)((char *)this + 7617) = 0;
        goto LABEL_240;
      }
      *((_BYTE *)this + 7615) = *((_BYTE *)this + 104);
      *((_BYTE *)this + 7616) = *((_BYTE *)this + 104);
      *((_BYTE *)this + 7617) = *((_BYTE *)this + 104);
      *((_BYTE *)this + 7618) = *((_BYTE *)this + 104);
      if ( !v79 )
      {
LABEL_240:
        v131 = 0;
        goto LABEL_241;
      }
      v131 = *((_BYTE *)this + 104);
LABEL_241:
      *((_BYTE *)this + 7619) = v131;
      if ( v118 || v79 )
      {
        *((_BYTE *)this + 7620) = *((_BYTE *)this + 104);
        v133 = *((_DWORD *)this + 26);
      }
      else
      {
        *((_BYTE *)this + 7620) = 0;
        LOBYTE(v133) = 0;
      }
      *((_BYTE *)this + 7621) = v133;
      *((_BYTE *)this + 1518) = 3;
      *((_BYTE *)this + 7605) = 3;
      if ( v79 )
        *((_DWORD *)this + 1882) = 0xFFFF;
      else
        *((_DWORD *)this + 1882) = 50115;
      v53 = 4;
      v54 = 110;
LABEL_217:
      v124 = v54;
      if ( v34 != *((_DWORD *)v4 + 904) )
        IO80211AWDLPeerManager::setAFTXMode(v4, v34);
      v146 = 0;
      v145 = 1LL;
      v142 = -2144835128;
      v143 = 118;
      v144 = &v145;
      v148 = *((_BYTE *)v4 + 1518);
      v146 = 0;
      v147 = 0;
      HIDWORD(v145) = 0;
      v125 = IO80211PeerManager::ioctl_internal(v4, (__int64)&v142);
      if ( v125 )
      {
        LODWORD(v126) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)v4 + 56LL))(v4, &v142);
        v127 = OSMetaClass::getClassName(v126);
        IO80211PeerManager::logDebug(
          v4,
          "%s::%s  Unable to set extension params ret %d\n",
          v127,
          (__int64)"setScheduleState",
          (unsigned int)v125,
          v128);
      }
      v141 = 1LL;
      HIDWORD(v141) = *((_DWORD *)v4 + 905);
      v143 = 226;
      v144 = &v141;
      IO80211AWDLPeerManager::setPresenceMode(v4, v53);
      IO80211AWDLPeerManager::setSyncFramePeriod(v4, v124);
      if ( *((_BYTE *)v4 + 3960) && *((_BYTE *)v4 + 7396) & 1 )
        IO80211AWDLPeerManager::setChannelSequenceUnconditional(v4, 1);
      return;
    case 10:
      if ( *((_DWORD *)this + 1245) != 2 )
      {
        *((_DWORD *)this + 1843) = 0;
        *((_DWORD *)this + 1245) = 2;
      }
      return;
    default:
      goto LABEL_217;
  }
}
// 7D120: using guessed type char *off_7D120[33];
// 7D180: using guessed type char *off_7D180[21];

//----- (0000000000028DAC) ----------------------------------------------------
char __fastcall IO80211AWDLPeerManager::usePiggybackScan(IO80211PeerManager *this, __int64 a2)
{
  __int64 v2; // r13@1
  __int64 v3; // rsi@1
  unsigned int v4; // eax@2
  unsigned int v5; // ecx@4
  signed __int64 v6; // rdx@5
  unsigned int v7; // ebx@8
  unsigned int v8; // er12@8
  size_t v9; // rsi@9
  OSMetaClass *v10; // rax@12
  __int64 v11; // rax@12
  __int64 v12; // rcx@14
  char v14[256]; // [sp+0h] [bp-130h]@11
  __int64 v15; // [sp+100h] [bp-30h]@1

  v2 = a2;
  v3 = off_7B078[0];
  v15 = *(_QWORD *)off_7B078[0];
  if ( *((_DWORD *)this + 259) != 1 )
  {
LABEL_13:
    LOBYTE(v4) = 0;
    goto LABEL_14;
  }
  LOBYTE(v4) = 0;
  if ( !(*((_BYTE *)this + 556) & 1) )
  {
    if ( v2 )
    {
      v5 = *(_DWORD *)(v2 + 68);
      v4 = 0;
      if ( v5 )
      {
        v6 = v2 + 76;
        while ( *(_DWORD *)v6 <= 0xBu )
        {
          ++v4;
          v6 += 12LL;
          if ( v4 >= v5 )
          {
            v7 = 0;
            v8 = 0;
            do
            {
              v9 = 0LL;
              if ( v8 <= 0xFE )
                v9 = 255 - v8;
              v8 += snprintf(&v14[v8], v9, "%u ", *(_DWORD *)(v2 + 12LL * v7++ + 76));
            }
            while ( v7 < *(_DWORD *)(v2 + 68) );
            LODWORD(v10) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
            v11 = OSMetaClass::getClassName(v10);
            IO80211PeerManager::logDebug(
              this,
              0x400000LL,
              "%s::%s Executing piggyback scan for (%s)\n",
              v11,
              (__int64)"usePiggybackScan",
              (__int64)v14);
            LOBYTE(v4) = 1;
            v3 = off_7B078[0];
            goto LABEL_14;
          }
        }
        goto LABEL_13;
      }
    }
  }
LABEL_14:
  v12 = *(_QWORD *)v3;
  return v4;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 28DAC: using guessed type char var_130[256];

//----- (0000000000028ED2) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setMinimumAvailable(IO80211AWDLPeerManager *this)
{
  IO80211AWDLPeerManager::setScheduleState(this, 1u, 0);
  return 0LL;
}

//----- (0000000000028EE6) ----------------------------------------------------
void IO80211AWDLPeerManager::setJoiningState()
{
  ;
}

//----- (0000000000028EEC) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::setInfraTxState(IO80211AWDLPeerManager *this)
{
  OSMetaClass *v1; // rax@4
  __int64 v2; // rcx@4
  unsigned __int64 v3; // rax@4
  char v4[8]; // r9@5

  if ( *((_DWORD *)this + 372) && *((_DWORD *)this + 1244) != 1 )
  {
    LODWORD(v1) = (*(int (__cdecl **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
    v2 = OSMetaClass::getClassName(v1);
    v3 = *((_DWORD *)this + 1244);
    if ( v3 > 0xB )
      *(_QWORD *)v4 = "unknown";
    else
      *(_QWORD *)v4 = off_7D120[v3];
    IO80211PeerManager::logDebug(
      this,
      0x2000000000LL,
      "%s::%s (current=%s)\n",
      v2,
      (__int64)"setInfraTxState",
      *(__int64 *)v4);
    IO80211AWDLPeerManager::setScheduleState(this, 1u, 0);
  }
}
// 7D120: using guessed type char *off_7D120[33];

//----- (0000000000028F7A) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAlwaysAvailable(IO80211AWDLPeerManager *this, char a2)
{
  char v2; // dl@3
  unsigned int v3; // esi@3

  if ( !*((_DWORD *)this + 139) )
  {
    v2 = a2;
    v3 = 4;
    goto LABEL_5;
  }
  if ( !*((_DWORD *)this + 1245) )
  {
    v2 = a2;
    v3 = 7;
LABEL_5:
    IO80211AWDLPeerManager::setScheduleState(this, v3, v2);
  }
  return 0LL;
}

//----- (0000000000028FAE) ----------------------------------------------------
char __fastcall IO80211AWDLPeerManager::realTimeDataModeRequired(IO80211AWDLPeerManager *this)
{
  return *((_BYTE *)this + 7408);
}

//----- (0000000000028FBA) ----------------------------------------------------
bool __fastcall IO80211AWDLPeerManager::useSingleBandDataMode(IO80211AWDLPeerManager *this)
{
  int v2; // [sp+Ch] [bp-4h]@1

  v2 = 0;
  IO80211CommandQueue::map(
    *((_QWORD *)this + 11),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countCachedSingleBandPeers,
    (__int64)this,
    (__int64)&v2,
    0LL,
    -1);
  return v2 != 0;
}

//----- (0000000000028FF9) ----------------------------------------------------
__int64 __fastcall _countCachedSingleBandPeers(__int64 a1, __int64 a2, __int64 a3)
{
  if ( *(_BYTE *)(a2 + 522) && !*(_BYTE *)(a2 + 1160) )
    ++*(_DWORD *)a3;
  return 0LL;
}

//----- (0000000000029016) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::calculateDataChannelsForAirplayDirectDFS(IO80211AWDLPeerManager *this, IO80211AWDLPeer *a2)
{
  char v2; // r12@1
  int v3; // ebx@1
  __int64 result; // rax@1
  __int64 v5; // r15@1
  __int64 v6; // rbx@4
  OSMetaClass *v7; // rax@7
  __int64 v8; // r14@7
  __int64 v9; // rbx@7
  int v10; // ST00_4@7
  int v11; // ST08_4@7
  __int64 v12; // rax@7
  __int64 v13; // rbx@8
  __int64 v14; // rax@8
  __int64 v15; // r9@8
  __int64 v16; // rax@11
  OSMetaClass *v17; // rax@14
  __int64 v18; // r15@14
  __int64 v19; // rax@16
  char v20; // al@20
  char v21; // al@26
  OSMetaClass *v22; // rax@28
  __int64 v23; // rax@28
  __int64 v24; // r8@28
  __int64 v25; // r9@28
  char v26; // al@37
  OSMetaClass *v27; // rax@39
  __int64 v28; // rax@39
  __int64 v29; // r8@39
  __int64 v30; // r9@39
  int v31; // eax@41
  OSMetaClass *v32; // rax@46
  __int64 v33; // rax@46
  int v34; // ST08_4@46
  int v35; // ST00_4@46
  __int64 v36; // [sp+28h] [bp-38h]@14
  unsigned __int8 v37; // [sp+34h] [bp-2Ch]@3

  v2 = *((_BYTE *)a2 + 1203);
  v3 = *((_BYTE *)a2 + 1203);
  result = getAbsoluteTime();
  v5 = result;
  if ( *((_DWORD *)this + 26) == v3 )
  {
    *((_BYTE *)this + 1535) = v2;
    *((_BYTE *)this + 1534) = v2;
    return result;
  }
  v37 = v3;
  if ( !*((_BYTE *)this + 3636)
    || (v6 = *((_QWORD *)this + 494)) != 0
    && (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v6)) >> 64) >> 18) <= *((_DWORD *)this + 384)
    || *((_DWORD *)this + 912) > 1u )
  {
    v13 = *((_QWORD *)this + 494);
    v14 = getAbsoluteTime();
    v12 = IO80211PeerManager::logDebug(
            this,
            0x800000LL,
            "%s:ONLY %u milli secs since last force roaming\n",
            (__int64)"calculateDataChannelsForAirplayDirectDFS",
            (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (v14 - v13)) >> 64) >> 18),
            v15);
  }
  else
  {
    LODWORD(v7) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
    v8 = OSMetaClass::getClassName(v7);
    v9 = *((_QWORD *)this + 494);
    v10 = *((_DWORD *)this + 912);
    v11 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v9)) >> 64) >> 18;
    IO80211PeerManager::logDebug(
      this,
      0x800000LL,
      "%s:%s: %d attempt #%u to force roam and the last attempt was %u secs ago\n",
      v8,
      (__int64)"calculateDataChannelsForAirplayDirectDFS",
      1929LL);
    *((_QWORD *)this + 494) = v5;
    v12 = IO80211AWDLPeerManager::forceRoamToPeersAP(this, (ether_addr *)0x800000);
  }
  if ( !*((_DWORD *)this + 1015) )
  {
    LODWORD(v17) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                     this,
                     0x800000LL);
    v36 = OSMetaClass::getClassName(v17);
    v18 = (__int64)"no";
    if ( *((_BYTE *)this + 3636) )
      v18 = (__int64)"yes";
    IO80211AWDLPeerManager::isDFSChannel(this, *((_DWORD *)this + 26), v37);
    IO80211PeerManager::logDebug(
      this,
      0x800000LL,
      "%s::%s(): Operating in retrogade mode.  We are on DFS(%s) - %u, peer is on DFS(%s) - %u\n",
      v36,
      (__int64)"calculateDataChannelsForAirplayDirectDFS",
      v18);
    v19 = *((_DWORD *)this + 26);
    if ( (_DWORD)v19 && !*((_BYTE *)this + 3636) )
    {
      *((_BYTE *)this + 1534) = v19;
    }
    else if ( v2 && !IO80211AWDLPeerManager::isDFSChannel(this, v19, v37) )
    {
      *((_BYTE *)this + 1534) = v2;
    }
    else
    {
      v20 = *((_BYTE *)this + 1533);
      if ( !v20 )
        v20 = *((_BYTE *)this + 1532);
      *((_BYTE *)this + 1534) = v20;
    }
    *((_BYTE *)this + 1535) = 0;
    goto LABEL_46;
  }
  if ( *((_DWORD *)this + 992) )
  {
    v16 = *((_DWORD *)this + 26);
    if ( (_DWORD)v16 )
    {
      if ( *((_BYTE *)this + 3636) )
        *((_BYTE *)this + 1534) = 0;
      else
        *((_BYTE *)this + 1534) = v16;
    }
    else
    {
      v21 = *((_BYTE *)this + 1533);
      if ( !v21 )
        v21 = *((_BYTE *)this + 1532);
      *((_BYTE *)this + 1534) = v21;
      LODWORD(v22) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       0x800000LL);
      v23 = OSMetaClass::getClassName(v22);
      v16 = IO80211PeerManager::logDebug(
              this,
              "%s::%s Error: Asked to favor ATVs infra connection for AirPlay but it doesn't have an infra connection!\n",
              v23,
              (__int64)"calculateDataChannelsForAirplayDirectDFS",
              v24,
              v25);
    }
    if ( v2 )
    {
      if ( IO80211AWDLPeerManager::isDFSChannel(this, v16, v37) )
        v2 = *((_BYTE *)this + 1534);
      *((_BYTE *)this + 1535) = v2;
      goto LABEL_46;
    }
  }
  else
  {
    if ( v2 )
    {
      if ( IO80211AWDLPeerManager::isDFSChannel(this, v12, v37) )
        *((_BYTE *)this + 1534) = 0;
      else
        *((_BYTE *)this + 1534) = v2;
    }
    else
    {
      v26 = *((_BYTE *)this + 1533);
      if ( !v26 )
        v26 = *((_BYTE *)this + 1532);
      *((_BYTE *)this + 1534) = v26;
      LODWORD(v27) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       0x800000LL);
      v28 = OSMetaClass::getClassName(v27);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s Error: Asked to favor ATVs infra connection for AirPlay but it doesn't have an infra connection!\n",
        v28,
        (__int64)"calculateDataChannelsForAirplayDirectDFS",
        v29,
        v30);
    }
    v31 = *((_DWORD *)this + 26);
    if ( v31 )
    {
      if ( *((_BYTE *)this + 3636) )
        LOBYTE(v31) = 0;
      *((_BYTE *)this + 1535) = v31;
      goto LABEL_46;
    }
  }
  *((_BYTE *)this + 1535) = *((_BYTE *)this + 1534);
LABEL_46:
  LODWORD(v32) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
  v33 = OSMetaClass::getClassName(v32);
  v34 = *((_BYTE *)this + 1535);
  v35 = *((_BYTE *)this + 1534);
  return IO80211PeerManager::logDebug(
           this,
           0x800000LL,
           "%s::%s favoring ATV infra (%d), _primaryDataChannelNum(%u), _secondaryDataChannel(%u)\n",
           v33,
           (__int64)"calculateDataChannelsForAirplayDirectDFS",
           *((_DWORD *)this + 1015));
}

//----- (0000000000029418) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::forceRoamToPeersAP(IO80211AWDLPeerManager *this, ether_addr *a2)
{
  OSMetaClass *v2; // rax@1
  __int64 v3; // rax@1
  __int64 v4; // r9@1
  int v5; // er14@1
  OSMetaClass *v6; // rax@2
  __int64 v7; // rax@2
  __int64 v8; // r9@2
  int v10; // [sp+8h] [bp-38h]@1
  int v11; // [sp+Ch] [bp-34h]@1
  __int64 *v12; // [sp+10h] [bp-30h]@1
  __int64 v13; // [sp+20h] [bp-20h]@1
  int v14; // [sp+28h] [bp-18h]@1

  v14 = 0;
  v13 = 1LL;
  v10 = -2144835128;
  v11 = 167;
  v12 = &v13;
  LODWORD(v2) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, ether_addr *))(*(_QWORD *)this + 56LL))(this, a2);
  v3 = OSMetaClass::getClassName(v2);
  IO80211PeerManager::logDebug(this, 0x80000000LL, "%s::%s Force Roam \n", v3, (__int64)"forceRoamToPeersAP", v4);
  v5 = IO80211PeerManager::ioctl_internal(this, (__int64)&v10);
  if ( v5 )
  {
    LODWORD(v6) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v10);
    v7 = OSMetaClass::getClassName(v6);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s  Unable to forceRoam: ret %d\n",
      v7,
      (__int64)"forceRoamToPeersAP",
      (unsigned int)v5,
      v8);
  }
  *((_BYTE *)this + 3644) = 1;
  ++*((_DWORD *)this + 912);
  return (unsigned int)v5;
}

//----- (00000000000294DA) ----------------------------------------------------
char __usercall IO80211AWDLPeerManager::isDFSChannel@<al>(IO80211AWDLPeerManager *this@<rdi>, __int64 a2@<rax>, unsigned __int8 a3@<sil>)
{
  __int64 v3; // r9@3
  char v4; // r15@3
  __int64 v6; // [sp-4h] [bp-20h]@1

  v6 = a2;
  HIDWORD(v6) = 0;
  if ( a3
    && (unsigned int)IO80211AWDLPeerManager::isValidChannel(
                       this,
                       (__int64)((char *)this + 1540),
                       a3,
                       1,
                       (__int64)((char *)&v6 + 4)) )
  {
    v4 = 1;
    if ( IO80211PeerManager::shouldVerboseLog(this, 0x800000LL) )
      IO80211PeerManager::logDebug(
        this,
        0x800000LL,
        "channel %u is DFS channel; chanproperties 0x%X \n",
        a3,
        HIDWORD(v6),
        v3);
  }
  else
  {
    v4 = 0;
  }
  return v4;
}

//----- (000000000002955E) ----------------------------------------------------
__int64 __usercall IO80211AWDLPeerManager::calculateDataChannelsForAirplayDirect@<rax>(IO80211AWDLPeerManager *this@<rdi>, IO80211AWDLPeer *a2@<rsi>, __int64 a3@<rax>)
{
  char v3; // r12@2
  unsigned int v4; // er14@2
  __int64 result; // rax@3
  int v6; // eax@6
  int v7; // ecx@6
  int v8; // eax@9
  int v9; // ecx@11
  OSMetaClass *v10; // rax@17
  __int64 v11; // rax@17
  __int64 v12; // r9@17
  char v13; // al@17
  int v14; // eax@20
  OSMetaClass *v15; // rax@23
  __int64 v16; // rax@23
  int v17; // ST00_4@23

  if ( *((_BYTE *)this + 3636)
    || (v3 = *((_BYTE *)a2 + 1203),
        v4 = *((_BYTE *)a2 + 1203),
        IO80211AWDLPeerManager::isDFSChannel(this, a3, *((_BYTE *)a2 + 1203))) )
  {
    result = IO80211AWDLPeerManager::calculateDataChannelsForAirplayDirectDFS(this, a2);
  }
  else
  {
    if ( v3 )
    {
      if ( *((_DWORD *)this + 992) )
      {
        v6 = *((_DWORD *)this + 26);
        v7 = *((_DWORD *)this + 26);
        if ( !v6 )
          LOBYTE(v7) = v4;
        *((_BYTE *)this + 1534) = v7;
        *((_BYTE *)this + 1535) = v3;
      }
      else
      {
        *((_BYTE *)this + 1534) = v3;
        v6 = *((_DWORD *)this + 26);
        v9 = *((_DWORD *)this + 26);
        if ( !v6 )
          LOBYTE(v9) = v4;
        *((_BYTE *)this + 1535) = v9;
      }
      if ( !*((_DWORD *)this + 1015) && v4 == v6 && v4 <= 0xE )
      {
        LODWORD(v10) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
        v11 = OSMetaClass::getClassName(v10);
        IO80211PeerManager::logDebug(
          this,
          0x800000LL,
          "%s::%s() Single 2.4Ghz infra channel in use, only giving 4 slots\n",
          v11,
          (__int64)"calculateDataChannelsForAirplayDirect",
          v12);
        v13 = *((_BYTE *)this + 1533);
        if ( !v13 )
          v13 = *((_BYTE *)this + 1532);
        *((_BYTE *)this + 1535) = v13;
      }
    }
    else
    {
      v8 = *((_DWORD *)this + 26);
      if ( v8 )
      {
        *((_BYTE *)this + 1535) = v8;
        *((_BYTE *)this + 1534) = v8;
      }
      else
      {
        v14 = *((_BYTE *)this + 1533);
        if ( !(_BYTE)v14 )
          LOBYTE(v14) = *((_BYTE *)this + 1532);
        *((_BYTE *)this + 1535) = v14;
        *((_BYTE *)this + 1534) = v14;
      }
    }
    LODWORD(v15) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
    v16 = OSMetaClass::getClassName(v15);
    v17 = *((_BYTE *)this + 1535);
    result = IO80211PeerManager::logDebug(
               this,
               0x800000LL,
               "%s::%s _primaryDataChannelNum(%u), _secondaryDataChannel(%u)\n",
               v16,
               (__int64)"calculateDataChannelsForAirplayDirect",
               *((_BYTE *)this + 1534));
  }
  return result;
}

//----- (00000000000296E4) ----------------------------------------------------
char __fastcall IO80211AWDLPeerManager::calculateDataChannelsForAlwaysAvailable(IO80211AWDLPeerManager *this)
{
  OSMetaClass *v1; // rax@2
  __int64 v2; // r10@2
  __int64 v3; // rax@2
  int v4; // ST30_4@2
  int v5; // ST28_4@2
  int v6; // ST20_4@2
  int v7; // ST18_4@2
  int v8; // ST10_4@2
  int v9; // ST08_4@2
  int v10; // ST00_4@2
  __int64 v11; // rax@2
  __int64 v12; // rsi@2
  int v13; // eax@3
  char v14; // al@5
  int v15; // eax@9
  OSMetaClass *v16; // rax@11
  __int64 v17; // rax@11
  OSMetaClass *v18; // rax@16
  __int64 v19; // rax@16
  __int64 v20; // r8@16
  __int64 v21; // r9@16
  OSMetaClass *v22; // rax@17
  __int64 v23; // rax@17
  int v24; // ST00_4@17
  int v26; // [sp+40h] [bp-10h]@4
  int v27; // [sp+44h] [bp-Ch]@12

  if ( *((_BYTE *)this + 7408) )
  {
    *((_BYTE *)this + 7443) = 0;
    LODWORD(v1) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
    v2 = OSMetaClass::getClassName(v1);
    v3 = *((_QWORD *)this + 927);
    v4 = *(_BYTE *)(v3 + 1203);
    v5 = *(_BYTE *)(v3 + 1163);
    v6 = *(_BYTE *)(v3 + 37);
    v7 = *(_BYTE *)(v3 + 36);
    v8 = *(_BYTE *)(v3 + 35);
    v9 = *(_BYTE *)(v3 + 34);
    v10 = *(_BYTE *)(v3 + 33);
    v11 = IO80211PeerManager::logDebug(
            this,
            0x800000LL,
            "%s::%s(): Airplaying with peer: %02x:%02x:%02x:%02x:%02x:%02x. Direct mode enable(%d).  Infra channel(%d)\n",
            v2,
            (__int64)"calculateDataChannelsForAlwaysAvailable",
            *(_BYTE *)(v3 + 32));
    v12 = *((_QWORD *)this + 927);
    if ( *(_BYTE *)(v12 + 1163) )
    {
      LOBYTE(v13) = IO80211AWDLPeerManager::calculateDataChannelsForAirplayDirect(this, (IO80211AWDLPeer *)v12, v11);
    }
    else
    {
      v15 = *((_DWORD *)this + 26);
      if ( v15 )
      {
        if ( v15 == *(_BYTE *)(v12 + 1203) )
        {
          *((_BYTE *)this + 7443) = 1;
          *((_BYTE *)this + 1535) = v15;
          *((_BYTE *)this + 1534) = v15;
          LODWORD(v16) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
          v17 = OSMetaClass::getClassName(v16);
          LOBYTE(v13) = IO80211PeerManager::logDebug(
                          this,
                          0x800000LL,
                          "%s::%s(): Using INFRA Airplay mode on channel %d\n",
                          v17,
                          (__int64)"calculateDataChannelsForAlwaysAvailable",
                          *((_DWORD *)this + 26));
        }
        else
        {
          LODWORD(v22) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
          v23 = OSMetaClass::getClassName(v22);
          v24 = *(_BYTE *)(*((_QWORD *)this + 927) + 1203LL);
          IO80211PeerManager::logDebug(
            this,
            0x800000LL,
            "%s::%s(): Using Airplay non-direct mode and devices have different infra channels.  %d --> %d\n",
            v23,
            (__int64)"calculateDataChannelsForAlwaysAvailable",
            *((_DWORD *)this + 26));
          LOBYTE(v13) = *((_BYTE *)this + 1533);
          if ( !(_BYTE)v13 )
            LOBYTE(v13) = *((_BYTE *)this + 1532);
          *((_BYTE *)this + 1535) = v13;
          *((_BYTE *)this + 1534) = v13;
        }
      }
      else
      {
        LODWORD(v18) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
        v19 = OSMetaClass::getClassName(v18);
        LOBYTE(v13) = IO80211PeerManager::logDebug(
                        this,
                        "%s::%s(): Error, using Airplay non-direct mode and don't have infra connection\n",
                        v19,
                        (__int64)"calculateDataChannelsForAlwaysAvailable",
                        v20,
                        v21);
      }
    }
  }
  else
  {
    v26 = 0;
    IO80211CommandQueue::map(
      *((_QWORD *)this + 11),
      (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countCachedSingleBandPeers,
      (__int64)this,
      (__int64)&v26,
      0LL,
      -1);
    if ( v26 || (v14 = *((_BYTE *)this + 1533)) == 0 )
      v14 = *((_BYTE *)this + 1532);
    *((_BYTE *)this + 1534) = v14;
    v13 = *((_DWORD *)this + 26);
    if ( v13 )
    {
      *((_BYTE *)this + 1535) = v13;
    }
    else
    {
      v27 = 0;
      IO80211CommandQueue::map(
        *((_QWORD *)this + 11),
        (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countCachedSingleBandPeers,
        (__int64)this,
        (__int64)&v27,
        0LL,
        -1);
      if ( v27 || (LOBYTE(v13) = *((_BYTE *)this + 1533), !(_BYTE)v13) )
        LOBYTE(v13) = *((_BYTE *)this + 1532);
      *((_BYTE *)this + 1535) = v13;
    }
  }
  return v13;
}

//----- (000000000002993E) ----------------------------------------------------
bool __fastcall IO80211AWDLPeerManager::addInfraToMinimumChannelSequence(IO80211AWDLPeerManager *this)
{
  bool v1; // r14@1
  int v3; // [sp+Ch] [bp-14h]@1

  v3 = 0;
  v1 = 0;
  IO80211CommandQueue::lockMap(
    *((IO80211CommandQueue **)this + 476),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countAirPlayServices,
    (__int64)this,
    (__int64)&v3,
    0LL,
    -1);
  if ( !*((_BYTE *)this + 3636) )
    v1 = v3 != 0;
  return v1;
}

//----- (0000000000029996) ----------------------------------------------------
__int64 __fastcall _countAirPlayServices(__int64 a1, IO80211ServiceRequestDescriptor *a2, __int64 a3)
{
  __int64 v3; // r14@1
  unsigned __int64 v4; // rax@3
  unsigned __int64 v5; // rax@4
  unsigned __int64 v6; // rax@5
  unsigned __int64 v7; // rax@6

  v3 = a3;
  if ( a2 )
  {
    if ( (unsigned __int8)IO80211ServiceRequestDescriptor::recordType(a2) == 12 )
    {
      v4 = strlen("ip6");
      if ( (signed int)IO80211ServiceRequestDescriptor::hasString(a2, "ip6", v4) < 0
        || (v5 = strlen("arpa"), (signed int)IO80211ServiceRequestDescriptor::hasString(a2, "arpa", v5) < 0) )
      {
        v6 = strlen("airplay");
        if ( (signed int)IO80211ServiceRequestDescriptor::hasString(a2, "airplay", v6) >= 0
          || (v7 = strlen("raop"), (signed int)IO80211ServiceRequestDescriptor::hasString(a2, "raop", v7) >= 0) )
          ++*(_DWORD *)v3;
      }
    }
  }
  return 0LL;
}

//----- (0000000000029A58) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::cachedPeerHasChangedChannelSequence(IO80211AWDLPeerManager *this, IO80211AWDLPeer *a2)
{
  IO80211AWDLPeer *v2; // r13@1
  __int64 v3; // rbx@1
  size_t v4; // rsi@1
  unsigned int v5; // ebx@3
  unsigned int v6; // er12@3
  OSMetaClass *v7; // rax@7
  __int64 v8; // rax@7
  int v9; // ST38_4@7
  int v10; // ST30_4@7
  int v11; // ST20_4@7
  int v12; // ST18_4@7
  int v13; // ST10_4@7
  int v14; // ST08_4@7
  int v15; // ST00_4@7
  char v17[256]; // [sp+40h] [bp-130h]@6
  __int64 v18; // [sp+140h] [bp-30h]@1

  v2 = a2;
  v3 = off_7B078[0];
  v18 = *(_QWORD *)off_7B078[0];
  v4 = 0x800000LL;
  if ( IO80211PeerManager::shouldLog(this, 0x800000LL) )
  {
    if ( *((_BYTE *)v2 + 1457) )
    {
      v5 = 0;
      v6 = 0;
      do
      {
        v4 = 0LL;
        if ( v6 <= 0xFE )
          v4 = 255 - v6;
        v6 += snprintf(&v17[v6], v4, "%u ", *((_BYTE *)v2 + v5++ + 1462));
      }
      while ( v5 < *((_BYTE *)v2 + 1457) );
    }
    LODWORD(v7) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, size_t))(*(_QWORD *)this + 56LL))(this, v4);
    v8 = OSMetaClass::getClassName(v7);
    v9 = *((_DWORD *)this + 369);
    v10 = *((_DWORD *)this + 367);
    v11 = *((_BYTE *)v2 + 37);
    v12 = *((_BYTE *)v2 + 36);
    v13 = *((_BYTE *)v2 + 35);
    v14 = *((_BYTE *)v2 + 34);
    v15 = *((_BYTE *)v2 + 33);
    IO80211PeerManager::logDebug(
      this,
      0x800000LL,
      "%s::%s(): Cached peer(%02X:%02X:%02X:%02X:%02X:%02X) has changed its channel sequence to %s at (%u:%u)\n",
      v8,
      (__int64)"cachedPeerHasChangedChannelSequence",
      *((_BYTE *)v2 + 32));
    v3 = off_7B078[0];
  }
  return *(_QWORD *)v3;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 29A58: using guessed type char var_130[256];

//----- (0000000000029B9E) ----------------------------------------------------
signed __int64 __fastcall IO80211AWDLPeerManager::awdlStatsAccumulateScheduleStateDuration(__int64 a1, unsigned int a2, __int64 a3)
{
  signed __int64 result; // rax@1

  result = 16LL * a2;
  *(_QWORD *)(a1 + result + 8296) += (unsigned __int64)((unsigned __int128)(4835703278458516699LL * a3) >> 64) >> 18;
  return result;
}

//----- (0000000000029BC6) ----------------------------------------------------
signed __int64 __fastcall IO80211AWDLPeerManager::awdlStatsIncrementScheduleStateCount(__int64 a1, unsigned int a2)
{
  signed __int64 result; // rax@1

  result = 16LL * a2;
  ++*(_DWORD *)(a1 + result + 8288);
  return result;
}

//----- (0000000000029BDA) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::disablePrivateElectionID(IO80211AWDLPeerManager *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  *((_BYTE *)this + 3720) &= 0xFEu;
  *((_DWORD *)this + 934) = 0;
  IO80211PeerManager::logDebug(this, 0x10000LL, "Disabling Priv Eid: %u \n", 0LL, a5, a6);
  return IO80211AWDLPeerManager::updateAWDLPrivateElectionID(this);
}

//----- (0000000000029C18) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::enablePrivateElectionID(IO80211AWDLPeerManager *this)
{
  __int64 v1; // r9@1
  __int64 v2; // r8@1
  int v3; // eax@2
  __int64 v4; // rcx@4
  __int64 result; // rax@6
  __int64 v6; // rcx@6
  __int64 v7; // r8@6
  __int64 v8; // r9@6

  IO80211CommandQueue::map(
    *((_QWORD *)this + 11),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_adoptHighestPeerPrivEID,
    (__int64)this,
    0LL,
    0LL,
    -1);
  v2 = *((_DWORD *)this + 934);
  if ( (_DWORD)v2 )
  {
    v3 = *((_DWORD *)this + 930);
  }
  else
  {
    v2 = *((_DWORD *)this + 933) & (unsigned int)random();
    *((_DWORD *)this + 934) = v2;
    v3 = *((_DWORD *)this + 930) | 1;
    *((_DWORD *)this + 930) = v3;
  }
  v4 = (__int64)"Private Eid Disabled";
  if ( v3 & 1 )
    v4 = (__int64)"Private Eid Enabled";
  IO80211PeerManager::logDebug(this, 0x800000LL, "%s; setting private election id to 0x%x\n", v4, v2, v1);
  result = IO80211AWDLPeerManager::updateAWDLPrivateElectionID(this);
  if ( (_DWORD)result )
  {
    *((_BYTE *)this + 3720) &= 0xFEu;
    *((_DWORD *)this + 934) = 0;
    result = IO80211PeerManager::logDebug(
               this,
               0x10000LL,
               "Unable to set private election id; disabling \n",
               v6,
               v7,
               v8);
  }
  return result;
}

//----- (0000000000029CE2) ----------------------------------------------------
unsigned int __fastcall IO80211AWDLPeerManager::setAFTXMode(IO80211AWDLPeerManager *this, int a2)
{
  unsigned int result; // eax@1
  unsigned int v3; // er15@1
  OSMetaClass *v4; // rax@2
  __int64 v5; // rax@2
  int v6; // [sp+8h] [bp-38h]@1
  int v7; // [sp+Ch] [bp-34h]@1
  __int64 *v8; // [sp+10h] [bp-30h]@1
  __int64 v9; // [sp+20h] [bp-20h]@1

  v9 = 1LL;
  v6 = -2144835128;
  v7 = 208;
  v8 = &v9;
  HIDWORD(v9) = *((_DWORD *)this + 904);
  result = IO80211PeerManager::ioctl_internal(this, (__int64)&v6);
  v3 = result;
  if ( result )
  {
    LODWORD(v4) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v6);
    v5 = OSMetaClass::getClassName(v4);
    result = IO80211PeerManager::logDebug(
               this,
               "%s::%s  Unable to set aftx_mode to %d: ret %d\n",
               v5,
               (__int64)"setAFTXMode",
               v3,
               *((_DWORD *)this + 904));
    *((_DWORD *)this + 904) = a2;
  }
  return result;
}

//----- (0000000000029D76) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setSyncFramePeriod(IO80211AWDLPeerManager *this, int a2)
{
  int v2; // er15@1
  int v3; // er12@2
  OSMetaClass *v4; // rax@3
  __int64 v5; // rax@3
  int v7; // [sp+0h] [bp-50h]@2
  int v8; // [sp+4h] [bp-4Ch]@2
  __int64 *v9; // [sp+8h] [bp-48h]@2
  __int64 v10; // [sp+18h] [bp-38h]@2
  __int64 v11; // [sp+20h] [bp-30h]@2
  int v12; // [sp+28h] [bp-28h]@2
  int v13; // [sp+2Ch] [bp-24h]@2

  v2 = 0;
  if ( *((_DWORD *)this + 376) != a2 )
  {
    v12 = 0;
    v11 = 0LL;
    v10 = 1LL;
    v8 = 116;
    v9 = &v10;
    v7 = -2144835128;
    v11 = *((_DWORD *)this + 373);
    HIDWORD(v10) = *((_DWORD *)this + 374);
    HIDWORD(v11) = *((_DWORD *)this + 375);
    v12 = a2;
    v13 = *((_DWORD *)this + 377);
    v3 = IO80211PeerManager::ioctl_internal(this, (__int64)&v7);
    if ( v3 )
    {
      LODWORD(v4) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v7);
      v5 = OSMetaClass::getClassName(v4);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s fail to set PSF period to %u: %x\n",
        v5,
        (__int64)"setSyncFramePeriod",
        (unsigned int)a2,
        (unsigned int)v3);
      v2 = v3;
    }
    else
    {
      *((_DWORD *)this + 376) = a2;
    }
  }
  return (unsigned int)v2;
}

//----- (0000000000029E5A) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setChannelSequence(IO80211AWDLPeerManager *this)
{
  __int64 result; // rax@3

  if ( *((_BYTE *)this + 3960) && *((_BYTE *)this + 7396) & 1 )
    result = IO80211AWDLPeerManager::setChannelSequenceUnconditional(this, 1);
  else
    result = 0LL;
  return result;
}

//----- (0000000000029E7F) ----------------------------------------------------
__int64 __fastcall _adoptHighestPeerPrivEID(__int64 a1, __int64 a2)
{
  unsigned int v2; // eax@2

  if ( *(_BYTE *)(a2 + 522) )
  {
    v2 = *(_DWORD *)(a2 + 1180);
    if ( *(_DWORD *)(a1 + 3736) < v2 )
    {
      *(_DWORD *)(a1 + 3736) = v2;
      *(_BYTE *)(a1 + 3720) |= 1u;
    }
  }
  return 0LL;
}

//----- (0000000000029EAC) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::updateAWDLPrivateElectionID(IO80211AWDLPeerManager *this)
{
  __int64 v1; // r9@1
  signed int v2; // er14@3
  OSMetaClass *v3; // rax@4
  __int64 v4; // rax@4
  int v5; // er15@5
  OSMetaClass *v6; // rax@6
  __int64 v7; // rax@6
  __int64 v8; // r9@6
  int v10; // [sp+0h] [bp-40h]@5
  int v11; // [sp+4h] [bp-3Ch]@5
  int *v12; // [sp+8h] [bp-38h]@5
  int v13; // [sp+18h] [bp-28h]@5
  char v14; // [sp+1Ch] [bp-24h]@5
  int v15; // [sp+20h] [bp-20h]@5

  v1 = (__int64)"Private Eid Disabled";
  if ( *((_DWORD *)this + 930) & 1 )
    v1 = (__int64)"Private Eid Enabled";
  v2 = 0;
  IO80211PeerManager::logDebug(
    this,
    0x800000LL,
    "%s configure to %u %s \n",
    (__int64)"updateAWDLPrivateElectionID",
    *((_DWORD *)this + 934),
    v1);
  if ( *((_DWORD *)this + 994) )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    0x800000LL);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      0x800000LL,
      "%s::%s Disabling private election for _airplaySink %u\n",
      v4,
      (__int64)"updateAWDLPrivateElectionID",
      *((_DWORD *)this + 992));
    v2 = -1;
  }
  else
  {
    memset(&v13, 0, 0xCuLL);
    v13 = 1;
    v15 = *((_DWORD *)this + 934);
    v14 = *((_BYTE *)this + 3720);
    v10 = -2144835128;
    v11 = 212;
    v12 = &v13;
    v5 = IO80211PeerManager::ioctl_internal(this, (__int64)&v10);
    if ( v5 )
    {
      LODWORD(v6) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v10);
      v7 = OSMetaClass::getClassName(v6);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s\tUnable to enable private election id ret %d\n",
        v7,
        (__int64)"updateAWDLPrivateElectionID",
        (unsigned int)v5,
        v8);
      v2 = v5;
    }
  }
  return (unsigned int)v2;
}

//----- (0000000000029FD8) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::runPiggybackScanStateMachine(IO80211AWDLPeerManager *this)
{
  IO80211AWDLPeerManager *v1; // r12@1
  int v2; // er14@1
  OSMetaClass *v3; // rax@1
  __int64 v4; // rax@1
  char v5; // r9@1
  int v6; // eax@2
  char v7; // r10@4
  char v8; // r8@4
  int v9; // ecx@5
  __int64 v10; // rcx@8
  unsigned int v11; // edx@8
  signed __int64 v12; // rsi@9
  signed __int64 v13; // r13@9
  __int64 v14; // rsi@12
  __int64 v15; // rdi@12
  int v16; // ebx@14
  char v17; // si@15
  char v18; // si@17
  __int64 v19; // rsi@20
  __int64 v20; // rax@23
  char v21; // si@24
  __int64 v22; // rax@29
  __int64 v23; // rsi@29
  size_t v24; // rsi@37
  unsigned int v25; // er13@39
  unsigned int v26; // ebx@39
  OSMetaClass *v27; // rax@43
  __int64 v28; // rax@43
  int v29; // esi@44
  int v30; // er14@46
  OSMetaClass *v31; // rax@47
  __int64 v32; // rax@47
  __int64 v33; // r9@47
  int v34; // er15@53
  OSMetaClass *v35; // rax@54
  __int64 v36; // rax@54
  __int64 v37; // r9@54
  __int64 result; // rax@55
  __int64 v39; // [sp+0h] [bp-1C0h]@0
  int v40; // [sp+8h] [bp-1B8h]@46
  int v41; // [sp+Ch] [bp-1B4h]@46
  __int64 *v42; // [sp+10h] [bp-1B0h]@46
  __int64 v43; // [sp+20h] [bp-1A0h]@46
  int v44; // [sp+28h] [bp-198h]@46
  int v45; // [sp+2Ch] [bp-194h]@46
  int v46; // [sp+30h] [bp-190h]@46
  __int64 v47; // [sp+38h] [bp-188h]@1
  IO80211AWDLPeerManager *v48; // [sp+40h] [bp-180h]@1
  __int64 v49; // [sp+48h] [bp-178h]@1
  __int64 v50; // [sp+50h] [bp-170h]@1
  __int64 v51; // [sp+58h] [bp-168h]@1
  __int64 v52; // [sp+60h] [bp-160h]@1
  __int64 v53; // [sp+68h] [bp-158h]@1
  __int64 v54; // [sp+70h] [bp-150h]@1
  __int64 v55; // [sp+78h] [bp-148h]@1
  __int64 v56; // [sp+80h] [bp-140h]@1
  __int64 v57; // [sp+88h] [bp-138h]@1
  char v58[256]; // [sp+90h] [bp-130h]@42
  __int64 v59; // [sp+190h] [bp-30h]@1

  v1 = this;
  v59 = *(_QWORD *)off_7B078[0];
  v2 = *((_DWORD *)this + 367);
  v57 = 0LL;
  v56 = 0LL;
  v55 = 0LL;
  v54 = 0LL;
  v53 = 0LL;
  v52 = 0LL;
  v51 = 0LL;
  v50 = 0LL;
  v49 = 0LL;
  v48 = 0LL;
  v47 = 0LL;
  LODWORD(v47) = 1;
  LODWORD(v3) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
  v4 = OSMetaClass::getClassName(v3);
  LODWORD(v39) = (unsigned __int16)(v2 + 4);
  IO80211PeerManager::logDebug(
    v1,
    0x400000LL,
    "%s::%s piggybackScanStateMachine start: current index(%d), starting_sequence(%d)\n",
    v4,
    (__int64)"runPiggybackScanStateMachine",
    *((_DWORD *)v1 + 1843));
  *((_BYTE *)this + 7605) = 3;
  *((_BYTE *)this + 7584) = 16;
  *((_BYTE *)this + 1518) = 3;
  v5 = *((_BYTE *)this + 7443);
  if ( v5 )
    v6 = *((_DWORD *)this + 26);
  else
    LOBYTE(v6) = *((_BYTE *)this + 1532);
  *((_BYTE *)this + 7606) = v6;
  v7 = *((_BYTE *)this + 1534);
  v8 = *((_BYTE *)this + 1534);
  *((_BYTE *)this + 7607) = v8;
  if ( v5 )
  {
    v9 = *((_DWORD *)this + 26);
  }
  else
  {
    LOBYTE(v9) = *((_BYTE *)this + 1533);
    if ( !(_BYTE)v9 )
      LOBYTE(v9) = *((_BYTE *)this + 1532);
  }
  *((_BYTE *)this + 7608) = v9;
  *((_BYTE *)this + 7609) = v7;
  v10 = *((_DWORD *)this + 1843);
  v11 = *((_DWORD *)this + 1263);
  if ( (unsigned int)v10 >= v11 )
  {
    *((_BYTE *)this + 7610) = v7;
    v13 = 0LL;
  }
  else
  {
    v12 = 3 * v10;
    LODWORD(v10) = v10 + 1;
    *((_DWORD *)this + 1843) = v10;
    *((_BYTE *)this + 7610) = *((_BYTE *)this + 4 * v12 + 5060);
    WORD2(v49) = v2 + 20;
    LODWORD(v49) = 1;
    v13 = 1LL;
  }
  if ( (unsigned int)v10 >= v11 )
  {
    *((_BYTE *)this + 7611) = v7;
    v15 = (unsigned int)v13;
  }
  else
  {
    v14 = (unsigned int)v10;
    LODWORD(v10) = v10 + 1;
    *((_DWORD *)this + 1843) = v10;
    *((_BYTE *)this + 7611) = *((_BYTE *)this + 12 * v14 + 5060);
    v15 = (unsigned int)(v13 + 1);
    *(_WORD *)((char *)&dword_14 + (2 * v13 | (unsigned __int64)&v47)) = v2 + 24;
    LODWORD(v13) = v49 + 1;
    LODWORD(v49) = v49 + 1;
  }
  v16 = *((_DWORD *)v1 + 26);
  if ( v16 )
  {
    *((_BYTE *)v1 + 7612) = v16;
    v17 = v16;
  }
  else
  {
    *((_BYTE *)v1 + 7612) = v7;
    v17 = v8;
  }
  *((_BYTE *)v1 + 7613) = v17;
  v18 = v16;
  if ( !v5 )
    v18 = *((_BYTE *)v1 + 1532);
  *((_BYTE *)v1 + 7614) = v18;
  if ( (unsigned int)v10 >= v11 )
  {
    *((_BYTE *)v1 + 7615) = v7;
  }
  else
  {
    v19 = (unsigned int)v10;
    LODWORD(v10) = v10 + 1;
    *((_DWORD *)v1 + 1843) = v10;
    *((_BYTE *)v1 + 7615) = *((_BYTE *)v1 + 12 * v19 + 5060);
    *((_WORD *)&v49 + v15 + 2) = v2 + 40;
    LODWORD(v13) = v49 + 1;
    LODWORD(v49) = v49 + 1;
    v15 = (unsigned int)(v15 + 1);
  }
  if ( (unsigned int)v10 >= v11 )
  {
    v21 = v16;
    if ( !v5 )
    {
      v21 = *((_BYTE *)v1 + 1533);
      if ( !v21 )
        v21 = *((_BYTE *)v1 + 1532);
    }
    *((_BYTE *)v1 + 7616) = v21;
  }
  else
  {
    v20 = (unsigned int)v10;
    LODWORD(v10) = v10 + 1;
    *((_DWORD *)v1 + 1843) = v10;
    *((_BYTE *)v1 + 7616) = *((_BYTE *)v1 + 12 * v20 + 5060);
    *((_WORD *)&v49 + v15 + 2) = v2 + 44;
    LODWORD(v13) = v49 + 1;
    LODWORD(v49) = v49 + 1;
    LODWORD(v15) = v15 + 1;
  }
  *((_BYTE *)v1 + 7617) = v7;
  if ( (unsigned int)v10 >= v11 )
  {
    *((_BYTE *)v1 + 7618) = v7;
  }
  else
  {
    v22 = (unsigned int)v10;
    LODWORD(v10) = v10 + 1;
    *((_DWORD *)v1 + 1843) = v10;
    *((_BYTE *)v1 + 7618) = *((_BYTE *)v1 + 12 * v22 + 5060);
    v23 = (unsigned int)v15;
    LODWORD(v15) = v15 + 1;
    *((_WORD *)&v49 + v23 + 2) = v2 + 52;
    LODWORD(v13) = v49 + 1;
    LODWORD(v49) = v49 + 1;
  }
  if ( (unsigned int)v10 >= v11 )
  {
    *((_BYTE *)v1 + 7619) = v7;
  }
  else
  {
    *((_DWORD *)v1 + 1843) = v10 + 1;
    *((_BYTE *)v1 + 7619) = *((_BYTE *)v1 + 12 * (unsigned int)v10 + 5060);
    *((_WORD *)&v49 + (unsigned int)v15 + 2) = v2 + 56;
    LODWORD(v13) = v49 + 1;
    LODWORD(v49) = v49 + 1;
  }
  if ( v16 )
  {
    *((_BYTE *)v1 + 7620) = v16;
  }
  else
  {
    *((_BYTE *)v1 + 7620) = v7;
    LOBYTE(v16) = v8;
  }
  *((_BYTE *)v1 + 7621) = v16;
  v24 = 0x400000LL;
  if ( IO80211PeerManager::shouldLog(v1, 0x400000LL) )
  {
    if ( (_DWORD)v13 )
    {
      v25 = 0;
      v26 = 0;
      do
      {
        v24 = 0LL;
        if ( v26 <= 0xFE )
          v24 = 255 - v26;
        v26 += snprintf(&v58[v26], v24, "%u ", *((_WORD *)&v49 + v25++ + 2), v39);
      }
      while ( v25 < (unsigned int)v49 );
    }
    LODWORD(v27) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, size_t))(*(_QWORD *)v1 + 56LL))(v1, v24);
    v28 = OSMetaClass::getClassName(v27);
    IO80211PeerManager::logDebug(
      v1,
      0x400000LL,
      "%s::%s Sequence numbers for AW's that will have piggyback scanning enabled: %s\n",
      v28,
      (__int64)"runPiggybackScanStateMachine",
      (__int64)v58);
  }
  v29 = *((_DWORD *)v1 + 904);
  if ( v29 != 3 )
  {
    *((_DWORD *)v1 + 904) = 3;
    IO80211AWDLPeerManager::setAFTXMode(v1, v29);
  }
  v44 = 0;
  v43 = 1LL;
  v40 = -2144835128;
  v41 = 118;
  v42 = &v43;
  v46 = *((_BYTE *)v1 + 1518);
  v44 = 0;
  v45 = 0;
  HIDWORD(v43) = 0;
  v30 = IO80211PeerManager::ioctl_internal(v1, (__int64)&v40);
  if ( v30 )
  {
    LODWORD(v31) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)v1 + 56LL))(v1, &v40);
    v32 = OSMetaClass::getClassName(v31);
    IO80211PeerManager::logDebug(
      v1,
      "%s::%s  Unable to set extension params ret %d\n",
      v32,
      (__int64)"runPiggybackScanStateMachine",
      (unsigned int)v30,
      v33);
  }
  else
  {
    *((_DWORD *)v1 + 1882) = 1285;
    IO80211AWDLPeerManager::setPresenceMode(v1, 4u);
    IO80211AWDLPeerManager::setSyncFramePeriod(v1, 440);
    if ( *((_BYTE *)v1 + 3960) && *((_BYTE *)v1 + 7396) & 1 )
      IO80211AWDLPeerManager::setChannelSequenceUnconditional(v1, 1);
    if ( *((_DWORD *)v1 + 1843) >= *((_DWORD *)v1 + 1263) )
      *((_DWORD *)v1 + 1245) = 3;
    v41 = 211;
    v42 = &v47;
    v48 = (IO80211AWDLPeerManager *)((char *)v1 + 4984);
    HIDWORD(v47) = 0;
    v34 = IO80211PeerManager::ioctl_internal(v1, (__int64)&v40);
    v30 = 0;
    if ( v34 )
    {
      LODWORD(v35) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)v1 + 56LL))(v1, &v40);
      v36 = OSMetaClass::getClassName(v35);
      IO80211PeerManager::logDebug(
        v1,
        "%s::%s  Unable to start piggyback scan %d\n",
        v36,
        (__int64)"runPiggybackScanStateMachine",
        (unsigned int)v34,
        v37);
      v30 = v34;
    }
  }
  result = *(_QWORD *)off_7B078[0];
  if ( *(_QWORD *)off_7B078[0] == v59 )
    result = (unsigned int)v30;
  return result;
}
// 14: using guessed type int;
// 7B078: using guessed type __int64 off_7B078[7];
// 29FD8: using guessed type char var_130[256];

//----- (000000000002A656) ----------------------------------------------------
char __fastcall IO80211AWDLPeerManager::setPresenceModeForScan(IO80211AWDLPeerManager *this)
{
  IO80211AWDLPeerManager *v1; // r15@1
  char v2; // r14@3
  unsigned int v3; // esi@5
  int v4; // edx@5
  char v5; // r8@5
  int v6; // eax@5
  int v7; // ecx@5
  unsigned int v8; // edi@5
  unsigned int v9; // eax@6
  signed int v10; // edx@6
  signed int v11; // ebx@7
  OSMetaClass *v13; // rax@11
  __int64 v14; // rax@11

  v1 = this;
  if ( !(*((_BYTE *)this + 7396) & 1) || !*((_BYTE *)this + 652) )
    return 0;
  v2 = 1;
  if ( !*((_BYTE *)this + 1514) )
  {
    if ( *((_DWORD *)this + 259) != 1 )
    {
      v3 = *((_DWORD *)this + 373);
      v4 = *((_DWORD *)this + 374);
      v5 = *((_BYTE *)this + 1512);
      v6 = *((_DWORD *)this + 375);
      v7 = v3 * *((_BYTE *)this + 1512) - v4 - v6;
      v8 = *((_DWORD *)this + 901);
      if ( v7 < v8 )
      {
        v9 = (v8 + v4 + v6) / v3;
        v10 = 1;
        do
        {
          v11 = v10;
          v10 *= 2;
        }
        while ( v11 < v9 );
        *((_BYTE *)v1 + 1513) = v5;
        if ( !(unsigned int)IO80211AWDLPeerManager::setPresenceMode(v1, v11) )
        {
          LODWORD(v13) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, _QWORD))(*(_QWORD *)v1 + 56LL))(
                           v1,
                           (unsigned int)v11);
          v14 = OSMetaClass::getClassName(v13);
          IO80211PeerManager::logDebug(
            v1,
            0x800000LL,
            "%s::%s Scan started, changing PM to %d\n",
            v14,
            (__int64)"setPresenceModeForScan",
            (unsigned int)v11);
          *((_BYTE *)v1 + 1514) = 1;
          return v2;
        }
      }
    }
    return 0;
  }
  return v2;
}

//----- (000000000002A73A) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::sequenceToChannel(IO80211AWDLPeerManager *this)
{
  unsigned int v1; // esi@1
  unsigned int v2; // er8@1
  __int64 result; // rax@2

  v1 = *((_BYTE *)this + 7600) + 1;
  v2 = *((_BYTE *)this + 7605) + 1;
  if ( !(*((_DWORD *)this + 367) % (v2 * v1 * *((_WORD *)this + 3801)) % v1 % v2)
    || (LODWORD(result) = *((_BYTE *)this + 7601), (_DWORD)result == 255) )
    LOBYTE(result) = *((_BYTE *)this + *((_DWORD *)this + 367) % (v2 * v1 * *((_WORD *)this + 3801)) % v1 / v2 + 7606);
  return (unsigned __int8)result;
}

//----- (000000000002A79E) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::updateServiceTimer(IO80211AWDLPeerManager *this)
{
  __int64 v1; // rbx@1
  IO80211CommandQueue *v2; // rdi@1
  signed __int64 (__fastcall *v3)(__int64, __int64, __int64); // rsi@2
  unsigned __int64 v4; // r14@4
  unsigned __int64 v5; // rax@5
  __int64 v6; // rcx@5
  OSMetaClass *v7; // rax@7
  __int64 v8; // rax@7
  __int64 v9; // r9@7
  __int64 v11; // [sp+10h] [bp-20h]@2

  v1 = (__int64)this;
  v2 = (IO80211CommandQueue *)*((_QWORD *)this + 477);
  if ( v2 )
  {
    v11 = 0LL;
    v3 = _nextDeadLine;
    IO80211CommandQueue::lockMap(
      v2,
      (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_nextDeadLine,
      v1,
      (__int64)&v11,
      0LL,
      -1);
    if ( v11 )
    {
      if ( *(_QWORD *)(v1 + 3904) != v11 )
      {
        *(_QWORD *)(v1 + 3904) = v11;
        v4 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (*(_QWORD *)(v1 + 3904) - getAbsoluteTime())) >> 64) >> 18;
        (*(void (__fastcall **)(_QWORD, signed __int64 (__fastcall *)(__int64, __int64, __int64)))(**(_QWORD **)(v1 + 4920)
                                                                                                 + 536LL))(
          *(_QWORD *)(v1 + 4920),
          _nextDeadLine);
        (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v1 + 4920) + 464LL))(
          *(_QWORD *)(v1 + 4920),
          (unsigned int)v4);
        if ( IO80211PeerManager::shouldLog((IO80211PeerManager *)v1, 0x2000000LL) )
        {
          v5 = getAbsoluteTime();
          v6 = 19342813113834067LL * (v5 >> 9) >> 64 >> 11;
          IO80211PeerManager::logDebug(
            (IO80211PeerManager *)v1,
            0x2000000LL,
            "%llu.%03llu set service timer to %llu.%03llu (%lld)\n",
            v6,
            4835703278458516699LL * (v5 - 1000000000 * v6) >> 64 >> 18,
            (unsigned __int64)(19342813113834067LL * (unsigned __int128)(*(_QWORD *)(v1 + 3904) >> 9) >> 64) >> 11);
        }
      }
    }
    else
    {
      if ( *(_DWORD *)(*(_QWORD *)(v1 + 3816) + 52LL) )
      {
        LODWORD(v7) = (*(int (__fastcall **)(__int64, signed __int64 (__fastcall *)(__int64, __int64, __int64)))(*(_QWORD *)v1 + 56LL))(
                        v1,
                        _nextDeadLine);
        v8 = OSMetaClass::getClassName(v7);
        v3 = (signed __int64 (__fastcall *)(__int64, __int64, __int64))"%s::%s no dead line cancel service timer num %u\n";
        IO80211PeerManager::logDebug(
          (IO80211PeerManager *)v1,
          "%s::%s no dead line cancel service timer num %u\n",
          v8,
          (__int64)"updateServiceTimer",
          *(_DWORD *)(*(_QWORD *)(v1 + 3816) + 52LL),
          v9);
      }
      *(_QWORD *)(v1 + 3904) = 0LL;
      (*(void (__fastcall **)(_QWORD, signed __int64 (__fastcall *)(__int64, __int64, __int64)))(**(_QWORD **)(v1 + 4920)
                                                                                               + 536LL))(
        *(_QWORD *)(v1 + 4920),
        v3);
    }
  }
  return 0LL;
}

//----- (000000000002A951) ----------------------------------------------------
signed __int64 __fastcall _nextDeadLine(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  signed __int64 result; // rax@1

  v3 = a3;
  result = 0LL;
  if ( !*(_BYTE *)(a2 + 64) )
  {
    getAbsoluteTime();
    *(_QWORD *)v3 = *(_QWORD *)(a2 + 40);
    result = 3LL;
  }
  return result;
}

//----- (000000000002A97C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::sendOobFrame(IO80211AWDLPeerManager *this, IO80211ActionFrameDescriptor *a2)
{
  IO80211AWDLPeerManager *v2; // r14@1
  int v3; // ebx@1
  OSMetaClass *v4; // rax@3
  __int64 v5; // r10@3
  int v6; // er8@3
  __int64 v7; // r9@3
  int v8; // ST8C_4@5
  int v9; // ST88_4@5
  int v10; // ST84_4@5
  int v11; // ST80_4@5
  int v12; // ST7C_4@5
  __int64 v13; // rdi@5
  __int64 v14; // ST90_8@6
  __int64 v15; // r12@6
  int v16; // ST74_4@6
  int v17; // ST60_4@7
  int v18; // ST58_4@7
  int v19; // ST50_4@7
  __int64 v20; // rdi@12
  __int64 v21; // rax@13
  __int64 v22; // rdi@13
  __int16 v23; // ax@14
  int v24; // er12@17
  unsigned __int64 v25; // rbx@18
  OSMetaClass *v26; // rax@18
  __int64 v27; // rax@18
  __int64 v28; // r8@18
  int v29; // ST30_4@18
  int v30; // ST28_4@18
  int v31; // ST20_4@18
  int v32; // ST18_4@18
  int v33; // ST10_4@18
  int v34; // ST08_4@18
  int v35; // ST00_4@18
  signed __int64 v37; // [sp+90h] [bp-80h]@7
  int v38; // [sp+98h] [bp-78h]@17
  int v39; // [sp+9Ch] [bp-74h]@17
  __int64 *v40; // [sp+A0h] [bp-70h]@17
  __int64 v41; // [sp+B0h] [bp-60h]@9
  __int64 v42; // [sp+B8h] [bp-58h]@9
  __int64 v43; // [sp+C0h] [bp-50h]@9
  __int64 v44; // [sp+C8h] [bp-48h]@9
  __int64 v45; // [sp+D0h] [bp-40h]@9
  __int64 v46; // [sp+D8h] [bp-38h]@9
  __int64 v47; // [sp+E0h] [bp-30h]@9

  v2 = this;
  v3 = 0;
  if ( a2 )
  {
    if ( IO80211PeerManager::shouldLog(this, 0x1000000000LL) )
    {
      getAbsoluteTime();
      LODWORD(v4) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                      this,
                      0x1000000000LL);
      v5 = OSMetaClass::getClassName(v4);
      v6 = *((_DWORD *)this + 257);
      v7 = (__int64)"oob";
      if ( *((_DWORD *)this + 372) == 1 )
        v7 = (__int64)"OOB";
      v8 = *((_BYTE *)a2 + 77);
      v9 = *((_BYTE *)a2 + 78);
      v10 = *((_BYTE *)a2 + 79);
      v11 = *((_BYTE *)a2 + 80);
      v12 = *((_BYTE *)a2 + 81);
      v13 = *((_QWORD *)a2 + 4);
      if ( v13 )
      {
        v14 = v5;
        v15 = v7;
        v16 = *((_BYTE *)a2 + 76);
        mbuf_len(v13);
        v7 = v15;
        v5 = v14;
      }
      v37 = (signed __int64)((char *)v2 + 1028);
      v17 = *((_DWORD *)a2 + 15);
      v18 = *((_WORD *)a2 + 28);
      v19 = *((_BYTE *)a2 + 52);
      IO80211PeerManager::logDebug(
        v2,
        0x1000000000LL,
        "%s::%s %s %llu.%03llu avail %u [%02X:%02X:%02X:%02X:%02X:%02X] len %lu ch %u added %u minDelay %u\n",
        v5,
        (__int64)"sendOobFrame",
        v7);
      v3 = 0;
    }
    else
    {
      v37 = (signed __int64)((char *)this + 1028);
    }
    v47 = 0LL;
    v46 = 0LL;
    v45 = 0LL;
    v44 = 0LL;
    v43 = 0LL;
    v42 = 0LL;
    LODWORD(v41) = 1;
    memset((char *)&v41 + 4, 255, 6uLL);
    if ( *(_DWORD *)v37 )
      LODWORD(v45) = 0;
    else
      LODWORD(v45) = *((_BYTE *)a2 + 52);
    memcpy((char *)&v43 + 6, (char *)v2 + 3668, 6uLL);
    WORD2(v43) = 7;
    v20 = *((_QWORD *)a2 + 4);
    if ( v20 )
    {
      LODWORD(v21) = mbuf_data(v20);
      v22 = *((_QWORD *)a2 + 4);
      v47 = v21;
      if ( v22 )
      {
        v23 = mbuf_len(v22);
        goto LABEL_17;
      }
    }
    else
    {
      v47 = 0LL;
    }
    v23 = 0;
LABEL_17:
    LOWORD(v46) = v23;
    v39 = 149;
    v40 = &v41;
    v38 = -2144835128;
    v24 = IO80211PeerManager::ioctl_internal(v2, (__int64)&v38);
    if ( v24 )
    {
      v25 = getAbsoluteTime();
      LODWORD(v26) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)v2 + 56LL))(v2, &v38);
      v27 = OSMetaClass::getClassName(v26);
      v28 = 19342813113834067LL * (v25 >> 9) >> 64 >> 11;
      v29 = *((_BYTE *)a2 + 81);
      v30 = *((_BYTE *)a2 + 80);
      v31 = *((_BYTE *)a2 + 79);
      v32 = *((_BYTE *)a2 + 78);
      v33 = *((_BYTE *)a2 + 77);
      v34 = *((_BYTE *)a2 + 76);
      v35 = *((_DWORD *)v2 + 257);
      IO80211PeerManager::logDebug(
        v2,
        "%s::%s %llu.%03llu couldn't send af, avail %u [%02X:%02X:%02X:%02X:%02X:%02X]\n",
        v27,
        (__int64)"sendOobFrame",
        v28,
        4835703278458516699LL * (v25 - 1000000000 * v28) >> 64 >> 18);
      IO80211ActionFrameDescriptor::freeResources(a2, 1u);
      (*(void (__fastcall **)(IO80211ActionFrameDescriptor *, signed __int64))(*(_QWORD *)a2 + 40LL))(a2, 1LL);
      v3 = v24;
    }
    else if ( *((_DWORD *)a2 + 17) )
    {
      *((_BYTE *)a2 + 64) = 1;
      IO80211CommandQueue::lockEnqueue(*((IO80211CommandQueue **)v2 + 478), a2);
    }
    else
    {
      IO80211ActionFrameDescriptor::freeResources(a2, 1u);
      (*(void (__fastcall **)(IO80211ActionFrameDescriptor *, signed __int64))(*(_QWORD *)a2 + 40LL))(a2, 1LL);
    }
  }
  return (unsigned int)v3;
}
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);

//----- (000000000002AD6A) ----------------------------------------------------
void IO80211AWDLPeerManager::handleChannelSwitchAnnouncement()
{
  ;
}

//----- (000000000002AD70) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::cachedPeerHasChangedInfra(IO80211AWDLPeerManager *this, IO80211Peer *a2)
{
  OSMetaClass *v2; // rax@1
  __int64 v3; // rax@1
  int v4; // ST58_4@1
  int v5; // ST50_4@1
  int v6; // ST48_4@1
  int v7; // ST40_4@1
  int v8; // ST38_4@1
  int v9; // ST30_4@1
  int v10; // ST28_4@1
  int v11; // ST20_4@1
  int v12; // ST18_4@1
  int v13; // ST10_4@1
  int v14; // ST08_4@1
  int v15; // ST00_4@1

  LODWORD(v2) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
  v3 = OSMetaClass::getClassName(v2);
  v4 = *((_BYTE *)a2 + 1203);
  v5 = *((_BYTE *)a2 + 1209);
  v6 = *((_BYTE *)a2 + 1208);
  v7 = *((_BYTE *)a2 + 1207);
  v8 = *((_BYTE *)a2 + 1206);
  v9 = *((_BYTE *)a2 + 1205);
  v10 = *((_BYTE *)a2 + 1204);
  v11 = *((_BYTE *)a2 + 37);
  v12 = *((_BYTE *)a2 + 36);
  v13 = *((_BYTE *)a2 + 35);
  v14 = *((_BYTE *)a2 + 34);
  v15 = *((_BYTE *)a2 + 33);
  IO80211PeerManager::logDebug(
    this,
    0x800000LL,
    "%s::%s(): Cached peer (%02x:%02x:%02x:%02x:%02x:%02x) has changed infra to %02x:%02x:%02x:%02x:%02x:%02x on channel %d\n",
    v3,
    (__int64)"cachedPeerHasChangedInfra",
    *((_BYTE *)a2 + 32));
  if ( *((_DWORD *)this + 1244) == 4 )
    IO80211AWDLPeerManager::setScheduleState(this, 4u, 1);
}

//----- (000000000002AE7C) ----------------------------------------------------
char __fastcall IO80211AWDLPeerManager::doMonitorTimer(IO80211AWDLPeerManager *this)
{
  __int64 v1; // r15@1
  char v2; // bl@1
  __int64 v3; // rax@1
  int v4; // eax@2
  char *v5; // rsi@4
  OSMetaClass *v6; // rax@6
  __int64 v7; // rcx@6
  __int64 v8; // rax@6
  OSMetaClass *v9; // rax@7
  __int64 v10; // rax@7
  __int64 v11; // r8@7
  __int64 v12; // r9@7
  __int64 (__fastcall *v13)(__int64, __int64, __int64); // rsi@9
  unsigned __int64 v14; // rdx@9
  unsigned int v15; // ST68_4@10
  __int64 v16; // ST58_8@10
  int v17; // ST54_4@10
  __int64 v18; // ST40_8@10
  int v19; // ST38_4@10
  char *v20; // rax@10
  char v21; // r12@12
  unsigned __int64 v22; // r14@15
  unsigned __int64 v23; // rbx@15
  __int64 v24; // rax@15
  IO80211PeerManager *v25; // r13@17
  unsigned __int64 v26; // r15@17
  unsigned __int64 v27; // r12@17
  unsigned __int64 v28; // rbx@17
  __int64 v29; // rax@17
  unsigned int v30; // eax@19
  OSMetaClass *v31; // rax@21
  __int64 v32; // rax@21
  __int64 v33; // r8@21
  __int64 v34; // r9@21
  char v35; // bl@25
  __int64 v36; // r14@27
  int v37; // er13@27
  OSMetaClass *v38; // rax@30
  __int64 v39; // r12@30
  __int64 v40; // rbx@30
  __int64 v41; // rax@30
  __int64 v42; // r9@30
  OSMetaClass *v43; // rax@33
  __int64 v44; // rax@33
  __int64 v45; // r9@33
  __int64 v46; // rax@33
  char v47; // bl@34
  int v48; // eax@35
  __int64 v49; // rbx@41
  __int64 v50; // rbx@43
  __int64 v51; // rbx@45
  __int64 v52; // rbx@47
  OSMetaClass *v53; // rax@49
  __int64 v54; // r14@49
  __int64 v55; // rbx@49
  unsigned __int64 v56; // rdx@49
  __int64 v57; // rbx@51
  unsigned __int64 v58; // r12@52
  __int64 v59; // rbx@53
  unsigned __int64 v60; // r12@54
  __int64 v61; // rbx@55
  unsigned __int64 v62; // r13@56
  int v63; // ST18_4@57
  unsigned int v64; // er12@59
  __int64 v65; // rbx@61
  int v66; // ST00_4@61
  const char *v67; // rdx@61
  __int64 v68; // rcx@61
  int v70; // eax@66
  __int64 v71; // rbx@68
  __int64 v72; // rbx@69
  unsigned int v73; // er12@70
  int v74; // er13@70
  __int64 v75; // rbx@70
  int v76; // ST00_4@70
  char v77; // r13@70
  __int64 v78; // rbx@72
  int v79; // ST00_4@72
  __int64 v80; // r9@73
  IO80211PeerManager *v81; // rdi@73
  __int64 v82; // r8@73
  __int64 v83; // rbx@79
  OSMetaClass *v84; // rax@82
  __int64 v85; // r12@82
  __int64 v86; // rbx@82
  int v87; // ST00_4@82
  OSMetaClass *v88; // rax@85
  __int64 v89; // rax@85
  __int64 v90; // rbx@86
  __int64 v91; // r8@89
  __int64 v92; // r9@89
  __int64 v93; // rax@92
  unsigned __int64 v94; // rax@94
  __int64 v95; // rcx@94
  __int64 v96; // r8@94
  int v97; // edx@94
  __int64 v98; // rdi@94
  int v99; // esi@95
  __int64 v100; // r8@97
  __int64 v101; // r9@97
  unsigned int v102; // eax@97
  int v103; // ecx@98
  int v104; // eax@102
  int v105; // ecx@102
  int v106; // eax@102
  unsigned int v107; // eax@103
  __int64 v108; // rbx@107
  unsigned int v109; // er12@108
  int v110; // er13@108
  __int64 v111; // rbx@108
  int v112; // ST00_4@108
  __int64 v113; // rbx@111
  __int64 v114; // rbx@112
  unsigned int v115; // er12@113
  int v116; // er13@113
  __int64 v117; // rbx@113
  int v118; // ST00_4@113
  __int64 v119; // rbx@114
  __int64 v120; // rbx@115
  unsigned int v121; // er12@116
  __int64 v122; // rbx@116
  unsigned int v123; // er15@116
  __int64 v124; // r13@116
  int v125; // ST00_4@116
  __int64 v126; // rbx@119
  unsigned int v127; // er12@120
  int v128; // er13@120
  __int64 v129; // rbx@120
  int v130; // ST00_4@120
  __int64 v131; // rbx@122
  unsigned int v132; // er12@123
  int v133; // er13@123
  __int64 v134; // rbx@123
  int v135; // ST00_4@123
  bool v136; // [sp+68h] [bp-68h]@27
  __int64 v137; // [sp+68h] [bp-68h]@51
  __int64 v138; // [sp+70h] [bp-60h]@2
  unsigned int v139; // [sp+7Ch] [bp-54h]@97
  __int64 v140; // [sp+80h] [bp-50h]@33
  int v141; // [sp+88h] [bp-48h]@9
  int v142; // [sp+8Ch] [bp-44h]@9
  __int64 v143; // [sp+90h] [bp-40h]@4
  __int64 v144; // [sp+98h] [bp-38h]@1
  int v145; // [sp+A4h] [bp-2Ch]@27

  v1 = (__int64)this;
  v2 = ((int (*)(void))`vtable for'IO80211PeerManager[40])();
  v144 = 1LL;
  v3 = getAbsoluteTime();
  if ( !v2 )
    return 0;
  v138 = v3;
  v4 = *((_DWORD *)this + 1844);
  if ( v4 == 3 || v4 == 5 )
  {
    v143 = 1LL;
    v5 = (char *)this + 1456;
    if ( v4 == 3 )
      v5 = (char *)this + 7380;
    memcpy((char *)&v143 + 4, v5, 3uLL);
    LODWORD(v6) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
    v7 = OSMetaClass::getClassName(v6);
    *((_DWORD *)this + 1844);
    IO80211PeerManager::logDebug(
      this,
      0x2000000000LL,
      "%s::%s Requesting host to change country code to %s based on %s\n",
      v7,
      (__int64)"doMonitorTimer",
      (__int64)((char *)&v143 + 4));
    v8 = IO80211PeerManager::getController(this);
    if ( IO80211Controller::setCountryCode(v8, (__int64)&v143) )
    {
      LODWORD(v9) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64 *))(*(_QWORD *)this + 56LL))(this, &v143);
      v10 = OSMetaClass::getClassName(v9);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s Failed to set country code\n",
        v10,
        (__int64)"doMonitorTimer",
        v11,
        v12);
      if ( *((_DWORD *)this + 1844) != 5 )
        *((_DWORD *)this + 1844) = 1;
    }
  }
  v142 = 0;
  v141 = 0;
  IO80211CommandQueue::lockMap(
    *((IO80211CommandQueue **)this + 476),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countNonAirPlayServices,
    (__int64)this,
    (__int64)&v141,
    0LL,
    -1);
  IO80211CommandQueue::lockMap(
    *((IO80211CommandQueue **)this + 476),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countAirPlayServices,
    (__int64)this,
    (__int64)&v142,
    0LL,
    -1);
  v13 = (__int64 (__fastcall *)(__int64, __int64, __int64))0x20000000;
  if ( IO80211PeerManager::shouldLog(this, 0x20000000LL) )
  {
    v15 = *(_DWORD *)(*((_QWORD *)this + 476) + 52LL);
    v16 = (__int64)IO80211PeerManager::getBSDName(this);
    v17 = *((_DWORD *)this + 1885);
    *((_DWORD *)this + 1849);
    v18 = *((_QWORD *)this + 489);
    v1 = (__int64)this;
    v19 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v18)) >> 64) >> 18;
    v13 = (__int64 (__fastcall *)(__int64, __int64, __int64))0x20000000;
    IO80211PeerManager::logDebug(
      this,
      0x20000000LL,
      "%s::%s monTimer services %u trigger %u numNonAirPlayServices %u _state 0x%u%s%s%s%s since %u(ms)\n",
      v16,
      (__int64)"doMonitorTimer",
      v15);
    v20 = (char *)this + 7540;
  }
  else
  {
    v20 = (char *)this + 7540;
  }
  v21 = 0;
  if ( *(_DWORD *)v20 && !v141 && !v142 )
  {
    v22 = *(_QWORD *)(v1 + 3912);
    v23 = *(_QWORD *)(v1 + 992);
    v24 = getAbsoluteTime();
    if ( v22 > v23 )
      v23 = v22;
    v25 = (IO80211PeerManager *)v1;
    v26 = 4835703278458516699LL * (v24 - v23) >> 64 >> 18;
    v27 = *((_QWORD *)v25 + 489);
    v28 = *((_QWORD *)v25 + 125);
    v29 = getAbsoluteTime();
    if ( v27 > v28 )
      v28 = v27;
    v14 = 4835703278458516699LL * (v29 - v28) >> 64;
    v30 = *((_DWORD *)v25 + 913);
    v21 = 0;
    if ( (unsigned int)v26 <= v30 )
    {
      v1 = (__int64)v25;
    }
    else
    {
      v14 >>= 18;
      v1 = (__int64)v25;
      if ( (unsigned int)v14 > v30 )
      {
        LODWORD(v31) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64, unsigned __int64, IO80211PeerManager *))(*(_QWORD *)v25 + 56LL))(
                         v25,
                         0x20000000LL,
                         v14,
                         v25);
        v32 = OSMetaClass::getClassName(v31);
        v13 = (__int64 (__fastcall *)(__int64, __int64, __int64))"%s::%s(): Disabling AWDL due to no services and idle link.\n";
        IO80211PeerManager::logDebug(
          v25,
          "%s::%s(): Disabling AWDL due to no services and idle link.\n",
          v32,
          (__int64)"doMonitorTimer",
          v33,
          v34);
        v21 = 1;
      }
    }
  }
  if ( !*(_DWORD *)(v1 + 1036) )
  {
    v35 = v141 ? 0 : v142 != 0;
    v145 = 0;
    v13 = _countNonATVCachedPeers;
    IO80211CommandQueue::map(
      *(_QWORD *)(v1 + 88),
      (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countNonATVCachedPeers,
      v1,
      (__int64)&v145,
      0LL,
      -1);
    v36 = *(_QWORD *)(v1 + 3928);
    v136 = v145 != 0;
    v37 = *(_DWORD *)(v1 + 104);
    v14 = (unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v36)) >> 64;
    if ( !v37 && !(v136 | (unsigned __int8)(v35 ^ 1)) )
    {
      v14 >>= 18;
      if ( (unsigned int)v14 >= 0x2711 )
      {
        LODWORD(v38) = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(__int64, __int64, __int64)))(*(_QWORD *)v1 + 56LL))(
                         v1,
                         _countNonATVCachedPeers);
        v39 = OSMetaClass::getClassName(v38);
        v40 = *(_QWORD *)(v1 + 3928);
        v41 = getAbsoluteTime();
        v13 = (__int64 (__fastcall *)(__int64, __int64, __int64))"%s::%s(): Disabling AWDL: Airplay registered in legacy infra-assist mode without an infra connection for %u ms\n";
        IO80211PeerManager::logDebug(
          (IO80211PeerManager *)v1,
          "%s::%s(): Disabling AWDL: Airplay registered in legacy infra-assist mode without an infra connection for %u ms\n",
          v39,
          (__int64)"doMonitorTimer",
          (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (v41 - v40)) >> 64) >> 18),
          v42);
LABEL_32:
        if ( *(_DWORD *)(v1 + 7376) == 4 )
        {
          LODWORD(v43) = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(__int64, __int64, __int64)))(*(_QWORD *)v1 + 56LL))(
                           v1,
                           v13);
          v44 = OSMetaClass::getClassName(v43);
          IO80211PeerManager::logDebug(
            (IO80211PeerManager *)v1,
            0x2000000000LL,
            "%s::%s Country code was set from peer, moving back to unknown\n",
            v44,
            (__int64)"doMonitorTimer",
            v45);
          v140 = 1LL;
          v46 = IO80211PeerManager::getController((IO80211PeerManager *)v1);
          IO80211Controller::setCountryCode(v46, (__int64)&v140);
          *(_DWORD *)(v1 + 7376) = 0;
        }
        v47 = 0;
        IO80211AWDLPeerManager::doAwdlDisable((IO80211AWDLPeerManager *)v1, 0);
        return v47;
      }
    }
  }
  if ( v21 )
    goto LABEL_32;
  v48 = *(_DWORD *)(v1 + 7396);
  if ( !(v48 & 0xE) )
    return 0;
  if ( *(_DWORD *)(v1 + 3984) )
  {
    if ( *(_DWORD *)(v1 + 3996) )
    {
      if ( !(v48 & 4) && !*(_DWORD *)(v1 + 3968) && !*(_DWORD *)(v1 + 4980) )
      {
        v49 = *(_QWORD *)(v1 + 600);
        if ( !v49
          || (v14 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v49)) >> 64) >> 18,
              (unsigned int)v14 > *(_DWORD *)(v1 + 4012)) )
        {
          v50 = *(_QWORD *)(v1 + 592);
          if ( !v50
            || (v14 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v50)) >> 64) >> 18,
                (unsigned int)v14 > *(_DWORD *)(v1 + 4008)) )
          {
            v51 = *(_QWORD *)(v1 + 3920);
            if ( !v51
              || (v14 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v51)) >> 64) >> 18,
                  (unsigned int)v14 > *(_DWORD *)(v1 + 3996)) )
            {
              v52 = *(_QWORD *)(v1 + 3912);
              if ( !v52
                || (v14 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v52)) >> 64) >> 18,
                    (unsigned int)v14 > *(_DWORD *)(v1 + 3996)) )
              {
                LODWORD(v53) = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(__int64, __int64, __int64), unsigned __int64))(*(_QWORD *)v1 + 56LL))(
                                 v1,
                                 v13,
                                 v14);
                v54 = OSMetaClass::getClassName(v53);
                v55 = *(_QWORD *)(v1 + 592);
                v56 = 0LL;
                if ( v55 )
                  v56 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v55)) >> 64) >> 18;
                v137 = v56;
                v57 = *(_QWORD *)(v1 + 600);
                if ( v57 )
                  v58 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v57)) >> 64) >> 18;
                v59 = *(_QWORD *)(v1 + 3920);
                if ( v59 )
                  v60 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v59)) >> 64) >> 18;
                v61 = *(_QWORD *)(v1 + 3912);
                if ( v61 )
                  v62 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v61)) >> 64) >> 18;
                v63 = *(_DWORD *)(v1 + 1020);
                IO80211PeerManager::logDebug(
                  (IO80211PeerManager *)v1,
                  137975824384LL,
                  "%s::%s browsing device idle for txQUni %u(ms) txQMulti %u(ms) statechange %u(ms) serviceupdate %u(ms)  pkt %u -> quiet\n",
                  v54,
                  (__int64)"doMonitorTimer",
                  v137);
                IO80211AWDLPeerManager::enterQuietMode((IO80211AWDLPeerManager *)v1, 0);
                IO80211PeerManager::lockDataPath((IO80211PeerManager *)v1);
                IO80211Peer::flushQueues(*(IO80211Peer **)(v1 + 72), 0);
                IO80211PeerManager::unlockDataPath((IO80211PeerManager *)v1, 0LL);
              }
            }
          }
        }
      }
    }
  }
  IO80211PeerManager::lockDataPath((IO80211PeerManager *)v1);
  if ( *(_DWORD *)(v1 + 3968) )
  {
    *(_DWORD *)(v1 + 7400) = 255;
    v64 = *(_DWORD *)(v1 + 3728);
    if ( *(_DWORD *)(v1 + 4048) )
    {
      if ( v64 != 250 )
      {
        HIDWORD(v144) = 250;
        v65 = *(_QWORD *)(v1 + 3936);
        v66 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v65)) >> 64) >> 18;
        v67 = "%d: met %x   flags %x _lastTimeSince %u \n";
        v68 = 3535LL;
LABEL_73:
        v80 = 255LL;
        v81 = (IO80211PeerManager *)v1;
        v82 = v64;
LABEL_74:
        IO80211PeerManager::logDebug(v81, 0x800000LL, v67, v68, v82, v80);
        v77 = 1;
        goto LABEL_76;
      }
    }
    else if ( v64 >= 0x51 )
    {
      HIDWORD(v144) = 8 * (unsigned __int8)*(_DWORD *)(v1 + 3972) & 0x10 ^ 0x50;
      v78 = *(_QWORD *)(v1 + 3936);
      v79 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v78)) >> 64) >> 18;
      v67 = "%d: met %x (to default)   flags %x _lastTimeSince %u \n";
      v68 = 3541LL;
      goto LABEL_73;
    }
  }
  else if ( *(_DWORD *)(v1 + 3728) <= 0x95u && !(*(_BYTE *)(v1 + 7396) & 0xC) )
  {
    v70 = *(_DWORD *)(v1 + 7400);
    if ( *(_DWORD *)(v1 + 4976) == 4 )
    {
      if ( v70 & 8
        || (v71 = *(_QWORD *)(v1 + 8480),
            (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v71)) >> 64) >> 18) < 0x7D1)
        || (v72 = *(_QWORD *)(v1 + 3936),
            (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v72)) >> 64) >> 18) < 0x7D1) )
      {
        v77 = 0;
      }
      else
      {
        v73 = *(_DWORD *)(v1 + 3728);
        HIDWORD(v144) = v73 + 2;
        v74 = *(_DWORD *)(v1 + 7400) | 8;
        *(_DWORD *)(v1 + 7400) = v74;
        v75 = *(_QWORD *)(v1 + 3936);
        v76 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v75)) >> 64) >> 18;
        IO80211PeerManager::logDebug(
          (IO80211PeerManager *)v1,
          0x800000LL,
          "%d: met %x   flags %x _lastTimeSince %u \n",
          3556LL,
          v73,
          (unsigned int)v74);
        v77 = 1;
      }
      if ( !(*(_BYTE *)(v1 + 7400) & 0x10) )
      {
        v113 = *(_QWORD *)(v1 + 8480);
        if ( (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v113)) >> 64) >> 18) >= 0xFA1 )
        {
          v114 = *(_QWORD *)(v1 + 3936);
          if ( (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v114)) >> 64) >> 18) >= 0xFA1 )
          {
            v115 = *(_DWORD *)(v1 + 3728);
            HIDWORD(v144) = v115 + 2;
            v116 = *(_DWORD *)(v1 + 7400) | 0x10;
            *(_DWORD *)(v1 + 7400) = v116;
            v117 = *(_QWORD *)(v1 + 3936);
            v118 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v117)) >> 64) >> 18;
            IO80211PeerManager::logDebug(
              (IO80211PeerManager *)v1,
              0x800000LL,
              "%d: met %x   flags %x _lastTimeSince %u \n",
              3564LL,
              v115,
              (unsigned int)v116);
            v77 = 1;
          }
        }
      }
      v119 = *(_QWORD *)(v1 + 8480);
      if ( (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v119)) >> 64) >> 18) < 0x2711 )
        goto LABEL_76;
      v120 = *(_QWORD *)(v1 + 3936);
      if ( (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v120)) >> 64) >> 18) < 0x2711 )
        goto LABEL_76;
      v121 = *(_DWORD *)(v1 + 3728);
      HIDWORD(v144) = v121 + 2;
      v122 = v1;
      v123 = *(_DWORD *)(v1 + 7400);
      v124 = *(_QWORD *)(v122 + 3936);
      v125 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v124)) >> 64) >> 18;
      v67 = "%d: met %x   flags %x _lastTimeSince %u \n";
      v68 = 3571LL;
      v82 = v121;
      v81 = (IO80211PeerManager *)v122;
      v80 = v123;
      v1 = v122;
    }
    else
    {
      if ( v70 & 1
        || (v108 = *(_QWORD *)(v1 + 3936),
            (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v108)) >> 64) >> 18) < 0xFA1) )
      {
        v77 = 0;
      }
      else
      {
        v109 = *(_DWORD *)(v1 + 3728);
        HIDWORD(v144) = v109 + 2;
        v110 = *(_DWORD *)(v1 + 7400) | 1;
        *(_DWORD *)(v1 + 7400) = v110;
        v111 = *(_QWORD *)(v1 + 3936);
        v112 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v111)) >> 64) >> 18;
        IO80211PeerManager::logDebug(
          (IO80211PeerManager *)v1,
          0x800000LL,
          "%d: met %x   flags %x _lastTimeSince %u \n",
          3582LL,
          v109,
          (unsigned int)v110);
        v77 = 1;
      }
      if ( !(*(_BYTE *)(v1 + 7400) & 2) )
      {
        v126 = *(_QWORD *)(v1 + 3936);
        if ( (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v126)) >> 64) >> 18) >= 0x4E21 )
        {
          v127 = *(_DWORD *)(v1 + 3728);
          HIDWORD(v144) = v127 + 2;
          v128 = *(_DWORD *)(v1 + 7400) | 2;
          *(_DWORD *)(v1 + 7400) = v128;
          v129 = *(_QWORD *)(v1 + 3936);
          v130 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v129)) >> 64) >> 18;
          IO80211PeerManager::logDebug(
            (IO80211PeerManager *)v1,
            0x800000LL,
            "%d: met %x   flags %x _lastTimeSince %u \n",
            3590LL,
            v127,
            (unsigned int)v128);
          v77 = 1;
        }
      }
      if ( *(_BYTE *)(v1 + 7400) & 4 )
        goto LABEL_76;
      v131 = *(_QWORD *)(v1 + 3936);
      if ( (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v131)) >> 64) >> 18) < 0xEA61 )
        goto LABEL_76;
      v132 = *(_DWORD *)(v1 + 3728);
      HIDWORD(v144) = v132 + 2;
      v133 = *(_DWORD *)(v1 + 7400) | 4;
      *(_DWORD *)(v1 + 7400) = v133;
      v134 = *(_QWORD *)(v1 + 3936);
      v135 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v134)) >> 64) >> 18;
      v67 = "%d: met %x   flags %x _lastTimeSince %u \n";
      v68 = 3598LL;
      v82 = v132;
      v81 = (IO80211PeerManager *)v1;
      v80 = (unsigned int)v133;
    }
    goto LABEL_74;
  }
  v77 = 0;
LABEL_76:
  if ( !*(_BYTE *)(v1 + 7408) )
    goto LABEL_127;
  if ( *(_BYTE *)(v1 + 3636) )
  {
    if ( *(_DWORD *)(v1 + 104) != *(_BYTE *)(*(_QWORD *)(v1 + 7416) + 1203LL) )
    {
      v83 = *(_QWORD *)(v1 + 3952);
      if ( (!v83
         || (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v83)) >> 64) >> 18) > *(_DWORD *)(v1 + 1536))
        && *(_DWORD *)(v1 + 3648) <= 1u )
      {
        LODWORD(v84) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v1 + 56LL))(v1);
        v85 = OSMetaClass::getClassName(v84);
        v86 = *(_QWORD *)(v1 + 3952);
        v87 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v86)) >> 64) >> 18;
        IO80211PeerManager::logDebug(
          (IO80211PeerManager *)v1,
          0x800000LL,
          "%s:%s: %d attempt to Force Roaming as the last one was %u secs ago\n",
          v85,
          (__int64)"doMonitorTimer",
          3610LL);
        *(_QWORD *)(v1 + 3952) = v138;
        IO80211AWDLPeerManager::forceRoamToPeersAP((IO80211AWDLPeerManager *)v1, (ether_addr *)0x800000);
      }
    }
  }
  if ( !*(_BYTE *)(v1 + 7408) )
  {
LABEL_127:
    if ( *(_BYTE *)(v1 + 3644) )
    {
      LODWORD(v88) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v1 + 56LL))(v1);
      v89 = OSMetaClass::getClassName(v88);
      IO80211PeerManager::logDebug(
        (IO80211PeerManager *)v1,
        0x800000LL,
        "%s:%s: %d Done with Airplay & Force Roaming was requested; Re enabling roam\n",
        v89,
        (__int64)"doMonitorTimer",
        3617LL);
      IO80211AWDLPeerManager::enableRoaming((IO80211AWDLPeerManager *)v1);
    }
  }
  v90 = *(_QWORD *)(v1 + 592);
  if ( v90
    && (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v90)) >> 64) >> 18) >= 0x2711 )
    IO80211PeerManager::flushFreeMbufs((IO80211PeerManager *)v1);
  IO80211Peer::flushQueues(*(IO80211Peer **)(v1 + 72), 10000);
  IO80211PeerManager::unlockDataPath((IO80211PeerManager *)v1, 10000LL);
  if ( v77 )
  {
    IO80211PeerManager::logDebug(
      (IO80211PeerManager *)v1,
      137984212992LL,
      "changing election metric to %u \n",
      HIDWORD(v144),
      v91,
      v92);
    IO80211AWDLPeerManager::setAwdlElectionMetric((IO80211PeerManager *)v1, (__int64)&v144);
  }
  memset((void *)(v1 + 4072), 0, 0x2CuLL);
  if ( *(_DWORD *)(v1 + 104) )
  {
    v93 = IO80211PeerManager::getController((IO80211PeerManager *)v1);
    IO80211Controller::getInfraExtendedStats(v93, v1 + 4072);
  }
  if ( IO80211PeerManager::shouldLog((IO80211PeerManager *)v1, 0x20000000LL) )
  {
    v94 = getAbsoluteTime();
    v95 = 19342813113834067LL * (v94 >> 9) >> 64 >> 11;
    v96 = 4835703278458516699LL * (v94 - 1000000000 * v95) >> 64 >> 18;
    LODWORD(v94) = *(_DWORD *)(v1 + 8244);
    v97 = *(_DWORD *)(v1 + 4100);
    v98 = *(_QWORD *)(v1 + 3808);
    if ( v98 )
      v99 = *(_DWORD *)(v98 + 52);
    *(_DWORD *)(v1 + 7396);
    IO80211PeerManager::logDebug(
      (IO80211PeerManager *)v1,
      0x20000000LL,
      "%llu.%03llu ichan %u _roamAsserted %u rssi %d srv %u state %u %s\n",
      v95,
      v96,
      *(_DWORD *)(v1 + 104));
  }
  v139 = 0;
  IO80211PeerManager::lockDataPath((IO80211PeerManager *)v1);
  IO80211CommandQueue::map(
    *(_QWORD *)(v1 + 88),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countCachedPeers,
    v1,
    (__int64)&v139,
    0LL,
    -1);
  IO80211PeerManager::unlockDataPath((IO80211PeerManager *)v1, (__int64)_countCachedPeers);
  v102 = v139;
  if ( !v139 )
  {
    v103 = *(_DWORD *)(v1 + 3720);
    v102 = 0;
    if ( v103 & 1 )
    {
      *(_DWORD *)(v1 + 3720) = v103 & 0xFFFFFFFE;
      *(_DWORD *)(v1 + 3736) = 0;
      IO80211PeerManager::logDebug((IO80211PeerManager *)v1, 0x10000LL, "Disabling Priv Eid: %u \n", 0LL, v100, v101);
      IO80211AWDLPeerManager::updateAWDLPrivateElectionID((IO80211AWDLPeerManager *)v1);
      v102 = v139;
    }
  }
  if ( *(_BYTE *)(v1 + 8279) < v102 )
    *(_BYTE *)(v1 + 8279) = v102;
  IO80211AWDLPeerManager::awdlStatsCollectCachedPeersBandInfo((IO80211AWDLPeerManager *)v1);
  v104 = *(_DWORD *)(v1 + 836);
  *(_DWORD *)(v1 + 8264) += *(_DWORD *)(v1 + 836) - *(_DWORD *)(v1 + 8488);
  v105 = *(_DWORD *)(v1 + 832);
  *(_DWORD *)(v1 + 8268) += *(_DWORD *)(v1 + 832) - *(_DWORD *)(v1 + 8492);
  *(_DWORD *)(v1 + 8488) = v104;
  *(_DWORD *)(v1 + 8492) = v105;
  *(_BYTE *)(v1 + 8276) = *(_BYTE *)(v1 + 104);
  v106 = *(_DWORD *)(v1 + 8260);
  if ( *(_DWORD *)(v1 + 4048) )
    v107 = v106 | 8;
  else
    v107 = v106 & 0xFFFFFFF7;
  *(_DWORD *)(v1 + 8260) = v107;
  return 1;
}
// 7D5B0: using guessed type __int64 `vtable for'IO80211PeerManager[2];

//----- (000000000002BE5E) ----------------------------------------------------
__int64 __fastcall _countNonAirPlayServices(__int64 a1, IO80211ServiceRequestDescriptor *a2, __int64 a3)
{
  __int64 v3; // r14@1
  unsigned __int64 v4; // rax@3
  unsigned __int64 v5; // rax@4
  unsigned __int64 v6; // rax@5
  unsigned __int64 v7; // rax@6

  v3 = a3;
  if ( a2 )
  {
    if ( (unsigned __int8)IO80211ServiceRequestDescriptor::recordType(a2) == 12 )
    {
      v4 = strlen("ip6");
      if ( (signed int)IO80211ServiceRequestDescriptor::hasString(a2, "ip6", v4) < 0
        || (v5 = strlen("arpa"), (signed int)IO80211ServiceRequestDescriptor::hasString(a2, "arpa", v5) < 0) )
      {
        v6 = strlen("airplay");
        if ( (signed int)IO80211ServiceRequestDescriptor::hasString(a2, "airplay", v6) < 0 )
        {
          v7 = strlen("raop");
          if ( (signed int)IO80211ServiceRequestDescriptor::hasString(a2, "raop", v7) < 0 )
            ++*(_DWORD *)v3;
        }
      }
    }
  }
  return 0LL;
}

//----- (000000000002BF20) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::nonATVCachedCount(IO80211AWDLPeerManager *this)
{
  unsigned int v2; // [sp+Ch] [bp-4h]@1

  v2 = 0;
  IO80211CommandQueue::map(
    *((_QWORD *)this + 11),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countNonATVCachedPeers,
    (__int64)this,
    (__int64)&v2,
    0LL,
    -1);
  return v2;
}

//----- (000000000002BF5C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::enterQuietMode(IO80211AWDLPeerManager *this, char a2)
{
  IO80211AWDLPeerManager *v2; // r15@1
  int v3; // eax@1
  int v4; // ebx@1
  OSMetaClass *v5; // rax@5
  __int64 v6; // rcx@5
  char *v7; // r9@5
  int v8; // eax@7
  int v9; // eax@8
  __int64 v10; // rsi@10
  OSMetaClass *v11; // rax@11
  __int64 v12; // rax@11
  __int64 v13; // r9@11
  __int64 v14; // rdi@12
  int v16; // [sp+8h] [bp-48h]@10
  __int64 v17; // [sp+Ch] [bp-44h]@10
  __int64 v18; // [sp+18h] [bp-38h]@7
  int v19; // [sp+20h] [bp-30h]@5
  int v20; // [sp+24h] [bp-2Ch]@10
  int *v21; // [sp+28h] [bp-28h]@10

  v2 = this;
  v3 = *((_DWORD *)this + 1849);
  v4 = 6;
  if ( v3 & 1 )
  {
    if ( a2 )
    {
      v3 |= 8u;
      *((_DWORD *)this + 1849) = v3;
    }
    v4 = 0;
    if ( v3 & 2 )
    {
      bzero(&v19, 0x18uLL);
      LODWORD(v5) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                      this,
                      24LL);
      v6 = OSMetaClass::getClassName(v5);
      v7 = &byte_690F5;
      if ( a2 )
        v7 = "suspend";
      IO80211PeerManager::logDebug(
        this,
        137975824384LL,
        "%s::%s Entering quiet %s mode\n",
        v6,
        (__int64)"enterQuietMode",
        (__int64)v7);
      v18 = 1LL;
      *((_DWORD *)this + 1850) = 0;
      v8 = 8 * (unsigned __int8)*((_DWORD *)this + 993) & 0x10;
      if ( *((_DWORD *)this + 992) )
        v9 = v8 ^ 0x50;
      else
        v9 = v8 ^ 0x70;
      HIDWORD(v18) = v9;
      IO80211AWDLPeerManager::setAwdlElectionMetric(this, (__int64)&v18);
      v16 = 1;
      v20 = 117;
      v19 = -2144835128;
      v21 = &v16;
      v17 = 1LL;
      v10 = (__int64)&v19;
      v4 = IO80211PeerManager::ioctl_internal(this, (__int64)&v19);
      if ( v4 )
      {
        LODWORD(v11) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v19);
        v12 = OSMetaClass::getClassName(v11);
        IO80211PeerManager::logDebug(
          this,
          "%s::%s can't disable sync.  Quiet mode entry failed. Error=%d\n",
          v12,
          (__int64)"enterQuietMode",
          (unsigned int)v4,
          v13);
      }
      else
      {
        *((_DWORD *)this + 1849) = *((_DWORD *)this + 1849) & 0xFFFFFFF9 | 4;
        v14 = *((_QWORD *)this + 79);
        if ( v14 )
        {
          v10 = *((_DWORD *)v2 + 172);
          (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v14 + 464LL))(v14, v10);
        }
        IO80211AWDLPeerManager::awdlStatsPostMetrics(v2, v10);
        v4 = 0;
      }
    }
  }
  return (unsigned int)v4;
}
// 690F5: using guessed type char byte_690F5;

//----- (000000000002C0E6) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::enableRoaming(IO80211AWDLPeerManager *this)
{
  int v1; // er14@1
  OSMetaClass *v2; // rax@2
  __int64 v3; // rax@2
  __int64 v4; // r9@2
  int v6; // [sp+8h] [bp-38h]@1
  int v7; // [sp+Ch] [bp-34h]@1
  __int64 *v8; // [sp+10h] [bp-30h]@1
  __int64 v9; // [sp+20h] [bp-20h]@1
  int v10; // [sp+28h] [bp-18h]@1

  v10 = 0;
  v9 = 1LL;
  v6 = -2144835128;
  v7 = 224;
  v8 = &v9;
  v1 = IO80211PeerManager::ioctl_internal(this, (__int64)&v6);
  if ( v1 )
  {
    LODWORD(v2) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v6);
    v3 = OSMetaClass::getClassName(v2);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s  Unable to enable roaming: ret %d\n",
      v3,
      (__int64)"enableRoaming",
      (unsigned int)v1,
      v4);
  }
  *((_BYTE *)this + 3644) = 0;
  *((_DWORD *)this + 912) = 0;
  return (unsigned int)v1;
}

//----- (000000000002C17C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::awdlStatsIncrementCachedPeers(IO80211AWDLPeerManager *this, unsigned int a2)
{
  __int64 result; // rax@1

  result = *((_BYTE *)this + 8279);
  if ( (unsigned int)result < a2 )
    *((_BYTE *)this + 8279) = a2;
  return result;
}

//----- (000000000002C194) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::awdlStatsCollectCachedPeersBandInfo(IO80211AWDLPeerManager *this)
{
  unsigned int v1; // eax@1
  unsigned int v2; // eax@3
  unsigned int v3; // eax@5
  __int64 result; // rax@7

  v1 = *((_DWORD *)this + 2124);
  if ( v1 > *((_BYTE *)this + 8283) )
    *((_BYTE *)this + 8283) = v1;
  v2 = *((_DWORD *)this + 2126);
  if ( v2 > *((_BYTE *)this + 8281) )
    *((_BYTE *)this + 8281) = v2;
  v3 = *((_DWORD *)this + 2127);
  if ( v3 > *((_BYTE *)this + 8282) )
    *((_BYTE *)this + 8282) = v3;
  result = *((_DWORD *)this + 2125);
  if ( (unsigned int)result > *((_BYTE *)this + 8280) )
    *((_BYTE *)this + 8280) = result;
  *((_QWORD *)this + 1062) = 0LL;
  *((_QWORD *)this + 1063) = 0LL;
  return result;
}

//----- (000000000002C20C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::awdlStatsUnicastPktCount(IO80211AWDLPeerManager *this)
{
  __int64 result; // rax@1
  int v2; // ecx@1

  result = *((_DWORD *)this + 209);
  *((_DWORD *)this + 2066) += *((_DWORD *)this + 209) - *((_DWORD *)this + 2122);
  v2 = *((_DWORD *)this + 208);
  *((_DWORD *)this + 2067) += *((_DWORD *)this + 208) - *((_DWORD *)this + 2123);
  *((_DWORD *)this + 2122) = result;
  *((_DWORD *)this + 2123) = v2;
  return result;
}

//----- (000000000002C246) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::awdlStatsSetSelfInfraChannel(IO80211AWDLPeerManager *this, char a2)
{
  *((_BYTE *)this + 8276) = a2;
}

//----- (000000000002C254) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::awdlStatsSetFlags(IO80211AWDLPeerManager *this, int a2)
{
  *((_DWORD *)this + 2065) |= a2;
}

//----- (000000000002C260) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::awdlStatsClearFlags(IO80211AWDLPeerManager *this, int a2)
{
  *((_DWORD *)this + 2065) &= ~a2;
}

//----- (000000000002C26E) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::doNeighborMonitoring(IO80211AWDLPeerManager *this, IO80211AWDLPeer *a2)
{
  IO80211AWDLPeer *v2; // r14@1
  int v3; // ebx@1
  unsigned __int8 *v4; // rax@3
  __int64 v5; // r15@3
  OSMetaClass *v6; // rax@4
  __int64 v7; // rax@4
  __mbuf *v8; // rsi@5
  __int64 result; // rax@5
  unsigned int v10; // er15@5
  OSMetaClass *v11; // rax@6
  __int64 v12; // rdx@6
  __int64 v13; // r9@6
  int v14; // ST20_4@6
  int v15; // ST18_4@6
  int v16; // ST10_4@6
  int v17; // ST08_4@6
  int v18; // ST00_4@6
  const char *v19; // rsi@6
  __int64 v20; // rcx@6
  __int64 v21; // r8@6
  OSMetaClass *v22; // rax@7
  __mbuf *v23; // [sp+30h] [bp-30h]@1
  int v24; // [sp+3Ch] [bp-24h]@1

  v2 = a2;
  v24 = 1;
  v23 = 0LL;
  v3 = mbuf_allocpacket(0LL, 512LL, &v24, &v23);
  if ( v3 || !v23 )
  {
    LODWORD(v22) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                     this,
                     512LL);
    v12 = OSMetaClass::getClassName(v22);
    v19 = "%s::%s cannot allocate mbuf size %u err %d\n";
    v20 = (__int64)"doNeighborMonitoring";
    v21 = 512LL;
    v13 = (unsigned int)v3;
    goto LABEL_8;
  }
  LODWORD(v4) = mbuf_data(v23);
  v5 = (unsigned int)IO80211AWDLPeerManager::buildMasterIndicationTemplate(this, v4, 0x200u, 1);
  mbuf_setlen(v23, v5);
  if ( IO80211PeerManager::shouldLog(this, 0x1000000LL) )
  {
    LODWORD(v6) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    0x1000000LL);
    v7 = OSMetaClass::getClassName(v6);
    IO80211PeerManager::logDebug(
      this,
      0x1000000LL,
      "%s::%s did build mi len %lu \n",
      v7,
      (__int64)"doNeighborMonitoring",
      v5);
  }
  v8 = v23;
  result = IO80211AWDLPeerManager::queueOOBFrame(this, v23, 0LL, v2);
  v10 = result;
  if ( (_DWORD)result )
  {
    LODWORD(v11) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __mbuf *))(*(_QWORD *)this + 56LL))(this, v8);
    v12 = OSMetaClass::getClassName(v11);
    v13 = *((_BYTE *)v2 + 32);
    v14 = *((_BYTE *)v2 + 37);
    v15 = *((_BYTE *)v2 + 36);
    v16 = *((_BYTE *)v2 + 35);
    v17 = *((_BYTE *)v2 + 34);
    v18 = *((_BYTE *)v2 + 33);
    v19 = "%s::%s couldn't queue OOB frame ret %d peer %02X:%02X:%02X:%02X:%02X:%02X\n";
    v20 = (__int64)"doNeighborMonitoring";
    v21 = v10;
LABEL_8:
    result = IO80211PeerManager::logDebug(this, v19, v12, v20, v21, v13);
  }
  return result;
}
// C8BE8: using guessed type int __fastcall mbuf_allocpacket(_QWORD, _QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8CB0: using guessed type int __fastcall mbuf_setlen(_QWORD, _QWORD);

//----- (000000000002C3EE) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::buildMasterIndicationTemplate(IO80211AWDLPeerManager *this, unsigned __int8 *a2, unsigned int a3, char a4)
{
  IO80211AWDLPeerManager *v4; // r15@1
  unsigned int v5; // er12@1
  __int64 v6; // r9@2
  bool v7; // al@4
  __int64 v8; // r13@4
  __int64 v9; // r9@5
  int v10; // er14@8
  __int64 v11; // r9@9
  __int64 v12; // r8@10
  __int64 v13; // r9@10
  int v14; // er12@11
  unsigned int v15; // ebx@11
  int v16; // ebx@16
  __int64 v17; // r13@19
  unsigned __int64 v18; // rax@19
  __int64 v19; // rax@19
  __int16 v20; // ax@19
  __int16 v21; // ax@19
  __int16 v22; // ax@19
  __int16 v23; // ax@19
  __int16 v24; // ax@19
  __int64 v25; // r8@20
  __int64 v26; // r9@20
  IO80211ServiceRequestDescriptor *v27; // rdi@23
  int v28; // eax@24
  int v29; // er12@24
  int v30; // er12@26
  __int64 v31; // rax@28
  __int64 v32; // r9@28
  IO80211CommandQueue *v33; // rdi@30
  int v35; // [sp+4h] [bp-6Ch]@4
  char v36; // [sp+8h] [bp-68h]@1
  unsigned int v37; // [sp+Ch] [bp-64h]@1
  __int64 v38; // [sp+10h] [bp-60h]@4
  __int64 v39; // [sp+18h] [bp-58h]@19
  __int64 v40; // [sp+20h] [bp-50h]@19
  __int64 v41; // [sp+28h] [bp-48h]@19
  __int64 v42; // [sp+30h] [bp-40h]@19
  __int64 v43; // [sp+38h] [bp-38h]@19
  int v44; // [sp+44h] [bp-2Ch]@19

  v36 = a4;
  v37 = a3;
  v4 = this;
  IO80211CommandQueue::lock(*((IO80211CommandQueue **)this + 476), 0LL, 0);
  v5 = IO80211AWDLPeerManager::buildServiceParamTlv((__int64)this, (__int64)a2);
  if ( IO80211PeerManager::shouldVerboseLog(this, 0x1000000LL) && IO80211PeerManager::shouldLog(this, 0x1000000LL) )
    IO80211PeerManager::logDebug(this, 0x1000000LL, "    -- added service params len %X -> %u \n", v5 - 3, v5, v6);
  v7 = *((_DWORD *)this + 26) != 0;
  a2[v5] = 12;
  v35 = IO80211AWDLPeerManager::buildDataPathStateTlv(this, &a2[v5 + 3], v7);
  *(_WORD *)&a2[v5 + 1] = v35;
  v8 = (__int64)a2;
  v38 = (unsigned __int16)v35 + v5 + 3;
  if ( IO80211PeerManager::shouldVerboseLog(this, 0x1000000LL) && IO80211PeerManager::shouldLog(this, 0x1000000LL) )
    IO80211PeerManager::logDebug(
      this,
      0x1000000LL,
      "    -- added data path state len %u -> %u \n",
      (unsigned int)(unsigned __int16)v35 + 3,
      v38,
      v9);
  if ( *((_DWORD *)this + 90) )
  {
    a2[(unsigned int)v38] = 7;
    memset(&a2[(unsigned int)v38 + 3], 0, 2uLL);
    memcpy(&a2[(unsigned int)v38 + 5], (char *)this + 334, *((_DWORD *)this + 90));
    v10 = *((_DWORD *)this + 90) + 2;
    *(_WORD *)(&a2[(unsigned __int16)v35 + 4] + v5) = *((_WORD *)this + 180) + 2;
    if ( IO80211PeerManager::shouldVerboseLog(this, 0x1000000LL) )
    {
      v38 = (unsigned int)v38 + (unsigned __int16)v10 + 3;
      if ( IO80211PeerManager::shouldLog(this, 0x1000000LL) )
      {
        IO80211PeerManager::logDebug(
          this,
          0x1000000LL,
          "    -- adding ht capabilities length %u+%u [",
          2LL,
          *((_DWORD *)this + 90),
          v11);
        if ( *((_DWORD *)this + 90) != -2 )
        {
          v14 = (unsigned __int16)v10 + (unsigned __int16)v35 + v5 + 9;
          v15 = 0;
          do
            IO80211PeerManager::logDebug(this, 0x1000000LL, "%02X ", *(&a2[v14] + v15++), v12, v13);
          while ( v15 < *((_DWORD *)this + 90) + 2 );
        }
        IO80211PeerManager::logDebug(this, 0x1000000LL, "] -> %u\n", v38, v12, v13);
      }
    }
    else
    {
      LODWORD(v38) = v38 + (unsigned __int16)v10 + 3;
    }
  }
  if ( *((_BYTE *)this + 378) )
  {
    a2[(unsigned int)v38] = 17;
    memcpy(&a2[(unsigned int)v38 + 3], (char *)this + 364, 0xEuLL);
    *(_WORD *)&a2[(unsigned int)(v38 + 1)] = 14;
    v16 = v38 + 17;
  }
  else
  {
    v16 = v38;
  }
  if ( *((_DWORD *)this + 1008) )
  {
    a2[v16] = 15;
    *(_WORD *)&a2[v16 + 1] = 15;
    a2[v16 + 3] = *((_BYTE *)this + 1440);
    v17 = *((_QWORD *)this + 936);
    v18 = getAbsoluteTime() - v17;
    v8 = (__int64)a2;
    *(_DWORD *)&a2[v16 + 4] = _byteswap_ulong(2361183241434822607LL * (v18 >> 3) >> 64 >> 4);
    v44 = 0;
    v19 = IO80211VirtualInterface::getIfnet(*((IO80211VirtualInterface **)this + 16));
    ifnet_get_sndq_len(v19, &v44);
    v20 = __ROL2__(v44, 8);
    *(_WORD *)&a2[v16 + 8] = v20;
    v43 = 0LL;
    v42 = 0LL;
    v41 = 0LL;
    v40 = 0LL;
    v39 = 0LL;
    IO80211CommandQueue::map(
      *((_QWORD *)this + 11),
      (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_packetStats,
      (__int64)this,
      (__int64)&v39,
      0LL,
      -1);
    v21 = __ROL2__(v39, 8);
    *(_WORD *)&a2[v16 + 10] = v21;
    v22 = __ROL2__(WORD2(v39), 8);
    *(_WORD *)&a2[v16 + 12] = v22;
    v23 = __ROL2__(v40, 8);
    *(_WORD *)&a2[v16 + 14] = v23;
    v24 = __ROL2__(WORD2(v40), 8);
    *(_WORD *)&a2[v16 + 16] = v24;
    v16 += 18;
    if ( IO80211PeerManager::shouldVerboseLog(this, 0x1000000LL) )
    {
      if ( IO80211PeerManager::shouldLog(this, 0x1000000LL) )
        IO80211PeerManager::logDebug(
          this,
          0x1000000LL,
          "    -- added debug live tlvs -> %u \n",
          (unsigned int)v16,
          v25,
          v26);
    }
  }
  if ( *((_DWORD *)this + 1009)
    && (v27 = (IO80211ServiceRequestDescriptor *)*((_QWORD *)this + 483)) != 0LL
    && (v28 = (unsigned __int64)IO80211ServiceRequestDescriptor::getDataLength(v27) + 4,
        v29 = (unsigned __int16)v28,
        (unsigned __int16)v28 >= 5u)
    && (unsigned __int16)v28 < v37 - v16 )
  {
    *(_BYTE *)(v8 + (unsigned int)v16) = 16;
    *(_WORD *)((unsigned int)(v16 + 1) + v8) = v28 - 3;
    *(_BYTE *)(v8 + (unsigned int)(v16 + 3)) = 3;
    IO80211ServiceRequestDescriptor::copyDataOnly(
      *((IO80211ServiceRequestDescriptor **)v4 + 483),
      (unsigned __int8 *)(v8 + (unsigned int)v16 + 4),
      v37 - v16 - 4);
    v30 = v16 + v29;
    if ( IO80211PeerManager::shouldVerboseLog(v4, 0x1000000LL) && IO80211PeerManager::shouldLog(v4, 0x1000000LL) )
    {
      v31 = IO80211ServiceRequestDescriptor::getDataLength(*((IO80211ServiceRequestDescriptor **)v4 + 483));
      IO80211PeerManager::logDebug(
        v4,
        0x1000000LL,
        "    -- added arpa ip6 tlv (dlen %u) -> %u \n",
        v31,
        (unsigned int)v30,
        v32);
    }
  }
  else
  {
    v30 = v16;
  }
  v33 = (IO80211CommandQueue *)*((_QWORD *)v4 + 476);
  if ( v33 && v36 && v30 < v37 )
  {
    v30 += IO80211AWDLPeerManager::buildServiceResponseTlvs(v4, v8, v8 + (unsigned int)v30, v37 - v30);
    v33 = (IO80211CommandQueue *)*((_QWORD *)v4 + 476);
  }
  IO80211CommandQueue::unlock(v33, 0LL);
  return (unsigned int)v30;
}
// C8B00: using guessed type int __fastcall ifnet_get_sndq_len(_QWORD, _QWORD);

//----- (000000000002C8C4) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::queueOOBFrame(IO80211AWDLPeerManager *this, __mbuf *a2, __int64 a3, IO80211AWDLPeer *a4)
{
  int v4; // er13@1
  __int64 v5; // r15@1
  __int64 v6; // r14@1
  signed int v7; // ebx@1
  IO80211AWDLPeer *v8; // rbx@2
  __int64 v9; // r12@2
  __int64 v10; // rdi@4
  signed int v11; // er13@7
  OSMetaClass *v12; // rax@8
  __int64 v13; // rax@8
  int v14; // ST00_4@8
  unsigned __int64 v15; // ST18_8@8
  OSMetaClass *v16; // rax@10
  __int64 v17; // rax@10
  __int64 v18; // r9@10
  OSMetaClass *v20; // rax@16
  __int64 v21; // rax@16
  int v22; // ST20_4@16
  int v23; // ST18_4@16
  int v24; // ST10_4@16
  int v25; // ST08_4@16
  int v26; // ST00_4@16

  v4 = a3;
  v5 = (__int64)a2;
  v6 = (__int64)this;
  v7 = 0;
  if ( !*(_DWORD *)(*((_QWORD *)this + 477) + 52LL) )
  {
    v8 = a4;
    v9 = OSObject::operator new((OSObject *)&stru_20.nsects, (unsigned __int64)a2);
    IO80211ActionFrameDescriptor::IO80211ActionFrameDescriptor(v9);
    if ( v9 )
    {
      if ( IO80211ActionFrameDescriptor::initWithAddr(
             (IO80211ActionFrameDescriptor *)v9,
             (ether_addr *)((char *)v8 + 32)) )
      {
        *(_BYTE *)(v9 + 52) = *((_BYTE *)this + 1532);
        *(_WORD *)(v9 + 54) = 0;
        *(_DWORD *)(v9 + 72) = v4;
        v10 = *(_QWORD *)(v9 + 32);
        if ( v10 )
          mbuf_freem(v10);
        *(_QWORD *)(v9 + 32) = a2;
        IO80211CommandQueue::map(
          *(_QWORD *)(v6 + 88),
          (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_nextServiceRequest,
          v6,
          v9,
          0LL,
          -1);
        if ( *(_DWORD *)(v9 + 48) >= 0 )
        {
          *(_BYTE *)(v9 + 64) = 0;
          v7 = 0;
          v11 = 28;
          if ( (signed int)IO80211CommandQueue::lockInsert(
                             *(IO80211CommandQueue **)(v6 + 3816),
                             (__int64)_compareDeadLine,
                             v9,
                             0LL,
                             0,
                             0LL) >= 0 )
          {
            getAbsoluteTime();
            LODWORD(v12) = (*(int (__fastcall **)(__int64, signed __int64 (__fastcall *)(__int64, __int64)))(*(_QWORD *)v6 + 56LL))(
                             v6,
                             _compareDeadLine);
            v13 = OSMetaClass::getClassName(v12);
            v14 = *(_DWORD *)(v9 + 48);
            v15 = (unsigned __int64)(19342813113834067LL * (unsigned __int128)(*(_QWORD *)(v9 + 40) >> 9) >> 64) >> 11;
            IO80211PeerManager::logDebug(
              (IO80211PeerManager *)v6,
              0x1000000000LL,
              "%s::%s Queued req num %u delay %u now %llu.%03llu absolute %llu.%03llu\n",
              v13,
              (__int64)"queueOOBFrame",
              *(_DWORD *)(*(_QWORD *)(v6 + 3816) + 52LL));
            IO80211AWDLPeerManager::updateServiceTimer((IO80211AWDLPeerManager *)v6);
            return (unsigned int)v7;
          }
LABEL_12:
          a2 = 0LL;
          IO80211ActionFrameDescriptor::freeResources((IO80211ActionFrameDescriptor *)v9, 0);
          (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v9 + 40LL))(v9, 0LL);
          v7 = v11;
          goto LABEL_13;
        }
        LODWORD(v20) = (*(int (__fastcall **)(__int64, signed __int64 (__fastcall *)(__int64, __int64, __int64)))(*(_QWORD *)v6 + 56LL))(
                         v6,
                         _nextServiceRequest);
        v21 = OSMetaClass::getClassName(v20);
        v22 = *((_BYTE *)v8 + 37);
        v23 = *((_BYTE *)v8 + 36);
        v24 = *((_BYTE *)v8 + 35);
        v25 = *((_BYTE *)v8 + 34);
        v26 = *((_BYTE *)v8 + 33);
        a2 = (__mbuf *)"%s::%s peer unreachable %d %02X:%02X:%02X:%02X:%02X:%02X\n";
        IO80211PeerManager::logDebug(
          (IO80211PeerManager *)v6,
          "%s::%s peer unreachable %d %02X:%02X:%02X:%02X:%02X:%02X\n",
          v21,
          (__int64)"queueOOBFrame",
          *(_DWORD *)(v9 + 48),
          *((_BYTE *)v8 + 32));
        v11 = 16;
LABEL_11:
        v7 = v11;
        if ( !v9 )
          goto LABEL_13;
        goto LABEL_12;
      }
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v9 + 40LL))(v9, (char *)v8 + 32);
    }
    LODWORD(v16) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
    v17 = OSMetaClass::getClassName(v16);
    a2 = (__mbuf *)"%s::%s can't allocate af descriptor mbuf %p \n";
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't allocate af descriptor mbuf %p \n",
      v17,
      (__int64)"queueOOBFrame",
      v5,
      v18);
    v11 = 12;
    goto LABEL_11;
  }
LABEL_13:
  if ( v5 )
    mbuf_freem_list(v5, a2, a3, a4);
  return (unsigned int)v7;
}
// 20: using guessed type segment_command_64 stru_20;
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);
// C8C28: using guessed type int __fastcall mbuf_freem_list(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002CB70) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::doPrimaryPeerMonitoring(IO80211AWDLPeerManager *this, IO80211AWDLPeer *a2)
{
  IO80211AWDLPeerManager *v2; // r14@1
  unsigned __int8 v3; // al@4
  IO80211VirtualInterface *v4; // rdi@6
  __int64 v5; // r15@8
  unsigned int v6; // eax@9
  OSMetaClass *v7; // rax@11
  __int64 v8; // rcx@11
  __int64 v9; // r9@11
  int v10; // ST18_4@13
  int v11; // ST10_4@13
  OSMetaClass *v12; // rax@15
  __int64 v13; // rax@15
  __int64 v14; // r8@15
  __int64 v15; // r9@15
  int v16; // [sp+28h] [bp-78h]@14
  int v17; // [sp+2Ch] [bp-74h]@14
  __int64 *v18; // [sp+30h] [bp-70h]@14
  __int64 v19; // [sp+40h] [bp-60h]@14
  __int64 v20; // [sp+48h] [bp-58h]@14
  __int64 v21; // [sp+50h] [bp-50h]@14
  __int64 v22; // [sp+58h] [bp-48h]@14
  __int64 v23; // [sp+60h] [bp-40h]@14
  __int64 v24; // [sp+68h] [bp-38h]@14
  IO80211AWDLPeerManager *v25; // [sp+70h] [bp-30h]@14

  v2 = this;
  if ( !(*((_BYTE *)a2 + 1278) & 2)
    && (*((_BYTE *)a2 + 1195) || (unsigned int)IO80211AWDLPeer::getInfraDataPacketsTxAttemps(a2) >= 2) )
  {
    v3 = *((_BYTE *)a2 + 1203);
    if ( v3 )
    {
      if ( v3 < 0xFu
        || (v4 = (IO80211VirtualInterface *)*((_QWORD *)this + 16)) != 0LL
        && IO80211VirtualInterface::dualBandCapable(v4) )
      {
        v5 = *((_QWORD *)a2 + 154);
        if ( (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v5)) >> 64) >> 18) >= 0x1389 )
        {
          v6 = IO80211AWDLPeerManager::buildMasterIndicationTemplate(v2, (unsigned __int8 *)v2 + 4128, 0x300u, 0);
          *((_DWORD *)v2 + 1224) = v6;
          if ( v6 )
          {
            *((_DWORD *)v2 + 1224) += IO80211AWDLPeer::buildAwdlInviteTLV(
                                        a2,
                                        (unsigned __int8 *)v2 + v6 + 4128,
                                        768 - v6,
                                        6u,
                                        3);
            if ( IO80211PeerManager::shouldLog(v2, 0x200000000LL) )
            {
              getAbsoluteTime();
              LODWORD(v7) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)v2 + 56LL))(
                              v2,
                              0x200000000LL);
              v8 = OSMetaClass::getClassName(v7);
              v9 = (__int64)"pmi";
              if ( *((_DWORD *)v2 + 372) == 1 )
                v9 = (__int64)"PMI";
              v10 = *((_BYTE *)a2 + 1203);
              v11 = *((_DWORD *)v2 + 1224);
              IO80211PeerManager::logDebug(
                v2,
                0x200000000LL,
                "%s::%s %s %llu.%03llu len=%u ch %u\n",
                v8,
                (__int64)"doPrimaryPeerMonitoring",
                v9);
            }
            v25 = 0LL;
            v24 = 0LL;
            v23 = 0LL;
            v22 = 0LL;
            v21 = 0LL;
            v20 = 0LL;
            LODWORD(v19) = 1;
            memset((char *)&v19 + 4, 255, 6uLL);
            v23 = *((_BYTE *)a2 + 1203);
            memcpy((char *)&v21 + 6, (char *)v2 + 3668, 6uLL);
            v25 = (IO80211AWDLPeerManager *)((char *)v2 + 4128);
            v24 = *((_WORD *)v2 + 2448);
            WORD2(v21) = 7;
            v17 = 149;
            v18 = &v19;
            v16 = -2144835128;
            if ( IO80211PeerManager::ioctl_internal(v2, (__int64)&v16) )
            {
              LODWORD(v12) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)v2 + 56LL))(v2, &v16);
              v13 = OSMetaClass::getClassName(v12);
              IO80211PeerManager::logDebug(
                v2,
                "%s::%s could not send Master Indication frame\n",
                v13,
                (__int64)"doPrimaryPeerMonitoring",
                v14,
                v15);
            }
            else
            {
              *((_QWORD *)a2 + 154) = getAbsoluteTime();
            }
          }
        }
      }
    }
  }
}

//----- (000000000002CE29) ----------------------------------------------------
__int64 __fastcall _sendOobFrame(__int64 a1, __int64 a2)
{
  __int64 result; // rax@1

  result = 0LL;
  if ( !*(_BYTE *)(a2 + 64) )
    result = (unsigned __int64)(*(_QWORD *)(a2 + 40) - getAbsoluteTime()) < 0x1E8480 ? 5 : 3;
  return result;
}

//----- (000000000002CE5C) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::updateAndSendMI(IO80211AWDLPeerManager *this, char a2)
{
  int v2; // eax@2
  unsigned int v3; // er12@3
  unsigned int v4; // er13@3
  OSMetaClass *v5; // rax@3
  __int64 v6; // r10@3
  __int64 v7; // r9@5
  int v8; // ST20_4@7
  int v9; // ST18_4@7
  int v10; // ST10_4@7
  int v11; // ST08_4@7
  int v12; // ST00_4@7
  int v13; // eax@10
  int v14; // ecx@10
  OSMetaClass *v15; // rax@13
  __int64 v16; // rdx@13
  __int64 v17; // r9@13
  __int64 v18; // r8@13
  int v19; // [sp+38h] [bp-78h]@10
  int v20; // [sp+3Ch] [bp-74h]@8
  __int64 *v21; // [sp+40h] [bp-70h]@10
  __int64 v22; // [sp+50h] [bp-60h]@7
  __int64 v23; // [sp+58h] [bp-58h]@7
  __int64 v24; // [sp+60h] [bp-50h]@7
  __int64 v25; // [sp+68h] [bp-48h]@7
  __int64 v26; // [sp+70h] [bp-40h]@7
  __int64 v27; // [sp+78h] [bp-38h]@7
  IO80211AWDLPeerManager *v28; // [sp+80h] [bp-30h]@7

  if ( *((_BYTE *)this + 7396) & 2 )
  {
    v2 = IO80211AWDLPeerManager::buildMasterIndicationTemplate(
           this,
           (unsigned __int8 *)this + 4128,
           0x300u,
           *((_DWORD *)this + 947) != 0);
    *((_DWORD *)this + 1224) = v2;
    if ( v2 )
    {
      v3 = *((_DWORD *)this + 361);
      v4 = *((_DWORD *)this + 362);
      LODWORD(v5) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, char *))(*(_QWORD *)this + 56LL))(
                      this,
                      (char *)this + 4128);
      v6 = OSMetaClass::getClassName(v5);
      if ( v3 <= v4 )
      {
        v7 = (__int64)"mi";
        if ( *((_DWORD *)this + 372) == 1 )
          v7 = (__int64)"MI";
        v8 = *((_DWORD *)this + 1849);
        v9 = *((_DWORD *)this + 1224);
        v10 = *((_DWORD *)this + 257);
        v11 = *((_DWORD *)this + 360);
        v12 = *((_DWORD *)this + 367);
        IO80211PeerManager::logDebug(
          this,
          0x1000000LL,
          "%s::%s %s sn=%u xid=%u avail %u size %u state %x sendNow %u\n",
          v6,
          (__int64)"updateAndSendMI",
          v7);
        ++*((_DWORD *)this + 361);
        v28 = 0LL;
        v27 = 0LL;
        v26 = 0LL;
        v25 = 0LL;
        v24 = 0LL;
        v23 = 0LL;
        LODWORD(v22) = 1;
        memset((char *)&v22 + 4, 255, 6uLL);
        memcpy((char *)&v24 + 6, (char *)this + 3668, 6uLL);
        v28 = (IO80211AWDLPeerManager *)((char *)this + 4128);
        v27 = *((_WORD *)this + 2448);
        WORD2(v24) = 6;
        if ( a2 )
        {
          v20 = 149;
        }
        else
        {
          v20 = 225;
          LODWORD(v24) = *((_DWORD *)this + 1882);
          HIDWORD(v23) = 100 * (unsigned __int8)random() + 5000;
          IO80211PeerManager::logDebug(
            this,
            0x1000000LL,
            "Sending MI template size %u; bitmap 0x%X at offset %uus \n",
            *((_DWORD *)this + 1224),
            (unsigned int)v24,
            HIDWORD(v23));
        }
        v21 = &v22;
        v19 = -2144835128;
        v13 = IO80211PeerManager::ioctl_internal(this, (__int64)&v19);
        v14 = *((_DWORD *)this + 361);
        if ( v14 )
          *((_DWORD *)this + 361) = v14 - 1;
        if ( v13 )
        {
          LODWORD(v15) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v19);
          v16 = OSMetaClass::getClassName(v15);
          v18 = (__int64)"template to fw";
          if ( a2 )
            v18 = (__int64)"now";
          IO80211PeerManager::logDebug(
            this,
            "%s::%s could not send Master Indication frame %s \n",
            v16,
            (__int64)"updateAndSendMI",
            v18,
            v17);
        }
      }
      else
      {
        IO80211PeerManager::logDebug(
          this,
          0x1000000LL,
          "%s::%s couldn't send: num outstanding %u max %u\n",
          v6,
          (__int64)"updateAndSendMI",
          *((_DWORD *)this + 361));
      }
    }
  }
}

//----- (000000000002D0DD) ----------------------------------------------------
signed __int64 __fastcall _nextServiceRequest(__int64 a1, __int64 a2, __int64 a3)
{
  IO80211ActionFrameDescriptor *v3; // r14@1
  signed __int64 result; // rax@1
  int v5; // ecx@2

  v3 = (IO80211ActionFrameDescriptor *)a3;
  result = 1LL;
  if ( a2 )
  {
    v5 = memcmp((const void *)(a2 + 32), (const void *)(a3 + 76), 6uLL);
    result = 0LL;
    if ( !v5 )
    {
      IO80211AWDLPeer::nextServiceRequest((IO80211AWDLPeer *)a2, v3);
      result = 3LL;
    }
  }
  return result;
}

//----- (000000000002D128) ----------------------------------------------------
signed __int64 __fastcall _compareDeadLine(__int64 a1, __int64 a2)
{
  unsigned __int64 v2; // rcx@1
  unsigned __int64 v3; // rdx@1
  signed __int64 result; // rax@1

  v2 = *(_QWORD *)(a1 + 40);
  v3 = *(_QWORD *)(a2 + 40);
  result = 1LL;
  if ( v2 >= v3 )
  {
    result = 0xFFFFFFFFLL;
    if ( v2 == v3 )
      result = 0LL;
  }
  return result;
}

//----- (000000000002D14E) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::doOOBInvite(IO80211AWDLPeerManager *this, ether_addr *a2)
{
  return 0LL;
}

//----- (000000000002D156) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::inputPacket(IO80211PeerManager *this, __int64 a2)
{
  __int64 v2; // rax@1
  __int64 v3; // r13@1
  ether_addr *v4; // r12@2
  OSMetaClass *v5; // rax@4
  __int64 v6; // ST48_8@4
  unsigned int v7; // ST54_4@4
  int v8; // ST44_4@4
  int v9; // ST40_4@4
  int v10; // ST3C_4@4
  int v11; // ST38_4@4
  __int64 v12; // r13@4
  int v13; // ST28_4@4

  LODWORD(v2) = mbuf_data(*(_QWORD *)a2);
  v3 = v2;
  if ( *((_BYTE *)this + 7572) )
  {
    v4 = (ether_addr *)(v2 + 6);
    if ( !(*(_BYTE *)(v2 + 6) & 1) && !IO80211PeerManager::findPeer(this, (unsigned __int8 *)(v2 + 6), 0) )
    {
      LODWORD(v5) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, v3 + 6);
      v6 = OSMetaClass::getClassName(v5);
      v7 = *(_BYTE *)(v3 + 6);
      v8 = *(_BYTE *)(v3 + 7);
      v9 = *(_BYTE *)(v3 + 8);
      v10 = *(_BYTE *)(v3 + 9);
      v11 = *(_BYTE *)(v3 + 10);
      v12 = *(_BYTE *)(v3 + 11);
      v13 = (unsigned __int8)IO80211PeerManager::getHashTableIndex(this, v4);
      IO80211PeerManager::logDebug(
        this,
        0x200000000LL,
        "%s::%s: adding peer on demand [%02X:%02X:%02X:%02X:%02X:%02X] at hash %u\n",
        v6,
        (__int64)"inputPacket",
        v7);
      (*(void (__fastcall **)(IO80211PeerManager *, ether_addr *))(*(_QWORD *)this + 440LL))(this, v4);
    }
  }
  JUMPOUT(__CS__, `vtable for'IO80211PeerManager[50]);
}
// 7D5B0: using guessed type __int64 `vtable for'IO80211PeerManager[2];
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);

//----- (000000000002D27E) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::outputStart(IO80211AWDLPeerManager *this)
{
  if ( !(*((_BYTE *)this + 7396) & 8) )
    JUMPOUT(__CS__, `vtable for'IO80211PeerManager[61]);
  *((_BYTE *)this + 216) = 1;
  return 0LL;
}
// 7D5B0: using guessed type __int64 `vtable for'IO80211PeerManager[2];

//----- (000000000002D2A4) ----------------------------------------------------
int __fastcall IO80211AWDLPeerManager::outputPacket(IO80211AWDLPeerManager *this, __mbuf *a2)
{
  __int64 v2; // rax@1
  __int64 v3; // r15@1
  int v4; // eax@2
  int v5; // eax@22
  int v6; // eax@30
  __int64 v7; // rax@48
  IO80211AWDLPeer *v8; // r12@48
  int v9; // eax@51
  int result; // eax@55
  __mbuf *v11; // r14@57
  OSMetaClass *v12; // rax@60
  __int64 v13; // rax@60
  int v14; // ST18_4@60
  int v15; // ST10_4@60
  int v16; // ST08_4@60
  int v17; // ST00_4@60
  __mbuf *v18; // r14@66
  IO80211Controller *v19; // rax@67
  char v20; // [sp+20h] [bp-80h]@22
  int v21; // [sp+24h] [bp-7Ch]@22
  int v22; // [sp+28h] [bp-78h]@22
  __mbuf *v23; // [sp+30h] [bp-70h]@22
  int v24; // [sp+38h] [bp-68h]@22
  int v25; // [sp+3Ch] [bp-64h]@22
  __int64 v26; // [sp+40h] [bp-60h]@22
  __int64 v27; // [sp+48h] [bp-58h]@22
  __int64 v28; // [sp+50h] [bp-50h]@22
  __int64 v29; // [sp+58h] [bp-48h]@22
  __int64 v30; // [sp+60h] [bp-40h]@22
  __int64 v31; // [sp+68h] [bp-38h]@22
  __int64 v32; // [sp+70h] [bp-30h]@22
  __int64 v33; // [sp+78h] [bp-28h]@22

  LODWORD(v2) = mbuf_data(a2);
  v3 = v2;
  if ( !*((_BYTE *)this + 652) )
    goto LABEL_54;
  v4 = *(_BYTE *)v2;
  if ( !*((_DWORD *)this + 123) )
  {
    if ( v4 != 51 )
      goto LABEL_21;
    goto LABEL_15;
  }
  if ( v4 != 51 )
    goto LABEL_21;
  if ( *(_BYTE *)(v3 + 1) == 51
    && (!*(_BYTE *)(v3 + 2) && !*(_BYTE *)(v3 + 3) && !*(_BYTE *)(v3 + 4) && *(_BYTE *)(v3 + 5) == 251
     || *(_BYTE *)(v3 + 2) == 128 && !*(_BYTE *)(v3 + 3) && !*(_BYTE *)(v3 + 4) && *(_BYTE *)(v3 + 5) == 251) )
  {
LABEL_54:
    mbuf_freem(a2);
    return 0;
  }
LABEL_15:
  if ( *(_BYTE *)(v3 + 1) == 51
    && !*(_BYTE *)(v3 + 2)
    && !*(_BYTE *)(v3 + 3)
    && !*(_BYTE *)(v3 + 4)
    && *(_BYTE *)(v3 + 5) == 251 )
    *(_BYTE *)(v3 + 2) = -128;
LABEL_21:
  if ( IO80211PeerManager::shouldLog(this, 0x200000000000LL) )
  {
    v20 = 1;
    v21 = 0;
    v22 = 0;
    v23 = a2;
    v24 = 0;
    v25 = 0;
    v33 = 0LL;
    v32 = 0LL;
    v31 = 0LL;
    v30 = 0LL;
    v29 = 0LL;
    v28 = 0LL;
    v27 = 0LL;
    v26 = 0LL;
    v5 = 0;
    if ( this )
    {
      if ( IO80211PeerManager::shouldVerboseLog(this, 0x200000000000LL) )
      {
        v5 = *((_DWORD *)this + 108);
      }
      else
      {
        v5 = *((_DWORD *)this + 106);
        if ( !*((_DWORD *)this + 106) )
          v5 = getLengthBeforeSensitivePayload(0, v23);
      }
    }
    v21 = v5;
    IO80211PeerManager::dumpPacket((__int64)this, 0x200000000000LL, "Net-awdl", (__int64)&v20);
  }
  if ( *((_DWORD *)this + 996) )
  {
    if ( !*((_DWORD *)this + 992) )
    {
      v6 = *((_DWORD *)this + 1849);
      if ( v6 & 0xC )
      {
        if ( !(v6 & 8) )
        {
          if ( !(*(_BYTE *)v3 & 1) )
            IO80211AWDLPeerManager::setAlwaysAvailable(this, 0);
          IO80211AWDLPeerManager::exitQuietMode(this);
          if ( !(*((_BYTE *)this + 7396) & 2) )
            goto LABEL_54;
        }
      }
    }
  }
  if ( !(*((_BYTE *)this + 7396) & 2)
    && (*(_BYTE *)v3 != 51
     || *(_BYTE *)(v3 + 1) != 51
     || *(_BYTE *)(v3 + 2) != 128
     || *(_BYTE *)(v3 + 3)
     || *(_BYTE *)(v3 + 4)
     || *(_BYTE *)(v3 + 5) != 251) )
    goto LABEL_54;
  if ( !*((_DWORD *)this + 1016) )
    mbuf_set_traffic_class(a2, 0LL);
  if ( *(_BYTE *)v3 & 1 )
    mbuf_set_traffic_class(a2, 0LL);
  IO80211PeerManager::lockDataPath(this);
  if ( !*((_DWORD *)this + 1883)
    || *(_BYTE *)v3 & 1
    || (v7 = IO80211PeerManager::findPeer(this, (unsigned __int8 *)v3, 1), (v8 = (IO80211AWDLPeer *)v7) == 0LL)
    || *(_BYTE *)(v7 + 1194) != 2 )
  {
    v11 = IO80211AWDLPeerManager::addAwdlSnapHeader(this, a2, 0);
    IO80211PeerManager::unlockDataPath(this, (__int64)a2);
    result = -536870211;
    if ( !v11 )
      return result;
    if ( !(*(_BYTE *)v3 & 1) && !IO80211PeerManager::findPeer(this, (unsigned __int8 *)v3, 0) )
    {
      LODWORD(v12) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64))(*(_QWORD *)this + 56LL))(this, v3);
      v13 = OSMetaClass::getClassName(v12);
      v14 = *(_BYTE *)(v3 + 5);
      v15 = *(_BYTE *)(v3 + 4);
      v16 = *(_BYTE *)(v3 + 3);
      v17 = *(_BYTE *)(v3 + 2);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s: addding peer on demand [%02X:%02X:%02X:%02X:%02X:%02X]\n",
        v13,
        (__int64)"outputPacket",
        *(_BYTE *)v3,
        *(_BYTE *)(v3 + 1));
      (*(void (__fastcall **)(IO80211AWDLPeerManager *, __int64))(*(_QWORD *)this + 440LL))(this, v3);
    }
    result = ((int (__fastcall *)(IO80211AWDLPeerManager *, __mbuf *))`vtable for'IO80211PeerManager[60])(this, v11);
    if ( result )
      return result;
    IO80211AWDLPeerManager::didQueuePacket(this, (unsigned __int8 *)v3);
    return 0;
  }
  if ( IO80211PeerManager::shouldLog(this, 2560LL) )
  {
    v20 = 1;
    v21 = 0;
    v22 = 0;
    v23 = a2;
    v24 = 0;
    v25 = 0;
    v33 = 0LL;
    v32 = 0LL;
    v31 = 0LL;
    v30 = 0LL;
    v29 = 0LL;
    v28 = 0LL;
    v27 = 0LL;
    v26 = 0LL;
    v9 = 0;
    if ( this )
    {
      if ( IO80211PeerManager::shouldVerboseLog(this, 2048LL) )
      {
        v9 = *((_DWORD *)this + 108);
      }
      else
      {
        v9 = *((_DWORD *)this + 106);
        if ( !*((_DWORD *)this + 106) )
          v9 = getLengthBeforeSensitivePayload(0, v23);
      }
    }
    v21 = v9;
    IO80211PeerManager::dumpPacket((__int64)this, 2560LL, " Txri ", (__int64)&v20);
  }
  v18 = IO80211AWDLPeerManager::addRedirectSnapHeader(this, a2, v8);
  IO80211PeerManager::unlockDataPath(this, (__int64)a2);
  result = -536870211;
  if ( v18 )
  {
    v19 = (IO80211Controller *)IO80211PeerManager::getController(this);
    IO80211Controller::awdlSendInfraPacket(v19, v18);
    return 0;
  }
  return result;
}
// 7D5B0: using guessed type __int64 `vtable for'IO80211PeerManager[2];
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);
// C8C98: using guessed type int __fastcall mbuf_set_traffic_class(_QWORD, _QWORD);

//----- (000000000002D75A) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::exitQuietMode(IO80211AWDLPeerManager *this)
{
  int v1; // eax@1
  signed int v2; // er14@1
  OSMetaClass *v3; // rax@3
  __int64 v4; // rax@3
  __int64 v5; // r9@3
  int v6; // er15@3
  OSMetaClass *v7; // rax@4
  __int64 v8; // rax@4
  __int64 v9; // r9@4
  unsigned int v10; // er15@5
  unsigned int v11; // er12@5
  __int64 v12; // r13@5
  int v13; // ST00_4@5
  __int64 v15; // [sp+10h] [bp-50h]@3
  int v16; // [sp+18h] [bp-48h]@3
  int v17; // [sp+20h] [bp-40h]@3
  int v18; // [sp+24h] [bp-3Ch]@3
  __int64 *v19; // [sp+28h] [bp-38h]@3

  v1 = *((_DWORD *)this + 1849);
  v2 = 6;
  if ( v1 & 1 )
  {
    *((_DWORD *)this + 1849) = v1 & 0xFFFFFFF7;
    v2 = 0;
    if ( v1 & 4 )
    {
      bzero(&v17, 0x18uLL);
      LODWORD(v3) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                      this,
                      24LL);
      v4 = OSMetaClass::getClassName(v3);
      v2 = 0;
      IO80211PeerManager::logDebug(
        this,
        137975824384LL,
        "%s::%s Exiting quiet mode\n",
        v4,
        (__int64)"exitQuietMode",
        v5);
      v15 = 1LL;
      v18 = 117;
      v17 = -2144835128;
      v19 = &v15;
      v16 = 1;
      v6 = IO80211PeerManager::ioctl_internal(this, (__int64)&v17);
      if ( v6 )
      {
        LODWORD(v7) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v17);
        v8 = OSMetaClass::getClassName(v7);
        IO80211PeerManager::logDebug(
          this,
          "%s::%s can't enable sync.  Quiet mode exit failed. Error=%d\n",
          v8,
          (__int64)"exitQuietMode",
          (unsigned int)v6,
          v9);
        v2 = v6;
      }
      else
      {
        memset((char *)this + 7448, 0, 0x18uLL);
        v10 = *((_DWORD *)this + 932);
        v11 = *((_DWORD *)this + 1850);
        v12 = *((_QWORD *)this + 492);
        v13 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v12)) >> 64) >> 18;
        IO80211PeerManager::logDebug(this, 0x800000LL, "%d: met %x   flags %x _lastTimeSince %u\n", 6889LL, v10, v11);
        IO80211AWDLPeerManager::updateAndSendMI(this, 0);
        *((_QWORD *)this + 493) = getAbsoluteTime();
        *((_DWORD *)this + 1849) = *((_DWORD *)this + 1849) & 0xFFFFFFF9 | 2;
      }
    }
  }
  return (unsigned int)v2;
}

//----- (000000000002D8F0) ----------------------------------------------------
__mbuf *__fastcall IO80211AWDLPeerManager::addRedirectSnapHeader(IO80211AWDLPeerManager *this, __mbuf *a2, IO80211AWDLPeer *a3)
{
  __mbuf *v3; // rbx@1
  __int64 v4; // r12@1
  __int64 v5; // rax@4
  __int64 v6; // rax@7
  __mbuf *v7; // rax@7
  OSMetaClass *v8; // rax@9
  __int64 v9; // rax@9
  __mbuf *v10; // rbx@9
  __int64 v11; // r9@9
  void *v12; // rax@12
  void *v13; // rbx@12
  __int64 v14; // rax@12
  __mbuf *v15; // rax@13
  __mbuf *v16; // rbx@13
  OSMetaClass *v17; // rax@14
  __int64 v18; // rax@14
  __int64 v19; // r9@14
  __mbuf *v20; // rbx@16
  __int64 v21; // rax@16
  int v22; // eax@17
  int v24; // [sp+4h] [bp-ACh]@12
  IO80211AWDLPeer *v25; // [sp+8h] [bp-A8h]@1
  char v26; // [sp+10h] [bp-A0h]@6
  int v27; // [sp+14h] [bp-9Ch]@6
  int v28; // [sp+18h] [bp-98h]@6
  __mbuf *v29; // [sp+20h] [bp-90h]@6
  int v30; // [sp+28h] [bp-88h]@6
  int v31; // [sp+2Ch] [bp-84h]@6
  __int64 v32; // [sp+30h] [bp-80h]@6
  __int64 v33; // [sp+38h] [bp-78h]@6
  __int64 v34; // [sp+40h] [bp-70h]@6
  __int64 v35; // [sp+48h] [bp-68h]@6
  __int64 v36; // [sp+50h] [bp-60h]@6
  __int64 v37; // [sp+58h] [bp-58h]@6
  __int64 v38; // [sp+60h] [bp-50h]@6
  __int64 v39; // [sp+68h] [bp-48h]@6
  int v40; // [sp+74h] [bp-3Ch]@1
  __mbuf *v41; // [sp+78h] [bp-38h]@1
  __mbuf *v42; // [sp+80h] [bp-30h]@1

  v25 = a3;
  v3 = a2;
  v42 = a2;
  v41 = 0LL;
  v40 = 1;
  mbuf_data(a2);
  LODWORD(v4) = mbuf_pkthdr_len(a2);
  if ( !(_DWORD)v4 )
  {
    LODWORD(v4) = 0;
    if ( a2 )
    {
      LODWORD(v4) = 0;
      do
      {
        LODWORD(v5) = mbuf_len(v3);
        if ( !v5 && *((_DWORD *)this + 119) )
        {
          v26 = 1;
          v27 = 80;
          v28 = 0;
          v29 = v42;
          v30 = 0;
          v31 = 0;
          v39 = 0LL;
          v38 = 0LL;
          v37 = 0LL;
          v36 = 0LL;
          v35 = 0LL;
          v34 = 0LL;
          v33 = 0LL;
          v32 = 0LL;
          a2 = (__mbuf *)"tx null";
          IO80211PeerManager::dumpPacket((__int64)this, (signed __int64)"tx null", (__int64)&v26);
        }
        LODWORD(v6) = mbuf_len(v3);
        v4 = v6 + ((unsigned int)v4 & 0xFFFFFFFF);
        LODWORD(v7) = mbuf_next(v3, a2);
        v3 = v7;
      }
      while ( v7 );
    }
  }
  if ( mbuf_pullup(&v42, 12LL) )
  {
    LODWORD(v8) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, 12LL);
    v9 = OSMetaClass::getClassName(v8);
    v10 = 0LL;
    IO80211PeerManager::logDebug(
      this,
      "%s::%s cannot pullup %u bytes !!\n",
      v9,
      (__int64)"addRedirectSnapHeader",
      14LL,
      v11);
  }
  else if ( mbuf_allocpacket(0LL, 128LL, &v40, &v41) || !v41 )
  {
    LODWORD(v17) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                     this,
                     128LL);
    v18 = OSMetaClass::getClassName(v17);
    v10 = 0LL;
    IO80211PeerManager::logDebug(
      this,
      "%s::%s cannot allocate llc mbuf size %u\n",
      v18,
      (__int64)"addRedirectSnapHeader",
      128LL,
      v19);
    mbuf_freem(v42);
  }
  else
  {
    v24 = mbuf_get_traffic_class(v42);
    mbuf_set_traffic_class(v41, (unsigned int)v24);
    mbuf_data(v42);
    LODWORD(v12) = mbuf_data(v41);
    v13 = v12;
    memcpy(v12, (char *)v25 + 1210, 6uLL);
    memcpy((char *)v13 + 6, (char *)this + 118, 6uLL);
    *(_QWORD *)((char *)v13 + 12) = 578978732723604873LL;
    *((_WORD *)v13 + 10) = *((_WORD *)v25 + 2 * (unsigned int)v24 + 206) & 0x3FF;
    LODWORD(v14) = mbuf_len(v42);
    if ( v14 == 12 )
    {
      LODWORD(v15) = mbuf_next(v42, (char *)this + 118);
      v16 = v15;
      mbuf_setnext(v42, 0LL);
      mbuf_free(v42, 0LL);
      v42 = v16;
    }
    else
    {
      mbuf_adj(v42, 12LL);
    }
    mbuf_setlen(v41, 22LL);
    mbuf_setnext(v41, v42);
    v20 = v41;
    LODWORD(v21) = mbuf_data(v41);
    mbuf_pkthdr_setheader(v20, v21);
    mbuf_pkthdr_setlen(v41, ((_DWORD)v4 + 12) & 0xFFFFFFFF);
    ++*((_DWORD *)v25 + (unsigned int)v24 + 414);
    v26 = 1;
    v27 = 64;
    v28 = 0;
    v29 = v41;
    v30 = 0;
    v31 = 0;
    v39 = 0LL;
    v38 = 0LL;
    v37 = 0LL;
    v36 = 0LL;
    v35 = 0LL;
    v34 = 0LL;
    v33 = 0LL;
    v32 = 0LL;
    if ( (unsigned int)getLengthBeforeSensitivePayload(0, v41) < 0x41 )
      v22 = getLengthBeforeSensitivePayload(0, v29);
    else
      v22 = v27;
    v27 = v22;
    IO80211PeerManager::dumpPacket((__int64)this, (signed __int64)" Te ", (__int64)&v26);
    v10 = v41;
  }
  return v10;
}
// C8BE0: using guessed type int __fastcall mbuf_adj(_QWORD, _QWORD);
// C8BE8: using guessed type int __fastcall mbuf_allocpacket(_QWORD, _QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C18: using guessed type int __fastcall mbuf_free(_QWORD, _QWORD);
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);
// C8C30: using guessed type int __fastcall mbuf_get_traffic_class(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C58: using guessed type int __fastcall mbuf_next(_QWORD, _QWORD);
// C8C68: using guessed type int __fastcall mbuf_pkthdr_len(_QWORD);
// C8C78: using guessed type int __fastcall mbuf_pkthdr_setheader(_QWORD, _QWORD);
// C8C80: using guessed type int __fastcall mbuf_pkthdr_setlen(_QWORD, _QWORD);
// C8C90: using guessed type int __fastcall mbuf_pullup(_QWORD, _QWORD);
// C8C98: using guessed type int __fastcall mbuf_set_traffic_class(_QWORD, _QWORD);
// C8CB0: using guessed type int __fastcall mbuf_setlen(_QWORD, _QWORD);
// C8CB8: using guessed type int __fastcall mbuf_setnext(_QWORD, _QWORD);

//----- (000000000002DCCE) ----------------------------------------------------
char __fastcall IO80211AWDLPeerManager::didQueuePacket(IO80211AWDLPeerManager *this, unsigned __int8 *a2)
{
  IO80211AWDLPeerManager *v2; // rbx@1
  OSMetaClass *v3; // rax@5
  __int64 v4; // rax@5
  IO80211VirtualInterface *v5; // rdi@5
  __int64 v6; // rax@6
  __int64 v7; // r12@8
  __int64 v8; // r13@8
  int v9; // ST38_4@8
  int v10; // ST30_4@8
  int v11; // ST28_4@8
  int v12; // ST20_4@8
  int v13; // ST08_4@8
  int v14; // ST00_4@8
  char result; // al@12
  OSMetaClass *v16; // rax@13
  __int64 v17; // rax@13
  __int64 v18; // r12@13
  IO80211VirtualInterface *v19; // rdi@13
  __int64 v20; // rax@14
  int v21; // ST40_4@16
  int v22; // ST38_4@16
  int v23; // ST30_4@16
  int v24; // ST28_4@16
  int v25; // ST20_4@16
  int v26; // ST18_4@16
  int v27; // ST10_4@16
  int v28; // ST08_4@16
  int v29; // ST00_4@16
  __int64 v30; // [sp+78h] [bp-58h]@5
  __int64 v31; // [sp+80h] [bp-50h]@1
  __int64 v32; // [sp+88h] [bp-48h]@1
  __int64 v33; // [sp+90h] [bp-40h]@1
  __int64 v34; // [sp+98h] [bp-38h]@1
  __int64 v35; // [sp+A0h] [bp-30h]@1

  v2 = this;
  v35 = 0LL;
  v34 = 0LL;
  v33 = 0LL;
  v32 = 0LL;
  v31 = 0LL;
  if ( *((_DWORD *)this + 1244) == 1 && *((_DWORD *)this + 1238) == 1 && !(*a2 & 1) )
  {
    IO80211CommandQueue::map(
      *((_QWORD *)this + 11),
      (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_packetStats,
      (__int64)this,
      (__int64)&v31,
      0LL,
      -1);
    if ( *((_DWORD *)this + 120) )
    {
      LODWORD(v3) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64 (__fastcall *)(__int64, __int64, __int64)))(*(_QWORD *)this + 56LL))(
                      this,
                      _packetStats);
      v4 = OSMetaClass::getClassName(v3);
      v30 = v4;
      v5 = (IO80211VirtualInterface *)*((_QWORD *)this + 16);
      if ( v5 )
        v6 = (__int64)IO80211VirtualInterface::getBSDName(v5);
      else
        v6 = (__int64)IO80211Interface::getBSDName(*((IO80211Interface **)v2 + 17), v4);
      v7 = a2[3];
      v8 = a2[4];
      v9 = *((_BYTE *)v2 + 1512);
      v10 = *((_DWORD *)v2 + 360);
      v11 = *((_DWORD *)v2 + 258);
      v12 = a2[5];
      v13 = a2[2];
      v14 = a2[1];
      IO80211PeerManager::logDebug(
        v2,
        "%s::%s didQ<%s>  [%02X:%02X:%02X:%02X:%02X:%02X] txAv %u eid %u pm %u [%u %u %u %u]\n",
        v30,
        (__int64)"didQueuePacket",
        v6,
        *a2);
    }
    if ( (unsigned int)(v32 + HIDWORD(v32)) >= *((_DWORD *)v2 + 1242)
      || (unsigned int)(v31 + HIDWORD(v31)) >= *((_DWORD *)v2 + 1241) )
      IO80211AWDLPeerManager::setAlwaysAvailable(v2, 0);
  }
  *((_QWORD *)v2 + 934) = getAbsoluteTime();
  result = IO80211PeerManager::shouldLog(v2, 0x400000000LL);
  if ( result )
  {
    LODWORD(v16) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)v2 + 56LL))(
                     v2,
                     0x400000000LL);
    v17 = OSMetaClass::getClassName(v16);
    v18 = v17;
    v19 = (IO80211VirtualInterface *)*((_QWORD *)v2 + 16);
    if ( v19 )
      v20 = (__int64)IO80211VirtualInterface::getBSDName(v19);
    else
      v20 = (__int64)IO80211Interface::getBSDName(*((IO80211Interface **)v2 + 17), v17);
    v21 = *((_BYTE *)v2 + 1512);
    v22 = *((_DWORD *)v2 + 360);
    v23 = *((_DWORD *)v2 + 258);
    v24 = a2[5];
    v25 = a2[4];
    v26 = a2[3];
    v27 = a2[2];
    v28 = a2[1];
    v29 = *a2;
    result = IO80211PeerManager::logDebug(
               v2,
               0x400000000LL,
               "%s::%s didQ <%s> [%02X:%02X:%02X:%02X:%02X:%02X] txAv %u eid %u pm %u\n",
               v18,
               (__int64)"didQueuePacket",
               v20);
  }
  return result;
}

//----- (000000000002DF40) ----------------------------------------------------
bool __fastcall IO80211AWDLPeerManager::isBrowsingFor(IO80211AWDLPeerManager *this, unsigned __int8 *a2, __int16 a3)
{
  bool result; // al@1
  unsigned __int8 *v4; // [sp+0h] [bp-10h]@2
  __int16 v5; // [sp+8h] [bp-8h]@2

  result = 1;
  if ( !*((_DWORD *)this + 949) )
  {
    v4 = a2;
    v5 = a3;
    result = IO80211CommandQueue::lockMap(
               *((IO80211CommandQueue **)this + 476),
               (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_is_browsing_for,
               (__int64)this,
               (__int64)&v4,
               0LL,
               -1) != 0;
  }
  return result;
}

//----- (000000000002DF8E) ----------------------------------------------------
__int64 __fastcall _is_browsing_for(__int64 a1, IO80211ServiceRequestDescriptor *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  return (unsigned int)IO80211ServiceRequestDescriptor::isBrowseFor(
                         a2,
                         *(unsigned __int8 **)a3,
                         *(_BYTE *)(a3 + 8),
                         a4,
                         a5,
                         a6) == 0;
}

//----- (000000000002DFAE) ----------------------------------------------------
__int64 __usercall IO80211AWDLPeerManager::dequeueTxPacket@<rax>(IO80211PeerManager *this@<rdi>, __int64 a2@<rsi>, unsigned __int64 a3@<r15>)
{
  __int64 v3; // rbx@1
  signed __int64 v4; // rax@1
  __int64 v5; // rsi@3
  __int64 v6; // r13@13
  unsigned __int64 v7; // r15@14
  __int64 v8; // rax@14
  int v9; // STA4_4@14
  int v10; // STA0_4@14
  int v11; // ST9C_4@14
  int v12; // ST98_4@14
  int v13; // ST94_4@14
  int v14; // er8@14
  int v15; // er9@14
  __int64 v16; // rax@14
  int v17; // er13@15
  __int64 v18; // r15@16
  int v19; // er10@16
  int v20; // er11@16
  bool v21; // al@17
  int v22; // ST80_4@18
  int v23; // ST60_4@18
  __int64 v24; // rdi@19
  __int64 v25; // rax@22
  __int64 v27; // [sp+B0h] [bp-40h]@14
  __int64 v28; // [sp+B8h] [bp-38h]@14
  int v29; // [sp+C4h] [bp-2Ch]@10

  v3 = a2;
  v4 = 3LL;
  do
    *(_QWORD *)(a2 + 8 * v4++) = 0LL;
  while ( v4 != 7 );
  IO80211PeerManager::lockDataPath(this);
  v5 = 0x400000000LL;
  if ( IO80211PeerManager::shouldLog(this, 0x400000000LL) )
    a3 = getAbsoluteTime();
  if ( !*((_DWORD *)this + 258) )
  {
    if ( *((_DWORD *)this + 1244) != 4 && *((_BYTE *)this + 1512) )
    {
      *(_WORD *)(v3 + 88) = 0;
      v29 = 0;
      goto LABEL_13;
    }
    goto LABEL_11;
  }
  if ( *((_DWORD *)this + 360) >= 8u )
LABEL_11:
    *(_WORD *)(v3 + 6) = 0;
  IO80211PeerManager::unlockDataPath(this, 0x400000000LL);
  v5 = v3;
  v29 = ((int (__fastcall *)(IO80211PeerManager *, __int64))`vtable for'IO80211PeerManager[64])(this, v3);
  IO80211PeerManager::lockDataPath(this);
LABEL_13:
  IO80211PeerManager::unlockDataPath(this, v5);
  v6 = 0LL;
  if ( IO80211PeerManager::shouldLog(this, 0x400000000LL) )
  {
    getAbsoluteTime();
    v28 = 19342813113834067LL * (a3 >> 9) >> 64 >> 11;
    v7 = 4835703278458516699LL * (a3 - 1000000000 * v28) >> 64;
    LODWORD(v8) = current_thread(this, 0x400000000LL);
    v27 = v8;
    IO80211PeerManager::getBSDName(this);
    v9 = *(_WORD *)(v3 + 2);
    v10 = *(_WORD *)(v3 + 4);
    v11 = *(_WORD *)(v3 + 6);
    v12 = *(_WORD *)(v3 + 8);
    v13 = *(_WORD *)(v3 + 10);
    v14 = *(_WORD *)(v3 + 12);
    v15 = *(_WORD *)(v3 + 14);
    v16 = *((_QWORD *)this + 11);
    if ( v16 )
      v17 = *(_DWORD *)(v16 + 52);
    v18 = v7 >> 18;
    v19 = *((_DWORD *)this + 38);
    v20 = *((_DWORD *)this + 258);
    if ( *((_DWORD *)this + 1244) != 4 )
      v21 = *((_BYTE *)this + 1512) == 0;
    v22 = *((_DWORD *)this + 38);
    v23 = *((_BYTE *)this + 560);
    v6 = 0LL;
    IO80211PeerManager::logDebug(
      this,
      0x400000000LL,
      "%llu.%06llu DQUREQ <%p> <%s> total %u maxu %u maxm %u pktcnt[%u %u %u %u] numpeers %u reqTx 0x%x txav%u aav %u dpopen %u -> %llu.%06llu got %d reqTx 0x%x\n",
      v28,
      v18,
      v27);
  }
  do
  {
    v24 = *(_QWORD *)(v3 + 8 * v6 + 24);
    *(_WORD *)(v3 + 2 * v6 + 8) = 0;
    if ( v24 )
    {
      *(_WORD *)(v3 + 2 * v6 + 8) = 1;
      while ( 1 )
      {
        LODWORD(v25) = mbuf_nextpkt(v24);
        if ( !v25 )
          break;
        ++*(_WORD *)(v3 + 2 * v6 + 8);
        v24 = v25;
      }
    }
    ++v6;
  }
  while ( v6 != 4 );
  return (unsigned int)v29;
}
// 7D5B0: using guessed type __int64 `vtable for'IO80211PeerManager[2];
// C8A50: using guessed type int __fastcall current_thread(_QWORD, _QWORD);
// C8C60: using guessed type int __fastcall mbuf_nextpkt(_QWORD);

//----- (000000000002E268) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::updateSyncFrameTemplate(IO80211AWDLPeerManager *this)
{
  __int64 v1; // r12@1
  unsigned int v2; // er14@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  __int64 v5; // r9@2
  __int64 result; // rax@2
  OSMetaClass *v7; // rax@6
  __int64 v8; // rax@6
  int v9; // er14@7
  OSMetaClass *v10; // rax@8
  __int64 v11; // r15@8
  __int64 v12; // rax@8
  __int64 v13; // rax@8
  __int64 v14; // rcx@9
  int v15; // [sp+8h] [bp-258h]@7
  int v16; // [sp+Ch] [bp-254h]@7
  __int64 *v17; // [sp+10h] [bp-250h]@7
  __int64 v18; // [sp+20h] [bp-240h]@1
  __int64 v19; // [sp+28h] [bp-238h]@1
  char v20[520]; // [sp+30h] [bp-230h]@1
  __int64 v21; // [sp+238h] [bp-28h]@1

  v1 = off_7B078[0];
  v21 = *(_QWORD *)off_7B078[0];
  v18 = 1LL;
  v19 = (__int64)v20;
  v2 = IO80211AWDLPeerManager::buildServiceParamTlv((__int64)this, (__int64)v20);
  if ( v2 < 0x200 )
  {
    if ( *((_DWORD *)this + 947) >= 2u )
    {
      IO80211CommandQueue::lock(*((IO80211CommandQueue **)this + 476), 0LL, 0);
      v2 += IO80211AWDLPeerManager::buildServiceResponseTlvs(this, (__int64)v20, (__int64)&v20[v2], 512 - v2);
      IO80211CommandQueue::unlock(*((IO80211CommandQueue **)this + 476), 0LL);
    }
    HIDWORD(v18) = v2;
    if ( IO80211PeerManager::shouldVerboseLog(this, 0x2000000000LL) )
    {
      LODWORD(v7) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                      this,
                      0x2000000000LL);
      v8 = OSMetaClass::getClassName(v7);
      IO80211PeerManager::logDebug(
        this,
        0x2000000000LL,
        "%s::%s updateSyncFrameTemplate len %u\n",
        v8,
        (__int64)"updateSyncFrameTemplate",
        v2);
    }
    v15 = -2144835128;
    v16 = 151;
    v17 = &v18;
    v9 = IO80211PeerManager::ioctl_internal(this, (__int64)&v15);
    result = 0LL;
    if ( v9 )
    {
      LODWORD(v10) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v15);
      v11 = OSMetaClass::getClassName(v10);
      v12 = IO80211PeerManager::getController(this);
      LODWORD(v13) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v12 + 1920LL))(v12, (unsigned int)v9);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s  Unable to set sync frame template ret %d %s\n",
        v11,
        (__int64)"updateSyncFrameTemplate",
        (unsigned int)v9,
        v13);
      result = (unsigned int)v9;
    }
  }
  else
  {
    LODWORD(v3) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s buildServiceParamTlv() returned invalid template_size %u\n",
      v4,
      (__int64)"updateSyncFrameTemplate",
      v2,
      v5);
    result = 3758097097LL;
  }
  v14 = *(_QWORD *)v1;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 2E268: using guessed type char var_230[520];

//----- (000000000002E438) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::buildServiceParamTlv(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  int v3; // ecx@1
  int v4; // eax@2
  __int64 v5; // rdx@3
  __int64 result; // rax@5

  v2 = 0LL;
  memset((void *)a2, 0, 0x2CuLL);
  *(_BYTE *)a2 = 6;
  v3 = 0;
  do
  {
    v4 = *(_DWORD *)(a1 + 8140);
    if ( _bittest((const unsigned int *)&v4, v2) )
    {
      v5 = (unsigned int)v3++;
      *(_BYTE *)(a2 + v5 + 12) = *(_BYTE *)(a1 + v2 + 8144);
    }
    ++v2;
  }
  while ( v2 != 32 );
  *(_BYTE *)(a2 + 3) = 0;
  result = (unsigned int)(v3 + 12);
  *(_DWORD *)(a2 + 8) = *(_DWORD *)(a1 + 8140);
  *(_WORD *)(a2 + 6) = *(_WORD *)(a1 + 8136);
  *(_WORD *)(a2 + 1) = v3 + 9;
  return result;
}

//----- (000000000002E4B8) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::buildServiceResponseTlvs(IO80211PeerManager *this, __int64 a2, __int64 a3, unsigned int a4)
{
  __int64 v4; // rbx@1
  unsigned int v5; // er15@1
  unsigned int v6; // er15@2
  __int64 v7; // r9@3
  unsigned int v8; // er15@5
  __int64 v9; // r9@6
  __int64 v10; // r9@9
  OSMetaClass *v11; // rax@12
  __int64 v12; // rax@12
  __int64 v13; // r8@12
  __int64 v14; // r9@12
  OSMetaClass *v15; // rax@12
  __int64 v16; // rax@12
  __int64 v17; // r9@12
  __int64 v18; // rdx@12
  __int64 v19; // rcx@12
  __int64 v20; // r8@12
  __int64 v21; // r9@12
  __int64 v22; // r13@13
  __int64 result; // rax@16
  __int64 v24; // [sp+8h] [bp-98h]@2
  __int64 v25; // [sp+10h] [bp-90h]@2
  __int64 v26; // [sp+18h] [bp-88h]@2
  int v27; // [sp+20h] [bp-80h]@2
  int v28; // [sp+24h] [bp-7Ch]@2
  char v29; // [sp+28h] [bp-78h]@2
  char v30; // [sp+29h] [bp-77h]@2
  int v31; // [sp+2Ch] [bp-74h]@2
  __int64 v32; // [sp+30h] [bp-70h]@2
  __int64 v33; // [sp+38h] [bp-68h]@2
  __int64 v34; // [sp+40h] [bp-60h]@2
  __int64 v35; // [sp+48h] [bp-58h]@2
  unsigned int v36; // [sp+50h] [bp-50h]@2
  int v37; // [sp+54h] [bp-4Ch]@2
  int v38; // [sp+58h] [bp-48h]@2
  __int64 v39; // [sp+60h] [bp-40h]@2
  int v40; // [sp+68h] [bp-38h]@2
  __int64 v41; // [sp+70h] [bp-30h]@1

  v4 = off_7B078[0];
  v41 = *(_QWORD *)off_7B078[0];
  v5 = 0;
  if ( *((_DWORD *)this + 947) )
  {
    v24 = a3;
    v25 = 0LL;
    v26 = a4;
    v27 = 2;
    v28 = 12;
    v29 = 0;
    v30 = 0;
    v31 = 0;
    v35 = 0LL;
    v34 = 0LL;
    v33 = 0LL;
    v32 = 0LL;
    v36 = 0;
    v37 = 0;
    v38 = 0;
    v39 = 0LL;
    v40 = 0;
    IO80211CommandQueue::map(
      *((_QWORD *)this + 476),
      (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_copyTLV,
      (__int64)this,
      (__int64)&v24,
      0LL,
      -1);
    v6 = v25;
    if ( IO80211PeerManager::shouldVerboseLog(this, 0x1000000LL) && IO80211PeerManager::shouldLog(this, 0x1000000LL) )
      IO80211PeerManager::logDebug(
        this,
        0x1000000LL,
        "    Sync -- advertise PTR records tlvs num %u -> %u \n",
        v36,
        v6,
        v7);
    v28 = 33;
    IO80211CommandQueue::map(
      *((_QWORD *)this + 476),
      (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_copyTLV,
      (__int64)this,
      (__int64)&v24,
      0LL,
      -1);
    v8 = v25;
    if ( IO80211PeerManager::shouldVerboseLog(this, 0x1000000LL) && IO80211PeerManager::shouldLog(this, 0x1000000LL) )
      IO80211PeerManager::logDebug(
        this,
        0x1000000LL,
        "    Sync -- advertise SRV records tlvs num %u -> %u \n",
        v36,
        v8,
        v9);
    v28 = 16;
    IO80211CommandQueue::map(
      *((_QWORD *)this + 476),
      (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_copyTLV,
      (__int64)this,
      (__int64)&v24,
      0LL,
      -1);
    v5 = v25;
    if ( IO80211PeerManager::shouldVerboseLog(this, 0x1000000LL) && IO80211PeerManager::shouldLog(this, 0x1000000LL) )
      IO80211PeerManager::logDebug(
        this,
        0x1000000LL,
        "    Sync -- advertise TXT records tlvs num %u -> %u \n",
        v36,
        v5,
        v10);
    if ( *((_DWORD *)this + 1006) >= 2u )
    {
      LODWORD(v11) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       0x1000000LL);
      v12 = OSMetaClass::getClassName(v11);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s buildServiceResponseTlvs() Clearing bits \n",
        v12,
        (__int64)"buildServiceResponseTlvs",
        v13,
        v14);
      LODWORD(v15) = (*(int (__fastcall **)(IO80211PeerManager *, _QWORD))(*(_QWORD *)this + 56LL))(
                       this,
                       "%s::%s buildServiceResponseTlvs() Clearing bits \n");
      v16 = OSMetaClass::getClassName(v15);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s ssth: 0x%x [",
        v16,
        (__int64)"buildServiceResponseTlvs",
        *(_DWORD *)(a2 + 8),
        v17);
      if ( *(_WORD *)(a2 + 1) - 9 > 0 )
      {
        v22 = 0LL;
        do
          IO80211PeerManager::logDebug(this, "%02x ", *(_BYTE *)(a2 + v22++ + 12), v19, v20, v21);
        while ( (signed int)v22 < *(_WORD *)(a2 + 1) - 9 );
      }
      IO80211PeerManager::logDebug(this, "]\n", v18, v19, v20, v21);
      v4 = off_7B078[0];
    }
  }
  result = *(_QWORD *)v4;
  if ( *(_QWORD *)v4 == v41 )
    result = v5;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000002E7A0) ----------------------------------------------------
char __fastcall IO80211AWDLPeerManager::setInfraChannelSpec(IO80211PeerManager *this, int a2, const void *a3)
{
  char result; // al@1
  IO80211PeerManager *v4; // rbx@1
  __int64 v5; // rax@4
  OSMetaClass *v6; // rax@7
  __int64 v7; // rdi@7
  char v8; // [sp+20h] [bp-20h]@3
  int v9; // [sp+28h] [bp-18h]@5
  int v10; // [sp+2Ch] [bp-14h]@5

  result = (char)a3;
  v4 = this;
  if ( !*((_DWORD *)this + 26) )
  {
    if ( a3 )
    {
      memcpy(&v8, a3, 0x10uLL);
    }
    else
    {
      v5 = IO80211PeerManager::getController(this);
      result = IO80211Controller::getInfraChannel(v5, &v8);
      if ( !result )
      {
        *((_QWORD *)this + 13) = 0LL;
        return result;
      }
    }
    *((_DWORD *)this + 26) = v9;
    result = v10;
    *((_DWORD *)this + 27) = v10;
  }
  if ( a2 )
  {
    LODWORD(v6) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
    v7 = OSMetaClass::getClassName(v6);
    result = IO80211PeerManager::logDebug(
               v4,
               "%s::%s chan %u flags 0x%x (%s %s) -> 0x%x\n",
               v7,
               (__int64)"setInfraChannelSpec",
               *((_DWORD *)v4 + 26),
               *((_DWORD *)v4 + 27));
  }
  return result;
}

//----- (000000000002E8A2) ----------------------------------------------------
char __fastcall IO80211AWDLPeerManager::getInfrastructureState(IO80211AWDLPeerManager *this)
{
  __int64 v1; // rax@1
  __int64 *v2; // rsi@1
  char v3; // r15@1
  OSMetaClass *v4; // rax@2
  __int64 v5; // rax@2
  __int64 v6; // r9@2
  char v7; // bl@3
  OSMetaClass *v8; // rax@5
  __int64 v9; // rax@5
  int v10; // ST08_4@5
  __int64 v11; // rax@6
  OSMetaClass *v12; // rax@7
  __int64 v13; // rcx@7
  __int64 v14; // r9@7
  const char *v15; // rdx@7
  __int64 v16; // rax@8
  char v17; // bl@8
  char *v18; // rsi@8
  char v19; // r15@9
  OSMetaClass *v20; // rax@10
  OSMetaClass *v21; // rax@13
  __int64 v22; // rax@13
  __int64 v23; // r9@13
  int v24; // eax@16
  OSMetaClass *v25; // rax@17
  __int64 v26; // rax@17
  OSMetaClass *v27; // rax@22
  __int64 v28; // rax@22
  int v29; // ST20_4@22
  int v30; // ST18_4@22
  int v31; // ST10_4@22
  int v32; // ST08_4@22
  int v33; // ST00_4@22
  __int64 v35; // [sp+30h] [bp-40h]@8
  int v36; // [sp+38h] [bp-38h]@8
  __int64 v37; // [sp+40h] [bp-30h]@1
  __int64 v38; // [sp+48h] [bp-28h]@1

  v38 = 0LL;
  v37 = 1LL;
  v1 = IO80211PeerManager::getController(this);
  v2 = &v37;
  v3 = IO80211Controller::getInfraChannel(v1, &v37);
  if ( !v3 )
  {
    LODWORD(v4) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64 *))(*(_QWORD *)this + 56LL))(this, &v37);
    v5 = OSMetaClass::getClassName(v4);
    v2 = 0;
    IO80211PeerManager::logDebug(
      this,
      0x2000000000LL,
      "%s::%s couldn't get infra channel\n",
      v5,
      (__int64)"getInfrastructureState",
      v6);
  }
  v7 = 0;
  if ( (_DWORD)v38 )
    v7 = v3;
  LODWORD(v8) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64 *))(*(_QWORD *)this + 56LL))(this, v2);
  v9 = OSMetaClass::getClassName(v8);
  v10 = *((_DWORD *)this + 26);
  IO80211PeerManager::logDebug(
    this,
    0x2000000000LL,
    "%s::%s valid infra %u cd.channel %u infrachannel %u \n",
    v9,
    (__int64)"getInfrastructureState",
    (unsigned __int8)v7);
  if ( v7 )
  {
    v11 = IO80211PeerManager::getController(this);
    if ( (*(int (__fastcall **)(__int64, char *))(*(_QWORD *)v11 + 2848LL))(v11, (char *)this + 118) )
    {
      LODWORD(v12) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
      v13 = OSMetaClass::getClassName(v12);
      v15 = "%s::%s couldn't get infra address\n";
    }
    else
    {
      v36 = 0;
      v35 = 1LL;
      v16 = IO80211PeerManager::getController(this);
      v17 = IO80211Controller::getBSSIDData(v16, &v35);
      v18 = (char *)&v35 + 4;
      memcpy((char *)this + 112, (char *)&v35 + 4, 6uLL);
      if ( v17 )
      {
        v19 = 0;
        goto LABEL_16;
      }
      LODWORD(v20) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, char *))(*(_QWORD *)this + 56LL))(
                       this,
                       (char *)&v35 + 4);
      v13 = OSMetaClass::getClassName(v20);
      v15 = "%s::%s couldn't get infra BSSID\n";
    }
    IO80211PeerManager::logDebug(this, 0x2000000000LL, v15, v13, (__int64)"getInfrastructureState", v14);
  }
  if ( *((_DWORD *)this + 26) )
  {
    LODWORD(v21) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                     this,
                     0x2000000000LL);
    v22 = OSMetaClass::getClassName(v21);
    IO80211PeerManager::logDebug(
      this,
      0x2000000000LL,
      "%s::%s lost infrastructure link\n",
      v22,
      (__int64)"getInfrastructureState",
      v23);
    v19 = 1;
  }
  else
  {
    v19 = 0;
  }
  memset((char *)this + 118, 0, 6uLL);
  v18 = 0LL;
  memset((char *)this + 112, 0, 6uLL);
LABEL_16:
  v24 = *((_DWORD *)this + 26);
  if ( v24 != (_DWORD)v38 )
  {
    LODWORD(v25) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, char *))(*(_QWORD *)this + 56LL))(this, v18);
    v26 = OSMetaClass::getClassName(v25);
    IO80211PeerManager::logDebug(
      this,
      0x2000000000LL,
      "%s::%s infra channel %u -> %u\n",
      v26,
      (__int64)"getInfrastructureState",
      *((_DWORD *)this + 26));
    v24 = v38;
    *((_DWORD *)this + 26) = v38;
    *((_DWORD *)this + 27) = HIDWORD(v38);
    v19 = 1;
  }
  if ( !v24 )
    *((_DWORD *)this + 26) = 0;
  if ( v19 && IO80211PeerManager::shouldLog(this, 0x2000000000LL) )
  {
    LODWORD(v27) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                     this,
                     0x2000000000LL);
    v28 = OSMetaClass::getClassName(v27);
    v29 = *((_DWORD *)this + 26);
    v30 = *((_BYTE *)this + 117);
    v31 = *((_BYTE *)this + 116);
    v32 = *((_BYTE *)this + 115);
    v33 = *((_BYTE *)this + 114);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s(): Infrastructure state changed: BSSID(%02x:%02x:%02x:%02x:%02x:%02x), Channel(%u)\n",
      v28,
      (__int64)"getInfrastructureState",
      *((_BYTE *)this + 112),
      *((_BYTE *)this + 113));
  }
  return v19;
}

//----- (000000000002EB80) ----------------------------------------------------
char __fastcall IO80211AWDLPeerManager::interfaceStateChange(IO80211AWDLPeerManager *this, unsigned int a2)
{
  IO80211AWDLPeerManager *v2; // r14@1
  OSMetaClass *v3; // rax@1
  __int64 v4; // r10@1
  char v5[8]; // r9@1
  int v6; // edx@3
  unsigned __int64 v7; // rax@3
  char *v8; // r11@4
  unsigned __int64 v9; // rax@5
  char *v10; // r12@6
  __int64 v11; // r15@7
  int v12; // ST48_4@7
  OSMetaClass *v13; // rax@9
  __int64 v14; // rdx@9
  __int64 v15; // r9@9
  char v16[8]; // r8@10
  char *v17; // rsi@11
  OSMetaClass *v18; // rax@15
  __int64 v19; // rcx@15
  char v20[8]; // r9@16
  char v21; // r13@18
  __int64 (__fastcall *v22)(__int64, IO80211ServiceRequestDescriptor *, __int64); // rsi@28
  int v23; // ebx@28
  int v24; // er12@28
  int v25; // eax@28
  int v26; // ecx@28
  __int64 v27; // rdx@30
  int v28; // er12@32
  __int64 v29; // rcx@32
  int v30; // eax@35
  OSMetaClass *v31; // rax@40
  __int64 v32; // rax@40
  __int64 v33; // r8@40
  __int64 v34; // r9@40
  OSMetaClass *v35; // rax@45
  __int64 v36; // rax@45
  __int64 v37; // r9@45
  int v38; // eax@46
  char v39; // dl@46
  bool v40; // bl@46
  int v41; // eax@46
  signed __int64 v42; // rcx@46
  char v43; // bl@46
  OSMetaClass *v44; // rax@51
  char v45[8]; // r9@51
  int v46; // ebx@53
  int v47; // ST60_4@53
  int v48; // ST40_4@53
  int v49; // ST38_4@53
  OSMetaClass *v50; // rax@53
  __int64 v51; // rcx@53
  unsigned __int64 v52; // rax@53
  char v53[8]; // r9@53
  int v54; // ST08_4@55
  int v55; // ST00_4@55
  __int64 v56; // rsi@55
  OSMetaClass *v57; // rax@57
  __int64 v58; // rax@57
  __int64 v59; // r8@57
  __int64 v60; // r9@57
  OSMetaClass *v61; // rax@60
  __int64 v62; // rax@60
  __int64 v63; // rsi@60
  __int64 v64; // r9@60
  OSMetaClass *v65; // rax@61
  __int64 v66; // rdx@61
  __int64 v67; // r8@61
  __int64 v68; // r9@61
  const char *v69; // rsi@61
  int v70; // ebx@62
  OSMetaClass *v71; // rax@63
  __int64 v72; // r15@63
  unsigned int v73; // er12@63
  __int64 v74; // rax@63
  int v75; // ebx@65
  char v76; // r12@65
  OSMetaClass *v77; // rax@66
  __int64 v78; // rax@66
  bool v79; // bl@67
  OSMetaClass *v80; // rax@69
  __int64 v81; // rax@69
  int v82; // ST00_4@69
  int *v83; // rsi@69
  int v84; // ebx@69
  int v85; // eax@71
  signed __int64 v86; // rsi@72
  OSMetaClass *v87; // rax@81
  __int64 v88; // rax@81
  __int64 v89; // r9@81
  OSMetaClass *v90; // rax@83
  OSMetaClass *v91; // rax@86
  __int64 v92; // rax@86
  __int64 v93; // r9@86
  int v94; // eax@89
  OSMetaClass *v95; // rax@89
  __int64 v96; // rax@89
  __int64 v97; // rbx@89
  unsigned int v98; // er15@89
  unsigned int v99; // er12@89
  int v100; // ST00_4@89
  OSMetaClass *v101; // rax@91
  __int64 v102; // rax@91
  __int64 v103; // r9@91
  __int64 v104; // rdi@93
  IO80211VirtualInterface *v105; // rdi@96
  __int64 v107; // [sp+70h] [bp-100h]@51
  __int64 v108; // [sp+78h] [bp-F8h]@51
  char v109; // [sp+87h] [bp-E9h]@53
  unsigned int v110; // [sp+8Ch] [bp-E4h]@3
  __int64 v111; // [sp+90h] [bp-E0h]@82
  int v112; // [sp+98h] [bp-D8h]@82
  __int64 v113; // [sp+A0h] [bp-D0h]@69
  __int64 v114; // [sp+A8h] [bp-C8h]@69
  int v115; // [sp+B0h] [bp-C0h]@69
  int v116; // [sp+B4h] [bp-BCh]@69
  __int64 v117; // [sp+B8h] [bp-B8h]@62
  __int64 v118; // [sp+C0h] [bp-B0h]@62
  int v119; // [sp+C8h] [bp-A8h]@59
  int v120; // [sp+CCh] [bp-A4h]@59
  int v121; // [sp+D0h] [bp-A0h]@28
  int v122; // [sp+D4h] [bp-9Ch]@28
  int v123; // [sp+D8h] [bp-98h]@62
  int v124; // [sp+DCh] [bp-94h]@62
  __int64 *v125; // [sp+E0h] [bp-90h]@62
  char v126; // [sp+F0h] [bp-80h]@13

  v2 = this;
  LODWORD(v3) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
  v4 = OSMetaClass::getClassName(v3);
  *(_QWORD *)v5 = "unknown";
  if ( a2 <= 0xD )
    *(_QWORD *)v5 = off_7D1A0[a2];
  v110 = a2;
  v6 = *((_DWORD *)this + 1849);
  v7 = *((_DWORD *)this + 1244);
  if ( v7 <= 0xB )
    v8 = off_7D120[v7];
  v9 = *((_DWORD *)this + 259);
  if ( v9 <= 3 )
    v10 = off_7D180[v9];
  *((_BYTE *)this + 96);
  v11 = *((_BYTE *)this + 7441);
  v12 = *((_DWORD *)this + 1012);
  IO80211PeerManager::logDebug(
    this,
    0x800000LL,
    "%s::%s Enter [reason %s] state 0x%x%s%s%s%s%s %s %s %s soloEnabled %u chanSwithCapable %u\n",
    v4,
    (__int64)"interfaceStateChange",
    *(__int64 *)v5);
  if ( !*((_DWORD *)this + 1851) && a2 != 6 )
  {
    LODWORD(v13) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                     this,
                     0x800000LL);
    v14 = OSMetaClass::getClassName(v13);
    if ( a2 > 0xD )
      *(_QWORD *)v16 = "unknown";
    else
      *(_QWORD *)v16 = off_7D1A0[a2];
    v21 = 0;
    IO80211PeerManager::logDebug(
      this,
      "%s::%s WD reset in progress, not enabling AWDL yet! %s\n",
      v14,
      (__int64)"interfaceStateChange",
      *(__int64 *)v16,
      v15);
    return v21;
  }
  v17 = 0;
  if ( IO80211PeerManager::shouldVerboseLog(this, 0x2000000000LL) )
  {
    v17 = 0;
    if ( IO80211PeerManager::shouldLog(this, 0x2000000000LL) )
    {
      IO80211PeerManager::initUserPrintContext(this, (__int64)&v126, 0LL, 0);
      v17 = &v126;
      IO80211CommandQueue::print(*((_QWORD *)this + 476), (__int64)&v126);
    }
  }
  if ( (unsigned int)IO80211VirtualInterface::linkState(*((IO80211VirtualInterface **)this + 16)) == 1 )
  {
    LODWORD(v18) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, char *))(*(_QWORD *)this + 56LL))(this, v17);
    v19 = OSMetaClass::getClassName(v18);
    if ( v110 > 0xD )
      *(_QWORD *)v20 = "unknown";
    else
      *(_QWORD *)v20 = off_7D1A0[v110];
    IO80211PeerManager::logDebug(
      this,
      0x2000000000LL,
      "%s::%s Interface link is down, nothing to do. Source = %s\n",
      v19,
      (__int64)"interfaceStateChange",
      *(__int64 *)v20);
    return 1;
  }
  if ( *((_DWORD *)this + 992) )
    *((_DWORD *)this + 259) = *((_DWORD *)this + 1012) && *((_BYTE *)this + 7441);
  if ( IO80211AWDLPeerManager::getInfrastructureState(this) )
  {
    *((_QWORD *)this + 491) = getAbsoluteTime();
    *((_BYTE *)this + 96) = 0;
  }
  v122 = 0;
  v121 = 0;
  IO80211CommandQueue::lockMap(
    *((IO80211CommandQueue **)this + 476),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countNonAirPlayServices,
    (__int64)this,
    (__int64)&v121,
    0LL,
    -1);
  v22 = _countAirPlayServices;
  IO80211CommandQueue::lockMap(
    *((IO80211CommandQueue **)this + 476),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countAirPlayServices,
    (__int64)this,
    (__int64)&v122,
    0LL,
    -1);
  v23 = v122;
  v24 = v121;
  *((_DWORD *)this + 996) = *((_DWORD *)this + 992) == 0 && v122 != 0 && v121 == 0;
  IO80211AWDLPeerManager::configureValidNANChannels(this);
  v25 = *((_DWORD *)this + 381);
  v26 = *((_DWORD *)this + 381);
  if ( !v25 )
    v26 = *((_DWORD *)this + 382);
  v27 = *((_BYTE *)this + 1533);
  if ( (_DWORD)v27 != (unsigned __int8)v26 )
    *((_BYTE *)this + 96) = 0;
  v28 = v23 + v24;
  v29 = *((_DWORD *)this + 380);
  *((_BYTE *)this + 1532) = v29;
  *((_BYTE *)this + 1533) = 0;
  if ( v25 || (v25 = *((_DWORD *)this + 382)) != 0 )
    *((_BYTE *)this + 1533) = v25;
  v30 = *((_DWORD *)this + 259);
  if ( !v30 )
  {
    v27 = (unsigned __int8)v29;
    v29 = *((_DWORD *)this + 26);
    if ( (_DWORD)v27 != (_DWORD)v29 )
      *((_BYTE *)this + 96) = 0;
    *((_BYTE *)this + 1532) = v29;
    *((_BYTE *)this + 1533) = 0;
  }
  if ( v110 == 6 )
  {
    LODWORD(v31) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64 (__fastcall *)(__int64, IO80211ServiceRequestDescriptor *, __int64)))(*(_QWORD *)this + 56LL))(
                     this,
                     _countAirPlayServices);
    v32 = OSMetaClass::getClassName(v31);
    v22 = (__int64 (__fastcall *)(__int64, IO80211ServiceRequestDescriptor *, __int64))"%s::%s Recovering Reset due to watchdog \n";
    IO80211PeerManager::logDebug(
      this,
      "%s::%s Recovering Reset due to watchdog \n",
      v32,
      (__int64)"interfaceStateChange",
      v33,
      v34);
    v30 = *((_DWORD *)this + 259);
  }
  LOBYTE(v29) = *((_DWORD *)this + 1885) != 0;
  LOBYTE(v27) = v28 != 0;
  if ( !v30 && (!*((_DWORD *)this + 26) || *((_BYTE *)this + 3636)) )
  {
    if ( *((_BYTE *)this + 7396) & 2 )
    {
      LODWORD(v35) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64 (__fastcall *)(__int64, IO80211ServiceRequestDescriptor *, __int64), __int64, __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       v22,
                       v27,
                       v29);
      v36 = OSMetaClass::getClassName(v35);
      v21 = 0;
      IO80211PeerManager::logDebug(
        this,
        0x2000000000LL,
        "%s::%s In legacy infrastructure mode with no infra connection, waiting briefly before turning off AWDL\n",
        v36,
        (__int64)"interfaceStateChange",
        v37);
      return v21;
    }
    return 0;
  }
  v38 = *((_DWORD *)this + 1849);
  v39 = v27 & v29 | (v110 == 3);
  v40 = (v38 & 8) == 0;
  v41 = v38 & 2;
  v42 = 0x800000LL;
  v43 = v39 & v40;
  if ( v43 )
  {
    if ( v41 )
      goto LABEL_51;
  }
  else if ( !v41 )
  {
    goto LABEL_51;
  }
  v42 = 0xFFFFFFFFLL;
LABEL_51:
  v108 = v42;
  LODWORD(v44) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64 (__fastcall *)(__int64, IO80211ServiceRequestDescriptor *, __int64)))(*(_QWORD *)this + 56LL))(
                   this,
                   v22);
  v107 = OSMetaClass::getClassName(v44);
  *(_QWORD *)v45 = "unknown";
  if ( v110 <= 0xD )
    *(_QWORD *)v45 = off_7D1A0[v110];
  v109 = v43;
  *((_DWORD *)this + 1849);
  v46 = *((_DWORD *)this + 26);
  v47 = *((_DWORD *)this + 996);
  v48 = *(_DWORD *)(*((_QWORD *)this + 476) + 52LL);
  v49 = *((_DWORD *)this + 372);
  IO80211PeerManager::logDebug(
    this,
    v108,
    "%s::%s(): [reason: %s] %s  (state 0x%x%s%s%s%s%s _syncState:%u numservices:%u (valid:%u) valid_infra:%u cur_infra_channel:%u quiet_mode:%u\n)\n",
    v107,
    (__int64)"interfaceStateChange",
    *(__int64 *)v45);
  LODWORD(v50) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64))(*(_QWORD *)this + 56LL))(this, v108);
  v51 = OSMetaClass::getClassName(v50);
  v52 = *((_DWORD *)this + 259);
  *(_QWORD *)v53 = "unknown";
  if ( v52 <= 3 )
    *(_QWORD *)v53 = off_7D180[v52];
  v54 = *((_BYTE *)this + 1533);
  v55 = *((_BYTE *)this + 1532);
  v21 = 0;
  v56 = v108;
  IO80211PeerManager::logDebug(
    this,
    v108,
    "%s::%s(): strategy:%s master channel 1=>%d master channel 2=>%d\n",
    v51,
    (__int64)"interfaceStateChange",
    *(__int64 *)v53);
  if ( v109 & 1 )
  {
    if ( !(*((_BYTE *)this + 7396) & 1) )
    {
      LODWORD(v57) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64))(*(_QWORD *)this + 56LL))(this, v108);
      v58 = OSMetaClass::getClassName(v57);
      v56 = (__int64)"%s::%s and not configured!  Trying to configure...\n";
      IO80211PeerManager::logDebug(
        this,
        "%s::%s and not configured!  Trying to configure...\n",
        v58,
        (__int64)"interfaceStateChange",
        v59,
        v60);
      if ( (signed int)IO80211AWDLPeerManager::configure(this) < 0 )
      {
        LODWORD(v65) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, _QWORD))(*(_QWORD *)this + 56LL))(
                         this,
                         "%s::%s and not configured!  Trying to configure...\n");
        v66 = OSMetaClass::getClassName(v65);
        v69 = "%s::%s FAILURE to configure AWDL\n";
LABEL_84:
        v21 = 0;
        IO80211PeerManager::logDebug(this, v69, v66, (__int64)"interfaceStateChange", v67, v68);
        return v21;
      }
    }
    (*(void (__fastcall **)(IO80211AWDLPeerManager *, __int64))(*(_QWORD *)this + 424LL))(this, v56);
    if ( !*((_BYTE *)this + 96) )
    {
      v119 = 1;
      v120 = *((_DWORD *)this + 929);
      if ( (unsigned int)IO80211AWDLPeerManager::setAwdlElectionId(this, &v119) )
      {
        LODWORD(v61) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v119);
        v62 = OSMetaClass::getClassName(v61);
        v63 = (__int64)"%s::%s failed to set election ID to %u\n";
        v21 = 0;
        IO80211PeerManager::logDebug(
          this,
          "%s::%s failed to set election ID to %u\n",
          v62,
          (__int64)"interfaceStateChange",
          *((_DWORD *)this + 929),
          v64);
LABEL_64:
        (*(void (__fastcall **)(IO80211AWDLPeerManager *, __int64))(*(_QWORD *)this + 416LL))(this, v63);
        return v21;
      }
      v118 = 1LL;
      v117 = 1LL;
      HIDWORD(v118) = *((_BYTE *)this + 1532);
      HIDWORD(v117) = *((_BYTE *)this + 1533);
      v123 = -2144835128;
      v124 = 132;
      v125 = &v118;
      v70 = IO80211PeerManager::ioctl_internal(this, (__int64)&v123);
      if ( v70 )
      {
        LODWORD(v71) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v123);
        v72 = OSMetaClass::getClassName(v71);
        v73 = *((_BYTE *)this + 1532);
        v74 = IO80211PeerManager::getController(this);
        (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v74 + 1920LL))(v74, (unsigned int)v70);
        v63 = (__int64)"%s::%s Unable to set master channel %u ret %d (%s)\n";
        v21 = 0;
        IO80211PeerManager::logDebug(
          this,
          "%s::%s Unable to set master channel %u ret %d (%s)\n",
          v72,
          (__int64)"interfaceStateChange",
          v73,
          (unsigned int)v70);
        goto LABEL_64;
      }
      v123 = -2144835128;
      v124 = 205;
      v125 = &v117;
      v75 = IO80211PeerManager::ioctl_internal(this, (__int64)&v123);
      v76 = 1;
      if ( v75 )
      {
        LODWORD(v77) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v123);
        v78 = OSMetaClass::getClassName(v77);
        v76 = 0;
        IO80211PeerManager::logDebug(
          this,
          "%s::%s Unable to set secondary master channel %u ret %d\n",
          v78,
          (__int64)"interfaceStateChange",
          *((_BYTE *)this + 1533),
          (unsigned int)v75);
      }
      *((_QWORD *)this + 486) = getAbsoluteTime();
      v79 = (unsigned int)IO80211AWDLPeerManager::updateSyncFrameTemplate(this) == 0;
      IO80211AWDLPeerManager::updateAndSendMI(this, 0);
      *((_BYTE *)this + 96) = v76 & v79;
    }
    if ( !*((_BYTE *)this + 3960) )
    {
      v115 = 0;
      v114 = 0LL;
      v113 = 1LL;
      v114 = *((_DWORD *)this + 373);
      HIDWORD(v113) = *((_DWORD *)this + 374);
      HIDWORD(v114) = *((_DWORD *)this + 375);
      v115 = *((_DWORD *)this + 376);
      v116 = *((_DWORD *)this + 377);
      v123 = -2144835128;
      v124 = 116;
      v125 = &v113;
      LODWORD(v80) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
      v81 = OSMetaClass::getClassName(v80);
      v82 = *((_DWORD *)this + 373);
      IO80211PeerManager::logDebug(
        this,
        0x2000000000LL,
        "%s::%s set sync params state 0x%x awperiod %u\n",
        v81,
        (__int64)"interfaceStateChange",
        *((_DWORD *)this + 1849));
      v83 = &v123;
      v84 = IO80211PeerManager::ioctl_internal(this, (__int64)&v123);
      if ( v84 )
      {
        if ( v84 != 82 )
        {
          LODWORD(v91) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v123);
          v92 = OSMetaClass::getClassName(v91);
          v83 = (int *)"%s::%s  Unable to set SYNC params ret %d\n";
          IO80211PeerManager::logDebug(
            this,
            "%s::%s  Unable to set SYNC params ret %d\n",
            v92,
            (__int64)"interfaceStateChange",
            (unsigned int)v84,
            v93);
        }
        (*(void (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 416LL))(this, v83);
        return 0;
      }
      *((_BYTE *)this + 3960) = 1;
    }
    v85 = *((_DWORD *)this + 259);
    if ( v85 )
    {
      v86 = *((_DWORD *)this + 1244);
      if ( v85 == 1 && !(*((_BYTE *)this + 7396) & 2) )
        v86 = *((_DWORD *)this + 139) != 0;
    }
    else
    {
      v86 = 1LL;
      if ( v110 == 2 )
        v86 = 3 * (unsigned int)(*((_DWORD *)this + 139) != 0) + 4;
    }
    if ( !*((_DWORD *)this + 1245) )
      IO80211AWDLPeerManager::setScheduleState(this, v86, 1);
    if ( !(*((_BYTE *)this + 7396) & 2) )
    {
      if ( strnlen((const char *)this + 7383, 3uLL) )
      {
        memcpy((char *)this + 1456, (char *)this + 7383, 3uLL);
        LODWORD(v87) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, char *))(*(_QWORD *)this + 56LL))(
                         this,
                         (char *)this + 7383);
        v88 = OSMetaClass::getClassName(v87);
        IO80211PeerManager::logDebug(
          this,
          "%s::%s forcing intial country code %s\n",
          v88,
          (__int64)"interfaceStateChange",
          (__int64)((char *)this + 1456),
          v89);
        *((_DWORD *)this + 1844) = 5;
      }
      v111 = 1LL;
      v112 = 1;
      v123 = -2144835128;
      v124 = 117;
      v125 = &v111;
      if ( IO80211PeerManager::ioctl_internal(this, (__int64)&v123) )
      {
        (*(void (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 416LL))(this, &v123);
        LODWORD(v90) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
        v66 = OSMetaClass::getClassName(v90);
        v69 = "%s::%s can t enable awdl!\n";
        goto LABEL_84;
      }
      v94 = *((_DWORD *)this + 1849);
      *((_QWORD *)this + 492) = *((_QWORD *)this + 490);
      *((_DWORD *)this + 1849) = v94 & 0xFFFFFFF9 | 2;
      memset((char *)this + 7448, 0, 0x18uLL);
      LODWORD(v95) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, _QWORD))(*(_QWORD *)this + 56LL))(this, 0LL);
      v96 = OSMetaClass::getClassName(v95);
      IO80211PeerManager::logDebug(
        this,
        0x2000000000LL,
        "%s::%s did enable state %x\n",
        v96,
        (__int64)"interfaceStateChange",
        *((_DWORD *)this + 1849));
      IO80211AWDLPeerManager::updateAndSendMI(this, 0);
      v97 = getAbsoluteTime();
      *((_QWORD *)this + 490) = v97;
      *((_QWORD *)this + 492) = v97;
      v98 = *((_DWORD *)this + 932);
      v99 = *((_DWORD *)this + 1850);
      v100 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v97)) >> 64) >> 18;
      IO80211PeerManager::logDebug(this, 0x800000LL, "%d: met %x   flags %x _lastTimeSince %u\n", 4847LL, v98, v99);
      v86 = 5000LL;
      IO80211Peer::flushQueues(*((IO80211Peer **)this + 9), 5000);
      if ( !*((_DWORD *)this + 259) && *((_QWORD *)this + 16) )
      {
        LODWORD(v101) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                          this,
                          5000LL);
        v102 = OSMetaClass::getClassName(v101);
        v86 = 0x10000000LL;
        IO80211PeerManager::logDebug(
          this,
          0x10000000LL,
          "%s::%s masterReport interfaceStateChange\n",
          v102,
          (__int64)"interfaceStateChange",
          v103);
        IO80211VirtualInterface::postNewMasterElected(*((IO80211VirtualInterface **)this + 16), (__ifnet *)0x10000000);
      }
    }
    if ( *((_BYTE *)this + 7396) & 6 )
    {
      (*(void (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 432LL))(this, v86);
      v104 = *((_QWORD *)this + 79);
      if ( v104 )
        (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v104 + 464LL))(v104, 30LL);
    }
    else
    {
      IO80211PeerManager::removeAllPeers(this);
      IO80211PeerManager::flushFreeMbufs(this);
    }
    v105 = (IO80211VirtualInterface *)*((_QWORD *)v2 + 16);
    v21 = 1;
    if ( v105 )
      IO80211VirtualInterface::postSyncStateChanged(v105);
  }
  return v21;
}
// 7D120: using guessed type char *off_7D120[33];
// 7D180: using guessed type char *off_7D180[21];
// 7D1A0: using guessed type char *off_7D1A0[17];

//----- (000000000002F8C8) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::selectChannelsToUseForAWDL(IO80211AWDLPeerManager *this)
{
  __int64 result; // rax@1

  *((_BYTE *)this + 1532) = *((_BYTE *)this + 1520);
  *((_BYTE *)this + 1533) = 0;
  result = *((_DWORD *)this + 381);
  if ( (_DWORD)result || (result = *((_DWORD *)this + 382), (_DWORD)result) )
    *((_BYTE *)this + 1533) = result;
  return result;
}

//----- (000000000002F8FC) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlElectionId(IO80211PeerManager *this, void *a2)
{
  signed int v2; // er14@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  __int64 v5; // r9@2
  OSMetaClass *v6; // rax@4
  __int64 v7; // rax@4

  v2 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x7Au, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    2150132168LL);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s error can't set election id ret=%d\n",
      v4,
      (__int64)"setAwdlElectionId",
      (unsigned int)v2,
      v5);
  }
  else
  {
    *((_DWORD *)this + 929) = *((_DWORD *)a2 + 1);
    if ( IO80211PeerManager::shouldLog(this, 32LL) )
    {
      LODWORD(v6) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, 32LL);
      v7 = OSMetaClass::getClassName(v6);
      IO80211PeerManager::logDebug(
        this,
        32LL,
        "%s::%s did set electionId 0x%x\n",
        v7,
        (__int64)"setAwdlElectionId",
        *((_DWORD *)a2 + 1));
    }
  }
  return (unsigned int)v2;
}

//----- (000000000002F9B6) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::adjustAwdlSnapHeader(IO80211AWDLPeerManager *this, IO80211PacketDescriptor *a2, IO80211Peer *a3)
{
  __int64 v3; // rbx@1
  IO80211AWDLPeerManager *v4; // r15@1
  __int64 v5; // r14@1
  __int64 v6; // rax@1
  __int64 v7; // r12@1
  char v8; // r13@1
  unsigned __int64 v9; // rax@1
  OSMetaClass *v10; // rax@2
  __int64 v11; // r12@2
  __int64 v12; // rax@2
  __int64 v13; // r9@2
  char v14; // r13@3
  OSMetaClass *v15; // rax@7
  __int64 v16; // rcx@7
  int v17; // eax@8
  int v18; // ST18_4@9
  __int64 v19; // rsi@10
  signed __int64 v20; // rdi@10
  signed __int16 v21; // bx@10
  signed __int64 v22; // r12@10
  unsigned int v23; // eax@14
  __int64 v24; // rcx@16
  unsigned __int16 v25; // ax@19
  unsigned int v26; // ebx@19
  signed __int64 v27; // r12@20
  OSMetaClass *v28; // rax@25
  __int64 v29; // rax@25
  __int64 v30; // r9@25
  __int64 v31; // rax@26
  __int16 v32; // ax@26
  __int16 v33; // ax@26
  signed __int64 v34; // rdx@26
  char v35; // cl@29
  signed __int64 v36; // r13@30
  signed __int64 v37; // rax@32
  char v38; // dl@32
  signed __int64 v39; // rcx@34
  int v40; // er15@38
  int v41; // eax@38
  OSMetaClass *v43; // rax@41
  __int64 v44; // rax@41
  __int64 v45; // [sp+28h] [bp-58h]@19
  __int64 v46; // [sp+40h] [bp-40h]@10
  IO80211PacketDescriptor *v47; // [sp+48h] [bp-38h]@1
  int v48; // [sp+50h] [bp-30h]@3
  int v49; // [sp+54h] [bp-2Ch]@26

  v3 = (__int64)a3;
  v47 = a2;
  v4 = this;
  v5 = *((_QWORD *)a2 + 4);
  LODWORD(v6) = mbuf_data(*((_QWORD *)a2 + 4));
  v7 = v6;
  v8 = *(_BYTE *)v6;
  LODWORD(v9) = mbuf_maxlen(v5);
  if ( v9 > 0x7F )
  {
    v14 = v8 & 1;
    v48 = *(_BYTE *)(v7 + 13) | (*(_BYTE *)(v7 + 12) << 8);
    *(_BYTE *)(v7 + 22) = *((_BYTE *)this + 1518);
    *(_BYTE *)(v7 + 23) = *((_BYTE *)this + 1512);
    if ( IO80211PeerManager::shouldLog(this, 0x400000000LL) && (v14 || v3 && !*(_DWORD *)(v3 + 608)) )
    {
      LODWORD(v15) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       0x400000000LL);
      v16 = OSMetaClass::getClassName(v15);
      if ( v3 )
        v17 = *(_DWORD *)(v3 + 608);
      v18 = *((_DWORD *)this + 90);
      IO80211PeerManager::logDebug(
        this,
        0x400000000LL,
        "%s::%s peer %p cnt %u pkt_length %u isMcast %u _htCapabilityLength %u MAX_MBUF_LLC_SIZE %u\n",
        v16,
        (__int64)"adjustAwdlSnapHeader",
        v3);
    }
    v46 = v3;
    v19 = v7;
    v20 = v7 + 28;
    v21 = 0;
    v22 = v7 + 28;
    if ( (unsigned int)v48 <= 0x47F )
    {
      if ( !v14 )
      {
        v21 = 0;
        v22 = v20;
        if ( !v46 )
          goto LABEL_29;
        v21 = 0;
        v22 = v20;
        if ( *(_DWORD *)(v46 + 608) )
          goto LABEL_23;
      }
      v23 = *((_DWORD *)v4 + 90);
      if ( !v23 || v23 >= 0x80 )
        goto LABEL_25;
      *(_BYTE *)(v19 + 28) = 7;
      *(_BYTE *)(v19 + 29) = *((_BYTE *)v4 + 360) + 2;
      memset((void *)(v19 + 30), 0, 2uLL);
      memcpy((void *)(v19 + 32), (char *)v4 + 334, *((_DWORD *)v4 + 90));
      v24 = (unsigned __int16)(*((_WORD *)v4 + 180) + 2);
      v22 = v19 + v24 + 30;
      if ( !v14 )
      {
        v21 = 1;
        if ( !v46 )
          goto LABEL_29;
        v21 = 1;
        if ( *(_DWORD *)(v46 + 608) )
        {
LABEL_23:
          if ( *((_DWORD *)v4 + 1008) )
          {
            if ( v22 - v20 >= 105 )
            {
LABEL_25:
              LODWORD(v28) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)v4 + 56LL))(v4);
              v29 = OSMetaClass::getClassName(v28);
              IO80211PeerManager::logDebug(
                v4,
                "%s::%s not enough space to add HT capabilities TLV (%d)",
                v29,
                (__int64)"adjustAwdlSnapHeader",
                *((_DWORD *)v4 + 90),
                v30);
              return v5;
            }
            *(_WORD *)v22 = 14;
            *(_BYTE *)(v22 + 2) = *((_BYTE *)v4 + 1440);
            *(_BYTE *)(v22 + 3) = *(_BYTE *)(v46 + 2LL * (unsigned int)mbuf_get_traffic_class(v5) + 80);
            *(_DWORD *)(v22 + 4) = _byteswap_ulong(2361183241434822607LL
                                                 * ((unsigned __int64)(getAbsoluteTime() - *((_QWORD *)v4 + 936)) >> 3) >> 64 >> 4);
            *(_DWORD *)(v22 + 8) = _byteswap_ulong(*((_DWORD *)v47 + 11));
            v49 = 0;
            v31 = IO80211VirtualInterface::getIfnet(*((IO80211VirtualInterface **)v4 + 16));
            ifnet_get_sndq_len(v31, &v49);
            v32 = __ROL2__(v49, 8);
            *(_WORD *)(v22 + 12) = v32;
            v33 = __ROL2__(*((_WORD *)v4 + 734), 8);
            v34 = (signed __int64)((char *)v4 + 592);
            *(_WORD *)(v22 + 14) = v33;
            *(_WORD *)(v22 + 16) = *((_BYTE *)v4 + 7585);
            *(_WORD *)(v22 + 18) = *((_WORD *)v47 + 30);
            if ( v14 )
              v34 = (signed __int64)((char *)v4 + 600);
            *(_DWORD *)(v22 + 20) = _byteswap_ulong((unsigned __int64)(2361183241434822607LL
                                                                     * (unsigned __int128)(*(_QWORD *)v34 >> 3) >> 64) >> 4);
            *(_BYTE *)(v22 + 1) = 22;
            v22 += 24LL;
            ++v21;
          }
LABEL_29:
          v35 = -(char)(v22 + 28 - v20) & 3;
          if ( !v35 )
          {
            v36 = v20;
LABEL_38:
            *(_WORD *)(v19 + 26) = v21 | *(_WORD *)(v19 + 26) & 0xFFF0;
            *(_WORD *)(v19 + 24) = (*((_BYTE *)v47 + 40) << 12) | *((_WORD *)v47 + 28) & 0xFFF;
            v40 = mbuf_len(v5);
            mbuf_setlen(v5, v22 + 28 - v36);
            v41 = v48 + mbuf_len(v5) - v40;
            *(_BYTE *)(v19 + 13) = v41;
            *(_BYTE *)(v19 + 12) = BYTE1(v41);
            return v5;
          }
          v36 = v20;
          if ( v35 == 1 )
          {
            *(_WORD *)v22 = 771;
            v37 = v22 + 2;
            v35 = 5;
            v38 = 3;
          }
          else
          {
            v37 = v22 + 2;
            v38 = v35 - 2;
            *(_BYTE *)v22 = 3;
            *(_BYTE *)(v22 + 1) = v35 - 2;
            if ( v35 == 2 )
            {
LABEL_37:
              ++v21;
              v22 = v37;
              goto LABEL_38;
            }
          }
          v39 = (unsigned __int8)(v35 - 3) + 3LL;
          do
          {
            --v38;
            *(_BYTE *)v37++ = 0;
          }
          while ( v38 );
          v37 = v39 + v22;
          goto LABEL_37;
        }
      }
      v45 = (unsigned __int16)(*((_WORD *)v4 + 180) + 2);
      v25 = IO80211AWDLPeerManager::buildDataPathStateTlv(v4, (unsigned __int8 *)(v24 + v19 + 32), 1);
      v26 = v25;
      if ( v25 )
      {
        v27 = v20 + 128 - v22;
        if ( v25 < v27 )
        {
          *(_BYTE *)(v19 + v45 + 30) = 12;
          *(_BYTE *)(v19 + v45 + 31) = v25;
          v21 = 2;
          v22 = v19 + v45 + 30 + (unsigned int)v25 + 2;
          goto LABEL_22;
        }
      }
      else
      {
        v27 = v20 + 128 - v22;
      }
      LODWORD(v43) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)v4 + 56LL))(v4);
      v44 = OSMetaClass::getClassName(v43);
      IO80211PeerManager::logDebug(
        v4,
        "%s::%s not enough space to add data path TLV (%d, remaining) %u",
        v44,
        (__int64)"adjustAwdlSnapHeader",
        v26,
        (unsigned int)v27);
      return v5;
    }
LABEL_22:
    if ( !v46 )
      goto LABEL_29;
    goto LABEL_23;
  }
  LODWORD(v10) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
  v11 = OSMetaClass::getClassName(v10);
  LODWORD(v12) = mbuf_maxlen(v5);
  IO80211PeerManager::logDebug(
    this,
    "%s::%s adjusting awdl mbuf, and too short %lu\n",
    v11,
    (__int64)"adjustAwdlSnapHeader",
    v12,
    v13);
  return v5;
}
// C8B00: using guessed type int __fastcall ifnet_get_sndq_len(_QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C30: using guessed type int __fastcall mbuf_get_traffic_class(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C50: using guessed type int __fastcall mbuf_maxlen(_QWORD);
// C8CB0: using guessed type int __fastcall mbuf_setlen(_QWORD, _QWORD);

//----- (000000000002FED2) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::buildEnhDataRateTlv(IO80211AWDLPeerManager *this, unsigned __int8 *a2)
{
  memset(a2, 0, 2uLL);
  memcpy(a2 + 2, (char *)this + 334, *((_DWORD *)this + 90));
  return (unsigned int)(*((_DWORD *)this + 90) + 2);
}

//----- (000000000002FF12) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::buildDataPathStateTlv(IO80211AWDLPeerManager *this, unsigned __int8 *a2, char a3)
{
  char v3; // r15@1
  IO80211AWDLPeerManager *v4; // rbx@1
  IO80211VirtualInterface *v5; // rdi@1
  __int16 v6; // cx@2
  __int16 v7; // ax@4
  __int16 v8; // cx@7
  __int16 v9; // r12@10
  __int16 v10; // r14@12
  signed __int64 v11; // r15@12
  __int16 v12; // r12@15
  char v14; // [sp+0h] [bp-2Ch]@12

  v3 = a3;
  v4 = this;
  v5 = (IO80211VirtualInterface *)*((_QWORD *)this + 16);
  if ( v5 )
    v6 = 32 * (unsigned __int8)IO80211VirtualInterface::dualBandCapable(v5);
  else
    v6 = 0;
  v7 = v6 | 0x40;
  if ( !*((_DWORD *)v4 + 992) )
    v7 = v6;
  if ( *((_BYTE *)v4 + 7441) )
  {
    v8 = v7 | 0x400;
    if ( !*((_DWORD *)v4 + 1012) )
      v8 = v7;
    v7 = v8;
  }
  v9 = v7 | 0x80;
  if ( !*((_DWORD *)v4 + 1883) )
    v9 = v7;
  memcpy(a2 + 2, (char *)v4 + 1456, 4uLL);
  v10 = v9 | 0x300;
  *(_WORD *)(a2 + 5) = *((_BYTE *)v4 + 1534);
  v14 = v3;
  v11 = 7LL;
  if ( v14 & 1 && *((_DWORD *)v4 + 26) )
  {
    memcpy(a2 + 7, (char *)v4 + 112, 6uLL);
    *(_WORD *)(a2 + 13) = *((_WORD *)v4 + 52);
    if ( !memcmp((char *)v4 + 118, (char *)v4 + 3680, 6uLL) )
    {
      v11 = 15LL;
      v12 = v9 | 0x301;
    }
    else
    {
      v12 = v9 | 0x303;
      memcpy(a2 + 15, (char *)v4 + 118, 6uLL);
      v11 = 21LL;
    }
    v10 = v12;
  }
  if ( v14 & 4 )
  {
    v10 |= 4u;
    memcpy(&a2[v11], (char *)v4 + 3680, 6uLL);
    v11 = (unsigned int)(v11 + 6);
  }
  if ( v14 & 0x10 && *((_WORD *)v4 + 3801) )
  {
    v10 |= 0x10u;
    a2[v11] = *((_BYTE *)v4 + 7584);
    a2[(unsigned int)(v11 + 1)] = *((_BYTE *)v4 + 7605);
    a2[(unsigned int)(v11 + 2)] = *((_BYTE *)v4 + 7604);
    memcpy(&a2[v11 + 3], (char *)v4 + 7606, *((_BYTE *)v4 + 7584));
    LODWORD(v11) = v11 + *((_BYTE *)v4 + 7584) + 3;
  }
  *(_WORD *)a2 = v10;
  return (unsigned int)v11;
}

//----- (00000000000300D6) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::build11zServiceRequests(IO80211AWDLPeerManager *this)
{
  return 0LL;
}

//----- (00000000000300DE) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::masterReport(IO80211PeerManager *this, void *a2, int a3)
{
  int v3; // er14@1
  OSMetaClass *v4; // rax@8
  __int64 v5; // ST90_8@8
  int v6; // ST8C_4@8
  int v7; // ST88_4@8
  int v8; // ST84_4@8
  int v9; // ST80_4@8
  int v10; // ST7C_4@8
  int v11; // ST78_4@8
  int v12; // ST68_4@8
  int v13; // ST60_4@8
  int v14; // ST58_4@8
  int v15; // ST50_4@8
  int v16; // ST48_4@8
  int v17; // ST40_4@8
  int v18; // ST38_4@8
  __int64 result; // rax@12
  __int64 v20; // r14@16
  __int64 v21; // rax@16
  signed __int128 v22; // t2@16
  OSMetaClass *v23; // rax@17
  __int64 v24; // rax@17
  int v25; // ST20_4@17
  int v26; // ST18_4@17
  int v27; // ST10_4@17
  int v28; // ST08_4@17
  int v29; // ST00_4@17

  v3 = a3;
  if ( *((_DWORD *)this + 372) != a3 )
    *((_QWORD *)this + 940) = getAbsoluteTime();
  if ( !a2 || !memcmp(&null_address, a2, 6uLL) )
    goto LABEL_20;
  if ( memcmp((char *)this + 7387, a2, 6uLL) && memcmp((char *)this + 3680, a2, 6uLL) )
  {
    if ( IO80211PeerManager::shouldLog(this, 0x10000000LL) )
    {
      LODWORD(v4) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                      this,
                      0x10000000LL);
      v5 = OSMetaClass::getClassName(v4);
      v6 = *((_DWORD *)this + 372);
      v7 = *((_BYTE *)this + 7387);
      v8 = *((_BYTE *)this + 7388);
      v9 = *((_BYTE *)this + 7389);
      v10 = *((_BYTE *)this + 7390);
      v11 = *((_BYTE *)this + 7391);
      v12 = *((_BYTE *)a2 + 5);
      v13 = *((_BYTE *)a2 + 4);
      v14 = *((_BYTE *)a2 + 3);
      v15 = *((_BYTE *)a2 + 2);
      v16 = *((_BYTE *)a2 + 1);
      v17 = *(_BYTE *)a2;
      v18 = *((_BYTE *)this + 7392);
      IO80211PeerManager::logDebug(
        this,
        0x10000000LL,
        "%s::%s %llu.%03llu state %u set pending [%02X:%02X:%02X:%02X:%02X:%02X] -> [%02X:%02X:%02X:%02X:%02X:%02X]\n",
        v5,
        (__int64)"masterReport",
        (unsigned __int64)(19342813113834067LL * (unsigned __int128)(*((_QWORD *)this + 939) >> 9) >> 64) >> 11);
    }
    if ( memcmp((char *)this + 7387, (char *)this + 3680, 6uLL) )
      memcpy((char *)this + 7387, a2, 6uLL);
    *((_BYTE *)this + 7386) = 1;
  }
  result = (__int64)memcpy((char *)this + 3686, a2, 6uLL);
  if ( !v3 )
  {
LABEL_20:
    a2 = 0LL;
    result = (__int64)memset((char *)this + 3686, 0, 4uLL);
  }
  *((_DWORD *)this + 372) = v3;
  if ( *((_BYTE *)this + 7386) && *((_QWORD *)this + 16) )
  {
    v20 = *((_QWORD *)this + 939);
    v21 = getAbsoluteTime();
    v22 = 4835703278458516699LL * (v21 - v20);
    result = 4835703278458516699LL * (v21 - v20);
    if ( (unsigned int)(*((_QWORD *)&v22 + 1) >> 18) >= 0x2711 )
    {
      *((_QWORD *)this + 939) = getAbsoluteTime();
      LODWORD(v23) = (*(int (__fastcall **)(IO80211PeerManager *, void *))(*(_QWORD *)this + 56LL))(this, a2);
      v24 = OSMetaClass::getClassName(v23);
      v25 = *((_BYTE *)this + 3691);
      v26 = *((_BYTE *)this + 3690);
      v27 = *((_BYTE *)this + 3689);
      v28 = *((_BYTE *)this + 3688);
      v29 = *((_BYTE *)this + 3687);
      IO80211PeerManager::logDebug(
        this,
        0x10000000LL,
        "%s::%s Top Master change (%02X:%02X:%02X:%02X:%02X:%02X). Last change %u ms ago.\n",
        v24,
        (__int64)"masterReport",
        *((_BYTE *)this + 3686));
      result = IO80211VirtualInterface::postNewMasterElected(
                 *((IO80211VirtualInterface **)this + 16),
                 (__ifnet *)0x10000000);
      *((_BYTE *)this + 7386) = 0;
    }
  }
  return result;
}
// 77FDC: using guessed type int null_address;

//----- (0000000000030408) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::seq2Channel(IO80211AWDLPeerManager *this, unsigned int a2)
{
  unsigned int v2; // er8@1
  unsigned int v3; // ecx@1
  unsigned int v4; // er9@2
  int v5; // esi@2
  unsigned int v6; // eax@5

  v2 = *((_BYTE *)this + 7584);
  v3 = 0;
  if ( *((_BYTE *)this + 7584) )
  {
    v4 = a2 % *((_WORD *)this + 3801);
    v5 = *((_BYTE *)this + 7605);
    if ( !*((_BYTE *)this + 7605) || (v3 = *((_BYTE *)this + 7601), v3 == 255) || !(v4 % (v5 + 1)) )
    {
      v6 = v4 / (v5 + 1);
      if ( v6 >= v2 )
        v6 %= v2;
      v3 = *((_BYTE *)this + v6 + 7606);
    }
  }
  return v3;
}

//----- (0000000000030478) ----------------------------------------------------
char __fastcall IO80211AWDLPeerManager::reportDataPathEvents(IO80211AWDLPeerManager *this, __int64 a2, void *a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // r12@1
  void *v7; // r14@1
  __int64 v8; // r15@1
  char v9; // bl@1
  __int64 v10; // rax@6
  signed __int64 v11; // rsi@6
  IO80211CommandQueue *v12; // rdi@9
  __int64 v13; // r14@10
  OSMetaClass *v14; // rax@12
  __int64 v15; // rcx@12
  __int64 v16; // r9@12
  __int64 v17; // rbx@18
  unsigned int v18; // edx@22
  __int64 v19; // r9@23
  __int64 v21; // rsi@30
  unsigned __int64 v22; // rbx@31
  unsigned __int32 v23; // er12@32
  __int64 v24; // r13@32
  __int64 v25; // rdi@32
  __int64 v26; // rsi@32
  int v27; // ST1B8_4@32
  __int64 v28; // rcx@32
  __int64 v29; // r8@34
  __int64 v30; // r9@34
  const char *v31; // rdx@34
  IO80211PeerManager *v32; // rdi@34
  int v33; // er13@35
  int v34; // er12@35
  int v35; // ST194_4@35
  int v36; // ST190_4@35
  int v37; // ST18C_4@35
  int v38; // ST188_4@35
  int v39; // ST184_4@35
  int v40; // ST180_4@35
  int v41; // ST178_4@35
  __int64 v42; // rbx@36
  __int64 v43; // r13@36
  unsigned __int64 v44; // r12@36
  __int64 v45; // r9@37
  __int64 v46; // rcx@37
  __int64 v47; // r8@39
  int v48; // ST50_4@39
  int v49; // ST48_4@39
  int v50; // ST40_4@39
  const char *v51; // rdx@39
  __int64 v52; // rsi@39
  __int64 v53; // r9@39
  __int64 v54; // rcx@43
  IO80211VirtualInterface *v55; // rdi@45
  OSMetaClass *v56; // rax@47
  __int64 v57; // rdx@47
  __int64 v58; // r8@47
  __int64 v59; // rdx@49
  __int64 v60; // rcx@49
  __int64 v61; // r8@49
  __int64 v62; // r9@49
  unsigned int v63; // eax@49
  OSMetaClass *v64; // rax@52
  __int64 v65; // rdx@52
  __int64 v66; // r8@52
  __int64 v67; // r9@52
  const char *v68; // rsi@52
  __int64 v69; // rax@53
  signed __int64 v70; // rsi@53
  int v71; // ebx@54
  OSMetaClass *v72; // rax@58
  __int64 v73; // rax@58
  __int64 v74; // r9@58
  unsigned int v75; // esi@58
  OSMetaClass *v76; // rax@60
  __int64 v77; // rcx@60
  __int64 v78; // r9@60
  OSMetaClass *v79; // rax@63
  int v80; // ST20_4@72
  int v81; // ST18_4@72
  int v82; // ST10_4@72
  __int64 v83; // r14@74
  __int64 v84; // rcx@74
  __int64 v85; // r8@74
  unsigned int v86; // edx@74
  __int64 v87; // r9@76
  char *v88; // rsi@78
  unsigned int v89; // eax@78
  int v90; // ecx@81
  int v91; // edx@84
  unsigned int v92; // eax@84
  __int64 v93; // rbx@86
  __int64 v94; // rbx@89
  __int64 v95; // rax@96
  int v96; // eax@101
  OSMetaClass *v97; // rax@104
  __int64 v98; // rax@104
  int v99; // ebx@104
  OSMetaClass *v100; // rax@105
  __int64 v101; // rax@105
  __int64 v102; // r9@105
  int v103; // esi@107
  unsigned __int64 v104; // rdi@109
  unsigned __int64 v105; // rbx@109
  OSMetaClass *v106; // rax@112
  __int64 v107; // rax@112
  __int64 v108; // r8@112
  __int64 v109; // r9@112
  int v110; // ST18_4@118
  int v111; // ST10_4@118
  int v112; // ST08_4@118
  void *v113; // ST1B8_8@120
  __int64 v114; // rbx@120
  unsigned __int64 v115; // r13@120
  int v116; // ST198_4@120
  int v117; // ST194_4@120
  int v118; // ST190_4@120
  int v119; // ST18C_4@120
  int v120; // ST188_4@120
  int v121; // ST184_4@120
  int v122; // ST180_4@120
  unsigned int v123; // eax@120
  __int64 v124; // r9@122
  __int64 v125; // rcx@122
  __int64 v126; // ST170_8@124
  __int64 v127; // ST168_8@124
  int v128; // ST134_4@124
  int v129; // ST130_4@124
  int v130; // ST12C_4@124
  int v131; // ecx@124
  __int64 v132; // rcx@125
  __int64 v133; // ST170_8@127
  int v134; // ST158_4@127
  int v135; // ST150_4@127
  int v136; // ST148_4@127
  int v137; // ebx@127
  int v138; // ST11C_4@124
  int v139; // ST118_4@124
  int v140; // ST114_4@124
  int v141; // ST110_4@124
  int v142; // ST10C_4@124
  int v143; // ST108_4@124
  int v144; // ST104_4@124
  int v145; // ST100_4@124
  int v146; // STFC_4@124
  int v147; // STE8_4@124
  int v148; // STE0_4@124
  int v149; // STD8_4@124
  int v150; // STD0_4@124
  int v151; // STC8_4@124
  int v152; // STC0_4@124
  int v153; // STB8_4@124
  int v154; // STB0_4@124
  int v155; // ST138_4@127
  int v156; // ST134_4@127
  int v157; // ST130_4@127
  int v158; // ST12C_4@127
  int v159; // ST120_4@127
  int v160; // ST11C_4@127
  int v161; // ST118_4@127
  int v162; // ST114_4@127
  int v163; // ST110_4@127
  int v164; // STC8_4@127
  int v165; // STC0_4@127
  int v166; // STB8_4@127
  int v167; // STB0_4@127
  int v168; // STA8_4@127
  int v169; // STA0_4@127
  int v170; // ST98_4@127
  int v171; // ST90_4@127
  int v172; // ST88_4@127
  int v173; // ST80_4@127
  __int64 v174; // rcx@128
  __int64 v175; // r8@128
  __int64 v176; // r9@128
  __int64 v177; // rbx@129
  int v178; // ST1B8_4@129
  __int64 v179; // ST1B0_8@129
  __int64 v180; // rbx@129
  __int64 v181; // ST1A8_8@129
  __int64 v182; // rbx@129
  unsigned __int64 v183; // r13@129
  __int64 v184; // rbx@129
  int v185; // ST08_4@129
  __int64 v186; // r8@131
  __int64 v187; // r9@131
  char *v188; // rbx@135
  __int64 v189; // r12@135
  char *v190; // r13@135
  __int64 v191; // rcx@135
  char *v192; // rcx@136
  int v193; // esi@137
  unsigned __int8 v194; // di@137
  unsigned int v195; // ebx@137
  unsigned int v196; // er12@137
  signed int v197; // er13@137
  int v198; // er13@145
  unsigned int v199; // edx@145
  __int64 v200; // r9@147
  __int64 v201; // rax@150
  int v202; // eax@153
  int v203; // [sp+160h] [bp-100h]@36
  int v204; // [sp+168h] [bp-F8h]@35
  int v205; // [sp+170h] [bp-F0h]@35
  unsigned __int64 v206; // [sp+178h] [bp-E8h]@120
  int v207; // [sp+198h] [bp-C8h]@35
  signed __int64 v208; // [sp+198h] [bp-C8h]@138
  int v209; // [sp+1A0h] [bp-C0h]@35
  int v210; // [sp+1A0h] [bp-C0h]@120
  int v211; // [sp+1A8h] [bp-B8h]@35
  int v212; // [sp+1A8h] [bp-B8h]@120
  const void *v213; // [sp+1B0h] [bp-B0h]@74
  int v214; // [sp+1B0h] [bp-B0h]@120
  int v215; // [sp+1B8h] [bp-A8h]@35
  unsigned __int32 v216[3]; // [sp+1B8h] [bp-A8h]@122
  int v217; // [sp+1C4h] [bp-9Ch]@9
  __int64 v218; // [sp+1C8h] [bp-98h]@104
  __int64 v219; // [sp+1D0h] [bp-90h]@104
  __int64 v220; // [sp+1D8h] [bp-88h]@104
  __int64 v221; // [sp+1E0h] [bp-80h]@104
  __int64 v222; // [sp+1E8h] [bp-78h]@104
  __int64 v223; // [sp+1F0h] [bp-70h]@104
  __int64 v224; // [sp+1F8h] [bp-68h]@104
  __int64 v225; // [sp+200h] [bp-60h]@104
  __int64 v226; // [sp+208h] [bp-58h]@104
  __int64 v227; // [sp+210h] [bp-50h]@104
  __int64 v228; // [sp+218h] [bp-48h]@104
  int v229; // [sp+220h] [bp-40h]@104
  int v230; // [sp+224h] [bp-3Ch]@104
  __int64 *v231; // [sp+228h] [bp-38h]@104

  v6 = a4;
  v7 = a3;
  v8 = (__int64)this;
  v9 = 0;
  if ( (signed int)a2 > 32 )
  {
    if ( (signed int)a2 > 40 )
    {
      switch ( (_DWORD)a2 )
      {
        case 0x29:
          if ( !a3 )
            goto LABEL_63;
          *((_DWORD *)this + 1899) = *((_DWORD *)a3 + 8);
          *(_QWORD *)((char *)this + 7588) = *((_QWORD *)a3 + 3);
          *((_BYTE *)this + 7585) = *((_BYTE *)this + 7592);
          v17 = IO80211PeerManager::getController(this);
          if ( v17 && !*((_DWORD *)this + 1895) )
          {
            if ( IO80211PeerManager::shouldLog(this, 16LL) && IO80211PeerManager::shouldVerboseLog(this, 16LL) )
            {
              v18 = *((_DWORD *)this + 1899);
              if ( BYTE1(v18) & 4 )
              {
                v19 = (__int64)"80MHz";
              }
              else
              {
                v19 = (__int64)"20MHz";
                if ( (v18 & 4) >> 2 )
                  v19 = (__int64)"40MHz";
              }
              v110 = *((_DWORD *)this + 27);
              v111 = *((_DWORD *)this + 26);
              v112 = *((_BYTE *)this + 7585);
              IO80211PeerManager::logDebug(
                this,
                16LL,
                "set Current Channel %u flags 0x%x (%s %s), current (%x) infra %u flags 0x%x\n",
                *((_DWORD *)this + 1898),
                v18,
                v19);
            }
            IO80211Controller::setCurrentChannel(v17, (__int64)((char *)this + 7588));
          }
          IO80211PeerManager::lockDataPath(this);
          v113 = (void *)*((_QWORD *)this + 936);
          getAbsoluteTime();
          v114 = *((_QWORD *)this + 936);
          v206 = (unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v114)) >> 64;
          v115 = getAbsoluteTime();
          *((_QWORD *)this + 936) = v115;
          v214 = *((_DWORD *)this + 196) - *((_DWORD *)this + 212);
          v212 = *((_DWORD *)this + 199) - *((_DWORD *)this + 224);
          v210 = *((_DWORD *)this + 200) - *((_DWORD *)this + 225);
          v116 = *((_DWORD *)this + 195) - *((_DWORD *)this + 211);
          v117 = *((_DWORD *)this + 201) - *((_DWORD *)this + 213);
          v118 = *((_DWORD *)this + 203) - *((_DWORD *)this + 215);
          v119 = *((_DWORD *)this + 206) - *((_DWORD *)this + 220);
          v120 = *((_DWORD *)this + 207) - *((_DWORD *)this + 221);
          v121 = *((_DWORD *)this + 202) - *((_DWORD *)this + 214);
          v122 = *((_DWORD *)this + 210) - *((_DWORD *)this + 216);
          *(_QWORD *)((char *)this + 1028) = 4294967297LL;
          *((_DWORD *)this + 360) = 0;
          v123 = *(_DWORD *)v7;
          *((_DWORD *)this + 367) = *(_DWORD *)v7;
          *((_DWORD *)this + 369) = v123 % ((*((_BYTE *)this + 7605) + 1) * (unsigned int)*((_BYTE *)this + 7584))
                                  / ((unsigned int)*((_BYTE *)this + 7605) + 1);
          if ( IO80211PeerManager::shouldLog(this, 0x2000LL) )
          {
            if ( IO80211PeerManager::shouldLog(this, 0x8000000LL) )
            {
              v216[0] = _byteswap_ulong(*((_DWORD *)v7 + 5));
              v124 = v216[0] - *((_DWORD *)this + 1870);
              v125 = (__int64)"start:";
              if ( *((_DWORD *)this + 372) == 1 )
                v125 = (__int64)"Start:";
              v126 = v125;
              v128 = *((_DWORD *)this + 367);
              v129 = *((_DWORD *)this + 369);
              v130 = *((_BYTE *)this + 7585);
              v131 = *((_DWORD *)this + 1899);
              v138 = *((_BYTE *)this + 1512);
              v139 = *((_BYTE *)this + 1518);
              v140 = *((_BYTE *)v7 + 14);
              v141 = *((_BYTE *)v7 + 15);
              v142 = *((_BYTE *)v7 + 16);
              v143 = *((_BYTE *)v7 + 17);
              v144 = *((_BYTE *)v7 + 18);
              v145 = *((_BYTE *)v7 + 19);
              v146 = *((_BYTE *)v7 + 8);
              v147 = *((_DWORD *)this + 255);
              v148 = *((_DWORD *)this + 226) - *((_DWORD *)this + 230);
              v149 = *((_DWORD *)this + 229) - *((_DWORD *)this + 217);
              v150 = *((_BYTE *)v7 + 13);
              v151 = *((_BYTE *)v7 + 12);
              v152 = *((_BYTE *)v7 + 11);
              v153 = *((_BYTE *)v7 + 10);
              v154 = *((_BYTE *)v7 + 9);
              v127 = 19342813113834067LL * (v115 >> 9) >> 64 >> 11;
              IO80211PeerManager::logDebug(
                this,
                134225920LL,
                "%s %llu.%03llu [%llu.%03llu] [fw: %u.%03u.%03u %u.%03u.%03u] sn=%03u/%02u ch=%u,%s,%s pm=%02u min=%03u TM= %02X:%02X:%02X:%02X:%02X:%02X mst=%02X:%02X:%02X:%02X:%02X:%02X act=%02u/%02u pkt %u ",
                v126,
                v127,
                4835703278458516699LL * (v115 - 1000000000 * v127) >> 64 >> 18);
              *((_DWORD *)this + 1870) = v216[0];
            }
            else
            {
              v132 = (__int64)"start:";
              if ( *((_DWORD *)this + 372) == 1 )
                v132 = (__int64)"Start:";
              v134 = *((_DWORD *)this + 367);
              v135 = *((_DWORD *)this + 369);
              v136 = *((_BYTE *)this + 7585);
              v137 = *((_DWORD *)this + 1899);
              v155 = *((_BYTE *)this + 1512);
              v156 = *((_BYTE *)this + 1518);
              v157 = *((_BYTE *)v7 + 14);
              v158 = *((_BYTE *)v7 + 15);
              v159 = *((_BYTE *)v7 + 16);
              v160 = *((_BYTE *)v7 + 17);
              v161 = *((_BYTE *)v7 + 18);
              v162 = *((_BYTE *)v7 + 19);
              v163 = *((_BYTE *)v7 + 8);
              v164 = *((_DWORD *)this + 934);
              v165 = *((_DWORD *)this + 932);
              v166 = *((_DWORD *)this + 255);
              v167 = *((_DWORD *)this + 226) - *((_DWORD *)this + 230);
              v168 = *((_DWORD *)this + 229) - *((_DWORD *)this + 217);
              v169 = *((_BYTE *)v7 + 13);
              v170 = *((_BYTE *)v7 + 12);
              v171 = *((_BYTE *)v7 + 11);
              v172 = *((_BYTE *)v7 + 10);
              v173 = *((_BYTE *)v7 + 9);
              v133 = 19342813113834067LL * (v115 >> 9) >> 64 >> 11;
              IO80211PeerManager::logDebug(
                this,
                0x2000LL,
                "%s %llu.%03llu [%llu.%03llu] sn=%03u/%02u ch=%u,%s,%s pr=%02u min=%03u TM= %02X:%02X:%02X:%02X:%02X:%02X mst=%02X:%02X:%02X:%02X:%02X:%02X act=%02u/%02u pkt %u met 0x%x private eid %u  ",
                v132,
                v133,
                4835703278458516699LL * (v115 - 1000000000 * v133) >> 64 >> 18);
            }
            IO80211PeerManager::logDebug(
              this,
              0x2000LL,
              "[i%u(%u,%u)/%u/%u o%u(%u,%u)/%u/%u]",
              (unsigned int)v214,
              (unsigned int)v212,
              (unsigned int)v210);
            if ( IO80211PeerManager::shouldVerboseLog(this, 0x2000LL) )
            {
              v177 = *((_QWORD *)this + 124);
              v178 = (v177 != 0) | 2 * (*((_QWORD *)this + 125) != 0LL) | 4 * (*((_QWORD *)this + 490) != 0LL) | 8 * (*((_QWORD *)this + 493) != 0LL);
              v179 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v177)) >> 64) >> 18;
              v180 = *((_QWORD *)this + 125);
              v181 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v180)) >> 64) >> 18;
              v182 = *((_QWORD *)this + 490);
              v183 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v182)) >> 64) >> 18;
              v184 = *((_QWORD *)this + 493);
              v185 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v184)) >> 64) >> 18;
              IO80211PeerManager::logDebug(
                this,
                549755822080LL,
                "- [%x] uTx %u(ms) uRx %u(ms) stateChange %u(ms) unquiet %u(ms)\n",
                (unsigned int)v178,
                v179,
                v181);
            }
            else
            {
              IO80211PeerManager::logDebug(this, 549755822080LL, "\n", v174, v175, v176);
            }
          }
          v186 = *((_DWORD *)this + 369);
          v187 = *((_BYTE *)this + v186 + 7606);
          if ( (_DWORD)v187 != *((_BYTE *)this + 7585) )
          {
            IO80211PeerManager::logDebug(
              this,
              0x2000LL,
              "AWDL SANITY FAILURE: Channel mismatch at sequence(%u:%u), expected %u, got %u",
              *((_DWORD *)this + 367),
              v186,
              v187);
            ++*((_DWORD *)this + 1864);
          }
          if ( *((_BYTE *)this + 1484) )
          {
            IO80211PeerManager::logDebug(
              this,
              0x2000LL,
              "AWDL SANITY FAILURE: Back to Back start events.  Sequence(%u), previous(%u)\n",
              *((_DWORD *)this + 367),
              *((_DWORD *)this + 368),
              v187);
            ++*((_DWORD *)this + 1863);
          }
          v188 = (char *)this + 788;
          v189 = (__int64)((char *)this + 816);
          v190 = (char *)this + 872;
          *((_BYTE *)this + 1484) = 1;
          v191 = *((_DWORD *)this + 368);
          if ( (_DWORD)v191 == *((_DWORD *)this + 367) )
          {
            IO80211PeerManager::logDebug(
              this,
              0x2000LL,
              "AWDL SANITY FAILURE: Back to Back sequence numbers: %u\n",
              v191,
              v186,
              v187);
            ++*((_DWORD *)this + 1866);
            v192 = (char *)this + 1480;
            goto LABEL_150;
          }
          v193 = *((_DWORD *)this + 369);
          v194 = *((_BYTE *)this + 7584);
          v195 = 0;
          v196 = (*(_DWORD *)(v8 + 1480) + 1) % (unsigned int)*(_BYTE *)(v8 + 7584);
          v197 = 1;
          if ( v196 == v193 )
          {
            v208 = v8 + 1480;
          }
          else
          {
            v208 = v8 + 1480;
            do
            {
              if ( *(_BYTE *)(v8 + v196 + 7606) )
              {
                IO80211PeerManager::logDebug(
                  (IO80211PeerManager *)v8,
                  0x2000LL,
                  "skipped channel %u(%u),  ",
                  *(_BYTE *)(v8 + v196 + 7606),
                  v196,
                  v187);
                ++v195;
                v194 = *(_BYTE *)(v8 + 7584);
                v193 = *(_DWORD *)(v8 + 1476);
              }
              ++v197;
              v196 = (v196 + 1) % v194;
            }
            while ( v196 != v193 );
            if ( v195 )
            {
              IO80211PeerManager::logDebug(
                (IO80211PeerManager *)v8,
                0x2000LL,
                "AWDL SANITY FAILURE: Skipped %u AW start events\n",
                v195,
                v186,
                v187);
              *(_DWORD *)(v8 + 7468) += v195;
              v189 = v8 + 816;
              goto LABEL_149;
            }
          }
          v198 = *(_BYTE *)(v8 + 1512) * *(_DWORD *)(v8 + 1496) * v197;
          v199 = -((v206 >> 18) - v198);
          if ( (signed int)v199 < 1 )
            v199 = (v206 >> 18) - v198;
          v200 = *(_DWORD *)(v8 + 7444);
          v189 = v8 + 816;
          if ( v199 > (unsigned int)v200 )
          {
            ++*(_DWORD *)(v8 + 7460);
            IO80211PeerManager::logDebug(
              (IO80211PeerManager *)v8,
              0x2000LL,
              "AWDL SANITY FAILURE: Time between AW starts (%u ms) is outside of tolerance(%u +/- %u ms)\n",
              v206 >> 18,
              (unsigned int)v198,
              v200);
          }
LABEL_149:
          v190 = (char *)(v8 + 872);
          v188 = (char *)(v8 + 788);
          v192 = (char *)v208;
LABEL_150:
          *(_DWORD *)(v8 + 1472) = *(_DWORD *)(v8 + 1468);
          *(_DWORD *)v192 = *(_DWORD *)(v8 + 1476);
          *(_DWORD *)(v8 + 844) = *(_DWORD *)(v8 + 780);
          *(_DWORD *)(v8 + 848) = *(_DWORD *)(v8 + 784);
          memcpy((void *)(v8 + 888), v188, 0x10uLL);
          *(_DWORD *)(v8 + 852) = *(_DWORD *)(v8 + 804);
          *(_DWORD *)(v8 + 856) = *(_DWORD *)(v8 + 808);
          *(_DWORD *)(v8 + 860) = *(_DWORD *)(v8 + 812);
          memcpy(v190, (const void *)v189, 0x10uLL);
          *(_DWORD *)(v8 + 864) = *(_DWORD *)(v8 + 840);
          *(_DWORD *)(v8 + 920) = *(_DWORD *)(v8 + 904);
          *(_DWORD *)(v8 + 868) = *(_DWORD *)(v8 + 916);
          IO80211PeerManager::unlockDataPath((IO80211PeerManager *)v8, v189);
          (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v8 + 640) + 464LL))(
            *(_QWORD *)(v8 + 640),
            *(_DWORD *)(v8 + 3640));
          IO80211AWDLPeerManager::masterReport((IO80211PeerManager *)v8, (char *)v7 + 14, *((_DWORD *)v7 + 1));
          v201 = *(_QWORD *)(v8 + 8128);
          if ( v201 )
            (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v8 + 4936) + 464LL))(
              *(_QWORD *)(v8 + 4936),
              *(_BYTE *)(v201 + 1857));
          if ( *(_BYTE *)(v8 + 7442) )
          {
            v202 = *(_DWORD *)(v8 + 7528);
            if ( _bittest((const unsigned int *)&v202, *(_DWORD *)(v8 + 1476)) )
            {
              *(_QWORD *)(v8 + 7496) = getAbsoluteTime();
              (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v8 + 4944) + 464LL))(
                *(_QWORD *)(v8 + 4944),
                (unsigned int)(*(_DWORD *)(v8 + 3640) + 5));
            }
          }
          return 0;
        default:
          return ((int (__fastcall *)(IO80211AWDLPeerManager *, __int64, void *, __int64))`vtable for'IO80211PeerManager[62])(
                   this,
                   a2,
                   a3,
                   a4);
        case 0x42:
          return v9;
        case 0x2A:
          if ( a3 )
          {
            v21 = 0x4000LL;
            if ( IO80211PeerManager::shouldLog(this, 0x4000LL) )
            {
              v22 = getAbsoluteTime();
              if ( IO80211PeerManager::shouldLog(this, 0x8000000LL) )
              {
                v23 = _byteswap_ulong(*((_DWORD *)v7 + 1));
                v24 = *((_QWORD *)this + 936);
                v25 = getAbsoluteTime() - v24;
                v26 = v23 - *(_DWORD *)(v8 + 7480);
                v27 = *(_DWORD *)(v8 + 1440);
                v28 = (__int64)"xten:";
                if ( *(_DWORD *)(v8 + 1488) == 1 )
                  v28 = (__int64)"Xten:";
                v29 = 19342813113834067LL * (v22 >> 9) >> 64 >> 11;
                v30 = 4835703278458516699LL * (v22 - 1000000000 * v29) >> 64 >> 18;
                v31 = "%s %llu.%03llu [%llu.%03llu] [fw: %u.%03u.%03u %u.%03u.%03u] eid=%u\n";
                v21 = 134234112LL;
                v32 = (IO80211PeerManager *)v8;
              }
              else
              {
                v103 = *((_DWORD *)this + 360);
                v28 = (__int64)"xten:";
                if ( *((_DWORD *)this + 372) == 1 )
                  v28 = (__int64)"Xten:";
                v104 = 19342813113834067LL * (v22 >> 9) >> 64 >> 11;
                v105 = 4835703278458516699LL * (v22 - 1000000000 * v104) >> 64 >> 18;
                v31 = " %s %llu.%03llu sn=%u\n";
                v21 = 0x4000LL;
                v29 = v104;
                v32 = (IO80211PeerManager *)v8;
                v30 = v105;
              }
              IO80211PeerManager::logDebug(v32, v21, v31, v28, v29, v30);
            }
            if ( !*(_DWORD *)(v8 + 1028) )
            {
              LODWORD(v106) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v8 + 56LL))(v8, v21);
              v107 = OSMetaClass::getClassName(v106);
              IO80211PeerManager::logDebug(
                (IO80211PeerManager *)v8,
                "%s::%s APPLE80211_M_AWDL_AVAILABILITY_WINDOW_EXTENSION_START and not available\n",
                v107,
                (__int64)"reportDataPathEvents",
                v108,
                v109);
              *(_QWORD *)(v8 + 1028) = 4294967297LL;
            }
            *(_DWORD *)(v8 + 1440) = *(_DWORD *)v7;
            return 0;
          }
LABEL_63:
          LODWORD(v79) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
          v65 = OSMetaClass::getClassName(v79);
          v68 = "%s::%s APPLE80211_M_AWDL_AVAILABILITY_WINDOW_START no param!!\n";
LABEL_64:
          IO80211PeerManager::logDebug(this, v68, v65, (__int64)"reportDataPathEvents", v66, v67);
          return 1;
        case 0x2B:
          IO80211PeerManager::lockDataPath(this);
          *((_BYTE *)this + 1484) = 0;
          v204 = *((_DWORD *)this + 207);
          v205 = *((_DWORD *)this + 221);
          v215 = *((_DWORD *)this + 196) - *((_DWORD *)this + 212);
          v207 = *((_DWORD *)this + 199) - *((_DWORD *)this + 224);
          v33 = *((_DWORD *)this + 200) - *((_DWORD *)this + 225);
          v34 = *((_DWORD *)this + 195) - *((_DWORD *)this + 211);
          v35 = *((_DWORD *)this + 201) - *((_DWORD *)this + 213);
          v211 = *((_DWORD *)this + 203) - *((_DWORD *)this + 215);
          v209 = *((_DWORD *)this + 206) - *((_DWORD *)this + 220);
          v36 = *((_DWORD *)this + 202) - *((_DWORD *)this + 214);
          v37 = *((_DWORD *)this + 210) - *((_DWORD *)this + 216);
          v38 = *((_DWORD *)this + 233) - *((_DWORD *)this + 237);
          v39 = *((_DWORD *)this + 234) - *((_DWORD *)this + 238);
          v40 = *((_DWORD *)this + 236) - *((_DWORD *)this + 240);
          v41 = *((_DWORD *)this + 235) - *((_DWORD *)this + 239);
          if ( IO80211PeerManager::shouldLog(this, 0x2000LL) )
          {
            v203 = v33;
            v42 = *((_QWORD *)this + 936);
            v43 = getAbsoluteTime() - v42;
            v44 = getAbsoluteTime();
            if ( IO80211PeerManager::shouldLog(this, 0x8000000LL) )
            {
              v45 = _byteswap_ulong(*((_DWORD *)v7 + 1)) - *((_DWORD *)this + 1870);
              v46 = (__int64)"end:";
              if ( *((_DWORD *)this + 372) == 1 )
                v46 = (__int64)"End:";
              v47 = 19342813113834067LL * (v44 >> 9) >> 64 >> 11;
              v48 = *((_DWORD *)this + 226) - *((_DWORD *)this + 230);
              v49 = *((_DWORD *)this + 229) - *((_DWORD *)this + 217);
              v50 = *((_DWORD *)this + 360);
              v51 = "%s %llu.%03llu [%llu.%03llu] [fw: %u.%03u.%03u %u.%03u.%03u] en=%02u act=%02u/%02u";
              v52 = 134225920LL;
              v53 = 4835703278458516699LL * (v44 - 1000000000 * v47) >> 64 >> 18;
            }
            else
            {
              v46 = (__int64)"end:";
              if ( *((_DWORD *)this + 372) == 1 )
                v46 = (__int64)"End:";
              v47 = 19342813113834067LL * (v44 >> 9) >> 64 >> 11;
              v53 = 4835703278458516699LL * (v44 - 1000000000 * v47) >> 64 >> 18;
              v80 = *((_DWORD *)this + 226) - *((_DWORD *)this + 230);
              v81 = *((_DWORD *)this + 229) - *((_DWORD *)this + 217);
              v82 = *((_DWORD *)this + 360);
              v51 = "%s %llu.%03llu [%llu.%03llu] en=%02u act=%02u/%02u";
              v52 = 0x2000LL;
            }
            IO80211PeerManager::logDebug(this, v52, v51, v46, v47, v53);
            IO80211PeerManager::logDebug(
              this,
              0x2000LL,
              " [i%u(%u,%u)/%u/%u o%u(%u,%u)/%u/%u] Q%u T%u O%u S%u\n",
              (unsigned int)v215,
              (unsigned int)v207,
              (unsigned int)v203);
          }
          v213 = (char *)this + 816;
          *((_DWORD *)this + 237) = *((_DWORD *)this + 233);
          *((_DWORD *)this + 238) = *((_DWORD *)this + 234);
          *((_DWORD *)this + 240) = *((_DWORD *)this + 236);
          *((_DWORD *)this + 239) = *((_DWORD *)this + 235);
          v83 = *((_QWORD *)this + 936);
          v84 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v83)) >> 64) >> 18;
          v85 = *((_DWORD *)this + 374) * (unsigned int)*((_BYTE *)this + 1512);
          v86 = -(v84 - v85);
          if ( (signed int)v86 < 1 )
            v86 = v84 - v85;
          v87 = *((_DWORD *)this + 1861);
          if ( v86 > (unsigned int)v87 )
          {
            ++*((_DWORD *)this + 1862);
            IO80211PeerManager::logDebug(
              this,
              0x2000LL,
              "AWDL SANITY FAILURE: Time since AW start (%u ms) is outside of tolerance(%u +/- %u ms)\n",
              v84,
              v85,
              v87);
          }
          *((_DWORD *)this + 211) = *((_DWORD *)this + 195);
          *((_DWORD *)this + 212) = *((_DWORD *)this + 196);
          *((_DWORD *)this + 213) = *((_DWORD *)this + 201);
          memcpy((char *)this + 888, (char *)this + 788, 0x10uLL);
          *((_DWORD *)this + 214) = *((_DWORD *)this + 202);
          *((_DWORD *)this + 215) = *((_DWORD *)this + 203);
          *((_DWORD *)this + 216) = *((_DWORD *)this + 210);
          v88 = (char *)this + 816;
          memcpy((char *)this + 872, v213, 0x10uLL);
          *((_DWORD *)this + 230) = *((_DWORD *)this + 226);
          *((_DWORD *)this + 217) = *((_DWORD *)this + 229);
          IO80211PeerManager::unlockDataPath(this, (__int64)v213);
          v89 = *((_DWORD *)this + 1241);
          if ( !v89 )
            goto LABEL_96;
          if ( v211 >= v89 || (unsigned int)(v204 + v209 - v205) >= *((_DWORD *)this + 1242) )
          {
            *((_DWORD *)this + 1239) = 0;
            v90 = 0;
          }
          else
          {
            v90 = *((_DWORD *)this + 1239) + 1;
            *((_DWORD *)this + 1239) = v90;
          }
          if ( v215 >= v89 )
          {
            *((_DWORD *)this + 1240) = 0;
          }
          else
          {
            v91 = *((_DWORD *)this + 1240) + 1;
            *((_DWORD *)this + 1240) = v91;
            v92 = *((_BYTE *)this + 7584);
            if ( v91 > v92 && v90 > v92 )
            {
              v93 = *((_QWORD *)this + 490);
              if ( !v93
                || (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL
                                                                       * (getAbsoluteTime() - v93)) >> 64) >> 18) > *((_DWORD *)this + 1000) )
              {
                if ( !*((_DWORD *)this + 996)
                  || (v94 = *((_QWORD *)this + 493)) == 0
                  || (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL
                                                                         * (getAbsoluteTime() - v94)) >> 64) >> 18) > *((_DWORD *)this + 1005) )
                {
                  *((_DWORD *)this + 1243) = *((_DWORD *)this + 1004);
                  if ( !*((_DWORD *)this + 1245) )
                  {
                    v88 = (_BYTE *)(&dword_0 + 1);
                    IO80211AWDLPeerManager::setScheduleState(this, 1u, 0);
                  }
                  goto LABEL_96;
                }
              }
            }
          }
          if ( !__PAIR__(*((_DWORD *)this + 1240), *((_DWORD *)this + 1239)) )
          {
            v88 = 0LL;
            IO80211AWDLPeerManager::setAlwaysAvailable(this, 0);
          }
LABEL_96:
          v95 = IO80211PeerManager::getController(this);
          if ( *((_BYTE *)this + 1512) && v95 )
          {
            v88 = 0LL;
            IO80211Controller::setCurrentChannel(v95, 0LL);
          }
          if ( !*((_BYTE *)this + 7584) || !*((_BYTE *)this + 1512) )
            return 0;
          v96 = *((_DWORD *)this + 1245);
          v9 = 0;
          if ( !v96
            || ((unsigned int)*((_BYTE *)this + 1512) + *((_DWORD *)this + 367))
             % (*((_BYTE *)this + 1512) * (unsigned int)*((_BYTE *)this + 7584)) )
            return v9;
          if ( v96 != 3 )
          {
            if ( v96 == 2 )
              IO80211AWDLPeerManager::runPiggybackScanStateMachine(this);
            return 0;
          }
          LODWORD(v97) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, char *))(*(_QWORD *)this + 56LL))(this, v88);
          v98 = OSMetaClass::getClassName(v97);
          IO80211PeerManager::logDebug(
            this,
            0x400000LL,
            "%s::%s Sequence %u: PIGGYBACK scan machine complete, stopping and resuming normal operations\n",
            v98,
            (__int64)"reportDataPathEvents",
            *((_DWORD *)this + 367));
          v229 = -2144835128;
          v228 = 0LL;
          v227 = 0LL;
          v226 = 0LL;
          v225 = 0LL;
          v224 = 0LL;
          v223 = 0LL;
          v222 = 0LL;
          v221 = 0LL;
          v220 = 0LL;
          v219 = 0LL;
          v218 = 4294967297LL;
          v230 = 211;
          v231 = &v218;
          v99 = IO80211PeerManager::ioctl_internal(this, (__int64)&v229);
          if ( v99 )
          {
            LODWORD(v100) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(
                              this,
                              &v229);
            v101 = OSMetaClass::getClassName(v100);
            IO80211PeerManager::logDebug(
              this,
              "%s::%s  Unable to start piggyback scan %d\n",
              v101,
              (__int64)"reportDataPathEvents",
              (unsigned int)v99,
              v102);
          }
          *((_DWORD *)this + 1245) = 0;
          v9 = 0;
          v75 = 4;
LABEL_59:
          IO80211AWDLPeerManager::setScheduleState(this, v75, 0);
          return v9;
        case 0x2E:
          if ( a3 && !*(_DWORD *)a3 )
          {
            *((_BYTE *)this + 7396) &= 0xFDu;
            *((_DWORD *)this + 372) = 0;
            *((_DWORD *)this + 1245) = 0;
          }
          v54 = (__int64)"slv";
          if ( *((_DWORD *)this + 372) == 1 )
            v54 = (__int64)"mst";
          v9 = 0;
          IO80211PeerManager::logDebug(this, 0x800000LL, "%s \n", v54, a5, a6);
          v55 = (IO80211VirtualInterface *)*((_QWORD *)this + 16);
          if ( !v55 )
            return v9;
          IO80211VirtualInterface::postSyncStateChanged(v55);
          return 0;
        case 0x31:
          ((void (__fastcall *)(IO80211AWDLPeerManager *, signed __int64, void *, __int64))`vtable for'IO80211PeerManager[62])(
            this,
            49LL,
            a3,
            a4);
          LODWORD(v56) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
          v57 = OSMetaClass::getClassName(v56);
          v58 = (__int64)"complete";
          if ( !*(_DWORD *)v7 )
            v58 = (__int64)"in progress";
          IO80211PeerManager::logDebug(
            this,
            "%s::%s APPLE80211_M_RESET_INTERFACE received, chip reset %s stateFlags %X\n",
            v57,
            (__int64)"reportDataPathEvents",
            v58,
            *((_DWORD *)this + 1849));
          v63 = *(_DWORD *)v7;
          *((_DWORD *)this + 1851) = *(_DWORD *)v7;
          if ( !v63 )
          {
            if ( *((_BYTE *)this + 7396) & 1 )
              IO80211AWDLPeerManager::reset(this);
            return 0;
          }
          v9 = 0;
          IO80211PeerManager::logDebug(this, "chip reset completed! configuring AWDL!\n", v59, v60, v61, v62);
          if ( (unsigned int)IO80211AWDLPeerManager::configure(this) )
            return v9;
          *((_BYTE *)this + 96) = 0;
          v10 = *(_QWORD *)this;
          v11 = 6LL;
          break;
        case 0x32:
          LODWORD(v64) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
          v65 = OSMetaClass::getClassName(v64);
          v68 = "%s::%s APPLE80211_M_PEER_CREDIT_GRANT is not expected on AWDL\n";
          goto LABEL_64;
        case 0x33:
          v69 = (__int64)`vtable for'IO80211PeerManager;
          v70 = 51LL;
          goto LABEL_67;
        case 0x3A:
          v71 = *(_DWORD *)a3;
          IO80211PeerManager::lockDataPath(this);
          if ( v71 || !*((_BYTE *)this + 156) )
            *(_QWORD *)((char *)this + 1028) = 4294967297LL;
          else
            *(_QWORD *)((char *)this + 1028) = 0LL;
          IO80211PeerManager::unlockDataPath(this, a2);
          v69 = (__int64)`vtable for'IO80211PeerManager;
          v70 = 58LL;
LABEL_67:
          (*(void (__fastcall **)(IO80211AWDLPeerManager *, signed __int64, void *, __int64))(v69 + 496))(
            this,
            v70,
            v7,
            v6);
          return 0;
        case 0x3B:
          memcpy((char *)this + 3680, a3, 6uLL);
          return 0;
        case 0x3E:
          LODWORD(v72) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
          v73 = OSMetaClass::getClassName(v72);
          v9 = 0;
          IO80211PeerManager::logDebug(
            this,
            0x400000LL,
            "%s::%s Received pscan begin from driver\n",
            v73,
            (__int64)"reportDataPathEvents",
            v74);
          v75 = 10;
          goto LABEL_59;
        case 0x40:
          LODWORD(v76) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
          v77 = OSMetaClass::getClassName(v76);
          v78 = (__int64)"Start";
          if ( !v7 )
            v78 = (__int64)"End";
          v9 = 0;
          IO80211PeerManager::logDebug(
            this,
            0x800000LL,
            "%s::%s Tx calibration %s request\n",
            v77,
            (__int64)"reportDataPathEvents",
            v78);
          return v9;
      }
      goto LABEL_26;
    }
    if ( (_DWORD)a2 != 33 )
      return ((int (__fastcall *)(IO80211AWDLPeerManager *, __int64, void *, __int64))`vtable for'IO80211PeerManager[62])(
               this,
               a2,
               a3,
               a4);
    v217 = *((_DWORD *)a3 + 2);
    v12 = (IO80211CommandQueue *)*((_QWORD *)this + 477);
    if ( !v12 )
      return 0;
    v9 = 0;
    v13 = IO80211CommandQueue::lockMap(
            v12,
            (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_cleanOobFrame,
            v8,
            (__int64)&v217,
            0LL,
            -1);
    if ( v13 )
    {
      if ( IO80211PeerManager::shouldLog((IO80211PeerManager *)v8, 0x2000000LL) )
      {
        getAbsoluteTime();
        LODWORD(v14) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v8 + 56LL))(v8, 0x2000000LL);
        v15 = OSMetaClass::getClassName(v14);
        v16 = (__int64)"aftxc";
        if ( *(_DWORD *)(v8 + 1488) == 1 )
          v16 = (__int64)"AFTXC";
        IO80211PeerManager::logDebug(
          (IO80211PeerManager *)v8,
          0x2000000LL,
          "%s::%s %s %llu.%03llu %u\n",
          v15,
          (__int64)"reportDataPathEvents",
          v16);
      }
      IO80211ActionFrameDescriptor::freeResources((IO80211ActionFrameDescriptor *)v13, 1u);
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v13 + 40LL))(v13, 1LL);
      return 0;
    }
  }
  else
  {
    if ( (_DWORD)a2 == 4 )
    {
      v10 = *(_QWORD *)this;
      v11 = 5LL;
      goto LABEL_26;
    }
    if ( (_DWORD)a2 != 9 )
    {
      if ( (_DWORD)a2 == 11 )
      {
        if ( *((_BYTE *)this + 7396) & 1 )
        {
          v10 = *(_QWORD *)this;
          v11 = 11LL;
LABEL_26:
          (*(void (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(v10 + 320))(this, v11);
        }
        return 0;
      }
      return ((int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))`vtable for'IO80211PeerManager[62])(this, a2, a3, a4);
    }
  }
  return v9;
}
// 0: using guessed type int dword_0;
// 7D5B0: using guessed type __int64 `vtable for'IO80211PeerManager[2];

//----- (0000000000032268) ----------------------------------------------------
signed __int64 __fastcall _cleanOobFrame(__int64 a1, __int64 a2, __int64 a3)
{
  signed __int64 result; // rax@1

  result = 0LL;
  if ( *(_DWORD *)a3 == *(_DWORD *)(a2 + 68) )
  {
    *(_BYTE *)(a2 + 64) = 2;
    result = 5LL;
  }
  return result;
}

//----- (0000000000032280) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::logAF(IO80211PeerManager *this, __int64 a2, unsigned __int8 *a3, unsigned __int64 a4, char a5)
{
  unsigned __int64 v5; // r12@1
  __int64 v6; // r15@1
  IO80211PeerManager *v7; // r13@1
  int v8; // ST13C_4@9
  int v9; // ebx@9
  signed __int64 v10; // r14@9
  __int16 v11; // di@10
  __int16 v12; // si@10
  int v13; // edx@10
  __int64 v14; // rax@10
  __int64 v15; // rsi@13
  __int64 v16; // rax@13
  __int64 v17; // r14@20
  __int64 v18; // rcx@20
  __int64 v19; // rdx@22
  __int64 v20; // ST140_8@24
  __int64 v21; // r15@24
  unsigned __int64 v22; // rdx@24
  int v23; // STD4_4@24
  int v24; // STD0_4@24
  int v25; // er10@24
  int v26; // er11@24
  int v27; // er9@24
  int v28; // er8@24
  int v29; // edi@24
  const char *v30; // rdx@24
  __int64 v31; // rsi@24
  __int64 v32; // rcx@24
  IO80211PeerManager *v33; // rdi@24
  __int64 v34; // r8@24
  __int64 v35; // r9@24
  __int64 v36; // rcx@25
  __int64 v37; // rdx@27
  __int64 v38; // ST140_8@29
  __int64 v39; // rbx@29
  unsigned __int64 v40; // rsi@29
  int v41; // ST108_4@29
  int v42; // ST100_4@29
  int v43; // STF8_4@29
  int v44; // er11@29
  int v45; // er10@29
  int v46; // er9@29
  int v47; // er8@29
  __int64 v49; // [sp+110h] [bp-90h]@22
  __int64 v50; // [sp+110h] [bp-90h]@27
  unsigned __int64 v51; // [sp+130h] [bp-70h]@9
  char v52; // [sp+140h] [bp-60h]@1
  unsigned __int8 *v53; // [sp+148h] [bp-58h]@1
  char v54; // [sp+150h] [bp-50h]@13
  __int64 v55; // [sp+170h] [bp-30h]@1

  v52 = a5;
  v5 = a4;
  v53 = a3;
  v6 = a2;
  v7 = this;
  v55 = *(_QWORD *)off_7B078[0];
  if ( *(_BYTE *)(a2 + 6) && IO80211PeerManager::shouldLog(this, 0x1000000LL)
    || IO80211PeerManager::shouldLog(this, 0x40000LL) && *((_DWORD *)this + 257)
    || IO80211PeerManager::shouldLog(this, 0x80000LL) && !*((_DWORD *)this + 360) && *((_DWORD *)this + 257)
    || IO80211PeerManager::shouldLog(this, 0x800000000LL) )
  {
    v51 = getAbsoluteTime();
    v8 = *(_DWORD *)(a2 + 8) - *(_DWORD *)(a2 + 12);
    v9 = 0;
    v10 = 0LL;
    if ( v5 >= 0x3A )
    {
      v11 = *(_WORD *)(a2 + 20);
      v12 = *(_WORD *)(a2 + 34);
      v13 = *(_WORD *)(v6 + 48);
      v14 = *(_WORD *)(v6 + 17);
      v9 = 0;
      if ( v14 + 43 <= v5 )
      {
        v10 = v14 + v6 + 19;
        v9 = *(_WORD *)(v14 + v6 + 23);
      }
      else
      {
        v10 = 0LL;
      }
    }
    memset(&v54, 0, 0x20uLL);
    IO80211PeerManager::lockDataPath(v7);
    v15 = (__int64)v53;
    v16 = IO80211PeerManager::findPeer(v7, v53, 0);
    if ( v16 && *(_BYTE *)(v16 + 1728) )
    {
      v15 = v16 + 1728;
      strlcpy(&v54, (const char *)(v16 + 1728), 0x20uLL);
    }
    IO80211PeerManager::unlockDataPath(v7, v15);
    if ( v10 && v9 == *((_DWORD *)v7 + 929) || *((_DWORD *)v7 + 366) )
    {
      if ( IO80211PeerManager::shouldLog(v7, 0x8000000LL) )
      {
        v17 = _byteswap_ulong(*((_DWORD *)v53 + 12)) - *((_DWORD *)v7 + 1870);
        v18 = (__int64)"a";
        if ( *((_DWORD *)v7 + 372) == 1 )
          v18 = (__int64)"A";
        v49 = v18;
        v19 = (__int64)" ";
        if ( v52 )
          v19 = (__int64)"*";
        v20 = v19;
        *(_BYTE *)(v6 + 6);
        *((_DWORD *)v7 + 257);
        v21 = *((_QWORD *)v7 + 936);
        v22 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v21)) >> 64) >> 18;
        v23 = *((_DWORD *)v7 + 360);
        v24 = *v53;
        v25 = v53[1];
        v26 = v53[2];
        v27 = v53[3];
        v28 = v53[4];
        LODWORD(v21) = v53[5];
        v29 = *((_DWORD *)v53 + 11);
        v30 = "%s%s %llu.%03llu [fw: %u.%03u.%03u %u.%03u.%03u] %s%s phy=%03u/%03u/%04u (%04ums) xid %-3u sn %-6u from %02X:%02X:%02X:%02X:%02X:%02X rssi %d %s%s%s\n";
        v31 = 0x8000000LL;
        v32 = v49;
        v33 = v7;
        v34 = v20;
        v35 = 19342813113834067LL * (v51 >> 9) >> 64 >> 11;
      }
      else
      {
        v36 = (__int64)"a";
        if ( *((_DWORD *)v7 + 372) == 1 )
          v36 = (__int64)"A";
        v50 = v36;
        v37 = (__int64)" ";
        if ( v52 )
          v37 = (__int64)"*";
        v38 = v37;
        *(_BYTE *)(v6 + 6);
        *((_DWORD *)v7 + 257);
        v39 = *((_QWORD *)v7 + 936);
        v40 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v39)) >> 64) >> 18;
        v41 = *((_DWORD *)v7 + 360);
        v42 = *v53;
        v43 = v53[1];
        v44 = v53[2];
        LODWORD(v39) = v53[3];
        v45 = v53[4];
        v46 = v53[5];
        v47 = *((_DWORD *)v53 + 11);
        v30 = "%s%s %llu.%03llu %s%s phy=%03u/%03u/%04u (%04ums) sn=%u xid %-3u sn %-5u from %02X:%02X:%02X:%02X:%02X:%02X rssi %d %s%s%s\n";
        v31 = 0LL;
        v32 = v50;
        v33 = v7;
        v34 = v38;
        v35 = 19342813113834067LL * (v51 >> 9) >> 64 >> 11;
      }
      IO80211PeerManager::logDebug(v33, v31, v30, v32, v34, v35);
    }
  }
  return *(_QWORD *)off_7B078[0];
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000032906) ----------------------------------------------------
char __fastcall IO80211AWDLPeerManager::actionFrameHasCorrectOUI(IO80211PeerManager *this, __int64 a2, unsigned __int64 a3)
{
  unsigned __int64 v3; // r14@1
  char v4; // bl@5
  OSMetaClass *v5; // rax@6
  __int64 v6; // rax@6
  int v7; // ST20_4@6
  int v8; // ST18_4@6
  int v9; // ST10_4@6
  int v10; // ST08_4@6
  unsigned __int64 v11; // rbx@6
  __int64 v12; // rdx@6
  __int64 v13; // rcx@6
  __int64 v14; // r8@6
  __int64 v15; // r9@6
  unsigned __int64 v16; // r12@6
  signed int v17; // er14@7

  v3 = a3;
  if ( *(_BYTE *)(a2 + 1)
    || *(_BYTE *)(a2 + 2) != 23
    || *(_BYTE *)(a2 + 3) != 242
    || *(_BYTE *)(a2 + 4) != 8
    || (v4 = 1, !*(_BYTE *)(a2 + 5)) )
  {
    LODWORD(v5) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
    v6 = OSMetaClass::getClassName(v5);
    v7 = *(_BYTE *)(a2 + 5);
    v8 = *(_BYTE *)(a2 + 3);
    v9 = *(_BYTE *)(a2 + 2);
    v10 = *(_BYTE *)(a2 + 1);
    v11 = 0LL;
    IO80211PeerManager::logDebug(
      this,
      0x10000LL,
      "%s::%s bad oui (%p) len %lu [%02X %02X %02X] version %u\n",
      v6,
      (__int64)"actionFrameHasCorrectOUI",
      a2);
    v16 = v3;
    if ( v3 )
    {
      v17 = 1;
      do
      {
        IO80211PeerManager::logDebug(this, 0x10000LL, "%02x ", *(_BYTE *)(a2 + v11), v14, v15);
        v11 = (unsigned int)v17++;
      }
      while ( v11 < v16 );
    }
    v4 = 0;
    IO80211PeerManager::logDebug(this, "\n", v12, v13, v14, v15);
  }
  return v4;
}

//----- (0000000000032A0E) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::updateAFStats(__int64 a1, __int64 a2, char a3)
{
  ++*(_DWORD *)(a1 + 904);
  if ( *(_DWORD *)(a2 + 16) > 0xEu )
    ++*(_DWORD *)(a1 + 912);
  else
    ++*(_DWORD *)(a1 + 908);
  if ( a3 )
    ++*(_DWORD *)(a1 + 916);
}

//----- (0000000000032A38) ----------------------------------------------------
bool __usercall IO80211AWDLPeerManager::validCCForPeerLearning@<al>(IO80211AWDLPeerManager *this@<rdi>, unsigned __int8 *a2@<rsi>, __int64 a3@<rax>)
{
  bool v3; // bl@1
  __int64 v5; // [sp-4h] [bp-20h]@1

  v5 = a3;
  v3 = 0;
  memset((char *)&v5 + 5, 0, 3uLL);
  if ( memcmp(a2, (char *)&v5 + 5, 3uLL) )
    v3 = *a2 != 88;
  return v3;
}

//----- (0000000000032A86) ----------------------------------------------------
bool __fastcall IO80211AWDLPeerManager::actionFrameInput(IO80211AWDLPeerManager *this, __mbuf *a2, __int64 a3, void *a4, __int64 a5)
{
  __int64 v5; // r14@1
  __mbuf *v6; // r12@1
  __int64 v7; // rbx@1
  __int64 v8; // r13@1
  bool v9; // r15@1
  __int64 v10; // rsi@1
  __int64 v11; // r15@3
  __int64 v12; // rax@3
  OSMetaClass *v13; // rax@4
  __int64 v14; // rax@4
  __int64 v15; // r8@4
  __int64 v16; // r9@4
  unsigned __int64 v17; // rax@7
  unsigned __int64 v18; // r12@7
  __int64 i; // rdi@7
  __int64 v20; // rax@8
  __int64 v21; // rax@9
  unsigned __int64 v22; // rax@11
  __int64 v23; // rax@12
  OSMetaClass *v24; // rax@13
  __int64 v25; // rdi@13
  __int64 v26; // r15@13
  __int64 v27; // rax@13
  OSMetaClass *v28; // rax@14
  __int64 v29; // rax@14
  __int64 v30; // r9@14
  OSMetaClass *v31; // rax@15
  __int64 v32; // r12@15
  __int64 v33; // rax@15
  void *v34; // rax@16
  void *v35; // r15@16
  const void *v36; // rax@17
  const void *v37; // r13@17
  size_t v38; // rax@17
  __int64 v39; // rax@17
  __int64 v40; // rax@17
  __int64 v41; // rdi@18
  __int64 v42; // rax@20
  __int64 v43; // r15@20
  char v44; // al@20
  __int64 v45; // rdi@26
  __int64 v46; // rsi@26
  __int64 v47; // r12@26
  __int64 v48; // rbx@26
  __int64 v49; // rax@34
  OSMetaClass *v50; // rax@36
  __int64 v51; // rax@36
  __int64 v52; // rbx@36
  OSMetaClass *v53; // rax@40
  __int64 v54; // rax@40
  int v55; // er10@40
  int v56; // edx@40
  int v57; // esi@40
  int v58; // edi@40
  __int64 v59; // rbx@40
  OSMetaClass *v60; // rax@40
  __int64 v61; // rax@40
  OSMetaClass *v62; // rax@42
  __int64 v63; // rax@42
  int v64; // eax@50
  __int64 v66; // rdi@61
  __int64 v67; // rdi@63
  OSMetaClass *v68; // rax@73
  __int64 v69; // rax@73
  __int64 v70; // r9@73
  OSMetaClass *v71; // rax@77
  __int64 v72; // rax@77
  __int64 v73; // r9@77
  __int64 v74; // [sp+0h] [bp-250h]@0
  __int64 v75; // [sp+8h] [bp-248h]@0
  __int64 v76; // [sp+10h] [bp-240h]@0
  __int64 v77; // [sp+18h] [bp-238h]@0
  __int64 v78; // [sp+20h] [bp-230h]@0
  __int64 v79; // [sp+28h] [bp-228h]@0
  __int64 v80; // [sp+30h] [bp-220h]@0
  __mbuf *v81; // [sp+40h] [bp-210h]@0
  __int64 v82; // [sp+48h] [bp-208h]@20
  IO80211AWDLPeerManager *v83; // [sp+50h] [bp-200h]@7
  int v84; // [sp+50h] [bp-200h]@20
  ether_addr *v85; // [sp+58h] [bp-1F8h]@1
  char *v86; // [sp+60h] [bp-1F0h]@68
  __int64 v87; // [sp+68h] [bp-1E8h]@68
  __int64 v88; // [sp+70h] [bp-1E0h]@68
  __int64 v89; // [sp+78h] [bp-1D8h]@68
  __int64 v90; // [sp+80h] [bp-1D0h]@68
  __int64 v91; // [sp+88h] [bp-1C8h]@68
  __int64 v92; // [sp+90h] [bp-1C0h]@68
  __int64 v93; // [sp+98h] [bp-1B8h]@68
  __int64 v94; // [sp+A0h] [bp-1B0h]@68
  __int64 v95; // [sp+A8h] [bp-1A8h]@68
  int v96; // [sp+B4h] [bp-19Ch]@13
  __int64 v97; // [sp+B8h] [bp-198h]@7
  char v98; // [sp+C0h] [bp-190h]@69
  int v99; // [sp+F4h] [bp-15Ch]@69
  char v100[8]; // [sp+118h] [bp-138h]@40
  __int64 v101; // [sp+120h] [bp-130h]@40
  __mbuf *v102; // [sp+128h] [bp-128h]@40
  __int64 v103; // [sp+130h] [bp-120h]@40
  __int64 v104; // [sp+138h] [bp-118h]@40
  ether_addr *v105; // [sp+140h] [bp-110h]@40
  __int64 v106; // [sp+148h] [bp-108h]@50
  __int64 v107; // [sp+150h] [bp-100h]@50
  __int64 v108; // [sp+158h] [bp-F8h]@50
  __int64 v109; // [sp+160h] [bp-F0h]@50
  __int64 v110; // [sp+168h] [bp-E8h]@50
  __int64 v111; // [sp+170h] [bp-E0h]@50
  __int64 v112; // [sp+178h] [bp-D8h]@1
  ether_addr *v113; // [sp+180h] [bp-D0h]@26
  char v114; // [sp+188h] [bp-C8h]@43
  int v115; // [sp+18Ch] [bp-C4h]@31
  char v116; // [sp+199h] [bp-B7h]@41
  char v117; // [sp+19Ah] [bp-B6h]@38
  int v118; // [sp+19Ch] [bp-B4h]@40
  char v119; // [sp+1A0h] [bp-B0h]@42
  unsigned __int16 v120; // [sp+1A2h] [bp-AEh]@40
  int v121; // [sp+1D0h] [bp-80h]@66
  __int64 v122; // [sp+1D8h] [bp-78h]@60
  char v123[8]; // [sp+1E0h] [bp-70h]@1
  __int64 v124; // [sp+1E8h] [bp-68h]@1
  __int64 v125; // [sp+1F0h] [bp-60h]@1
  __int64 v126; // [sp+1F8h] [bp-58h]@1
  __int64 v127; // [sp+200h] [bp-50h]@1
  __int64 v128; // [sp+208h] [bp-48h]@1
  __int64 v129; // [sp+210h] [bp-40h]@1
  __int64 v130; // [sp+218h] [bp-38h]@1
  __int64 v131; // [sp+220h] [bp-30h]@1

  v5 = a5;
  v85 = (ether_addr *)a4;
  v6 = a2;
  v7 = (__int64)this;
  v8 = off_7B078[0];
  v131 = *(_QWORD *)off_7B078[0];
  v130 = 0LL;
  v129 = 0LL;
  v128 = 0LL;
  v127 = 0LL;
  v126 = 0LL;
  v125 = 0LL;
  v124 = 0LL;
  *(_QWORD *)v123 = 0LL;
  v9 = 0;
  v10 = 0LL;
  memset(&v112, 0, 0x68uLL);
  if ( *((_DWORD *)this + 372) )
  {
    if ( !(*((_BYTE *)this + 7396) & 2) )
      goto LABEL_57;
    v11 = (__int64)v6;
    LODWORD(v12) = mbuf_nextpkt(v6);
    if ( v12 )
    {
      LODWORD(v13) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, _QWORD))(*(_QWORD *)this + 56LL))(this, 0LL);
      v14 = OSMetaClass::getClassName(v13);
      v10 = (__int64)"%s::%s received a packet on a chain\n";
      IO80211PeerManager::logDebug(
        this,
        "%s::%s received a packet on a chain\n",
        v14,
        (__int64)"actionFrameInput",
        v15,
        v16);
    }
    if ( !v85 || (unsigned __int64)v5 <= 0x3F )
    {
      LODWORD(v31) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64))(*(_QWORD *)this + 56LL))(this, v10);
      v32 = OSMetaClass::getClassName(v31);
      LODWORD(v33) = mbuf_len(v11);
      v7 = v33;
      v9 = 0;
      IO80211PeerManager::logDebug(
        this,
        "%s::%s mbuf len %lu headerLen %lu sizeof(struct apple80211_act_frm_hdr) %lu\n",
        v32,
        (__int64)"actionFrameInput",
        v33,
        v5);
      goto LABEL_58;
    }
    v83 = this;
    LODWORD(v17) = mbuf_len(v6);
    v18 = v17;
    v97 = 0LL;
    for ( i = v11; ; i = v7 )
    {
      LODWORD(v21) = mbuf_next(i, v10);
      v7 = v21;
      if ( !v21 )
        break;
      LODWORD(v20) = mbuf_len(v21);
      v18 += v20;
    }
    if ( v18 < 0x10 )
      goto LABEL_57;
    v7 = v11;
    LODWORD(v22) = mbuf_len(v11);
    if ( v18 > v22 || (LODWORD(v23) = mbuf_next(v11, v10), v23) )
    {
      v96 = 1;
      LODWORD(v24) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)v83 + 56LL))(v83);
      v25 = v11;
      v26 = OSMetaClass::getClassName(v24);
      LODWORD(v27) = mbuf_len(v25);
      IO80211PeerManager::logDebug(v83, "%s::%s aflen %lu mbuflen %lu\n", v26, (__int64)"actionFrameInput", v18, v27);
      if ( mbuf_allocpacket(0LL, v18, &v96, &v97) )
      {
        LODWORD(v28) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, unsigned __int64))(*(_QWORD *)v83 + 56LL))(
                         v83,
                         v18);
        v29 = OSMetaClass::getClassName(v28);
        v9 = 0;
        IO80211PeerManager::logDebug(v83, "%s::%s can't allocate mbuf %p\n", v29, (__int64)"actionFrameInput", v97, v30);
        v8 = off_7B078[0];
        goto LABEL_58;
      }
      LODWORD(v34) = mbuf_data(v97);
      v35 = v34;
      v81 = (__mbuf *)v7;
      do
      {
        LODWORD(v36) = mbuf_data(v7);
        v37 = v36;
        LODWORD(v38) = mbuf_len(v7);
        memcpy(v35, v37, v38);
        LODWORD(v39) = mbuf_len(v7);
        v35 = (char *)v35 + v39;
        LODWORD(v40) = mbuf_next(v7, v37);
        v7 = v40;
      }
      while ( v40 );
      mbuf_setlen(v97, v18);
      v41 = v97;
      v8 = off_7B078[0];
    }
    else
    {
      v97 = v11;
      v41 = v11;
      v81 = (__mbuf *)v11;
    }
    v7 = (__int64)v83;
    LODWORD(v42) = mbuf_data(v41);
    v43 = v42;
    v82 = v42;
    v84 = memcmp((char *)v83 + 3686, v85, 6uLL);
    v44 = IO80211AWDLPeerManager::actionFrameHasCorrectOUI((IO80211PeerManager *)v7, v43, v18);
    v9 = 1;
    if ( v44 )
    {
      ++*(_DWORD *)(v7 + 904);
      if ( *(_DWORD *)&v85[2].octet[4] > 0xEu )
        ++*(_DWORD *)(v7 + 912);
      else
        ++*(_DWORD *)(v7 + 908);
      if ( !v84 )
        ++*(_DWORD *)(v7 + 916);
      LOBYTE(v5) = (_BYTE)v85;
      IO80211AWDLPeerManager::logAF((IO80211PeerManager *)v7, v82, v85->octet, v18, v84 == 0);
      IO80211PeerManager::lockDataPath((IO80211PeerManager *)v7);
      v112 = v97;
      v113 = v85;
      v45 = *(_QWORD *)(v7 + 88);
      v46 = (__int64)_actionFrameReport;
      v47 = v7;
      v48 = IO80211CommandQueue::map(
              v45,
              (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_actionFrameReport,
              v7,
              (__int64)&v112,
              0LL,
              -1);
      if ( !v48 )
      {
        v7 = v47;
        if ( v84 && *(_DWORD *)&v85[7].octet[2] < *(_DWORD *)(v47 + 1460) )
        {
          IO80211PeerManager::unlockDataPath((IO80211PeerManager *)v47, (__int64)_actionFrameReport);
LABEL_57:
          v9 = 0;
          goto LABEL_58;
        }
        (*(void (__fastcall **)(__int64, ether_addr *))(*(_QWORD *)v47 + 440LL))(v47, v85);
        v45 = *(_QWORD *)(v47 + 88);
        v46 = (__int64)_actionFrameReport;
        v48 = IO80211CommandQueue::map(
                v45,
                (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_actionFrameReport,
                v47,
                (__int64)&v112,
                0LL,
                -1);
      }
      if ( v115 )
      {
        LOBYTE(v5) = 0;
      }
      else if ( v48 )
      {
        v49 = *(_DWORD *)(v47 + 7376) | 2u;
        if ( (_DWORD)v49 == 2 )
        {
          v46 = v48 + 1216;
          if ( IO80211AWDLPeerManager::validCCForPeerLearning(
                 (IO80211AWDLPeerManager *)v45,
                 (unsigned __int8 *)(v48 + 1216),
                 v49) )
          {
            LODWORD(v50) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v47 + 56LL))(v47, v46);
            v51 = OSMetaClass::getClassName(v50);
            LODWORD(v79) = *(_BYTE *)(v48 + 37);
            LODWORD(v78) = *(_BYTE *)(v48 + 36);
            LODWORD(v77) = *(_BYTE *)(v48 + 35);
            LODWORD(v76) = *(_BYTE *)(v48 + 34);
            LODWORD(v75) = *(_BYTE *)(v48 + 33);
            LODWORD(v74) = *(_BYTE *)(v48 + 32);
            v52 = v48 + 1216;
            IO80211PeerManager::logDebug(
              (IO80211PeerManager *)v47,
              0x2000000000LL,
              "%s::%s Setting country code to %s based on peer: %02x:%02x:%02x:%02x:%02x:%02x\n",
              v51,
              (__int64)"actionFrameInput",
              v52);
            v46 = v52;
            memcpy((void *)(v47 + 7380), (const void *)v52, 3uLL);
            if ( *(_DWORD *)(v47 + 7376) != 5 )
              *(_DWORD *)(v47 + 7376) = 3;
          }
        }
        if ( v117 && *(_DWORD *)(v47 + 4040) )
        {
          LODWORD(v53) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v47 + 56LL))(v47, v46);
          v54 = OSMetaClass::getClassName(v53);
          v55 = v85->octet[1];
          v56 = v85->octet[2];
          v57 = v85->octet[3];
          v58 = v85->octet[4];
          v59 = v85->octet[5];
          LODWORD(v80) = v120;
          IO80211PeerManager::logDebug(
            (IO80211PeerManager *)v47,
            0x10000000LL,
            "%s::%s peer=%02X:%02X:%02X:%02X:%02X:%02X reset Services rssi %d SUI %u\n",
            v54,
            (__int64)"actionFrameInput",
            v85->octet[0]);
          v105 = 0LL;
          v104 = 0LL;
          v103 = 0LL;
          v102 = 0LL;
          v101 = 0LL;
          *(_QWORD *)v100 = 0LL;
          strcpy(v100, "\x01");
          LODWORD(v60) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v47 + 56LL))(v47, 0x10000000LL);
          v61 = OSMetaClass::getClassName(v60);
          LODWORD(v79) = v118;
          LODWORD(v78) = v85->octet[5];
          LODWORD(v77) = v85->octet[4];
          LODWORD(v76) = v85->octet[3];
          LODWORD(v75) = v85->octet[2];
          LODWORD(v74) = v85->octet[1];
          IO80211PeerManager::logDebug(
            (IO80211PeerManager *)v47,
            0x10000000LL,
            "%s::%s postPeerPresence for peer%02X:%02X:%02X:%02X:%02X:%02X at rssi %d\n",
            v61,
            (__int64)"actionFrameInput",
            v85->octet[0]);
          v46 = (__int64)v85;
          IO80211PeerManager::postPeerPresence((IO80211PeerManager *)v47, v85, v118, 0, 0, v100);
        }
        if ( v116 )
        {
          LODWORD(v62) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v47 + 56LL))(v47, v46);
          v63 = OSMetaClass::getClassName(v62);
          LODWORD(v80) = v120;
          LODWORD(v79) = v118;
          LODWORD(v78) = v85->octet[5];
          LODWORD(v77) = v85->octet[4];
          LODWORD(v76) = v85->octet[3];
          LODWORD(v75) = v85->octet[2];
          LODWORD(v74) = v85->octet[1];
          IO80211PeerManager::logDebug(
            (IO80211PeerManager *)v47,
            0x10000000LL,
            "%s::%s peer=%02X:%02X:%02X:%02X:%02X:%02X postPeerPresence rssi %d SUI %u\n",
            v63,
            (__int64)"actionFrameInput",
            v85->octet[0]);
          IO80211PeerManager::postPeerPresence((IO80211PeerManager *)v47, v85, v118, 0, 0, &v119);
        }
        LOBYTE(v5) = v114;
        v46 = 60LL;
        snprintf(v123, 0x3CuLL, "AF %s%s", v74, v75, v76, v77, v78, v79, v80);
      }
      else
      {
        LOBYTE(v5) = 0;
        v46 = 60LL;
        snprintf(v123, 0x3CuLL, "AF No Peer");
      }
      v7 = v47;
      IO80211PeerManager::unlockDataPath((IO80211PeerManager *)v47, v46);
      if ( *(_BYTE *)(v47 + 3746) )
      {
        if ( (unsigned int)IO80211AWDLPeerManager::updateAWDLPrivateElectionID((IO80211AWDLPeerManager *)v47) )
        {
          *(_DWORD *)(v47 + 3736) = 0;
          *(_BYTE *)(v47 + 3720) &= 0xFEu;
        }
        *(_BYTE *)(v47 + 3746) = 0;
      }
      if ( IO80211PeerManager::shouldLog((IO80211PeerManager *)v47, 0x8000LL) )
      {
        v100[0] = 0;
        *(_DWORD *)&v100[4] = 0;
        LODWORD(v101) = 3;
        v102 = v81;
        v103 = 0x100000000LL;
        v111 = 0LL;
        v110 = 0LL;
        v109 = 0LL;
        v108 = 0LL;
        v107 = 0LL;
        v106 = 0LL;
        v104 = 0LL;
        LODWORD(v104) = 4194312;
        v105 = v85;
        v64 = 0;
        if ( v47 )
        {
          if ( IO80211PeerManager::shouldVerboseLog((IO80211PeerManager *)v47, 0x8000LL) )
          {
            v64 = *(_DWORD *)(v47 + 432);
          }
          else
          {
            v64 = *(_DWORD *)(v47 + 424);
            if ( !*(_DWORD *)(v47 + 424) )
              v64 = getLengthBeforeSensitivePayload(0, v102);
          }
        }
        *(_DWORD *)&v100[4] = v64;
        IO80211PeerManager::dumpPacket(v47, 0x8000LL, v123, (__int64)v100);
      }
      if ( !v115 )
        goto LABEL_60;
      goto LABEL_57;
    }
  }
LABEL_58:
  while ( *(_QWORD *)v8 != v131 )
  {
LABEL_60:
    if ( v122 )
    {
      v66 = *(_QWORD *)(v7 + 128);
      if ( v66 )
      {
        (*(void (__fastcall **)(__int64, __int64, _QWORD))(*(_QWORD *)v66 + 2184LL))(v66, v122, 0LL);
      }
      else
      {
        v67 = *(_QWORD *)(v7 + 136);
        if ( v67 )
          (*(void (__fastcall **)(__int64, __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v67 + 2168LL))(
            v67,
            v122,
            0LL,
            0LL,
            0LL);
      }
      v122 = 0LL;
    }
    if ( v121 && *(_DWORD *)(v7 + 3784) )
    {
      v95 = 0LL;
      v94 = 0LL;
      v93 = 0LL;
      v92 = 0LL;
      v91 = 0LL;
      v90 = 0LL;
      v89 = 0LL;
      v88 = 0LL;
      v87 = 0LL;
      v86 = 0LL;
      if ( IO80211PeerManager::shouldVerboseLog((IO80211PeerManager *)v7, 64LL) )
      {
        IO80211PeerManager::initUserPrintContext((IO80211PeerManager *)v7, (__int64)&v98, 0LL, 0);
        v99 = 1;
        v86 = &v98;
      }
      if ( IO80211PeerManager::shouldVerboseLog((IO80211PeerManager *)v7, 64LL)
        && *(_DWORD *)(v7 + 3780)
        && *(_DWORD *)(*(_QWORD *)(v7 + 3800) + 52LL) )
      {
        LODWORD(v68) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v7 + 56LL))(v7, 64LL);
        v69 = OSMetaClass::getClassName(v68);
        IO80211PeerManager::logDebug(
          (IO80211PeerManager *)v7,
          "%s::%s will push up %u\n",
          v69,
          (__int64)"actionFrameInput",
          *(_DWORD *)(*(_QWORD *)(v7 + 3800) + 52LL),
          v70);
      }
      LOBYTE(v5) = 0;
      IO80211CommandQueue::lockMap(
        *(IO80211CommandQueue **)(v7 + 3800),
        (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_serviceResponseSendToUserLand,
        v7,
        0LL,
        (__int64)&v86,
        -1);
      if ( IO80211PeerManager::shouldVerboseLog((IO80211PeerManager *)v7, 64LL) )
      {
        if ( *(_DWORD *)(v7 + 3780) && *(_DWORD *)(*(_QWORD *)(v7 + 3800) + 52LL) )
        {
          LODWORD(v71) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v7 + 56LL))(v7, 64LL);
          v72 = OSMetaClass::getClassName(v71);
          LOBYTE(v5) = 0;
          IO80211PeerManager::logDebug(
            (IO80211PeerManager *)v7,
            "%s::%s did push up %u\n",
            v72,
            (__int64)"actionFrameInput",
            *(_DWORD *)(*(_QWORD *)(v7 + 3800) + 52LL),
            v73);
        }
        else
        {
          LOBYTE(v5) = 0;
        }
      }
    }
    if ( (__mbuf *)v97 != v81 )
    {
      mbuf_freem(v97);
      v97 = 0LL;
    }
    v9 = (_BYTE)v5 != 0;
  }
  return v9;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C8BE8: using guessed type int __fastcall mbuf_allocpacket(_QWORD, _QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C58: using guessed type int __fastcall mbuf_next(_QWORD, _QWORD);
// C8C60: using guessed type int __fastcall mbuf_nextpkt(_QWORD);
// C8CB0: using guessed type int __fastcall mbuf_setlen(_QWORD, _QWORD);

//----- (00000000000335E6) ----------------------------------------------------
signed __int64 __fastcall _actionFrameReport(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  int v4; // ecx@1
  signed __int64 result; // rax@1

  v3 = a3;
  v4 = memcmp((const void *)(a2 + 32), *(const void **)(a3 + 8), 6uLL);
  result = 0LL;
  if ( !v4 )
  {
    *(_BYTE *)(v3 + 16) = IO80211AWDLPeer::actionFrameReport((IO80211AWDLPeer *)a2, v3);
    result = 1LL;
  }
  return result;
}

//----- (0000000000033625) ----------------------------------------------------
__int64 __fastcall _serviceResponseSendToUserLand(IO80211PeerManager *this, __int64 a2, __int64 a3, __int64 *a4)
{
  signed int v4; // ebx@1
  __int64 v5; // r15@2
  __int64 v6; // rdx@3
  int v7; // eax@4
  char v9; // [sp+8h] [bp-78h]@4
  int v10; // [sp+Ch] [bp-74h]@4
  int v11; // [sp+10h] [bp-70h]@4
  __mbuf *v12; // [sp+18h] [bp-68h]@4
  int v13; // [sp+20h] [bp-60h]@4
  int v14; // [sp+24h] [bp-5Ch]@4
  __int64 v15; // [sp+28h] [bp-58h]@4
  __int64 v16; // [sp+30h] [bp-50h]@4
  __int64 v17; // [sp+38h] [bp-48h]@4
  __int64 v18; // [sp+40h] [bp-40h]@4
  __int64 v19; // [sp+48h] [bp-38h]@4
  __int64 v20; // [sp+50h] [bp-30h]@4
  __int64 v21; // [sp+58h] [bp-28h]@4
  __int64 v22; // [sp+60h] [bp-20h]@4

  v4 = 0;
  if ( *(_BYTE *)(a2 + 74) )
  {
    v5 = IO80211ServiceRequestDescriptor::buildmDNSFrame(a2, *a4);
    v4 = 12;
    if ( v5 )
    {
      if ( IO80211PeerManager::shouldLog(this, 64LL) )
      {
        v9 = 0;
        v10 = 0;
        v11 = 0;
        v12 = (__mbuf *)v5;
        v13 = 0;
        v14 = 0;
        v22 = 0LL;
        v21 = 0LL;
        v20 = 0LL;
        v19 = 0LL;
        v18 = 0LL;
        v17 = 0LL;
        v16 = 0LL;
        v15 = 0LL;
        v7 = 0;
        if ( this )
        {
          if ( IO80211PeerManager::shouldVerboseLog(this, 64LL) )
          {
            v7 = *((_DWORD *)this + 108);
          }
          else
          {
            v7 = *((_DWORD *)this + 106);
            if ( !*((_DWORD *)this + 106) )
              v7 = getLengthBeforeSensitivePayload(0, v12);
          }
        }
        v10 = v7;
        IO80211PeerManager::dumpPacket((__int64)this, 64LL, " directMdnsRx ", (__int64)&v9);
      }
      IO80211VirtualInterface::pushPacket(*((IO80211VirtualInterface **)this + 16), (__mbuf *)v5, v6);
    }
  }
  return (unsigned int)v4;
}

//----- (000000000003374C) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlSyncParams(IO80211PeerManager *this, void *a2)
{
  void *v2; // rbx@1
  signed int v3; // ecx@11
  int v4; // eax@13
  int v5; // edx@13
  unsigned int v6; // esi@13

  v2 = a2;
  if ( *((_DWORD *)a2 + 2) == -1 )
    *((_DWORD *)a2 + 2) = *((_DWORD *)this + 373);
  if ( *((_DWORD *)a2 + 1) == -1 )
    *((_DWORD *)a2 + 1) = *((_DWORD *)this + 374);
  if ( *((_DWORD *)a2 + 3) == -1 )
    *((_DWORD *)a2 + 3) = *((_DWORD *)this + 375);
  if ( *((_DWORD *)a2 + 4) == -1 )
    *((_DWORD *)a2 + 4) = *((_DWORD *)this + 376);
  if ( *((_DWORD *)a2 + 5) == -1 )
    *((_DWORD *)a2 + 5) = *((_DWORD *)this + 377);
  v3 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x74u, a2);
  if ( v3 )
  {
    *((_BYTE *)this + 3960) = 0;
  }
  else
  {
    v4 = *((_DWORD *)a2 + 2);
    *((_DWORD *)this + 373) = v4;
    v5 = *((_DWORD *)a2 + 1);
    *((_DWORD *)this + 374) = v5;
    v6 = *((_DWORD *)a2 + 3);
    *((_DWORD *)this + 375) = v6;
    *((_DWORD *)this + 376) = *((_DWORD *)v2 + 4);
    *((_DWORD *)this + 377) = *((_DWORD *)v2 + 5);
    if ( (v4 - v5) / v6 > 2 )
    {
      *((_DWORD *)this + 1243) = 3;
      *((_DWORD *)this + 1004) = 3;
    }
    else
    {
      *((_DWORD *)this + 1243) = 1;
      *((_DWORD *)this + 1004) = 1;
    }
    *((_BYTE *)this + 3960) = 1;
  }
  return (unsigned int)v3;
}

//----- (0000000000033848) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlSyncEnabled(IO80211AWDLPeerManager *this, void *a2)
{
  OSMetaClass *v2; // rax@1
  __int64 v3; // rax@1
  __int64 v4; // r9@1
  signed int v5; // er15@4
  int v6; // eax@5
  int v7; // eax@6
  unsigned int v8; // er12@8
  unsigned int v9; // er13@8
  __int64 v10; // r15@8
  int v11; // ST00_4@8
  __int64 v12; // rcx@9
  __int64 v13; // r8@9
  __int64 v14; // r9@9
  OSMetaClass *v15; // rax@10
  __int64 v16; // rax@10
  __int64 v17; // r8@10
  __int64 v18; // r9@10
  OSMetaClass *v19; // rax@12
  __int64 v20; // rax@12
  __int64 v21; // r8@12
  __int64 v22; // r9@12
  __int64 v24; // [sp+10h] [bp-30h]@5

  LODWORD(v2) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
  v3 = OSMetaClass::getClassName(v2);
  v4 = (__int64)"not ";
  if ( *((_DWORD *)this + 1849) & 1 )
    v4 = (__int64)" ";
  *((_DWORD *)a2 + 2);
  IO80211PeerManager::logDebug(
    this,
    0x2000000000LL,
    "%s::%s AWDL is %s configured %s\n",
    v3,
    (__int64)"setAwdlSyncEnabled",
    v4);
  if ( *((_BYTE *)this + 7396) & 1 || (v5 = IO80211AWDLPeerManager::configure(this)) == 0 )
  {
    v24 = 1LL;
    *((_DWORD *)this + 1850) = 0;
    v6 = 8 * (unsigned __int8)*((_DWORD *)this + 993) & 0x10;
    if ( *((_DWORD *)this + 992) )
      v7 = v6 ^ 0x50;
    else
      v7 = v6 ^ 0x70;
    HIDWORD(v24) = v7;
    IO80211AWDLPeerManager::setAwdlElectionMetric(this, (__int64)&v24);
    v8 = *((_DWORD *)this + 932);
    v9 = *((_DWORD *)this + 1850);
    v10 = *((_QWORD *)this + 492);
    v11 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v10)) >> 64) >> 18;
    v5 = 0;
    IO80211PeerManager::logDebug(
      this,
      0x800000LL,
      "%d: met %x   flags %x _lastTimeSince %u; Time going to 0\n",
      6614LL,
      v8,
      v9);
    *((_QWORD *)this + 492) = 0LL;
    if ( *((_DWORD *)a2 + 2) )
    {
      *((_DWORD *)this + 1001) = *((_DWORD *)this + 999);
      *((_DWORD *)this + 999) = 0;
      *((_BYTE *)this + 96) = 0;
      (*(void (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 320LL))(this, 3LL);
      if ( !(*((_BYTE *)this + 7396) & 2) )
      {
        LODWORD(v15) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
        v16 = OSMetaClass::getClassName(v15);
        IO80211PeerManager::logDebug(
          this,
          "%s::%s AWDL can't be enabled at this time\n",
          v16,
          (__int64)"setAwdlSyncEnabled",
          v17,
          v18);
        v5 = 1;
      }
    }
    else
    {
      IO80211PeerManager::removeAllPeers(this);
      *((_BYTE *)this + 7396) &= 0xF9u;
      v5 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x75u, a2);
      if ( v5 )
      {
        LODWORD(v19) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                         this,
                         2150132168LL);
        v20 = OSMetaClass::getClassName(v19);
        IO80211PeerManager::logDebug(
          this,
          "%s::%s AWDL can't DISABLE!!\n",
          v20,
          (__int64)"setAwdlSyncEnabled",
          v21,
          v22);
      }
      *((_DWORD *)this + 999) = *((_DWORD *)this + 1001);
    }
    if ( *((_QWORD *)this + 16) )
    {
      IO80211PeerManager::logDebug(this, 0x10000000LL, "masterReport enableSync\n", v12, v13, v14);
      IO80211VirtualInterface::postNewMasterElected(*((IO80211VirtualInterface **)this + 16), (__ifnet *)0x10000000);
      IO80211VirtualInterface::postSyncStateChanged(*((IO80211VirtualInterface **)this + 16));
    }
  }
  return (unsigned int)v5;
}

//----- (0000000000033AA4) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlPeerTrafficRegistration(IO80211AWDLPeerManager *this, void *a2)
{
  __int64 v2; // rbx@1
  signed int v3; // er15@1
  OSMetaClass *v4; // rax@1
  __int64 v5; // rax@1
  __int64 (__fastcall *v6)(__int64, __int64); // rsi@2
  __int64 v7; // rax@2
  __int64 v8; // r15@2
  OSMetaClass *v9; // rax@4
  __int64 v10; // rax@4
  int v11; // ST18_4@4
  int v12; // ST10_4@4
  int v13; // ST08_4@4
  int v14; // ST00_4@4
  OSMetaClass *v15; // rax@5
  __int64 v16; // rax@5
  int v17; // ST18_4@5
  int v18; // ST10_4@5
  int v19; // ST08_4@5
  int v20; // ST00_4@5
  signed int v21; // ebx@6
  OSMetaClass *v22; // rax@7
  __int64 v23; // rax@7
  __int64 v24; // r9@7
  char *v25; // rax@8
  unsigned __int64 v26; // rsi@8
  OSMetaClass *v27; // rax@9
  __int64 v28; // rax@9
  int v29; // ST18_4@9
  int v30; // ST10_4@9
  int v31; // ST08_4@9
  int v32; // ST00_4@9
  signed int v33; // ebx@10
  OSMetaClass *v34; // rax@11
  __int64 v35; // rax@11
  __int64 v36; // r9@11

  v2 = (__int64)a2;
  v3 = 0;
  IO80211CommandQueue::map(
    *((_QWORD *)this + 11),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_setPrimary,
    (__int64)this,
    (__int64)a2,
    0LL,
    -1);
  *((_DWORD *)this + 1015) = *((_DWORD *)a2 + 19) & 2;
  LODWORD(v4) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64 (__fastcall *)(__int64, __int64, __int64)))(*(_QWORD *)this + 56LL))(
                  this,
                  _setPrimary);
  v5 = OSMetaClass::getClassName(v4);
  IO80211PeerManager::logDebug(
    this,
    0x800000LL,
    "%s::%s hint = %x \n",
    v5,
    (__int64)"setAwdlPeerTrafficRegistration",
    *((_DWORD *)a2 + 19));
  if ( !*((_DWORD *)a2 + 18) )
  {
    LODWORD(v15) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                     this,
                     0x800000LL);
    v16 = OSMetaClass::getClassName(v15);
    v17 = *((_BYTE *)a2 + 9);
    v18 = *((_BYTE *)a2 + 8);
    v19 = *((_BYTE *)a2 + 7);
    v20 = *((_BYTE *)a2 + 6);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s Clearing AirPlay peer %02X:%02X:%02X:%02X:%02X:%02X\n",
      v16,
      (__int64)"setAwdlPeerTrafficRegistration",
      *((_BYTE *)a2 + 4),
      *((_BYTE *)a2 + 5));
    *((_BYTE *)this + 7408) = 0;
    *((_QWORD *)this + 927) = 0LL;
    if ( !*((_DWORD *)this + 1245) )
    {
      v21 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0xA4u, a2);
      if ( v21 )
      {
        LODWORD(v22) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                         this,
                         2150132168LL);
        v23 = OSMetaClass::getClassName(v22);
        IO80211PeerManager::logDebug(
          this,
          "%s::%s Can't clear peer traffic registration, ret %d\n",
          v23,
          (__int64)"setAwdlPeerTrafficRegistration",
          (unsigned int)v21,
          v24);
        v3 = v21;
      }
    }
    IO80211AWDLPeerManager::setScheduleState(this, *((_DWORD *)this + 1244), 1);
    v25 = IO80211VirtualInterface::getBSDName(*((IO80211VirtualInterface **)this + 16));
    v26 = 68LL;
    goto LABEL_13;
  }
  v6 = _getPrimary;
  v7 = IO80211CommandQueue::map(
         *((_QWORD *)this + 11),
         (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_getPrimary,
         (__int64)this,
         v2,
         0LL,
         -1);
  v8 = v7;
  if ( v7 )
  {
    v6 = (__int64 (__fastcall *)(__int64, __int64))(v2 + 4);
    if ( !memcmp((const void *)(v7 + 32), (const void *)(v2 + 4), 6uLL) )
    {
      *((_BYTE *)this + 7408) = 1;
      *((_QWORD *)this + 927) = v8;
      *((_BYTE *)this + 8260) |= 0x20u;
      *((_BYTE *)this + 8277) = *(_BYTE *)(v8 + 1203);
      LODWORD(v27) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64 (__fastcall *)(__int64, __int64)))(*(_QWORD *)this + 56LL))(
                       this,
                       v6);
      v28 = OSMetaClass::getClassName(v27);
      v29 = *(_BYTE *)(v2 + 9);
      v30 = *(_BYTE *)(v2 + 8);
      v31 = *(_BYTE *)(v2 + 7);
      v32 = *(_BYTE *)(v2 + 6);
      v3 = 0;
      IO80211PeerManager::logDebug(
        this,
        "%s::%s Setting AirPlay peer %02X:%02X:%02X:%02X:%02X:%02X\n",
        v28,
        (__int64)"setAwdlPeerTrafficRegistration",
        *(_BYTE *)(v2 + 4),
        *(_BYTE *)(v2 + 5));
      if ( !*((_DWORD *)this + 1245) )
      {
        v33 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0xA4u, (void *)v2);
        if ( v33 )
        {
          LODWORD(v34) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                           this,
                           2150132168LL);
          v35 = OSMetaClass::getClassName(v34);
          IO80211PeerManager::logDebug(
            this,
            "%s::%s Can't set peer traffic registration, ret %d\n",
            v35,
            (__int64)"setAwdlPeerTrafficRegistration",
            (unsigned int)v33,
            v36);
          v3 = v33;
        }
      }
      IO80211AWDLPeerManager::setScheduleState(this, *((_DWORD *)this + 1244), 1);
      v25 = IO80211VirtualInterface::getBSDName(*((IO80211VirtualInterface **)this + 16));
      v26 = 67LL;
LABEL_13:
      IO80211InterfacePostMessage(v25, v26, 0LL, 0LL);
      return (unsigned int)v3;
    }
  }
  LODWORD(v9) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64 (__fastcall *)(__int64, __int64)))(*(_QWORD *)this + 56LL))(
                  this,
                  v6);
  v10 = OSMetaClass::getClassName(v9);
  v11 = *(_BYTE *)(v2 + 9);
  v12 = *(_BYTE *)(v2 + 8);
  v13 = *(_BYTE *)(v2 + 7);
  v14 = *(_BYTE *)(v2 + 6);
  IO80211PeerManager::logDebug(
    this,
    "%s::%s peer for traffic registration not found %02x:%02x:%02x:%02x:%02x:%02x\n",
    v10,
    (__int64)"setAwdlPeerTrafficRegistration",
    *(_BYTE *)(v2 + 4),
    *(_BYTE *)(v2 + 5));
  v3 = -536870160;
  return (unsigned int)v3;
}

//----- (0000000000033DC2) ----------------------------------------------------
__int64 __fastcall _setPrimary(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  *(_BYTE *)(a2 + 1195) = !memcmp((const void *)(a2 + 32), (const void *)(a3 + 4), 6uLL) && *(_DWORD *)(v3 + 72);
  return 0LL;
}

//----- (0000000000033E03) ----------------------------------------------------
__int64 __fastcall _getPrimary(__int64 a1, __int64 a2)
{
  return *(_BYTE *)(a2 + 1195) != 0;
}

//----- (0000000000033E16) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::awdlStatsSetPeerInfraChannel(IO80211AWDLPeerManager *this, char a2)
{
  *((_BYTE *)this + 8277) = a2;
}

//----- (0000000000033E24) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlPeerTrafficRegistration(IO80211PeerManager *this, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 (__fastcall *v3)(__int64, __int64); // rsi@1
  __int64 v4; // rax@1
  OSMetaClass *v5; // rax@7
  __int64 v6; // rax@7

  v2 = a2;
  v3 = _getPrimary;
  v4 = IO80211CommandQueue::map(
         *((_QWORD *)this + 11),
         (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_getPrimary,
         (__int64)this,
         v2,
         0LL,
         -1);
  if ( v4 )
    *(_DWORD *)(v2 + 72) = *(_BYTE *)(v4 + 1195);
  if ( *((_DWORD *)this + 1015) )
    *(_BYTE *)(v2 + 76) |= 2u;
  if ( v4 )
  {
    v3 = (__int64 (__fastcall *)(__int64, __int64))(v4 + 32);
    memcpy((void *)(v2 + 4), (const void *)(v4 + 32), 6uLL);
  }
  LODWORD(v5) = (*(int (__fastcall **)(IO80211PeerManager *, __int64 (__fastcall *)(__int64, __int64)))(*(_QWORD *)this + 56LL))(
                  this,
                  v3);
  v6 = OSMetaClass::getClassName(v5);
  IO80211PeerManager::logDebug(
    this,
    0x800000LL,
    "%s::%s hint = %x \n",
    v6,
    (__int64)"getAwdlPeerTrafficRegistration",
    *(_DWORD *)(v2 + 76));
  return 0LL;
}

//----- (0000000000033EC2) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlExtensionParams(IO80211PeerManager *this, void *a2)
{
  OSMetaClass *v2; // rax@1
  __int64 v3; // rax@1
  int v4; // ST10_4@1
  int v5; // ST08_4@1
  int v6; // ST00_4@1
  signed int v7; // er15@9
  OSMetaClass *v8; // rax@9
  __int64 v9; // rax@9
  IO80211VirtualInterface *v10; // rdi@11

  LODWORD(v2) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
  v3 = OSMetaClass::getClassName(v2);
  v4 = *((_DWORD *)a2 + 3);
  v5 = *((_DWORD *)a2 + 1);
  v6 = *((_DWORD *)a2 + 2);
  IO80211PeerManager::logDebug(
    this,
    32LL,
    "%s::%s %u %u %u %u \n",
    v3,
    (__int64)"setAwdlExtensionParams",
    *((_DWORD *)a2 + 4));
  if ( *((_DWORD *)a2 + 2) == -1 )
    *((_DWORD *)a2 + 2) = *((_BYTE *)this + 1515);
  if ( *((_DWORD *)a2 + 1) == -1 )
    *((_DWORD *)a2 + 1) = *((_BYTE *)this + 1516);
  if ( *((_DWORD *)a2 + 3) == -1 )
    *((_DWORD *)a2 + 3) = *((_BYTE *)this + 1517);
  if ( *((_DWORD *)a2 + 4) == -1 )
    *((_DWORD *)a2 + 4) = *((_BYTE *)this + 1518);
  v7 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x76u, a2);
  LODWORD(v8) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                  this,
                  2150132168LL);
  v9 = OSMetaClass::getClassName(v8);
  IO80211PeerManager::logDebug(this, 32LL, "%s::%s ret %d\n", v9, (__int64)"setAwdlExtensionParams", (unsigned int)v7);
  if ( !v7 )
  {
    *((_BYTE *)this + 1515) = *((_BYTE *)a2 + 8);
    *((_BYTE *)this + 1516) = *((_BYTE *)a2 + 4);
    *((_BYTE *)this + 1517) = *((_BYTE *)a2 + 12);
    *((_BYTE *)this + 1518) = *((_BYTE *)a2 + 16);
  }
  v10 = (IO80211VirtualInterface *)*((_QWORD *)this + 16);
  if ( v10 )
    IO80211VirtualInterface::postSyncStateChanged(v10);
  return (unsigned int)v7;
}

//----- (0000000000033FF7) ----------------------------------------------------
__int64 __fastcall _countNonATVCachedPeers(__int64 a1, __int64 a2, __int64 a3)
{
  if ( *(_BYTE *)(a2 + 522) && !*(_BYTE *)(a2 + 1161) )
    ++*(_DWORD *)a3;
  return 0LL;
}

//----- (0000000000034014) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::isValidChannel(IO80211PeerManager *this, __int64 a2, int a3, int a4, __int64 a5)
{
  int v5; // er12@1
  unsigned int v6; // ecx@1
  int v7; // edx@1
  __int64 result; // rax@2
  __int64 v9; // r14@3
  int v10; // er15@3
  OSMetaClass *v11; // rax@6
  __int64 v12; // rax@6
  int v13; // ST38_4@6
  int v14; // ST30_4@6
  int v15; // ST00_4@6
  int v16; // ecx@10
  __int64 v17; // [sp+50h] [bp-40h]@1
  int v18; // [sp+5Ch] [bp-34h]@1

  v17 = a5;
  v18 = a4;
  v5 = a3;
  v6 = *(_WORD *)(a2 + 8);
  v7 = 127;
  if ( v6 > 0x7F || (result = 0LL, v7 = v6 - 1, ((v6 - 1) & 0x80000000) == 0) )
  {
    v9 = v7;
    v10 = v7 + 1;
    while ( 1 )
    {
      if ( IO80211PeerManager::shouldLog(this, 32LL) && IO80211PeerManager::shouldVerboseLog(this, 32LL) )
      {
        LODWORD(v11) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                         this,
                         32LL);
        v12 = OSMetaClass::getClassName(v11);
        *(_BYTE *)(a2 + v9 + 394);
        *(_BYTE *)(a2 + v9 + 522);
        *(_BYTE *)(a2 + v9 + 650);
        *(_BYTE *)(a2 + v9 + 778);
        *(_BYTE *)(a2 + v9 + 906);
        v13 = *(_DWORD *)(a2 + 4 * v9 + 1548);
        v14 = *(_DWORD *)(a2 + 4 * v9 + 1036);
        v15 = *(_BYTE *)(a2 + v9 + 266);
        IO80211PeerManager::logDebug(
          this,
          32LL,
          "%s::%s \t.chanSpec=%04x chanNum=%d\t indoorRestricted=%s  radarDFS=%s  passive=%s  support40MHz=%s  support80MHz=%s perChan=%x chanBitmap=%x\n",
          v12,
          (__int64)"isValidChannel",
          *(_WORD *)(a2 + 2 * v9 + 10));
      }
      if ( *(_BYTE *)(a2 + v9 + 266) == v5 )
        break;
      --v9;
      --v10;
      result = 0LL;
      if ( v10 <= 0 )
        return result;
    }
    v16 = (*(_BYTE *)(a2 + v9 + 522) != 0) | 2 * (*(_BYTE *)(a2 + v9 + 650) != 0) | 4 * (*(_BYTE *)(a2 + v9 + 394) != 0) | 8 * (*(_BYTE *)(a2 + v9 + 778) != 0) | 16 * (*(_BYTE *)(a2 + v9 + 906) != 0);
    *(_DWORD *)v17 = v16;
    result = 1LL;
    if ( v18 )
      result = (v18 & v16) == v18;
  }
  return result;
}

//----- (000000000003421A) ----------------------------------------------------
int __fastcall IO80211AWDLPeerManager::setAwdlCtl(IO80211AWDLPeerManager *this, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 v3; // r15@1
  OSMetaClass *v4; // rax@1
  __int64 v5; // rax@1
  size_t v6; // rbx@1
  size_t v7; // rax@2
  __int64 v8; // r9@2
  size_t v9; // rbx@3
  size_t v10; // rax@4
  size_t v11; // rbx@5
  size_t v12; // rax@6
  size_t v13; // rbx@7
  size_t v14; // rax@8
  __int64 v15; // r9@8
  size_t v16; // rbx@9
  size_t v17; // rax@10
  size_t v18; // rbx@11
  size_t v19; // rax@12
  __int64 v20; // r9@12
  size_t v21; // rbx@13
  size_t v22; // rax@14
  size_t v23; // rbx@15
  size_t v24; // rax@16
  size_t v25; // rbx@17
  size_t v26; // rax@18
  size_t v27; // rbx@19
  size_t v28; // rax@20
  size_t v29; // rbx@21
  size_t v30; // rax@22
  size_t v31; // rbx@23
  size_t v32; // rax@24
  size_t v33; // rbx@25
  size_t v34; // rax@26
  signed __int64 v35; // rsi@26
  size_t v36; // rbx@27
  size_t v37; // rax@28
  __int64 v38; // rdx@28
  __int64 v39; // r9@28
  size_t v40; // rbx@29
  size_t v41; // rax@30
  size_t v42; // rbx@31
  size_t v43; // rax@32
  size_t v44; // rbx@33
  size_t v45; // rax@34
  size_t v46; // rbx@35
  size_t v47; // rax@36
  size_t v48; // rbx@37
  size_t v49; // rax@38
  size_t v50; // rbx@39
  size_t v51; // rax@40
  size_t v52; // rbx@41
  size_t v53; // rax@42
  size_t v54; // rbx@43
  size_t v55; // rax@44
  size_t v56; // rbx@45
  size_t v57; // rax@46
  size_t v58; // rbx@47
  size_t v59; // rax@48
  size_t v60; // rbx@49
  size_t v61; // rax@50
  size_t v62; // rbx@51
  size_t v63; // rax@52
  size_t v64; // rbx@53
  size_t v65; // rax@54
  size_t v66; // rbx@55
  size_t v67; // rax@56
  __int64 v68; // r9@56
  size_t v69; // rbx@57
  size_t v70; // rax@58
  size_t v71; // rbx@59
  size_t v72; // rax@60
  size_t v73; // rbx@61
  size_t v74; // rax@62
  __int64 v75; // r9@62
  size_t v76; // rbx@63
  size_t v77; // rax@64
  size_t v78; // rbx@65
  size_t v79; // rax@66
  size_t v80; // rbx@67
  size_t v81; // rax@68
  size_t v82; // rbx@69
  size_t v83; // rax@70
  __int64 v84; // r9@70
  size_t v85; // rbx@71
  size_t v86; // rax@72
  size_t v87; // rbx@73
  size_t v88; // rax@74
  size_t v89; // rbx@75
  size_t v90; // rax@76
  size_t v91; // rbx@77
  size_t v92; // rax@78
  size_t v93; // rbx@79
  size_t v94; // rax@80
  size_t v95; // rbx@81
  size_t v96; // rax@82
  size_t v97; // rbx@83
  size_t v98; // rax@84
  size_t v99; // rbx@85
  size_t v100; // rax@86
  size_t v101; // rbx@87
  size_t v102; // rax@88
  size_t v103; // rbx@89
  size_t v104; // rax@90
  size_t v105; // rbx@91
  size_t v106; // rax@92
  size_t v107; // rbx@93
  size_t v108; // rax@94
  __int64 v109; // r9@94
  size_t v110; // rbx@95
  size_t v111; // rax@96
  __int64 v112; // r9@96
  size_t v113; // rbx@97
  size_t v114; // rax@98
  size_t v115; // rbx@99
  size_t v116; // rax@100
  __int64 v118; // rcx@102
  __int64 v119; // r8@102
  char *v120; // rsi@103
  __int64 v121; // rdx@103
  __int64 v122; // rcx@108
  __int64 v123; // r8@108
  unsigned int v124; // er8@110
  char v125[8]; // rbx@111
  __int64 v126; // rcx@114
  __int64 v127; // r8@114
  OSMetaClass *v128; // rax@131
  __int64 v129; // rcx@131
  __int64 v130; // r9@131
  char *v131; // rax@132
  __int64 v132; // rcx@133
  __int64 v133; // r8@133
  IO80211CommandQueue *v134; // rdi@136
  __int64 v135; // rax@143
  signed __int64 v136; // rsi@143
  __int64 v137; // rcx@167
  __int64 v138; // r8@167
  __int64 v139; // rcx@174
  __int64 v140; // r8@174
  __int64 v141; // rax@177
  __int64 v142; // rcx@186
  unsigned int v143; // ebx@186
  char *v144; // rsi@187
  __int64 v145; // rdx@187
  unsigned int v146; // ebx@209
  unsigned int v147; // ebx@212
  int v148; // eax@217
  __int64 v149; // [sp+0h] [bp-D0h]@1
  __int64 *v150; // [sp+8h] [bp-C8h]@137
  __int64 v151; // [sp+10h] [bp-C0h]@137
  __int64 v152; // [sp+18h] [bp-B8h]@137
  __int64 v153; // [sp+20h] [bp-B0h]@137
  __int64 v154; // [sp+28h] [bp-A8h]@137
  __int64 v155; // [sp+30h] [bp-A0h]@137
  __int64 v156; // [sp+38h] [bp-98h]@137
  __int64 v157; // [sp+40h] [bp-90h]@137
  __int64 v158; // [sp+48h] [bp-88h]@137
  __int64 v159; // [sp+50h] [bp-80h]@137
  __int64 v160; // [sp+58h] [bp-78h]@1
  __int64 v161; // [sp+60h] [bp-70h]@1
  __int64 v162; // [sp+68h] [bp-68h]@1
  __int64 v163; // [sp+70h] [bp-60h]@1
  __int64 v164; // [sp+78h] [bp-58h]@1
  __int64 v165; // [sp+80h] [bp-50h]@1
  __int64 v166; // [sp+88h] [bp-48h]@1
  __int64 v167; // [sp+90h] [bp-40h]@1
  __int64 v168; // [sp+98h] [bp-38h]@1
  __int64 v169; // [sp+A0h] [bp-30h]@1
  __int64 v170; // [sp+A8h] [bp-28h]@1

  v2 = a2;
  v3 = (__int64)this;
  LODWORD(v4) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
  v5 = OSMetaClass::getClassName(v4);
  v149 = *(_QWORD *)(a2 + 136);
  IO80211PeerManager::logDebug(this, 32LL, "%s::%s awdl <%s> %llu\n", v5, (__int64)"setAwdlCtl", a2 + 4);
  v170 = 0LL;
  v169 = 0LL;
  v168 = 0LL;
  v167 = 0LL;
  v166 = 0LL;
  v165 = 0LL;
  v164 = 0LL;
  v163 = 0LL;
  v162 = 0LL;
  v161 = 0LL;
  v160 = 0LL;
  v160 = *(_QWORD *)(a2 + 152);
  v164 = *(_DWORD *)(a2 + 144);
  v6 = strnlen("awdl_bonjour_offload", 0x80uLL);
  if ( v6 == strnlen((const char *)(a2 + 4), 0x80uLL) )
  {
    v7 = strlen("awdl_bonjour_offload");
    if ( !strncmp("awdl_bonjour_offload", (const char *)(a2 + 4), v7) )
    {
      v118 = *((_DWORD *)this + 947);
      v119 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 947) = v119;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_184;
      v120 = "%s : %d -> %d\n";
      v121 = (__int64)"awdl_bonjour_offload";
LABEL_183:
      _userPrint((__int64)&v160, v120, v121, v118, v119, v8, v149);
      goto LABEL_184;
    }
  }
  v9 = strnlen("always_available_packet_threshold", 0x80uLL);
  if ( v9 == strnlen((const char *)(a2 + 4), 0x80uLL) )
  {
    v10 = strlen("always_available_packet_threshold");
    if ( !strncmp("always_available_packet_threshold", (const char *)(a2 + 4), v10) )
    {
      v118 = *((_DWORD *)this + 1241);
      v119 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 1241) = v119;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"always_available_packet_threshold";
      goto LABEL_183;
    }
  }
  v11 = strnlen("always_available_packet_threshold_real_time", 0x80uLL);
  if ( v11 == strnlen((const char *)(a2 + 4), 0x80uLL) )
  {
    v12 = strlen("always_available_packet_threshold_real_time");
    if ( !strncmp("always_available_packet_threshold_real_time", (const char *)(a2 + 4), v12) )
    {
      v118 = *((_DWORD *)this + 1242);
      v119 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 1242) = v119;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"always_available_packet_threshold_real_time";
      goto LABEL_183;
    }
  }
  v13 = strnlen("awdlMaxBW", 0x80uLL);
  if ( v13 == strnlen((const char *)(a2 + 4), 0x80uLL) )
  {
    v14 = strlen("awdlMaxBW");
    if ( !strncmp("awdlMaxBW", (const char *)(a2 + 4), v14) )
    {
      v122 = *((_DWORD *)this + 2030);
      v123 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 2030) = v123;
      if ( *(_QWORD *)(a2 + 152) )
      {
        _userPrint((__int64)&v160, "%s : %u -> %u\n", (__int64)"awdlMaxBW", v122, v123, v15, v149);
        LODWORD(v123) = *((_DWORD *)this + 2030);
      }
      v124 = v123 - 1;
      if ( v124 > 2 )
        *(_QWORD *)v125 = "allowCC";
      else
        *(_QWORD *)v125 = off_7D210[v124];
      (*(void (__fastcall **)(IO80211AWDLPeerManager *, char[8]))(*(_QWORD *)this + 408LL))(this, *(_QWORD *)v125);
      *((_BYTE *)this + 7396) &= 0xFEu;
      (*(void (__fastcall **)(IO80211AWDLPeerManager *, char[8]))(*(_QWORD *)this + 400LL))(this, *(_QWORD *)v125);
      goto LABEL_184;
    }
  }
  v16 = strnlen("allowAwdlQuietMode", 0x80uLL);
  if ( v16 == strnlen((const char *)(a2 + 4), 0x80uLL) )
  {
    v17 = strlen("allowAwdlQuietMode");
    if ( !strncmp("allowAwdlQuietMode", (const char *)(a2 + 4), v17) )
    {
      v118 = *((_DWORD *)this + 996);
      v119 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 996) = v119;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"allowAwdlQuietMode";
      goto LABEL_183;
    }
  }
  v18 = strnlen("awdl_infra_interface_switching", 0x80uLL);
  if ( v18 == strnlen((const char *)(a2 + 4), 0x80uLL) )
  {
    v19 = strlen("awdl_infra_interface_switching");
    if ( !strncmp("awdl_infra_interface_switching", (const char *)(a2 + 4), v19) )
    {
      v126 = *((_DWORD *)this + 1883);
      v127 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 1883) = v127;
      if ( *(_QWORD *)(a2 + 152) )
        _userPrint((__int64)&v160, "%s : %u -> %u\n", (__int64)"awdl_infra_interface_switching", v126, v127, v20, v149);
      IO80211AWDLPeerManager::updateSyncFrameTemplate(this);
      goto LABEL_184;
    }
  }
  v21 = strnlen("awdl_master_sync_grace_period", 0x80uLL);
  if ( v21 == strnlen((const char *)(a2 + 4), 0x80uLL) )
  {
    v22 = strlen("awdl_master_sync_grace_period");
    if ( !strncmp("awdl_master_sync_grace_period", (const char *)(a2 + 4), v22) )
    {
      v118 = *((_DWORD *)this + 1000);
      v119 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 1000) = v119;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"awdl_master_sync_grace_period";
      goto LABEL_183;
    }
  }
  v23 = strnlen("awdl_quiet_grace_period", 0x80uLL);
  if ( v23 == strnlen((const char *)(a2 + 4), 0x80uLL) )
  {
    v24 = strlen("awdl_quiet_grace_period");
    if ( !strncmp("awdl_quiet_grace_period", (const char *)(a2 + 4), v24) )
    {
      v118 = *((_DWORD *)this + 999);
      v119 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 999) = v119;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"awdl_quiet_grace_period";
      goto LABEL_183;
    }
  }
  v25 = strnlen("awdl_quiet_grace_period_unicast", 0x80uLL);
  if ( v25 == strnlen((const char *)(a2 + 4), 0x80uLL) )
  {
    v26 = strlen("awdl_quiet_grace_period_unicast");
    if ( !strncmp("awdl_quiet_grace_period_unicast", (const char *)(a2 + 4), v26) )
    {
      v118 = *((_DWORD *)this + 1002);
      v119 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 1002) = v119;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"awdl_quiet_grace_period_unicast";
      goto LABEL_183;
    }
  }
  v27 = strnlen("awdl_quiet_grace_period_multicast", 0x80uLL);
  if ( v27 == strnlen((const char *)(a2 + 4), 0x80uLL) )
  {
    v28 = strlen("awdl_quiet_grace_period_multicast");
    if ( !strncmp("awdl_quiet_grace_period_multicast", (const char *)(a2 + 4), v28) )
    {
      v118 = *((_DWORD *)this + 1003);
      v119 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 1003) = v119;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"awdl_quiet_grace_period_multicast";
      goto LABEL_183;
    }
  }
  v29 = strnlen("awdl_unquiet_to_minimum", 0x80uLL);
  if ( v29 == strnlen((const char *)(a2 + 4), 0x80uLL) )
  {
    v30 = strlen("awdl_unquiet_to_minimum");
    if ( !strncmp("awdl_unquiet_to_minimum", (const char *)(a2 + 4), v30) )
    {
      v118 = *((_DWORD *)this + 1005);
      v119 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 1005) = v119;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"awdl_unquiet_to_minimum";
      goto LABEL_183;
    }
  }
  v31 = strnlen("defaultSocialChannel2G", 0x80uLL);
  if ( v31 == strnlen((const char *)(a2 + 4), 0x80uLL) )
  {
    v32 = strlen("defaultSocialChannel2G");
    if ( !strncmp("defaultSocialChannel2G", (const char *)(a2 + 4), v32) )
    {
      v118 = *((_DWORD *)this + 380);
      v119 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 380) = v119;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"defaultSocialChannel2G";
      goto LABEL_183;
    }
  }
  v33 = strnlen("channelSequenceStrategy", 0x80uLL);
  if ( v33 == strnlen((const char *)(a2 + 4), 0x80uLL) )
  {
    v34 = strlen("channelSequenceStrategy");
    v35 = a2 + 4;
    if ( !strncmp("channelSequenceStrategy", (const char *)(v2 + 4), v34) )
    {
      *((_DWORD *)this + 259) = *(_DWORD *)(v2 + 136);
      LODWORD(v128) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                        this,
                        v35);
      v129 = OSMetaClass::getClassName(v128);
      v130 = *((_DWORD *)this + 259);
      if ( (unsigned __int64)v130 <= 3 )
        v131 = off_7D180[v130];
      IO80211PeerManager::logDebug(
        this,
        0x2000000000LL,
        "%s::%s set strategy %u %s\n",
        v129,
        (__int64)"setAwdlCtl",
        v130);
LABEL_143:
      v135 = *(_QWORD *)v3;
      v136 = 4LL;
LABEL_144:
      (*(void (__fastcall **)(__int64, signed __int64, __int64, __int64))(v135 + 320))(v3, v136, v38, v132);
      goto LABEL_184;
    }
  }
  v36 = strnlen("discard_airplay_records", 0x80uLL);
  if ( v36 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v37 = strlen("discard_airplay_records");
    if ( !strncmp("discard_airplay_records", (const char *)(v2 + 4), v37) )
    {
      v132 = *((_DWORD *)this + 908);
      v133 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 908) = v133;
      if ( *(_QWORD *)(v2 + 152) )
      {
        _userPrint((__int64)&v160, "%s : %u -> %u\n", (__int64)"discard_airplay_records", v132, v133, v39, v149);
        LODWORD(v133) = *((_DWORD *)this + 908);
      }
      if ( !(_DWORD)v133 )
        goto LABEL_184;
      v134 = (IO80211CommandQueue *)*((_QWORD *)this + 476);
      if ( v134 )
      {
        v159 = 0LL;
        v158 = 0LL;
        v157 = 0LL;
        v156 = 0LL;
        v155 = 0LL;
        v154 = 0LL;
        v153 = 0LL;
        v152 = 0LL;
        v151 = 0LL;
        v150 = &v160;
        IO80211CommandQueue::lockMap(
          v134,
          (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_discardAirPlayService,
          v3,
          0LL,
          (__int64)&v150,
          -1);
      }
      goto LABEL_143;
    }
  }
  v40 = strnlen("dmdns_debug", 0x80uLL);
  if ( v40 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v41 = strlen("dmdns_debug");
    if ( !strncmp("dmdns_debug", (const char *)(v2 + 4), v41) )
    {
      v118 = *((_DWORD *)this + 945);
      v119 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 945) = v119;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"dmdns_debug";
      goto LABEL_183;
    }
  }
  v42 = strnlen("do_ip6_arpa", 0x80uLL);
  if ( v42 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v43 = strlen("do_ip6_arpa");
    if ( !strncmp("do_ip6_arpa", (const char *)(v2 + 4), v43) )
    {
      v118 = *((_DWORD *)this + 1009);
      v119 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 1009) = v119;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"do_ip6_arpa";
      goto LABEL_183;
    }
  }
  v44 = strnlen("do_reset_services", 0x80uLL);
  if ( v44 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v45 = strlen("do_reset_services");
    if ( !strncmp("do_reset_services", (const char *)(v2 + 4), v45) )
    {
      v118 = *((_DWORD *)this + 1010);
      v119 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 1010) = v119;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"do_reset_services";
      goto LABEL_183;
    }
  }
  v46 = strnlen("dont_duplicate_mcast", 0x80uLL);
  if ( v46 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v47 = strlen("dont_duplicate_mcast");
    if ( !strncmp("dont_duplicate_mcast", (const char *)(v2 + 4), v47) )
    {
      v118 = *((_DWORD *)this + 906);
      v119 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 906) = v119;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"dont_duplicate_mcast";
      goto LABEL_183;
    }
  }
  v48 = strnlen("driver_set_interface_state", 0x80uLL);
  if ( v48 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v49 = strlen("driver_set_interface_state");
    if ( !strncmp("driver_set_interface_state", (const char *)(v2 + 4), v49) )
    {
      v118 = *((_DWORD *)this + 1895);
      v119 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 1895) = v119;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"driver_set_interface_state";
      goto LABEL_183;
    }
  }
  v50 = strnlen("enable_forced_roam", 0x80uLL);
  if ( v50 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v51 = strlen("enable_forced_roam");
    if ( !strncmp("enable_forced_roam", (const char *)(v2 + 4), v51) )
    {
      v118 = *((_DWORD *)this + 1887);
      v119 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 1887) = v119;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"enable_forced_roam";
      goto LABEL_183;
    }
  }
  v52 = strnlen("enable_mdns_initial_speedup", 0x80uLL);
  if ( v52 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v53 = strlen("enable_mdns_initial_speedup");
    if ( !strncmp("enable_mdns_initial_speedup", (const char *)(v2 + 4), v53) )
    {
      v118 = *((_DWORD *)this + 1890);
      v119 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 1890) = v119;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"enable_mdns_initial_speedup";
      goto LABEL_183;
    }
  }
  v54 = strnlen("enable_wme", 0x80uLL);
  if ( v54 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v55 = strlen("enable_wme");
    if ( !strncmp("enable_wme", (const char *)(v2 + 4), v55) )
    {
      v118 = *((_DWORD *)this + 1016);
      v119 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 1016) = v119;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"enable_wme";
      goto LABEL_183;
    }
  }
  v56 = strnlen("filter_dmdns", 0x80uLL);
  if ( v56 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v57 = strlen("filter_dmdns");
    if ( !strncmp("filter_dmdns", (const char *)(v2 + 4), v57) )
    {
      v118 = *((_DWORD *)this + 907);
      v119 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 907) = v119;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"filter_dmdns";
      goto LABEL_183;
    }
  }
  v58 = strnlen("fixedSequenceInfraReservedTime", 0x80uLL);
  if ( v58 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v59 = strlen("fixedSequenceInfraReservedTime");
    if ( !strncmp("fixedSequenceInfraReservedTime", (const char *)(v2 + 4), v59) )
    {
      v118 = *((_DWORD *)this + 903);
      v119 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 903) = v119;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"fixedSequenceInfraReservedTime";
      goto LABEL_183;
    }
  }
  v60 = strnlen("freeze_min_ext", 0x80uLL);
  if ( v60 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v61 = strlen("freeze_min_ext");
    if ( !strncmp("freeze_min_ext", (const char *)(v2 + 4), v61) )
    {
      v118 = *((_DWORD *)this + 1007);
      v119 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 1007) = v119;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"freeze_min_ext";
      goto LABEL_183;
    }
  }
  v62 = strnlen("guardTime", 0x80uLL);
  if ( v62 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v63 = strlen("guardTime");
    if ( !strncmp("guardTime", (const char *)(v2 + 4), v63) )
    {
      v118 = *((_DWORD *)this + 910);
      v119 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 910) = v119;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"guardTime";
      goto LABEL_183;
    }
  }
  v64 = strnlen("idle_peer_delete", 0x80uLL);
  if ( v64 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v65 = strlen("idle_peer_delete");
    if ( !strncmp("idle_peer_delete", (const char *)(v2 + 4), v65) )
    {
      v118 = *((_DWORD *)this + 1886);
      v119 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 1886) = v119;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"idle_peer_delete";
      goto LABEL_183;
    }
  }
  v66 = strnlen("infra_awdl_interface_switching", 0x80uLL);
  if ( v66 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v67 = strlen("infra_awdl_interface_switching");
    if ( !strncmp("infra_awdl_interface_switching", (const char *)(v2 + 4), v67) )
    {
      v137 = *((_DWORD *)this + 1884);
      v138 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 1884) = v138;
      if ( *(_QWORD *)(v2 + 152) )
        _userPrint((__int64)&v160, "%s : %u -> %u\n", (__int64)"infra_awdl_interface_switching", v137, v138, v68, v149);
      *(_BYTE *)(IO80211PeerManager::getController(this) + 312) = *(_QWORD *)(v2 + 136) != 0LL;
      goto LABEL_184;
    }
  }
  v69 = strnlen("insert_debug_tlv", 0x80uLL);
  if ( v69 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v70 = strlen("insert_debug_tlv");
    if ( !strncmp("insert_debug_tlv", (const char *)(v2 + 4), v70) )
    {
      v118 = *((_DWORD *)this + 1008);
      v119 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 1008) = v119;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"insert_debug_tlv";
      goto LABEL_183;
    }
  }
  v71 = strnlen("log_pkt_queue", 0x80uLL);
  if ( v71 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v72 = strlen("log_pkt_queue");
    if ( !strncmp("log_pkt_queue", (const char *)(v2 + 4), v72) )
    {
      v118 = *((_DWORD *)this + 120);
      v119 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 120) = v119;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"log_pkt_queue";
      goto LABEL_183;
    }
  }
  v73 = strnlen("low_power_min_ext", 0x80uLL);
  if ( v73 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v74 = strlen("low_power_min_ext");
    if ( !strncmp("low_power_min_ext", (const char *)(v2 + 4), v74) )
    {
      v139 = *((_DWORD *)this + 1004);
      v140 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 1004) = v140;
      if ( *(_QWORD *)(v2 + 152) )
        _userPrint((__int64)&v160, "%s : %u -> %u\n", (__int64)"low_power_min_ext", v139, v140, v75, v149);
      *((_DWORD *)this + 1244) = 11;
      goto LABEL_184;
    }
  }
  v76 = strnlen("masterHomeChannel2", 0x80uLL);
  if ( v76 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v77 = strlen("masterHomeChannel2");
    if ( !strncmp("masterHomeChannel2", (const char *)(v2 + 4), v77) )
    {
      v118 = *((_BYTE *)this + 1533);
      v141 = *(_QWORD *)(v2 + 136);
      *((_BYTE *)this + 1533) = v141;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v119 = (unsigned __int8)v141;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"masterHomeChannel2";
      goto LABEL_183;
    }
  }
  v78 = strnlen("mdns_trigger", 0x80uLL);
  if ( v78 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v79 = strlen("mdns_trigger");
    if ( !strncmp("mdns_trigger", (const char *)(v2 + 4), v79) )
    {
      v118 = *((_DWORD *)this + 1885);
      v119 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 1885) = v119;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v120 = "%s : %u -> %u\n";
      v121 = (__int64)"mdns_trigger";
      goto LABEL_183;
    }
  }
  v80 = strnlen("mdns_direct_path", 0x80uLL);
  if ( v80 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v81 = strlen("mdns_direct_path");
    if ( !strncmp("mdns_direct_path", (const char *)(v2 + 4), v81) )
    {
      v118 = *((_DWORD *)this + 946);
      v119 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 946) = v119;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v120 = "%s : %d -> %d\n";
      v121 = (__int64)"mdns_direct_path";
      goto LABEL_183;
    }
  }
  v82 = strnlen("mdns_direct_path_verbose", 0x80uLL);
  if ( v82 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v83 = strlen("mdns_direct_path_verbose");
    if ( !strncmp("mdns_direct_path_verbose", (const char *)(v2 + 4), v83) )
    {
      v142 = *((_DWORD *)this + 948);
      v143 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 948) = v143;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v144 = "%s : %d -> %d\n";
      v145 = (__int64)"mdns_direct_path_verbose";
LABEL_219:
      _userPrint((__int64)&v160, v144, v145, v142, v143, v84, v149);
      goto LABEL_184;
    }
  }
  v85 = strnlen("mdns_direct_path_never_wait", 0x80uLL);
  if ( v85 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v86 = strlen("mdns_direct_path_never_wait");
    if ( !strncmp("mdns_direct_path_never_wait", (const char *)(v2 + 4), v86) )
    {
      v142 = *((_DWORD *)this + 949);
      v143 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 949) = v143;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v144 = "%s : %d -> %d\n";
      v145 = (__int64)"mdns_direct_path_never_wait";
      goto LABEL_219;
    }
  }
  v87 = strnlen("oob_delay", 0x80uLL);
  if ( v87 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v88 = strlen("oob_delay");
    if ( !strncmp("oob_delay", (const char *)(v2 + 4), v88) )
    {
      v142 = *((_DWORD *)this + 1888);
      v143 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 1888) = v143;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v144 = "%s : %u -> %u\n";
      v145 = (__int64)"oob_delay";
      goto LABEL_219;
    }
  }
  v89 = strnlen("peer_add_rssi_threshold", 0x80uLL);
  if ( v89 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v90 = strlen("peer_add_rssi_threshold");
    if ( !strncmp("peer_add_rssi_threshold", (const char *)(v2 + 4), v90) )
    {
      v142 = *((_DWORD *)this + 365);
      v143 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 365) = v143;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v144 = "%s : %d -> %d\n";
      v145 = (__int64)"peer_add_rssi_threshold";
      goto LABEL_219;
    }
  }
  v91 = strnlen("print_all_election_id", 0x80uLL);
  if ( v91 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v92 = strlen("print_all_election_id");
    if ( !strncmp("print_all_election_id", (const char *)(v2 + 4), v92) )
    {
      v142 = *((_DWORD *)this + 366);
      v143 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 366) = v143;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v144 = "%s : %u -> %u\n";
      v145 = (__int64)"print_all_election_id";
      goto LABEL_219;
    }
  }
  v93 = strnlen("private_election_id_mask", 0x80uLL);
  if ( v93 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v94 = strlen("private_election_id_mask");
    if ( !strncmp("private_election_id_mask", (const char *)(v2 + 4), v94) )
    {
      v142 = *((_DWORD *)this + 933);
      v143 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 933) = v143;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v144 = "%s : %u -> %u\n";
      v145 = (__int64)"private_election_id_mask";
      goto LABEL_219;
    }
  }
  v95 = strnlen("refuse_scans", 0x80uLL);
  if ( v95 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v96 = strlen("refuse_scans");
    if ( !strncmp("refuse_scans", (const char *)(v2 + 4), v96) )
    {
      v142 = *((_DWORD *)this + 914);
      v143 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 914) = v143;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v144 = "%s : %u -> %u\n";
      v145 = (__int64)"refuse_scans";
      goto LABEL_219;
    }
  }
  v97 = strnlen("reservedTimeForScansLvl1", 0x80uLL);
  if ( v97 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v98 = strlen("reservedTimeForScansLvl1");
    if ( !strncmp("reservedTimeForScansLvl1", (const char *)(v2 + 4), v98) )
    {
      v142 = *((_DWORD *)this + 902);
      v143 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 902) = v143;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v144 = "%s : %u -> %u\n";
      v145 = (__int64)"reservedTimeForScansLvl1";
      goto LABEL_219;
    }
  }
  v99 = strnlen("reset_stats", 0x80uLL);
  if ( v99 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v100 = strlen("reset_stats");
    if ( !strncmp("reset_stats", (const char *)(v2 + 4), v100) )
    {
      v142 = *((_DWORD *)this + 900);
      v143 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 900) = v143;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v144 = "%s : %u -> %u\n";
      v145 = (__int64)"reset_stats";
      goto LABEL_219;
    }
  }
  v101 = strnlen("serviceInactivityTimeout", 0x80uLL);
  if ( v101 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v102 = strlen("serviceInactivityTimeout");
    if ( !strncmp("serviceInactivityTimeout", (const char *)(v2 + 4), v102) )
    {
      v142 = *((_DWORD *)this + 913);
      v143 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 913) = v143;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v144 = "%s : %u -> %u\n";
      v145 = (__int64)"serviceInactivityTimeout";
      goto LABEL_219;
    }
  }
  v103 = strnlen("verbose_master_indication", 0x80uLL);
  if ( v103 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v104 = strlen("verbose_master_indication");
    if ( !strncmp("verbose_master_indication", (const char *)(v2 + 4), v104) )
    {
      v142 = *((_DWORD *)this + 1006);
      v143 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 1006) = v143;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v144 = "%s : %u -> %u\n";
      v145 = (__int64)"verbose_master_indication";
      goto LABEL_219;
    }
  }
  v105 = strnlen("infraOnDFSChannel", 0x80uLL);
  if ( v105 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v106 = strlen("infraOnDFSChannel");
    if ( !strncmp("infraOnDFSChannel", (const char *)(v2 + 4), v106) )
    {
      *((_BYTE *)this + 3636) = *(_QWORD *)(v2 + 136) != 0LL;
      goto LABEL_184;
    }
  }
  v107 = strnlen("airplaySinkSoloModeEnabled", 0x80uLL);
  if ( v107 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v108 = strlen("airplaySinkSoloModeEnabled");
    if ( !strncmp("airplaySinkSoloModeEnabled", (const char *)(v2 + 4), v108) )
    {
      v132 = *((_DWORD *)this + 1012);
      v146 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 1012) = v146;
      if ( *(_QWORD *)(v2 + 152) )
        _userPrint((__int64)&v160, "%s : %u -> %u\n", (__int64)"airplaySinkSoloModeEnabled", v132, v146, v109, v149);
      v135 = *(_QWORD *)this;
      v136 = 13LL;
      goto LABEL_144;
    }
  }
  v110 = strnlen("enhancedMinimumMode", 0x80uLL);
  if ( v110 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v111 = strlen("enhancedMinimumMode");
    if ( !strncmp("enhancedMinimumMode", (const char *)(v2 + 4), v111) )
    {
      v132 = *((_DWORD *)this + 1014);
      v147 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 1014) = v147;
      if ( *(_QWORD *)(v2 + 152) )
        _userPrint((__int64)&v160, "%s : %u -> %u\n", (__int64)"enhancedMinimumMode", v132, v147, v112, v149);
      v135 = *(_QWORD *)this;
      v136 = 5LL;
      goto LABEL_144;
    }
  }
  v113 = strnlen("aa_use_secondary_only", 0x80uLL);
  if ( v113 == strnlen((const char *)(v2 + 4), 0x80uLL) )
  {
    v114 = strlen("aa_use_secondary_only");
    if ( !strncmp("aa_use_secondary_only", (const char *)(v2 + 4), v114) )
    {
      v142 = *((_DWORD *)this + 1013);
      v143 = *(_DWORD *)(v2 + 136);
      *((_DWORD *)this + 1013) = v143;
      if ( !*(_QWORD *)(v2 + 152) )
        goto LABEL_184;
      v144 = "%s : %u -> %u\n";
      v145 = (__int64)"aa_use_secondary_only";
      goto LABEL_219;
    }
  }
  v115 = strnlen("supportsWaitingForAllTxStatus", 0x80uLL);
  if ( v115 != strnlen((const char *)(v2 + 4), 0x80uLL)
    || (v116 = strlen("supportsWaitingForAllTxStatus"),
        strncmp("supportsWaitingForAllTxStatus", (const char *)(v2 + 4), v116)) )
  {
    *(_DWORD *)(v2 + 160) += v165;
    return ((int (__fastcall *)(IO80211AWDLPeerManager *, __int64))`vtable for'IO80211PeerManager[43])(this, v2);
  }
  v142 = *((_BYTE *)this + 562);
  v148 = *(_DWORD *)(v2 + 136);
  *((_BYTE *)this + 562) = v148 != 0;
  if ( *(_QWORD *)(v2 + 152) )
  {
    v143 = v148 != 0;
    v144 = "%s : %u -> %u\n";
    v145 = (__int64)"supportsWaitingForAllTxStatus";
    goto LABEL_219;
  }
LABEL_184:
  *(_DWORD *)(v2 + 160) += v165;
  return 0;
}
// 7D180: using guessed type char *off_7D180[21];
// 7D210: using guessed type char *off_7D210[3];
// 7D5B0: using guessed type __int64 `vtable for'IO80211PeerManager[2];

//----- (0000000000035E20) ----------------------------------------------------
__int64 __fastcall _discardAirPlayService(__int64 a1, IO80211ServiceRequestDescriptor *a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  IO80211ServiceRequestDescriptor *v5; // r15@1
  unsigned __int64 v6; // rax@1
  unsigned __int64 v7; // rax@2
  __int64 v8; // rsi@3
  signed int v9; // er14@3
  __int64 v10; // rax@4

  v4 = a4;
  v5 = a2;
  v6 = strlen("airplay");
  if ( (signed int)IO80211ServiceRequestDescriptor::hasString(a2, "airplay", v6) < 0 )
  {
    v7 = strlen("raop");
    if ( (signed int)IO80211ServiceRequestDescriptor::hasString(a2, "raop", v7) < 0 )
    {
      v8 = *(_QWORD *)v4;
      v9 = 0;
      if ( !v8 )
        return (unsigned int)v9;
      v10 = (__int64)"_discardAirPlayService: will keep\n";
      goto LABEL_5;
    }
  }
  v8 = *(_QWORD *)v4;
  v9 = 12;
  if ( v8 )
  {
    v10 = (__int64)"_discardAirPlayService: will discard\n";
LABEL_5:
    *(_QWORD *)(v8 + 80) = v10;
    (*(void (__fastcall **)(IO80211ServiceRequestDescriptor *))(*(_QWORD *)v5 + 280LL))(v5);
  }
  return (unsigned int)v9;
}

//----- (0000000000035EBA) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlSocialTimeSlots(IO80211PeerManager *this, __int64 a2)
{
  OSMetaClass *v2; // rax@1
  __int64 v3; // rax@1
  int v4; // eax@1

  LODWORD(v2) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
  v3 = OSMetaClass::getClassName(v2);
  IO80211PeerManager::logDebug(
    this,
    "%s::%s new mode %u old mode %u\n",
    v3,
    (__int64)"setAwdlSocialTimeSlots",
    *(_BYTE *)(a2 + 4),
    *((_DWORD *)this + 1012));
  v4 = *(_BYTE *)(a2 + 4);
  if ( *((_DWORD *)this + 1012) != v4 )
  {
    *((_DWORD *)this + 1012) = v4;
    (*(void (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 320LL))(this, 13LL);
  }
  return 0LL;
}

//----- (0000000000035F28) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlSocialTimeSlots(IO80211PeerManager *this, __int64 a2)
{
  OSMetaClass *v2; // rax@1
  __int64 v3; // rax@1
  __int64 v4; // r9@1

  LODWORD(v2) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
  v3 = OSMetaClass::getClassName(v2);
  IO80211PeerManager::logDebug(this, 0x2000000000LL, "%s::%s\n", v3, (__int64)"getAwdlSocialTimeSlots", v4);
  *(_BYTE *)(a2 + 4) = *((_BYTE *)this + 4048);
  return 0LL;
}

//----- (0000000000035F7A) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlBtleStateParams(IO80211PeerManager *this, __int64 a2)
{
  OSMetaClass *v2; // rax@2
  __int64 v3; // rax@2
  __int64 v4; // r9@2

  if ( IO80211PeerManager::shouldLog(this, 32LL) )
  {
    LODWORD(v2) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, 32LL);
    v3 = OSMetaClass::getClassName(v2);
    IO80211PeerManager::logDebug(this, 32LL, "%s::%s\n", v3, (__int64)"getAwdlBtleStateParams", v4);
  }
  memcpy((void *)(a2 + 4), (char *)this + 3680, 6uLL);
  *(_WORD *)(a2 + 10) = *((_WORD *)this + 4068);
  *(_DWORD *)(a2 + 12) = *((_DWORD *)this + 1856);
  memcpy((void *)(a2 + 16), (char *)this + 7428, 0xCuLL);
  return 0LL;
}

//----- (0000000000036014) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlTxCalPeriod(IO80211PeerManager *this, void *a2)
{
  signed int v2; // ebx@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  __int64 v5; // r9@2

  v2 = IO80211PeerManager::do_ioctl(this, 0xC02869C9, 0xE2u, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    3223873993LL);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't get txcal period: %d\n",
      v4,
      (__int64)"getAwdlTxCalPeriod",
      (unsigned int)v2,
      v5);
  }
  return (unsigned int)v2;
}

//----- (0000000000036070) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlTxCalPeriod(IO80211PeerManager *this, void *a2)
{
  signed int v2; // ebx@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2

  v2 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0xE2u, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    2150132168LL);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't set txcal period, val %u, ret %d\n",
      v4,
      (__int64)"setAwdlTxCalPeriod",
      *((_DWORD *)a2 + 1),
      (unsigned int)v2);
  }
  return (unsigned int)v2;
}

//----- (00000000000360D8) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlAfTxMode(IO80211PeerManager *this, void *a2)
{
  OSMetaClass *v2; // rax@2
  __int64 v3; // rax@2
  __int64 v4; // r9@2
  signed int v5; // er15@3
  OSMetaClass *v6; // rax@4
  __int64 v7; // rdx@4
  __int64 v8; // r8@4
  const char *v9; // rsi@4
  __int64 v10; // rcx@4
  __int64 v11; // r9@4
  OSMetaClass *v12; // rax@6

  if ( IO80211PeerManager::shouldLog(this, 32LL) )
  {
    LODWORD(v2) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, 32LL);
    v3 = OSMetaClass::getClassName(v2);
    IO80211PeerManager::logDebug(this, 32LL, "%s::%s\n", v3, (__int64)"getAwdlAfTxMode", v4);
  }
  v5 = IO80211PeerManager::do_ioctl(this, 0xC02869C9, 0xD0u, a2);
  if ( v5 )
  {
    LODWORD(v6) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    3223873993LL);
    v7 = OSMetaClass::getClassName(v6);
    v8 = *((_DWORD *)this + 904);
    v9 = "%s::%s can't get af tx mode, has %u, ret %d\n";
    v10 = (__int64)"getAwdlAfTxMode";
    v11 = (unsigned int)v5;
LABEL_7:
    IO80211PeerManager::logDebug(this, v9, v7, v10, v8, v11);
    return (unsigned int)v5;
  }
  if ( *((_DWORD *)this + 904) != *((_DWORD *)a2 + 1) )
  {
    LODWORD(v12) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                     this,
                     3223873993LL);
    v7 = OSMetaClass::getClassName(v12);
    v8 = *((_DWORD *)this + 904);
    v11 = *((_DWORD *)a2 + 1);
    v9 = "%s::%s mismatch want %u got %u\n";
    v10 = (__int64)"getAwdlAfTxMode";
    goto LABEL_7;
  }
  return (unsigned int)v5;
}

//----- (00000000000361C8) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlAfTxMode(IO80211PeerManager *this, void *a2)
{
  OSMetaClass *v2; // rax@2
  __int64 v3; // rax@2
  signed int v4; // er15@3
  OSMetaClass *v5; // rax@4
  __int64 v6; // rax@4

  if ( IO80211PeerManager::shouldLog(this, 32LL) )
  {
    LODWORD(v2) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, 32LL);
    v3 = OSMetaClass::getClassName(v2);
    IO80211PeerManager::logDebug(this, 32LL, "%s::%s val %u\n", v3, (__int64)"setAwdlAfTxMode", *((_DWORD *)a2 + 1));
  }
  v4 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0xD0u, a2);
  if ( v4 )
  {
    LODWORD(v5) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    2150132168LL);
    v6 = OSMetaClass::getClassName(v5);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't set af tx mode, val %u, ret %d\n",
      v6,
      (__int64)"setAwdlAfTxMode",
      *((_DWORD *)a2 + 1),
      (unsigned int)v4);
  }
  else
  {
    *((_DWORD *)this + 904) = *((_DWORD *)a2 + 1);
  }
  return (unsigned int)v4;
}

//----- (0000000000036286) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlBtlePeerIndication(IO80211PeerManager *this, __int64 a2)
{
  __int64 v2; // r12@1
  OSMetaClass *v3; // rax@1
  __int64 v4; // rax@1
  __int64 v5; // r9@1
  int v6; // eax@1
  signed __int64 v7; // rsi@3
  __int64 v8; // rbx@3
  OSMetaClass *v9; // rax@4
  __int64 v10; // rcx@4
  __int64 v11; // r9@4
  int v12; // ST20_4@4
  int v13; // ST18_4@4
  int v14; // ST10_4@4
  int v15; // ST08_4@4
  int v16; // ST00_4@4
  const char *v17; // rdx@4
  signed __int64 v18; // rsi@5
  __int64 v19; // rbx@5
  OSMetaClass *v20; // rax@6
  int v21; // ST20_4@6
  int v22; // ST18_4@6
  int v23; // ST10_4@6
  int v24; // ST08_4@6
  int v25; // ST00_4@6
  OSMetaClass *v26; // rax@8
  int v27; // ST20_4@8
  int v28; // ST18_4@8
  int v29; // ST10_4@8
  int v30; // ST08_4@8
  int v31; // ST00_4@8
  OSMetaClass *v32; // rax@9
  OSMetaClass *v33; // rax@10
  int v34; // ST20_4@10
  int v35; // ST18_4@10
  int v36; // ST10_4@10
  int v37; // ST08_4@10
  int v38; // ST00_4@10
  OSMetaClass *v39; // rax@11
  int v40; // ST20_4@11
  int v41; // ST18_4@11
  int v42; // ST10_4@11
  int v43; // ST08_4@11
  int v44; // ST00_4@11

  v2 = a2;
  LODWORD(v3) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
  v4 = OSMetaClass::getClassName(v3);
  IO80211PeerManager::logDebug(this, 0x2000000000LL, "%s::%s\n", v4, (__int64)"setAwdlBtlePeerIndication", v5);
  v6 = *(_DWORD *)(a2 + 4);
  switch ( v6 )
  {
    case 6:
      v18 = a2 + 8;
      v19 = IO80211PeerManager::findPeer(this, (unsigned __int8 *)(v2 + 8), 1);
      if ( v19 )
      {
        LODWORD(v20) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, v18);
        v10 = OSMetaClass::getClassName(v20);
        v11 = *(_BYTE *)(v19 + 32);
        v21 = *(_BYTE *)(v19 + 37);
        v22 = *(_BYTE *)(v19 + 36);
        v23 = *(_BYTE *)(v19 + 35);
        v24 = *(_BYTE *)(v19 + 34);
        v25 = *(_BYTE *)(v19 + 33);
        v17 = "%s::%s BT-LE requested peer UPDATE for %02x:%02x:%02x:%02x:%02x:%02x\n";
      }
      else
      {
        LODWORD(v39) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, v18);
        v10 = OSMetaClass::getClassName(v39);
        v11 = *(_BYTE *)(v2 + 8);
        v40 = *(_BYTE *)(v2 + 13);
        v41 = *(_BYTE *)(v2 + 12);
        v42 = *(_BYTE *)(v2 + 11);
        v43 = *(_BYTE *)(v2 + 10);
        v44 = *(_BYTE *)(v2 + 9);
        v17 = "%s::%s BT-LE requested peer UPDATE for unknown peer %02x:%02x:%02x:%02x:%02x:%02x\n";
      }
      break;
    case 3:
      v7 = a2 + 8;
      v8 = IO80211PeerManager::findPeer(this, (unsigned __int8 *)(v2 + 8), 1);
      if ( v8 )
      {
        LODWORD(v9) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, v7);
        v10 = OSMetaClass::getClassName(v9);
        v11 = *(_BYTE *)(v8 + 32);
        v12 = *(_BYTE *)(v8 + 37);
        v13 = *(_BYTE *)(v8 + 36);
        v14 = *(_BYTE *)(v8 + 35);
        v15 = *(_BYTE *)(v8 + 34);
        v16 = *(_BYTE *)(v8 + 33);
        v17 = "%s::%s BT-LE requested peer DELETION for %02x:%02x:%02x:%02x:%02x:%02x\n";
      }
      else
      {
        LODWORD(v33) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, v7);
        v10 = OSMetaClass::getClassName(v33);
        v11 = *(_BYTE *)(v2 + 8);
        v34 = *(_BYTE *)(v2 + 13);
        v35 = *(_BYTE *)(v2 + 12);
        v36 = *(_BYTE *)(v2 + 11);
        v37 = *(_BYTE *)(v2 + 10);
        v38 = *(_BYTE *)(v2 + 9);
        v17 = "%s::%s BT-LE requested peer DELETION for UNKNOWN peer %02x:%02x:%02x:%02x:%02x:%02x\n";
      }
      break;
    case 1:
      LODWORD(v26) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       0x2000000000LL);
      v10 = OSMetaClass::getClassName(v26);
      v11 = *(_BYTE *)(a2 + 8);
      v27 = *(_BYTE *)(a2 + 13);
      v28 = *(_BYTE *)(a2 + 12);
      v29 = *(_BYTE *)(a2 + 11);
      v30 = *(_BYTE *)(a2 + 10);
      v31 = *(_BYTE *)(a2 + 9);
      v17 = "%s::%s BT-LE FOUND peer %02x:%02x:%02x:%02x:%02x:%02x\n";
      break;
    default:
      LODWORD(v32) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       0x2000000000LL);
      v10 = OSMetaClass::getClassName(v32);
      v11 = *(_DWORD *)(a2 + 4);
      v17 = "%s::%s unsupported operation %d\n";
      break;
  }
  IO80211PeerManager::logDebug(this, 0x2000000000LL, v17, v10, (__int64)"setAwdlBtlePeerIndication", v11);
  return 0LL;
}

//----- (0000000000036502) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlBtleEnableSynchWithParams(IO80211AWDLPeerManager *this, __int64 a2)
{
  int v2; // eax@1
  char v3; // cl@1
  OSMetaClass *v4; // rax@3
  __int64 v5; // rax@3
  __int64 v6; // r9@3
  unsigned int v7; // er12@3
  OSMetaClass *v8; // rax@6
  __int64 v9; // rcx@6
  char v10[8]; // r9@6
  const char *v11; // rdx@8
  __int64 v12; // r8@8
  OSMetaClass *v13; // rax@9
  OSMetaClass *v14; // rax@13
  __int64 v15; // rax@13
  __int64 v16; // r9@13
  int v18; // [sp+10h] [bp-30h]@5
  int v19; // [sp+14h] [bp-2Ch]@5
  int v20; // [sp+18h] [bp-28h]@5

  v2 = *(_DWORD *)(a2 + 4);
  v3 = *((_BYTE *)this + 7440);
  if ( v2 )
  {
    if ( v3 )
    {
      LODWORD(v4) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
      v5 = OSMetaClass::getClassName(v4);
      IO80211PeerManager::logDebug(
        this,
        0x2000000000LL,
        "%s::%s ERROR! AWDL already enabled by BTLE!\n",
        v5,
        (__int64)"setAwdlBtleEnableSynchWithParams",
        v6);
      return 37;
    }
  }
  else
  {
    v2 = 0;
    if ( !v3 )
    {
      LODWORD(v14) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
      v15 = OSMetaClass::getClassName(v14);
      IO80211PeerManager::logDebug(
        this,
        0x2000000000LL,
        "%s::%s ERROR! AWDL not enabled by BTLE!\n",
        v15,
        (__int64)"setAwdlBtleEnableSynchWithParams",
        v16);
      return 6;
    }
  }
  v18 = *(_DWORD *)a2;
  v19 = v2;
  v20 = 0;
  v7 = IO80211AWDLPeerManager::setAwdlSyncEnabled(this, &v18);
  if ( v7 )
  {
    LODWORD(v8) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v18);
    v9 = OSMetaClass::getClassName(v8);
    *(_QWORD *)v10 = "DISABLE";
    if ( *(_DWORD *)(a2 + 4) )
      *(_QWORD *)v10 = "ENABLE";
    v11 = "%s::%s Failed to %s AWDL by BTLE %x\n";
    v12 = (__int64)"setAwdlBtleEnableSynchWithParams";
  }
  else
  {
    *((_BYTE *)this + 7440) = *(_DWORD *)(a2 + 4) != 0;
    LODWORD(v13) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v18);
    v9 = OSMetaClass::getClassName(v13);
    *(_QWORD *)v10 = "DISABLED";
    if ( *((_BYTE *)this + 7440) )
      *(_QWORD *)v10 = "ENABLED";
    v11 = "%s::%s AWDL %s by BTLE (%x)\n";
    v12 = (__int64)"setAwdlBtleEnableSynchWithParams";
    v7 = 0;
  }
  IO80211PeerManager::logDebug(this, 0x2000000000LL, v11, v9, v12, *(__int64 *)v10);
  return v7;
}

//----- (000000000003667E) ----------------------------------------------------
int __fastcall IO80211AWDLPeerManager::handleDebugCmd_infra_rst(IO80211PeerManager *this, __int64 a2)
{
  IO80211PeerManager *v2; // rbx@1
  signed __int64 v3; // r14@2
  int v4; // eax@2
  __int64 v5; // rdi@2
  __int64 v6; // rdx@3
  __int64 v7; // rcx@3

  v2 = this;
  IO80211PeerManager::lockDataPath(this);
  if ( *((_QWORD *)this + 11) )
  {
    v3 = a2 + 1352;
    v4 = memcmp((const void *)(a2 + 1352), &null_address, 6uLL);
    v5 = *((_QWORD *)this + 11);
    a2 = (__int64)_resetInfra;
    if ( v4 )
    {
      v6 = (__int64)v2;
      v7 = v3;
    }
    else
    {
      v7 = 0LL;
      v6 = (__int64)v2;
    }
    IO80211CommandQueue::map(v5, (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_resetInfra, v6, v7, 0LL, -1);
  }
  return IO80211PeerManager::unlockDataPath(v2, a2);
}
// 77FDC: using guessed type int null_address;

//----- (00000000000366F1) ----------------------------------------------------
signed __int64 __fastcall _resetInfra(__int64 a1, __int64 a2, const void *a3)
{
  int v3; // ecx@2
  signed __int64 result; // rax@2

  if ( a3 )
  {
    v3 = memcmp((const void *)(a2 + 32), a3, 6uLL);
    result = 0LL;
    if ( !v3 )
    {
      *(_DWORD *)(a2 + 1188) = 0;
      result = 3LL;
    }
  }
  else
  {
    *(_DWORD *)(a2 + 1188) = 0;
    result = 0LL;
  }
  return result;
}

//----- (0000000000036740) ----------------------------------------------------
int __fastcall IO80211AWDLPeerManager::handleDebugCmd_iping(IO80211AWDLPeerManager *this, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  unsigned __int64 v4; // rax@1
  __int64 v5; // r12@1
  __int64 v6; // r13@1
  __int64 v7; // rax@1
  int v8; // ST20_4@1
  int v9; // ST18_4@1
  int v10; // ST10_4@1
  int v11; // ST08_4@1
  unsigned __int8 *v12; // rsi@1
  __int64 v13; // rax@1
  __int64 v14; // rsi@2
  OSMetaClass *v15; // rax@3
  __int64 v16; // rax@3
  __int64 v17; // r8@3
  __int64 v18; // r9@3
  char v20; // [sp+0h] [bp-50h]@1

  v3 = a3;
  v4 = getAbsoluteTime();
  v5 = 19342813113834067LL * (v4 >> 9) >> 64 >> 11;
  v6 = 633825300114115LL * (v4 >> 15) >> 64 >> 20;
  v7 = (__int64)IO80211PeerManager::getBSDName(this);
  v8 = *(_BYTE *)(a2 + 1357);
  v9 = *(_BYTE *)(a2 + 1356);
  v10 = *(_BYTE *)(a2 + 1355);
  v11 = *(_BYTE *)(a2 + 1354);
  _userPrint(
    v3,
    "%llu.%03llu <%s> iping %02X:%02X:%02X:%02X:%02X:%02X\n",
    v5,
    v6,
    v7,
    *(_BYTE *)(a2 + 1352),
    *(_BYTE *)(a2 + 1353));
  IO80211PeerManager::lockDataPath(this);
  v12 = (unsigned __int8 *)(a2 + 1352);
  v13 = IO80211PeerManager::findPeer(this, v12, 1);
  if ( v13 )
  {
    v14 = v13;
    IO80211AWDLPeerManager::peerDoInfraPing(this, (IO80211AWDLPeer *)v13);
  }
  else
  {
    LODWORD(v15) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, unsigned __int8 *))(*(_QWORD *)this + 56LL))(
                     this,
                     v12);
    v16 = OSMetaClass::getClassName(v15);
    v14 = (__int64)"%s::%s peer not found\n";
    _userPrint(v3, "%s::%s peer not found\n", v16, (__int64)"handleDebugCmd_iping", v17, v18, v20);
  }
  return IO80211PeerManager::unlockDataPath(this, v14);
}

//----- (0000000000036868) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::handleDebugCmd_presence(IO80211PeerManager *this, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  unsigned __int64 v4; // r13@1
  __int64 v5; // r14@1
  __int64 v6; // rcx@3
  unsigned __int64 v7; // r13@3
  __int64 v8; // r8@3
  __int64 v9; // r9@3
  char v10; // al@3
  int v11; // edx@3
  int v12; // esi@3
  int v13; // ebx@3
  int v14; // er15@4
  ether_addr *v16; // [sp+30h] [bp-70h]@1
  __int64 v17; // [sp+38h] [bp-68h]@1
  char v18[2]; // [sp+40h] [bp-60h]@1
  __int16 v19; // [sp+42h] [bp-5Eh]@2
  char v20; // [sp+44h] [bp-5Ch]@2
  __int64 v21; // [sp+70h] [bp-30h]@1

  v17 = a3;
  v3 = a2;
  v21 = *(_QWORD *)off_7B078[0];
  v4 = getAbsoluteTime();
  memset(v18, 0, 0x30uLL);
  IO80211PeerManager::lockDataPath(this);
  v16 = (ether_addr *)(a2 + 1352);
  v5 = IO80211PeerManager::findPeer(this, (unsigned __int8 *)(a2 + 1352), 1);
  if ( v5 )
  {
    *(_QWORD *)(v5 + 160) = getAbsoluteTime();
    v19 = *(_WORD *)(v5 + 1678);
    strcpy(v18, "\x01");
    memcpy(&v20, (const void *)(v5 + 1680), 0x20uLL);
  }
  v6 = 19342813113834067LL * (v4 >> 9) >> 64 >> 11;
  v7 = v4 >> 15;
  v8 = *(_BYTE *)(a2 + 1352);
  v9 = *(_BYTE *)(a2 + 1353);
  v10 = *(_BYTE *)(a2 + 1354);
  v11 = *(_BYTE *)(a2 + 1355);
  v12 = *(_BYTE *)(a2 + 1356);
  v13 = *(_BYTE *)(v3 + 1357);
  if ( v5 )
    v14 = *(_WORD *)(v5 + 1678);
  _userPrint(
    v17,
    "%llu.%03llu posting peer presence %02X:%02X:%02X:%02X:%02X:%02X peer %p SUI %u\n",
    v6,
    633825300114115LL * v7 >> 64 >> 20,
    v8,
    v9,
    v10);
  IO80211PeerManager::unlockDataPath(
    this,
    (__int64)"%llu.%03llu posting peer presence %02X:%02X:%02X:%02X:%02X:%02X peer %p SUI %u\n");
  IO80211PeerManager::postPeerPresence(this, v16, -40, 0, 0, v18);
  return *(_QWORD *)off_7B078[0];
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (00000000000369EE) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::handleDebugCmd_absence(IO80211PeerManager *this, __int64 a2, __int64 a3)
{
  __int64 v3; // ST30_8@1
  __int64 v4; // rbx@1
  ether_addr *v5; // r14@1
  unsigned __int64 v6; // r13@1
  __int64 v7; // rsi@1
  int v8; // ST18_4@1
  int v9; // ST10_4@1
  int v10; // ST08_4@1
  __int64 result; // rax@1
  IO80211VirtualInterface *v12; // rdi@1

  v3 = a3;
  v4 = a2;
  v5 = (ether_addr *)(a2 + 1352);
  v6 = getAbsoluteTime();
  IO80211PeerManager::lockDataPath(this);
  v7 = a2 + 1352;
  IO80211PeerManager::findPeer(this, (unsigned __int8 *)v7, 1);
  IO80211PeerManager::unlockDataPath(this, v7);
  v8 = *(_BYTE *)(v4 + 1357);
  v9 = *(_BYTE *)(v4 + 1356);
  v10 = *(_BYTE *)(v4 + 1355);
  result = _userPrint(
             v3,
             "%llu.%03llu posting peer absence %02X:%02X:%02X:%02X:%02X:%02X peer %p\n",
             19342813113834067LL * (v6 >> 9) >> 64 >> 11,
             633825300114115LL * (v6 >> 15) >> 64 >> 20,
             *(_BYTE *)(v4 + 1352),
             *(_BYTE *)(v4 + 1353),
             *(_BYTE *)(v4 + 1354));
  v12 = (IO80211VirtualInterface *)*((_QWORD *)this + 16);
  if ( v12 )
    result = IO80211VirtualInterface::postPeerAbsence(v12, v5);
  return result;
}

//----- (0000000000036AFC) ----------------------------------------------------
int __fastcall IO80211AWDLPeerManager::handleDebugCmd_iredirect(IO80211PeerManager *this, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@1
  __int64 v6; // r12@1
  OSMetaClass *v7; // rax@2
  __int64 v8; // rax@2
  int v9; // ST20_4@2
  int v10; // ST18_4@2
  int v11; // ST10_4@2
  int v12; // ST08_4@2
  __int64 v13; // rsi@2
  OSMetaClass *v14; // rax@3
  __int64 v15; // rax@3
  __int64 v16; // r8@3
  __int64 v17; // r9@3
  char v19; // [sp+0h] [bp-50h]@0

  v3 = a3;
  v4 = a2;
  IO80211PeerManager::lockDataPath(this);
  v5 = IO80211PeerManager::findPeer(this, (unsigned __int8 *)(a2 + 1352), 1);
  v6 = v5;
  if ( v5 )
  {
    *(_BYTE *)(v5 + 1194) = 2 * (*(_BYTE *)(v5 + 1194) != 2);
    LODWORD(v7) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
    v8 = OSMetaClass::getClassName(v7);
    v9 = *(_BYTE *)(v6 + 1194);
    v10 = *(_BYTE *)(a2 + 1357);
    v11 = *(_BYTE *)(a2 + 1356);
    v12 = *(_BYTE *)(a2 + 1355);
    v13 = (__int64)"%s:%s infra redirect %02X:%02X:%02X:%02X:%02X:%02X -> %u\n";
    _userPrint(
      v3,
      "%s:%s infra redirect %02X:%02X:%02X:%02X:%02X:%02X -> %u\n",
      v8,
      (__int64)"handleDebugCmd_iredirect",
      *(_BYTE *)(v4 + 1352),
      *(_BYTE *)(v4 + 1353),
      *(_BYTE *)(v4 + 1354));
  }
  else
  {
    LODWORD(v14) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
    v15 = OSMetaClass::getClassName(v14);
    v13 = (__int64)"%s::%s peer not found\n";
    _userPrint(v3, "%s::%s peer not found\n", v15, (__int64)"handleDebugCmd_iredirect", v16, v17, v19);
  }
  return IO80211PeerManager::unlockDataPath(this, v13);
}

//----- (0000000000036C08) ----------------------------------------------------
int __fastcall IO80211AWDLPeerManager::handleDebugCmd_aredirect(IO80211AWDLPeerManager *this, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@1
  __int64 v6; // r12@1
  OSMetaClass *v7; // rax@2
  __int64 v8; // rax@2
  int v9; // ST20_4@2
  int v10; // ST18_4@2
  int v11; // ST10_4@2
  int v12; // ST08_4@2
  __int64 v13; // rsi@2
  OSMetaClass *v14; // rax@3
  __int64 v15; // rax@3
  __int64 v16; // r8@3
  __int64 v17; // r9@3
  char v19; // [sp+0h] [bp-50h]@0

  v3 = a3;
  v4 = a2;
  IO80211PeerManager::lockDataPath(this);
  v5 = IO80211AWDLPeerManager::findInfraPeer(this, (unsigned __int8 *)(a2 + 1352));
  v6 = v5;
  if ( v5 )
  {
    *(_BYTE *)(v5 + 1194) = *(_BYTE *)(v5 + 1194) != 1;
    LODWORD(v7) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
    v8 = OSMetaClass::getClassName(v7);
    v9 = *(_BYTE *)(v6 + 1194);
    v10 = *(_BYTE *)(a2 + 1357);
    v11 = *(_BYTE *)(a2 + 1356);
    v12 = *(_BYTE *)(a2 + 1355);
    v13 = (__int64)"%s:%s awdl redirect %02X:%02X:%02X:%02X:%02X:%02X -> %u\n";
    _userPrint(
      v3,
      "%s:%s awdl redirect %02X:%02X:%02X:%02X:%02X:%02X -> %u\n",
      v8,
      (__int64)"handleDebugCmd_aredirect",
      *(_BYTE *)(v4 + 1352),
      *(_BYTE *)(v4 + 1353),
      *(_BYTE *)(v4 + 1354));
  }
  else
  {
    LODWORD(v14) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
    v15 = OSMetaClass::getClassName(v14);
    v13 = (__int64)"%s::%s peer not found\n";
    _userPrint(v3, "%s::%s peer not found\n", v15, (__int64)"handleDebugCmd_aredirect", v16, v17, v19);
  }
  return IO80211PeerManager::unlockDataPath(this, v13);
}

//----- (0000000000036D0C) ----------------------------------------------------
int __fastcall IO80211AWDLPeerManager::handleDebugCmd_poll(IO80211PeerManager *this, __int64 a2)
{
  __int64 v3; // [sp+8h] [bp-18h]@1
  int v4; // [sp+10h] [bp-10h]@1
  char v5; // [sp+14h] [bp-Ch]@1

  v3 = a2 + 1352;
  v4 = 0;
  v5 = 1;
  IO80211PeerManager::lockDataPath(this);
  IO80211CommandQueue::map(
    *((_QWORD *)this + 11),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_setNeighborMonitoring,
    (__int64)this,
    (__int64)&v3,
    0LL,
    -1);
  return IO80211PeerManager::unlockDataPath(this, (__int64)_setNeighborMonitoring);
}

//----- (0000000000036D62) ----------------------------------------------------
signed __int64 __fastcall _setNeighborMonitoring(__int64 a1, __int64 a2, const void **a3)
{
  const void **v3; // rbx@1
  int v4; // ecx@1
  signed __int64 result; // rax@1

  v3 = a3;
  v4 = memcmp((const void *)(a2 + 32), *a3, 6uLL);
  result = 0LL;
  if ( !v4 )
  {
    if ( *((_BYTE *)v3 + 12) )
      *(_BYTE *)(a2 + 1200) = *(_BYTE *)(a2 + 1200) == 0;
    else
      *(_BYTE *)(a2 + 1200) = *((_BYTE *)v3 + 8);
    result = 3LL;
  }
  return result;
}

//----- (0000000000036DB4) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::handleDebugCmd_primary(IO80211PeerManager *this, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 v4; // [sp+8h] [bp-68h]@1
  __int64 v5; // [sp+10h] [bp-60h]@1
  __int64 v6; // [sp+18h] [bp-58h]@1
  __int64 v7; // [sp+20h] [bp-50h]@1
  __int64 v8; // [sp+28h] [bp-48h]@1
  __int64 v9; // [sp+30h] [bp-40h]@1
  __int64 v10; // [sp+38h] [bp-38h]@1
  __int64 v11; // [sp+40h] [bp-30h]@1
  __int64 v12; // [sp+48h] [bp-28h]@1
  __int64 v13; // [sp+50h] [bp-20h]@1
  __int64 v14; // [sp+58h] [bp-18h]@1

  v2 = off_7B078[0];
  v14 = *(_QWORD *)off_7B078[0];
  v13 = 0LL;
  v12 = 0LL;
  v11 = 0LL;
  v10 = 0LL;
  v9 = 0LL;
  v8 = 0LL;
  v7 = 0LL;
  v6 = 0LL;
  v5 = 0LL;
  v4 = 0LL;
  LODWORD(v4) = 1;
  memcpy((char *)&v4 + 4, (const void *)(a2 + 1352), 6uLL);
  LODWORD(v13) = 1;
  IO80211PeerManager::lockDataPath(this);
  IO80211CommandQueue::map(
    *((_QWORD *)this + 11),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_setPrimary,
    (__int64)this,
    (__int64)&v4,
    0LL,
    -1);
  IO80211PeerManager::unlockDataPath(this, (__int64)_setPrimary);
  return *(_QWORD *)v2;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000036E8A) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::handleDebugCmd_force(IO80211AWDLPeerManager *this, __int64 a2, __int64 a3)
{
  __int64 v3; // r12@1
  __int64 v4; // rsi@1
  __int64 v5; // rbx@1
  int v6; // eax@2
  OSMetaClass *v7; // rax@3
  __int64 v8; // rax@3
  int v9; // ST48_4@3
  int v10; // ST40_4@3
  int v11; // ST38_4@3
  int v12; // ST30_4@3
  int v13; // ST28_4@3
  int v14; // ST20_4@3
  int v15; // ST18_4@3
  int v16; // ST10_4@3
  int v17; // ST08_4@3
  __int64 v19; // [sp+60h] [bp-30h]@1

  v19 = a3;
  v3 = a2;
  IO80211PeerManager::lockDataPath(this);
  v4 = a2 + 1352;
  v5 = IO80211AWDLPeerManager::findInfraPeer(this, (unsigned __int8 *)v4);
  if ( v5 )
    v6 = *(_BYTE *)(v5 + 1203);
  IO80211PeerManager::unlockDataPath(this, v4);
  LODWORD(v7) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
  v8 = OSMetaClass::getClassName(v7);
  v9 = *(_BYTE *)(v5 + 37);
  v10 = *(_BYTE *)(v5 + 36);
  v11 = *(_BYTE *)(v5 + 35);
  v12 = *(_BYTE *)(v5 + 34);
  v13 = *(_BYTE *)(v5 + 33);
  v14 = *(_BYTE *)(v5 + 32);
  v15 = *(_BYTE *)(v3 + 1357);
  v16 = *(_BYTE *)(v3 + 1356);
  v17 = *(_BYTE *)(v3 + 1355);
  _userPrint(
    v19,
    (char *)&stru_6F47B,
    v8,
    (__int64)"handleDebugCmd_force",
    *(_BYTE *)(v3 + 1352),
    *(_BYTE *)(v3 + 1353),
    *(_BYTE *)(v3 + 1354));
  return IO80211AWDLPeerManager::forceRoamToPeersAP(this, &stru_6F47B);
}

//----- (0000000000036FAA) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::handleDebugCmd_chanlist(IO80211PeerManager *this, __int64 a2, __int64 a3)
{
  __int64 v3; // r13@1
  __int64 v4; // rbx@1
  __int64 v5; // rcx@1
  __int64 v6; // r8@1
  __int64 v7; // r9@1
  int v8; // er12@1
  OSMetaClass *v9; // rax@2
  __int64 v10; // rax@2
  __int64 v11; // r9@2
  __int64 v12; // rcx@3
  __int64 v13; // r8@3
  __int64 v14; // r9@3
  char v15; // ST00_1@3
  int v16; // eax@3
  __int64 v17; // r14@4
  __int64 v18; // r8@5
  __int64 v19; // r9@7
  __int64 v20; // rax@9
  int v21; // ST20_4@11
  int v22; // ST18_4@11
  char v24; // [sp+0h] [bp-890h]@0
  int v25; // [sp+38h] [bp-858h]@1
  int v26; // [sp+3Ch] [bp-854h]@1
  int *v27; // [sp+40h] [bp-850h]@1
  int v28; // [sp+50h] [bp-840h]@1
  char v29; // [sp+54h] [bp-83Ch]@3
  unsigned __int16 v30; // [sp+58h] [bp-838h]@3
  __int16 v31[128]; // [sp+5Ah] [bp-836h]@11
  char v32[128]; // [sp+15Ah] [bp-736h]@11
  char v33[128]; // [sp+1DAh] [bp-6B6h]@5
  char v34[128]; // [sp+25Ah] [bp-636h]@7
  char v35[128]; // [sp+2DAh] [bp-5B6h]@9
  char v36[128]; // [sp+35Ah] [bp-536h]@11
  char v37[130]; // [sp+3DAh] [bp-4B6h]@11
  int v38[128]; // [sp+45Ch] [bp-434h]@11
  int v39[129]; // [sp+65Ch] [bp-234h]@11
  __int64 v40; // [sp+860h] [bp-30h]@1

  v3 = a3;
  v4 = off_7B078[0];
  v40 = *(_QWORD *)off_7B078[0];
  __bzero(&v28, 2060LL);
  v28 = 1;
  v25 = -1071093303;
  v26 = 207;
  v27 = &v28;
  v8 = IO80211PeerManager::ioctl_internal(this, (__int64)&v25);
  if ( v8 )
  {
    LODWORD(v9) = (*(int (__fastcall **)(IO80211PeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v25);
    v10 = OSMetaClass::getClassName(v9);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s  Unable to get non DFS 40MHz channels ret %d\n",
      v10,
      (__int64)"handleDebugCmd_chanlist",
      (unsigned int)v8,
      v11);
  }
  else
  {
    _userPrint(v3, "channelListInfo.countryCode = %s\n", (__int64)&v29, v5, v6, v7, v24);
    _userPrint(v3, "\t.numChanSpecs = %d\n", v30, v12, v13, v14, v15);
    v16 = v30;
    if ( v30 )
    {
      v17 = 0LL;
      do
      {
        v18 = (__int64)"N";
        if ( v33[v17] )
          v18 = (__int64)"Y";
        v19 = (__int64)"N";
        if ( v34[v17] )
          v19 = (__int64)"Y";
        v20 = (__int64)"N";
        if ( v35[v17] )
          v20 = (__int64)"Y";
        v36[v17];
        v37[v17];
        v21 = v39[v17];
        v22 = v38[v17];
        _userPrint(
          v3,
          "\t chanSpec=%04x chanNum=%3d indoorRestricted=%s  radarDFS=%s  passive=%s  support40MHz=%s support80MHz=%s perChanInfo=%04x chanBitmap=%04x \n",
          (unsigned __int16)v31[v17],
          (unsigned __int8)v32[v17],
          v18,
          v19,
          v20);
        ++v17;
        v16 = v30;
      }
      while ( (signed int)v17 < v30 );
    }
    *(_DWORD *)(a2 + 1288) = v16;
    v4 = off_7B078[0];
  }
  return *(_QWORD *)v4;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);
// 36FAA: using guessed type char var_6B6[128];
// 36FAA: using guessed type char var_636[128];
// 36FAA: using guessed type char var_5B6[128];
// 36FAA: using guessed type char var_536[128];
// 36FAA: using guessed type __int16 var_836[128];
// 36FAA: using guessed type char var_4B6[130];
// 36FAA: using guessed type char var_736[128];
// 36FAA: using guessed type int var_434[128];
// 36FAA: using guessed type int var_234[129];

//----- (0000000000037192) ----------------------------------------------------
int __fastcall IO80211AWDLPeerManager::handleDebugCmd_print_awdl_peers(IO80211PeerManager *this, __int64 a2, __int64 a3)
{
  int v3; // er12@1
  OSMetaClass *v4; // rax@2
  __int64 v5; // rax@2
  __int64 v6; // r9@2
  int v7; // STCC_4@3
  int v8; // STC8_4@3
  int v9; // STC4_4@3
  int v10; // STC0_4@3
  int v11; // STBC_4@3
  int v12; // STB8_4@3
  int v13; // STB4_4@3
  int v14; // STB0_4@3
  int v15; // ST88_4@3
  int v16; // ST80_4@3
  int v17; // ST78_4@3
  int v18; // ST70_4@3
  int v19; // ST68_4@3
  int v20; // ST60_4@3
  int v21; // ST48_4@3
  signed __int64 v22; // r12@3
  __int64 v23; // r14@4
  __int64 v24; // rsi@5
  __int64 v25; // rax@6
  __int64 v27; // [sp+E0h] [bp-80h]@1
  int v28; // [sp+E8h] [bp-78h]@1
  int v29; // [sp+ECh] [bp-74h]@1
  __int64 *v30; // [sp+F0h] [bp-70h]@1
  __int64 v31; // [sp+100h] [bp-60h]@1
  __int64 v32; // [sp+108h] [bp-58h]@1
  __int64 v33; // [sp+110h] [bp-50h]@1
  __int64 v34; // [sp+118h] [bp-48h]@1
  __int64 v35; // [sp+120h] [bp-40h]@1
  __int64 v36; // [sp+128h] [bp-38h]@1
  __int64 v37; // [sp+130h] [bp-30h]@1

  v27 = a3;
  *(_DWORD *)(a3 + 48) = 4;
  v37 = 0LL;
  v36 = 0LL;
  v35 = 0LL;
  v34 = 0LL;
  v33 = 0LL;
  v32 = 0LL;
  v31 = 0LL;
  LODWORD(v31) = 1;
  v28 = -1071093303;
  v29 = 155;
  v30 = &v31;
  v3 = IO80211PeerManager::ioctl_internal(this, (__int64)&v28);
  if ( v3 )
  {
    LODWORD(v4) = (*(int (__fastcall **)(IO80211PeerManager *, int *))(*(_QWORD *)this + 56LL))(this, &v28);
    v5 = OSMetaClass::getClassName(v4);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s  Unable to get election params ret %d\n",
      v5,
      (__int64)"handleDebugCmd_print_awdl_peers",
      (unsigned int)v3,
      v6);
  }
  *((_DWORD *)this + 929) = WORD1(v33);
  *((_DWORD *)this + 934) = HIDWORD(v35);
  memcpy((char *)this + 3692, (char *)&v33 + 6, 6uLL);
  memcpy((char *)this + 3698, (char *)&v36 + 1, 6uLL);
  IO80211PeerManager::lockDataPath(this);
  v7 = *((_BYTE *)this + 3684);
  v8 = *((_BYTE *)this + 3685);
  v9 = *((_DWORD *)this + 932);
  v10 = *((_BYTE *)this + 3692);
  v11 = *((_BYTE *)this + 3693);
  v12 = *((_BYTE *)this + 3694);
  v13 = *((_BYTE *)this + 3695);
  v14 = *((_BYTE *)this + 3696);
  v15 = *((_BYTE *)this + 3703);
  v16 = *((_BYTE *)this + 3702);
  v17 = *((_BYTE *)this + 3701);
  v18 = *((_BYTE *)this + 3700);
  v19 = *((_BYTE *)this + 3699);
  v20 = *((_BYTE *)this + 3698);
  v21 = *((_BYTE *)this + 3697);
  _userPrint(
    v27,
    "%s%02X:%02X:%02X:%02X:%02X:%02X (Self) metric %u _topMaster %02X:%02X:%02X:%02X:%02X:%02X eid %u hop %u priv: %02X:%02X:%02X:%02X:%02X:%02X eid %u hop %u%s\n  ----  \n",
    (__int64)"\x1B[1;30;48m",
    *((_BYTE *)this + 3680),
    *((_BYTE *)this + 3681),
    *((_BYTE *)this + 3682),
    *((_BYTE *)this + 3683));
  v22 = a2 + 1352;
  if ( !memcmp((const void *)(a2 + 1352), &null_address, 6uLL) )
  {
    v24 = v27;
    *(_DWORD *)(v27 + 40) += IO80211CommandQueue::print(*((_QWORD *)this + 11), v27);
  }
  else
  {
    v23 = 0LL;
    do
    {
      v24 = (__int64)&null_address;
      if ( memcmp((const void *)(v22 + v23), &null_address, 6uLL) )
      {
        v24 = v22 + v23;
        v25 = IO80211PeerManager::findPeer(this, (unsigned __int8 *)(v22 + v23), 1);
        if ( v25 )
        {
          v24 = v27;
          *(_DWORD *)(v27 + 48) = 2;
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v25 + 280LL))(v25);
        }
      }
      v23 += 6LL;
    }
    while ( v23 != 96 );
  }
  return IO80211PeerManager::unlockDataPath(this, v24);
}
// 77FDC: using guessed type int null_address;

//----- (00000000000374FC) ----------------------------------------------------
int __fastcall IO80211AWDLPeerManager::handleDebugCmd(IO80211AWDLPeerManager *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // rcx@1
  int v7; // eax@1
  bool v8; // zf@1
  int result; // eax@1
  signed __int64 v10; // rbx@3
  char *v11; // rax@5
  size_t v12; // r12@6
  __int64 v13; // rcx@6
  __int64 v14; // r8@6
  __int64 v15; // r9@6
  size_t v16; // rax@7
  char *v17; // rax@12
  size_t v18; // r12@13
  size_t v19; // rax@14
  char *v20; // rax@20
  size_t v21; // r12@21
  size_t v22; // rax@22
  char *v23; // rax@28
  size_t v24; // r12@29
  size_t v25; // rax@30
  char *v26; // rax@36
  size_t v27; // r12@37
  size_t v28; // rax@38
  char *v29; // rax@44
  size_t v30; // r12@45
  size_t v31; // rax@46
  char *v32; // rax@52
  size_t v33; // r12@53
  size_t v34; // rax@54
  char *v35; // rax@60
  size_t v36; // r12@61
  size_t v37; // rax@62
  char *v38; // rax@68
  size_t v39; // r12@69
  size_t v40; // rax@70
  char *v41; // rax@76
  size_t v42; // r12@77
  size_t v43; // rax@78
  char *v44; // rax@84
  int v45; // eax@84
  size_t v46; // r12@85
  size_t v47; // rax@86
  char *v48; // rax@92
  size_t v49; // r12@93
  size_t v50; // rax@94
  char *v51; // rax@100
  size_t v52; // r12@101
  size_t v53; // rax@102
  char v54; // [sp+0h] [bp-80h]@0
  __int64 v55; // [sp+8h] [bp-78h]@1
  __int64 v56; // [sp+10h] [bp-70h]@1
  __int64 v57; // [sp+18h] [bp-68h]@1
  __int64 v58; // [sp+20h] [bp-60h]@1
  __int64 v59; // [sp+28h] [bp-58h]@1
  __int64 v60; // [sp+30h] [bp-50h]@1
  __int64 v61; // [sp+38h] [bp-48h]@1
  __int64 v62; // [sp+40h] [bp-40h]@1
  __int64 v63; // [sp+48h] [bp-38h]@1
  __int64 v64; // [sp+50h] [bp-30h]@1
  __int64 v65; // [sp+58h] [bp-28h]@1

  v65 = 0LL;
  v64 = 0LL;
  v63 = 0LL;
  v62 = 0LL;
  v61 = 0LL;
  v60 = 0LL;
  v59 = 0LL;
  v58 = 0LL;
  v57 = 0LL;
  v56 = 0LL;
  v55 = 0LL;
  v6 = *(_QWORD *)(a2 + 1456);
  v55 = *(_QWORD *)(a2 + 1456);
  v7 = *(_DWORD *)(a2 + 1452);
  LODWORD(v59) = v7;
  v60 = *(_DWORD *)(a2 + 1464);
  HIDWORD(v61) = *(_WORD *)(a2 + 4);
  v8 = v7 == 0;
  result = 22;
  if ( !v8 && v6 )
  {
    v10 = a2 + 8;
    if ( *(_BYTE *)(a2 + 8) )
    {
      if ( strchr((const char *)(a2 + 8), 61)
        && (v11 = strchr((const char *)(a2 + 8), 61),
            !strncasecmp((const char *)(a2 + 8), "infra_rst", (size_t)&v11[-v10]))
        || (v12 = strlen((const char *)(a2 + 8)), v12 == strlen("infra_rst"))
        && (v16 = strlen("infra_rst"), !strncasecmp((const char *)(a2 + 8), "infra_rst", v16)) )
        IO80211AWDLPeerManager::handleDebugCmd_infra_rst(this, a2);
    }
    else
    {
      _userPrint((__int64)&v55, "%s\n", (__int64)"infra_rst", v6, a5, a6, v54);
    }
    if ( *(_BYTE *)v10 )
    {
      if ( strchr((const char *)(a2 + 8), 61)
        && (v17 = strchr((const char *)(a2 + 8), 61), !strncasecmp((const char *)(a2 + 8), "iping", (size_t)&v17[-v10]))
        || (v18 = strlen((const char *)(a2 + 8)), v18 == strlen("iping"))
        && (v19 = strlen("iping"), !strncasecmp((const char *)(a2 + 8), "iping", v19)) )
        IO80211AWDLPeerManager::handleDebugCmd_iping(this, a2, (__int64)&v55);
    }
    else if ( *(_QWORD *)(a2 + 1456) )
    {
      _userPrint((__int64)&v55, "%s\n", (__int64)"iping", v13, v14, v15, v54);
    }
    if ( *(_BYTE *)v10 )
    {
      if ( strchr((const char *)(a2 + 8), 61)
        && (v20 = strchr((const char *)(a2 + 8), 61),
            !strncasecmp((const char *)(a2 + 8), "presence", (size_t)&v20[-v10]))
        || (v21 = strlen((const char *)(a2 + 8)), v21 == strlen("presence"))
        && (v22 = strlen("presence"), !strncasecmp((const char *)(a2 + 8), "presence", v22)) )
        IO80211AWDLPeerManager::handleDebugCmd_presence(this, a2, (__int64)&v55);
    }
    else if ( *(_QWORD *)(a2 + 1456) )
    {
      _userPrint((__int64)&v55, "%s\n", (__int64)"presence", v13, v14, v15, v54);
    }
    if ( *(_BYTE *)v10 )
    {
      if ( strchr((const char *)(a2 + 8), 61)
        && (v23 = strchr((const char *)(a2 + 8), 61), !strncasecmp(
                                                         (const char *)(a2 + 8),
                                                         "absence",
                                                         (size_t)&v23[-v10]))
        || (v24 = strlen((const char *)(a2 + 8)), v24 == strlen("absence"))
        && (v25 = strlen("absence"), !strncasecmp((const char *)(a2 + 8), "absence", v25)) )
        IO80211AWDLPeerManager::handleDebugCmd_absence(this, a2, (__int64)&v55);
    }
    else if ( *(_QWORD *)(a2 + 1456) )
    {
      _userPrint((__int64)&v55, "%s\n", (__int64)"absence", v13, v14, v15, v54);
    }
    if ( *(_BYTE *)v10 )
    {
      if ( strchr((const char *)(a2 + 8), 61)
        && (v26 = strchr((const char *)(a2 + 8), 61),
            !strncasecmp((const char *)(a2 + 8), "iredirect", (size_t)&v26[-v10]))
        || (v27 = strlen((const char *)(a2 + 8)), v27 == strlen("iredirect"))
        && (v28 = strlen("iredirect"), !strncasecmp((const char *)(a2 + 8), "iredirect", v28)) )
        IO80211AWDLPeerManager::handleDebugCmd_iredirect(this, a2, (__int64)&v55);
    }
    else if ( *(_QWORD *)(a2 + 1456) )
    {
      _userPrint((__int64)&v55, "%s\n", (__int64)"iredirect", v13, v14, v15, v54);
    }
    if ( *(_BYTE *)v10 )
    {
      if ( strchr((const char *)(a2 + 8), 61)
        && (v29 = strchr((const char *)(a2 + 8), 61),
            !strncasecmp((const char *)(a2 + 8), "aredirect", (size_t)&v29[-v10]))
        || (v30 = strlen((const char *)(a2 + 8)), v30 == strlen("aredirect"))
        && (v31 = strlen("aredirect"), !strncasecmp((const char *)(a2 + 8), "aredirect", v31)) )
        IO80211AWDLPeerManager::handleDebugCmd_aredirect(this, a2, (__int64)&v55);
    }
    else if ( *(_QWORD *)(a2 + 1456) )
    {
      _userPrint((__int64)&v55, "%s\n", (__int64)"aredirect", v13, v14, v15, v54);
    }
    if ( *(_BYTE *)v10 )
    {
      if ( strchr((const char *)(a2 + 8), 61)
        && (v32 = strchr((const char *)(a2 + 8), 61), !strncasecmp((const char *)(a2 + 8), "poll", (size_t)&v32[-v10]))
        || (v33 = strlen((const char *)(a2 + 8)), v33 == strlen("poll"))
        && (v34 = strlen("poll"), !strncasecmp((const char *)(a2 + 8), "poll", v34)) )
        IO80211AWDLPeerManager::handleDebugCmd_poll(this, a2);
    }
    else if ( *(_QWORD *)(a2 + 1456) )
    {
      _userPrint((__int64)&v55, "%s\n", (__int64)"poll", v13, v14, v15, v54);
    }
    if ( *(_BYTE *)v10 )
    {
      if ( strchr((const char *)(a2 + 8), 61)
        && (v35 = strchr((const char *)(a2 + 8), 61), !strncasecmp(
                                                         (const char *)(a2 + 8),
                                                         "primary",
                                                         (size_t)&v35[-v10]))
        || (v36 = strlen((const char *)(a2 + 8)), v36 == strlen("primary"))
        && (v37 = strlen("primary"), !strncasecmp((const char *)(a2 + 8), "primary", v37)) )
        IO80211AWDLPeerManager::handleDebugCmd_primary(this, a2);
    }
    else if ( *(_QWORD *)(a2 + 1456) )
    {
      _userPrint((__int64)&v55, "%s\n", (__int64)"primary", v13, v14, v15, v54);
    }
    if ( *(_BYTE *)v10 )
    {
      if ( strchr((const char *)(a2 + 8), 61)
        && (v38 = strchr((const char *)(a2 + 8), 61), !strncasecmp((const char *)(a2 + 8), "force", (size_t)&v38[-v10]))
        || (v39 = strlen((const char *)(a2 + 8)), v39 == strlen("force"))
        && (v40 = strlen("force"), !strncasecmp((const char *)(a2 + 8), "force", v40)) )
        IO80211AWDLPeerManager::handleDebugCmd_force(this, a2, (__int64)&v55);
    }
    else if ( *(_QWORD *)(a2 + 1456) )
    {
      _userPrint((__int64)&v55, "%s\n", (__int64)"force", v13, v14, v15, v54);
    }
    if ( *(_BYTE *)v10 )
    {
      if ( strchr((const char *)(a2 + 8), 61)
        && (v41 = strchr((const char *)(a2 + 8), 61),
            !strncasecmp((const char *)(a2 + 8), "print_sr", (size_t)&v41[-v10]))
        || (v42 = strlen((const char *)(a2 + 8)), v42 == strlen("print_sr"))
        && (v43 = strlen("print_sr"), !strncasecmp((const char *)(a2 + 8), "print_sr", v43)) )
        IO80211AWDLPeerManager::printServiceRequests((__int64)this, (__int64)&v55);
    }
    else if ( *(_QWORD *)(a2 + 1456) )
    {
      _userPrint((__int64)&v55, "%s\n", (__int64)"print_sr", v13, v14, v15, v54);
    }
    if ( *(_BYTE *)v10 )
    {
      if ( strchr((const char *)(a2 + 8), 61)
        && (v44 = strchr((const char *)(a2 + 8), 61),
            (v45 = strncasecmp((const char *)(a2 + 8), "print_oob", (size_t)&v44[-v10])) == 0)
        || (v46 = strlen((const char *)(a2 + 8)), v46 == strlen("print_oob"))
        && (v47 = strlen("print_oob"), (v45 = strncasecmp((const char *)(a2 + 8), "print_oob", v47)) == 0) )
        IO80211AWDLPeerManager::printOobRequests(v45, (__int64)this, (__int64)&v55);
    }
    else if ( *(_QWORD *)(a2 + 1456) )
    {
      _userPrint((__int64)&v55, "%s\n", (__int64)"print_oob", v13, v14, v15, v54);
    }
    if ( *(_BYTE *)v10 )
    {
      if ( strchr((const char *)(a2 + 8), 61)
        && (v48 = strchr((const char *)(a2 + 8), 61),
            !strncasecmp((const char *)(a2 + 8), "chanList", (size_t)&v48[-v10]))
        || (v49 = strlen((const char *)(a2 + 8)), v49 == strlen("chanList"))
        && (v50 = strlen("chanList"), !strncasecmp((const char *)(a2 + 8), "chanList", v50)) )
        IO80211AWDLPeerManager::handleDebugCmd_chanlist(this, a2, (__int64)&v55);
    }
    else if ( *(_QWORD *)(a2 + 1456) )
    {
      _userPrint((__int64)&v55, "%s\n", (__int64)"chanList", v13, v14, v15, v54);
    }
    if ( *(_BYTE *)v10 )
    {
      if ( strchr((const char *)(a2 + 8), 61)
        && (v51 = strchr((const char *)(a2 + 8), 61),
            !strncasecmp((const char *)(a2 + 8), "print_awdl_peers", (size_t)&v51[-v10]))
        || (v52 = strlen((const char *)(a2 + 8)), v52 == strlen("print_awdl_peers"))
        && (v53 = strlen("print_awdl_peers"), !strncasecmp((const char *)(a2 + 8), "print_awdl_peers", v53)) )
        IO80211AWDLPeerManager::handleDebugCmd_print_awdl_peers(this, a2, (__int64)&v55);
    }
    else if ( *(_QWORD *)(a2 + 1456) )
    {
      _userPrint((__int64)&v55, "%s\n", (__int64)"print_awdl_peers", v13, v14, v15, v54);
    }
    *(_DWORD *)(a2 + 1464) += v60;
    result = ((int (__fastcall *)(IO80211AWDLPeerManager *, __int64))`vtable for'IO80211PeerManager[69])(this, a2);
  }
  return result;
}
// 7D5B0: using guessed type __int64 `vtable for'IO80211PeerManager[2];

//----- (0000000000037EC4) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::printServiceRequests(__int64 a1, __int64 a2)
{
  __int64 v2; // rax@1
  __int64 v3; // rdx@1
  unsigned __int64 v4; // rax@3
  __int64 v5; // r13@3
  __int64 v6; // ST08_8@3
  __int64 v7; // r12@3
  __int64 v8; // r15@3
  __int64 v9; // rax@3
  __int64 v10; // rdx@3
  __int64 v11; // rcx@3
  __int64 v12; // r8@3
  __int64 v13; // r9@3
  __int64 result; // rax@3
  __int64 v15; // rdx@4
  __int64 v16; // rcx@4
  __int64 v17; // r8@4
  __int64 v18; // r9@4
  char v19; // ST00_1@4
  __int64 v20; // rdx@4
  __int64 v21; // rcx@4
  __int64 v22; // r8@4
  __int64 v23; // r9@4
  char v24; // [sp+0h] [bp-40h]@0
  char v25; // [sp+0h] [bp-40h]@3
  char v26; // [sp+0h] [bp-40h]@4

  v2 = *(_QWORD *)(a1 + 3808);
  v3 = 0LL;
  if ( v2 )
    v3 = *(_DWORD *)(v2 + 52);
  _userPrint(
    a2,
    "Num Service Requests %u SUI %u advertise: ssth 0x%x browse: ssth 0x%x \n",
    v3,
    *(_WORD *)(a1 + 8136),
    *(_DWORD *)(a1 + 8140),
    *(_DWORD *)(a1 + 8176),
    v24);
  v4 = getAbsoluteTime();
  v5 = 19342813113834067LL * (v4 >> 9) >> 64 >> 11;
  v6 = 4835703278458516699LL * (v4 - 1000000000 * v5) >> 64 >> 18;
  v7 = *(_QWORD *)(a1 + 3912);
  v8 = (unsigned __int64)(19342813113834067LL * (unsigned __int128)(*(_QWORD *)(a1 + 3912) >> 9) >> 64) >> 11;
  v9 = getAbsoluteTime();
  _userPrint(
    a2,
    "         now %llu.%03llu last update %llu.%03llu diff %ums\n",
    v5,
    v6,
    v8,
    (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (v7 - 1000000000 * v8)) >> 64) >> 18,
    (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (v9 - v7)) >> 64) >> 18);
  result = 0LL;
  if ( *(_QWORD *)(a1 + 3808) )
  {
    _userPrint(a2, "  \n", v10, v11, v12, v13, v25);
    *(_DWORD *)(a2 + 48) = 2;
    IO80211CommandQueue::print(*(_QWORD *)(a1 + 3808), a2);
    _userPrint(a2, "  \n", v15, v16, v17, v18, v19);
    *(_DWORD *)(a2 + 48) = 1;
    IO80211CommandQueue::print(*(_QWORD *)(a1 + 3808), a2);
    if ( *(_QWORD *)(a1 + 3864) )
    {
      *(_DWORD *)(a2 + 48) = 0;
      _userPrint(a2, "   ip6.arpa  :\n", v20, v21, v22, v23, v26);
      (*(void (__fastcall **)(_QWORD, __int64))(**(_QWORD **)(a1 + 3864) + 280LL))(*(_QWORD *)(a1 + 3864), a2);
    }
    result = *(_DWORD *)(a2 + 40);
  }
  return result;
}

//----- (0000000000038070) ----------------------------------------------------
__int64 __usercall IO80211AWDLPeerManager::printOobRequests@<rax>(char a1@<al>, __int64 a2@<rdi>, __int64 a3@<rsi>)
{
  __int64 v3; // r14@1
  __int64 v4; // r15@1
  unsigned __int64 v5; // rsi@1
  __int64 v6; // r9@1
  __int64 v7; // rax@1
  unsigned int v8; // ecx@1
  __int64 v9; // rbx@3
  __int64 v10; // rdi@3
  __int64 v11; // rdx@4
  __int64 v12; // rcx@4
  __int64 v13; // r8@4
  __int64 v14; // r9@4
  __int64 v15; // rax@4
  char v17; // [sp-8h] [bp-20h]@1
  char v18; // [sp-8h] [bp-20h]@3

  v17 = a1;
  v3 = a3;
  v4 = a2;
  v5 = getAbsoluteTime();
  v7 = *(_QWORD *)(a2 + 3816);
  v8 = 0;
  if ( v7 )
    v8 = *(_DWORD *)(v7 + 52);
  v9 = 19342813113834067LL * (v5 >> 9) >> 64 >> 11;
  _userPrint(
    v3,
    "Num OOB Requests %u now %llu.%03llu\n",
    v8,
    v9,
    4835703278458516699LL * (v5 - 1000000000 * v9) >> 64 >> 18,
    v6,
    v17);
  v10 = *(_QWORD *)(a2 + 3816);
  if ( v10 )
  {
    *(_DWORD *)(v3 + 48) = 1;
    IO80211CommandQueue::print(v10, v3);
    v15 = *(_QWORD *)(v4 + 3824);
    if ( v15 )
    {
      _userPrint(v3, "     done %u:\n", *(_DWORD *)(v15 + 52), v12, v13, v14, v18);
      IO80211CommandQueue::print(*(_QWORD *)(v4 + 3824), v3);
    }
    else
    {
      _userPrint(v3, "     done 0.\n", v11, v12, v13, v14, v18);
    }
  }
  return 0LL;
}

//----- (0000000000038156) ----------------------------------------------------
int __fastcall IO80211AWDLPeerManager::getAwdlCtl(IO80211PeerManager *this, __int64 a2)
{
  __int64 v2; // r12@1
  int v3; // er15@1
  __int64 v4; // r8@1
  __int64 v5; // r9@1
  OSMetaClass *v6; // rax@2
  __int64 v7; // rax@2
  __int64 v8; // rax@3
  size_t v9; // rbx@4
  __int64 v10; // rax@48
  __int64 v11; // r8@202
  __int64 v12; // r9@202
  int v13; // ebx@215
  int result; // eax@215
  OSMetaClass *v15; // rax@216
  __int64 v16; // rax@216
  char v17; // [sp+0h] [bp-90h]@0
  __int64 v18; // [sp+10h] [bp-80h]@3
  __int64 v19; // [sp+18h] [bp-78h]@3
  __int64 v20; // [sp+20h] [bp-70h]@3
  __int64 v21; // [sp+28h] [bp-68h]@3
  __int64 v22; // [sp+30h] [bp-60h]@3
  __int64 v23; // [sp+38h] [bp-58h]@3
  __int64 v24; // [sp+40h] [bp-50h]@3
  __int64 v25; // [sp+48h] [bp-48h]@3
  __int64 v26; // [sp+50h] [bp-40h]@3
  __int64 v27; // [sp+58h] [bp-38h]@3
  __int64 v28; // [sp+60h] [bp-30h]@3

  v2 = a2 + 4;
  v3 = strnlen((const char *)(a2 + 4), 0x80uLL);
  if ( IO80211PeerManager::shouldLog(this, 32LL) )
  {
    LODWORD(v6) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, 32LL);
    v7 = OSMetaClass::getClassName(v6);
    IO80211PeerManager::logDebug(this, 32LL, "%s::%s awdl <%s>\n", v7, (__int64)"getAwdlCtl", v2);
  }
  v28 = 0LL;
  v27 = 0LL;
  v26 = 0LL;
  v25 = 0LL;
  v24 = 0LL;
  v23 = 0LL;
  v22 = 0LL;
  v21 = 0LL;
  v20 = 0LL;
  v19 = 0LL;
  v18 = 0LL;
  v8 = *(_QWORD *)(a2 + 152);
  v18 = *(_QWORD *)(a2 + 152);
  v22 = *(_DWORD *)(a2 + 144);
  v23 = *(_DWORD *)(a2 + 160);
  if ( !v3 )
  {
LABEL_45:
    if ( v8 )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"awdlMaxBW", *((_DWORD *)this + 2030), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 2030);
      goto LABEL_253;
    }
    goto LABEL_49;
  }
  v9 = v3 & 0xFFFFFFFF;
  if ( !strncmp("awdlMaxBW", (const char *)v2, v3 & 0xFFFFFFFF) )
  {
    v8 = *(_QWORD *)(a2 + 152);
    goto LABEL_45;
  }
  if ( !strncmp("awdl_bonjour_offload", (const char *)v2, v9) )
  {
LABEL_49:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"awdl_bonjour_offload", *((_DWORD *)this + 947), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 947);
      goto LABEL_253;
    }
    goto LABEL_53;
  }
  if ( !strncmp("always_available_packet_threshold", (const char *)v2, v9) )
  {
LABEL_53:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint(
        (__int64)&v18,
        "%s = %u\n",
        (__int64)"always_available_packet_threshold",
        *((_DWORD *)this + 1241),
        v4,
        v5,
        v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1241);
      goto LABEL_253;
    }
    goto LABEL_57;
  }
  if ( !strncmp("always_available_packet_threshold_real_time", (const char *)v2, v9) )
  {
LABEL_57:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint(
        (__int64)&v18,
        "%s = %u\n",
        (__int64)"always_available_packet_threshold_real_time",
        *((_DWORD *)this + 1242),
        v4,
        v5,
        v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1242);
      goto LABEL_253;
    }
    goto LABEL_61;
  }
  if ( !strncmp("allowAwdlQuietMode", (const char *)v2, v9) )
  {
LABEL_61:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"allowAwdlQuietMode", *((_DWORD *)this + 996), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 996);
      goto LABEL_253;
    }
    goto LABEL_65;
  }
  if ( !strncmp("awdl_infra_interface_switching", (const char *)v2, v9) )
  {
LABEL_65:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint(
        (__int64)&v18,
        "%s = %u\n",
        (__int64)"awdl_infra_interface_switching",
        *((_DWORD *)this + 1883),
        v4,
        v5,
        v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1883);
      goto LABEL_253;
    }
    goto LABEL_69;
  }
  if ( !strncmp("awdl_master_sync_grace_period", (const char *)v2, v9) )
  {
LABEL_69:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint(
        (__int64)&v18,
        "%s = %u\n",
        (__int64)"awdl_master_sync_grace_period",
        *((_DWORD *)this + 1000),
        v4,
        v5,
        v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1000);
      goto LABEL_253;
    }
    goto LABEL_73;
  }
  if ( !strncmp("awdl_quiet_grace_period", (const char *)v2, v9) )
  {
LABEL_73:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"awdl_quiet_grace_period", *((_DWORD *)this + 999), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 999);
      goto LABEL_253;
    }
    goto LABEL_77;
  }
  if ( !strncmp("awdl_quiet_grace_period_unicast", (const char *)v2, v9) )
  {
LABEL_77:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint(
        (__int64)&v18,
        "%s = %u\n",
        (__int64)"awdl_quiet_grace_period_unicast",
        *((_DWORD *)this + 1002),
        v4,
        v5,
        v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1002);
      goto LABEL_253;
    }
    goto LABEL_81;
  }
  if ( !strncmp("awdl_quiet_grace_period_multicast", (const char *)v2, v9) )
  {
LABEL_81:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint(
        (__int64)&v18,
        "%s = %u\n",
        (__int64)"awdl_quiet_grace_period_multicast",
        *((_DWORD *)this + 1003),
        v4,
        v5,
        v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1003);
      goto LABEL_253;
    }
    goto LABEL_85;
  }
  if ( !strncmp("awdl_unquiet_to_minimum", (const char *)v2, v9) )
  {
LABEL_85:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"awdl_unquiet_to_minimum", *((_DWORD *)this + 1005), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1005);
      goto LABEL_253;
    }
    goto LABEL_89;
  }
  if ( !strncmp("channelSequenceStrategy", (const char *)v2, v9) )
  {
LABEL_89:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"channelSequenceStrategy", *((_DWORD *)this + 259), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 259);
      goto LABEL_253;
    }
    goto LABEL_93;
  }
  if ( !strncmp("defaultSocialChannel2G", (const char *)v2, v9) )
  {
LABEL_93:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"defaultSocialChannel2G", *((_DWORD *)this + 380), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 380);
      goto LABEL_253;
    }
    goto LABEL_97;
  }
  if ( !strncmp("discard_airplay_records", (const char *)v2, v9) )
  {
LABEL_97:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"discard_airplay_records", *((_DWORD *)this + 908), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 908);
      goto LABEL_253;
    }
    goto LABEL_101;
  }
  if ( !strncmp("dmdns_debug", (const char *)v2, v9) )
  {
LABEL_101:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"dmdns_debug", *((_DWORD *)this + 945), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 945);
      goto LABEL_253;
    }
    goto LABEL_105;
  }
  if ( !strncmp("do_ip6_arpa", (const char *)v2, v9) )
  {
LABEL_105:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"do_ip6_arpa", *((_DWORD *)this + 1009), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1009);
      goto LABEL_253;
    }
    goto LABEL_109;
  }
  if ( !strncmp("do_reset_services", (const char *)v2, v9) )
  {
LABEL_109:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"do_reset_services", *((_DWORD *)this + 1010), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1010);
      goto LABEL_253;
    }
    goto LABEL_113;
  }
  if ( !strncmp("dont_duplicate_mcast", (const char *)v2, v9) )
  {
LABEL_113:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"dont_duplicate_mcast", *((_DWORD *)this + 906), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 906);
      goto LABEL_253;
    }
    goto LABEL_117;
  }
  if ( !strncmp("driver_set_interface_state", (const char *)v2, v9) )
  {
LABEL_117:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint(
        (__int64)&v18,
        "%s = %u\n",
        (__int64)"driver_set_interface_state",
        *((_DWORD *)this + 1895),
        v4,
        v5,
        v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1895);
      goto LABEL_253;
    }
    goto LABEL_121;
  }
  if ( !strncmp("enable_forced_roam", (const char *)v2, v9) )
  {
LABEL_121:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"enable_forced_roam", *((_DWORD *)this + 1887), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1887);
      goto LABEL_253;
    }
    goto LABEL_125;
  }
  if ( !strncmp("enable_mdns_initial_speedup", (const char *)v2, v9) )
  {
LABEL_125:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint(
        (__int64)&v18,
        "%s = %u\n",
        (__int64)"enable_mdns_initial_speedup",
        *((_DWORD *)this + 1890),
        v4,
        v5,
        v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1890);
      goto LABEL_253;
    }
    goto LABEL_129;
  }
  if ( !strncmp("enable_wme", (const char *)v2, v9) )
  {
LABEL_129:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"enable_wme", *((_DWORD *)this + 1016), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1016);
      goto LABEL_253;
    }
    goto LABEL_133;
  }
  if ( !strncmp("filter_dmdns", (const char *)v2, v9) )
  {
LABEL_133:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"filter_dmdns", *((_DWORD *)this + 907), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 907);
      goto LABEL_253;
    }
    goto LABEL_137;
  }
  if ( !strncmp("fixedSequenceInfraReservedTime", (const char *)v2, v9) )
  {
LABEL_137:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint(
        (__int64)&v18,
        "%s = %u\n",
        (__int64)"fixedSequenceInfraReservedTime",
        *((_DWORD *)this + 903),
        v4,
        v5,
        v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 903);
      goto LABEL_253;
    }
    goto LABEL_141;
  }
  if ( !strncmp("freeze_min_ext", (const char *)v2, v9) )
  {
LABEL_141:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"freeze_min_ext", *((_DWORD *)this + 1007), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1007);
      goto LABEL_253;
    }
    goto LABEL_145;
  }
  if ( !strncmp("guardTime", (const char *)v2, v9) )
  {
LABEL_145:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"guardTime", *((_DWORD *)this + 910), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 910);
      goto LABEL_253;
    }
    goto LABEL_149;
  }
  if ( !strncmp("idle_peer_delete", (const char *)v2, v9) )
  {
LABEL_149:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"idle_peer_delete", *((_DWORD *)this + 1886), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1886);
      goto LABEL_253;
    }
    goto LABEL_153;
  }
  if ( !strncmp("insert_debug_tlv", (const char *)v2, v9) )
  {
LABEL_153:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"insert_debug_tlv", *((_DWORD *)this + 1008), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1008);
      goto LABEL_253;
    }
    goto LABEL_157;
  }
  if ( !strncmp("log_pkt_queue", (const char *)v2, v9) )
  {
LABEL_157:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"log_pkt_queue", *((_DWORD *)this + 120), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 120);
      goto LABEL_253;
    }
    goto LABEL_161;
  }
  if ( !strncmp("masterHomeChannel2", (const char *)v2, v9) )
  {
LABEL_161:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"masterHomeChannel2", *((_BYTE *)this + 1533), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_BYTE *)this + 1533);
      goto LABEL_253;
    }
    goto LABEL_165;
  }
  if ( !strncmp("mdns_trigger", (const char *)v2, v9) )
  {
LABEL_165:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"mdns_trigger", *((_DWORD *)this + 1885), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1885);
      goto LABEL_253;
    }
    goto LABEL_169;
  }
  if ( !strncmp("mdns_direct_path", (const char *)v2, v9) )
  {
LABEL_169:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"mdns_direct_path", *((_DWORD *)this + 946), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 946);
      goto LABEL_253;
    }
    goto LABEL_173;
  }
  if ( !strncmp("mdns_direct_path_verbose", (const char *)v2, v9) )
  {
LABEL_173:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"mdns_direct_path_verbose", *((_DWORD *)this + 948), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 948);
      goto LABEL_253;
    }
    goto LABEL_177;
  }
  if ( !strncmp("mdns_direct_path_never_wait", (const char *)v2, v9) )
  {
LABEL_177:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint(
        (__int64)&v18,
        "%s = %d\n",
        (__int64)"mdns_direct_path_never_wait",
        *((_DWORD *)this + 949),
        v4,
        v5,
        v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 949);
      goto LABEL_253;
    }
    goto LABEL_181;
  }
  if ( !strncmp("oob_delay", (const char *)v2, v9) )
  {
LABEL_181:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"oob_delay", *((_DWORD *)this + 1888), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1888);
      goto LABEL_253;
    }
    goto LABEL_185;
  }
  if ( !strncmp("peer_add_rssi_threshold", (const char *)v2, v9) )
  {
LABEL_185:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %d\n", (__int64)"peer_add_rssi_threshold", *((_DWORD *)this + 365), v4, v5, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 365);
      goto LABEL_253;
    }
    goto LABEL_189;
  }
  if ( !strncmp("print_all_election_id", (const char *)v2, v9) )
  {
LABEL_189:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"print_all_election_id", *((_DWORD *)this + 366), v4, v5, v17);
    if ( !v3 )
      goto LABEL_193;
    v10 = *((_DWORD *)this + 366);
LABEL_253:
    *(_QWORD *)(a2 + 136) = v10;
    result = 0;
LABEL_254:
    *(_DWORD *)(a2 + 160) += v23;
    return result;
  }
  if ( strncmp("aa_use_secondary_only", (const char *)v2, v9) )
  {
    if ( strncmp("supportsWaitingForAllTxStatus", (const char *)v2, v9) )
      goto LABEL_202;
    goto LABEL_197;
  }
LABEL_193:
  if ( *(_QWORD *)(a2 + 152) )
    _userPrint((__int64)&v18, "%s = %u\n", (__int64)"aa_use_secondary_only", *((_DWORD *)this + 1013), v4, v5, v17);
  if ( v3 )
  {
    v10 = *((_DWORD *)this + 1013);
    goto LABEL_253;
  }
LABEL_197:
  if ( *(_QWORD *)(a2 + 152) )
    _userPrint(
      (__int64)&v18,
      "%s = %u\n",
      (__int64)"supportsWaitingForAllTxStatus",
      *((_BYTE *)this + 562),
      v4,
      v5,
      v17);
  if ( v3 )
  {
    v10 = *((_BYTE *)this + 562);
    goto LABEL_253;
  }
  v9 = 0LL;
LABEL_202:
  if ( v9 == strlen("print_peers") && !strncmp("print_peers", (const char *)v2, v9) )
  {
    v13 = IO80211AWDLPeerManager::printAwdlPeers((__int64)this, a2);
    result = 0;
    if ( v13 )
    {
      LODWORD(v15) = (*(int (__fastcall **)(IO80211PeerManager *, __int64))(*(_QWORD *)this + 56LL))(this, a2);
      v16 = OSMetaClass::getClassName(v15);
      IO80211PeerManager::logDebug(
        this,
        32LL,
        "%s::%s -awdl_peers returned error: %d\n",
        v16,
        (__int64)"getAwdlCtl",
        (unsigned int)v13);
      result = v13;
    }
    goto LABEL_254;
  }
  if ( !v3 || !strncmp("private_election_id_mask", (const char *)v2, v9) )
  {
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint(
        (__int64)&v18,
        "%s = %u\n",
        (__int64)"private_election_id_mask",
        *((_DWORD *)this + 933),
        v11,
        v12,
        v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 933);
      goto LABEL_253;
    }
    goto LABEL_221;
  }
  if ( !strncmp("reservedTimeForScans", (const char *)v2, v9) )
  {
LABEL_221:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"reservedTimeForScans", *((_DWORD *)this + 901), v11, v12, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 901);
      goto LABEL_253;
    }
    goto LABEL_225;
  }
  if ( !strncmp("reservedTimeForScansLvl1", (const char *)v2, v9) )
  {
LABEL_225:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint(
        (__int64)&v18,
        "%s = %u\n",
        (__int64)"reservedTimeForScansLvl1",
        *((_DWORD *)this + 902),
        v11,
        v12,
        v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 902);
      goto LABEL_253;
    }
    goto LABEL_229;
  }
  if ( !strncmp("reset_stats", (const char *)v2, v9) )
  {
LABEL_229:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"reset_stats", *((_DWORD *)this + 900), v11, v12, v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 900);
      goto LABEL_253;
    }
    goto LABEL_233;
  }
  if ( !strncmp("serviceInactivityTimeout", (const char *)v2, v9) )
  {
LABEL_233:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint(
        (__int64)&v18,
        "%s = %u\n",
        (__int64)"serviceInactivityTimeout",
        *((_DWORD *)this + 913),
        v11,
        v12,
        v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 913);
      goto LABEL_253;
    }
    goto LABEL_237;
  }
  if ( !strncmp("verbose_master_indication", (const char *)v2, v9) )
  {
LABEL_237:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint(
        (__int64)&v18,
        "%s = %u\n",
        (__int64)"verbose_master_indication",
        *((_DWORD *)this + 1006),
        v11,
        v12,
        v17);
    if ( v3 )
    {
      v10 = *((_DWORD *)this + 1006);
      goto LABEL_253;
    }
    goto LABEL_241;
  }
  if ( !strncmp("infraOnDFSChannel", (const char *)v2, v9) )
  {
LABEL_241:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v18, "%s = %u\n", (__int64)"infraOnDFSChannel", *((_BYTE *)this + 3636), v11, v12, v17);
    if ( v3 )
    {
      v10 = *((_BYTE *)this + 3636);
      goto LABEL_253;
    }
    goto LABEL_245;
  }
  if ( strncmp("airplaySinkSoloModeEnabled", (const char *)v2, v9) )
  {
    if ( strncmp("enhancedMinimumMode", (const char *)v2, v9) )
      goto LABEL_256;
    goto LABEL_249;
  }
LABEL_245:
  if ( *(_QWORD *)(a2 + 152) )
    _userPrint(
      (__int64)&v18,
      "%s = %u\n",
      (__int64)"airplaySinkSoloModeEnabled",
      *((_DWORD *)this + 1012),
      v11,
      v12,
      v17);
  if ( v3 )
  {
    v10 = *((_DWORD *)this + 1012);
    goto LABEL_253;
  }
LABEL_249:
  if ( *(_QWORD *)(a2 + 152) )
    _userPrint((__int64)&v18, "%s = %u\n", (__int64)"enhancedMinimumMode", *((_DWORD *)this + 1014), v11, v12, v17);
  if ( v3 )
  {
    v10 = *((_DWORD *)this + 1014);
    goto LABEL_253;
  }
LABEL_256:
  *(_DWORD *)(a2 + 160) += v23;
  return ((int (__fastcall *)(IO80211PeerManager *, __int64))`vtable for'IO80211PeerManager[48])(this, a2);
}
// 7D5B0: using guessed type __int64 `vtable for'IO80211PeerManager[2];

//----- (0000000000039378) ----------------------------------------------------
signed __int64 __fastcall IO80211AWDLPeerManager::printAwdlPeers(__int64 a1, __int64 a2)
{
  void *v2; // rax@1
  void *v3; // rbx@1
  int v4; // er15@2
  signed __int64 result; // rax@2

  LODWORD(v2) = IOMalloc(1472LL);
  v3 = v2;
  if ( v2 )
  {
    bzero(v2, 0x5C0uLL);
    *(_DWORD *)v3 = *(_DWORD *)a2;
    *((_WORD *)v3 + 3) = 1;
    strncpy((char *)v3 + 8, "print_awdl_peers", 0x80uLL);
    *((_QWORD *)v3 + 182) = *(_QWORD *)(a2 + 152);
    *((_DWORD *)v3 + 363) = *(_DWORD *)(a2 + 144);
    v4 = (*(int (__fastcall **)(__int64, void *))(*(_QWORD *)a1 + 536LL))(a1, v3);
    *(_DWORD *)(a2 + 160) = *((_DWORD *)v3 + 366);
    IOFree(v3, 1472LL);
    result = (unsigned int)v4;
  }
  else
  {
    result = 12LL;
  }
  return result;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (0000000000039424) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlPeerServiceParams(__int64 a1, __int64 a2)
{
  *(_WORD *)(a1 + 8136) = *(_WORD *)(a2 + 4);
  *(_DWORD *)(a1 + 8140) = *(_DWORD *)(a2 + 8);
  memcpy((void *)(a1 + 8144), (const void *)(a2 + 12), 0x20uLL);
  return 0LL;
}

//----- (0000000000039456) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlStrategy(IO80211PeerManager *this, __int64 a2)
{
  OSMetaClass *v2; // rax@1
  __int64 v3; // rax@1

  *((_DWORD *)this + 1238) = *(_DWORD *)(a2 + 4);
  LODWORD(v2) = (*(int (__cdecl **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
  v3 = OSMetaClass::getClassName(v2);
  IO80211PeerManager::logDebug(
    this,
    32LL,
    "%s::%s strategy: %d\n",
    v3,
    (__int64)"setAwdlStrategy",
    *((_DWORD *)this + 1238));
  return 0LL;
}

//----- (00000000000394A6) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::buildSyncParamsTlv(__int64 a1, __int64 a2)
{
  int v2; // er15@1
  int v3; // er15@1
  signed int v4; // eax@1
  char v5; // cl@1
  __int64 v6; // rcx@3
  __int64 v7; // rax@7

  v2 = *(_BYTE *)(a1 + 7584) * (1 - ((*(_BYTE *)(a1 + 7604) < 1u) - 1));
  memset((void *)a2, 0, 0x2AuLL);
  *(_BYTE *)a2 = 4;
  v3 = ((_WORD)v2 + 45) & 0x7FC;
  *(_WORD *)(a2 + 1) = v3 - 3;
  *(_BYTE *)(a2 + 6) = *(_BYTE *)(a1 + 1532);
  v4 = *(_BYTE *)(a1 + 7584);
  *(_BYTE *)(a2 + 36) = *(_BYTE *)(a1 + 7584) - 1;
  *(_BYTE *)(a2 + 39) = *(_BYTE *)(a1 + 7605);
  v5 = *(_BYTE *)(a1 + 7604);
  *(_BYTE *)(a2 + 37) = v5;
  *(_BYTE *)(a2 + 38) = *(_BYTE *)(a1 + 7600);
  if ( v5 )
  {
    if ( (_BYTE)v4 )
    {
      v6 = 0LL;
      do
      {
        *(_WORD *)(a2 + 2 * v6 + 42) = *(_BYTE *)(a1 + v6 + 7606);
        ++v6;
      }
      while ( (signed int)v6 < v4 );
    }
  }
  else if ( (_BYTE)v4 )
  {
    v7 = 0LL;
    do
    {
      *(_BYTE *)(a2 + v7 + 42) = *(_BYTE *)(a1 + v7 + 7606);
      ++v7;
    }
    while ( (signed int)v7 < *(_BYTE *)(a1 + 7584) );
  }
  *(_BYTE *)(a2 + 20) = *(_BYTE *)(a1 + 1518);
  *(_BYTE *)(a2 + 22) = *(_BYTE *)(a1 + 1515);
  *(_BYTE *)(a2 + 21) = *(_BYTE *)(a1 + 1516);
  *(_BYTE *)(a2 + 23) = *(_BYTE *)(a1 + 1517);
  return (unsigned int)v3;
}

//----- (00000000000395AA) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::buildELectionParamsTlv(__int64 a1, __int64 a2)
{
  int v2; // ebx@1

  v2 = 16 * (unsigned __int8)*(_DWORD *)(a1 + 3720) & 0x10;
  memset((void *)a2, 0, (unsigned int)(v2 + 24));
  *(_BYTE *)a2 = 5;
  *(_WORD *)(a2 + 1) = v2 + 21;
  return (unsigned int)(v2 + 24);
}

//----- (00000000000395EE) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::buildEncapsulatedIP(IO80211AWDLPeerManager *this, unsigned __int8 *a2, __mbuf *a3, unsigned int a4)
{
  __mbuf *v4; // r12@1
  unsigned __int8 *v5; // r15@1
  signed int v6; // er13@1
  int v7; // eax@2
  int v8; // ebx@2
  int v9; // er14@2
  __int64 result; // rax@2
  const void *v11; // rax@3
  const void *v12; // rsi@3
  __mbuf *v13; // rax@3
  unsigned int v14; // [sp+0h] [bp-2Ch]@1

  v14 = a4;
  v4 = a3;
  v5 = a2;
  *a2 = 13;
  v6 = 3;
  if ( a3 )
  {
    while ( 1 )
    {
      v7 = mbuf_len(v4);
      v8 = v7;
      v9 = v7 + v6;
      result = 0LL;
      if ( v9 > v14 )
        break;
      LODWORD(v11) = mbuf_data(v4);
      v12 = v11;
      memcpy(&v5[v6], v11, (unsigned int)v8);
      LODWORD(v13) = mbuf_next(v4, v12);
      v4 = v13;
      v6 = v9;
      if ( !v13 )
        goto LABEL_6;
    }
  }
  else
  {
    v9 = 3;
LABEL_6:
    *(_WORD *)(v5 + 1) = v9 - 3;
    result = (unsigned int)v9;
  }
  return result;
}
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C58: using guessed type int __fastcall mbuf_next(_QWORD, _QWORD);

//----- (0000000000039680) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::buildIEEE80211CntnrTlv(IO80211AWDLPeerManager *this, unsigned __int8 *a2, unsigned __int8 *a3, unsigned int a4)
{
  unsigned int v4; // ebx@1

  v4 = a4;
  memcpy(a2, a3, a4);
  return v4;
}

//----- (00000000000396A0) ----------------------------------------------------
bool __fastcall IO80211AWDLPeerManager::multicastAllowedOnInfra(IO80211AWDLPeerManager *this)
{
  int v2; // [sp+0h] [bp-Ch]@1

  v2 = 0;
  IO80211CommandQueue::lockMap(
    *((IO80211CommandQueue **)this + 476),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countAirPlayServices,
    (__int64)this,
    (__int64)&v2,
    0LL,
    -1);
  return *((_DWORD *)this + 26) != 0 && v2 != 0;
}

//----- (00000000000396EA) ----------------------------------------------------
bool __usercall IO80211AWDLPeerManager::inMulticastTimeslot@<al>(IO80211AWDLPeerManager *this@<rdi>, __int64 a2@<rax>)
{
  unsigned int v2; // edx@1
  bool result; // al@2
  signed int v4; // esi@2
  __int64 v5; // [sp-4h] [bp-10h]@1

  v5 = a2;
  HIDWORD(v5) = 0;
  IO80211CommandQueue::lockMap(
    *((IO80211CommandQueue **)this + 476),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countAirPlayServices,
    (__int64)this,
    (__int64)((char *)&v5 + 4),
    0LL,
    -1);
  v2 = *((_DWORD *)this + 369);
  if ( v2 <= 0xA )
  {
    result = 1;
    v4 = 1285;
    if ( _bittest((const unsigned int *)&v4, v2) )
      return result;
    if ( v2 == 6 )
    {
      if ( !HIDWORD(v5) )
        return 0;
      goto LABEL_8;
    }
  }
  result = 0;
  if ( v2 == 14 && HIDWORD(v5) )
LABEL_8:
    result = *((_DWORD *)this + 26) != 0;
  return result;
}

//----- (000000000003975E) ----------------------------------------------------
int __fastcall IO80211AWDLPeerManager::queueInfraPacket(IO80211AWDLPeerManager *this, __mbuf *a2)
{
  IO80211AWDLPeerManager *v2; // r15@1
  __mbuf *v3; // r12@1
  __mbuf *v4; // rbx@2
  __int64 v5; // rax@3
  __mbuf *v6; // rax@4
  __int64 v7; // rdi@7

  v2 = this;
  IOSimpleLockLock(*((_QWORD *)this + 484));
  v3 = 0LL;
  if ( a2 )
  {
    v3 = 0LL;
    v4 = a2;
    while ( 1 )
    {
      LODWORD(v5) = mbuf_nextpkt(v4);
      if ( !v5 )
        break;
      LODWORD(v6) = mbuf_nextpkt(v4);
      v4 = v6;
      if ( !v6 )
        goto LABEL_7;
    }
    v3 = v4;
  }
LABEL_7:
  v7 = *((_QWORD *)this + 480);
  if ( v7 )
    mbuf_setnextpkt(v7, a2);
  else
    *((_QWORD *)v2 + 479) = a2;
  *((_QWORD *)v2 + 480) = v3;
  IOSimpleLockUnlock(*((_QWORD *)v2 + 484));
  return (*(int (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)v2 + 616) + 464LL))(*((_QWORD *)v2 + 616), 1LL);
}
// C7780: using guessed type int __fastcall IOSimpleLockLock(_QWORD);
// C7788: using guessed type int __fastcall IOSimpleLockUnlock(_QWORD);
// C8C60: using guessed type int __fastcall mbuf_nextpkt(_QWORD);
// C8CC0: using guessed type int __fastcall mbuf_setnextpkt(_QWORD, _QWORD);

//----- (00000000000397FC) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::buildInfraIdPacket(IO80211AWDLPeerManager *this, IO80211AWDLPeer *a2, unsigned __int8 a3, char a4, __mbuf *a5)
{
  __mbuf *v5; // r15@1
  int v6; // er14@1
  __int64 v7; // rax@1
  __int64 v8; // rbx@1
  unsigned __int16 v9; // ax@4
  int v10; // er14@4
  __int64 v11; // rax@4
  unsigned __int16 v12; // ax@4
  signed int v13; // ebx@4
  OSMetaClass *v14; // rax@5
  __int64 v15; // rax@5
  int v16; // ST18_4@5
  int v17; // ST10_4@5
  int v18; // ST08_4@5
  int v19; // ST00_4@5
  unsigned __int8 v21; // [sp+28h] [bp-38h]@1
  char v22; // [sp+2Ch] [bp-34h]@1

  v5 = a5;
  v22 = a4;
  v21 = a3;
  v6 = mbuf_maxlen(a5);
  LODWORD(v7) = mbuf_data(v5);
  v8 = v7;
  if ( !memcmp(&null_address, (char *)a2 + 1210, 6uLL) )
  {
    LODWORD(v14) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
    v15 = OSMetaClass::getClassName(v14);
    v16 = *((_BYTE *)a2 + 37);
    v17 = *((_BYTE *)a2 + 36);
    v18 = *((_BYTE *)a2 + 35);
    v19 = *((_BYTE *)a2 + 34);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s trying to send to null address %02X:%02X:%02X:%02X:%02X:%02X\n",
      v15,
      (__int64)"buildInfraIdPacket",
      *((_BYTE *)a2 + 32),
      *((_BYTE *)a2 + 33));
    v13 = -1;
  }
  else
  {
    memcpy((void *)v8, (char *)a2 + 1210, 6uLL);
    memcpy((void *)(v8 + 6), (char *)this + 118, 6uLL);
    *(_QWORD *)(v8 + 12) = 506921138685676937LL;
    *(_WORD *)(v8 + 20) = 0;
    *(_BYTE *)(v8 + 22) = 10;
    if ( !v21 )
      ++*((_WORD *)a2 + 929);
    *(_BYTE *)(v8 + 22) = 10;
    v9 = IO80211AWDLPeer::buildAwdlInviteTLV(a2, (unsigned __int8 *)(v8 + 25), (unsigned int)(v6 - 25), v21, v22);
    *(_WORD *)(v8 + 23) = v9;
    v10 = v9;
    v11 = (unsigned int)v9 + 25;
    *(_BYTE *)(v8 + v11) = 12;
    v12 = IO80211AWDLPeerManager::buildDataPathStateTlv(this, (unsigned __int8 *)(v8 + v11 + 3), 5);
    *(_WORD *)((unsigned int)(v10 + 26) + v8) = v12;
    mbuf_setlen(v5, (unsigned int)v12 + v10 + 28);
    v13 = 0;
    mbuf_set_traffic_class(v5, 0LL);
  }
  return (unsigned int)v13;
}
// 77FDC: using guessed type int null_address;
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C50: using guessed type int __fastcall mbuf_maxlen(_QWORD);
// C8C98: using guessed type int __fastcall mbuf_set_traffic_class(_QWORD, _QWORD);
// C8CB0: using guessed type int __fastcall mbuf_setlen(_QWORD, _QWORD);

//----- (0000000000039988) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::handle11zPacket(IO80211AWDLPeerManager *this, __mbuf *a2)
{
  __mbuf *v2; // r14@1
  __int64 v3; // r13@1
  __int64 v4; // rsi@3
  __int64 v5; // rax@3
  __int64 v6; // r15@3
  __int64 v7; // rax@4
  __int64 v8; // r12@4
  unsigned __int8 *v9; // r15@4
  OSMetaClass *v10; // rax@4
  __int64 v11; // rax@4
  int v12; // ST18_4@4
  int v13; // ST10_4@4
  int v14; // ST08_4@4
  int v15; // ST00_4@4
  OSMetaClass *v16; // rax@5
  __int64 v17; // rax@5
  __int64 v18; // r8@5
  __int64 v19; // r9@5
  OSMetaClass *v20; // rax@7
  __int64 v21; // rax@7
  int v22; // ST18_4@7
  int v23; // ST10_4@7
  int v24; // ST08_4@7
  int v25; // ST00_4@7
  int v26; // er12@10
  unsigned int v27; // er12@12
  OSMetaClass *v28; // rax@14
  __int64 v29; // rax@14
  int v30; // ST00_4@14
  unsigned int v31; // eax@15
  signed int v32; // er15@16
  __int64 v33; // rax@19
  __int64 v34; // r12@19
  __int64 v35; // rax@19
  int v36; // eax@19
  OSMetaClass *v37; // rax@23
  __int64 v38; // rax@23
  OSMetaClass *v39; // rax@24
  __int64 v40; // rax@24
  __int64 v41; // r8@24
  __int64 v42; // r9@24
  __int64 v43; // rdi@27
  __int64 result; // rax@29
  char v45; // [sp+20h] [bp-F0h]@19
  int v46; // [sp+24h] [bp-ECh]@19
  int v47; // [sp+28h] [bp-E8h]@19
  __mbuf *v48; // [sp+30h] [bp-E0h]@19
  int v49; // [sp+38h] [bp-D8h]@19
  int v50; // [sp+3Ch] [bp-D4h]@19
  __int64 v51; // [sp+40h] [bp-D0h]@19
  __int64 v52; // [sp+48h] [bp-C8h]@19
  __int64 v53; // [sp+50h] [bp-C0h]@19
  __int64 v54; // [sp+58h] [bp-B8h]@19
  __int64 v55; // [sp+60h] [bp-B0h]@19
  __int64 v56; // [sp+68h] [bp-A8h]@19
  __int64 v57; // [sp+70h] [bp-A0h]@19
  __int64 v58; // [sp+78h] [bp-98h]@19
  __mbuf *v59; // [sp+80h] [bp-90h]@1
  int v60; // [sp+8Ch] [bp-84h]@1
  __mbuf *v61; // [sp+90h] [bp-80h]@1
  __int64 v62; // [sp+98h] [bp-78h]@1
  __int64 v63; // [sp+A0h] [bp-70h]@1
  __int64 v64; // [sp+A8h] [bp-68h]@1
  __int64 v65; // [sp+B0h] [bp-60h]@1
  __int64 v66; // [sp+B8h] [bp-58h]@1
  __int64 v67; // [sp+C0h] [bp-50h]@1
  __int64 v68; // [sp+C8h] [bp-48h]@1
  __int64 v69; // [sp+D0h] [bp-40h]@1
  __int64 v70; // [sp+D8h] [bp-38h]@1
  __int64 v71; // [sp+E0h] [bp-30h]@1

  v2 = a2;
  v3 = off_7B078[0];
  v71 = *(_QWORD *)off_7B078[0];
  v60 = 1;
  v59 = 0LL;
  v70 = 0LL;
  v69 = 0LL;
  v68 = 0LL;
  v67 = 0LL;
  v66 = 0LL;
  v65 = 0LL;
  v64 = 0LL;
  v63 = 0LL;
  v62 = 0LL;
  v61 = a2;
  if ( !*((_DWORD *)this + 1883) || !*((_DWORD *)this + 372) )
  {
    mbuf_freem(a2);
    v32 = -1;
    goto LABEL_29;
  }
  IO80211PeerManager::lockDataPath(this);
  v4 = (__int64)_handle11z;
  v5 = IO80211CommandQueue::map(
         *((_QWORD *)this + 11),
         (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_handle11z,
         (__int64)this,
         (__int64)&v61,
         0LL,
         -1);
  v6 = v5;
  if ( !v5 )
  {
    LODWORD(v7) = mbuf_data(v2);
    v8 = v7;
    v9 = (unsigned __int8 *)(v7 + 6);
    LODWORD(v10) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64 (__fastcall *)(__int64, __int64, __int64 *)))(*(_QWORD *)this + 56LL))(
                     this,
                     _handle11z);
    v11 = OSMetaClass::getClassName(v10);
    v12 = *(_BYTE *)(v8 + 11);
    v13 = *(_BYTE *)(v8 + 10);
    v14 = *(_BYTE *)(v8 + 9);
    v15 = *(_BYTE *)(v8 + 8);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s peer not found %02X:%02X:%02X:%02X:%02X:%02X\n",
      v11,
      (__int64)"handle11zPacket",
      *(_BYTE *)(v8 + 6),
      *(_BYTE *)(v8 + 7));
    if ( !IO80211AWDLPeerManager::addInfraPeer(this, v9) )
    {
      LODWORD(v16) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, unsigned __int8 *))(*(_QWORD *)this + 56LL))(
                       this,
                       v9);
      v17 = OSMetaClass::getClassName(v16);
      IO80211PeerManager::logDebug(this, "%s::%s can't add infra peer\n", v17, (__int64)"handle11zPacket", v18, v19);
    }
    v4 = (__int64)_handle11z;
    v5 = IO80211CommandQueue::map(
           *((_QWORD *)this + 11),
           (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_handle11z,
           (__int64)this,
           (__int64)&v61,
           0LL,
           -1);
    v6 = v5;
    if ( !v5 )
    {
      LODWORD(v20) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64 (__fastcall *)(__int64, __int64, __int64 *)))(*(_QWORD *)this + 56LL))(
                       this,
                       _handle11z);
      v21 = OSMetaClass::getClassName(v20);
      v22 = *(_BYTE *)(v8 + 11);
      v23 = *(_BYTE *)(v8 + 10);
      v24 = *(_BYTE *)(v8 + 9);
      v25 = *(_BYTE *)(v8 + 8);
      v4 = (__int64)"%s::%s !! peer Added but not found %02X:%02X:%02X:%02X:%02X:%02X\n";
      v5 = IO80211PeerManager::logDebug(
             this,
             "%s::%s !! peer Added but not found %02X:%02X:%02X:%02X:%02X:%02X\n",
             v21,
             (__int64)"handle11zPacket",
             *(_BYTE *)(v8 + 6),
             *(_BYTE *)(v8 + 7));
    }
  }
  if ( !v6 )
    goto LABEL_33;
  LOWORD(v5) = v62;
  if ( (_BYTE)v62 )
  {
    v26 = mbuf_allocpacket(1LL, 128LL, &v60, &v59);
    if ( v26 || !v2 )
    {
      LODWORD(v37) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       128LL);
      v38 = OSMetaClass::getClassName(v37);
      v32 = 0;
      IO80211PeerManager::logDebug(
        this,
        "%s::%s cannot allocate mbuf size %u err %d\n",
        v38,
        (__int64)"handle11zPacket",
        128LL,
        (unsigned int)v26);
      IO80211PeerManager::unlockDataPath(this, (__int64)"%s::%s cannot allocate mbuf size %u err %d\n");
      goto LABEL_29;
    }
    v27 = IO80211AWDLPeerManager::buildInfraIdPacket(this, (IO80211AWDLPeer *)v6, BYTE1(v70), 1, v59);
    if ( !v59 )
    {
      LODWORD(v39) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
      v40 = OSMetaClass::getClassName(v39);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s cannot build infra Id packet\n",
        v40,
        (__int64)"handle11zPacket",
        v41,
        v42);
      IO80211PeerManager::unlockDataPath(this, (__int64)"%s::%s cannot build infra Id packet\n");
      v32 = -1;
      goto LABEL_29;
    }
    IO80211AWDLPeerManager::queueInfraPacket(this, v59);
    ++*(_DWORD *)(v6 + 1188);
    *(_QWORD *)(v6 + 1224) = getAbsoluteTime();
    v4 = 0x4000000LL;
    if ( IO80211PeerManager::shouldLog(this, 0x4000000LL) )
    {
      LODWORD(v28) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       0x4000000LL);
      v29 = OSMetaClass::getClassName(v28);
      v30 = *(_DWORD *)(v6 + 1188);
      v4 = 0x4000000LL;
      IO80211PeerManager::logDebug(
        this,
        0x4000000LL,
        "%s::%s send response ret=%u count %u\n",
        v29,
        (__int64)"handle11zPacket",
        v27);
    }
    LOBYTE(v31) = BYTE1(v62);
  }
  else
  {
    v31 = (unsigned int)v5 >> 8;
  }
  if ( !(_BYTE)v31 )
  {
LABEL_33:
    IO80211PeerManager::unlockDataPath(this, v4);
    mbuf_freem(v2);
    v32 = 0;
    goto LABEL_29;
  }
  LODWORD(v33) = mbuf_data(v2);
  v34 = v33;
  memcpy((void *)(v33 + 16), (const void *)(v6 + 32), 6uLL);
  memcpy((void *)(v34 + 10), (char *)this + 3680, 6uLL);
  mbuf_adj(v2, 10LL);
  LODWORD(v35) = mbuf_pkthdr_len(v2);
  mbuf_pkthdr_setlen(v2, v35 - 10);
  v45 = 0;
  v46 = 0;
  v47 = 0;
  v48 = v2;
  v49 = 0;
  v50 = 0;
  v58 = 0LL;
  v57 = 0LL;
  v56 = 0LL;
  v55 = 0LL;
  v54 = 0LL;
  v53 = 0LL;
  v52 = 0LL;
  v51 = 0LL;
  v32 = 0;
  v36 = 0;
  if ( this )
  {
    if ( IO80211PeerManager::shouldVerboseLog(this, 0x4000000LL) )
    {
      v36 = *((_DWORD *)this + 108);
    }
    else
    {
      v36 = *((_DWORD *)this + 106);
      if ( !*((_DWORD *)this + 106) )
        v36 = getLengthBeforeSensitivePayload(0, v48);
    }
  }
  v46 = v36;
  IO80211PeerManager::dumpPacket((__int64)this, 0x4000000LL, " Re ", (__int64)&v45);
  IO80211PeerManager::unlockDataPath(this, 0x4000000LL);
  v43 = *((_QWORD *)this + 16);
  if ( v43 )
  {
    v32 = 0;
    IO80211VirtualInterface::passUp(v43, (__int64)v2, 0LL);
  }
LABEL_29:
  result = *(_QWORD *)v3;
  if ( *(_QWORD *)v3 == v71 )
    result = (unsigned int)v32;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C8BE0: using guessed type int __fastcall mbuf_adj(_QWORD, _QWORD);
// C8BE8: using guessed type int __fastcall mbuf_allocpacket(_QWORD, _QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);
// C8C68: using guessed type int __fastcall mbuf_pkthdr_len(_QWORD);
// C8C80: using guessed type int __fastcall mbuf_pkthdr_setlen(_QWORD, _QWORD);

//----- (0000000000039ECE) ----------------------------------------------------
signed __int64 __fastcall _handle11z(__int64 a1, __int64 a2, __int64 *a3)
{
  __int64 *v3; // r14@1
  __int64 v4; // rax@1
  int v5; // ecx@1
  signed __int64 result; // rax@1

  v3 = a3;
  LODWORD(v4) = mbuf_data(*a3);
  v5 = memcmp((const void *)(v4 + 6), (const void *)(a2 + 1210), 6uLL);
  result = 0LL;
  if ( !v5 )
  {
    IO80211AWDLPeer::handle11zPacket((IO80211AWDLPeer *)a2, v3);
    result = 1LL;
  }
  return result;
}
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);

//----- (0000000000039F16) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::buildAndQueueOOBServiceResponse(IO80211AWDLPeerManager *this, IO80211AWDLPeer *a2)
{
  IO80211AWDLPeer *v2; // r12@1
  __int64 v3; // r14@1
  int v4; // ebx@1
  __int64 v5; // rax@3
  __int64 v6; // rbx@3
  OSMetaClass *v7; // rax@4
  __int64 v8; // rax@4
  signed __int64 v9; // rsi@5
  unsigned int v10; // eax@5
  unsigned int v11; // er13@5
  int v12; // er12@6
  __int64 v13; // r9@6
  int v14; // er13@8
  int v15; // er12@8
  __int64 v16; // r9@8
  unsigned int v17; // er13@10
  int v18; // er12@10
  char v19; // al@10
  __int64 v20; // r9@10
  unsigned int v21; // er13@12
  OSMetaClass *v22; // rax@13
  __int64 v23; // rax@13
  __mbuf *v24; // rsi@14
  signed int v25; // er13@14
  int v26; // er12@14
  OSMetaClass *v27; // rax@15
  __int64 v28; // rax@15
  int v29; // ST20_4@15
  int v30; // ST18_4@15
  int v31; // ST10_4@15
  int v32; // ST08_4@15
  int v33; // ST00_4@15
  OSMetaClass *v34; // rax@16
  __int64 v35; // rax@16
  OSMetaClass *v36; // rax@18
  __int64 v37; // rax@18
  __int64 v38; // r9@18
  __int64 result; // rax@21
  IO80211AWDLPeer *v40; // [sp+30h] [bp-B0h]@6
  __mbuf *v41; // [sp+38h] [bp-A8h]@1
  int v42; // [sp+44h] [bp-9Ch]@1
  __int64 v43; // [sp+48h] [bp-98h]@12
  __int64 v44; // [sp+50h] [bp-90h]@12
  __int64 v45; // [sp+58h] [bp-88h]@12
  int v46; // [sp+60h] [bp-80h]@12
  int v47; // [sp+64h] [bp-7Ch]@12
  char v48; // [sp+68h] [bp-78h]@12
  char v49; // [sp+69h] [bp-77h]@12
  int v50; // [sp+6Ch] [bp-74h]@12
  __int64 v51; // [sp+70h] [bp-70h]@12
  __int64 v52; // [sp+78h] [bp-68h]@12
  __int64 v53; // [sp+80h] [bp-60h]@12
  __int64 v54; // [sp+88h] [bp-58h]@12
  unsigned int v55; // [sp+90h] [bp-50h]@12
  int v56; // [sp+94h] [bp-4Ch]@12
  int v57; // [sp+98h] [bp-48h]@12
  __int64 v58; // [sp+A0h] [bp-40h]@12
  int v59; // [sp+A8h] [bp-38h]@12
  __int64 v60; // [sp+B0h] [bp-30h]@1

  v2 = a2;
  v3 = off_7B078[0];
  v60 = *(_QWORD *)off_7B078[0];
  v42 = 1;
  v41 = 0LL;
  v4 = mbuf_allocpacket(0LL, 1040LL, &v42, &v41);
  if ( v4 || !v41 )
  {
    LODWORD(v34) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                     this,
                     1040LL);
    v35 = OSMetaClass::getClassName(v34);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s cannot allocate mbuf size %u err %d\n",
      v35,
      (__int64)"buildAndQueueOOBServiceResponse",
      1040LL,
      (unsigned int)v4);
    v25 = -536870181;
    goto LABEL_21;
  }
  LODWORD(v5) = mbuf_data(v41);
  v6 = v5;
  if ( IO80211PeerManager::shouldLog(this, 0x200000LL) )
  {
    LODWORD(v7) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    0x200000LL);
    v8 = OSMetaClass::getClassName(v7);
    IO80211PeerManager::logDebug(
      this,
      0x200000LL,
      "%s::%s len %u\n",
      v8,
      (__int64)"buildAndQueueOOBServiceResponse",
      1040LL);
  }
  IO80211CommandQueue::lock(*((IO80211CommandQueue **)this + 476), 0LL, 0);
  *(_BYTE *)v6 = 127;
  *(_BYTE *)(v6 + 1) = 0;
  *(_BYTE *)(v6 + 2) = 23;
  *(_BYTE *)(v6 + 3) = -14;
  *(_BYTE *)(v6 + 4) = 8;
  *(_BYTE *)(v6 + 5) = 16;
  *(_BYTE *)(v6 + 6) = 1;
  *(_BYTE *)(v6 + 7) = 0;
  *(_DWORD *)(v6 + 12) = 0;
  *(_DWORD *)(v6 + 8) = 0;
  v9 = v6 + 16;
  v10 = IO80211AWDLPeerManager::buildSyncParamsTlv((__int64)this, v6 + 16);
  v11 = v10;
  if ( v10 )
  {
    v40 = v2;
    v12 = v10 + 16;
    if ( IO80211PeerManager::shouldLog(this, 0x200000LL) )
      IO80211PeerManager::logDebug(
        this,
        0x200000LL,
        "    -- added sync params len %u -> %u\n",
        v11,
        (unsigned int)v12,
        v13);
    v14 = 16 * (unsigned __int8)*((_DWORD *)this + 930) & 0x10;
    memset((void *)(v6 + (unsigned int)v12), 0, (unsigned int)(v14 + 24));
    *(_BYTE *)(v6 + (unsigned int)v12) = 5;
    *(_WORD *)(v6 + (unsigned int)v12 + 1) = v14 + 21;
    v15 = v14 + v12 + 24;
    if ( IO80211PeerManager::shouldLog(this, 0x200000LL) )
      IO80211PeerManager::logDebug(
        this,
        0x200000LL,
        "    -- added election params len %u -> %u\n",
        (unsigned int)(v14 + 24),
        (unsigned int)v15,
        v16);
    v17 = IO80211AWDLPeerManager::buildServiceParamTlv((__int64)this, v6 + (unsigned int)v15);
    v18 = v17 + v15;
    v19 = IO80211PeerManager::shouldLog(this, 0x200000LL);
    v3 = off_7B078[0];
    if ( v19 )
      IO80211PeerManager::logDebug(
        this,
        0x200000LL,
        "    -- added service params len %u -> %u\n",
        v17,
        (unsigned int)v18,
        v20);
    v43 = (unsigned int)v18 + v6;
    v44 = 0LL;
    v45 = (unsigned int)(1040 - v18);
    v46 = 0;
    v47 = 2;
    v48 = 0;
    v49 = 0;
    v50 = 0;
    v54 = 0LL;
    v53 = 0LL;
    v52 = 0LL;
    v51 = 0LL;
    v55 = 0;
    v56 = 0;
    v57 = 0;
    v58 = 0LL;
    v59 = 0;
    memcpy(&v51, (char *)v40 + 1680, 0x20uLL);
    IO80211CommandQueue::map(
      *((_QWORD *)this + 476),
      (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_copyTLV,
      (__int64)this,
      (__int64)&v43,
      0LL,
      -1);
    v21 = v44 + v18;
    if ( IO80211PeerManager::shouldLog(this, 0x200000LL) )
    {
      LODWORD(v22) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       0x200000LL);
      v23 = OSMetaClass::getClassName(v22);
      IO80211PeerManager::logDebug(
        this,
        0x200000LL,
        "%s::%s    -- added service tlvs num %u len %lu -> %u \n",
        v23,
        (__int64)"buildAndQueueOOBServiceResponse",
        v55);
    }
    mbuf_setlen(v41, v21);
    v24 = v41;
    v25 = 0;
    v26 = IO80211AWDLPeerManager::queueOOBFrame(this, v41, 0LL, v40);
    if ( !v26 )
    {
      IO80211CommandQueue::unlock(*((IO80211CommandQueue **)this + 476), 0LL);
      goto LABEL_21;
    }
    LODWORD(v27) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __mbuf *))(*(_QWORD *)this + 56LL))(this, v24);
    v28 = OSMetaClass::getClassName(v27);
    v29 = *((_BYTE *)v40 + 37);
    v30 = *((_BYTE *)v40 + 36);
    v31 = *((_BYTE *)v40 + 35);
    v32 = *((_BYTE *)v40 + 34);
    v33 = *((_BYTE *)v40 + 33);
    v9 = (signed __int64)"%s::%s couldn't queue OOB frame ret %d userpeer %02X:%02X:%02X:%02X:%02X:%02X\n";
    IO80211PeerManager::logDebug(
      this,
      "%s::%s couldn't queue OOB frame ret %d userpeer %02X:%02X:%02X:%02X:%02X:%02X\n",
      v28,
      (__int64)"buildAndQueueOOBServiceResponse",
      (unsigned int)v26,
      *((_BYTE *)v40 + 32));
    v25 = v26;
  }
  else
  {
    v25 = -536870212;
  }
  LODWORD(v36) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, v9);
  v37 = OSMetaClass::getClassName(v36);
  IO80211PeerManager::logDebug(
    this,
    "%s::%s couldn't build OOB frame ret %d\n",
    v37,
    (__int64)"buildAndQueueOOBServiceResponse",
    (unsigned int)v25,
    v38);
  IO80211CommandQueue::unlock(*((IO80211CommandQueue **)this + 476), 0LL);
  if ( v41 )
    mbuf_freem(v41);
LABEL_21:
  result = *(_QWORD *)v3;
  if ( *(_QWORD *)v3 == v60 )
    result = (unsigned int)v25;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C8BE8: using guessed type int __fastcall mbuf_allocpacket(_QWORD, _QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);
// C8CB0: using guessed type int __fastcall mbuf_setlen(_QWORD, _QWORD);

//----- (000000000003A39E) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::buildAndQueueOOBInquiry(IO80211AWDLPeerManager *this, IO80211AWDLPeer *a2)
{
  __int64 v2; // rax@1
  __int64 v3; // r13@1
  signed int v4; // ebx@1
  OSMetaClass *v5; // rax@3
  __int64 v6; // rax@3
  unsigned int v7; // eax@4
  unsigned int v8; // er15@4
  int v9; // er12@5
  __int64 v10; // r9@5
  int v11; // er15@7
  int v12; // er12@7
  __int64 v13; // r9@7
  unsigned int v14; // ebx@9
  int v15; // er12@9
  __int64 v16; // r9@9
  int v17; // ebx@11
  OSMetaClass *v18; // rax@13
  __int64 v19; // rax@13
  __int64 v20; // r9@13
  OSMetaClass *v21; // rax@14
  __int64 v22; // rax@14
  __int64 v23; // r9@14
  __int64 v24; // rbx@16
  int v26; // [sp+18h] [bp-78h]@16
  int v27; // [sp+1Ch] [bp-74h]@16
  __int64 *v28; // [sp+20h] [bp-70h]@16
  __int64 v29; // [sp+30h] [bp-60h]@1
  __int64 v30; // [sp+38h] [bp-58h]@1
  __int64 v31; // [sp+40h] [bp-50h]@1
  __int64 v32; // [sp+48h] [bp-48h]@1
  __int64 v33; // [sp+50h] [bp-40h]@1
  __int64 v34; // [sp+58h] [bp-38h]@1
  __int64 v35; // [sp+60h] [bp-30h]@1

  v35 = 0LL;
  v34 = 0LL;
  v33 = 0LL;
  v32 = 0LL;
  v31 = 0LL;
  v30 = 0LL;
  v29 = 0LL;
  LODWORD(v29) = 1;
  LODWORD(v2) = kalloc(1040LL);
  v3 = v2;
  v4 = 0;
  if ( v2 )
  {
    if ( IO80211PeerManager::shouldLog(this, 0x200000LL) )
    {
      LODWORD(v5) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                      this,
                      0x200000LL);
      v6 = OSMetaClass::getClassName(v5);
      IO80211PeerManager::logDebug(this, 0x200000LL, "%s::%s len %u\n", v6, (__int64)"buildAndQueueOOBInquiry", 1040LL);
    }
    *(_BYTE *)v3 = 127;
    *(_BYTE *)(v3 + 1) = 0;
    *(_BYTE *)(v3 + 2) = 23;
    *(_BYTE *)(v3 + 3) = -14;
    *(_BYTE *)(v3 + 4) = 8;
    *(_BYTE *)(v3 + 5) = 16;
    *(_BYTE *)(v3 + 6) = 1;
    *(_BYTE *)(v3 + 7) = 0;
    *(_DWORD *)(v3 + 12) = 0;
    *(_DWORD *)(v3 + 8) = 0;
    v7 = IO80211AWDLPeerManager::buildSyncParamsTlv((__int64)this, v3 + 16);
    v8 = v7;
    v4 = -536870212;
    if ( v7 )
    {
      v9 = v7 + 16;
      if ( IO80211PeerManager::shouldLog(this, 0x200000LL) )
        IO80211PeerManager::logDebug(
          this,
          0x200000LL,
          "    -- added sync params len %u -> %u\n",
          v8,
          (unsigned int)v9,
          v10);
      v11 = 16 * (unsigned __int8)*((_DWORD *)this + 930) & 0x10;
      memset((void *)(v3 + (unsigned int)v9), 0, (unsigned int)(v11 + 24));
      *(_BYTE *)(v3 + (unsigned int)v9) = 5;
      *(_WORD *)(v3 + (unsigned int)v9 + 1) = v11 + 21;
      v12 = v11 + v9 + 24;
      if ( IO80211PeerManager::shouldLog(this, 0x200000LL) )
        IO80211PeerManager::logDebug(
          this,
          0x200000LL,
          "    -- added election params len %u -> %u\n",
          (unsigned int)(v11 + 24),
          (unsigned int)v12,
          v13);
      v14 = IO80211AWDLPeerManager::buildServiceParamTlv((__int64)this, v3 + (unsigned int)v12);
      v15 = v14 + v12;
      if ( IO80211PeerManager::shouldLog(this, 0x200000LL) )
        IO80211PeerManager::logDebug(
          this,
          0x200000LL,
          "    -- added service params len %u -> %u\n",
          v14,
          (unsigned int)v15,
          v16);
      v17 = IO80211AWDLPeer::copyServiceRequestTlv(a2, (unsigned __int8 *)(v3 + (unsigned int)v15));
      if ( v17 || !IO80211PeerManager::shouldLog(this, 0x100000LL) )
      {
        v24 = (unsigned int)(v15 + v17);
        memset((char *)&v29 + 4, 255, 6uLL);
        LODWORD(v33) = 0;
        memcpy((char *)&v31 + 6, (char *)this + 3668, 6uLL);
        v35 = v3;
        LOWORD(v34) = v24;
        WORD2(v31) = 7;
        v27 = 149;
        v28 = &v29;
        v26 = -2144835128;
        IO80211PeerManager::ioctl_internal(this, (__int64)&v26);
        kfree(v3, v24);
        v4 = 0;
        return (unsigned int)v4;
      }
      LODWORD(v18) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       0x100000LL);
      v19 = OSMetaClass::getClassName(v18);
      IO80211PeerManager::logDebug(
        this,
        0x100000LL,
        "%s::%s no Requests to copy \n",
        v19,
        (__int64)"buildAndQueueOOBInquiry",
        v20);
      v4 = -2;
    }
  }
  LODWORD(v21) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
  v22 = OSMetaClass::getClassName(v21);
  IO80211PeerManager::logDebug(
    this,
    "%s::%s couldn't build OOB frame ret %d\n",
    v22,
    (__int64)"buildAndQueueOOBInquiry",
    (unsigned int)v4,
    v23);
  if ( v3 )
    kfree(v3, 1040LL);
  return (unsigned int)v4;
}
// C8BB8: using guessed type int __fastcall kalloc(_QWORD);
// C8BC8: using guessed type int __fastcall kfree(_QWORD, _QWORD);

//----- (000000000003A6B8) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::buildAndQueueOOBData(IO80211AWDLPeerManager *this, __mbuf *a2, IO80211AWDLPeer *a3)
{
  IO80211AWDLPeer *v3; // r12@1
  int v4; // eax@1
  int v5; // er15@1
  int v6; // eax@1
  signed int v7; // er14@1
  __int64 v8; // rsi@2
  int v9; // er12@2
  __int64 v10; // rax@4
  __int64 v11; // r12@4
  OSMetaClass *v12; // rax@5
  __int64 v13; // rax@5
  signed __int64 v14; // rsi@6
  unsigned int v15; // eax@6
  unsigned int v16; // ebx@6
  int v17; // er15@7
  __int64 v18; // r9@7
  int v19; // er14@9
  int v20; // er14@9
  __int64 v21; // r9@9
  unsigned int v22; // ebx@11
  int v23; // er14@11
  __int64 v24; // r9@11
  unsigned int v25; // eax@13
  unsigned int v26; // ebx@13
  int v27; // er14@14
  __int64 v28; // r9@14
  __mbuf *v29; // rsi@16
  int v30; // er15@16
  OSMetaClass *v31; // rax@17
  __int64 v32; // rax@17
  int v33; // ST20_4@17
  int v34; // ST18_4@17
  int v35; // ST10_4@17
  int v36; // ST08_4@17
  int v37; // ST00_4@17
  OSMetaClass *v38; // rax@18
  __int64 v39; // rax@18
  OSMetaClass *v40; // rax@19
  __int64 v41; // rbx@19
  OSMetaClass *v42; // rax@20
  __int64 v43; // rax@20
  __int64 v44; // r9@20
  size_t v46; // [sp+28h] [bp-58h]@9
  IO80211AWDLPeer *v47; // [sp+30h] [bp-50h]@2
  __mbuf *v48; // [sp+38h] [bp-48h]@2
  int v49; // [sp+44h] [bp-3Ch]@2
  __mbuf *v50; // [sp+48h] [bp-38h]@1
  int v51; // [sp+54h] [bp-2Ch]@1

  v3 = a3;
  v51 = 1;
  v50 = 0LL;
  v4 = mbuf_pkthdr_len(a2);
  v5 = v4;
  v6 = v4 + 256;
  v7 = -536870181;
  if ( (unsigned int)v6 > 0x410 )
    return (unsigned int)v7;
  v48 = a2;
  v47 = v3;
  v8 = (unsigned int)v6;
  v49 = v6;
  v9 = mbuf_allocpacket(0LL, (unsigned int)v6, &v51, &v50);
  if ( v9 || !v50 )
  {
    LODWORD(v38) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64))(*(_QWORD *)this + 56LL))(this, v8);
    v39 = OSMetaClass::getClassName(v38);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s cannot allocate mbuf size %u err %d\n",
      v39,
      (__int64)"buildAndQueueOOBData",
      (unsigned int)v49,
      (unsigned int)v9);
    return (unsigned int)v7;
  }
  LODWORD(v10) = mbuf_data(v50);
  v11 = v10;
  if ( IO80211PeerManager::shouldLog(this, 0x200000LL) )
  {
    LODWORD(v12) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                     this,
                     0x200000LL);
    v13 = OSMetaClass::getClassName(v12);
    IO80211PeerManager::logDebug(
      this,
      0x200000LL,
      "%s::%s len %u\n",
      v13,
      (__int64)"buildAndQueueOOBData",
      (unsigned int)v5);
  }
  IO80211CommandQueue::lock(*((IO80211CommandQueue **)this + 476), 0LL, 0);
  *(_BYTE *)v11 = 127;
  *(_BYTE *)(v11 + 1) = 0;
  *(_BYTE *)(v11 + 2) = 23;
  *(_BYTE *)(v11 + 3) = -14;
  *(_BYTE *)(v11 + 4) = 8;
  *(_BYTE *)(v11 + 5) = 16;
  *(_BYTE *)(v11 + 6) = 1;
  *(_BYTE *)(v11 + 7) = 0;
  *(_DWORD *)(v11 + 12) = 0;
  *(_DWORD *)(v11 + 8) = 0;
  v14 = v11 + 16;
  v15 = IO80211AWDLPeerManager::buildSyncParamsTlv((__int64)this, v11 + 16);
  v16 = v15;
  if ( v15 )
  {
    v17 = v15 + 16;
    if ( IO80211PeerManager::shouldLog(this, 0x200000LL) )
      IO80211PeerManager::logDebug(
        this,
        0x200000LL,
        "    -- added sync params len %u -> %u\n",
        v16,
        (unsigned int)v17,
        v18);
    v19 = 16 * (unsigned __int8)*((_DWORD *)this + 930) & 0x10;
    v46 = (unsigned int)(v19 + 24);
    memset((void *)(v11 + (unsigned int)v17), 0, v46);
    *(_BYTE *)(v11 + (unsigned int)v17) = 5;
    *(_WORD *)(v11 + (unsigned int)v17 + 1) = v19 + 21;
    v20 = v19 + v17 + 24;
    if ( IO80211PeerManager::shouldLog(this, 0x200000LL) )
      IO80211PeerManager::logDebug(
        this,
        0x200000LL,
        "    -- added election params len %u -> %u\n",
        v46,
        (unsigned int)v20,
        v21);
    v22 = IO80211AWDLPeerManager::buildServiceParamTlv((__int64)this, v11 + (unsigned int)v20);
    v23 = v22 + v20;
    if ( IO80211PeerManager::shouldLog(this, 0x200000LL) )
      IO80211PeerManager::logDebug(
        this,
        0x200000LL,
        "    -- added service params len %u -> %u\n",
        v22,
        (unsigned int)v23,
        v24);
    v25 = IO80211AWDLPeerManager::buildEncapsulatedIP(
            this,
            (unsigned __int8 *)((unsigned int)v23 + v11),
            v48,
            v49 - v23);
    v26 = v25;
    if ( v25 )
    {
      v27 = v25 + v23;
      if ( IO80211PeerManager::shouldLog(this, 0x200000LL) )
        IO80211PeerManager::logDebug(
          this,
          0x200000LL,
          "    -- added encapsulated IP len %u -> %u\n",
          v26,
          (unsigned int)v27,
          v28);
      mbuf_setlen(v50, (unsigned int)v27);
      v29 = v50;
      v7 = 0;
      v30 = IO80211AWDLPeerManager::queueOOBFrame(this, v50, 0LL, v47);
      if ( v30 )
      {
        LODWORD(v31) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __mbuf *))(*(_QWORD *)this + 56LL))(this, v29);
        v32 = OSMetaClass::getClassName(v31);
        v33 = *((_BYTE *)v47 + 37);
        v34 = *((_BYTE *)v47 + 36);
        v35 = *((_BYTE *)v47 + 35);
        v36 = *((_BYTE *)v47 + 34);
        v37 = *((_BYTE *)v47 + 33);
        IO80211PeerManager::logDebug(
          this,
          "%s::%s couldn't queue OOB frame ret %d userpeer %02X:%02X:%02X:%02X:%02X:%02X\n",
          v32,
          (__int64)"buildAndQueueOOBData",
          (unsigned int)v30,
          *((_BYTE *)v47 + 32));
        v7 = v30;
      }
      else
      {
        IO80211CommandQueue::unlock(*((IO80211CommandQueue **)this + 476), 0LL);
      }
      return (unsigned int)v7;
    }
    LODWORD(v40) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
    v41 = OSMetaClass::getClassName(v40);
    mbuf_pkthdr_len(v48);
    v14 = (signed __int64)"%s::%s   error with encapsulated IP %u %u af_size %u len %lu\n";
    IO80211PeerManager::logDebug(
      this,
      "%s::%s   error with encapsulated IP %u %u af_size %u len %lu\n",
      v41,
      (__int64)"buildAndQueueOOBData",
      0LL,
      (unsigned int)v23);
  }
  LODWORD(v42) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, v14);
  v43 = OSMetaClass::getClassName(v42);
  v7 = -536870212;
  IO80211PeerManager::logDebug(
    this,
    "%s::%s couldn't build OOB frame ret %d\n",
    v43,
    (__int64)"buildAndQueueOOBData",
    3758097084LL,
    v44);
  IO80211CommandQueue::unlock(*((IO80211CommandQueue **)this + 476), 0LL);
  if ( v50 )
    mbuf_freem(v50);
  return (unsigned int)v7;
}
// C8BE8: using guessed type int __fastcall mbuf_allocpacket(_QWORD, _QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);
// C8C68: using guessed type int __fastcall mbuf_pkthdr_len(_QWORD);
// C8CB0: using guessed type int __fastcall mbuf_setlen(_QWORD, _QWORD);

//----- (000000000003AAB0) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::buildServiceRequest(IO80211AWDLPeerManager *this, unsigned int a2, __int64 a3)
{
  __int64 v3; // rbx@1
  unsigned int v4; // er15@1
  signed int v5; // er14@1
  char *v6; // r12@3
  OSMetaClass *v7; // rax@4
  __int64 v8; // rax@4
  __int64 v9; // r14@4
  __int64 v10; // r9@4
  OSMetaClass *v11; // rax@6
  __int64 v12; // rax@6
  __int64 v13; // rcx@6
  __int64 v14; // r8@6
  __int64 v15; // r9@6
  int v16; // ebx@7
  int v17; // ebx@9
  unsigned int v18; // ebx@12
  int v19; // er14@12
  __int64 v20; // r9@12
  __int64 v21; // rbx@14
  int v22; // ST20_4@14
  int v23; // er14@14
  int v24; // er14@14
  __int64 v25; // r9@14
  unsigned int v26; // eax@16
  int v27; // ecx@16
  unsigned int v28; // er14@16
  size_t v29; // r12@16
  int v30; // eax@18
  int *v31; // rdx@19
  __int64 *v32; // rcx@19
  unsigned int v33; // er13@19
  signed __int64 v34; // rsi@19
  int v35; // ebx@20
  __int64 v36; // rsi@21
  int v37; // er14@21
  __int64 v38; // rdi@24
  void *v39; // rax@26
  __int64 v40; // rax@26
  size_t v41; // r14@26
  unsigned int v42; // ebx@26
  unsigned int v43; // er12@26
  const char *v44; // rsi@27
  __int64 v45; // r15@38
  __int64 v46; // rax@38
  OSMetaClass *v47; // rax@39
  __int64 v48; // r14@39
  __int64 v49; // rax@39
  __int64 v50; // rcx@39
  __int64 v51; // rbx@42
  IO80211PeerManager *v52; // r15@42
  OSMetaClass *v53; // rax@43
  __int64 v54; // rdx@43
  __int64 v55; // r8@43
  __int64 v56; // rcx@43
  IO80211PeerManager *v57; // rdi@43
  __int64 v58; // r9@43
  OSMetaClass *v59; // rax@44
  __int64 v60; // rax@44
  __int64 v61; // r8@44
  __int64 v62; // r9@44
  OSMetaClass *v63; // rax@45
  __int64 v64; // rax@45
  __int64 v65; // r8@45
  __int64 v66; // r9@45
  OSMetaClass *v67; // rax@46
  OSMetaClass *v68; // rax@49
  __int64 v69; // rax@49
  __int64 v70; // r9@49
  __int64 v71; // rdx@49
  __int64 v72; // rcx@49
  __int64 result; // rax@51
  size_t v74; // [sp+8h] [bp-378h]@19
  int v75; // [sp+10h] [bp-370h]@18
  size_t v76; // [sp+18h] [bp-368h]@14
  __int64 v77; // [sp+18h] [bp-368h]@21
  __int64 v78; // [sp+20h] [bp-360h]@19
  IO80211AWDLPeerManager *v79; // [sp+28h] [bp-358h]@18
  __int64 v80; // [sp+30h] [bp-350h]@5
  unsigned __int8 v81; // [sp+3Dh] [bp-343h]@27
  unsigned __int16 v82; // [sp+3Eh] [bp-342h]@27
  __int64 v83; // [sp+40h] [bp-340h]@19
  int v84; // [sp+4Ch] [bp-334h]@19
  char v85; // [sp+50h] [bp-330h]@3
  char v86; // [sp+150h] [bp-230h]@12
  char v87; // [sp+151h] [bp-22Fh]@12
  char v88; // [sp+152h] [bp-22Eh]@12
  char v89; // [sp+153h] [bp-22Dh]@12
  char v90; // [sp+154h] [bp-22Ch]@12
  char v91; // [sp+155h] [bp-22Bh]@12
  char v92; // [sp+156h] [bp-22Ah]@12
  char v93; // [sp+157h] [bp-229h]@12
  int v94; // [sp+158h] [bp-228h]@12
  int v95; // [sp+15Ch] [bp-224h]@12
  char v96; // [sp+160h] [bp-220h]@12
  unsigned __int16 v97; // [sp+161h] [bp-21Fh]@14
  __int64 v98; // [sp+350h] [bp-30h]@1

  v3 = a3;
  v4 = a2;
  v98 = *(_QWORD *)off_7B078[0];
  v5 = 32;
  if ( a2 <= 0x20 )
    v5 = a2;
  v6 = &v85;
  if ( copyin(a3, &v85, (unsigned int)v5) )
  {
    LODWORD(v7) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, char *))(*(_QWORD *)this + 56LL))(this, &v85);
    v8 = OSMetaClass::getClassName(v7);
    v9 = 0LL;
    IO80211PeerManager::logDebug(this, "%s::%s can't copy from %llx\n", v8, (__int64)"buildServiceRequest", v3, v10);
  }
  else
  {
    v80 = v3;
    if ( IO80211PeerManager::shouldLog(this, 0x200000LL) )
    {
      LODWORD(v11) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       0x200000LL);
      v12 = OSMetaClass::getClassName(v11);
      IO80211PeerManager::logDebug(this, 0x200000LL, "%s::%s len %u\n", v12, (__int64)"buildServiceRequest", a2);
      if ( v5 )
      {
        v16 = -33;
        if ( ~a2 > 0xFFFFFFDF )
          v16 = ~a2;
        v17 = ~v16;
        do
        {
          IO80211PeerManager::logDebug(this, 0x200000LL, "%02X ", (unsigned __int8)*v6++, v14, v15);
          --v17;
        }
        while ( v17 );
      }
      IO80211PeerManager::logDebug(this, 0x200000LL, "\n", v13, v14, v15);
    }
    v86 = 127;
    v87 = 0;
    v88 = 23;
    v89 = -14;
    v90 = 8;
    v91 = 16;
    v92 = 1;
    v93 = 0;
    v95 = 0;
    v94 = 0;
    v18 = IO80211AWDLPeerManager::buildSyncParamsTlv((__int64)this, (__int64)&v96);
    v19 = v18 + 16;
    if ( IO80211PeerManager::shouldLog(this, 0x200000LL) )
      IO80211PeerManager::logDebug(
        this,
        0x200000LL,
        "    -- added sync params len %u -> %u\n",
        v18,
        (unsigned int)v19,
        v20);
    v21 = v97;
    v22 = v19;
    v23 = 16 * (unsigned __int8)*((_DWORD *)this + 930) & 0x10;
    v76 = (unsigned int)(v23 + 24);
    memset(&v86 + v97 + 19, 0, v76);
    *(&v86 + v21 + 19) = 5;
    *(_WORD *)(&v86 + v21 + 20) = v23 + 21;
    v24 = v23 + v22 + 24;
    if ( IO80211PeerManager::shouldLog(this, 0x200000LL) )
      IO80211PeerManager::logDebug(
        this,
        0x200000LL,
        "    -- added election params len %u -> %u\n",
        v76,
        (unsigned int)v24,
        v25);
    v26 = IO80211AWDLPeerManager::buildServiceParamTlv((__int64)this, (__int64)(&v86 + v21 + 43));
    v27 = v24;
    v28 = v26;
    LODWORD(v29) = v26 + v27;
    if ( IO80211PeerManager::shouldLog(this, 0x200000LL) )
      IO80211PeerManager::logDebug(
        this,
        0x200000LL,
        "    -- added service params len %u -> %u tlv_len %u\n",
        v28,
        (unsigned int)v29,
        a2);
    v79 = this;
    v9 = 0LL;
    v30 = v29;
    v75 = v29;
    if ( a2 )
    {
      v29 = (unsigned int)v29;
      v74 = (unsigned int)v29;
      v31 = &v84;
      v32 = &v83;
      v33 = 0;
      v34 = 0LL;
      v78 = 0LL;
      v9 = 0LL;
      while ( 1 )
      {
        v84 = 1;
        v83 = 0LL;
        v35 = v4 + v30;
        if ( v4 + v30 >= 0x411 )
        {
          LODWORD(v63) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64, int *, __int64 *))(*(_QWORD *)v79 + 56LL))(
                           v79,
                           v34,
                           v31,
                           v32);
          v64 = OSMetaClass::getClassName(v63);
          v9 = 0LL;
          IO80211PeerManager::logDebug(
            v79,
            "%s::%s must generate fragmented frame\n",
            v64,
            (__int64)"buildServiceRequest",
            v65,
            v66);
          goto LABEL_51;
        }
        v77 = v9;
        v36 = (unsigned int)v35;
        v37 = mbuf_allocpacket(0LL, (unsigned int)v35, v31, v32);
        if ( v37 || (v36 = v83) == 0 )
        {
          v52 = v79;
          LODWORD(v67) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, __int64))(*(_QWORD *)v79 + 56LL))(v79, v36);
          v54 = OSMetaClass::getClassName(v67);
          v44 = "%s::%s cannot allocate mbuf size %u err %d\n";
          v56 = (__int64)"buildServiceRequest";
          v57 = v79;
          v55 = (unsigned int)v35;
          v58 = (unsigned int)v37;
LABEL_47:
          IO80211PeerManager::logDebug(v57, v44, v54, v56, v55, v58);
          goto LABEL_48;
        }
        if ( v78 )
        {
          mbuf_setnextpkt(v78, v83);
          v38 = v83;
        }
        else
        {
          v77 = v83;
          v38 = v83;
        }
        v78 = v38;
        LODWORD(v39) = mbuf_data(v38);
        memcpy(v39, &v86, v29);
        LODWORD(v40) = mbuf_data(v83);
        v41 = v29 + v40;
        v42 = 0;
        v43 = v4;
        if ( v4 )
          break;
LABEL_38:
        v45 = v83;
        LODWORD(v46) = mbuf_data(v83);
        mbuf_setlen(v45, v41 - v46);
        v34 = 0x200000LL;
        v9 = v77;
        if ( IO80211PeerManager::shouldLog(v79, 0x200000LL) )
        {
          LODWORD(v47) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)v79 + 56LL))(
                           v79,
                           0x200000LL);
          v48 = OSMetaClass::getClassName(v47);
          LODWORD(v49) = mbuf_len(v83);
          v34 = 0x200000LL;
          v50 = v48;
          v9 = v77;
          IO80211PeerManager::logDebug(
            v79,
            0x200000LL,
            "%s::%s total len %lu remain %u\n",
            v50,
            (__int64)"buildServiceRequest",
            v49);
        }
        v4 = v42;
        v30 = v75;
        v29 = v74;
        v31 = &v84;
        v32 = &v83;
        if ( !v42 )
          goto LABEL_51;
      }
      while ( 1 )
      {
        v82 = 0;
        v81 = 0;
        v44 = (const char *)&v82;
        if ( copyin(v80 + 1, &v82, 2LL) || (v44 = (const char *)&v81, copyin(v80, &v81, 1LL)) )
        {
LABEL_42:
          v51 = v77;
          v52 = v79;
          goto LABEL_49;
        }
        v82 += 3;
        if ( IO80211PeerManager::shouldLog(v79, 0x100000LL) )
          IO80211PeerManager::logDebug(v79, 0x100000LL, "    -- tlv %u: len %u type %u\n", v33, v82, v81);
        if ( v82 > v43 )
        {
          v52 = v79;
          LODWORD(v53) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)v79 + 56LL))(
                           v79,
                           0x100000LL);
          v54 = OSMetaClass::getClassName(v53);
          v55 = v82;
          v44 = "%s::%s wrong tlv len %u remain %u\n";
          v56 = (__int64)"buildServiceRequest";
          v57 = v79;
          v58 = v43;
          goto LABEL_47;
        }
        if ( v82 > v4 )
          break;
        v44 = (const char *)v41;
        if ( copyin(v80, v41, v82) )
          goto LABEL_42;
        ++v33;
        v80 += v82;
        v41 += v82;
        v43 -= v82;
        if ( !v43 )
        {
          v42 = 0;
          goto LABEL_38;
        }
        v4 -= v82;
        v42 = v43;
        if ( !v4 )
          goto LABEL_38;
      }
      v52 = v79;
      LODWORD(v59) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)v79 + 56LL))(
                       v79,
                       0x100000LL);
      v60 = OSMetaClass::getClassName(v59);
      v44 = "%s::%s fragmentation not supported\n";
      IO80211PeerManager::logDebug(
        v79,
        "%s::%s fragmentation not supported\n",
        v60,
        (__int64)"buildServiceRequest",
        v61,
        v62);
LABEL_48:
      v51 = v77;
LABEL_49:
      LODWORD(v68) = (*(int (__fastcall **)(IO80211PeerManager *, const char *))(*(_QWORD *)v52 + 56LL))(v52, v44);
      v69 = OSMetaClass::getClassName(v68);
      v9 = 0LL;
      IO80211PeerManager::logDebug(v52, "%s::%s return error %p\n", v69, (__int64)"buildServiceRequest", v51, v70);
      if ( v51 )
      {
        mbuf_freem_list(v51, "%s::%s return error %p\n", v71, v72);
        v9 = 0LL;
      }
    }
  }
LABEL_51:
  result = *(_QWORD *)off_7B078[0];
  if ( *(_QWORD *)off_7B078[0] == v98 )
    result = v9;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C8A40: using guessed type int __fastcall copyin(_QWORD, _QWORD, _QWORD);
// C8BE8: using guessed type int __fastcall mbuf_allocpacket(_QWORD, _QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C28: using guessed type int __fastcall mbuf_freem_list(_QWORD, _QWORD, _QWORD, _QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8CB0: using guessed type int __fastcall mbuf_setlen(_QWORD, _QWORD);
// C8CC0: using guessed type int __fastcall mbuf_setnextpkt(_QWORD, _QWORD);

//----- (000000000003B15E) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::comparePeerForPrivateElection(IO80211AWDLPeerManager *this, IO80211AWDLPeer *a2)
{
  return memcmp((char *)a2 + 32, (char *)this + 3680, 6uLL) == 0;
}

//----- (000000000003B184) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::copyServiceRequestsForPeer(IO80211AWDLPeerManager *this, IO80211AWDLPeer *a2, unsigned __int8 *a3)
{
  int v3; // ecx@2
  int v4; // er9@1
  unsigned int v5; // esi@1
  __int64 result; // rax@4
  int v7; // [sp+Ch] [bp-4h]@6

  v4 = 0;
  v5 = 0;
  while ( 1 )
  {
    v3 = *((_DWORD *)this + 2035);
    if ( _bittest((const unsigned int *)&v3, v5) )
    {
      if ( *((_BYTE *)this + 8144) )
        break;
    }
    ++v5;
    v4 += 8;
    result = 0LL;
    if ( v5 >= 0x20 )
      return result;
  }
  v7 = 0;
  IO80211CommandQueue::lockMap(
    *((IO80211CommandQueue **)this + 476),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countAdvertisement,
    (__int64)this,
    (__int64)&v7,
    0LL,
    v4);
  return 1LL;
}

//----- (000000000003B1E3) ----------------------------------------------------
__int64 __fastcall _countAdvertisement(__int64 a1, __int64 a2, __int64 a3)
{
  if ( *(_BYTE *)(a2 + 73) == 2 )
    ++*(_DWORD *)a3;
  return 0LL;
}

//----- (000000000003B1F6) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::updateSSTH(IO80211AWDLPeerManager *this)
{
  int v1; // ebx@1
  int v2; // er13@1
  int v3; // er15@1
  int v4; // er12@2
  __int64 v5; // rcx@3
  int v6; // eax@4
  __int64 v7; // rcx@5
  OSMetaClass *v8; // rax@9
  __int64 v9; // rax@9
  int v10; // ST10_4@9
  int v11; // ST00_4@9
  int v13; // [sp+24h] [bp-2Ch]@2

  v1 = 0;
  memset((char *)this + 8144, 0, 0x20uLL);
  memset((char *)this + 8180, 0, 0x20uLL);
  *((_DWORD *)this + 2044) = 0;
  *((_DWORD *)this + 2035) = 0;
  IO80211VirtualInterface::postMessage(*((IO80211VirtualInterface **)this + 16), 0x38uLL, 0LL, 0LL);
  v2 = 0;
  v3 = 0;
  do
  {
    v13 = 0;
    IO80211CommandQueue::lockMap(
      *((IO80211CommandQueue **)this + 476),
      (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countAdvertisement,
      (__int64)this,
      (__int64)&v13,
      0LL,
      v1);
    v4 = v13;
    if ( v13 )
    {
      v5 = (unsigned int)v1 >> 3;
      *((_BYTE *)this + v5 + 8144) |= 1 << (v1 & 7);
      *((_DWORD *)this + 2035) |= 1 << v5;
    }
    v13 = 0;
    IO80211CommandQueue::lockMap(
      *((IO80211CommandQueue **)this + 476),
      (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countBrowse,
      (__int64)this,
      (__int64)&v13,
      0LL,
      v1);
    v6 = v13;
    if ( v13 )
    {
      v7 = (unsigned int)v1 >> 3;
      *((_BYTE *)this + v7 + 8180) |= 1 << (v1 & 7);
      *((_DWORD *)this + 2044) |= 1 << v7;
    }
    v3 += v4;
    v2 += v6;
    ++v1;
  }
  while ( v1 != 256 );
  if ( IO80211PeerManager::shouldLog(this, 0x100000LL) && IO80211PeerManager::shouldVerboseLog(this, 0x100000LL) )
  {
    LODWORD(v8) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    0x100000LL);
    v9 = OSMetaClass::getClassName(v8);
    v10 = *((_DWORD *)this + 2044);
    v11 = *((_DWORD *)this + 2035);
    IO80211PeerManager::logDebug(
      this,
      0x100000LL,
      "%s::%s SUI %u ssth_map 0x%x cnt %u - browse_map 0x%x cnt %u\n",
      v9,
      (__int64)"updateSSTH",
      *((_WORD *)this + 4068));
  }
  return 0LL;
}

//----- (000000000003B3C4) ----------------------------------------------------
__int64 __fastcall _countBrowse(__int64 a1, __int64 a2, __int64 a3)
{
  if ( *(_BYTE *)(a2 + 73) == 1 )
    ++*(_DWORD *)a3;
  return 0LL;
}

//----- (000000000003B3D8) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::updateLocalRequests(IO80211AWDLPeerManager *this, __int64 a2)
{
  __int64 v2; // r13@1
  int v3; // er15@1
  __int64 v4; // r12@1
  OSMetaClass *v5; // rax@3
  __int64 v6; // rax@3
  signed int v7; // er14@3
  __int64 v8; // r8@3
  __int64 v9; // r9@3
  __int64 v10; // rbx@6
  __int64 v11; // r14@9
  __int64 v12; // r13@9
  __int64 v13; // rbx@12
  char *v14; // rsi@12
  __int64 v15; // rbx@14
  OSMetaClass *v16; // rax@15
  __int64 v17; // rcx@15
  __int64 v18; // r14@17
  int v19; // ST90_4@19
  int v20; // ST8C_4@19
  int v21; // eax@19
  OSMetaClass *v22; // rax@20
  __int64 v23; // rcx@20
  __int64 v24; // r8@20
  bool v25; // zf@22
  __int64 v26; // r14@22
  __int64 v27; // rdx@22
  char v28; // bl@24
  unsigned __int64 v29; // rdx@28
  char *v30; // rcx@29
  __int64 v31; // ST58_8@30
  unsigned __int64 v32; // rax@33
  unsigned __int64 v33; // rax@34
  __int64 v34; // rdi@35
  __int64 v35; // rdx@37
  __int64 v36; // rcx@37
  __int64 v37; // r8@37
  __int64 v38; // r9@37
  unsigned __int64 v39; // rax@41
  __int64 v40; // rbx@41
  unsigned __int64 v41; // rax@42
  OSMetaClass *v42; // rax@44
  __int64 v43; // rax@44
  __int64 v44; // r9@44
  __int64 v45; // rax@46
  __int64 v46; // rdx@49
  __int64 v47; // rcx@49
  __int64 v48; // r8@49
  __int64 v49; // r9@49
  OSMetaClass *v50; // rax@53
  __int64 v51; // rax@53
  __int64 v52; // r9@53
  __int64 v53; // rax@54
  char v54; // al@54
  __int64 v55; // rcx@54
  unsigned int v56; // eax@56
  __int64 v57; // r14@56
  OSMetaClass *v58; // rax@57
  __int64 v59; // rax@57
  OSMetaClass *v60; // rax@59
  __int64 v61; // rdx@59
  __int64 v62; // r9@59
  const char *v63; // rsi@59
  OSMetaClass *v64; // rax@61
  __int64 v65; // r15@47
  OSMetaClass *v66; // rax@66
  __int64 v67; // rcx@66
  __int64 v68; // r9@66
  OSMetaClass *v69; // rax@73
  __int64 v70; // rax@73
  __int64 v71; // r9@73
  OSMetaClass *v72; // rax@74
  __int64 v73; // rax@74
  __int64 v74; // rax@74
  OSMetaClass *v75; // rax@78
  __int64 v76; // rax@78
  OSMetaClass *v77; // rax@79
  __int64 v78; // rax@79
  __int64 v80; // [sp+0h] [bp-160h]@0
  __int64 v81; // [sp+8h] [bp-158h]@0
  __int64 v82; // [sp+10h] [bp-150h]@0
  __int64 v83; // [sp+18h] [bp-148h]@0
  __int64 v84; // [sp+20h] [bp-140h]@0
  __int64 v85; // [sp+28h] [bp-138h]@0
  int v86; // [sp+94h] [bp-CCh]@19
  int v87; // [sp+98h] [bp-C8h]@19
  int v88; // [sp+9Ch] [bp-C4h]@19
  int v89; // [sp+A0h] [bp-C0h]@17
  int v90; // [sp+A4h] [bp-BCh]@17
  __int64 v91; // [sp+A8h] [bp-B8h]@17
  __int64 v92; // [sp+B0h] [bp-B0h]@15
  IO80211PeerManager *v93; // [sp+B0h] [bp-B0h]@32
  char v94; // [sp+B8h] [bp-A8h]@6
  __int64 v95; // [sp+C0h] [bp-A0h]@1
  __int64 v96; // [sp+C8h] [bp-98h]@6
  __int64 v97; // [sp+D0h] [bp-90h]@8
  unsigned __int64 v98; // [sp+DCh] [bp-84h]@5
  int v99; // [sp+114h] [bp-4Ch]@26

  v95 = a2;
  v2 = (__int64)this;
  v3 = *(_WORD *)(a2 + 16);
  v4 = *(_QWORD *)(a2 + 24);
  if ( *(_BYTE *)(a2 + 10) && !v4 )
  {
    LODWORD(v5) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
    v6 = OSMetaClass::getClassName(v5);
    v7 = 0;
    IO80211PeerManager::logDebug(
      this,
      "%s::%s Deletion of all services requested (discoveryd crash)\n",
      v6,
      (__int64)"updateLocalRequests",
      v8,
      v9);
    IO80211CommandQueue::lockFlush(*((IO80211CommandQueue **)this + 476));
LABEL_4:
    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 320LL))(v2, 2LL);
    return (unsigned int)v7;
  }
  BYTE3(v98) = 0;
  LOWORD(v98) = 0;
  if ( (unsigned int)v3 > 3 )
  {
    v96 = 0LL;
    v94 = 0;
    v10 = 0LL;
    while ( 1 )
    {
      if ( copyin(v4, (char *)&v98 + 3, 1LL) )
      {
        LODWORD(v60) = (*(int (__fastcall **)(__int64, char *))(*(_QWORD *)v2 + 56LL))(v2, (char *)&v98 + 3);
        v61 = OSMetaClass::getClassName(v60);
        v63 = "%s::%s can't copy type from %llx\n";
LABEL_62:
        IO80211PeerManager::logDebug((IO80211PeerManager *)v2, v63, v61, (__int64)"updateLocalRequests", v4, v62);
        v7 = 22;
        return (unsigned int)v7;
      }
      if ( copyin(v4 + 1, &v98, 2LL) )
      {
        LODWORD(v64) = (*(int (__fastcall **)(__int64, unsigned __int64 *))(*(_QWORD *)v2 + 56LL))(v2, &v98);
        v61 = OSMetaClass::getClassName(v64);
        v63 = "%s::%s can't copy len from %llx\n";
        goto LABEL_62;
      }
      v97 = v10;
      v7 = 22;
      if ( (unsigned __int16)v98 + 3 > v3 )
        return (unsigned int)v7;
      v11 = v2;
      v12 = (__int64)((char *)&v98 + 4);
      if ( BYTE3(v98) != 1 )
      {
        if ( BYTE3(v98) != 2 )
        {
          v2 = v11;
          goto LABEL_45;
        }
        ++*(_WORD *)(v11 + 8136);
      }
      v13 = OSObject::operator new((OSObject *)stru_68.segname, (unsigned __int64)&v98);
      IO80211ServiceRequestDescriptor::IO80211ServiceRequestDescriptor(v13);
      v14 = (char *)&v98 + 4;
      IO80211PeerManager::initUserPrintContext((IO80211PeerManager *)v11, (__int64)((char *)&v98 + 4), 0LL, 0);
      if ( !v13
        || (v14 = (char *)v4, !IO80211ServiceRequestDescriptor::initWithUserAddress(
                                 v13,
                                 v4,
                                 (__int64)((char *)&v98 + 4))) )
      {
        v2 = v11;
        LODWORD(v22) = (*(int (__fastcall **)(__int64, char *))(*(_QWORD *)v11 + 56LL))(v11, v14);
        v23 = OSMetaClass::getClassName(v22);
        v24 = (__int64)"add";
        if ( *(_BYTE *)(v95 + 10) )
          v24 = (__int64)"delete";
        v25 = v13 == 0;
        v26 = v13;
        v27 = (__int64)"Tlv Error";
        if ( !v13 )
          v27 = (__int64)"No Memory";
        v81 = v27;
        LODWORD(v80) = BYTE3(v98);
        v28 = 1;
        if ( v25 )
          v28 = v94;
        IO80211PeerManager::logDebug(
          (IO80211PeerManager *)v2,
          "%s::%s can't allocate service descriptor for %s len %u type %u %s\n",
          v23,
          (__int64)"updateLocalRequests",
          v24,
          (unsigned int)(unsigned __int16)v98 + 3);
        v99 = 1;
        IO80211CommandQueue::print(*(_QWORD *)(v2 + 3808), (__int64)((char *)&v98 + 4));
        v94 = v28;
        v96 = v26;
        goto LABEL_45;
      }
      v96 = v13;
      v15 = v11;
      if ( IO80211PeerManager::shouldLog((IO80211PeerManager *)v11, 0x100000LL) )
      {
        LODWORD(v16) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v11 + 56LL))(v11, 0x100000LL);
        v92 = OSMetaClass::getClassName(v16);
        v17 = (__int64)"srv";
        if ( *(_DWORD *)(v11 + 1488) == 1 )
          v17 = (__int64)"SRV";
        v91 = v17;
        v90 = *(_DWORD *)(*(_QWORD *)(v11 + 3808) + 52LL);
        v89 = *(_WORD *)(v95 + 16);
        v18 = (__int64)" ADD  ";
        if ( *(_BYTE *)(v95 + 10) )
          v18 = (__int64)"DELETE";
        v88 = *(_DWORD *)(v15 + 7396);
        v87 = *(_BYTE *)(v15 + 652);
        v86 = *(_DWORD *)(v15 + 104);
        v19 = *(_DWORD *)(v15 + 7540);
        v20 = *(_BYTE *)(v96 + 12);
        v21 = (unsigned __int8)IO80211ServiceRequestDescriptor::recordType((IO80211ServiceRequestDescriptor *)v96);
        v29 = *(_BYTE *)(v96 + 73);
        if ( v29 <= 0x12 )
          v30 = off_7D230[v29];
        v31 = *(_QWORD *)(v96 + 48);
        LODWORD(v85) = v86;
        LODWORD(v84) = v87;
        LODWORD(v83) = v88;
        v82 = v18;
        LODWORD(v81) = v89;
        LODWORD(v80) = v90;
        IO80211PeerManager::logDebug(
          (IO80211PeerManager *)v15,
          0x100000LL,
          "%s::%s %s local num=%u len=%u %s flags %x ifstate %u infraChannel %u  mdns %u hash 0x%02x %s %s srv=%p key %p\n",
          v92,
          (__int64)"updateLocalRequests",
          v91);
        v12 = (__int64)((char *)&v98 + 4);
        if ( IO80211PeerManager::shouldLog((IO80211PeerManager *)v15, 0x100000LL) )
          IO80211PeerManager::logUserPrint((IO80211PeerManager *)v15, 0x100000LL, (IO80211QueueDescriptor *)v96, 0, 0LL);
      }
      v93 = (IO80211PeerManager *)v15;
      if ( *(_DWORD *)(v15 + 4036) )
      {
        v32 = strlen("ip6");
        if ( (signed int)IO80211ServiceRequestDescriptor::hasString((IO80211ServiceRequestDescriptor *)v96, "ip6", v32) >= 0 )
        {
          v33 = strlen("arpa");
          if ( (signed int)IO80211ServiceRequestDescriptor::hasString(
                             (IO80211ServiceRequestDescriptor *)v96,
                             "arpa",
                             v33) >= 0 )
          {
            v2 = v15;
            v34 = *(_QWORD *)(v15 + 3864);
            if ( *(_BYTE *)(v95 + 10) )
            {
              v94 = 1;
              v10 = v97;
              if ( v34 )
              {
                (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v34 + 288LL))(v34, "arpa");
                (*(void (__cdecl **)(_QWORD, _QWORD, __int64, __int64, __int64, __int64, __int64, __int64, __int64, __int64, __int64, __int64))(**((_QWORD **)v93 + 483) + 40LL))(
                  *((_QWORD *)v93 + 483),
                  "arpa",
                  v35,
                  v36,
                  v37,
                  v38,
                  v80,
                  v81,
                  v82,
                  v83,
                  v84,
                  v85);
                *((_QWORD *)v93 + 483) = 0LL;
              }
            }
            else
            {
              v10 = v97;
              if ( v34 )
              {
                (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v34 + 288LL))(v34, "arpa");
                (*(void (__cdecl **)(_QWORD, _QWORD, __int64, __int64, __int64, __int64, __int64, __int64, __int64, __int64, __int64, __int64))(**((_QWORD **)v93 + 483) + 40LL))(
                  *((_QWORD *)v93 + 483),
                  "arpa",
                  v46,
                  v47,
                  v48,
                  v49,
                  v80,
                  v81,
                  v82,
                  v83,
                  v84,
                  v85);
              }
              *((_QWORD *)v93 + 483) = v96;
            }
            goto LABEL_46;
          }
        }
      }
      if ( *(_BYTE *)(v95 + 10) )
      {
        v2 = v15;
        IO80211CommandQueue::lockMap(
          *(IO80211CommandQueue **)(v15 + 3808),
          (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_serviceFindAndRemove,
          v15,
          v96,
          0LL,
          -1);
        goto LABEL_40;
      }
      v39 = strlen("airplay");
      v40 = v96;
      if ( (signed int)IO80211ServiceRequestDescriptor::hasString(
                         (IO80211ServiceRequestDescriptor *)v96,
                         "airplay",
                         v39) >= 0
        || (v41 = strlen("raop"),
            (signed int)IO80211ServiceRequestDescriptor::hasString((IO80211ServiceRequestDescriptor *)v96, "raop", v41) >= 0) )
      {
        if ( *((_DWORD *)v93 + 908) )
        {
          IO80211PeerManager::logUserPrint(v93, 0x100000LL, (IO80211QueueDescriptor *)v96, 0, 0LL);
          LODWORD(v42) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)v93 + 56LL))(
                           v93,
                           0x100000LL);
          v43 = OSMetaClass::getClassName(v42);
          IO80211PeerManager::logDebug(
            v93,
            0x100000LL,
            "%s::%s(): Discarding Airplay registration (_discard_airplay_records = 1)\n",
            v43,
            (__int64)"updateLocalRequests",
            v44);
          v94 = 1;
          v2 = (__int64)v93;
          goto LABEL_45;
        }
        v40 = v96;
        if ( !*((_BYTE *)v93 + 7441) )
        {
          if ( *((_BYTE *)v93 + 3636) )
          {
            v2 = (__int64)v93;
            IO80211PeerManager::logUserPrint(v93, 0x100000LL, (IO80211QueueDescriptor *)v96, 0, 0LL);
            LODWORD(v50) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 56LL))(v2, 0x100000LL);
            v51 = OSMetaClass::getClassName(v50);
            IO80211PeerManager::logDebug(
              v93,
              0x100000LL,
              "%s::%s(): Discarding Airplay registration, legacy device on DFS infra channel\n",
              v51,
              (__int64)"updateLocalRequests",
              v52);
LABEL_40:
            v94 = 1;
LABEL_45:
            v10 = v97;
            goto LABEL_46;
          }
        }
      }
      v53 = getAbsoluteTime();
      *(_QWORD *)(v40 + 88) = v53;
      *((_QWORD *)v93 + 487) = v53;
      v54 = IO80211PeerManager::shouldLog(v93, 0x100000LL);
      v55 = 0LL;
      if ( v54 )
      {
        IO80211PeerManager::initUserPrintContext(v93, v12, 0LL, 0);
        v99 = IO80211PeerManager::shouldVerboseLog(v93, 0x100000LL);
        v55 = v12;
      }
      v56 = IO80211CommandQueue::lockInsert(
              *((IO80211CommandQueue **)v93 + 476),
              (__int64)_compareServiceKeys,
              v40,
              v55,
              2u,
              0LL);
      v57 = v40;
      v10 = v56;
      v2 = (__int64)v93;
      if ( (v56 & 0x80000000) != 0 )
      {
        (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(__int64, __int64, __int64)))(*(_QWORD *)v57 + 288LL))(
          v57,
          _compareServiceKeys);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v57 + 40LL))(v57);
        LODWORD(v77) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)v93 + 56LL))(v93);
        v78 = OSMetaClass::getClassName(v77);
        IO80211PeerManager::logDebug(
          v93,
          0x100000LL,
          "%s::%s not inserting service ret=%d\n",
          v78,
          (__int64)"updateLocalRequests",
          (unsigned int)v10);
        v7 = 22;
        if ( (_DWORD)v10 == -1 )
          v7 = 12;
        return (unsigned int)v7;
      }
      LODWORD(v58) = (*(int (__fastcall **)(IO80211PeerManager *, __int64 (__fastcall *)(__int64, __int64, __int64)))(*(_QWORD *)v93 + 56LL))(
                       v93,
                       _compareServiceKeys);
      v59 = OSMetaClass::getClassName(v58);
      v96 = v57;
      LODWORD(v80) = *(_BYTE *)(v57 + 12);
      IO80211PeerManager::logDebug(
        v93,
        0x100000LL,
        "%s::%s inserted service ret=%d h=0x%02x\n",
        v59,
        (__int64)"updateLocalRequests",
        (unsigned int)v10);
LABEL_46:
      v45 = (unsigned int)(unsigned __int16)v98 + 3;
      v3 -= v45;
      v4 += v45;
      if ( v3 <= 3 )
      {
        v65 = v96;
        v7 = v10;
        goto LABEL_63;
      }
    }
  }
  v65 = 0LL;
  v94 = 0;
  v7 = 0;
LABEL_63:
  IO80211AWDLPeerManager::updateSSTH((IO80211AWDLPeerManager *)v2);
  IO80211PeerManager::lockDataPath((IO80211PeerManager *)v2);
  IO80211CommandQueue::map(
    *(_QWORD *)(v2 + 88),
    (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_remakeBrowseList,
    v2,
    0LL,
    0LL,
    -1);
  IO80211PeerManager::unlockDataPath((IO80211PeerManager *)v2, (__int64)_remakeBrowseList);
  if ( *(_DWORD *)(v2 + 7540)
    && v65
    && (unsigned __int8)IO80211ServiceRequestDescriptor::recordType((IO80211ServiceRequestDescriptor *)v65) == 12 )
  {
    LODWORD(v66) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v2 + 56LL))(v2);
    v67 = OSMetaClass::getClassName(v66);
    v68 = (__int64)"Added";
    if ( *(_BYTE *)(v95 + 10) )
      v68 = (__int64)"Deleted";
    *(_BYTE *)(v65 + 73);
    IO80211PeerManager::logDebug(
      (IO80211PeerManager *)v2,
      0x2000000000LL,
      "%s::%s %s %s Service\n",
      v67,
      (__int64)"updateLocalRequests",
      v68);
    *(_BYTE *)(v2 + 96) = 0;
    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 320LL))(v2, 2LL);
  }
  if ( v94 & 1 && v65 )
  {
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v65 + 288LL))(v65);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v65 + 40LL))(v65);
  }
  *(_QWORD *)(v2 + 3912) = getAbsoluteTime();
  if ( !(*(_BYTE *)(v2 + 7396) & 1) )
  {
    LODWORD(v69) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v2 + 56LL))(v2);
    v70 = OSMetaClass::getClassName(v69);
    IO80211PeerManager::logDebug(
      (IO80211PeerManager *)v2,
      "%s::%s _stateFlags Received service request but not configured (0x%x)! bailing..\n",
      v70,
      (__int64)"updateLocalRequests",
      *(_DWORD *)(v2 + 7396),
      v71);
  }
  IO80211AWDLPeerManager::updateSyncFrameTemplate((IO80211AWDLPeerManager *)v2);
  IO80211AWDLPeerManager::updateAndSendMI((IO80211AWDLPeerManager *)v2, 0);
  LODWORD(v72) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v2 + 56LL))(v2, 0LL);
  v73 = OSMetaClass::getClassName(v72);
  *(_BYTE *)(v2 + 96);
  IO80211PeerManager::logDebug(
    (IO80211PeerManager *)v2,
    0x2000000000LL,
    "%s::%s updateLocalRequests with size %u%s\n",
    v73,
    (__int64)"updateLocalRequests",
    *(_DWORD *)(*(_QWORD *)(v2 + 3808) + 52LL));
  v74 = *(_QWORD *)(v2 + 3808);
  if ( *(_DWORD *)(v74 + 52) && !(*(_BYTE *)(v2 + 7396) & 2) && !*(_BYTE *)(v95 + 10) )
  {
    if ( *(_DWORD *)(v74 + 52) == 1 )
    {
      LODWORD(v75) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 56LL))(v2, 0x2000000000LL);
      v76 = OSMetaClass::getClassName(v75);
      IO80211PeerManager::logDebug(
        (IO80211PeerManager *)v2,
        0x2000000000LL,
        "%s::%s _serviceRequests size %u -> clear channel config\n",
        v76,
        (__int64)"updateLocalRequests",
        *(_DWORD *)(*(_QWORD *)(v2 + 3808) + 52LL));
      *(_BYTE *)(v2 + 96) = 0;
    }
    goto LABEL_4;
  }
  return (unsigned int)v7;
}
// 68: using guessed type section_64 stru_68;
// 7D230: using guessed type char *off_7D230[19];
// C8A40: using guessed type int __fastcall copyin(_QWORD, _QWORD, _QWORD);

//----- (000000000003BEFB) ----------------------------------------------------
signed __int64 __fastcall _serviceFindAndRemove(__int64 a1, IO80211ServiceRequestDescriptor *a2, IO80211ServiceRequestDescriptor *a3)
{
  bool v3; // zf@1
  signed __int64 result; // rax@1

  v3 = (unsigned int)IO80211ServiceRequestDescriptor::compare(a2, a3) == 0;
  result = 15LL;
  if ( !v3 )
    result = 0LL;
  return result;
}

//----- (000000000003BF18) ----------------------------------------------------
__int64 __fastcall _remakeBrowseList(__int64 a1, IO80211AWDLPeer *a2)
{
  IO80211AWDLPeer::makeBrowseList(a2);
  return 0LL;
}

//----- (000000000003BF28) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlPeerServiceRequest(IO80211AWDLPeerManager *this, __int64 a2)
{
  __int64 result; // rax@4

  if ( __PAIR__(*(_BYTE *)(a2 + 5), *(_BYTE *)(a2 + 4))
    || __PAIR__(*(_BYTE *)(a2 + 7), *(_BYTE *)(a2 + 6))
    || __PAIR__(*(_BYTE *)(a2 + 9), *(_BYTE *)(a2 + 8)) )
    result = 22LL;
  else
    result = IO80211AWDLPeerManager::updateLocalRequests(this, a2);
  return result;
}

//----- (000000000003BF5E) ----------------------------------------------------
signed __int64 IO80211AWDLPeerManager::getAwdlPeerServiceRequest()
{
  return 22LL;
}

//----- (000000000003BF6A) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlMaxPeers(IO80211PeerManager *this, void *a2)
{
  signed int v2; // er14@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  __int64 v5; // r9@2

  v2 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x82u, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    2150132168LL);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't set peer cache size, ret=%d\n",
      v4,
      (__int64)"setAwdlMaxPeers",
      (unsigned int)v2,
      v5);
  }
  else
  {
    *((_DWORD *)this + 40) = *((_DWORD *)a2 + 1);
  }
  return (unsigned int)v2;
}

//----- (000000000003BFDE) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlMaxTreeDepth(IO80211PeerManager *this, void *a2)
{
  signed int v2; // er14@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  __int64 v5; // r9@2

  v2 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x7Bu, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    2150132168LL);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't set election id ret=%d\n",
      v4,
      (__int64)"setAwdlMaxTreeDepth",
      (unsigned int)v2,
      v5);
  }
  else
  {
    *((_DWORD *)this + 931) = *((_DWORD *)a2 + 1);
  }
  return (unsigned int)v2;
}

//----- (000000000003C052) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlPrivateElectionId(IO80211PeerManager *this, void *a2)
{
  int v2; // eax@1
  unsigned int v3; // ecx@1
  signed int v4; // er14@3
  OSMetaClass *v5; // rax@4
  __int64 v6; // rax@4
  __int64 v7; // r9@4
  OSMetaClass *v8; // rax@6
  __int64 v9; // rax@6

  v2 = *((_DWORD *)a2 + 2);
  v3 = *((_DWORD *)this + 930) | 1;
  if ( !v2 )
    v3 = *((_DWORD *)this + 930) & 0xFFFFFFFE;
  *((_DWORD *)this + 930) = v3;
  *((_BYTE *)a2 + 4) = v3;
  *((_DWORD *)this + 934) = v2;
  v4 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0xD4u, a2);
  if ( v4 )
  {
    LODWORD(v5) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    2150132168LL);
    v6 = OSMetaClass::getClassName(v5);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s error can't set private election id ret=%d\n",
      v6,
      (__int64)"setAwdlPrivateElectionId",
      (unsigned int)v4,
      v7);
  }
  else
  {
    *((_DWORD *)this + 934) = *((_DWORD *)a2 + 2);
    if ( IO80211PeerManager::shouldLog(this, 32LL) )
    {
      LODWORD(v8) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, 32LL);
      v9 = OSMetaClass::getClassName(v8);
      IO80211PeerManager::logDebug(
        this,
        32LL,
        "%s::%s electionId %x\n",
        v9,
        (__int64)"setAwdlPrivateElectionId",
        *((_DWORD *)a2 + 2));
    }
  }
  return (unsigned int)v4;
}

//----- (000000000003C132) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlForcedRoamConfig(IO80211AWDLPeerManager *a1, ether_addr *a2)
{
  IO80211AWDLPeerManager::forceRoamToPeersAP(a1, a2);
  return 0LL;
}

//----- (000000000003C142) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlGuardTime(__int64 a1, __int64 a2)
{
  *(_DWORD *)(a1 + 3640) = *(_DWORD *)(a2 + 4);
  return 0LL;
}

//----- (000000000003C154) ----------------------------------------------------
__int64 __usercall IO80211AWDLPeerManager::setAwdlBssid@<rax>(IO80211PeerManager *this@<rdi>, void *a2@<rsi>, __int64 a3@<rax>)
{
  signed int v3; // ebx@5
  OSMetaClass *v4; // rax@6
  __int64 v5; // rax@6
  __int64 v6; // r9@6
  __int64 v8; // [sp+0h] [bp-20h]@1

  v8 = a3;
  WORD2(v8) = 0;
  LODWORD(v8) = 0;
  if ( !memcmp(&v8, (char *)a2 + 4, 6uLL) )
    memcpy((char *)this + 3668, (char *)a2 + 4, 6uLL);
  if ( !memcmp(&v8, (char *)a2 + 10, 6uLL) )
    memcpy((char *)this + 3674, (char *)a2 + 10, 6uLL);
  v3 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x7Du, a2);
  if ( v3 )
  {
    LODWORD(v4) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    2150132168LL);
    v5 = OSMetaClass::getClassName(v4);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't set AWDL BSSID ret=%d\n",
      v5,
      (__int64)"setAwdlBssid",
      (unsigned int)v3,
      v6);
  }
  return (unsigned int)v3;
}

//----- (000000000003C222) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlScanReservedTime(__int64 a1, __int64 a2)
{
  *(_DWORD *)(a1 + 3604) = *(_DWORD *)(a2 + 4);
  return 0LL;
}

//----- (000000000003C234) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlElectionParams(IO80211PeerManager *this, void *a2)
{
  signed int v2; // er14@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // r15@2
  __int64 v5; // rax@2
  __int64 v6; // rax@2
  OSMetaClass *v7; // rax@4
  __int64 v8; // rax@4

  v2 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x9Bu, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    2150132168LL);
    v4 = OSMetaClass::getClassName(v3);
    v5 = IO80211PeerManager::getController(this);
    LODWORD(v6) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v5 + 1920LL))(v5, (unsigned int)v2);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't set AWDL PARAMS ret=%d %s\n",
      v4,
      (__int64)"setAwdlElectionParams",
      (unsigned int)v2,
      v6);
  }
  else if ( IO80211PeerManager::shouldLog(this, 32LL) )
  {
    LODWORD(v7) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, 32LL);
    v8 = OSMetaClass::getClassName(v7);
    IO80211PeerManager::logDebug(
      this,
      32LL,
      "%s::%s param->self_metric = %x\n",
      v8,
      (__int64)"setAwdlElectionParams",
      *((_DWORD *)a2 + 8));
  }
  return (unsigned int)v2;
}

//----- (000000000003C300) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlAvailabilityWindowApAlignment(IO80211PeerManager *this, void *a2)
{
  int v2; // eax@1
  OSMetaClass *v3; // rax@4
  __int64 v4; // rax@4
  __int64 v5; // r9@4
  signed int v6; // er15@4
  OSMetaClass *v7; // rax@8
  __int64 v8; // rax@8
  __int64 v9; // r9@8

  v2 = *((_DWORD *)a2 + 2);
  if ( v2 == -1 )
  {
    v2 = *((_DWORD *)this + 915);
    *((_DWORD *)a2 + 2) = v2;
  }
  if ( (unsigned int)(v2 + 500) < 0x3E9 )
  {
    if ( *((_DWORD *)a2 + 1) == -1 )
      *((_DWORD *)a2 + 1) = *((_DWORD *)this + 916);
    v6 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x7Fu, a2);
    if ( v6 )
    {
      LODWORD(v7) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                      this,
                      2150132168LL);
      v8 = OSMetaClass::getClassName(v7);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s can't set AWDL AP beacon alignement ret=%d\n",
        v8,
        (__int64)"setAwdlAvailabilityWindowApAlignment",
        (unsigned int)v6,
        v9);
    }
    else
    {
      *((_DWORD *)this + 916) = *((_DWORD *)a2 + 1);
      *((_DWORD *)this + 915) = *((_DWORD *)a2 + 2);
      v6 = 0;
    }
  }
  else
  {
    LODWORD(v3) = (*(int (__cdecl **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s invalid parameter offset %d\n",
      v4,
      (__int64)"setAwdlAvailabilityWindowApAlignment",
      *((_DWORD *)a2 + 2),
      v5);
    v6 = 22;
  }
  return (unsigned int)v6;
}

//----- (000000000003C3EA) ----------------------------------------------------
signed __int64 IO80211AWDLPeerManager::setAwdlSyncFrameApAlignment()
{
  return 45LL;
}

//----- (000000000003C3F6) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::printAwdlChannelSequence(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  unsigned int v6; // ebx@1
  __int64 v7; // rdx@1
  __int64 v8; // rcx@1
  __int64 v9; // r8@1
  __int64 v10; // r9@1
  char v11; // ST00_1@1
  __int64 v12; // rdx@1
  __int64 v13; // rcx@1
  __int64 v14; // r8@1
  __int64 v15; // r9@1
  __int64 v16; // rdx@3
  __int64 v17; // rcx@3
  __int64 v18; // r8@3
  __int64 v19; // r9@3
  char v20; // ST00_1@3
  char v22; // [sp+0h] [bp-20h]@0
  char v23; // [sp+0h] [bp-20h]@1

  v6 = 0;
  _userPrint(
    a2,
    "          CH length=%u stepcount=%u encoding=%u : ",
    *(_BYTE *)(a1 + 7584),
    *(_BYTE *)(a1 + 7605),
    *(_BYTE *)(a1 + 7604),
    a6,
    v22);
  _userPrint(a2, "[", v7, v8, v9, v10, v11);
  if ( *(_BYTE *)(a1 + 7584) )
  {
    do
      _userPrint(a2, "%u ", *(_BYTE *)(a1 + v6++ + 7606), v13, v14, v15, v23);
    while ( v6 < *(_BYTE *)(a1 + 7584) );
  }
  _userPrint(a2, "]", v12, v13, v14, v15, v23);
  _userPrint(a2, "\n", v16, v17, v18, v19, v20);
  return 0LL;
}

//----- (000000000003C4AC) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::printAwdlTimingStats(__int64 a1, __int64 a2)
{
  int v2; // ST08_4@1

  v2 = *(_DWORD *)(a1 + 7468);
  _userPrint(
    a2,
    "          Timing Stats: ts_length_error(%u), backtoback_start(%u), incorrect_channel(%u), inter_ts_error(%d), seq_num_error(%u), skipped_aw(%u)\n",
    *(_DWORD *)(a1 + 7448),
    *(_DWORD *)(a1 + 7452),
    *(_DWORD *)(a1 + 7456),
    *(_DWORD *)(a1 + 7460),
    *(_DWORD *)(a1 + 7464));
  memset((void *)(a1 + 7448), 0, 0x18uLL);
  return 0LL;
}

//----- (000000000003C51A) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlChannelSequence(IO80211PeerManager *this, void *a2)
{
  OSMetaClass *v2; // rax@2
  __int64 v3; // rax@2
  __int64 v4; // r9@2
  signed int v5; // er15@2
  OSMetaClass *v6; // rax@4
  __int64 v7; // rax@4
  int v8; // ST18_4@4
  int v9; // ST10_4@4
  int v10; // ST08_4@4
  int v11; // ST00_4@4
  __int64 v12; // rcx@4
  __int64 v13; // r8@4
  __int64 v14; // r9@4
  char v15; // al@4
  __int64 *v16; // rbx@6
  signed int v17; // er15@6
  int v18; // eax@7
  __int64 v19; // r9@7
  __int64 *v20; // r13@13
  signed int v21; // ebx@13
  OSMetaClass *v22; // rax@17
  __int64 v23; // rax@17
  __int64 v24; // r9@17
  __int16 v25; // ax@18
  __int16 v26; // cx@18
  __int16 v27; // dx@18
  char *v28; // r12@19
  __int64 v29; // rax@19

  if ( (unsigned __int8)(*((_BYTE *)a2 + 5) - 1) < 0x20u )
  {
    if ( IO80211PeerManager::shouldLog(this, 32LL) )
    {
      LODWORD(v6) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, 32LL);
      v7 = OSMetaClass::getClassName(v6);
      v8 = *((_BYTE *)a2 + 6);
      v9 = *((_BYTE *)a2 + 9);
      v10 = *((_BYTE *)a2 + 8);
      v11 = *((_BYTE *)a2 + 7);
      IO80211PeerManager::logDebug(
        this,
        32LL,
        "%s::%s length %u step count %u duplicate %u fill %d encoding %u : ",
        v7,
        (__int64)"setAwdlChannelSequence",
        *((_BYTE *)a2 + 5));
      v15 = *((_BYTE *)a2 + 5);
      if ( *((_BYTE *)a2 + 6) )
      {
        if ( v15 )
        {
          v16 = (__int64 *)((char *)a2 + 16);
          v17 = 0;
          do
          {
            v18 = *(_DWORD *)v16 & 0xC00;
            v19 = (__int64)",40MHz";
            if ( v18 != 3072 )
            {
              v19 = (__int64)",unknown";
              if ( v18 == 2048 )
                v19 = (__int64)",20MHz";
            }
            IO80211PeerManager::logDebug(
              this,
              32LL,
              " 0x%04x=%d%s%s%s",
              *(_DWORD *)v16,
              (unsigned __int8)*(_DWORD *)v16,
              v19);
            v16 = (__int64 *)((char *)v16 + 12);
            ++v17;
          }
          while ( v17 < *((_BYTE *)a2 + 5) );
        }
      }
      else if ( v15 )
      {
        v20 = (__int64 *)((char *)a2 + 16);
        v21 = 0;
        do
        {
          IO80211PeerManager::logDebug(this, 32LL, " %d ", *(_DWORD *)v20, v13, v14);
          v20 = (__int64 *)((char *)v20 + 12);
          ++v21;
        }
        while ( v21 < *((_BYTE *)a2 + 5) );
      }
      IO80211PeerManager::logDebug(this, 32LL, "\n", v12, v13, v14);
    }
    v5 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x81u, a2);
    if ( v5 )
    {
      LODWORD(v22) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       2150132168LL);
      v23 = OSMetaClass::getClassName(v22);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s can't set AWDL channel sequence ret=%d \n",
        v23,
        (__int64)"setAwdlChannelSequence",
        (unsigned int)v5,
        v24);
    }
    else
    {
      *((_DWORD *)this + 259) = 3;
      *((_BYTE *)this + 7604) = *((_BYTE *)a2 + 6);
      v25 = *((_BYTE *)a2 + 5);
      *((_BYTE *)this + 7584) = v25;
      v26 = *((_BYTE *)a2 + 7);
      *((_BYTE *)this + 7605) = v26;
      v27 = *((_BYTE *)a2 + 8);
      *((_BYTE *)this + 7600) = v27;
      *((_WORD *)this + 3801) = (v26 + 1) * v25 * (v27 + 1);
      if ( v25 )
      {
        v28 = (char *)a2 + 16;
        v29 = 0LL;
        do
        {
          *((_BYTE *)this + v29++ + 7606) = *v28;
          v28 += 12;
        }
        while ( (signed int)v29 < *((_BYTE *)this + 7584) );
      }
    }
    *((_QWORD *)this + 486) = getAbsoluteTime();
  }
  else
  {
    LODWORD(v2) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
    v3 = OSMetaClass::getClassName(v2);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s AWDL channel sequence length invalid %u (max = 32)\n",
      v3,
      (__int64)"setAwdlChannelSequence",
      *((_BYTE *)a2 + 5),
      v4);
    v5 = 22;
  }
  return (unsigned int)v5;
}

//----- (000000000003C7FE) ----------------------------------------------------
__int64 IO80211AWDLPeerManager::setAwdlOOBRequest()
{
  return 0LL;
}

//----- (000000000003C806) ----------------------------------------------------
__int64 IO80211AWDLPeerManager::setAwdlSyncFrameTemplate()
{
  return 0LL;
}

//----- (000000000003C80E) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlOUI(IO80211PeerManager *this, void *a2)
{
  signed int v2; // er14@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  __int64 v5; // r9@2

  v2 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x83u, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    2150132168LL);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't set AWDL OUI ret=%d\n",
      v4,
      (__int64)"setAwdlOUI",
      (unsigned int)v2,
      v5);
  }
  else
  {
    *((_BYTE *)this + 3776) = *((_BYTE *)a2 + 4);
    *((_BYTE *)this + 3777) = *((_BYTE *)a2 + 5);
    *((_BYTE *)this + 3778) = *((_BYTE *)a2 + 6);
  }
  return (unsigned int)v2;
}

//----- (000000000003C896) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlSecondaryMasterChannel(IO80211PeerManager *this, void *a2)
{
  OSMetaClass *v2; // rax@1
  __int64 v3; // rax@1
  signed int v4; // er14@1
  int v5; // eax@1
  signed int v6; // er12@2
  OSMetaClass *v7; // rax@3
  __int64 v8; // rax@3
  int v9; // eax@7
  OSMetaClass *v10; // rax@8
  __int64 v11; // rax@8
  __int64 v12; // r9@8

  LODWORD(v2) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
  v3 = OSMetaClass::getClassName(v2);
  v4 = 0;
  IO80211PeerManager::logDebug(
    this,
    0x2000000000LL,
    "%s::%s will set AWDL secondary master channel=%u ret=%d\n",
    v3,
    (__int64)"setAwdlSecondaryMasterChannel",
    *((_DWORD *)a2 + 1));
  v5 = *((_DWORD *)this + 1017);
  if ( v5 == 1 )
  {
    v6 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0xCDu, a2);
    if ( v6 )
    {
      LODWORD(v7) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                      this,
                      2150132168LL);
      v8 = OSMetaClass::getClassName(v7);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s can't set AWDL secondary master channel=%u ret=%d\n",
        v8,
        (__int64)"setAwdlSecondaryMasterChannel",
        *((_DWORD *)a2 + 1),
        (unsigned int)v6);
      v4 = v6;
    }
    else
    {
      v9 = *((_DWORD *)a2 + 1);
      *((_DWORD *)this + 381) = v9;
      *((_BYTE *)this + 1533) = v9;
    }
  }
  else if ( !v5 )
  {
    *((_BYTE *)this + 96) = 0;
    *((_DWORD *)this + 381) = *((_DWORD *)a2 + 1);
    if ( *((_BYTE *)this + 7396) & 2 )
    {
      (*(void (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 320LL))(this, 11LL);
    }
    else
    {
      LODWORD(v10) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       0x2000000000LL);
      v11 = OSMetaClass::getClassName(v10);
      v4 = 0;
      IO80211PeerManager::logDebug(
        this,
        "%s:%s Not in Sync state, current state = 0x%x\n",
        v11,
        (__int64)"setAwdlSecondaryMasterChannel",
        *((_DWORD *)this + 1849),
        v12);
    }
  }
  return (unsigned int)v4;
}

//----- (000000000003C9D2) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlMasterChannel(IO80211PeerManager *this, void *a2)
{
  int v2; // eax@1
  signed int v3; // er14@1
  signed int v4; // er12@2
  OSMetaClass *v5; // rax@3
  __int64 v6; // rax@3
  int v7; // eax@7
  OSMetaClass *v8; // rax@8
  __int64 v9; // rax@8
  __int64 v10; // r9@8

  v2 = *((_DWORD *)this + 1017);
  v3 = 0;
  if ( v2 == 1 )
  {
    v4 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x84u, a2);
    if ( v4 )
    {
      LODWORD(v5) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                      this,
                      2150132168LL);
      v6 = OSMetaClass::getClassName(v5);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s can't set AWDL master channel=%u ret=%d\n",
        v6,
        (__int64)"setAwdlMasterChannel",
        *((_DWORD *)a2 + 1),
        (unsigned int)v4);
      v3 = v4;
    }
    else
    {
      v7 = *((_DWORD *)a2 + 1);
      *((_DWORD *)this + 380) = v7;
      *((_BYTE *)this + 1532) = v7;
    }
  }
  else if ( !v2 )
  {
    *((_BYTE *)this + 96) = 0;
    *((_DWORD *)this + 380) = *((_DWORD *)a2 + 1);
    if ( *((_BYTE *)this + 7396) & 2 )
    {
      (*(void (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 320LL))(this, 10LL);
    }
    else
    {
      LODWORD(v8) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
      v9 = OSMetaClass::getClassName(v8);
      v3 = 0;
      IO80211PeerManager::logDebug(
        this,
        "%s:%s Not in Sync state, current state = 0x%x\n",
        v9,
        (__int64)"setAwdlMasterChannel",
        *((_DWORD *)this + 1849),
        v10);
    }
  }
  return (unsigned int)v3;
}

//----- (000000000003CAC8) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlKey(IO80211PeerManager *this, void *a2)
{
  signed int v2; // er15@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  int v5; // ST18_4@2
  int v6; // ST10_4@2
  int v7; // ST08_4@2
  int v8; // ST00_4@2

  v2 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0xDBu, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    2150132168LL);
    v4 = OSMetaClass::getClassName(v3);
    v5 = *((_BYTE *)a2 + 97);
    v6 = *((_BYTE *)a2 + 96);
    v7 = *((_BYTE *)a2 + 95);
    v8 = *((_BYTE *)a2 + 94);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't set AWDL keys for the peer %02x:%02x:%02x:%02x:%02x:%02x, error = %d\n",
      v4,
      (__int64)"setAwdlKey",
      *((_BYTE *)a2 + 92),
      *((_BYTE *)a2 + 93));
  }
  return (unsigned int)v2;
}

//----- (000000000003CB5E) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlEncryptType(IO80211PeerManager *this, void *a2)
{
  signed int v2; // ebx@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  __int64 v5; // r9@2

  v2 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0xDCu, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    2150132168LL);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't set AWDL encryption type, error = %d\n",
      v4,
      (__int64)"setAwdlEncryptType",
      (unsigned int)v2,
      v5);
  }
  return (unsigned int)v2;
}

//----- (000000000003CBBA) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlEncryptType(IO80211PeerManager *this, void *a2)
{
  signed int v2; // ebx@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  __int64 v5; // r9@2

  v2 = IO80211PeerManager::do_ioctl(this, 0xC02869C9, 0xDCu, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    3223873993LL);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't get AWDL encryption type, error = %d\n",
      v4,
      (__int64)"getAwdlEncryptType",
      (unsigned int)v2,
      v5);
  }
  return (unsigned int)v2;
}

//----- (000000000003CC16) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlStatistics(__int64 a1, void *a2)
{
  __int64 v2; // r15@1
  __int64 v3; // r12@1
  int v4; // eax@1
  int v5; // ecx@1

  v2 = *(_QWORD *)(a1 + 8480);
  v3 = *(_DWORD *)(a1 + 4976);
  *(_QWORD *)(a1 + 16 * v3 + 8296) += (unsigned __int64)((unsigned __int128)(4835703278458516699LL
                                                                           * (getAbsoluteTime() - v2)) >> 64) >> 18;
  v4 = *(_DWORD *)(a1 + 836);
  *(_DWORD *)(a1 + 8264) += *(_DWORD *)(a1 + 836) - *(_DWORD *)(a1 + 8488);
  v5 = *(_DWORD *)(a1 + 832);
  *(_DWORD *)(a1 + 8268) += *(_DWORD *)(a1 + 832) - *(_DWORD *)(a1 + 8492);
  *(_DWORD *)(a1 + 8488) = v4;
  *(_DWORD *)(a1 + 8492) = v5;
  memcpy(a2, (const void *)(a1 + 8256), 0xE0uLL);
  return 0LL;
}

//----- (000000000003CCAE) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::clearAwdlStatistics(__int64 a1)
{
  memset((void *)(a1 + 8256), 0, 0xE0uLL);
  if ( *(_DWORD *)(a1 + 3968) )
    *(_BYTE *)(a1 + 8260) |= 0x10u;
  return 0LL;
}

//----- (000000000003CCE4) ----------------------------------------------------
signed __int64 IO80211AWDLPeerManager::setAwdlTopMaster()
{
  return 45LL;
}

//----- (000000000003CCF0) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlElectionRssiThresholds(IO80211PeerManager *this, void *a2)
{
  signed int v2; // er15@9
  OSMetaClass *v3; // rax@10
  __int64 v4; // rax@10
  int v5; // ST08_4@10
  int v6; // ST00_4@10

  if ( *((_DWORD *)a2 + 1) == -1 )
    *((_DWORD *)a2 + 1) = *((_DWORD *)this + 937);
  if ( *((_DWORD *)a2 + 2) == -1 )
    *((_DWORD *)a2 + 2) = *((_DWORD *)this + 938);
  if ( *((_DWORD *)a2 + 3) == -1 )
    *((_DWORD *)a2 + 3) = *((_DWORD *)this + 939);
  if ( *((_DWORD *)a2 + 4) == -1 )
    *((_DWORD *)a2 + 4) = *((_DWORD *)this + 940);
  v2 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x87u, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    2150132168LL);
    v4 = OSMetaClass::getClassName(v3);
    v5 = *((_DWORD *)a2 + 4);
    v6 = *((_DWORD *)a2 + 3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't set election rssi thresholds to %d %d %d %d ret=%d\n",
      v4,
      (__int64)"setAwdlElectionRssiThresholds",
      *((_DWORD *)a2 + 1),
      *((_DWORD *)a2 + 2));
  }
  else
  {
    *((_DWORD *)this + 940) = *((_DWORD *)a2 + 4);
    *((_DWORD *)this + 939) = *((_DWORD *)a2 + 3);
    *((_DWORD *)this + 938) = *((_DWORD *)a2 + 2);
    *((_DWORD *)this + 937) = *((_DWORD *)a2 + 1);
  }
  return (unsigned int)v2;
}

//----- (000000000003CDDE) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlSyncState(IO80211AWDLPeerManager *this, void *a2)
{
  OSMetaClass *v2; // rax@1
  __int64 v3; // rcx@1
  __int64 v4; // r9@1
  int v5; // ST00_4@3
  signed int v6; // er14@5
  OSMetaClass *v7; // rax@7
  __int64 v8; // rdx@7
  __int64 v9; // r9@7
  const char *v10; // rsi@7
  signed int v11; // er14@8
  OSMetaClass *v12; // rax@9
  __int64 v13; // rax@9
  __int64 v14; // r9@9
  OSMetaClass *v15; // rax@10
  __int64 v16; // rax@10
  OSMetaClass *v17; // rax@12
  __int64 v19; // r13@15
  unsigned int v20; // er15@15
  unsigned int v21; // er12@15
  int v22; // ST00_4@15
  __int64 v23; // [sp+8h] [bp-38h]@6
  int v24; // [sp+10h] [bp-30h]@6

  LODWORD(v2) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
  v3 = OSMetaClass::getClassName(v2);
  v4 = (__int64)"not ";
  if ( *((_DWORD *)this + 1849) & 1 )
    v4 = (__int64)" ";
  v5 = *((_DWORD *)a2 + 1);
  IO80211PeerManager::logDebug(
    this,
    32LL,
    "%s::%s AWDL is %s configured want state %u \n",
    v3,
    (__int64)"setAwdlSyncState",
    v4);
  if ( !*((_DWORD *)a2 + 1) || *((_BYTE *)this + 7396) & 1 || (v6 = IO80211AWDLPeerManager::configure(this)) == 0 )
  {
    *((_BYTE *)this + 7396) &= 0xFDu;
    v24 = 0;
    v23 = 1LL;
    v6 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x75u, &v23);
    if ( v6 )
    {
      LODWORD(v7) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                      this,
                      2150132168LL);
      v8 = OSMetaClass::getClassName(v7);
      v10 = "%s::%s AWDL can't DISABLE sync ret=%d\n";
    }
    else
    {
      *((_BYTE *)this + 7396) &= 0xFBu;
      v11 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x86u, a2);
      if ( v11 )
      {
        LODWORD(v12) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                         this,
                         2150132168LL);
        v13 = OSMetaClass::getClassName(v12);
        IO80211PeerManager::logDebug(
          this,
          "%s::%s can't set sync state ret=%d\n",
          v13,
          (__int64)"setAwdlSyncState",
          (unsigned int)v11,
          v14);
      }
      else
      {
        *((_DWORD *)this + 372) = *((_DWORD *)a2 + 1);
        LODWORD(v15) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                         this,
                         2150132168LL);
        v16 = OSMetaClass::getClassName(v15);
        IO80211PeerManager::logDebug(
          this,
          0x2000000000LL,
          "%s::%s state %u\n",
          v16,
          (__int64)"setAwdlSyncState",
          *((_DWORD *)this + 372));
      }
      v24 = 1;
      v6 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x75u, &v23);
      if ( !v6 )
      {
        *((_DWORD *)this + 1849) = *((_DWORD *)this + 1849) & 0xFFFFFFF9 | 2;
        v6 = 0;
        memset((char *)this + 7448, 0, 0x18uLL);
        v19 = *((_QWORD *)this + 490);
        *((_QWORD *)this + 492) = v19;
        v20 = *((_DWORD *)this + 932);
        v21 = *((_DWORD *)this + 1850);
        v22 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v19)) >> 64) >> 18;
        IO80211PeerManager::logDebug(this, 0x800000LL, "%d: met %x   flags %x _lastTimeSince %u\n", 10674LL, v20, v21);
        return (unsigned int)v6;
      }
      LODWORD(v17) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       2150132168LL);
      v8 = OSMetaClass::getClassName(v17);
      v10 = "%s::%s can't re-enable sync ret=%d\n";
    }
    IO80211PeerManager::logDebug(this, v10, v8, (__int64)"setAwdlSyncState", (unsigned int)v6, v9);
  }
  return (unsigned int)v6;
}

//----- (000000000003D04A) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlPresenceMode(IO80211PeerManager *this, void *a2)
{
  signed int v2; // ebx@1
  OSMetaClass *v3; // rax@3
  __int64 v4; // rax@3

  v2 = 22;
  if ( *((_DWORD *)a2 + 1) <= 0x3Fu )
  {
    v2 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x88u, a2);
    if ( v2 )
    {
      LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                      this,
                      2150132168LL);
      v4 = OSMetaClass::getClassName(v3);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s can't set presence mode to %u ret=%d\n",
        v4,
        (__int64)"setAwdlPresenceMode",
        *((_DWORD *)a2 + 1),
        (unsigned int)v2);
    }
    else
    {
      *((_BYTE *)this + 1512) = *((_BYTE *)a2 + 4);
      v2 = 0;
    }
  }
  return (unsigned int)v2;
}

//----- (000000000003D0D0) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlElectionMasterCounts(IO80211PeerManager *this, void *a2)
{
  signed int v2; // er15@7
  OSMetaClass *v3; // rax@8
  __int64 v4; // rax@8
  int v5; // ST00_4@8

  if ( *((_DWORD *)a2 + 3) == -1 )
    *((_DWORD *)a2 + 3) = *((_DWORD *)this + 926);
  if ( *((_DWORD *)a2 + 2) == -1 )
    *((_DWORD *)a2 + 2) = *((_DWORD *)this + 928);
  if ( *((_DWORD *)a2 + 1) == -1 )
    *((_DWORD *)a2 + 1) = *((_DWORD *)this + 927);
  v2 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x89u, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    2150132168LL);
    v4 = OSMetaClass::getClassName(v3);
    v5 = *((_DWORD *)a2 + 3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't set master counts to %u %u %u ret=%d\n",
      v4,
      (__int64)"setAwdlElectionMasterCounts",
      *((_DWORD *)a2 + 2),
      *((_DWORD *)a2 + 1));
  }
  else
  {
    *((_DWORD *)this + 926) = *((_DWORD *)a2 + 3);
    *((_DWORD *)this + 928) = *((_DWORD *)a2 + 2);
    *((_DWORD *)this + 927) = *((_DWORD *)a2 + 1);
  }
  return (unsigned int)v2;
}

//----- (000000000003D19E) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlSyncFramePacketLifetime(IO80211PeerManager *this, void *a2)
{
  signed int v2; // er14@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2

  v2 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x8Au, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    2150132168LL);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't set sync packet lifetime to %u ret=%d\n",
      v4,
      (__int64)"setAwdlSyncFramePacketLifetime",
      *((_DWORD *)a2 + 1),
      (unsigned int)v2);
  }
  else
  {
    *((_DWORD *)this + 942) = *((_DWORD *)a2 + 1);
  }
  return (unsigned int)v2;
}

//----- (000000000003D216) ----------------------------------------------------
__int64 IO80211AWDLPeerManager::setAwdlMasterSyncFramePeriod()
{
  return 0LL;
}

//----- (000000000003D21E) ----------------------------------------------------
signed int __fastcall IO80211AWDLPeerManager::setAwdlNonElectionMasterSyncFramePeriod(__int64 a1, __int64 a2)
{
  signed int result; // eax@1

  result = IO80211PeerManager::do_ioctl((IO80211PeerManager *)a1, 0x802869C8, 0x8Cu, (void *)a2);
  if ( !result )
    *(_DWORD *)(a1 + 1508) = *(_DWORD *)(a2 + 4);
  return result;
}

//----- (000000000003D250) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlBtCoexProtectedPeriodLength(IO80211PeerManager *this, void *a2)
{
  signed int v2; // er14@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  __int64 v5; // r9@2

  v2 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x91u, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    2150132168LL);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s cannot set BT protected length ret %d\n",
      v4,
      (__int64)"setAwdlBtCoexProtectedPeriodLength",
      (unsigned int)v2,
      v5);
  }
  else
  {
    *((_DWORD *)this + 943) = *((_DWORD *)a2 + 1);
  }
  return (unsigned int)v2;
}

//----- (000000000003D2C4) ----------------------------------------------------
signed int __fastcall IO80211AWDLPeerManager::setAwdlMaxNoMasterPeriods(__int64 a1, __int64 a2)
{
  signed int result; // eax@1

  result = IO80211PeerManager::do_ioctl((IO80211PeerManager *)a1, 0x802869C8, 0x96u, (void *)a2);
  if ( !result )
    *(_BYTE *)(a1 + 3779) = *(_BYTE *)(a2 + 4);
  return result;
}

//----- (000000000003D2F6) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlSuspendedMode(IO80211AWDLPeerManager *this)
{
  OSMetaClass *v1; // rax@1
  __int64 v2; // rax@1
  __int64 v3; // r8@1
  __int64 v4; // r9@1

  LODWORD(v1) = (*(int (__cdecl **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
  v2 = OSMetaClass::getClassName(v1);
  IO80211PeerManager::logDebug(
    this,
    "%s::%s() Suspending AWDL, enterQuietMode(true)\n",
    v2,
    (__int64)"setAwdlSuspendedMode",
    v3,
    v4);
  return IO80211AWDLPeerManager::enterQuietMode(this, 1);
}

//----- (000000000003D33C) ----------------------------------------------------
int __fastcall IO80211AWDLPeerManager::setAwdlAutoMode(IO80211AWDLPeerManager *this)
{
  OSMetaClass *v1; // rax@2
  __int64 v2; // rax@2
  __int64 v3; // r8@2
  __int64 v4; // r9@2

  *((_DWORD *)this + 259) = 1;
  *((_DWORD *)this + 1885) = 1;
  if ( *((_BYTE *)this + 7396) & 0xC )
  {
    LODWORD(v1) = (*(int (__cdecl **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
    v2 = OSMetaClass::getClassName(v1);
    IO80211PeerManager::logDebug(this, "%s::%s Resuming AWDL\n", v2, (__int64)"setAwdlAutoMode", v3, v4);
    IO80211AWDLPeerManager::exitQuietMode(this);
  }
  return (*(int (__fastcall **)(IO80211AWDLPeerManager *, signed __int64))(*(_QWORD *)this + 320LL))(this, 5LL);
}

//----- (000000000003D3B0) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlOperatingMode(__int64 a1, __int64 a2)
{
  *(_DWORD *)(a2 + 4) = *(_DWORD *)(a1 + 4068);
  return 0LL;
}

//----- (000000000003D3C2) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::setAwdlOperatingMode(IO80211AWDLPeerManager *this, __int64 a2)
{
  unsigned __int64 v2; // r14@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  __int64 v5; // r9@2
  signed int v6; // er15@2
  int v7; // er15@3
  OSMetaClass *v8; // rax@3
  __int64 v9; // rdx@3
  __int64 v10; // r9@3

  v2 = *(_DWORD *)(a2 + 4);
  if ( v2 < 3 )
  {
    v7 = *((_DWORD *)this + 1017);
    LODWORD(v8) = (*(int (__cdecl **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
    v9 = OSMetaClass::getClassName(v8);
    if ( v7 == (_DWORD)v2 )
    {
      v6 = 0;
      IO80211PeerManager::logDebug(
        this,
        "%s::%s AWDL operation mode already set to %s, return success\n",
        v9,
        (__int64)"setAwdlOperatingMode",
        (__int64)IO80211AWDLPeerManager::setAwdlOperatingMode(apple80211_awdl_oper_mode *)::awdlOperModeDesc[v2],
        v10);
    }
    else
    {
      v6 = 0;
      IO80211PeerManager::logDebug(
        this,
        "%s::%s Setting the AWDL operation mode from %s to %s\n",
        v9,
        (__int64)"setAwdlOperatingMode",
        (__int64)IO80211AWDLPeerManager::setAwdlOperatingMode(apple80211_awdl_oper_mode *)::awdlOperModeDesc[(unsigned __int64)*((_DWORD *)this + 1017)],
        (__int64)IO80211AWDLPeerManager::setAwdlOperatingMode(apple80211_awdl_oper_mode *)::awdlOperModeDesc[v2]);
      *((_DWORD *)this + 1017) = v2;
      if ( (_DWORD)v2 == 2 )
      {
        IO80211AWDLPeerManager::setAwdlSuspendedMode(this);
      }
      else if ( (_DWORD)v2 == 1 )
      {
        *((_DWORD *)this + 259) = 3;
        *((_DWORD *)this + 1885) = 0;
        *((_DWORD *)this + 996) = 0;
      }
      else if ( !(_DWORD)v2 )
      {
        IO80211AWDLPeerManager::setAwdlAutoMode(this);
      }
    }
  }
  else
  {
    LODWORD(v3) = (*(int (__cdecl **)(IO80211AWDLPeerManager *))(*(_QWORD *)this + 56LL))(this);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s Unrecognized AWDL operation mode %i, return failure\n",
      v4,
      (__int64)"setAwdlOperatingMode",
      (unsigned int)v2,
      v5);
    v6 = 1;
  }
  return (unsigned int)v6;
}
// 7D100: using guessed type char *IO80211AWDLPeerManager::setAwdlOperatingMode(apple80211_awdl_oper_mode *)::awdlOperModeDesc[3];

//----- (000000000003D4E4) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlRestoreDefaults(IO80211AWDLPeerManager *this, unsigned int *a2)
{
  OSMetaClass *v2; // rax@1
  __int64 v3; // rax@1
  __int64 v4; // r8@1
  __int64 v5; // r9@1

  LODWORD(v2) = (*(int (__fastcall **)(IO80211AWDLPeerManager *, unsigned int *))(*(_QWORD *)this + 56LL))(this, a2);
  v3 = OSMetaClass::getClassName(v2);
  IO80211PeerManager::logDebug(
    this,
    "%s::%s Restoring to the default values and re-configuring AWDL ... \n",
    v3,
    (__int64)"getAwdlRestoreDefaults",
    v4,
    v5);
  IO80211AWDLPeerManager::configure(this);
  return 0LL;
}

//----- (000000000003D528) ----------------------------------------------------
signed int __fastcall IO80211AWDLPeerManager::getAwdlExtensionParams(IO80211PeerManager *this, void *a2)
{
  OSMetaClass *v2; // rax@2
  __int64 v3; // rax@2
  __int64 v4; // r9@2
  signed int result; // eax@3

  if ( IO80211PeerManager::shouldLog(this, 32LL) )
  {
    LODWORD(v2) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, 32LL);
    v3 = OSMetaClass::getClassName(v2);
    IO80211PeerManager::logDebug(this, 32LL, "%s::%s \n", v3, (__int64)"getAwdlExtensionParams", v4);
  }
  result = IO80211PeerManager::do_ioctl(this, 0xC02869C9, 0x76u, a2);
  if ( !result )
  {
    *((_BYTE *)this + 1515) = *((_BYTE *)a2 + 8);
    *((_BYTE *)this + 1516) = *((_BYTE *)a2 + 4);
    *((_BYTE *)this + 1517) = *((_BYTE *)a2 + 12);
    *((_BYTE *)this + 1518) = *((_BYTE *)a2 + 16);
    result = 0;
  }
  return result;
}

//----- (000000000003D5BC) ----------------------------------------------------
signed int __fastcall IO80211AWDLPeerManager::getAwdlSyncParams(IO80211PeerManager *this, void *a2)
{
  void *v2; // r14@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  __int64 v5; // r9@2
  signed __int64 v6; // rsi@3
  signed int result; // eax@3
  OSMetaClass *v8; // rax@5
  __int64 v9; // rax@5
  OSMetaClass *v10; // rax@7
  __int64 v11; // rax@7
  OSMetaClass *v12; // rax@9
  __int64 v13; // rax@9
  OSMetaClass *v14; // rax@11
  __int64 v15; // rax@11
  int v16; // eax@12
  OSMetaClass *v17; // rax@13
  __int64 v18; // rax@13

  v2 = a2;
  if ( IO80211PeerManager::shouldLog(this, 32LL) )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, 32LL);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(this, 32LL, "%s::%s\n", v4, (__int64)"getAwdlSyncParams", v5);
  }
  v6 = 3223873993LL;
  result = IO80211PeerManager::do_ioctl(this, 0xC02869C9, 0x74u, v2);
  if ( !result )
  {
    if ( *((_DWORD *)this + 373) != *((_DWORD *)v2 + 2) )
    {
      LODWORD(v8) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                      this,
                      3223873993LL);
      v9 = OSMetaClass::getClassName(v8);
      v6 = (signed __int64)"%s::%s mismatch _availabilityWindowPeriod %u data->availability_window_period %u\n";
      IO80211PeerManager::logDebug(
        this,
        "%s::%s mismatch _availabilityWindowPeriod %u data->availability_window_period %u\n",
        v9,
        (__int64)"getAwdlSyncParams",
        *((_DWORD *)this + 373),
        *((_DWORD *)v2 + 2));
    }
    if ( *((_DWORD *)this + 374) != *((_DWORD *)v2 + 1) )
    {
      LODWORD(v10) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, v6);
      v11 = OSMetaClass::getClassName(v10);
      v6 = (signed __int64)"%s::%s mismatch _availabilityWindowLength %u data->availability_window_length %u\n";
      IO80211PeerManager::logDebug(
        this,
        "%s::%s mismatch _availabilityWindowLength %u data->availability_window_length %u\n",
        v11,
        (__int64)"getAwdlSyncParams",
        *((_DWORD *)this + 374),
        *((_DWORD *)v2 + 1));
    }
    if ( *((_DWORD *)this + 375) != *((_DWORD *)v2 + 3) )
    {
      LODWORD(v12) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, v6);
      v13 = OSMetaClass::getClassName(v12);
      v6 = (signed __int64)"%s::%s mismatch _availabilityabilityWindowExtensionLength %u data->extension_length %u\n";
      IO80211PeerManager::logDebug(
        this,
        "%s::%s mismatch _availabilityabilityWindowExtensionLength %u data->extension_length %u\n",
        v13,
        (__int64)"getAwdlSyncParams",
        *((_DWORD *)this + 375),
        *((_DWORD *)v2 + 3));
    }
    if ( *((_DWORD *)this + 376) != *((_DWORD *)v2 + 4) )
    {
      LODWORD(v14) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, v6);
      v15 = OSMetaClass::getClassName(v14);
      v6 = (signed __int64)"%s::%s mismatch fSyncFramePeriod %u data->synchronization_frame_period %u\n";
      IO80211PeerManager::logDebug(
        this,
        "%s::%s mismatch fSyncFramePeriod %u data->synchronization_frame_period %u\n",
        v15,
        (__int64)"getAwdlSyncParams",
        *((_DWORD *)this + 376),
        *((_DWORD *)v2 + 4));
    }
    v16 = *((_DWORD *)this + 377);
    if ( v16 != *((_DWORD *)v2 + 5) )
    {
      LODWORD(v17) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, v6);
      v18 = OSMetaClass::getClassName(v17);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s mismatch fSyncFramePeriod %u data->synchronization_frame_period %u\n",
        v18,
        (__int64)"getAwdlSyncParams",
        *((_DWORD *)this + 377),
        *((_DWORD *)v2 + 5));
      v16 = *((_DWORD *)v2 + 5);
    }
    *((_DWORD *)this + 373) = *((_DWORD *)v2 + 2);
    *((_DWORD *)this + 374) = *((_DWORD *)v2 + 1);
    *((_DWORD *)this + 375) = *((_DWORD *)v2 + 3);
    *((_DWORD *)this + 376) = *((_DWORD *)v2 + 4);
    *((_DWORD *)this + 377) = v16;
    result = 0;
  }
  return result;
}

//----- (000000000003D7AE) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlSyncEnabled(IO80211PeerManager *this, void *a2)
{
  OSMetaClass *v2; // rax@2
  __int64 v3; // rax@2
  __int64 v4; // r9@2
  signed int v5; // ebx@3
  int v6; // eax@4
  OSMetaClass *v7; // rax@8
  __int64 v8; // rax@8

  if ( IO80211PeerManager::shouldLog(this, 32LL) )
  {
    LODWORD(v2) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, 32LL);
    v3 = OSMetaClass::getClassName(v2);
    IO80211PeerManager::logDebug(this, 32LL, "%s::%s \n", v3, (__int64)"getAwdlSyncEnabled", v4);
  }
  v5 = IO80211PeerManager::do_ioctl(this, 0xC02869C9, 0x75u, a2);
  if ( !v5 )
  {
    v6 = *((_DWORD *)this + 1849) & 2;
    if ( *((_DWORD *)a2 + 2) )
    {
      v5 = 0;
      if ( !v6 )
        goto LABEL_8;
    }
    else
    {
      v5 = 0;
      if ( v6 )
      {
LABEL_8:
        LODWORD(v7) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                        this,
                        3223873993LL);
        v8 = OSMetaClass::getClassName(v7);
        v5 = 0;
        IO80211PeerManager::logDebug(
          this,
          "%s::%s enable state mismatch fw %u _syncState %u\n",
          v8,
          (__int64)"getAwdlSyncEnabled",
          *((_DWORD *)a2 + 2),
          *((_DWORD *)this + 372));
        return (unsigned int)v5;
      }
    }
  }
  return (unsigned int)v5;
}

//----- (000000000003D87E) ----------------------------------------------------
__int64 IO80211AWDLPeerManager::getAwdlPeerServiceParams()
{
  return 0LL;
}

//----- (000000000003D886) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlElectionId(IO80211PeerManager *this, void *a2)
{
  signed int v2; // er14@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  __int64 v5; // r9@2
  OSMetaClass *v6; // rax@4
  __int64 v7; // rax@4

  v2 = IO80211PeerManager::do_ioctl(this, 0xC02869C9, 0x7Au, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    3223873993LL);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't get election_id ret=%d\n",
      v4,
      (__int64)"getAwdlElectionId",
      (unsigned int)v2,
      v5);
    *((_DWORD *)a2 + 1) = *((_DWORD *)this + 929);
  }
  else if ( IO80211PeerManager::shouldLog(this, 32LL) )
  {
    LODWORD(v6) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, 32LL);
    v7 = OSMetaClass::getClassName(v6);
    IO80211PeerManager::logDebug(
      this,
      32LL,
      "%s::%s election_id %u\n",
      v7,
      (__int64)"getAwdlElectionId",
      *((_DWORD *)this + 929));
  }
  return (unsigned int)v2;
}

//----- (000000000003D942) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlPrivateElectionId(IO80211PeerManager *this, void *a2)
{
  signed int v2; // er14@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  __int64 v5; // r9@2
  OSMetaClass *v6; // rax@4
  __int64 v7; // rax@4

  v2 = IO80211PeerManager::do_ioctl(this, 0xC02869C9, 0xD4u, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    3223873993LL);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't get election_id ret=%d\n",
      v4,
      (__int64)"getAwdlPrivateElectionId",
      (unsigned int)v2,
      v5);
    *((_DWORD *)a2 + 2) = *((_DWORD *)this + 934);
  }
  else if ( IO80211PeerManager::shouldLog(this, 32LL) )
  {
    LODWORD(v6) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, 32LL);
    v7 = OSMetaClass::getClassName(v6);
    IO80211PeerManager::logDebug(
      this,
      32LL,
      "%s::%s private election_id %u\n",
      v7,
      (__int64)"getAwdlPrivateElectionId",
      *((_DWORD *)this + 934));
  }
  return (unsigned int)v2;
}

//----- (000000000003D9FE) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlElectionMetric(IO80211PeerManager *this, void *a2)
{
  signed int v2; // er14@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  __int64 v5; // r9@2
  OSMetaClass *v6; // rax@4
  __int64 v7; // rax@4

  v2 = IO80211PeerManager::do_ioctl(this, 0xC02869C9, 0x7Eu, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    3223873993LL);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't get election_metric ret=%d\n",
      v4,
      (__int64)"getAwdlElectionMetric",
      (unsigned int)v2,
      v5);
  }
  else if ( IO80211PeerManager::shouldLog(this, 32LL) )
  {
    LODWORD(v6) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, 32LL);
    v7 = OSMetaClass::getClassName(v6);
    IO80211PeerManager::logDebug(
      this,
      32LL,
      "%s::%s election_metric %u\n",
      v7,
      (__int64)"getAwdlElectionMetric",
      *((_DWORD *)a2 + 1));
  }
  return (unsigned int)v2;
}

//----- (000000000003DAAE) ----------------------------------------------------
signed int __fastcall IO80211AWDLPeerManager::getAwdlMaxTreeDepth(IO80211PeerManager *a1, void *a2)
{
  return IO80211PeerManager::do_ioctl(a1, 0xC02869C9, 0x7Bu, a2);
}

//----- (000000000003DAC8) ----------------------------------------------------
signed int __fastcall IO80211AWDLPeerManager::getAwdlMaxPeers(IO80211PeerManager *a1, void *a2)
{
  return IO80211PeerManager::do_ioctl(a1, 0xC02869C9, 0x82u, a2);
}

//----- (000000000003DAE2) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlGuardTime(__int64 a1, __int64 a2)
{
  *(_DWORD *)(a2 + 4) = *(_DWORD *)(a1 + 3640);
  return 0LL;
}

//----- (000000000003DAF4) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlBssid(__int64 a1, __int64 a2)
{
  memcpy((void *)(a2 + 4), (const void *)(a1 + 3668), 6uLL);
  memcpy((void *)(a2 + 10), (const void *)(a1 + 3674), 6uLL);
  return 0LL;
}

//----- (000000000003DB32) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlElectionParams(IO80211PeerManager *this, void *a2)
{
  signed int v2; // er14@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // r15@2
  __int64 v5; // rax@2
  __int64 v6; // rax@2
  int v7; // eax@3
  int v8; // ecx@4
  OSMetaClass *v9; // rax@5
  __int64 v10; // rax@5
  int v11; // ST08_4@5
  int v12; // ST00_4@5

  v2 = IO80211PeerManager::do_ioctl(this, 0xC02869C9, 0x9Bu, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    3223873993LL);
    v4 = OSMetaClass::getClassName(v3);
    v5 = IO80211PeerManager::getController(this);
    LODWORD(v6) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v5 + 1920LL))(v5, (unsigned int)v2);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't get election params ret=%d %s\n",
      v4,
      (__int64)"getAwdlElectionParams",
      (unsigned int)v2,
      v6);
  }
  else
  {
    v7 = *((_WORD *)a2 + 9);
    if ( *((_DWORD *)this + 929) != v7 || (v8 = *((_DWORD *)this + 934), v8 != *((_DWORD *)a2 + 9)) )
    {
      LODWORD(v9) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                      this,
                      3223873993LL);
      v10 = OSMetaClass::getClassName(v9);
      v11 = *((_DWORD *)a2 + 9);
      v12 = *((_DWORD *)this + 934);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s electionId mismatch  (%u, %u) private (%u , %u)\n",
        v10,
        (__int64)"getAwdlElectionParams",
        *((_DWORD *)this + 929),
        *((_WORD *)a2 + 9));
      LOWORD(v7) = *((_WORD *)a2 + 9);
      v8 = *((_DWORD *)a2 + 9);
    }
    *((_DWORD *)this + 929) = (unsigned __int16)v7;
    *((_DWORD *)this + 934) = v8;
    memcpy((char *)this + 3692, (char *)a2 + 22, 6uLL);
    memcpy((char *)this + 3698, (char *)a2 + 41, 6uLL);
  }
  return (unsigned int)v2;
}

//----- (000000000003DC68) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlAvailabilityWindowApAlignment(__int64 a1, __int64 a2)
{
  *(_DWORD *)(a2 + 8) = *(_DWORD *)(a1 + 3660);
  *(_DWORD *)(a2 + 4) = *(_DWORD *)(a1 + 3664);
  *(_DWORD *)(a2 + 12) = 0;
  return 0LL;
}

//----- (000000000003DC8A) ----------------------------------------------------
signed __int64 IO80211AWDLPeerManager::getAwdlSyncFrameApAlignment()
{
  return 45LL;
}

//----- (000000000003DC96) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlChannelSequence(IO80211PeerManager *this, void *a2)
{
  void *v2; // r14@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  int v5; // ST00_4@2
  signed __int64 v6; // rsi@3
  signed int v7; // er15@3
  OSMetaClass *v8; // rax@4
  __int64 v9; // rax@4
  __int64 v10; // r9@4
  OSMetaClass *v11; // rax@6
  __int64 v12; // rax@6
  __int64 *v13; // r12@8
  OSMetaClass *v14; // rax@9
  __int64 v15; // rax@9
  int v16; // ST00_4@9
  OSMetaClass *v17; // rax@11
  __int64 v18; // rax@11
  OSMetaClass *v19; // rax@13
  __int64 v20; // rax@13

  v2 = a2;
  if ( IO80211PeerManager::shouldLog(this, 32LL) )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, 32LL);
    v4 = OSMetaClass::getClassName(v3);
    v5 = *((_BYTE *)this + 7605);
    IO80211PeerManager::logDebug(
      this,
      32LL,
      "%s::%s len %u step %u\n",
      v4,
      (__int64)"getAwdlChannelSequence",
      *((_BYTE *)this + 7584));
  }
  v6 = 3223873993LL;
  v7 = IO80211PeerManager::do_ioctl(this, 0xC02869C9, 0x81u, v2);
  if ( v7 )
  {
    LODWORD(v8) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    3223873993LL);
    v9 = OSMetaClass::getClassName(v8);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s unable to get AWDL channel sequence ret=%d \n",
      v9,
      (__int64)"getAwdlChannelSequence",
      (unsigned int)v7,
      v10);
  }
  else
  {
    if ( *((_BYTE *)v2 + 6) != *((_BYTE *)this + 7604) )
    {
      LODWORD(v11) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                       this,
                       3223873993LL);
      v12 = OSMetaClass::getClassName(v11);
      v6 = (signed __int64)"%s::%s Parameter mismatch (channel sequence encoding): FW(%d), Family(%d)\n";
      IO80211PeerManager::logDebug(
        this,
        "%s::%s Parameter mismatch (channel sequence encoding): FW(%d), Family(%d)\n",
        v12,
        (__int64)"getAwdlChannelSequence",
        *((_BYTE *)v2 + 6),
        *((_BYTE *)this + 7604));
    }
    if ( *((_BYTE *)v2 + 5) == *((_BYTE *)this + 7584) )
    {
      v13 = (__int64 *)((char *)v2 + 7);
    }
    else
    {
      LODWORD(v14) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, v6);
      v15 = OSMetaClass::getClassName(v14);
      v13 = (__int64 *)((char *)v2 + 7);
      v16 = *((_BYTE *)v2 + 7);
      v6 = (signed __int64)"%s::%s Parameter mismatch (channel sequence length) :: FW(%d), Family(%d) step=%un";
      IO80211PeerManager::logDebug(
        this,
        "%s::%s Parameter mismatch (channel sequence length) :: FW(%d), Family(%d) step=%un",
        v15,
        (__int64)"getAwdlChannelSequence",
        *((_BYTE *)v2 + 5),
        *((_BYTE *)this + 7584));
    }
    if ( *(_BYTE *)v13 != *((_BYTE *)this + 7605) )
    {
      LODWORD(v17) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, v6);
      v18 = OSMetaClass::getClassName(v17);
      v6 = (signed __int64)"%s::%s Parameter mismatch (channel sequence step count) -: FW(%d), Family(%d)\n";
      IO80211PeerManager::logDebug(
        this,
        "%s::%s Parameter mismatch (channel sequence step count) -: FW(%d), Family(%d)\n",
        v18,
        (__int64)"getAwdlChannelSequence",
        *(_BYTE *)v13,
        *((_BYTE *)this + 7605));
    }
    if ( *((_BYTE *)v2 + 9) != *((_BYTE *)this + 7601) )
    {
      LODWORD(v19) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(this, v6);
      v20 = OSMetaClass::getClassName(v19);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s Parameter mismatch (channel fill channel): FW(%d), Family(%d)\n",
        v20,
        (__int64)"getAwdlChannelSequence",
        *((_BYTE *)v2 + 9),
        *((_BYTE *)this + 7601));
    }
    *((_DWORD *)v2 + 99) = *((_DWORD *)this + 259);
  }
  return (unsigned int)v7;
}

//----- (000000000003DEA0) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlOUI(__int64 a1, __int64 a2)
{
  *(_BYTE *)(a2 + 4) = *(_BYTE *)(a1 + 3776);
  *(_BYTE *)(a2 + 5) = *(_BYTE *)(a1 + 3777);
  *(_BYTE *)(a2 + 6) = *(_BYTE *)(a1 + 3778);
  return 0LL;
}

//----- (000000000003DEC4) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlMasterChannel(IO80211PeerManager *this, void *a2)
{
  signed int v2; // er14@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  __int64 v5; // r9@2
  OSMetaClass *v6; // rax@4
  __int64 v7; // rax@4

  v2 = IO80211PeerManager::do_ioctl(this, 0xC02869C9, 0x84u, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    3223873993LL);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s can't get channel ret %u\n",
      v4,
      (__int64)"getAwdlMasterChannel",
      (unsigned int)v2,
      v5);
  }
  else if ( *((_DWORD *)a2 + 1) != *((_BYTE *)this + 1532) )
  {
    LODWORD(v6) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    3223873993LL);
    v7 = OSMetaClass::getClassName(v6);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s master channel mismatch got %u want %u\n",
      v7,
      (__int64)"getAwdlMasterChannel",
      *((_DWORD *)a2 + 1),
      *((_BYTE *)this + 1532));
  }
  return (unsigned int)v2;
}

//----- (000000000003DF72) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlSecondaryMasterChannel(IO80211PeerManager *this, void *a2)
{
  signed int v2; // er14@2
  OSMetaClass *v3; // rax@3
  __int64 v4; // rax@3
  __int64 v5; // r9@3
  OSMetaClass *v6; // rax@6
  __int64 v7; // rax@6

  if ( *((_BYTE *)this + 7396) & 2 )
  {
    v2 = IO80211PeerManager::do_ioctl(this, 0xC02869C9, 0xCDu, a2);
    if ( v2 )
    {
      LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                      this,
                      3223873993LL);
      v4 = OSMetaClass::getClassName(v3);
      IO80211PeerManager::logDebug(
        this,
        "%s::%s can't get secondary channel ret %u\n",
        v4,
        (__int64)"getAwdlSecondaryMasterChannel",
        (unsigned int)v2,
        v5);
    }
    else
    {
      v2 = 0;
      if ( *((_DWORD *)a2 + 1) != *((_BYTE *)this + 1533) )
      {
        LODWORD(v6) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                        this,
                        3223873993LL);
        v7 = OSMetaClass::getClassName(v6);
        v2 = 0;
        IO80211PeerManager::logDebug(
          this,
          "%s::%s secondary master channel mismatch got %u want %u\n",
          v7,
          (__int64)"getAwdlSecondaryMasterChannel",
          *((_DWORD *)a2 + 1),
          *((_BYTE *)this + 1533));
      }
    }
  }
  else
  {
    *((_DWORD *)a2 + 1) = *((_BYTE *)this + 1533);
    v2 = 0;
  }
  return (unsigned int)v2;
}

//----- (000000000003E042) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlTopMaster(__int64 a1, __int64 a2)
{
  signed int v2; // er15@1

  v2 = IO80211PeerManager::do_ioctl((IO80211PeerManager *)a1, 0xC02869C9, 0x85u, (void *)a2);
  if ( v2 )
    memcpy((void *)(a1 + 3692), (const void *)(a2 + 4), 6uLL);
  return (unsigned int)v2;
}

//----- (000000000003E096) ----------------------------------------------------
signed int __fastcall IO80211AWDLPeerManager::getAwdlElectionRssiThresholds(IO80211PeerManager *a1, void *a2)
{
  return IO80211PeerManager::do_ioctl(a1, 0xC02869C9, 0x87u, a2);
}

//----- (000000000003E0B0) ----------------------------------------------------
signed int __fastcall IO80211AWDLPeerManager::getAwdlSyncState(IO80211PeerManager *a1, void *a2)
{
  return IO80211PeerManager::do_ioctl(a1, 0xC02869C9, 0x86u, a2);
}

//----- (000000000003E0CA) ----------------------------------------------------
signed int __fastcall IO80211AWDLPeerManager::getAwdlPresenceMode(IO80211PeerManager *a1, void *a2)
{
  return IO80211PeerManager::do_ioctl(a1, 0xC02869C9, 0x88u, a2);
}

//----- (000000000003E0E4) ----------------------------------------------------
signed int __fastcall IO80211AWDLPeerManager::getAwdlElectionMasterCounts(IO80211PeerManager *a1, void *a2)
{
  return IO80211PeerManager::do_ioctl(a1, 0xC02869C9, 0x89u, a2);
}

//----- (000000000003E0FE) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlSyncFramePacketLifetime(__int64 a1, __int64 a2)
{
  *(_DWORD *)(a2 + 4) = *(_DWORD *)(a1 + 3768);
  return 0LL;
}

//----- (000000000003E110) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlMasterSyncFramePeriod(__int64 a1, __int64 a2)
{
  *(_DWORD *)(a2 + 4) = *(_DWORD *)(a1 + 1504);
  return 0LL;
}

//----- (000000000003E122) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlNonElectionMasterSyncFramePeriod(__int64 a1, __int64 a2)
{
  *(_DWORD *)(a2 + 4) = *(_DWORD *)(a1 + 1508);
  return 0LL;
}

//----- (000000000003E134) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlMaxNoMasterPeriods(__int64 a1, __int64 a2)
{
  *(_DWORD *)(a2 + 4) = *(_BYTE *)(a1 + 3779);
  return 0LL;
}

//----- (000000000003E146) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlBtCoexProtectedPeriodLength(IO80211PeerManager *this, void *a2)
{
  signed int v2; // er14@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  __int64 v5; // r9@2

  v2 = IO80211PeerManager::do_ioctl(this, 0xC02869C9, 0x91u, a2);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    3223873993LL);
    v4 = OSMetaClass::getClassName(v3);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s cannot get BT protected length ret %d\n",
      v4,
      (__int64)"getAwdlBtCoexProtectedPeriodLength",
      (unsigned int)v2,
      v5);
  }
  else
  {
    *((_DWORD *)this + 943) = *((_DWORD *)a2 + 1);
  }
  return (unsigned int)v2;
}

//----- (000000000003E1BA) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlStrategy(__int64 a1, __int64 a2)
{
  *(_DWORD *)(a2 + 4) = *(_DWORD *)(a1 + 4952);
  *(_DWORD *)(a2 + 8) = *(_DWORD *)(a1 + 4976);
  *(_QWORD *)(a2 + 16) = getAbsoluteTime() - *(_QWORD *)(a1 + 7504);
  return 0LL;
}

//----- (000000000003E1F2) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::getAwdlPeerDatabase(__int64 a1, __int64 a2)
{
  unsigned int v2; // edx@1

  v2 = *(_DWORD *)(*(_QWORD *)(a1 + 88) + 52LL);
  *(_DWORD *)(a2 + 4) = v2;
  if ( v2 )
  {
    if ( v2 >= 0x41 )
      *(_DWORD *)(a2 + 4) = 64;
    IO80211CommandQueue::map(
      *(_QWORD *)(a1 + 88),
      (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_generatePeerDatabase,
      a1,
      a2,
      0LL,
      -1);
  }
  return 0LL;
}

//----- (000000000003E239) ----------------------------------------------------
__int64 __fastcall _generatePeerDatabase(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r15@1
  unsigned __int64 v4; // rbx@1
  int v5; // ecx@1
  int v6; // esi@1
  __int64 result; // rax@3

  v3 = a3;
  v4 = (unsigned __int64)(unsigned int)_generatePeerDatabase(OSObject *,IO80211QueueDescriptor *,void *,mapExtraParam *)::count << 6;
  memcpy((void *)(a3 + v4 + 8), (const void *)(a2 + 32), 6uLL);
  memcpy((void *)(v3 + v4 + 14), (const void *)(a2 + 1430), 6uLL);
  memcpy((void *)(v3 + v4 + 20), (const void *)(a2 + 1436), 6uLL);
  *(_DWORD *)(v3 + v4 + 32) = *(_WORD *)(a2 + 1296);
  *(_DWORD *)(v3 + v4 + 36) = *(_WORD *)(a2 + 1288);
  *(_DWORD *)(v3 + v4 + 40) = *(_WORD *)(a2 + 1294);
  *(_DWORD *)(v3 + v4 + 44) = *(_WORD *)(a2 + 1290);
  *(_WORD *)(v3 + v4 + 52) = *(_WORD *)(a2 + 1164);
  *(_DWORD *)(v3 + v4 + 68) = (char)IO80211Peer::getRssi((IO80211Peer *)a2);
  *(_DWORD *)(v3 + v4 + 60) = *(_DWORD *)(a2 + 1172);
  *(_DWORD *)(v3 + v4 + 56) = *(_DWORD *)(a2 + 1168);
  *(_BYTE *)(v3 + v4 + 64) = *(_BYTE *)(a2 + 1176);
  v5 = *(_DWORD *)(v3 + 4) - 1;
  v6 = 0;
  if ( _generatePeerDatabase(OSObject *,IO80211QueueDescriptor *,void *,mapExtraParam *)::count < (unsigned int)v5 )
    v6 = _generatePeerDatabase(OSObject *,IO80211QueueDescriptor *,void *,mapExtraParam *)::count + 1;
  result = 3
         * (unsigned int)(_generatePeerDatabase(OSObject *,IO80211QueueDescriptor *,void *,mapExtraParam *)::count >= (unsigned int)v5);
  _generatePeerDatabase(OSObject *,IO80211QueueDescriptor *,void *,mapExtraParam *)::count = v6;
  return result;
}
// 84E78: using guessed type int _generatePeerDatabase(OSObject *,IO80211QueueDescriptor *,void *,mapExtraParam *)::count;

//----- (000000000003E338) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::printState(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // r13@1
  IO80211CommandQueue *v4; // rdi@1
  __int64 v5; // r14@3
  unsigned __int64 v6; // r15@3
  int v7; // eax@3
  __int64 v8; // rdx@4
  int v9; // esi@9
  __int64 v10; // rcx@9
  __int64 v11; // r8@11
  __int64 v12; // r9@13
  char *v13; // rax@15
  int v14; // er10@17
  int v15; // er11@17
  __int64 v16; // rdi@17
  int v17; // er14@18
  unsigned int v18; // er15@19
  int v19; // eax@19
  char v20[8]; // rcx@20
  __int64 v21; // rax@22
  __int64 v22; // rdx@24
  __int64 v23; // rcx@24
  __int64 v24; // r8@24
  __int64 v25; // r9@24
  int v26; // ST08_4@27
  __int64 v27; // rdx@28
  int v28; // ST10_4@29
  int v29; // ST08_4@29
  __int64 v30; // r14@30
  unsigned __int64 v31; // r15@30
  unsigned __int64 v32; // rax@30
  char v33[8]; // rcx@30
  unsigned __int64 v34; // rax@32
  __int64 v35; // r12@34
  char v36; // ST00_1@34
  int v37; // ST08_4@34
  __int64 v38; // rax@35
  int v39; // ST20_4@35
  int v40; // ST18_4@35
  int v41; // ST10_4@35
  int v42; // ST08_4@35
  unsigned int v43; // ST40_4@36
  __int64 v44; // r14@36
  __int64 v45; // ST38_8@36
  __int64 v46; // r14@36
  unsigned __int64 v47; // rbx@36
  __int64 v48; // r14@36
  unsigned __int64 v49; // r14@36
  __int64 v50; // r15@36
  __int64 v51; // rax@36
  int v52; // ST10_4@36
  int v53; // er11@36
  __int64 v54; // rdx@36
  __int64 v55; // rcx@36
  __int64 v56; // r8@36
  __int64 v57; // r9@36
  char v59; // [sp+0h] [bp-80h]@19
  char v60; // [sp+0h] [bp-80h]@24
  __int64 v61; // [sp+38h] [bp-48h]@32
  char v62[8]; // [sp+40h] [bp-40h]@30
  __int64 v63; // [sp+48h] [bp-38h]@30
  unsigned int v64; // [sp+54h] [bp-2Ch]@1

  v2 = a2;
  v3 = a1;
  v64 = 0;
  v4 = *(IO80211CommandQueue **)(a1 + 3808);
  if ( v4 )
    IO80211CommandQueue::lockMap(
      v4,
      (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countAirPlayServices,
      v3,
      (__int64)&v64,
      0LL,
      -1);
  v5 = *(_QWORD *)(v3 + 3912);
  v6 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v5)) >> 64) >> 18;
  ((void (__fastcall *)(__int64, __int64))`vtable for'IO80211PeerManager[65])(v3, a2);
  v7 = *(_DWORD *)(v3 + 1488);
  if ( v7 == 1 )
  {
    v8 = (__int64)"Master";
  }
  else if ( v7 == 2 )
  {
    v8 = (__int64)"Slave";
  }
  else
  {
    v8 = (__int64)"Stopped";
    if ( v7 == 3 )
      v8 = (__int64)"NeMaster";
  }
  v9 = *(_DWORD *)(v3 + 7396);
  v10 = (__int64)" QUIET";
  if ( !(v9 & 0xC) )
    v10 = (__int64)&byte_690F5;
  v11 = (__int64)" SYNC-ACTIVE";
  if ( !((v9 & 2u) >> 1) )
    v11 = (__int64)&byte_690F5;
  v12 = (__int64)" OFF";
  if ( v9 & 0xE )
    v12 = (__int64)&byte_690F5;
  v13 = " CONFIGURED";
  if ( !(v9 & 1) )
    v13 = &byte_690F5;
  v14 = *(_BYTE *)(v3 + 1518);
  v15 = *(_BYTE *)(v3 + 1512);
  v16 = *(_QWORD *)(v3 + 3808);
  if ( v16 )
    v17 = *(_DWORD *)(v16 + 52);
  v18 = 0;
  _userPrint(
    v2,
    "          AWDL synchronization %s [state%s%s%s%s] minExt %u presenceMode %u numServiceReq %u lastServiceUpdate %u.%03u(sec) ago\n",
    v8,
    v10,
    v11,
    v12,
    (char)v13);
  v19 = *(_DWORD *)(v3 + 7376) - 1;
  if ( (unsigned int)v19 > 3 )
    *(_QWORD *)v20 = "Unknown";
  else
    *(_QWORD *)v20 = off_7D2D0[v19];
  v21 = *(_QWORD *)(v3 + 3808);
  if ( v21 )
    v18 = *(_DWORD *)(v21 + 52);
  _userPrint(
    v2,
    "          country <%s> countryCodeState<%s> numServices %u airplay services %u\n",
    v3 + 1456,
    *(__int64 *)v20,
    v18,
    v64,
    v59);
  if ( *(_DWORD *)(v3 + 612) )
    _userPrint(v2, "          channel switch in progress...\n", v22, v23, v24, v25, v60);
  if ( (*(_DWORD *)(v3 + 1488) & 0xFFFFFFFE) == 2 )
  {
    v26 = *(_BYTE *)(v3 + 3691);
    _userPrint(
      v2,
      "          Current Master %02X:%02X:%02X:%02X:%02X:%02X\n",
      *(_BYTE *)(v3 + 3686),
      *(_BYTE *)(v3 + 3687),
      *(_BYTE *)(v3 + 3688),
      *(_BYTE *)(v3 + 3689),
      *(_BYTE *)(v3 + 3690));
  }
  v27 = *(_DWORD *)(v3 + 104);
  if ( (_DWORD)v27 )
  {
    v28 = *(_BYTE *)(v3 + 117);
    v29 = *(_BYTE *)(v3 + 116);
    _userPrint(
      v2,
      "          Has infrastructure channel %u BSSID %02X:%02X:%02X:%02X:%02X:%02X\n",
      v27,
      *(_BYTE *)(v3 + 112),
      *(_BYTE *)(v3 + 113),
      *(_BYTE *)(v3 + 114),
      *(_BYTE *)(v3 + 115));
  }
  v63 = v2;
  v30 = *(_QWORD *)(v3 + 7504);
  v31 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v30)) >> 64) >> 18;
  v32 = *(_DWORD *)(v3 + 4976);
  *(_QWORD *)v33 = "unknown";
  *(_QWORD *)v62 = "unknown";
  if ( v32 <= 0xB )
    *(_QWORD *)v33 = off_7D120[v32];
  v61 = *(_QWORD *)v33;
  v34 = *(_DWORD *)(v3 + 1036);
  if ( v34 <= 3 )
    *(_QWORD *)v62 = off_7D180[v34];
  v35 = *(_QWORD *)(v3 + 3936);
  v36 = *(_DWORD *)(v3 + 7400);
  v37 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v35)) >> 64) >> 18;
  _userPrint(
    v2,
    "          Sched state %s strategy %s last change %u.%03u MetricFlags 0x%x last %u(ms)\n",
    v61,
    *(__int64 *)v62,
    (unsigned int)v31 / 0x3E8,
    (unsigned int)v31 % 0x3E8,
    v36);
  if ( *(_BYTE *)(v3 + 7408) )
  {
    v38 = *(_QWORD *)(v3 + 7416);
    v39 = *(_DWORD *)(v3 + 4060);
    v40 = *(_BYTE *)(v3 + 7443);
    v41 = *(_BYTE *)(v38 + 37);
    v42 = *(_BYTE *)(v38 + 36);
    _userPrint(
      v2,
      "%s          Airplaying to %02X:%02X:%02X:%02X:%02X:%02X. InfraAirplayMode(%d) FavorATVInfra(%d) %s\n",
      (__int64)"\x1B[1;30;48m",
      *(_BYTE *)(v38 + 32),
      *(_BYTE *)(v38 + 33),
      *(_BYTE *)(v38 + 34),
      *(_BYTE *)(v38 + 35));
  }
  v43 = *(_DWORD *)(v3 + 696);
  v44 = *(_QWORD *)(v3 + 3912);
  v45 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v44)) >> 64) >> 18;
  v46 = *(_QWORD *)(v3 + 992);
  v47 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v46)) >> 64) >> 18;
  v48 = *(_QWORD *)(v3 + 1000);
  v49 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v48)) >> 64) >> 18;
  v50 = *(_QWORD *)(v3 + 3920);
  v51 = getAbsoluteTime();
  v52 = *(_DWORD *)(v3 + 3652);
  _userPrint(
    v63,
    "          Monitor=%u msecSince Service %u(ms) Txu %u(ms) Rxu %u(ms) ifState %u(ms) -- timeout Service %u(ms) Inact %u(ms) Iface %u(ms)\n",
    v43,
    v45,
    (unsigned int)v47,
    (unsigned int)v49,
    (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (v51 - v50)) >> 64) >> 18);
  v53 = *(_BYTE *)(v3 + 7408);
  LODWORD(v50) = *(_DWORD *)(v3 + 3972);
  _userPrint(
    v63,
    "          data channels=(%u,%u), master channels 0x%x/0x%x,, piggybackScanstate=%u airplaying=%u deviceFlags 0x%x%s%s%s%s\n",
    *(_BYTE *)(v3 + 1534),
    *(_BYTE *)(v3 + 1535),
    *(_BYTE *)(v3 + 1532),
    *(_BYTE *)(v3 + 1533),
    *(_DWORD *)(v3 + 4980));
  IO80211AWDLPeerManager::printAwdlChannelSequence(v3, v63, v54, v55, v56, v57);
  IO80211AWDLPeerManager::printAwdlTimingStats(v3, v63);
  return *(_DWORD *)(v63 + 40);
}
// 690F5: using guessed type char byte_690F5;
// 7D120: using guessed type char *off_7D120[33];
// 7D180: using guessed type char *off_7D180[21];
// 7D2D0: using guessed type char *off_7D2D0[6];
// 7D5B0: using guessed type __int64 `vtable for'IO80211PeerManager[2];

//----- (000000000003E86E) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::printDataPath(IO80211PeerManager *this, __int64 a2)
{
  IO80211PeerManager *v2; // rbx@1
  __int64 v3; // r9@1
  char *v4; // rax@1
  __int64 v5; // rax@3
  unsigned int v6; // er15@3
  char v7; // r13@5
  IO80211VirtualInterface *v8; // rdi@5
  int v9; // er12@6
  int v10; // ST20_4@7
  int v11; // ST18_4@7
  int v12; // ST10_4@7
  int v13; // ST08_4@7
  __int16 v14; // ax@7
  __int64 v15; // r12@7
  unsigned int v16; // ST30_4@9
  unsigned int v17; // ST2C_4@9
  __int64 v18; // r13@9
  __int64 v19; // r15@9
  __int64 v20; // rax@9
  int v21; // ST10_4@9
  int v22; // ST08_4@9
  __int64 v23; // r9@9
  char v24; // ST00_1@9
  __int64 v25; // rdx@9
  __int64 v26; // rcx@9
  __int64 v27; // r8@9
  __int64 v28; // r9@9
  char v29; // ST00_1@9
  __int64 v30; // rdi@9
  unsigned int v32; // [sp+2Ch] [bp-34h]@5
  unsigned int v33; // [sp+30h] [bp-30h]@5
  unsigned int v34; // [sp+34h] [bp-2Ch]@5
  unsigned int v35; // [sp+34h] [bp-2Ch]@7

  v2 = this;
  v3 = *((_DWORD *)this + 1849);
  v4 = "Quiet ";
  if ( !(v3 & 0xC) )
    v4 = &byte_690F5;
  _userPrint(
    a2,
    "AWDL state:\n      presenceMode %u guardTime %u minExt %u state %x [%s%s%s]\n",
    *((_BYTE *)this + 1512),
    *((_DWORD *)this + 910),
    *((_BYTE *)this + 1518),
    v3,
    (char)v4);
  v5 = *((_QWORD *)this + 476);
  v6 = 0;
  if ( v5 )
    v6 = *(_DWORD *)(v5 + 52);
  v33 = *((_DWORD *)this + 26);
  v34 = *((_DWORD *)this + 1025);
  v32 = *((_DWORD *)this + 1883);
  v7 = *(_BYTE *)(IO80211PeerManager::getController(this) + 312);
  v8 = (IO80211VirtualInterface *)*((_QWORD *)this + 16);
  if ( v8 )
    v9 = (unsigned __int8)IO80211VirtualInterface::dualBandCapable(v8);
  _userPrint(
    a2,
    "      num service requests %u _infraChannel.channel %u infraRssi %d awdl->infra %u infra->awdl %u dual-band %d\n",
    v6,
    v33,
    v34,
    v32,
    v7);
  v10 = *((_DWORD *)v2 + 259);
  v11 = *((_DWORD *)v2 + 2061);
  v12 = *((_DWORD *)v2 + 26);
  v13 = *((_BYTE *)v2 + 117);
  _userPrint(
    a2,
    "         infraBSSID: %02X:%02X:%02X:%02X:%02X:%02X ch %u roam_assert %u _channelSequenceStrategy %u\n",
    *((_BYTE *)v2 + 112),
    *((_BYTE *)v2 + 113),
    *((_BYTE *)v2 + 114),
    *((_BYTE *)v2 + 115),
    *((_BYTE *)v2 + 116));
  v14 = *((_WORD *)v2 + 167);
  v35 = *((_DWORD *)v2 + 904);
  v15 = (__int64)"not supported";
  if ( (v14 & 2u) >> 1 )
    v15 = (__int64)"supported";
  v16 = *((_DWORD *)v2 + 991);
  v17 = *((_DWORD *)v2 + 40);
  v18 = *((_QWORD *)v2 + 940);
  v19 = (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v18)) >> 64) >> 18);
  v20 = getAbsoluteTime();
  v21 = *((_DWORD *)v2 + 361);
  v22 = *((_BYTE *)v2 + 628);
  _userPrint(
    a2,
    "        af_tx_mode %u 40MHz %s droppedDPClosed %u _peerCacheMaxSize %u sinceLastRoleChange %u(ms) wl %u master_indications [out %u]\n",
    v35,
    v15,
    v16,
    v17,
    (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (v20 - v19)) >> 64) >> 18);
  _userPrint(
    a2,
    "        action frame rx count %u, 2.4GHz %u, 5GHz %u\n",
    *((_DWORD *)v2 + 226),
    *((_DWORD *)v2 + 227),
    *((_DWORD *)v2 + 228),
    v23,
    v24);
  ((void (__fastcall *)(IO80211PeerManager *, __int64))`vtable for'IO80211PeerManager[67])(v2, a2);
  _userPrint(a2, " infra peers List:\n", v25, v26, v27, v28, v29);
  v30 = *((_QWORD *)v2 + 515);
  if ( v30 )
    IO80211CommandQueue::print(v30, a2);
  return *(_DWORD *)(a2 + 40);
}
// 690F5: using guessed type char byte_690F5;
// 7D5B0: using guessed type __int64 `vtable for'IO80211PeerManager[2];

//----- (000000000003EADC) ----------------------------------------------------
void *__fastcall IO80211AWDLPeerManager::awdlStatsClearMetrics(IO80211AWDLPeerManager *this)
{
  void *result; // rax@1

  result = memset((char *)this + 8256, 0, 0xE0uLL);
  *((_QWORD *)this + 1060) = 0LL;
  if ( *((_DWORD *)this + 992) )
    *((_BYTE *)this + 8260) |= 0x10u;
  return result;
}

//----- (000000000003EB1A) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::awdlStatsPrintMetric(IO80211AWDLPeerManager *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  IO80211AWDLPeerManager *v6; // r13@1
  __int64 v7; // r8@1
  __int64 v8; // r9@1
  __int64 v9; // r8@1
  __int64 v10; // r9@1
  __int64 v11; // r8@1
  __int64 v12; // r9@1
  __int64 v13; // r8@1
  __int64 v14; // r9@1
  __int64 v15; // r8@1
  __int64 v16; // r9@1
  __int64 v17; // r8@1
  __int64 v18; // r9@1
  __int64 v19; // r8@1
  __int64 v20; // r9@1
  __int64 v21; // r8@1
  __int64 v22; // r9@1
  __int64 v23; // rcx@1
  __int64 v24; // r8@3
  __int64 v25; // r9@3
  __int64 v26; // r15@3
  __int64 v27; // rcx@3
  __int64 v28; // r8@5
  __int64 v29; // r9@5
  __int64 v30; // rcx@5
  __int64 v31; // r8@7
  __int64 v32; // r9@7
  __int64 v33; // rcx@9
  __int64 v34; // r8@9
  __int64 v35; // r9@9
  __int64 v36; // r8@9
  __int64 v37; // r9@9
  __int64 v38; // r8@9
  __int64 v39; // r9@9
  __int64 v40; // r8@9
  __int64 v41; // r9@9
  __int64 v42; // r8@9
  __int64 v43; // r9@9
  __int64 v44; // rcx@9
  __int64 v45; // r8@9
  __int64 v46; // r9@9
  unsigned __int64 v47; // rbx@9
  __int64 result; // rax@10

  v6 = this;
  IO80211PeerManager::logDebug(this, 0x2000000000000LL, "AWDL Statistics:\n", a4, a5, a6);
  IO80211PeerManager::logDebug(
    this,
    0x2000000000000LL,
    "Rx Bytes              = %d\n",
    *((_DWORD *)this + 2066),
    v7,
    v8);
  IO80211PeerManager::logDebug(v6, 0x2000000000000LL, "Tx Bytes              = %d\n", *((_DWORD *)v6 + 2067), v9, v10);
  IO80211PeerManager::logDebug(v6, 0x2000000000000LL, "Self Infra Channel    = %d\n", *((_BYTE *)v6 + 8276), v11, v12);
  IO80211PeerManager::logDebug(v6, 0x2000000000000LL, "Peer Infra Channel    = %d\n", *((_BYTE *)v6 + 8277), v13, v14);
  IO80211PeerManager::logDebug(v6, 0x2000000000000LL, "# of Peers Discovered = %d\n", *((_BYTE *)v6 + 8278), v15, v16);
  IO80211PeerManager::logDebug(v6, 0x2000000000000LL, "# of Cached Peers     = %d\n", *((_BYTE *)v6 + 8279), v17, v18);
  IO80211PeerManager::logDebug(v6, 0x2000000000000LL, "Flags                 = %x\n", *((_DWORD *)v6 + 2065), v19, v20);
  v23 = (__int64)"non-XZ";
  if ( *((_DWORD *)this + 2065) & 1 )
    v23 = (__int64)"XZ";
  IO80211PeerManager::logDebug(this, 0x2000000000000LL, "Country Code          = %s\n", v23, v21, v22);
  v26 = (__int64)"No";
  v27 = (__int64)"No";
  if ( (*((_DWORD *)this + 2065) & 0x10u) >> 4 )
    v27 = (__int64)"Yes";
  IO80211PeerManager::logDebug(this, 0x2000000000000LL, "Is AppleTV            = %s\n", v27, v24, v25);
  v30 = (__int64)"No";
  if ( (*((_DWORD *)this + 2065) & 8u) >> 3 )
    v30 = (__int64)"Yes";
  IO80211PeerManager::logDebug(this, 0x2000000000000LL, "Supports Solo         = %s\n", v30, v28, v29);
  if ( (*((_DWORD *)this + 2065) & 0x20u) >> 5 )
    v26 = (__int64)"Yes";
  IO80211PeerManager::logDebug(this, 0x2000000000000LL, "Was Airplaying        = %s\n", v26, v31, v32);
  IO80211PeerManager::logDebug(this, 0x2000000000000LL, "Cached Peer's Infra on: \n", v33, v34, v35);
  IO80211PeerManager::logDebug(
    this,
    0x2000000000000LL,
    "                 2.4G = %d\n",
    *((_BYTE *)this + 8280),
    v36,
    v37);
  IO80211PeerManager::logDebug(
    this,
    0x2000000000000LL,
    "                   5G = %d\n",
    *((_BYTE *)this + 8281),
    v38,
    v39);
  IO80211PeerManager::logDebug(
    this,
    0x2000000000000LL,
    "                  DFS = %d\n",
    *((_BYTE *)this + 8282),
    v40,
    v41);
  IO80211PeerManager::logDebug(
    this,
    0x2000000000000LL,
    "       Not-Associated = %d\n",
    *((_BYTE *)this + 8283),
    v42,
    v43);
  IO80211PeerManager::logDebug(
    this,
    0x2000000000000LL,
    "                           State           Count      Duration(msecs)\n",
    v44,
    v45,
    v46);
  v47 = 0LL;
  do
  {
    result = IO80211PeerManager::logDebug(
               this,
               0x2000000000000LL,
               "%32s %15d %20llu\n",
               (__int64)off_7D120[v47 / 8],
               *(_DWORD *)((char *)this + 2 * v47 + 8288),
               *(_QWORD *)((char *)this + 2 * v47 + 8296));
    v47 += 8LL;
  }
  while ( v47 != 96 );
  return result;
}
// 7D120: using guessed type char *off_7D120[33];

//----- (000000000003EDA2) ----------------------------------------------------
void __fastcall IO80211AWDLPeerManager::awdlStatsDecrementPeer(IO80211AWDLPeerManager *this)
{
  --*((_BYTE *)this + 8278);
}

//----- (000000000003EDAE) ----------------------------------------------------
char __usercall IO80211AWDLPeerManager::awdlStatsCountPeersBand@<al>(IO80211AWDLPeerManager *this@<rdi>, __int64 a2@<rax>, unsigned __int8 a3@<sil>)
{
  if ( a3 )
  {
    if ( a3 < 0xFu )
    {
      ++*((_DWORD *)this + 2125);
    }
    else
    {
      ++*((_DWORD *)this + 2126);
      LOBYTE(a2) = IO80211AWDLPeerManager::isDFSChannel(this, a2, a3);
      if ( (_BYTE)a2 )
        ++*((_DWORD *)this + 2127);
    }
  }
  else
  {
    ++*((_DWORD *)this + 2124);
  }
  return a2;
}

//----- (000000000003EDF4) ----------------------------------------------------
void __fastcall IO80211QueueDescriptor::freeResources(IO80211QueueDescriptor *this)
{
  ;
}

//----- (000000000003EDFA) ----------------------------------------------------
__int64 __fastcall IO80211AWDLPeerManager::MetaClass::~MetaClass(IO80211AWDLPeerManager::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000003EE10) ----------------------------------------------------
__int64 `global constructor keyed to'_a_7()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(
    &IO80211AWDLPeerManager::gMetaClass,
    "IO80211AWDLPeerManager",
    &IO80211PeerManager::gMetaClass,
    8512LL);
  result = (__int64)off_7D020;
  IO80211AWDLPeerManager::gMetaClass = off_7D020;
  return result;
}
// 7D020: using guessed type __int64 (__fastcall *off_7D020[2])(IO80211AWDLPeerManager::MetaClass *__hidden this);
// 84430: using guessed type _QWORD IO80211AWDLPeerManager::gMetaClass;
// 84480: using guessed type _QWORD IO80211PeerManager::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003EE50) ----------------------------------------------------
__int64 `global destructor keyed to'_a_7()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211AWDLPeerManager::gMetaClass);
}
// 84430: using guessed type _QWORD IO80211AWDLPeerManager::gMetaClass;

//----- (000000000003EE70) ----------------------------------------------------
__int64 __fastcall IO80211Peer::MetaClass::MetaClass(IO80211Peer::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211Peer", &IO80211QueueDescriptor::gMetaClass, 1152LL);
  result = (__int64)off_7D4C0;
  *(_QWORD *)this = off_7D4C0;
  return result;
}
// 7D4C0: using guessed type __int64 (__fastcall *off_7D4C0[2])(IO80211Peer::MetaClass *__hidden this);
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003EEA2) ----------------------------------------------------
__int64 __fastcall IO80211Peer::MetaClass::~MetaClass(IO80211Peer::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000003EEAC) ----------------------------------------------------
__int64 __fastcall IO80211Peer::IO80211Peer(__int64 a1)
{
  __int64 result; // rax@1

  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  result = (__int64)off_7D310;
  *(_QWORD *)a1 = off_7D310;
  return result;
}
// 7D310: using guessed type __int64 (__fastcall *off_7D310[2])(IO80211Peer *__hidden this);

//----- (000000000003EECC) ----------------------------------------------------
__int64 __fastcall IO80211Peer::IO80211Peer(__int64 a1)
{
  __int64 result; // rax@1

  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  result = (__int64)off_7D310;
  *(_QWORD *)a1 = off_7D310;
  return result;
}
// 7D310: using guessed type __int64 (__fastcall *off_7D310[2])(IO80211Peer *__hidden this);

//----- (000000000003EEEC) ----------------------------------------------------
__int64 __fastcall IO80211Peer::~IO80211Peer(IO80211Peer *this)
{
  return IO80211QueueDescriptor::~IO80211QueueDescriptor(this);
}

//----- (000000000003EEF6) ----------------------------------------------------
__int64 __fastcall IO80211Peer::~IO80211Peer(IO80211Peer *this)
{
  return IO80211QueueDescriptor::~IO80211QueueDescriptor(this);
}

//----- (000000000003EF00) ----------------------------------------------------
void __fastcall IO80211Peer::~IO80211Peer(IO80211Peer *this)
{
  IO80211QueueDescriptor::~IO80211QueueDescriptor(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000003EF22) ----------------------------------------------------
__int64 __fastcall IO80211Peer::getMetaClass(IO80211Peer *this)
{
  return (__int64)&IO80211Peer::gMetaClass;
}
// 84458: using guessed type _QWORD IO80211Peer::gMetaClass;

//----- (000000000003EF30) ----------------------------------------------------
__int64 __fastcall IO80211Peer::MetaClass::MetaClass(IO80211Peer::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211Peer", &IO80211QueueDescriptor::gMetaClass, 1152LL);
  result = (__int64)off_7D4C0;
  *(_QWORD *)this = off_7D4C0;
  return result;
}
// 7D4C0: using guessed type __int64 (__fastcall *off_7D4C0[2])(IO80211Peer::MetaClass *__hidden this);
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003EF62) ----------------------------------------------------
__int64 __fastcall IO80211Peer::MetaClass::alloc(IO80211Peer::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_480, a2);
  IO80211QueueDescriptor::IO80211QueueDescriptor(v2);
  *(_QWORD *)v2 = off_7D310;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211Peer::gMetaClass);
  return v2;
}
// 480: using guessed type uuid_command stru_480;
// 7D310: using guessed type __int64 (__fastcall *off_7D310[2])(IO80211Peer *__hidden this);
// 84458: using guessed type _QWORD IO80211Peer::gMetaClass;

//----- (000000000003EFA2) ----------------------------------------------------
__int64 __fastcall IO80211Peer::IO80211Peer(__int64 a1)
{
  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  *(_QWORD *)a1 = off_7D310;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211Peer::gMetaClass);
}
// 7D310: using guessed type __int64 (__fastcall *off_7D310[2])(IO80211Peer *__hidden this);
// 84458: using guessed type _QWORD IO80211Peer::gMetaClass;

//----- (000000000003EFD2) ----------------------------------------------------
__int64 __fastcall IO80211Peer::IO80211Peer(__int64 a1)
{
  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  *(_QWORD *)a1 = off_7D310;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211Peer::gMetaClass);
}
// 7D310: using guessed type __int64 (__fastcall *off_7D310[2])(IO80211Peer *__hidden this);
// 84458: using guessed type _QWORD IO80211Peer::gMetaClass;

//----- (000000000003F002) ----------------------------------------------------
__int64 __fastcall IO80211Peer::withAddressAndManager(IO80211Peer *this, const unsigned __int8 *a2, IO80211PeerManager *a3)
{
  __int64 v3; // rbx@1

  v3 = OSObject::operator new((OSObject *)&stru_480, (unsigned __int64)a2);
  IO80211QueueDescriptor::IO80211QueueDescriptor(v3);
  *(_QWORD *)v3 = off_7D310;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211Peer::gMetaClass);
  if ( v3
    && !(unsigned __int8)(*(int (__fastcall **)(__int64, IO80211Peer *, const unsigned __int8 *))(*(_QWORD *)v3 + 320LL))(
                           v3,
                           this,
                           a2) )
  {
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
    v3 = 0LL;
  }
  return v3;
}
// 480: using guessed type uuid_command stru_480;
// 7D310: using guessed type __int64 (__fastcall *off_7D310[2])(IO80211Peer *__hidden this);
// 84458: using guessed type _QWORD IO80211Peer::gMetaClass;

//----- (000000000003F076) ----------------------------------------------------
void __fastcall IO80211Peer::addPhyStatistics(IO80211Peer *this)
{
  ;
}

//----- (000000000003F07C) ----------------------------------------------------
char __fastcall IO80211Peer::initWithAddressAndManager(IO80211Peer *this, const unsigned __int8 *a2, IO80211PeerManager *a3)
{
  IO80211PeerManager *v3; // r15@1
  unsigned __int8 v4; // al@4
  OSMetaClass *v5; // rax@5
  __int64 v6; // rax@5
  int v7; // ST28_4@5
  int v8; // ST20_4@5
  int v9; // ST18_4@5
  int v10; // ST10_4@5
  int v11; // ST08_4@5
  int v12; // ST00_4@5
  char result; // al@5

  v3 = a3;
  if ( a2 && (unsigned __int8)((int (*)(void))`vtable for'IO80211QueueDescriptor[19])() )
  {
    memcpy((char *)this + 32, a2, 6uLL);
    *((_QWORD *)this + 5) = v3;
    if ( v3 )
    {
      v4 = IO80211PeerManager::getHashTableIndex(v3, (ether_addr *)((char *)this + 32));
      *((_DWORD *)this + 62) = v4;
      *((_BYTE *)this + 12) = v4;
    }
    *((_DWORD *)this + 26) = 0;
    *((_DWORD *)this + 28) = -1;
    *((_DWORD *)this + 27) = 0;
    *((_BYTE *)this + 475) = 0;
    *((_DWORD *)this + 114) = *((_BYTE *)v3 + 553);
    *((_BYTE *)this + 474) = 0;
    LODWORD(v5) = (*(int (__fastcall **)(IO80211Peer *))(*(_QWORD *)this + 56LL))(this);
    v6 = OSMetaClass::getClassName(v5);
    v7 = *((_BYTE *)this + 12);
    v8 = a2[5];
    v9 = a2[4];
    v10 = a2[3];
    v11 = a2[2];
    v12 = a2[1];
    IO80211Peer::logDebug(
      this,
      0x200000000LL,
      "%s::%s()  Creating Peer: %02x:%02x:%02x:%02x:%02x:%02x hash(peerID) %u\n",
      v6,
      (__int64)"initWithAddressAndManager",
      *a2);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 822A0: using guessed type __int64 `vtable for'IO80211QueueDescriptor[2];

//----- (000000000003F1A0) ----------------------------------------------------
__int64 __fastcall IO80211Peer::logDebug(IO80211Peer *this, __int64 a2, const char *a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // rbx@1
  char v8; // [sp+0h] [bp-60h]@2
  __int64 v9; // [sp+18h] [bp-48h]@1
  __int64 v10; // [sp+20h] [bp-40h]@1
  __int64 v11; // [sp+28h] [bp-38h]@1
  __va_list_tag v12; // [sp+30h] [bp-30h]@2
  __int64 v13; // [sp+50h] [bp-10h]@1
  char v14; // [sp+70h] [bp+10h]@0

  v11 = a6;
  v10 = a5;
  v9 = a4;
  v6 = off_7B078[0];
  v13 = *(_QWORD *)off_7B078[0];
  if ( *((_QWORD *)this + 5) )
  {
    v12.reg_save_area = &v8;
    v12.overflow_arg_area = &v14;
    v12.fp_offset = 48;
    v12.gp_offset = 24;
    IO80211PeerManager::vlogDebug(*((IO80211PeerManager **)this + 5), a2, a3, &v12);
  }
  return *(_QWORD *)v6;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000003F20A) ----------------------------------------------------
__int64 __fastcall IO80211Peer::doCreditGrant(IO80211Peer *this, __int64 a2)
{
  int v2; // edx@1
  int v3; // ecx@2
  int v4; // eax@2
  int v5; // eax@5

  v2 = *(_DWORD *)(a2 + 16);
  if ( v2 )
  {
    v3 = *(_DWORD *)(a2 + 8);
    v4 = *(_DWORD *)(a2 + 12);
    if ( v2 == 2 )
    {
      if ( v3 == 1 )
        *((_DWORD *)this + 27) -= v4;
      else
        *((_DWORD *)this + 28) -= v4;
    }
    else if ( v3 == 1 )
    {
      *((_DWORD *)this + 27) += v4;
    }
    else
    {
      *((_DWORD *)this + 28) += v4;
    }
  }
  else
  {
    v5 = *(_DWORD *)(a2 + 12);
    if ( *(_DWORD *)(a2 + 8) == 1 )
      *((_DWORD *)this + 27) = v5;
    else
      *((_DWORD *)this + 28) = v5;
  }
  *((_QWORD *)this + 18) = getAbsoluteTime();
  return IO80211Peer::updateRequestBitField(this);
}

//----- (000000000003F26E) ----------------------------------------------------
__int64 __fastcall IO80211Peer::updateRequestBitField(IO80211Peer *this)
{
  unsigned int v1; // er14@1
  int v2; // ebx@1
  signed int v3; // edx@3

  v1 = 0;
  v2 = 0;
  do
  {
    if ( (unsigned __int8)(*(int (__fastcall **)(IO80211Peer *, _QWORD, signed __int64))(*(_QWORD *)this + 384LL))(
                            this,
                            (unsigned __int8)v2,
                            1LL) )
    {
      v3 = 1 << v2;
      if ( *(IO80211Peer **)(*((_QWORD *)this + 5) + 72LL) == this )
        v3 = 16;
      v1 |= v3;
    }
    ++v2;
  }
  while ( v2 != 4 );
  return v1;
}

//----- (000000000003F2CA) ----------------------------------------------------
char __fastcall IO80211Peer::cacheControlPending(IO80211Peer *this, void *a2)
{
  void *v2; // r14@1
  __int64 v3; // r15@1
  char result; // al@5
  OSMetaClass *v5; // rax@7
  __int64 v6; // rax@7
  char *v7; // r15@7
  int v8; // ST10_4@7
  int v9; // ST08_4@7
  int v10; // ST00_4@7
  char *v11; // rsi@9
  signed int v12; // eax@9
  bool v13; // zf@12
  char v14; // al@13
  OSMetaClass *v15; // rax@15
  __int64 v16; // rax@15
  int v17; // ST20_4@15
  int v18; // ST18_4@15
  int v19; // ST10_4@15
  int v20; // ST08_4@15
  int v21; // ST00_4@15

  v2 = a2;
  v3 = *((_QWORD *)this + 23);
  if ( v3
    && (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v3)) >> 64) >> 18) < 0x3E8
    || !*((_BYTE *)this + 476) && *((_BYTE *)this + 522) )
  {
    result = 0;
  }
  else
  {
    if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)this + 5), 0x200000000LL) )
    {
      LODWORD(v5) = (*(int (__fastcall **)(IO80211Peer *, signed __int64))(*(_QWORD *)this + 56LL))(this, 0x200000000LL);
      v6 = OSMetaClass::getClassName(v5);
      v7 = (char *)this + 428;
      v8 = *((_BYTE *)this + 428);
      v9 = *((_BYTE *)this + 475);
      v10 = *((_BYTE *)this + 522);
      IO80211Peer::logDebug(
        this,
        0x200000000LL,
        "%s::%s %p cached %u ampdu %u ht %u\n",
        v6,
        (__int64)"cacheControlPending",
        (__int64)a2);
    }
    else
    {
      v7 = (char *)this + 428;
    }
    v11 = 0LL;
    memset(v2, 0, 0x3CuLL);
    *(_DWORD *)v2 = 1;
    *((_WORD *)v2 + 6) = *((_WORD *)this + 18);
    *((_DWORD *)v2 + 2) = *((_DWORD *)this + 8);
    v12 = 6;
    if ( !*((_BYTE *)this + 522) )
      v12 = 0;
    *((_DWORD *)v2 + 1) = v12;
    if ( *((_BYTE *)this + 428) )
    {
      v11 = v7;
      memcpy((char *)v2 + 16, v7, 0x1CuLL);
      v13 = *((_DWORD *)this + 114) == 0;
      *((_BYTE *)this + 475) = *((_DWORD *)this + 114) != 0;
      *((_BYTE *)v2 + 44) = !v13;
    }
    v14 = *((_BYTE *)this + 474);
    *((_BYTE *)v2 + 45) = v14;
    if ( v14 )
    {
      v11 = (char *)this + 460;
      memcpy((char *)v2 + 46, (char *)this + 460, 0xEuLL);
    }
    *((_DWORD *)this + 132) = 0;
    *((_QWORD *)this + 23) = getAbsoluteTime();
    LODWORD(v15) = (*(int (__fastcall **)(IO80211Peer *, char *))(*(_QWORD *)this + 56LL))(this, v11);
    v16 = OSMetaClass::getClassName(v15);
    v17 = *((_BYTE *)this + 37);
    v18 = *((_BYTE *)this + 36);
    v19 = *((_BYTE *)this + 35);
    v20 = *((_BYTE *)this + 34);
    v21 = *((_BYTE *)this + 33);
    IO80211Peer::logDebug(
      this,
      0x400000000LL,
      "%s::%s _lastCacheAddAttempt now [%02X:%02X:%02X:%02X:%02X:%02X]\n",
      v16,
      (__int64)"cacheControlPending",
      *((_BYTE *)this + 32));
    *((_BYTE *)this + 476) = 0;
    result = 1;
  }
  return result;
}

//----- (000000000003F4C2) ----------------------------------------------------
__int64 __fastcall IO80211Peer::parseHTCapTLV(IO80211Peer *this, unsigned __int8 *a2, unsigned int a3)
{
  unsigned int v3; // er12@1
  IO80211Peer *v4; // r15@1
  unsigned __int8 *v5; // rdi@1
  signed __int64 v6; // rsi@1
  int v7; // eax@1
  __int64 v8; // rdx@1
  unsigned int v9; // er14@1
  __int64 v10; // rcx@1
  OSMetaClass *v11; // rax@2
  __int64 v12; // rax@2
  __int64 v13; // rdx@4
  unsigned int v14; // ebx@6
  __int64 result; // rax@6
  OSMetaClass *v16; // rax@8
  __int64 v17; // rax@8
  __int64 v18; // rcx@9
  __int64 v19; // r8@9
  __int64 v20; // r9@9
  __int64 v21; // rcx@9
  __int64 v22; // r8@9
  __int64 v23; // r9@9
  __int64 v24; // rbx@10
  const void *v25; // [sp+10h] [bp-40h]@1
  unsigned __int8 *v26; // [sp+18h] [bp-38h]@1
  size_t v27; // [sp+20h] [bp-30h]@1

  v3 = a3;
  v26 = a2;
  v4 = this;
  v25 = (char *)this + 430;
  v27 = a3;
  v5 = a2;
  v6 = (signed __int64)v25;
  v7 = memcmp(v5, v25, a3);
  v9 = 0;
  v10 = 0LL;
  if ( v7 )
  {
    LODWORD(v11) = (*(int (__fastcall **)(IO80211Peer *, const void *, __int64, _QWORD))(*(_QWORD *)v4 + 56LL))(
                     v4,
                     v25,
                     v8,
                     0LL);
    v12 = OSMetaClass::getClassName(v11);
    v6 = 0x200000000LL;
    IO80211Peer::logDebug(
      v4,
      0x200000000LL,
      "%s::%s HT IE val seems to have changed (length %u)\n",
      v12,
      (__int64)"parseHTCapTLV",
      v3);
    LOBYTE(v10) = 1;
  }
  if ( v3 == 26 )
  {
LABEL_6:
    v14 = v3;
    result = 0LL;
    if ( !(_BYTE)v10 )
      return result;
  }
  else
  {
    while ( 1 )
    {
      v13 = v3 + v9;
      if ( *((_BYTE *)v4 + v13 + 430) )
        break;
      ++v9;
      if ( v9 >= 26 - v27 )
        goto LABEL_6;
    }
    LODWORD(v16) = (*(int (__fastcall **)(IO80211Peer *, signed __int64, __int64, __int64))(*(_QWORD *)v4 + 56LL))(
                     v4,
                     v6,
                     v13,
                     v10);
    v17 = OSMetaClass::getClassName(v16);
    v14 = v3;
    IO80211Peer::logDebug(
      v4,
      0x200000000LL,
      "%s::%s HT IE length seems to have changed i=%i len %u size %u\n",
      v17,
      (__int64)"parseHTCapTLV",
      v9);
  }
  memset((char *)v4 + 428, 0, 0x1CuLL);
  *((_WORD *)v4 + 214) = 6701;
  memcpy((void *)v25, v26, v27);
  IO80211Peer::logDebug(v4, 0x200000000LL, "HT IE: old -> new \n", v18, v19, v20);
  if ( v14 )
  {
    v24 = 0LL;
    do
    {
      IO80211Peer::logDebug(v4, 0x200000000LL, "[%02x -> %02x] ", *((_BYTE *)v4 + v24 + 430), v26[v24], v23);
      ++v24;
    }
    while ( (_DWORD)v27 != (_DWORD)v24 );
  }
  IO80211Peer::logDebug(v4, 0x200000000LL, "\n", v21, v22, v23);
  return 1LL;
}

//----- (000000000003F66E) ----------------------------------------------------
__int64 __fastcall IO80211Peer::parseVhtCapTLV(IO80211Peer *this, void *a2)
{
  char *v2; // r14@1
  int v3; // ecx@1
  __int64 result; // rax@1
  OSMetaClass *v5; // rax@3
  __int64 v6; // rax@3
  __int64 v7; // r9@3
  __int64 v8; // r9@3
  __int64 v9; // r14@3
  __int64 v10; // rcx@4
  __int64 v11; // r8@4

  v2 = (char *)this + 460;
  v3 = memcmp(a2, (char *)this + 460, 0xCuLL);
  result = 0LL;
  if ( v3 )
  {
    if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)this + 5), 0x200000000LL) )
    {
      LODWORD(v5) = (*(int (__fastcall **)(IO80211Peer *, signed __int64))(*(_QWORD *)this + 56LL))(this, 0x200000000LL);
      v6 = OSMetaClass::getClassName(v5);
      IO80211Peer::logDebug(
        this,
        0x200000000LL,
        "%s::%s VHT Cap IE val seems to have changed\n",
        v6,
        (__int64)"parseVhtCapTLV",
        v7);
      v9 = 0LL;
      do
      {
        IO80211Peer::logDebug(
          this,
          0x200000000LL,
          "[%02x -> %02x] ",
          *((_BYTE *)this + v9 + 460),
          *((_BYTE *)a2 + v9),
          v8);
        ++v9;
      }
      while ( v9 != 12 );
      IO80211Peer::logDebug(this, 0x200000000LL, "\n", v10, v11, v8);
      v2 = (char *)this + 460;
    }
    *((_BYTE *)this + 474) = 1;
    memcpy(v2, a2, 0xEuLL);
    result = 1LL;
  }
  return result;
}

//----- (000000000003F766) ----------------------------------------------------
__int64 __fastcall IO80211Peer::doCacheControl(IO80211Peer *this, __int64 a2)
{
  int v2; // eax@9
  OSMetaClass *v3; // rax@10
  __int64 v4; // rax@10
  int v5; // ST20_4@10
  int v6; // ST18_4@10
  int v7; // ST10_4@10
  int v8; // ST08_4@10
  int v9; // ST00_4@10

  if ( *(_DWORD *)(a2 + 4) == 1 )
  {
    if ( *(_BYTE *)(a2 + 16) == 45 )
      memcpy((char *)this + 428, (const void *)(a2 + 16), 0x1CuLL);
    *((_BYTE *)this + 475) = *(_BYTE *)(a2 + 44) != 0;
  }
  if ( *(_BYTE *)(a2 + 45) && *(_BYTE *)(a2 + 46) == 191 && *(_BYTE *)(a2 + 47) == 12 )
  {
    memcpy((char *)this + 460, (const void *)(a2 + 46), 0xEuLL);
    *((_BYTE *)this + 474) = 1;
  }
  v2 = *(_DWORD *)(a2 + 4);
  if ( v2 == 3 )
  {
    *((_BYTE *)this + 522) = 0;
    *((_WORD *)this + 260) = 0;
    *((_BYTE *)this + 477) = 0;
    LODWORD(v3) = (*(int (__fastcall **)(IO80211Peer *))(*(_QWORD *)this + 56LL))(this);
    v4 = OSMetaClass::getClassName(v3);
    v5 = *((_BYTE *)this + 37);
    v6 = *((_BYTE *)this + 36);
    v7 = *((_BYTE *)this + 35);
    v8 = *((_BYTE *)this + 34);
    v9 = *((_BYTE *)this + 33);
    IO80211Peer::logDebug(
      this,
      0x200000000LL,
      "%s::%s uncache peer [%02X:%02X:%02X:%02X:%02X:%02X], don't flush queues\n",
      v4,
      (__int64)"doCacheControl",
      *((_BYTE *)this + 32));
  }
  else if ( v2 == 1 )
  {
    *((_BYTE *)this + 522) = 1;
    *((_BYTE *)this + 477) = 1;
    *((_WORD *)this + 260) = *(_WORD *)(a2 + 14);
    *((_DWORD *)this + 26) = 0;
    return IO80211Peer::updateRequestBitField(this);
  }
  return 0LL;
}

//----- (000000000003F8B2) ----------------------------------------------------
__int64 __fastcall IO80211Peer::findPacketDescriptor(IO80211Peer *this, __mbuf *a2)
{
  return 0LL;
}

//----- (000000000003F8BA) ----------------------------------------------------
char IO80211Peer::transmitSuccess()
{
  return 1;
}

//----- (000000000003F8C2) ----------------------------------------------------
char __fastcall IO80211Peer::prepareForTransmit(IO80211Peer *this, IO80211PacketDescriptor *a2)
{
  return 1;
}

//----- (000000000003F8CA) ----------------------------------------------------
__int64 __fastcall IO80211Peer::reset(IO80211Peer *this)
{
  *((_BYTE *)this + 522) = 0;
  *((_BYTE *)this + 476) = 1;
  *((_WORD *)this + 260) = 0;
  *((_BYTE *)this + 477) = 0;
  IO80211Peer::reclaimPackets(this);
  return 0LL;
}

//----- (000000000003F8F6) ----------------------------------------------------
__int64 __fastcall IO80211Peer::reclaimPackets(IO80211Peer *this)
{
  __int64 v1; // r12@1
  signed __int64 v2; // rbx@1
  IO80211CommandQueue *v3; // rdi@2
  IO80211PeerManager *v4; // r14@5
  OSMetaClass *v5; // rax@5
  __int64 v6; // rax@5
  __int64 v7; // r9@5
  unsigned int v9; // [sp+Ch] [bp-24h]@1

  v1 = (__int64)this;
  v9 = 0;
  v2 = 6LL;
  do
  {
    v3 = *(IO80211CommandQueue **)(v1 + 8 * v2);
    if ( v3 )
      IO80211CommandQueue::lockMap(
        v3,
        (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_reclaimPackets,
        v1,
        (__int64)&v9,
        0LL,
        -1);
    ++v2;
  }
  while ( v2 != 10 );
  v4 = *(IO80211PeerManager **)(v1 + 40);
  LODWORD(v5) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v1 + 56LL))(v1);
  v6 = OSMetaClass::getClassName(v5);
  return IO80211PeerManager::logDebug(
           v4,
           "%s::%s Reclaimed %d packets from firmware\n",
           v6,
           (__int64)"reclaimPackets",
           v9,
           v7);
}

//----- (000000000003F98C) ----------------------------------------------------
int __fastcall IO80211Peer::freeResources(IO80211Peer *this)
{
  return IO80211Peer::flushQueues(this, 0);
}

//----- (000000000003F998) ----------------------------------------------------
int __fastcall IO80211Peer::flushQueues(IO80211Peer *this, int a2)
{
  IO80211Peer *v2; // rbx@1
  __int64 (__fastcall *v3)(__int64, __int64); // rax@1
  __int64 v4; // r12@1
  IO80211CommandQueue *v5; // rdi@2
  OSMetaClass *v6; // rax@3
  __int64 v7; // r13@3
  __int64 v8; // rdi@3
  __int64 v9; // r15@3
  __int64 v10; // rdx@3
  __int64 v12; // [sp+20h] [bp-80h]@1
  __int64 v13; // [sp+28h] [bp-78h]@1
  __int64 (__fastcall *v14)(__int64, __int64); // [sp+30h] [bp-70h]@1
  __int64 v15; // [sp+38h] [bp-68h]@1
  __int64 v16; // [sp+40h] [bp-60h]@1
  __int64 v17; // [sp+48h] [bp-58h]@1
  __int64 v18; // [sp+50h] [bp-50h]@1
  __int64 v19; // [sp+58h] [bp-48h]@1
  __int64 v20; // [sp+60h] [bp-40h]@1
  __int64 v21; // [sp+68h] [bp-38h]@1
  int v22; // [sp+74h] [bp-2Ch]@1

  v2 = this;
  v22 = a2;
  v21 = 0LL;
  v20 = 0LL;
  v19 = 0LL;
  v18 = 0LL;
  v17 = 0LL;
  v16 = 0LL;
  v15 = 0LL;
  v13 = 0LL;
  v12 = 0LL;
  v3 = _addToFlushList;
  v14 = _addToFlushList;
  v4 = 0LL;
  do
  {
    v5 = (IO80211CommandQueue *)*((_QWORD *)v2 + v4 + 6);
    if ( v5 )
    {
      IO80211CommandQueue::lockMap(
        v5,
        (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_flushQueues,
        (__int64)v2,
        (__int64)&v22,
        (__int64)&v12,
        -1);
      LODWORD(v6) = (*(int (__fastcall **)(IO80211Peer *, __int64 (__fastcall *)(IO80211Peer *, void *, __int64)))(*(_QWORD *)v2 + 56LL))(
                      v2,
                      _flushQueues);
      v7 = OSMetaClass::getClassName(v6);
      vm_kernel_addrperm_addr(*((void **)v2 + v4 + 6));
      v8 = *((_QWORD *)v2 + v4 + 6);
      v9 = *(_DWORD *)(v8 + 52);
      (*(void (__cdecl **)(__int64, __int64 (__fastcall *)(IO80211Peer *, void *, __int64), __int64))(*(_QWORD *)v8 + 24LL))(
        v8,
        _flushQueues,
        v10);
      LODWORD(v3) = IO80211Peer::logDebug(
                      v2,
                      0x400000000LL,
                      "%s::%s --ac %u packets queue %p size %u retaincount %u\n",
                      v7,
                      (__int64)"flushQueues",
                      (unsigned int)v4);
      if ( !v22 )
      {
        IO80211CommandQueue::releaseResources(*((IO80211CommandQueue **)v2 + v4 + 6));
        LODWORD(v3) = (*(int (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)v2 + v4 + 6) + 40LL))(
                        *((_QWORD *)v2 + v4 + 6),
                        0x400000000LL);
        *((_QWORD *)v2 + v4 + 6) = 0LL;
      }
    }
    ++v4;
  }
  while ( v4 != 4 );
  return (signed int)v3;
}

//----- (000000000003FADD) ----------------------------------------------------
__int64 __fastcall _reclaimPackets(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int16 v4; // ax@2
  IO80211PeerManager *v5; // r15@3
  __int64 v6; // rdx@3
  __int64 v7; // r9@3
  __int64 v8; // rcx@3
  __int64 v9; // r8@5

  v3 = a3;
  if ( a2 )
  {
    v4 = *(_WORD *)(a2 + 48);
    if ( v4 & 0x201 )
    {
      v5 = *(IO80211PeerManager **)(a1 + 40);
      v6 = (__int64)vm_kernel_addrperm_addr(*(void **)(a2 + 32));
      v8 = (__int64)"Waiting TX. ";
      if ( !(*(_WORD *)(a2 + 48) & 1) )
        v8 = (__int64)&byte_690F5;
      v9 = (__int64)"Mbuf In Use. ";
      if ( !((unsigned __int16)(*(_WORD *)(a2 + 48) & 0x200) >> 9) )
        v9 = (__int64)&byte_690F5;
      IO80211PeerManager::logDebug(v5, "WARN: _reclaimPackets. m=%p. %s%s\n", v6, v8, v9, v7);
      v4 = *(_WORD *)(a2 + 48);
    }
    *(_WORD *)(a2 + 48) = v4 & 0xFFFE;
  }
  if ( v3 )
    ++*(_DWORD *)v3;
  return 0LL;
}
// 690F5: using guessed type char byte_690F5;

//----- (000000000003FB6E) ----------------------------------------------------
__int64 __fastcall IO80211Peer::logDebug(IO80211Peer *this, const char *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // rbx@1
  char v8; // [sp+0h] [bp-60h]@2
  __int64 v9; // [sp+10h] [bp-50h]@1
  __int64 v10; // [sp+18h] [bp-48h]@1
  __int64 v11; // [sp+20h] [bp-40h]@1
  __int64 v12; // [sp+28h] [bp-38h]@1
  __va_list_tag v13; // [sp+30h] [bp-30h]@2
  __int64 v14; // [sp+50h] [bp-10h]@1
  char v15; // [sp+70h] [bp+10h]@0

  v12 = a6;
  v11 = a5;
  v10 = a4;
  v9 = a3;
  v6 = off_7B078[0];
  v14 = *(_QWORD *)off_7B078[0];
  if ( *((_QWORD *)this + 5) )
  {
    v13.reg_save_area = &v8;
    v13.overflow_arg_area = &v15;
    v13.fp_offset = 48;
    v13.gp_offset = 16;
    IO80211PeerManager::vlogDebug(*((IO80211PeerManager **)this + 5), 0LL, a2, &v13);
  }
  return *(_QWORD *)v6;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000003FBE4) ----------------------------------------------------
__int64 __fastcall _addToFlushList(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rsi@1
  __int64 v4; // rax@4

  v2 = a2;
  v3 = *(_BYTE *)(a2 + 40);
  if ( !(*(_BYTE *)(v2 + 48) & 1) && *(_WORD *)(a1 + 2 * v3 + 80) )
  {
    if ( *(_BYTE *)(a1 + v3 + 478) )
    {
      v4 = *(_QWORD *)(a1 + 8 * v3 + 48);
      if ( v4 )
      {
        if ( (unsigned __int16)(*(_DWORD *)(v4 + 52) - *(_WORD *)(a1 + 2 * v3 + 80)) == 1 )
          *(_BYTE *)(a1 + v3 + 478) = 0;
      }
    }
    (*(void (__fastcall **)(__int64, __int64, signed __int64))(*(_QWORD *)a1 + 376LL))(a1, v3, 0xFFFFFFFFLL);
  }
  IO80211PeerManager::doFreePacket(*(IO80211PeerManager **)(a1 + 40), (IO80211PacketDescriptor *)v2);
  return 0LL;
}

//----- (000000000003FC59) ----------------------------------------------------
__int64 __fastcall _flushQueues(IO80211Peer *this, void *a2, __int64 a3)
{
  __int64 v3; // r13@1
  unsigned __int64 v4; // r14@1
  signed int v5; // er12@2
  __int64 v6; // STC8_8@3
  int v7; // STB4_4@3
  int v8; // STB0_4@3
  int v9; // STAC_4@3
  int v10; // STA8_4@3
  int v11; // STA4_4@3
  int v12; // STA0_4@3
  __int64 v13; // STB8_8@3
  int v14; // ST8C_4@3
  __int64 v15; // r13@3
  __int64 v16; // ST58_8@3
  int v17; // STB4_4@5
  int v18; // STB0_4@5
  int v19; // STAC_4@5
  int v20; // STA8_4@5
  int v21; // STA0_4@5
  int v22; // ST98_4@5
  __int64 v23; // STC0_8@5
  __int64 v24; // STB8_8@5
  int v25; // STA4_4@5
  __int64 v26; // r13@5
  __int64 v27; // ST48_8@5

  v3 = *(_DWORD *)a3;
  v4 = getAbsoluteTime();
  if ( v4 <= 1000000 * v3 + *((_QWORD *)a2 + 9) )
  {
    v5 = 0;
    if ( !(_DWORD)v3 )
    {
      v17 = *((_BYTE *)this + 32);
      v18 = *((_BYTE *)this + 33);
      v19 = *((_BYTE *)this + 34);
      v20 = *((_BYTE *)this + 35);
      v21 = *((_BYTE *)this + 36);
      v22 = *((_BYTE *)this + 37);
      v23 = (__int64)vm_kernel_addrperm_addr(a2);
      v24 = (__int64)vm_kernel_addrperm_addr(*((void **)a2 + 4));
      v25 = *((_WORD *)a2 + 24);
      v26 = *((_QWORD *)a2 + 9);
      getAbsoluteTime();
      v27 = *((_QWORD *)a2 + 9);
      IO80211Peer::logDebug(
        this,
        "flushQueue ERROR:: %llu.%03llu Found a packet in the future!! force flushing pkt %p m=%p flags %x ms %u [%02X:%02X:%02X:%02X:%02X:%02X] now %llu stamp %llu ns %llu [%02X:%02X:%02X:%02X:%02X:%02X]\n",
        19342813113834067LL * (v4 >> 9) >> 64 >> 11,
        4835703278458516699LL * (v4 - 1000000000 * (19342813113834067LL * (v4 >> 9) >> 64 >> 11)) >> 64 >> 18,
        v23,
        v24);
      v5 = 12;
    }
  }
  else
  {
    v5 = 12;
    if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)this + 5), 256LL) )
    {
      v6 = 19342813113834067LL * (v4 >> 9) >> 64 >> 11;
      v7 = *((_BYTE *)this + 32);
      v8 = *((_BYTE *)this + 33);
      v9 = *((_BYTE *)this + 34);
      v10 = *((_BYTE *)this + 35);
      v11 = *((_BYTE *)this + 36);
      v12 = *((_BYTE *)this + 37);
      v13 = (__int64)IO80211PeerManager::getBSDName(*((IO80211PeerManager **)this + 5));
      vm_kernel_addrperm_addr(a2);
      vm_kernel_addrperm_addr(*((void **)a2 + 4));
      v14 = *((_WORD *)a2 + 24);
      v15 = *((_QWORD *)a2 + 9);
      getAbsoluteTime();
      v16 = *((_QWORD *)a2 + 9);
      IO80211Peer::logDebug(
        this,
        256LL,
        "%llu.%03llu <%s> flushing pkt %p m=%p flags %x ms %u [%02X:%02X:%02X:%02X:%02X:%02X] now %llu stamp %llu ns %llu\n",
        v6,
        4835703278458516699LL * (v4 - 1000000000 * v6) >> 64 >> 18,
        v13);
    }
  }
  return (unsigned int)v5;
}

//----- (000000000003FF4E) ----------------------------------------------------
__int64 __fastcall IO80211Peer::doTransmitStatus(IO80211Peer *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r13@1
  __int64 v5; // r15@1
  __int64 v6; // rbx@1
  IO80211Peer *v7; // r14@1
  __int64 v8; // r12@1
  int v9; // eax@2
  __int64 v10; // rsi@8
  __int64 v11; // rdx@8
  __int64 v12; // rax@8
  signed __int16 v13; // cx@8
  char v14; // al@11
  signed int v15; // ebx@16
  signed int v16; // eax@19
  __int64 v17; // r12@22
  __int64 v18; // rax@33
  IO80211VirtualInterface *v19; // rdi@33
  __int64 v20; // rax@34
  __int64 v21; // rdx@36
  __int64 v22; // r9@36
  int v23; // ST94_4@38
  int v24; // ST90_4@38
  int v25; // ST8C_4@38
  int v26; // ST88_4@38
  int v27; // ST84_4@38
  int v28; // er8@38
  int v29; // er13@38
  int v30; // er10@38
  __int64 v31; // rcx@38
  int v32; // esi@39
  int v33; // ebx@40
  int v34; // er11@40
  int v35; // ecx@41
  int v36; // er12@41
  __int64 v37; // rdi@41
  unsigned __int64 v38; // ST78_8@42
  __int64 v39; // rax@46
  __int64 v40; // r8@46
  __int64 v41; // r9@46
  char v42; // r13@46
  __int64 v43; // rcx@46
  __int64 v44; // rax@47
  __int64 v45; // rax@49
  __int64 v46; // r9@49
  __int64 v47; // r12@52
  signed int v48; // eax@54
  __int64 v49; // rbx@59
  char v50; // al@59
  __int64 v51; // rcx@59
  char v52; // dl@59
  __int64 v53; // rdi@59
  int v54; // eax@59
  char v55; // r13@60
  int v56; // ecx@61
  __int64 v57; // rdx@64
  __int64 v58; // rax@67
  __int64 v59; // r8@69
  __int64 v60; // rax@69
  __int64 v61; // r9@69
  int v62; // ebx@71
  const void *v63; // rsi@81
  __int64 v64; // rax@84
  __int64 v65; // rax@86
  int v66; // eax@87
  __int64 v67; // rax@89
  int v68; // eax@90
  __int64 v69; // rax@92
  int v70; // eax@93
  __int64 v71; // rax@95
  int v72; // eax@96
  IO80211PeerManager *v73; // rdi@98
  int v74; // eax@98
  bool v75; // al@99
  __int64 v76; // rcx@99
  signed int v77; // ecx@103
  __int64 v78; // rsi@106
  __int64 v80; // [sp+A0h] [bp-120h]@38
  __int64 v81; // [sp+A8h] [bp-118h]@38
  bool v82; // [sp+A8h] [bp-118h]@44
  __int64 v83; // [sp+B0h] [bp-110h]@36
  __int64 v84; // [sp+B0h] [bp-110h]@44
  __int64 v85; // [sp+B8h] [bp-108h]@11
  __int64 v86; // [sp+B8h] [bp-108h]@59
  int v87; // [sp+C4h] [bp-FCh]@4
  char v88; // [sp+C8h] [bp-F8h]@98
  int v89; // [sp+CCh] [bp-F4h]@98
  int v90; // [sp+D0h] [bp-F0h]@98
  __mbuf *v91; // [sp+D8h] [bp-E8h]@98
  int v92; // [sp+E0h] [bp-E0h]@98
  int v93; // [sp+E4h] [bp-DCh]@98
  __int64 v94; // [sp+E8h] [bp-D8h]@98
  char *v95; // [sp+F0h] [bp-D0h]@98
  __int64 v96; // [sp+F8h] [bp-C8h]@98
  __int64 v97; // [sp+100h] [bp-C0h]@98
  __int64 v98; // [sp+108h] [bp-B8h]@98
  __int64 v99; // [sp+110h] [bp-B0h]@98
  __int64 v100; // [sp+118h] [bp-A8h]@98
  __int64 v101; // [sp+120h] [bp-A0h]@98
  char v102; // [sp+128h] [bp-98h]@82
  char v103; // [sp+15Ah] [bp-66h]@84
  char v104; // [sp+15Ch] [bp-64h]@84
  char v105; // [sp+15Dh] [bp-63h]@84
  int v106; // [sp+15Eh] [bp-62h]@84
  int v107; // [sp+162h] [bp-5Eh]@84
  int v108; // [sp+166h] [bp-5Ah]@84
  __int64 v109; // [sp+16Ah] [bp-56h]@84
  __int64 v110; // [sp+172h] [bp-4Eh]@84
  int v111; // [sp+17Ah] [bp-46h]@84
  __int16 v112; // [sp+17Eh] [bp-42h]@89
  __int16 v113; // [sp+180h] [bp-40h]@92
  __int16 v114; // [sp+182h] [bp-3Eh]@95
  __int16 v115; // [sp+184h] [bp-3Ch]@98
  __int16 v116; // [sp+186h] [bp-3Ah]@98
  __int16 v117; // [sp+188h] [bp-38h]@98
  __int16 v118; // [sp+18Ah] [bp-36h]@98
  __int16 v119; // [sp+18Ch] [bp-34h]@98
  __int16 v120; // [sp+18Eh] [bp-32h]@98
  __int16 v121; // [sp+190h] [bp-30h]@98
  __int16 v122; // [sp+192h] [bp-2Eh]@98
  __int16 v123; // [sp+194h] [bp-2Ch]@98

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = this;
  v8 = *(_QWORD *)a3;
  if ( *(_QWORD *)a3 )
    v9 = mbuf_get_traffic_class(*(_QWORD *)a3);
  else
    v9 = *(_BYTE *)(*(_QWORD *)(a3 + 24) + 45LL);
  v87 = v9;
  if ( *(_DWORD *)(*((_QWORD *)this + 5) + 928LL) && *((_DWORD *)this + 26) && !*(_DWORD *)(v5 + 8) )
    *(_DWORD *)(v5 + 8) = -536772087;
  v10 = *(_BYTE *)(a2 + 40);
  *(_QWORD *)(v5 + 16) = v6;
  v11 = *(_WORD *)(v6 + 48) & 0xFFFE;
  *(_WORD *)(v6 + 48) = v11;
  *(_DWORD *)(v6 + 80) = *(_DWORD *)(v5 + 8);
  v12 = *(_QWORD *)(v5 + 24);
  v13 = -1;
  if ( v12 )
    v13 = *(_WORD *)(v12 + 48);
  *(_WORD *)(v6 + 58) = v13;
  *(_QWORD *)(v5 + 40) = *(_QWORD *)(v4 + 72) - *(_QWORD *)(v6 + 64);
  if ( v8 )
  {
    v85 = v10;
    v14 = mbuf_pkthdr_rcvif(v8, v10, v11);
    LOWORD(v11) = *(_WORD *)(v6 + 48);
  }
  else
  {
    v85 = v10;
    v14 = *(_BYTE *)(v12 + 44);
  }
  *((_BYTE *)this + 116) = v14 & 1;
  if ( v11 & 0x20 )
  {
    ++*((_DWORD *)this + 27);
    *(_DWORD *)(v5 + 52) |= 1 << v87;
  }
  ++*((_DWORD *)this + 52);
  if ( v11 & 0x201 )
  {
    *(_BYTE *)(v5 + 32) = 0;
    v15 = 1;
    return (unsigned int)v15;
  }
  if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)this + 5), 0x80000000000LL)
    || IO80211PeerManager::shouldLog(*((IO80211PeerManager **)this + 5), 0x400000000LL) )
  {
    v16 = *(_DWORD *)(v6 + 80);
    if ( v16 >= 0 )
    {
      if ( !v16 )
      {
        v17 = (__int64)"OK    ";
        goto LABEL_33;
      }
    }
    else if ( v16 > -536772097 )
    {
      if ( v16 <= -536772084 )
      {
        switch ( v16 + 536772096 )
        {
          case 0:
            v17 = (__int64)"TxFail";
            break;
          default:
            goto LABEL_32;
          case 2:
            v17 = (__int64)"NoACK ";
            break;
          case 6:
            v17 = (__int64)"Expire";
            break;
          case 9:
            v17 = (__int64)"NoBuff";
            break;
        }
        goto LABEL_33;
      }
      if ( v16 == -536772083 )
      {
        v17 = (__int64)"NoRess";
        goto LABEL_33;
      }
    }
    else
    {
      if ( v16 == -536870199 )
      {
        v17 = (__int64)"IntErr";
LABEL_33:
        v18 = *((_QWORD *)this + 5);
        v19 = *(IO80211VirtualInterface **)(v18 + 128);
        if ( v19 )
          v20 = (__int64)IO80211VirtualInterface::getBSDName(v19);
        else
          v20 = (__int64)IO80211Interface::getBSDName(*(IO80211Interface **)(v18 + 136), v18);
        v83 = v4;
        v21 = *(_QWORD *)(v5 + 24);
        v22 = 0LL;
        if ( v21 )
          v22 = *(_BYTE *)(v21 + 46);
        v80 = v17;
        v23 = *(_DWORD *)(v5 + 8);
        v24 = *((_BYTE *)v7 + 32);
        v25 = *((_BYTE *)v7 + 33);
        v26 = *((_BYTE *)v7 + 34);
        v27 = *((_BYTE *)v7 + 35);
        v28 = *((_BYTE *)v7 + 36);
        v29 = *((_BYTE *)v7 + 37);
        v30 = *(_BYTE *)(v6 + 41);
        v81 = v6;
        v31 = *((_QWORD *)v7 + (unsigned int)v87 + 6);
        if ( v31 )
        {
          v32 = *(_DWORD *)(v31 + 52);
          v21 = *(_QWORD *)(v5 + 24);
        }
        v33 = *((_WORD *)v7 + v85 + 40);
        v34 = *(_DWORD *)(v5 + 52);
        if ( v21 )
        {
          v35 = *(_WORD *)v21;
          v36 = *(_WORD *)(v21 + 2);
          v37 = *(_QWORD *)(v21 + 20) - *(_QWORD *)(v21 + 28);
        }
        v38 = (unsigned __int64)(2361183241434822607LL * (unsigned __int128)(*(_QWORD *)(v5 + 40) >> 3) >> 64) >> 4;
        IO80211Peer::logDebug(
          v7,
          9912784519168LL,
          "TXSTATUS <%s> %s (%u) status=0x%x %02X:%02X:%02X:%02X:%02X:%02X cnt %u queuesize %u numhost %u ac %u new %u retries %u txRate %u contention %llu (us) tot-latency %llu (us)\n",
          v20,
          v80,
          v22);
        v6 = v81;
        v4 = v83;
        goto LABEL_43;
      }
      if ( v16 == -536870198 )
      {
        v17 = (__int64)"IOErr ";
        goto LABEL_33;
      }
    }
LABEL_32:
    v17 = (__int64)"ERR?  ";
    goto LABEL_33;
  }
LABEL_43:
  if ( *(_BYTE *)(*((_QWORD *)v7 + 5) + 552LL) )
  {
    v84 = v4;
    v82 = *(_DWORD *)(v6 + 80) == -536772094;
  }
  else
  {
    v84 = v4;
    v82 = 0;
  }
  LODWORD(v39) = mbuf_data(*(_QWORD *)(v6 + 32));
  v42 = *(_BYTE *)v39;
  v43 = v85;
  if ( *((_BYTE *)v7 + v85 + 478) )
  {
    v44 = *((_QWORD *)v7 + v85 + 6);
    if ( v44 )
    {
      if ( (unsigned __int16)(*(_DWORD *)(v44 + 52) - *((_WORD *)v7 + v85 + 40)) == 1 )
      {
        *((_BYTE *)v7 + v85 + 478) = 0;
        *(_DWORD *)(v5 + 52) = 31;
        v45 = *((_QWORD *)v7 + v85 + 6);
        v46 = 0LL;
        if ( v45 )
          v46 = (unsigned __int16)(*(_DWORD *)(v45 + 52) - *((_WORD *)v7 + v85 + 40));
        IO80211Peer::logDebug(
          v7,
          0x20000000000LL,
          "Data Path Opened after last suppression ac:%u Pid %u remain=%d\n",
          v85,
          *(_DWORD *)(v6 + 44),
          v46);
        v43 = v85;
      }
    }
  }
  v47 = v6;
  if ( v42 & 1 )
  {
LABEL_59:
    v86 = v43;
    v49 = (unsigned int)v87;
    ++*((_DWORD *)v7 + v49 + 136);
    v50 = (*(int (__fastcall **)(IO80211Peer *, __int64, __int64))(*(_QWORD *)v7 + 344LL))(v7, v47, v5);
    v51 = *((_QWORD *)v7 + 5);
    ++*(_DWORD *)(v51 + 944);
    *((_QWORD *)v7 + 19) = *(_QWORD *)(v84 + 72);
    ++*((_DWORD *)v7 + 152);
    LODWORD(v51) = *(_DWORD *)(v51 + 648);
    ++*((_WORD *)v7 + 8 * v49 + (v51 & 7) + 306);
    v52 = v50;
    v53 = *(_QWORD *)(v47 + 32);
    v54 = 0;
    if ( v53 )
    {
      v55 = v52;
      v54 = mbuf_len(v53);
      v52 = v55;
    }
    v56 = *(_DWORD *)(*((_QWORD *)v7 + 5) + 648LL);
    *((_DWORD *)v7 + 8 * (unsigned int)v87 + (v56 & 7) + 185) += v54;
    if ( v52 )
      goto LABEL_78;
    (*(void (__fastcall **)(IO80211Peer *, __int64, signed __int64))(*(_QWORD *)v7 + 376LL))(v7, v86, 1LL);
    goto LABEL_73;
  }
  if ( !v82 )
  {
    v48 = *(_DWORD *)(v6 + 80);
    if ( v48 < 0 )
    {
      if ( v48 <= -536772097 )
      {
        if ( (unsigned int)(v48 + 536870199) >= 2 )
          goto LABEL_75;
LABEL_77:
        ++*((_DWORD *)v7 + (unsigned int)v87 + 140);
        ++*((_DWORD *)v7 + 51);
        ++*((_DWORD *)v7 + 50);
        *(_WORD *)(v5 + 56) = 257;
        goto LABEL_78;
      }
      if ( v48 <= -536772084 )
      {
        v57 = (__int64)"TxFail";
        switch ( v48 + 536772096 )
        {
          case 2:
          case 6:
          case 9:
            goto LABEL_65;
          default:
            goto LABEL_75;
          case 0:
            goto LABEL_76;
        }
        goto LABEL_76;
      }
      if ( v48 == -536772083 )
        goto LABEL_77;
LABEL_75:
      v57 = (__int64)"ERR?  ";
LABEL_76:
      IO80211Peer::logDebug(v7, "Received unexpected txStatus to free %s, freeing anyway\n", v57, v43, v40, v41);
      goto LABEL_77;
    }
    if ( v48 )
      goto LABEL_75;
    goto LABEL_59;
  }
LABEL_65:
  if ( (unsigned int)*(_BYTE *)(v6 + 41) >= 6 )
  {
    ++*((_DWORD *)v7 + (unsigned int)v87 + 140);
    ++*((_DWORD *)v7 + 51);
    *(_BYTE *)(v5 + 56) = 1;
LABEL_78:
    *(_BYTE *)(v5 + 32) = 1;
    v15 = 5;
    goto LABEL_79;
  }
  ++*((_DWORD *)v7 + (unsigned int)v87 + 148);
  v58 = *((_QWORD *)v7 + v43 + 6);
  if ( !v58 || (unsigned __int16)(*(_DWORD *)(v58 + 52) - *((_WORD *)v7 + v43 + 40)) != 1 )
  {
    *((_BYTE *)v7 + v43 + 478) = 0;
    *((_QWORD *)v7 + v43 + 61) = *(_QWORD *)(v84 + 72);
    v59 = *(_DWORD *)(v6 + 44);
    v60 = *((_QWORD *)v7 + v43 + 6);
    v61 = 0LL;
    if ( v60 )
      v61 = (unsigned __int16)(*(_DWORD *)(v60 + 52) - *((_WORD *)v7 + v43 + 40));
    v62 = v43;
    IO80211Peer::logDebug(
      v7,
      0x20000000000LL,
      "Data Path closed after first suppression ac:%u Pid %u remain=%d\n",
      v43,
      v59,
      v61);
    LODWORD(v43) = v62;
  }
  (*(void (__fastcall **)(IO80211Peer *, _QWORD, signed __int64))(*(_QWORD *)v7 + 376LL))(v7, (unsigned int)v43, 1LL);
  ++*(_DWORD *)(*((_QWORD *)v7 + 5) + 940LL);
  ++*(_BYTE *)(v47 + 41);
LABEL_73:
  v15 = 3;
LABEL_79:
  if ( *(_QWORD *)(v47 + 32) && IO80211PeerManager::shouldLog(*((IO80211PeerManager **)v7 + 5), 0x20000000000LL) )
  {
    v63 = *(const void **)(v5 + 24);
    if ( v63 )
      memcpy(&v102, v63, 0x32uLL);
    else
      memset(&v102, 0, 0x32uLL);
    v103 = (*(_BYTE *)(v47 + 48) >> 5) & 1;
    v106 = *(_DWORD *)(v47 + 80);
    v105 = *(_BYTE *)(v5 + 52);
    v104 = *(_BYTE *)(v47 + 41);
    v107 = *((_DWORD *)v7 + 53);
    v108 = *((_DWORD *)v7 + 54);
    v109 = *(_QWORD *)(v47 + 64);
    v110 = *(_QWORD *)(v47 + 72);
    LODWORD(v64) = IO80211PeerManager::getIfNet(*((IO80211PeerManager **)v7 + 5));
    if ( ifnet_get_sndq_len(v64, &v111) )
      v111 = 0;
    v65 = *((_QWORD *)v7 + 6);
    if ( v65 )
      v66 = *(_DWORD *)(v65 + 52);
    else
      LOWORD(v66) = 0;
    v112 = v66;
    v67 = *((_QWORD *)v7 + 7);
    if ( v67 )
      v68 = *(_DWORD *)(v67 + 52);
    else
      LOWORD(v68) = 0;
    v113 = v68;
    v69 = *((_QWORD *)v7 + 8);
    if ( v69 )
      v70 = *(_DWORD *)(v69 + 52);
    else
      LOWORD(v70) = 0;
    v114 = v70;
    v71 = *((_QWORD *)v7 + 9);
    if ( v71 )
      v72 = *(_DWORD *)(v71 + 52);
    else
      LOWORD(v72) = 0;
    v115 = v72;
    v116 = *((_WORD *)v7 + 40);
    v117 = *((_WORD *)v7 + 41);
    v118 = *((_WORD *)v7 + 42);
    v119 = *((_WORD *)v7 + 43);
    v120 = *(_DWORD *)(*(_QWORD *)(*((_QWORD *)v7 + 5) + 32LL) + 52LL);
    v121 = *(_DWORD *)(*(_QWORD *)(*((_QWORD *)v7 + 5) + 40LL) + 52LL);
    v122 = *(_DWORD *)(*(_QWORD *)(*((_QWORD *)v7 + 5) + 48LL) + 52LL);
    v123 = *(_DWORD *)(*(_QWORD *)(*((_QWORD *)v7 + 5) + 56LL) + 52LL);
    v88 = 1;
    v89 = 0;
    v90 = 0;
    v91 = *(__mbuf **)(v47 + 32);
    v92 = *(_DWORD *)(v47 + 44);
    v93 = 1;
    v101 = 0LL;
    v100 = 0LL;
    v99 = 0LL;
    v98 = 0LL;
    v97 = 0LL;
    v96 = 0LL;
    v94 = 0LL;
    LODWORD(v94) = 7208962;
    v95 = &v102;
    v73 = (IO80211PeerManager *)*((_QWORD *)v7 + 5);
    v74 = 0;
    if ( v73 )
    {
      v75 = IO80211PeerManager::shouldVerboseLog(v73, 0x20000000000LL);
      v76 = *((_QWORD *)v7 + 5);
      if ( v75 )
      {
        v74 = *(_DWORD *)(v76 + 432);
      }
      else
      {
        v74 = *(_DWORD *)(v76 + 424);
        if ( !*(_DWORD *)(v76 + 424) )
          v74 = getLengthBeforeSensitivePayload(0, v91);
      }
    }
    v89 = v74;
    v77 = *(_DWORD *)(v47 + 80);
    if ( v77 >= 0 )
    {
      if ( !v77 )
      {
        v78 = (__int64)"OK    ";
        goto LABEL_117;
      }
    }
    else if ( v77 > -536772097 )
    {
      if ( v77 <= -536772084 )
      {
        switch ( v77 + 536772096 )
        {
          case 0:
            v78 = (__int64)"TxFail";
            break;
          default:
            goto LABEL_116;
          case 2:
            v78 = (__int64)"NoACK ";
            break;
          case 6:
            v78 = (__int64)"Expire";
            break;
          case 9:
            v78 = (__int64)"NoBuff";
            break;
        }
        goto LABEL_117;
      }
      if ( v77 == -536772083 )
      {
        v78 = (__int64)"NoRess";
        goto LABEL_117;
      }
    }
    else
    {
      if ( v77 == -536870199 )
      {
        v78 = (__int64)"IntErr";
LABEL_117:
        (*(void (__fastcall **)(IO80211Peer *, __int64, char *))(*(_QWORD *)v7 + 312LL))(v7, v78, &v88);
        ++*((_DWORD *)v7 + 53);
        return (unsigned int)v15;
      }
      if ( v77 == -536870198 )
      {
        v78 = (__int64)"IOErr ";
        goto LABEL_117;
      }
    }
LABEL_116:
    v78 = (__int64)"ERR?  ";
    goto LABEL_117;
  }
  return (unsigned int)v15;
}
// C8B00: using guessed type int __fastcall ifnet_get_sndq_len(_QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C30: using guessed type int __fastcall mbuf_get_traffic_class(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C70: using guessed type int __fastcall mbuf_pkthdr_rcvif(_QWORD, _QWORD, _QWORD);

//----- (000000000004098C) ----------------------------------------------------
__int64 __fastcall IO80211Peer::numPacket(__int64 a1, unsigned int a2)
{
  __int64 v2; // rcx@1
  __int64 result; // rax@1

  v2 = *(_QWORD *)(a1 + 8LL * a2 + 48);
  result = 0LL;
  if ( v2 )
    result = *(_DWORD *)(v2 + 52);
  return result;
}

//----- (00000000000409A4) ----------------------------------------------------
char __fastcall IO80211Peer::inputPacket(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rax@1
  int v4; // eax@3
  int v5; // eax@3
  int v6; // ecx@5

  v2 = (unsigned int)mbuf_get_traffic_class(a2);
  ++*(_DWORD *)(a1 + 4 * v2 + 576);
  LODWORD(v3) = mbuf_data(a2);
  if ( !(*(_BYTE *)v3 & 1) )
    ++*(_DWORD *)(a1 + 528);
  v4 = *(_DWORD *)(*(_QWORD *)(a1 + 40) + 648LL);
  ++*(_WORD *)(a1 + 16 * v2 + 2LL * (v4 & 7) + 676);
  v5 = 0;
  if ( a2 )
    v5 = mbuf_len(a2);
  v6 = *(_DWORD *)(*(_QWORD *)(a1 + 40) + 648LL);
  *(_DWORD *)(a1 + 32 * v2 + 4LL * (v6 & 7) + 868) += v5;
  return 1;
}
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C30: using guessed type int __fastcall mbuf_get_traffic_class(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);

//----- (0000000000040A32) ----------------------------------------------------
void __fastcall IO80211Peer::reportRssi(__int64 a1, char a2, __int64 a3, char a4)
{
  signed __int64 v4; // rax@2
  int v5; // ecx@3
  int v6; // ecx@5
  int v7; // ecx@6

  if ( a2 )
  {
    v4 = a1 + 1084;
    if ( a4 & 0x10 )
    {
      v5 = *(_DWORD *)(a1 + 1084);
      *(_BYTE *)(a1 + (v5 & 0xF) + 1120) = a2;
    }
    else if ( a4 & 8 )
    {
      v6 = *(_DWORD *)(a1 + 1084);
      *(_BYTE *)(a1 + (v6 & 0xF) + 1136) = a2;
    }
    v7 = *(_DWORD *)v4;
    *(_BYTE *)(a1 + (v7 & 0xF) + 1104) = a2;
    ++*(_DWORD *)v4;
    *(_BYTE *)(a1 + 1080) = a2;
  }
}

//----- (0000000000040A8C) ----------------------------------------------------
__int64 __fastcall IO80211Peer::getRssi(IO80211Peer *this)
{
  unsigned int v1; // ecx@1
  signed int v2; // er8@1
  int v3; // eax@3
  int v4; // edx@4
  char *v5; // rax@5
  int v6; // ecx@5
  signed int v7; // esi@5
  int v8; // esi@7

  v1 = *((_DWORD *)this + 271);
  v2 = 16;
  if ( v1 < 0x10 )
    v2 = *((_DWORD *)this + 271);
  LOBYTE(v3) = -100;
  if ( v2 )
  {
    v4 = 0;
    if ( v2 > 0 )
    {
      v5 = (char *)this + 1104;
      v6 = ~v1;
      v7 = -17;
      if ( (unsigned int)v6 > 0xFFFFFFEF )
        v7 = v6;
      v8 = ~v7;
      v4 = 0;
      do
      {
        if ( *v5 )
          v4 += *v5;
        ++v5;
        --v8;
      }
      while ( v8 );
    }
    v3 = (v4 + *((_BYTE *)this + 1080)) / (v2 + 1);
  }
  return (unsigned int)(char)v3;
}

//----- (0000000000040AEE) ----------------------------------------------------
__int64 __fastcall IO80211Peer::getRssi_5(IO80211Peer *this)
{
  unsigned int v1; // ecx@1
  int v2; // eax@1
  char *v3; // rdi@3
  int v4; // ecx@3
  signed int v5; // edx@3
  int v6; // edx@5
  unsigned int v7; // er8@5
  unsigned int v8; // ecx@5

  v1 = *((_DWORD *)this + 271);
  LOBYTE(v2) = -100;
  if ( (signed int)v1 > 0 || v1 >= 0x10 )
  {
    v3 = (char *)this + 1120;
    v4 = ~v1;
    v5 = -17;
    if ( (unsigned int)v4 > 0xFFFFFFEF )
      v5 = v4;
    v6 = ~v5;
    v7 = 0;
    v8 = 0;
    do
    {
      if ( *v3 )
      {
        v8 += *v3;
        ++v7;
      }
      ++v3;
      --v6;
    }
    while ( v6 );
    if ( v7 )
      v2 = v8 / v7;
  }
  return (unsigned int)(char)v2;
}

//----- (0000000000040B42) ----------------------------------------------------
__int64 __fastcall IO80211Peer::getRssi_2_4(IO80211Peer *this)
{
  unsigned int v1; // ecx@1
  int v2; // eax@1
  char *v3; // rdi@3
  int v4; // ecx@3
  signed int v5; // edx@3
  int v6; // edx@5
  unsigned int v7; // er8@5
  unsigned int v8; // ecx@5

  v1 = *((_DWORD *)this + 271);
  LOBYTE(v2) = -100;
  if ( (signed int)v1 > 0 || v1 >= 0x10 )
  {
    v3 = (char *)this + 1136;
    v4 = ~v1;
    v5 = -17;
    if ( (unsigned int)v4 > 0xFFFFFFEF )
      v5 = v4;
    v6 = ~v5;
    v7 = 0;
    v8 = 0;
    do
    {
      if ( *v3 )
      {
        v8 += *v3;
        ++v7;
      }
      ++v3;
      --v6;
    }
    while ( v6 );
    if ( v7 )
      v2 = v8 / v7;
  }
  return (unsigned int)(char)v2;
}

//----- (0000000000040B96) ----------------------------------------------------
__int64 __fastcall IO80211Peer::reportTransmitStatus(IO80211Peer *this, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 v3; // rbx@1
  int v4; // er12@2
  __int64 v5; // rdx@2
  __int64 v6; // rbx@4
  __int64 v7; // rax@4
  OSMetaClass *v8; // rax@9
  __int64 v9; // ST48_8@9
  int v10; // ST40_4@9
  int v11; // ST38_4@9
  int v12; // ST30_4@9
  int v13; // ST28_4@9
  int v14; // ST20_4@9
  int v15; // ST18_4@9
  __int64 v16; // ST10_8@9
  int (__fastcall *v17)(__int64, __int64, __int64, __int64); // rsi@9
  __int64 v18; // rbx@9
  OSMetaClass *v19; // rax@11
  __int64 v20; // rax@11
  OSMetaClass *v21; // rax@14
  __int64 v22; // r12@14
  __int64 v23; // rax@14
  unsigned __int64 v24; // rax@16
  int v25; // ecx@16
  __int64 v26; // rcx@16
  void *v28; // [sp+50h] [bp-80h]@6
  __int64 v29; // [sp+58h] [bp-78h]@4
  __int64 v30; // [sp+60h] [bp-70h]@4
  __int64 v31; // [sp+68h] [bp-68h]@4
  __int64 v32; // [sp+70h] [bp-60h]@4
  __int64 v33; // [sp+78h] [bp-58h]@4
  __int64 v34; // [sp+80h] [bp-50h]@4
  __int64 v35; // [sp+88h] [bp-48h]@4
  __int64 v36; // [sp+90h] [bp-40h]@4
  __int64 v37; // [sp+98h] [bp-38h]@4
  __int64 v38; // [sp+A0h] [bp-30h]@4

  v2 = a2;
  v3 = *(_QWORD *)a2;
  if ( *(_QWORD *)a2 )
  {
    v4 = mbuf_get_traffic_class(*(_QWORD *)a2);
    mbuf_pkthdr_rcvif(v3, a2, v5);
  }
  else
  {
    v4 = *(_BYTE *)(*(_QWORD *)(a2 + 24) + 45LL);
  }
  v6 = *((_QWORD *)this + (unsigned int)v4 + 6);
  v37 = 0LL;
  v36 = 0LL;
  v35 = 0LL;
  v34 = 0LL;
  v33 = 0LL;
  v32 = 0LL;
  v31 = 0LL;
  v30 = 0LL;
  v29 = 0LL;
  v38 = getAbsoluteTime();
  v7 = 0LL;
  if ( v6 )
    v7 = IO80211CommandQueue::map(v6, _doTransmitStatus, (__int64)this, a2, (__int64)&v29, -1);
  v28 = (void *)v7;
  if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)this + 5), 0x4000000000LL)
    && *(_QWORD *)(*((_QWORD *)this + 5) + 680LL) & 0x4000000000LL
    && !*(_QWORD *)(a2 + 16) )
  {
    LODWORD(v8) = (*(int (__fastcall **)(IO80211Peer *, signed __int64))(*(_QWORD *)this + 56LL))(this, 0x4000000000LL);
    v9 = OSMetaClass::getClassName(v8);
    vm_kernel_addrperm_addr(v28);
    v10 = *((_BYTE *)this + 37);
    v11 = *((_BYTE *)this + 36);
    v12 = *((_BYTE *)this + 35);
    v13 = *((_BYTE *)this + 34);
    v14 = *((_BYTE *)this + 33);
    v15 = *((_BYTE *)this + 32);
    v16 = *(_QWORD *)a2;
    v17 = 0;
    IO80211Peer::logDebug(
      this,
      0x4000000000LL,
      "%s::%s this %p reportcan't find packet pkt %p ac %u m %p peer %02x:%02x:%02x:%02x:%02x:%02x\n",
      v9,
      (__int64)"reportTransmitStatus",
      (__int64)this);
    v18 = 0LL;
    while ( 1 )
    {
      *(_DWORD *)(v2 + 48) = 1;
      if ( *((_QWORD *)this + v18 + 6) )
      {
        LODWORD(v19) = (*(int (__fastcall **)(IO80211Peer *, int (__fastcall *)(__int64, __int64, __int64, __int64)))(*(_QWORD *)this + 56LL))(
                         this,
                         v17);
        v20 = OSMetaClass::getClassName(v19);
        IO80211Peer::logDebug(
          this,
          "%s::%s looking ac %u size %u\n",
          v20,
          (__int64)"reportTransmitStatus",
          (unsigned int)v18,
          *(_DWORD *)(*((_QWORD *)this + v18 + 6) + 52LL));
        v17 = _doTransmitStatus;
        IO80211CommandQueue::map(*((_QWORD *)this + v18 + 6), _doTransmitStatus, (__int64)this, v2, 0LL, -1);
        if ( *(_QWORD *)(v2 + 16) )
          break;
      }
      ++v18;
      if ( (unsigned int)v18 >= 4 )
        goto LABEL_15;
    }
    LODWORD(v21) = (*(int (__fastcall **)(IO80211Peer *, int (__fastcall *)(__int64, __int64, __int64, __int64)))(*(_QWORD *)this + 56LL))(
                     this,
                     _doTransmitStatus);
    v22 = OSMetaClass::getClassName(v21);
    v23 = (__int64)vm_kernel_addrperm_addr(v28);
    IO80211Peer::logDebug(
      this,
      "%s::%s found on ac %u pkt %p\n",
      v22,
      (__int64)"reportTransmitStatus",
      (unsigned int)v18,
      v23);
  }
LABEL_15:
  if ( *(_QWORD *)(v2 + 16) )
  {
    v24 = *(_QWORD *)(v2 + 40);
    v25 = *(_DWORD *)(*((_QWORD *)this + 5) + 648LL);
    v26 = v25 & 7;
    if ( v24 > *((_QWORD *)this + v26 + 127) )
      *((_QWORD *)this + v26 + 127) = v24;
  }
  else
  {
    ++*((_DWORD *)this + 55);
  }
  return 0LL;
}
// C8C30: using guessed type int __fastcall mbuf_get_traffic_class(_QWORD);
// C8C70: using guessed type int __fastcall mbuf_pkthdr_rcvif(_QWORD, _QWORD, _QWORD);

//----- (0000000000040E27) ----------------------------------------------------
int __fastcall _doTransmitStatus(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  char *v5; // ST10_8@2
  char *v6; // ST08_8@2
  char *v7; // r12@2
  unsigned int v8; // er13@2
  unsigned int v9; // er14@2
  __int64 v10; // rax@5
  int result; // eax@7
  __int64 v12; // [sp+20h] [bp-30h]@1

  v12 = a4;
  v4 = a3;
  if ( *(_DWORD *)(a3 + 48) )
  {
    v5 = vm_kernel_addrperm_addr((void *)a2);
    v6 = vm_kernel_addrperm_addr(*(void **)(a2 + 32));
    v7 = vm_kernel_addrperm_addr(*(void **)v4);
    v8 = *(_WORD *)(a2 + 48);
    v9 = *(_WORD *)(a2 + 60);
    vm_kernel_addrperm_addr(*(void **)(v4 + 24));
    IOLog("pkt %p m %p - %p flags %x %x info %p\n", v5, v6, v7, v8, v9);
  }
  if ( *(_QWORD *)v4 && *(_QWORD *)(a2 + 32) == *(_QWORD *)v4
    || (v10 = *(_QWORD *)(v4 + 24)) != 0 && *(_DWORD *)(v10 + 40) == *(_DWORD *)(a2 + 52) )
    result = (*(int (__fastcall **)(__int64, __int64, __int64, __int64))(*(_QWORD *)a1 + 360LL))(a1, a2, v4, v12);
  else
    result = 0;
  return result;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000040F00) ----------------------------------------------------
__int64 __fastcall IO80211Peer::doMonitoring(__int64 a1)
{
  int v1; // eax@1
  __int64 v2; // rax@1
  __int64 v3; // r12@1
  __int64 v4; // r13@1
  int v5; // eax@2
  int v6; // eax@2
  int v7; // eax@2
  __int64 v8; // r14@3
  IO80211PeerManager *v9; // ST40_8@4
  unsigned int v10; // ST3C_4@4
  unsigned int v11; // ST34_4@4
  unsigned int v12; // ST38_4@4
  unsigned int v13; // ST30_4@4
  __int64 v14; // r14@4
  int v15; // ST08_4@4
  int v16; // ST00_4@4
  int v17; // ST10_4@4
  int v18; // eax@5
  int v19; // eax@6

  v1 = *(_DWORD *)(*(_QWORD *)(a1 + 40) + 648LL);
  v2 = v1 & 7;
  v3 = 0LL;
  v4 = 0LL;
  do
  {
    *(_WORD *)(a1 + 2 * v2 + 2 * v3 + 676) = 0;
    v5 = *(_DWORD *)(*(_QWORD *)(a1 + 40) + 648LL);
    *(_WORD *)(a1 + 2LL * (v5 & 7) + 2 * v3 + 612) = 0;
    v6 = *(_DWORD *)(*(_QWORD *)(a1 + 40) + 648LL);
    *(_DWORD *)(a1 + 4LL * (v6 & 7) + 4 * v3 + 868) = 0;
    v7 = *(_DWORD *)(*(_QWORD *)(a1 + 40) + 648LL);
    *(_DWORD *)(a1 + 4LL * (v7 & 7) + 4 * v3 + 740) = 0;
    if ( *(_BYTE *)(a1 + v4 + 478) )
    {
      v8 = *(_QWORD *)(a1 + v3 + 488) > 0x1EuLL;
      if ( (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v8)) >> 64) >> 18) )
      {
        *(_BYTE *)(a1 + v4 + 478) = 0;
        v9 = *(IO80211PeerManager **)(a1 + 40);
        v10 = *(_BYTE *)(a1 + 32);
        v11 = *(_BYTE *)(a1 + 33);
        v12 = *(_BYTE *)(a1 + 34);
        v13 = *(_BYTE *)(a1 + 35);
        v14 = *(_QWORD *)(a1 + v3 + 488);
        v15 = *(_BYTE *)(a1 + 37);
        v16 = *(_BYTE *)(a1 + 36);
        v17 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v14)) >> 64) >> 18;
        IO80211PeerManager::logDebug(
          v9,
          "resuming Data Path for %02X:%02X:%02X:%02X:%02X:%02X was waiting %u msecs on ac %u\n",
          v10,
          v11,
          v12,
          v13);
      }
    }
    ++v4;
    v18 = *(_DWORD *)(*(_QWORD *)(a1 + 40) + 648LL);
    v2 = v18 & 7;
    v3 += 8LL;
  }
  while ( v3 != 32 );
  *(_WORD *)(a1 + 2 * v2 + 996) = 0;
  v19 = *(_DWORD *)(*(_QWORD *)(a1 + 40) + 648LL);
  *(_QWORD *)(a1 + 8LL * (v19 & 7) + 1016) = 0LL;
  return 0LL;
}

//----- (00000000000410B2) ----------------------------------------------------
__int64 __fastcall IO80211Peer::getPacketStats(IO80211Peer *this)
{
  char *v1; // rdi@1
  __int64 v2; // r8@1
  __int64 result; // rax@1
  signed __int64 v4; // rdx@2
  char *v5; // rsi@2

  v1 = (char *)this + 676;
  v2 = 0LL;
  LODWORD(result) = 0;
  do
  {
    v4 = 4LL;
    v5 = v1;
    do
    {
      result = *((_WORD *)v5 - 32) + *(_WORD *)v5 + (unsigned int)result;
      v5 += 16;
      --v4;
    }
    while ( v4 );
    ++v2;
    v1 += 2;
  }
  while ( v2 != 8 );
  return result;
}

//----- (00000000000410F0) ----------------------------------------------------
__int64 __fastcall IO80211Peer::getPacketStatsRealTimeTx(IO80211Peer *this)
{
  char *v1; // rdi@1
  __int64 v2; // r8@1
  __int64 result; // rax@1
  signed __int64 v4; // rdx@2
  char *v5; // rsi@2

  v1 = (char *)this + 644;
  v2 = 0LL;
  LODWORD(result) = 0;
  do
  {
    v4 = 2LL;
    v5 = v1;
    do
    {
      result = (unsigned int)result + *(_WORD *)v5;
      v5 += 16;
      --v4;
    }
    while ( v4 );
    ++v2;
    v1 += 2;
  }
  while ( v2 != 8 );
  return result;
}

//----- (0000000000041128) ----------------------------------------------------
__int64 __fastcall IO80211Peer::getPacketStatsRealTimeRx(IO80211Peer *this)
{
  char *v1; // rdi@1
  __int64 v2; // r8@1
  __int64 result; // rax@1
  signed __int64 v4; // rdx@2
  char *v5; // rsi@2

  v1 = (char *)this + 708;
  v2 = 0LL;
  LODWORD(result) = 0;
  do
  {
    v4 = 2LL;
    v5 = v1;
    do
    {
      result = (unsigned int)result + *(_WORD *)v5;
      v5 += 16;
      --v4;
    }
    while ( v4 );
    ++v2;
    v1 += 2;
  }
  while ( v2 != 8 );
  return result;
}

//----- (0000000000041160) ----------------------------------------------------
__int16 __fastcall IO80211Peer::updateNumHostPackets(IO80211Peer *this, unsigned int a2, __int16 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int16 result; // ax@2

  if ( a2 < 4 )
  {
    *((_WORD *)this + (unsigned __int8)a2 + 40) += a3;
    result = (*(int (__fastcall **)(IO80211Peer *, _QWORD, _QWORD))(*(_QWORD *)this + 384LL))(
               this,
               (unsigned __int8)a2,
               0LL);
    if ( (_BYTE)result )
    {
      result = *((_WORD *)this + (unsigned __int8)a2 + 40);
      *((_WORD *)this + (unsigned __int8)a2 + 44) = result;
    }
    else
    {
      *((_WORD *)this + (unsigned __int8)a2 + 44) = 0;
    }
  }
  else
  {
    result = IO80211Peer::logDebug(
               this,
               "%s:%d AC %u out of range\n",
               (__int64)"updateNumHostPackets",
               1307LL,
               (unsigned __int8)a2,
               a6);
  }
  return result;
}

//----- (00000000000411D6) ----------------------------------------------------
bool __fastcall IO80211Peer::canTransmit(IO80211Peer *this, unsigned __int8 a2, char a3)
{
  unsigned __int8 v3; // r14@1
  __int64 v4; // r15@1
  int v5; // ST80_4@2
  int v6; // ST7C_4@2
  int v7; // ST78_4@2
  __int64 v8; // r12@2
  int v9; // ST74_4@2
  __int64 v10; // rcx@2
  int v11; // eax@3
  char *v12; // r13@4
  int v13; // er10@4
  int v14; // er11@4
  int v15; // er8@4
  int v16; // ecx@4
  bool v17; // zf@5
  int v18; // edx@11
  int v19; // esi@11
  bool result; // al@15
  int v21; // ecx@18
  int v22; // eax@25
  int v23; // eax@26
  unsigned __int8 v24; // [sp+90h] [bp-30h]@5
  char v25; // [sp+94h] [bp-2Ch]@1

  v25 = a3;
  v3 = a2;
  v4 = *((_QWORD *)this + 5);
  if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)this + 5), 0x4000000000000LL) )
  {
    v5 = *((_BYTE *)this + 35);
    v6 = *((_BYTE *)this + 36);
    v7 = *((_BYTE *)this + 37);
    v8 = a2;
    v9 = *((_BYTE *)this + 477);
    v10 = *((_QWORD *)this + a2 + 6);
    if ( v10 )
      v11 = *(_DWORD *)(v10 + 52);
    v12 = (char *)this + 8 * a2 + 48;
    v13 = *((_WORD *)this + a2 + 40);
    v14 = *((_WORD *)this + a2 + 44);
    v15 = *((_BYTE *)this + a2 + 478) ^ 1;
    v16 = *((_DWORD *)this + 26);
    if ( v16 )
    {
      if ( v16 == 1 )
      {
        v24 = a2;
        v17 = *((_DWORD *)this + 27) == 0;
      }
      else
      {
        v24 = a2;
      }
    }
    else
    {
      v24 = a2;
      v17 = *((_DWORD *)this + 28) == 0;
    }
    v18 = *(_BYTE *)(v4 + 560);
    v19 = *(_DWORD *)(v4 + 152);
    *(_QWORD *)(v4 + 72);
    IO80211Peer::logDebug(
      this,
      0x4000000000000LL,
      "canTransmit %02X:%02X:%02X:%02X:%02X:%02X ac=%d tok=%d q=%d hp=[%d,%d] wts=%d cr=%d dp=%d bm=[%d,%d]\n",
      *((_BYTE *)this + 32),
      *((_BYTE *)this + 33),
      *((_BYTE *)this + 34));
    v3 = v24;
  }
  else
  {
    v8 = a2;
    v12 = (char *)this + 8 * a2 + 48;
  }
  if ( !*(_QWORD *)v12 || !*((_WORD *)this + v8 + 40) || !*((_BYTE *)this + 477) )
    return 0;
  result = 1;
  if ( !*(_BYTE *)(v4 + 156) )
    return result;
  if ( *(_BYTE *)(v4 + 562) && *((_BYTE *)this + v8 + 478) )
    return 0;
  v21 = *((_DWORD *)this + 26);
  if ( v21 )
  {
    if ( v21 != 1 || !*((_DWORD *)this + 27) )
      return 0;
  }
  else if ( !*((_DWORD *)this + 28) )
  {
    return 0;
  }
  if ( !*(_BYTE *)(v4 + 560) )
    return 0;
  if ( !(v25 & 1) )
  {
    v22 = *(_DWORD *)(v4 + 152);
    if ( *(IO80211Peer **)(v4 + 72) == this )
      v23 = v22 & 0x10;
    else
      v23 = (1 << v3) & v22;
    result = v23 != 0;
  }
  return result;
}

//----- (00000000000413EA) ----------------------------------------------------
__int64 __fastcall IO80211Peer::printMac(IO80211Peer *this)
{
  int v1; // ST08_4@1
  int v2; // ST00_4@1

  v1 = *((_BYTE *)this + 37);
  v2 = *((_BYTE *)this + 36);
  return IO80211Peer::logDebug(
           this,
           "mac addr: %02X:%02X:%02X:%02X:%02X:%02X \n",
           *((_BYTE *)this + 32),
           *((_BYTE *)this + 33),
           *((_BYTE *)this + 34),
           *((_BYTE *)this + 35));
}

//----- (0000000000041428) ----------------------------------------------------
__int64 __fastcall IO80211Peer::packetStats(__int64 a1, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 v3; // rbx@1
  __int64 v4; // rdi@2

  v2 = a1;
  v3 = 0LL;
  do
  {
    v4 = *(_QWORD *)(v2 + 8 * v3 + 48);
    if ( v4 )
    {
      *(_DWORD *)(a2 + 36) = 0;
      IO80211CommandQueue::map(
        v4,
        (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_peerPacketStats,
        v2,
        a2,
        0LL,
        -1);
      *(_DWORD *)(a2 + 4 * v3 + 16) = *(_DWORD *)(a2 + 36);
      *(_DWORD *)(a2 + 4 * v3) = *(_DWORD *)(*(_QWORD *)(v2 + 8 * v3 + 48) + 52LL);
    }
    ++v3;
  }
  while ( v3 != 4 );
  return 0LL;
}

//----- (0000000000041496) ----------------------------------------------------
__int64 __fastcall _peerPacketStats(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  char *v4; // r15@2
  char *v5; // rax@2
  signed __int64 v6; // rbx@2
  __int64 v7; // r9@2

  v3 = a3;
  if ( *(_DWORD *)(a3 + 32) )
  {
    v4 = vm_kernel_addrperm_addr((void *)a2);
    v5 = vm_kernel_addrperm_addr(*(void **)(a2 + 32));
    v6 = a2 + 48;
    IOLog("cpf pkt %p m %p - flags %x %x\n", v4, v5, *(_WORD *)(a2 + 48), *(_WORD *)(a2 + 60), v7);
  }
  else
  {
    v6 = a2 + 48;
  }
  if ( *(_BYTE *)v6 & 1 )
    ++*(_DWORD *)(v3 + 36);
  return 0LL;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000414FE) ----------------------------------------------------
char __fastcall IO80211Peer::hasQueuedPackets(IO80211Peer *this)
{
  __int64 v1; // rbx@1
  unsigned int v2; // ecx@2
  char result; // al@3
  int v4[4]; // [sp+0h] [bp-40h]@1
  int v5[12]; // [sp+10h] [bp-30h]@3

  v1 = 0LL;
  memset(v4, 0, 0x28uLL);
  IO80211Peer::packetStats((__int64)this, (__int64)v4);
  while ( 1 )
  {
    v2 = v4[v1];
    if ( v2 )
    {
      result = 1;
      if ( v2 > v5[v1] )
        break;
    }
    ++v1;
    if ( (unsigned int)v1 >= 4 )
      return 0;
  }
  return result;
}
// 414FE: using guessed type int var_40[4];
// 414FE: using guessed type int var_30[12];

//----- (0000000000041554) ----------------------------------------------------
__int64 __fastcall IO80211Peer::getStats(__int64 a1, __int64 a2)
{
  int v2; // eax@1
  __int64 v3; // rcx@1
  __int64 v4; // rcx@3
  __int64 v5; // rax@6
  signed __int64 v6; // rax@8

  *(_BYTE *)(a2 + 11) = *(_BYTE *)(a1 + 1080);
  *(_BYTE *)(a2 + 12) = IO80211Peer::getRssi((IO80211Peer *)a1);
  *(_DWORD *)(a2 + 16) = 0;
  v2 = 0;
  v3 = 0LL;
  do
  {
    v2 += *(_DWORD *)(a1 + 4 * v3 + 544);
    *(_DWORD *)(a2 + 16) = v2;
    ++v3;
  }
  while ( v3 != 4 );
  *(_DWORD *)(a2 + 24) = 0;
  v4 = 0LL;
  do
  {
    v2 += *(_DWORD *)(a1 + 4 * v4 + 560);
    *(_DWORD *)(a2 + 16) = v2;
    ++v4;
  }
  while ( v4 != 4 );
  if ( *(_BYTE *)(a2 + 10) )
  {
    *(_BYTE *)(a1 + 1080) = 0;
    v5 = 0LL;
    do
      *(_BYTE *)(a1 + v5++ + 1104) = 0;
    while ( v5 != 16 );
    v6 = -4LL;
    do
    {
      *(_DWORD *)(a1 + 4 * v6 + 560) = 0;
      *(_DWORD *)(a1 + 4 * v6++ + 576) = 0;
    }
    while ( v6 );
  }
  return 0LL;
}

//----- (00000000000415FC) ----------------------------------------------------
__int64 __fastcall IO80211Peer::queuePacket(IO80211Peer *this, IO80211PacketDescriptor *a2)
{
  IO80211PacketDescriptor *v2; // r15@1
  IO80211Peer *v3; // rbx@1
  __int64 v4; // rax@1
  OSMetaClass *v5; // rax@2
  __int64 v6; // r14@2
  __int64 v7; // r12@2
  void *v8; // rax@2
  __int64 v9; // rax@2
  __int64 v10; // r14@3
  IO80211CommandQueue *v11; // rdi@3
  IO80211PeerManager *v12; // r12@4
  OSMetaClass *v13; // rax@4
  __int64 v14; // rax@4
  int v15; // ST20_4@4
  int v16; // ST18_4@4
  int v17; // ST10_4@4
  int v18; // ST08_4@4
  int v19; // ST00_4@4
  int v20; // eax@6
  __int64 result; // rax@6
  OSMetaClass *v22; // rax@7
  __int64 v23; // rcx@7
  __int64 v24; // rdx@7
  int v25; // eax@8
  OSMetaClass *v26; // rax@10
  __int64 v27; // rax@10
  __int64 v28; // r9@10

  v2 = a2;
  v3 = this;
  LODWORD(v4) = mbuf_nextpkt(*((_QWORD *)a2 + 4));
  if ( v4 )
  {
    LODWORD(v5) = (*(int (__fastcall **)(IO80211Peer *))(*(_QWORD *)this + 56LL))(this);
    v6 = OSMetaClass::getClassName(v5);
    v7 = (__int64)vm_kernel_addrperm_addr(*((void **)a2 + 4));
    LODWORD(v8) = mbuf_nextpkt(*((_QWORD *)a2 + 4));
    v9 = (__int64)vm_kernel_addrperm_addr(v8);
    a2 = (IO80211PacketDescriptor *)"%s::%s queuing a packet on a chain %p %p\n";
    IO80211Peer::logDebug(this, "%s::%s queuing a packet on a chain %p %p\n", v6, (__int64)"queuePacket", v7, v9);
  }
  v10 = (unsigned int)mbuf_get_traffic_class(*((_QWORD *)v2 + 4));
  v11 = (IO80211CommandQueue *)*((_QWORD *)this + v10 + 6);
  if ( v11
    || (v12 = (IO80211PeerManager *)*((_QWORD *)v3 + 5),
        LODWORD(v13) = (*(int (__fastcall **)(IO80211Peer *, IO80211PacketDescriptor *))(*(_QWORD *)v3 + 56LL))(v3, a2),
        v14 = OSMetaClass::getClassName(v13),
        v15 = *((_BYTE *)v3 + 37),
        v16 = *((_BYTE *)v3 + 36),
        v17 = *((_BYTE *)v3 + 35),
        v18 = *((_BYTE *)v3 + 34),
        v19 = *((_BYTE *)v3 + 33),
        IO80211PeerManager::logDebug(
          v12,
          137438953728LL,
          "%s::%s %02x:%02x:%02x:%02x:%02x:%02x alllocate queue for ac %u \n",
          v14,
          (__int64)"queuePacket",
          *((_BYTE *)v3 + 32)),
        v11 = IO80211PeerManager::allocateQueue(
                *((IO80211PeerManager **)v3 + 5),
                (IOCommandGate *)*(_WORD *)(*((_QWORD *)v3 + 5) + 2 * v10 + 544),
                1),
        (*((_QWORD *)v3 + v10 + 6) = v11) != 0LL) )
  {
    *((_DWORD *)v2 + 13) = *((_DWORD *)v3 + v10 + 103) & 0x3FFF | ((*((_DWORD *)v3 + 62) & 0xF) << 14);
    if ( IO80211CommandQueue::lockEnqueue(v11, v2) )
    {
      ++*((_DWORD *)v3 + 132);
      v20 = *((_DWORD *)v3 + v10 + 103);
      *((_DWORD *)v3 + v10 + 103) = v20 + 1;
      *((_WORD *)v2 + 28) = v20;
      *((_QWORD *)v3 + 22) = *((_QWORD *)v2 + 9);
      (*(void (__fastcall **)(IO80211Peer *, _QWORD, signed __int64))(*(_QWORD *)v3 + 376LL))(
        v3,
        (unsigned __int8)v10,
        1LL);
      result = 0LL;
    }
    else
    {
      LODWORD(v22) = (*(int (__fastcall **)(IO80211Peer *, IO80211PacketDescriptor *))(*(_QWORD *)v3 + 56LL))(v3, v2);
      v23 = OSMetaClass::getClassName(v22);
      v24 = *((_QWORD *)v3 + v10 + 6);
      if ( v24 )
        v25 = *(_DWORD *)(v24 + 52);
      IO80211Peer::logDebug(
        v3,
        0x4000000000LL,
        "%s::%s overrun, cannot enqueu packet ac=%u size %u\n",
        v23,
        (__int64)"queuePacket",
        (unsigned int)v10);
      result = 3758097128LL;
    }
  }
  else
  {
    LODWORD(v26) = (*(int (__fastcall **)(IO80211Peer *))(*(_QWORD *)v3 + 56LL))(v3);
    v27 = OSMetaClass::getClassName(v26);
    IO80211Peer::logDebug(
      v3,
      "%s::%s can't allocate a packet queue ac %u\n",
      v27,
      (__int64)"queuePacket",
      (unsigned int)v10,
      v28);
    result = 3758097086LL;
  }
  return result;
}
// C8C30: using guessed type int __fastcall mbuf_get_traffic_class(_QWORD);
// C8C60: using guessed type int __fastcall mbuf_nextpkt(_QWORD);

//----- (0000000000041824) ----------------------------------------------------
__int64 __fastcall IO80211Peer::dumpTxPacket(__int64 a1, char *a2, __int64 a3)
{
  return IO80211PeerManager::dumpPacket(*(_QWORD *)(a1 + 40), 35184372091392LL, a2, a3);
}

//----- (000000000004184C) ----------------------------------------------------
__int64 __fastcall IO80211Peer::getPacket(IO80211Peer *this, __int64 a2)
{
  __int64 v2; // r14@1
  IO80211Peer *v3; // rbx@1
  int v4; // er13@1
  unsigned int v5; // eax@1
  signed int v6; // er15@1
  int v7; // eax@6
  int v8; // ecx@10
  int v9; // eax@14
  int v10; // ecx@14
  int v11; // ecx@15
  OSMetaClass *v12; // rax@17
  __int64 v13; // rax@17
  int v14; // ST38_4@17
  int v15; // ST30_4@17
  int v16; // ST28_4@17
  int v17; // ST20_4@17
  int v18; // ST18_4@17
  int v19; // ST10_4@17
  int v20; // ST08_4@17
  int v21; // ST00_4@17
  int v22; // ecx@21
  OSMetaClass *v23; // rax@23
  __int64 v24; // rax@23
  int v25; // ST38_4@23
  int v26; // ST30_4@23
  int v27; // ST28_4@23
  int v28; // ST20_4@23
  int v29; // ST18_4@23
  int v30; // ST10_4@23
  int v31; // ST08_4@23
  int v32; // ST00_4@23
  __int64 v33; // rax@29
  unsigned int v34; // er11@29
  int v35; // ecx@29
  int v36; // er8@29
  int v37; // esi@29
  int v38; // edi@29
  int v39; // ST88_4@29
  int v40; // ST84_4@29
  int v41; // ST80_4@29
  __int64 v42; // rdx@29
  int v43; // er9@30
  __int64 v44; // rdx@31
  int v45; // ST94_4@32
  __int64 v46; // rdi@33
  int v47; // edx@34
  __int64 v48; // rdi@35
  int v49; // er11@36
  int v50; // eax@38
  __int64 v51; // rax@40
  IO80211VirtualInterface *v52; // rdi@40
  char *v53; // rax@41
  __int64 v54; // ST88_8@45
  __int64 v55; // rax@45
  int v56; // ST58_4@45
  int v57; // ST50_4@45
  int v58; // ST48_4@45
  int v59; // ST40_4@45
  int v60; // ST38_4@45
  int v61; // ST30_4@45
  int v62; // ST20_4@45
  int v63; // ST18_4@45
  int v64; // ST10_4@45
  int v65; // ST08_4@45
  int v66; // ST00_4@45
  int v67; // ecx@46
  unsigned int v69; // [sp+74h] [bp-9Ch]@31
  int v70; // [sp+94h] [bp-7Ch]@41
  __int64 v71; // [sp+98h] [bp-78h]@1
  __int64 v72; // [sp+A0h] [bp-70h]@1
  __int64 v73; // [sp+A8h] [bp-68h]@1
  __int64 v74; // [sp+B0h] [bp-60h]@1
  __int64 v75; // [sp+B8h] [bp-58h]@1
  __int64 v76; // [sp+C0h] [bp-50h]@1
  __int64 v77; // [sp+C8h] [bp-48h]@1
  __int64 v78; // [sp+D0h] [bp-40h]@1
  __int64 v79; // [sp+D8h] [bp-38h]@1
  __int64 v80; // [sp+E0h] [bp-30h]@1

  v2 = a2;
  v3 = this;
  v80 = 0LL;
  v79 = 0LL;
  v78 = 0LL;
  v77 = 0LL;
  v76 = 0LL;
  v75 = 0LL;
  v74 = 0LL;
  v73 = 0LL;
  v72 = 0LL;
  v71 = 0LL;
  v4 = *(_DWORD *)(a2 + 24);
  *(_DWORD *)(a2 + 20) = 0;
  v5 = *(_DWORD *)(a2 + 16);
  v6 = -1;
  if ( v5 <= 3 )
  {
    if ( *((_DWORD *)this + 26) == 1 )
      ++*((_DWORD *)this + 59);
    else
      ++*((_DWORD *)this + 58);
    v6 = 0;
    if ( (unsigned __int8)(*(int (__fastcall **)(IO80211Peer *, _QWORD, _QWORD))(*(_QWORD *)this + 384LL))(
                            this,
                            (unsigned __int8)v5,
                            0LL) )
    {
      v7 = *((_DWORD *)this + 27);
      if ( v7 < 0 || *((_DWORD *)this + 26) != 1 || v7 >= *(_DWORD *)(a2 + 24) )
      {
        v8 = *((_DWORD *)this + 28);
        if ( v8 < 0 || *((_DWORD *)this + 26) )
        {
          v7 = *(_DWORD *)(a2 + 24);
        }
        else
        {
          v7 = *(_DWORD *)(a2 + 24);
          if ( v8 < v7 )
          {
            *(_DWORD *)(a2 + 24) = v8;
            v7 = v8;
          }
        }
      }
      else
      {
        *(_DWORD *)(a2 + 24) = v7;
      }
      if ( v7 )
      {
        v80 = getAbsoluteTime();
        IO80211CommandQueue::map(
          *((_QWORD *)this + *(_DWORD *)(a2 + 16) + 6),
          (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_transmitReady,
          (__int64)this,
          a2,
          (__int64)&v71,
          -1);
        v9 = *(_DWORD *)(a2 + 20);
        *(_DWORD *)(a2 + 40) += v9;
        *(_DWORD *)(a2 + 28) += *((_WORD *)this + *(_DWORD *)(a2 + 16) + 40);
        v10 = *((_DWORD *)this + 26);
        if ( v10 )
        {
          if ( v10 == 1 )
          {
            v22 = *((_DWORD *)this + 27);
            if ( v22 >= 0 )
            {
              if ( v22 < v9 )
              {
                LODWORD(v23) = (*(int (__fastcall **)(IO80211Peer *, __int64 (__fastcall *)(void *, __int64, __int64, __int64)))(*(_QWORD *)this + 56LL))(
                                 this,
                                 _transmitReady);
                v24 = OSMetaClass::getClassName(v23);
                v25 = *((_BYTE *)this + 37);
                v26 = *((_BYTE *)this + 36);
                v27 = *((_BYTE *)this + 35);
                v28 = *((_BYTE *)this + 34);
                v29 = *((_BYTE *)this + 33);
                v30 = *((_BYTE *)this + 32);
                v31 = *(_DWORD *)(a2 + 20);
                v32 = *(_DWORD *)(a2 + 24);
                IO80211Peer::logDebug(
                  this,
                  "%s::%s error closeCredits %d state %u max %u num %u %02X:%02X:%02X:%02X:%02X:%02X\n",
                  v24,
                  (__int64)"getPacket",
                  *((_DWORD *)this + 27),
                  *((_DWORD *)this + 26));
                v22 = *((_DWORD *)this + 27);
              }
              if ( v22 > 0 )
                *((_DWORD *)this + 27) = v22 - *(_DWORD *)(a2 + 20);
            }
          }
        }
        else
        {
          v11 = *((_DWORD *)this + 28);
          if ( v11 >= 0 )
          {
            if ( v11 < v9 )
            {
              LODWORD(v12) = (*(int (__fastcall **)(IO80211Peer *, __int64 (__fastcall *)(void *, __int64, __int64, __int64)))(*(_QWORD *)this + 56LL))(
                               this,
                               _transmitReady);
              v13 = OSMetaClass::getClassName(v12);
              v14 = *((_BYTE *)this + 37);
              v15 = *((_BYTE *)this + 36);
              v16 = *((_BYTE *)this + 35);
              v17 = *((_BYTE *)this + 34);
              v18 = *((_BYTE *)this + 33);
              v19 = *((_BYTE *)this + 32);
              v20 = *(_DWORD *)(a2 + 20);
              v21 = *(_DWORD *)(a2 + 24);
              IO80211Peer::logDebug(
                this,
                "%s::%s error openCredits %d state %u max %u num %u %02X:%02X:%02X:%02X:%02X:%02X\n",
                v13,
                (__int64)"getPacket",
                *((_DWORD *)this + 28),
                *((_DWORD *)this + 26));
              v11 = *((_DWORD *)this + 28);
            }
            if ( v11 > 0 )
              *((_DWORD *)this + 28) = v11 - *(_DWORD *)(a2 + 20);
          }
        }
        if ( !*(_DWORD *)(a2 + 20) )
        {
          if ( *(_DWORD *)(*((_QWORD *)this + *(_DWORD *)(a2 + 16) + 6) + 52LL)
            && IO80211PeerManager::shouldLog(*((IO80211PeerManager **)this + 5), 0x400000000LL) )
          {
            v33 = (__int64)IO80211PeerManager::getBSDName(*((IO80211PeerManager **)this + 5));
            v34 = *((_BYTE *)this + 32);
            v35 = *((_BYTE *)this + 33);
            v36 = *((_BYTE *)this + 34);
            v37 = *((_BYTE *)this + 35);
            v38 = *((_BYTE *)this + 36);
            v39 = *((_BYTE *)v3 + 37);
            v40 = *(_DWORD *)(v2 + 24);
            v41 = *((_WORD *)v3 + *(_DWORD *)(v2 + 16) + 40);
            v42 = *((_QWORD *)v3 + 6);
            if ( v42 )
              v43 = *(_DWORD *)(v42 + 52);
            v69 = v34;
            v44 = *((_QWORD *)v3 + 7);
            if ( v44 )
              v45 = *(_DWORD *)(v44 + 52);
            v46 = *((_QWORD *)v3 + 8);
            if ( v46 )
              v47 = *(_DWORD *)(v46 + 52);
            v48 = *((_QWORD *)v3 + 9);
            if ( v48 )
              v49 = *(_DWORD *)(v48 + 52);
            IO80211Peer::logDebug(
              v3,
              0x400000000LL,
              " %s <%s>  %02X:%02X:%02X:%02X:%02X:%02X fail to get packets ac %u max %u host %u [%u %u %u %u]\n",
              (__int64)"getPacket",
              v33,
              v69);
          }
          v50 = 0;
          if ( !*(_DWORD *)(v2 + 20) )
            goto LABEL_51;
        }
        if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)v3 + 5), 0x400000000LL) )
        {
          v51 = *((_QWORD *)v3 + 5);
          v52 = *(IO80211VirtualInterface **)(v51 + 128);
          if ( v52 )
          {
            v70 = v4;
            v53 = IO80211VirtualInterface::getBSDName(v52);
          }
          else
          {
            v70 = v4;
            v53 = IO80211Interface::getBSDName(*(IO80211Interface **)(v51 + 136), v51);
          }
          v54 = (__int64)v53;
          v55 = *(_DWORD *)(v2 + 16);
          v56 = *((_DWORD *)v3 + 27);
          v57 = *((_DWORD *)v3 + 28);
          v58 = *((_DWORD *)v3 + 26);
          v59 = *((_WORD *)v3 + v55 + 40);
          v60 = *(_DWORD *)(*((_QWORD *)v3 + v55 + 6) + 52LL);
          v61 = *(_DWORD *)(v2 + 20);
          v62 = *(_DWORD *)(v2 + 24);
          v63 = *((_BYTE *)v3 + 37);
          v64 = *((_BYTE *)v3 + 36);
          v65 = *((_BYTE *)v3 + 35);
          v66 = *((_BYTE *)v3 + 34);
          IO80211Peer::logDebug(
            v3,
            0x400000000LL,
            "<%s> %02X:%02X:%02X:%02X:%02X:%02X did get packets max %u ac %u got %u pkts [in-queue %u host %u] state %u credits %d/%d\n",
            v54,
            *((_BYTE *)v3 + 32),
            *((_BYTE *)v3 + 33));
          v4 = v70;
        }
      }
      v67 = *(_DWORD *)(v2 + 20);
      v50 = 0;
      if ( v67 )
      {
        if ( *((_DWORD *)v3 + 26) == 1 )
          ++*((_DWORD *)v3 + 61);
        else
          ++*((_DWORD *)v3 + 60);
        v50 = v67;
      }
LABEL_51:
      *((_DWORD *)v3 + 54) += v50;
      *(_DWORD *)(v2 + 24) = v4;
      return (unsigned int)v6;
    }
  }
  return (unsigned int)v6;
}

//----- (0000000000041DAC) ----------------------------------------------------
__int64 __fastcall _transmitReady(void *a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r12@1
  __int64 v5; // r13@1
  __int64 v6; // r14@1
  void *v7; // r15@1
  signed int v8; // ebx@1
  __int64 v9; // rax@4
  __mbuf *v10; // r12@6
  char *v11; // rax@7
  __int64 v12; // rdx@7
  __int64 v13; // r8@7
  __int64 v14; // r9@7
  __int64 v15; // rdx@8
  __int64 v16; // rdi@8
  IO80211PeerManager *v17; // rdi@11
  __int64 v18; // rax@13
  __int64 v19; // rbx@13
  char v20; // al@13
  IO80211PeerManager *v21; // rdi@15
  int v22; // eax@15
  bool v23; // al@16
  __int64 v24; // rcx@16
  IO80211PeerManager *v25; // rdi@21
  int v26; // eax@21
  bool v27; // al@22
  __int64 v28; // rcx@22
  __int64 v29; // rax@26
  __int64 v30; // rsi@26
  __int16 v31; // ax@31
  char v33; // [sp+8h] [bp-F8h]@13
  int v34; // [sp+Ch] [bp-F4h]@13
  int v35; // [sp+10h] [bp-F0h]@13
  __mbuf *v36; // [sp+18h] [bp-E8h]@13
  int v37; // [sp+20h] [bp-E0h]@13
  int v38; // [sp+24h] [bp-DCh]@13
  __int64 v39; // [sp+28h] [bp-D8h]@13
  int *v40; // [sp+30h] [bp-D0h]@13
  __int64 v41; // [sp+38h] [bp-C8h]@13
  __int64 v42; // [sp+40h] [bp-C0h]@13
  __int64 v43; // [sp+48h] [bp-B8h]@13
  __int64 v44; // [sp+50h] [bp-B0h]@13
  __int64 v45; // [sp+58h] [bp-A8h]@13
  __int64 v46; // [sp+60h] [bp-A0h]@13
  int v47; // [sp+68h] [bp-98h]@13
  int v48; // [sp+6Ch] [bp-94h]@13
  int v49; // [sp+70h] [bp-90h]@13
  __int64 v50; // [sp+78h] [bp-88h]@13
  __int64 v51; // [sp+80h] [bp-80h]@7
  __int64 v52; // [sp+88h] [bp-78h]@7
  __int64 v53; // [sp+90h] [bp-70h]@7
  __int64 v54; // [sp+98h] [bp-68h]@7
  __int64 v55; // [sp+A0h] [bp-60h]@7
  __int64 v56; // [sp+A8h] [bp-58h]@7
  __int64 v57; // [sp+B0h] [bp-50h]@7
  __int64 v58; // [sp+B8h] [bp-48h]@7
  __int64 v59; // [sp+C0h] [bp-40h]@7
  __int64 v60; // [sp+C8h] [bp-38h]@7
  __int64 v61; // [sp+D0h] [bp-30h]@7

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = a1;
  v8 = 1;
  if ( *(_DWORD *)(a3 + 20) >= *(_DWORD *)(a3 + 24) )
    return (unsigned int)v8;
  v8 = 0;
  if ( *(_BYTE *)(a2 + 48) & 1 || !(unsigned __int8)(*(int (**)(void))(*(_QWORD *)a1 + 336LL))() )
    return (unsigned int)v8;
  v9 = *(_DWORD *)(v5 + 16);
  if ( *((_WORD *)a1 + v9 + 40) )
    (*(void (__fastcall **)(void *, _QWORD, signed __int64))(*(_QWORD *)a1 + 376LL))(
      a1,
      (unsigned __int8)v9,
      0xFFFFFFFFLL);
  *(_BYTE *)(a2 + 48) |= 1u;
  *(_QWORD *)(a2 + 64) = *(_QWORD *)(v4 + 72);
  v10 = *(__mbuf **)(a2 + 32);
  if ( !v10 )
  {
    v11 = vm_kernel_addrperm_addr(a1);
    IOLog("null mbuf!! peer =%p\n", v11, v12, v11, v13, v14);
    v61 = 0LL;
    v60 = 0LL;
    v59 = 0LL;
    v58 = 0LL;
    v57 = 0LL;
    v56 = 0LL;
    v55 = 0LL;
    v54 = 0LL;
    v53 = 0LL;
    v52 = 0LL;
    v51 = 0LL;
    (*(void (__fastcall **)(void *, __int64 *))(*(_QWORD *)a1 + 280LL))(a1, &v51);
  }
  *(_DWORD *)(v5 + 36) += mbuf_pkthdr_len(v10);
  mbuf_pkthdr_setrcvif(
    v10,
    2LL * (*((_DWORD *)a1 + 26) == 1) | (*((_BYTE *)a1 + 116) != 0) | (*(_DWORD *)(a2 + 52) << 14),
    v15);
  mbuf_setnextpkt(v10, 0LL);
  v16 = *(_QWORD *)(v5 + 8);
  if ( v16 )
    mbuf_setnextpkt(v16, v10);
  else
    *(_QWORD *)v5 = v10;
  *(_QWORD *)(v5 + 8) = v10;
  ++*(_DWORD *)(v5 + 20);
  v17 = (IO80211PeerManager *)*((_QWORD *)v7 + 5);
  if ( v17 && IO80211PeerManager::shouldLog(v17, 2560LL) )
  {
    v47 = *(_DWORD *)(v5 + 20);
    v48 = *(_DWORD *)(v5 + 24);
    v49 = OSIncrementAtomic(&_ucounter);
    v50 = *(_QWORD *)(a2 + 64);
    v33 = 1;
    v34 = 0;
    v35 = 0;
    v36 = v10;
    v37 = *(_DWORD *)(a2 + 44);
    v38 = 1;
    v46 = 0LL;
    v45 = 0LL;
    v44 = 0LL;
    v43 = 0LL;
    v42 = 0LL;
    v41 = 0LL;
    v39 = 0LL;
    LODWORD(v39) = 1572867;
    v40 = &v47;
    LODWORD(v18) = mbuf_data(v10);
    v19 = v18;
    v20 = *(_BYTE *)v18;
    if ( v20 & 1 )
    {
      if ( IO80211PeerManager::shouldLog(*((IO80211PeerManager **)v7 + 5), 2048LL) )
      {
        v21 = (IO80211PeerManager *)*((_QWORD *)v7 + 5);
        v22 = 0;
        if ( v21 )
        {
          v23 = IO80211PeerManager::shouldVerboseLog(v21, 2048LL);
          v24 = *((_QWORD *)v7 + 5);
          if ( v23 )
          {
            v22 = *(_DWORD *)(v24 + 432);
          }
          else
          {
            v22 = *(_DWORD *)(v24 + 424);
            if ( !*(_DWORD *)(v24 + 424) )
              v22 = getLengthBeforeSensitivePayload(0, v36);
          }
        }
        v34 = v22;
        v29 = *(_QWORD *)v7;
        v30 = (__int64)"  Tm     ";
LABEL_30:
        (*(void (__fastcall **)(void *, __int64, char *))(v29 + 312))(v7, v30, &v33);
        goto LABEL_31;
      }
      v20 = *(_BYTE *)v19;
    }
    if ( !(v20 & 1) && IO80211PeerManager::shouldLog(*((IO80211PeerManager **)v7 + 5), 512LL) )
    {
      v25 = (IO80211PeerManager *)*((_QWORD *)v7 + 5);
      v26 = 0;
      if ( v25 )
      {
        v27 = IO80211PeerManager::shouldVerboseLog(v25, 512LL);
        v28 = *((_QWORD *)v7 + 5);
        if ( v27 )
        {
          v26 = *(_DWORD *)(v28 + 432);
        }
        else
        {
          v26 = *(_DWORD *)(v28 + 424);
          if ( !*(_DWORD *)(v28 + 424) )
            v26 = getLengthBeforeSensitivePayload(0, v36);
        }
      }
      v34 = v26;
      v29 = *(_QWORD *)v7;
      v30 = (__int64)"  Tu     ";
      goto LABEL_30;
    }
  }
LABEL_31:
  ++*(_DWORD *)(*((_QWORD *)v7 + 5) + 936LL);
  v31 = *(_WORD *)(v6 + 48) & 8;
  if ( *(_DWORD *)(v5 + 20) >= *(_DWORD *)(v5 + 24) )
  {
    v8 = 1;
    if ( v31 )
      v8 = 15;
  }
  else
  {
    v8 = 12;
    if ( !v31 )
      v8 = 0;
  }
  return (unsigned int)v8;
}
// 84E7C: using guessed type _QWORD _ucounter;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C68: using guessed type int __fastcall mbuf_pkthdr_len(_QWORD);
// C8C88: using guessed type int __fastcall mbuf_pkthdr_setrcvif(_QWORD, _QWORD, _QWORD);
// C8CC0: using guessed type int __fastcall mbuf_setnextpkt(_QWORD, _QWORD);

//----- (0000000000042164) ----------------------------------------------------
__int64 __fastcall IO80211Peer::setState(IO80211Peer *this, int a2)
{
  *((_QWORD *)this + 18) = getAbsoluteTime();
  if ( a2 == 1 )
  {
    if ( *((_DWORD *)this + 27) > 0 )
      *((_DWORD *)this + 27) = 0;
  }
  else if ( !a2 && *((_DWORD *)this + 28) > 0 )
  {
    *((_DWORD *)this + 28) = 0;
  }
  *((_DWORD *)this + 26) = a2;
  return IO80211Peer::updateRequestBitField(this);
}

//----- (00000000000421B4) ----------------------------------------------------
signed __int64 __fastcall IO80211Peer::printHTandVHTFlags(__int64 a1, __int64 a2)
{
  __int64 v2; // r12@1
  char v3; // al@1
  __int64 i; // rcx@2
  __int16 v5; // ax@6
  __int64 v6; // r15@6
  unsigned int v7; // ebx@11
  unsigned int v8; // ebx@12
  char v9; // cl@13
  __int64 v10; // r8@16
  __int64 v11; // r9@16
  signed __int64 result; // rax@18
  char v13; // [sp+0h] [bp-40h]@18
  char v14; // [sp+4h] [bp-3Ch]@16
  char v15; // [sp+Eh] [bp-32h]@8
  __int64 v16; // [sp+18h] [bp-28h]@1

  v2 = off_7B078[0];
  v16 = *(_QWORD *)off_7B078[0];
  v3 = *(_BYTE *)(a1 + 433);
  if ( v3 )
  {
    for ( i = 0LL; v3 && (unsigned __int8)i <= 3u; ++i )
      v3 = *(_BYTE *)(a1 + i + 434);
    v5 = *(_WORD *)(a1 + 430);
    v6 = (__int64)"80";
    if ( !((v5 & 2u) >> 1) )
      v6 = (__int64)"20";
    snprintf(&v15, 0xAuLL, "%1ux%1uHT%2s", i);
  }
  else
  {
    snprintf(&v15, 0xAuLL, "NO");
    v6 = (__int64)"20";
  }
  if ( *(_BYTE *)(a1 + 474) )
  {
    v7 = 0;
    if ( (*(_WORD *)(a1 + 466) & 3) != 3 )
    {
      LOBYTE(v8) = 0;
      do
      {
        v9 = v8 + 2;
        v8 = (unsigned __int8)(v8 + 2);
      }
      while ( v8 <= 7 && ((3 << v9) & *(_WORD *)(a1 + 466)) != 3 << v9 );
      v7 = v8 >> 1;
    }
    snprintf(&v14, 0xAuLL, "%1ux%1uVHT%2s", v7, v7, v6);
  }
  else
  {
    snprintf(&v14, 0xAuLL, "NO");
  }
  _userPrint(a2, "HT: %s, VHT: %s ", (__int64)&v15, (__int64)&v14, v10, v11, v13);
  result = *(_QWORD *)v2;
  if ( *(_QWORD *)v2 == v16 )
    result = 1LL;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000042310) ----------------------------------------------------
__int64 __usercall IO80211Peer::print@<rax>(IO80211Peer *this@<rdi>, __int64 a2@<rsi>, __int64 a3@<r8>, __int64 a4@<r9>, __int64 a5@<r13>)
{
  __int64 v5; // r15@1
  IO80211Peer *v6; // r14@1
  __int64 v7; // rcx@1
  __int64 result; // rax@2
  __int64 v9; // rdx@3
  __int64 v10; // rbx@5
  bool v11; // zf@5
  __int64 v12; // rcx@5
  __int64 v13; // r8@5
  __int64 v14; // r9@5
  __int64 v15; // rax@5
  IO80211VirtualInterface *v16; // rdi@5
  char *v17; // rax@7
  char *v18; // rax@9
  IO80211Interface *v19; // rdi@10
  __int64 i; // rdx@12
  int v21; // ST18_4@13
  int v22; // ST10_4@13
  int v23; // ST08_4@13
  __int64 v24; // r9@13
  __int64 v25; // rbx@13
  __int64 v26; // rax@14
  __int64 v27; // rdx@14
  __int64 v28; // rcx@16
  unsigned int v29; // er12@19
  char v30; // ST00_1@19
  char v31; // ST00_1@19
  char v32; // ST00_1@19
  char v33; // ST00_1@19
  char v34; // ST00_1@19
  char v35; // ST00_1@19
  __int64 v36; // rax@19
  __int64 v37; // rdx@19
  __int64 v38; // rax@21
  __int64 v39; // rax@23
  __int64 v40; // r9@23
  __int64 v41; // r8@23
  __int64 v42; // rax@25
  int v43; // ST30_4@27
  int v44; // ST28_4@27
  int v45; // ST20_4@27
  int v46; // ST18_4@27
  int v47; // ST10_4@27
  int v48; // ST08_4@27
  unsigned int v49; // STD0_4@27
  unsigned int v50; // STC8_4@27
  unsigned int v51; // STC0_4@27
  __int16 v52; // STBC_2@27
  int v53; // STB8_4@27
  int v54; // STB4_4@27
  int v55; // STAC_4@27
  int v56; // STA8_4@27
  __int64 v57; // r13@27
  int v58; // er15@27
  int v59; // ebx@27
  __int64 v60; // rcx@27
  int v61; // STA4_4@27
  unsigned int v62; // STB0_4@27
  int v63; // et1@27
  int v64; // et1@27
  int v65; // et1@27
  int v66; // et1@27
  int v67; // STA0_4@27
  int v68; // ST9C_4@27
  int v69; // ST98_4@27
  int v70; // er12@27
  int v71; // ST88_4@27
  __int64 v72; // rdx@27
  __int64 v73; // rcx@27
  __int64 v74; // r8@27
  __int64 v75; // r9@27
  char v76; // ST00_1@27
  __int64 v77; // rdx@27
  __int64 v78; // rcx@27
  __int64 v79; // r8@27
  __int64 v80; // r9@27
  char v81; // ST00_1@27
  __int64 v82; // r15@27
  unsigned int v83; // STD0_4@29
  unsigned int v84; // STC8_4@29
  __int64 v85; // rbx@29
  __int64 v86; // rax@29
  int v87; // ST20_4@29
  int v88; // ST18_4@29
  int v89; // ST10_4@29
  int v90; // ST08_4@29
  __int64 v91; // rdx@29
  __int64 v92; // rcx@29
  __int64 v93; // r8@29
  __int64 v94; // r9@29
  char v95; // ST00_1@29
  signed int v96; // ebx@29
  __int64 v97; // r9@32
  __int64 v98; // r8@30
  __int64 v99; // rdx@32
  __int64 v100; // rcx@32
  __int64 v101; // r8@32
  __int64 v102; // r9@32
  __int64 v103; // r8@33
  __int64 v104; // r9@33
  __int64 v105; // rdx@33
  __int64 v106; // rcx@33
  __int64 v107; // r8@36
  __int64 v108; // r9@36
  __int64 v109; // rcx@36
  __int64 v110; // r8@37
  __int64 v111; // r9@37
  int v112; // ebx@37
  __int64 v113; // r12@37
  __int64 v114; // rdx@38
  signed __int64 v115; // r15@40
  __int64 v116; // rdx@40
  __int64 v117; // rcx@40
  int v118; // ebx@41
  __int64 v119; // r8@41
  __int64 v120; // r9@41
  __int64 v121; // rdx@42
  __int64 v122; // rdx@44
  __int64 v123; // rcx@44
  int v124; // er15@45
  __int64 v125; // r8@45
  __int64 v126; // r9@45
  __int64 v127; // rdx@46
  signed __int64 v128; // rbx@48
  __int64 v129; // rdx@48
  __int64 v130; // rcx@48
  int v131; // er15@49
  __int64 v132; // r8@49
  __int64 v133; // r9@49
  __int64 v134; // rdx@50
  __int64 v135; // rdx@52
  __int64 v136; // rcx@52
  __int64 v137; // rbx@54
  __int64 v138; // rdx@54
  __int64 v139; // rcx@54
  __int64 v140; // r8@54
  __int64 v141; // r9@54
  __int64 v142; // r8@55
  __int64 v143; // r9@55
  int v144; // ebx@55
  __int64 v145; // rdx@56
  __int64 v146; // rdx@58
  __int64 v147; // rcx@58
  __int64 v148; // r12@60
  __int64 v149; // r8@60
  char v150; // al@60
  __int64 v151; // r9@60
  signed int v152; // esi@60
  __int64 v153; // rcx@61
  signed __int64 v154; // rdi@61
  signed __int64 v155; // rbx@61
  __int64 v156; // rcx@61
  __int64 v157; // rdx@62
  __int64 v158; // r12@64
  unsigned int v159; // ebx@65
  __int64 v160; // rcx@65
  unsigned int v161; // esi@65
  unsigned int v162; // edi@65
  unsigned int v163; // ebx@65
  __int64 v164; // r12@66
  __int64 v165; // rbx@67
  __int64 v166; // rdi@68
  __int64 v167; // rbx@71
  char v168; // al@72
  __int64 v169; // rcx@72
  __int64 v170; // r8@72
  __int64 v171; // r9@72
  __int64 v172; // r9@72
  __int64 v173; // rbx@72
  __int64 v174; // rdx@73
  __int64 v175; // r8@75
  __int64 v176; // rbx@78
  __int64 v177; // rdx@79
  __int64 v178; // r8@81
  __int64 v179; // rbx@84
  __int64 v180; // rdx@85
  __int64 v181; // r8@87
  __int64 v182; // rdx@89
  __int64 v183; // rcx@89
  __int64 v184; // r8@89
  IO80211Interface *v185; // rdi@91
  __int64 v186; // rdx@93
  char v187; // [sp+0h] [bp-160h]@0
  char v188; // [sp+0h] [bp-160h]@13
  char v189; // [sp+0h] [bp-160h]@19
  char v190; // [sp+0h] [bp-160h]@29
  char v191; // [sp+0h] [bp-160h]@33
  char v192; // [sp+0h] [bp-160h]@36
  char v193; // [sp+0h] [bp-160h]@37
  char v194; // [sp+0h] [bp-160h]@41
  char v195; // [sp+0h] [bp-160h]@45
  char v196; // [sp+0h] [bp-160h]@49
  char v197; // [sp+0h] [bp-160h]@55
  char v198; // [sp+0h] [bp-160h]@60
  char v199; // [sp+0h] [bp-160h]@66
  char v200; // [sp+0h] [bp-160h]@72
  __int64 v201; // [sp+D0h] [bp-90h]@37
  __int64 v202; // [sp+D8h] [bp-88h]@27
  unsigned int v203; // [sp+E0h] [bp-80h]@16
  unsigned int v204; // [sp+E4h] [bp-7Ch]@19
  unsigned int v205; // [sp+E8h] [bp-78h]@19
  unsigned int v206; // [sp+ECh] [bp-74h]@19
  __int64 v207; // [sp+F0h] [bp-70h]@1
  __int64 v208; // [sp+F8h] [bp-68h]@1
  __int64 v209; // [sp+100h] [bp-60h]@1
  __int64 v210; // [sp+108h] [bp-58h]@1
  __int64 v211; // [sp+110h] [bp-50h]@1
  __int64 v212; // [sp+118h] [bp-48h]@1
  __int64 v213; // [sp+120h] [bp-40h]@1
  __int64 v214; // [sp+128h] [bp-38h]@1
  __int64 v215; // [sp+130h] [bp-30h]@1

  v5 = a2;
  v6 = this;
  v7 = off_7B078[0];
  v215 = *(_QWORD *)off_7B078[0];
  v214 = 0LL;
  v213 = 0LL;
  v212 = 0LL;
  v211 = 0LL;
  v210 = 0LL;
  v209 = 0LL;
  v208 = 0LL;
  v207 = 0LL;
  if ( *(_BYTE *)(a2 + 48) & 0x10 )
  {
    result = 0LL;
    if ( !*((_BYTE *)this + 522) )
      goto LABEL_96;
  }
  v9 = *(_QWORD *)(a2 + 80);
  if ( v9 )
    _userPrint(a2, "%s", v9, off_7B078[0], a3, a4, v187);
  v10 = *((_QWORD *)this + 16);
  a5 = (unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v10)) >> 64;
  v11 = memcmp((char *)this + 32, &null_address, 6uLL) == 0;
  v15 = *((_QWORD *)this + 5);
  v16 = *(IO80211VirtualInterface **)(v15 + 128);
  if ( v11 )
  {
    if ( v16 )
    {
      v18 = IO80211VirtualInterface::getBSDName(v16);
    }
    else
    {
      v185 = *(IO80211Interface **)(v15 + 136);
      if ( !v185 )
      {
        v186 = (__int64)"unknown";
        goto LABEL_94;
      }
      v18 = IO80211Interface::getBSDName(v185, v15);
    }
    v186 = (__int64)v18;
LABEL_94:
    _userPrint(a2, "<%s>\n", v186, v12, v13, v14, v187);
    v167 = a2;
    goto LABEL_95;
  }
  a5 = (unsigned __int64)a5 >> 18;
  if ( v16 )
  {
    v17 = IO80211VirtualInterface::getBSDName(v16);
  }
  else
  {
    v19 = *(IO80211Interface **)(v15 + 136);
    if ( !v19 )
      goto LABEL_97;
    v17 = IO80211Interface::getBSDName(v19, v15);
  }
  for ( i = (__int64)v17; ; i = (__int64)"unknown" )
  {
    v21 = *((_BYTE *)v6 + 37);
    v22 = *((_BYTE *)v6 + 36);
    v23 = *((_BYTE *)v6 + 35);
    _userPrint(
      v5,
      "\x1B[1;30;48m<%s> peer %u: %02X:%02X:%02X:%02X:%02X:%02X\x1B[m\n",
      i,
      *((_DWORD *)v6 + 62),
      *((_BYTE *)v6 + 32),
      *((_BYTE *)v6 + 33),
      *((_BYTE *)v6 + 34));
    v25 = 0LL;
    do
    {
      v26 = *((_QWORD *)v6 + v25 + 6);
      v27 = 0LL;
      if ( v26 )
        v27 = *(_DWORD *)(v26 + 52);
      *(&v203 + v25) = v27;
      v28 = *((_WORD *)v6 + v25 + 40);
      if ( (unsigned int)v27 < (unsigned int)v28 )
        _userPrint(v5, "queue size error: qsize %u num_host %u ac %u\n", v27, v28, (unsigned int)v25, v24, v188);
      ++v25;
    }
    while ( v25 != 4 );
    v29 = 0;
    _userPrint(
      v5,
      "   input .... [%u %u %u %u]\n",
      *((_DWORD *)v6 + 144),
      *((_DWORD *)v6 + 145),
      *((_DWORD *)v6 + 146),
      *((_DWORD *)v6 + 147),
      v188);
    _userPrint(
      v5,
      "   outok .... [%u %u %u %u]\n",
      *((_DWORD *)v6 + 136),
      *((_DWORD *)v6 + 137),
      *((_DWORD *)v6 + 138),
      *((_DWORD *)v6 + 139),
      v30);
    _userPrint(
      v5,
      "   outerr ... [%u %u %u %u]\n",
      *((_DWORD *)v6 + 140),
      *((_DWORD *)v6 + 141),
      *((_DWORD *)v6 + 142),
      *((_DWORD *)v6 + 143),
      v31);
    _userPrint(
      v5,
      "   suppress . [%u %u %u %u]\n",
      *((_DWORD *)v6 + 148),
      *((_DWORD *)v6 + 149),
      *((_DWORD *)v6 + 150),
      *((_DWORD *)v6 + 151),
      v32);
    _userPrint(v5, "   queue .... [%u %u %u %u]\n", v203, v204, v205, v206, v33);
    _userPrint(
      v5,
      "   pending .. [%u %u %u %u]\n",
      *((_WORD *)v6 + 40),
      *((_WORD *)v6 + 41),
      *((_WORD *)v6 + 42),
      *((_WORD *)v6 + 43),
      v34);
    _userPrint(
      v5,
      "   dequeuable [%u %u %u %u]\n",
      *((_WORD *)v6 + 44),
      *((_WORD *)v6 + 45),
      *((_WORD *)v6 + 46),
      *((_WORD *)v6 + 47),
      v35);
    v36 = *((_QWORD *)v6 + 6);
    v37 = 0LL;
    if ( v36 )
      v37 = (unsigned __int16)(*(_DWORD *)(v36 + 52) - *((_WORD *)v6 + 40));
    v38 = *((_QWORD *)v6 + 7);
    if ( v38 )
      v29 = (unsigned __int16)(*(_DWORD *)(v38 + 52) - *((_WORD *)v6 + 41));
    v39 = *((_QWORD *)v6 + 8);
    v40 = 0LL;
    v41 = 0LL;
    if ( v39 )
      v41 = (unsigned __int16)(*(_DWORD *)(v39 + 52) - *((_WORD *)v6 + 42));
    v42 = *((_QWORD *)v6 + 9);
    if ( v42 )
      v40 = (unsigned __int16)(*(_DWORD *)(v42 + 52) - *((_WORD *)v6 + 43));
    _userPrint(v5, "   in-flight  [%u %u %u %u]\n", v37, v29, v41, v40, v189);
    v43 = *((_DWORD *)v6 + 30);
    v44 = *((_DWORD *)v6 + 152);
    v45 = *((_DWORD *)v6 + 51);
    v46 = *((_DWORD *)v6 + 50);
    v47 = *((_DWORD *)v6 + 114);
    v48 = *((_BYTE *)v6 + 475);
    _userPrint(
      v5,
      "           Last Activity: %u.%3u cached %u ht %u txOk %u ampdu %u/%u txerr %u txgiveup %u outok %u flushed %u\n",
      (unsigned int)a5 / 0x3E8uLL,
      (unsigned int)a5 % 0x3E8,
      *((_BYTE *)v6 + 522),
      *((_BYTE *)v6 + 429),
      *((_BYTE *)v6 + 477));
    v49 = *((_BYTE *)v6 + 477);
    v50 = *((_DWORD *)v6 + 28) != 0;
    v51 = *((_DWORD *)v6 + 26);
    v52 = *((_WORD *)v6 + 40);
    v53 = *((_WORD *)v6 + 41);
    v54 = *((_WORD *)v6 + 42);
    v55 = *((_WORD *)v6 + 43);
    v56 = *((_BYTE *)v6 + 478) ^ 1;
    v202 = v5;
    v57 = *((_BYTE *)v6 + 479) ^ 1u;
    v58 = *((_BYTE *)v6 + 480) ^ 1;
    v59 = *((_BYTE *)v6 + 481) ^ 1;
    v60 = *((_QWORD *)v6 + 5);
    v61 = *(_BYTE *)(v60 + 560);
    v62 = *((_DWORD *)v6 + 27) != 0;
    v63 = *(_DWORD *)(v60 + 152);
    v64 = *(_DWORD *)(v60 + 152);
    v65 = *(_DWORD *)(v60 + 152);
    v66 = *(_DWORD *)(v60 + 152);
    v67 = *(_DWORD *)(v60 + 152) != 0;
    v68 = (unsigned __int8)(*(int (__fastcall **)(IO80211Peer *, _QWORD, _QWORD))(*(_QWORD *)v6 + 384LL))(v6, 0LL, 0LL);
    v69 = (unsigned __int8)(*(int (__fastcall **)(IO80211Peer *, signed __int64, _QWORD))(*(_QWORD *)v6 + 384LL))(
                             v6,
                             1LL,
                             0LL);
    v70 = (unsigned __int8)(*(int (__fastcall **)(IO80211Peer *, signed __int64, _QWORD))(*(_QWORD *)v6 + 384LL))(
                             v6,
                             2LL,
                             0LL);
    v71 = (unsigned __int8)(*(int (__fastcall **)(IO80211Peer *, signed __int64, _QWORD))(*(_QWORD *)v6 + 384LL))(
                             v6,
                             3LL,
                             0LL);
    _userPrint(
      v202,
      "    tOK=%u cred=[%u %u][%u] hp=[%u %u %u %u] !wtx=[%u %u %u %u] dp=%u bm=[%u %u %u %u %u]--> [%u %u %u %u] \n",
      v49,
      v50,
      v62,
      v51,
      v52);
    _userPrint(v202, "           ", v72, v73, v74, v75, v76);
    (*(void (__fastcall **)(IO80211Peer *, __int64))(*(_QWORD *)v6 + 304LL))(v6, v202);
    _userPrint(v202, "\n", v77, v78, v79, v80, v81);
    v82 = (__int64)"PMClose";
    if ( !*((_DWORD *)v6 + 26) )
      v82 = (__int64)"PMOpen";
    v83 = *((_DWORD *)v6 + 27);
    v84 = *((_DWORD *)v6 + 28);
    v85 = *((_QWORD *)v6 + 18);
    v86 = getAbsoluteTime();
    v87 = *((_DWORD *)v6 + 50);
    v88 = *((_DWORD *)v6 + 53);
    v89 = *((_DWORD *)v6 + 52);
    v90 = *((_DWORD *)v6 + 54);
    _userPrint(
      v202,
      "      pm state %s credits open %d close %d last update %ums gen %u numTx %u numTxStatus %u/%u numTxStatusError %u \n",
      v82,
      v84,
      v83,
      (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (v86 - v85)) >> 64) >> 18),
      *((_BYTE *)v6 + 116));
    _userPrint(v202, "         maxTxStatus latency (ms) [", v91, v92, v93, v94, v95);
    v96 = -8;
    v5 = (__int64)" ";
    do
    {
      v98 = (__int64)" ";
      if ( v96 == -1 )
        v98 = (__int64)"]\n";
      v97 = (unsigned __int64)(4835703278458516699LL
                             * (unsigned __int128)*((_QWORD *)v6
                                                  + (((unsigned __int8)v96
                                                    + (unsigned __int8)*(_DWORD *)(*((_QWORD *)v6 + 5) + 648LL)
                                                    + 9) & 7)
                                                  + 127) >> 64) >> 18;
      _userPrint(
        v202,
        "%llu.%03llu%s",
        v97,
        2361183241434822607LL
      * ((unsigned __int64)(*((_QWORD *)v6
                            + (((unsigned __int8)v96++ + (unsigned __int8)*(_DWORD *)(*((_QWORD *)v6 + 5) + 648LL) + 9) & 7)
                            + 127)
                          - 1000000 * v97) >> 3) >> 64 >> 4,
        v98,
        v97,
        v190);
    }
    while ( v96 );
    _userPrint(v202, "\n", v99, v100, v101, v102, v190);
    v105 = *((_DWORD *)v6 + 133);
    v106 = *((_DWORD *)v6 + 134);
    if ( __PAIR__(*((_DWORD *)v6 + 134), *((_DWORD *)v6 + 133)) || (v106 = 0LL, *((_DWORD *)v6 + 135)) )
      _userPrint(v202, "      Bonjour packets: urx %u utx %u mrx %u\n", v105, v106, *((_DWORD *)v6 + 135), v104, v191);
    _userPrint(v202, "     data-path history:\n\x1B[0;90;48m", v105, v106, v103, v104, v191);
    v109 = 0LL;
    do
    {
      v201 = v109;
      _userPrint(v202, "        AC=%u: rx [", v109, v109, v107, v108, v192);
      v112 = 0;
      v113 = v5;
      do
      {
        v114 = (__int64)&byte_690F5;
        if ( v112 )
          v114 = v113;
        v115 = (signed __int64)((char *)v6 + 16 * v201);
        _userPrint(
          v202,
          "%s%4u",
          v114,
          *(_WORD *)(v115 + 2LL * (((_BYTE)v112-- + (unsigned __int8)*(_DWORD *)(*((_QWORD *)v6 + 5) + 648LL)) & 7) + 676),
          v110,
          v111,
          v193);
      }
      while ( v112 != -8 );
      v118 = 0;
      _userPrint(v202, "] tx [", v116, v117, v110, v111, v193);
      do
      {
        v121 = (__int64)&byte_690F5;
        if ( v118 )
          v121 = v113;
        _userPrint(
          v202,
          "%s%4u",
          v121,
          *(_WORD *)(v115 + 2LL * (((_BYTE)v118-- + (unsigned __int8)*(_DWORD *)(*((_QWORD *)v6 + 5) + 648LL)) & 7) + 612),
          v119,
          v120,
          v194);
      }
      while ( v118 != -8 );
      v124 = 0;
      _userPrint(v202, "] rxB [", v122, v123, v119, v120, v194);
      do
      {
        v127 = (__int64)&byte_690F5;
        if ( v124 )
          v127 = v113;
        v128 = (signed __int64)((char *)v6 + 32 * v201);
        _userPrint(
          v202,
          "%s%7u",
          v127,
          *(_DWORD *)(v128
                    + 4LL * (((_BYTE)v124-- + (unsigned __int8)*(_DWORD *)(*((_QWORD *)v6 + 5) + 648LL)) & 7)
                    + 868),
          v125,
          v126,
          v195);
      }
      while ( v124 != -8 );
      v131 = 0;
      _userPrint(v202, "] txB [", v129, v130, v125, v126, v195);
      do
      {
        v134 = (__int64)&byte_690F5;
        if ( v131 )
          v134 = v113;
        _userPrint(
          v202,
          "%s%7u",
          v134,
          *(_DWORD *)(v128
                    + 4LL * (((_BYTE)v131-- + (unsigned __int8)*(_DWORD *)(*((_QWORD *)v6 + 5) + 648LL)) & 7)
                    + 740),
          v132,
          v133,
          v196);
      }
      while ( v131 != -8 );
      v5 = v113;
      _userPrint(v202, "]\n", v135, v136, v132, v133, v196);
      v109 = v201 + 1;
    }
    while ( v201 != 3 );
    v137 = v202;
    if ( IO80211PeerManager::isInfraRedirectSupported(*((IO80211PeerManager **)v6 + 5)) )
    {
      _userPrint(v202, "            txRedirect [", v138, v139, v140, v141, v192);
      v144 = 0;
      do
      {
        v145 = (__int64)&byte_690F5;
        if ( v144 )
          v145 = v113;
        _userPrint(
          v202,
          "%s%u",
          v145,
          *((_WORD *)v6
          + (((unsigned __int8)v144++ + (unsigned __int8)*(_DWORD *)(*((_QWORD *)v6 + 5) + 648LL)) & 7)
          + 498),
          v142,
          v143,
          v197);
      }
      while ( v144 != 8 );
      v137 = v202;
      _userPrint(v202, "]\n", v146, v147, v142, v143, v197);
    }
    v148 = v137;
    _userPrint(v137, "\x1B[m", v138, v139, v140, v141, v192);
    v149 = (__int64)((char *)v6 + 676);
    v150 = *(_DWORD *)(*((_QWORD *)v6 + 5) + 648LL) + 1;
    v151 = (__int64)((char *)v6 + 868);
    v152 = 1;
    do
    {
      v153 = v150 & 7;
      v154 = v149 + 2 * v153;
      v155 = v151 + 4 * v153;
      v156 = 0LL;
      do
      {
        *(_DWORD *)((char *)&v213 + v156) += *(_WORD *)(v154 + 4 * v156 - 64);
        *(_DWORD *)((char *)&v211 + v156) += *(_WORD *)(v154 + 4 * v156);
        *(_DWORD *)((char *)&v209 + v156) += *(_DWORD *)(v155 + 8 * v156 - 128);
        v157 = *(_DWORD *)(v155 + 8 * v156);
        *(_DWORD *)((char *)&v207 + v156) += v157;
        v156 += 4LL;
      }
      while ( v156 != 16 );
      ++v152;
      ++v150;
    }
    while ( v152 != 8 );
    a5 = v148;
    _userPrint(v148, "           averages: \n", v157, 16LL, v149, v151, v198);
    v158 = 0LL;
    do
    {
      v159 = *(_DWORD *)(*((_QWORD *)v6 + 5) + 688LL);
      v160 = 1000 * (*((_DWORD *)&v213 + v158) / 7u) / v159;
      *((_DWORD *)&v213 + v158) = v160;
      v161 = 1000 * (*((_DWORD *)&v211 + v158) / 7u) / v159;
      *((_DWORD *)&v211 + v158) = v161;
      v162 = 1000 * (*((_DWORD *)&v209 + v158) / 7u) / v159;
      *((_DWORD *)&v209 + v158) = v162;
      v163 = 1000 * (*((_DWORD *)&v207 + v158) / 7u) / v159;
      *((_DWORD *)&v207 + v158) = v163;
      _userPrint(
        a5,
        "                (Pkt/sec) in %4u out %4u   thruput(MBits/sec) In %3u.%06u Out %3u.%06u \n",
        v161,
        v160,
        8 * v163 / 0xF4240uLL,
        8 * v163 % 0xF4240,
        8 * v162 / 0xF4240);
      ++v158;
    }
    while ( v158 != 4 );
    _userPrint(
      a5,
      "       pkts sched stats: qt %u open %u/%u close %u/%u ",
      *((_DWORD *)v6 + 57),
      *((_DWORD *)v6 + 60),
      *((_DWORD *)v6 + 58),
      *((_DWORD *)v6 + 61),
      *((_DWORD *)v6 + 59));
    v164 = a5;
    if ( *(_BYTE *)(a5 + 48) & 2 )
    {
      v165 = 0LL;
      do
      {
        v166 = *((_QWORD *)v6 + v165 + 6);
        if ( v166 )
          IO80211CommandQueue::print(v166, a5);
        ++v165;
      }
      while ( v165 != 4 );
    }
    v167 = a5;
    if ( *((_DWORD *)v6 + 271) )
    {
      v168 = IO80211Peer::getRssi(v6);
      _userPrint(a5, "       RSSI %3d ", (unsigned int)v168, v169, v170, v171, v199);
      a5 = (__int64)"]";
      v173 = 0LL;
      do
      {
        v174 = (__int64)" [";
        if ( (_DWORD)v173 )
          v174 = v5;
        v175 = v5;
        if ( (_DWORD)v173 == 15 )
          v175 = (__int64)"]";
        _userPrint(v164, "%s%3d%s", v174, *((_BYTE *)v6 + v173++ + 1104), v175, v172, v200);
      }
      while ( v173 != 16 );
      v176 = 0LL;
      do
      {
        v177 = (__int64)" 2.4GHz [";
        if ( (_DWORD)v176 )
          v177 = v5;
        v178 = v5;
        if ( (_DWORD)v176 == 15 )
          v178 = (__int64)"]";
        _userPrint(v164, "%s%3d%s", v177, *((_BYTE *)v6 + v176++ + 1136), v178, v172, v200);
      }
      while ( v176 != 16 );
      v179 = 0LL;
      do
      {
        v180 = (__int64)" 5GHz [";
        if ( (_DWORD)v179 )
          v180 = v5;
        v181 = v5;
        if ( (_DWORD)v179 == 15 )
          v181 = (__int64)"]";
        _userPrint(v164, "%s%3d%s", v180, *((_BYTE *)v6 + v179++ + 1120), v181, v172, v200);
      }
      while ( v179 != 16 );
      _userPrint(v164, "\n", v182, v183, v184, v172, v200);
      v167 = v164;
    }
LABEL_95:
    result = *(_DWORD *)(v167 + 40);
    v7 = off_7B078[0];
LABEL_96:
    if ( *(_QWORD *)v7 == v215 )
      break;
LABEL_97:
    ;
  }
  return result;
}
// 690F5: using guessed type char byte_690F5;
// 77FDC: using guessed type int null_address;
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000004303A) ----------------------------------------------------
void __fastcall IO80211Peer::print(IO80211Peer *this)
{
  ;
}

//----- (0000000000043040) ----------------------------------------------------
__int64 __fastcall IO80211Peer::MetaClass::~MetaClass(IO80211Peer::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000043050) ----------------------------------------------------
__int64 `global constructor keyed to'_a_8()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IO80211Peer::gMetaClass, "IO80211Peer", &IO80211QueueDescriptor::gMetaClass, 1152LL);
  result = (__int64)off_7D4C0;
  IO80211Peer::gMetaClass = off_7D4C0;
  return result;
}
// 7D4C0: using guessed type __int64 (__fastcall *off_7D4C0[2])(IO80211Peer::MetaClass *__hidden this);
// 84458: using guessed type _QWORD IO80211Peer::gMetaClass;
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000043090) ----------------------------------------------------
__int64 `global destructor keyed to'_a_8()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211Peer::gMetaClass);
}
// 84458: using guessed type _QWORD IO80211Peer::gMetaClass;

//----- (00000000000430B0) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::MetaClass::MetaClass(IO80211PeerManager::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211PeerManager", &IO80211QueueDescriptor::gMetaClass, 1032LL);
  result = (__int64)off_7D800;
  *(_QWORD *)this = off_7D800;
  return result;
}
// 7D800: using guessed type __int64 (__fastcall *off_7D800[2])(IO80211PeerManager::MetaClass *__hidden this);
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000430E2) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::MetaClass::~MetaClass(IO80211PeerManager::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000430EC) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::IO80211PeerManager(__int64 a1)
{
  __int64 result; // rax@1

  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  result = (__int64)off_7D5C0;
  *(_QWORD *)a1 = off_7D5C0;
  return result;
}
// 7D5C0: using guessed type __int64 (__fastcall *off_7D5C0[2])(IO80211PeerManager *__hidden this);

//----- (000000000004310C) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::IO80211PeerManager(__int64 a1)
{
  __int64 result; // rax@1

  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  result = (__int64)off_7D5C0;
  *(_QWORD *)a1 = off_7D5C0;
  return result;
}
// 7D5C0: using guessed type __int64 (__fastcall *off_7D5C0[2])(IO80211PeerManager *__hidden this);

//----- (000000000004312C) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::~IO80211PeerManager(IO80211PeerManager *this)
{
  return IO80211QueueDescriptor::~IO80211QueueDescriptor(this);
}

//----- (0000000000043136) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::~IO80211PeerManager(IO80211PeerManager *this)
{
  return IO80211QueueDescriptor::~IO80211QueueDescriptor(this);
}

//----- (0000000000043140) ----------------------------------------------------
void __fastcall IO80211PeerManager::~IO80211PeerManager(IO80211PeerManager *this)
{
  IO80211QueueDescriptor::~IO80211QueueDescriptor(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000043162) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::getMetaClass(IO80211PeerManager *this)
{
  return (__int64)&IO80211PeerManager::gMetaClass;
}
// 84480: using guessed type _QWORD IO80211PeerManager::gMetaClass;

//----- (0000000000043170) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::MetaClass::MetaClass(IO80211PeerManager::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211PeerManager", &IO80211QueueDescriptor::gMetaClass, 1032LL);
  result = (__int64)off_7D800;
  *(_QWORD *)this = off_7D800;
  return result;
}
// 7D800: using guessed type __int64 (__fastcall *off_7D800[2])(IO80211PeerManager::MetaClass *__hidden this);
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000431A2) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::MetaClass::alloc(IO80211PeerManager::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_3D0.maxprot, a2);
  IO80211QueueDescriptor::IO80211QueueDescriptor(v2);
  *(_QWORD *)v2 = off_7D5C0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211PeerManager::gMetaClass);
  return v2;
}
// 3D0: using guessed type segment_command_64;
// 7D5C0: using guessed type __int64 (__fastcall *off_7D5C0[2])(IO80211PeerManager *__hidden this);
// 84480: using guessed type _QWORD IO80211PeerManager::gMetaClass;

//----- (00000000000431E2) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::IO80211PeerManager(__int64 a1)
{
  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  *(_QWORD *)a1 = off_7D5C0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211PeerManager::gMetaClass);
}
// 7D5C0: using guessed type __int64 (__fastcall *off_7D5C0[2])(IO80211PeerManager *__hidden this);
// 84480: using guessed type _QWORD IO80211PeerManager::gMetaClass;

//----- (0000000000043212) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::IO80211PeerManager(__int64 a1)
{
  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  *(_QWORD *)a1 = off_7D5C0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211PeerManager::gMetaClass);
}
// 7D5C0: using guessed type __int64 (__fastcall *off_7D5C0[2])(IO80211PeerManager *__hidden this);
// 84480: using guessed type _QWORD IO80211PeerManager::gMetaClass;

//----- (0000000000043242) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::withInterface(IO80211PeerManager *this, IO80211VirtualInterface *a2, IO80211Interface *a3)
{
  __int64 v3; // rbx@1

  v3 = OSObject::operator new((OSObject *)&stru_3D0.maxprot, (unsigned __int64)a2);
  IO80211QueueDescriptor::IO80211QueueDescriptor(v3);
  *(_QWORD *)v3 = off_7D5C0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211PeerManager::gMetaClass);
  if ( v3 && !IO80211PeerManager::initWithInterface((IO80211PeerManager *)v3, this, a2) )
  {
    (*(void (__fastcall **)(__int64, IO80211PeerManager *))(*(_QWORD *)v3 + 40LL))(v3, this);
    v3 = 0LL;
  }
  return v3;
}
// 3D0: using guessed type segment_command_64 stru_3D0;
// 7D5C0: using guessed type __int64 (__fastcall *off_7D5C0[2])(IO80211PeerManager *__hidden this);
// 84480: using guessed type _QWORD IO80211PeerManager::gMetaClass;

//----- (00000000000432B2) ----------------------------------------------------
char __fastcall IO80211PeerManager::initWithInterface(IO80211PeerManager *this, IO80211VirtualInterface *a2, IO80211Interface *a3)
{
  IO80211Interface *v3; // r12@1
  IO80211PeerManager *v4; // rbx@1
  __int64 v5; // r13@1
  OSMetaClass *v6; // rax@1
  __int64 v7; // rax@1
  char v8; // r14@1
  int (__cdecl *v9)(OSObject *, void *, void *, void *, void *); // rdx@1
  IO80211PeerManager *v10; // rax@7
  IO80211PeerManager *v11; // rax@9
  __int64 v12; // rax@11
  __int64 v13; // rax@12
  OSMetaClass *v14; // rax@14
  __int64 v15; // rax@14
  __int64 v16; // r8@14
  __int64 v17; // r9@14
  __int16 v18; // ax@15
  OSMetaClass *v19; // rax@16
  __int64 v20; // rax@16
  __int64 v21; // r8@16
  __int64 v22; // r9@16
  OSMetaClass *v23; // rax@18
  __int64 v24; // rax@18
  __int64 v25; // r8@18
  __int64 v26; // r9@18
  IO80211AWDLPeerManager *v27; // r12@19
  OSMetaClass *v28; // rax@20
  __int64 v29; // rax@20
  __int64 v30; // r8@20
  __int64 v31; // r9@20
  __int64 v32; // r13@21
  signed __int16 v33; // r14@21
  OSMetaClass *v34; // rax@22
  __int64 v35; // rsi@22
  __int64 v36; // r8@22
  __int64 v37; // r9@22
  IO80211CommandQueue *v38; // rdi@24
  unsigned __int64 v39; // rsi@25
  IO80211CommandQueue *v40; // rax@25
  signed int v41; // er15@27
  __int64 v42; // rbx@28
  OSMetaClass *v43; // rax@32
  __int64 v44; // rsi@32
  __int64 v45; // r8@32
  __int64 v46; // r9@32
  OSMetaClass *v47; // rax@33
  __int64 v48; // rsi@33
  __int64 v49; // r8@33
  __int64 v50; // r9@33
  int v51; // eax@36
  __int64 v52; // r15@36
  __int64 v53; // rbx@37
  __int64 v54; // rax@39
  OSMetaClass *v55; // rax@40
  __int64 v56; // rsi@40
  __int64 v57; // r9@40
  IO80211VirtualInterface *v58; // rdi@42
  __int64 i; // rax@44
  OSMetaClass *v60; // rax@46
  __int64 v61; // rax@46
  __int64 v62; // r8@46
  __int64 v63; // r9@46
  __int64 v65; // rax@51
  __int64 v66; // rax@52
  __int64 v67; // rax@52
  IO80211Interface *v68; // rdi@52
  __int64 v69; // rax@53
  IO80211PeerManager *v70; // rsi@53
  IO80211PeerManager *v71; // rdx@53
  __int64 v72; // rax@53
  OSMetaClass *v73; // rax@56
  __int64 v74; // rax@56
  __int64 v75; // r8@56
  __int64 v76; // r9@56
  IO80211VirtualInterface *v77; // rdi@57
  IO80211PeerManager *v78; // rdx@58
  __int64 v79; // rax@60
  OSMetaClass *v80; // rax@62
  __int64 v81; // rcx@62
  __int64 v82; // r8@62
  __int64 v83; // r9@62
  __int64 v84; // rdi@62
  IO80211CommandQueue *v85; // rax@63
  IO80211CommandQueue *v86; // rax@64
  __int64 v87; // rax@67
  IO80211CommandQueue *v88; // rax@68
  IO80211CommandQueue *v89; // rax@69
  __int64 v90; // rax@70
  void (__fastcall *v91)(IO80211PeerManager *); // rsi@71
  __int64 v92; // rax@71
  IO80211Interface *v93; // rdi@72
  __int64 v94; // rax@73
  __int64 v95; // rax@73
  IO80211VirtualInterface *v96; // rdi@74
  __int64 v97; // rax@75
  __int64 v98; // rax@76
  Stopwatch *v99; // rax@76
  unsigned __int64 v100; // rsi@76
  Stopwatch *v101; // rdi@76
  OSMetaClass *v102; // rax@77
  OSMetaClass *v103; // rax@78
  OSMetaClass *v104; // rax@79
  OSMetaClass *v105; // rax@80
  __int64 v106; // r8@80
  __int64 v107; // r9@80
  unsigned int v108; // eax@81
  __int64 v109; // rax@81
  __int64 v110; // rdi@81
  __int64 v111; // rax@82
  int v112; // er12@83
  char *v113; // rax@85
  OSMetaClass *v114; // rax@86
  __int64 v115; // r15@86
  char *v116; // rax@86
  __int64 v117; // r9@86
  OSMetaClass *v118; // rax@87
  __int64 v119; // rax@87
  __int64 v120; // r9@87
  OSMetaClass *v121; // rax@88
  OSMetaClass *v122; // rax@89
  OSMetaClass *v123; // rax@90
  int v124; // [sp+8h] [bp-98h]@27
  unsigned int v125; // [sp+24h] [bp-7Ch]@27
  int v126; // [sp+28h] [bp-78h]@83
  unsigned int v127; // [sp+2Ch] [bp-74h]@13
  char v128; // [sp+30h] [bp-70h]@85
  char v129; // [sp+31h] [bp-6Fh]@85
  char v130; // [sp+32h] [bp-6Eh]@85
  char v131; // [sp+33h] [bp-6Dh]@85
  __int64 v132; // [sp+70h] [bp-30h]@1

  v3 = a3;
  v4 = this;
  v5 = off_7B078[0];
  v132 = *(_QWORD *)off_7B078[0];
  LODWORD(v6) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
  v7 = OSMetaClass::getClassName(v6);
  v8 = 0;
  IO80211PeerManager::logDebug(
    this,
    0x2000000000LL,
    "%s::%s will init peer manager vifc %p ifc %p\n",
    v7,
    (__int64)"initWithInterface",
    (__int64)a2);
  if ( !(unsigned __int8)((int (__fastcall *)(IO80211PeerManager *, signed __int64))`vtable for'IO80211QueueDescriptor[19])(
                           this,
                           0x2000000000LL) )
    goto LABEL_47;
  if ( a2 )
  {
    *((_QWORD *)this + 16) = a2;
  }
  else if ( v3 )
  {
    *((_QWORD *)this + 17) = v3;
  }
  if ( !*((_QWORD *)this + 88) )
  {
    *((_DWORD *)this + 180) = 1;
    LODWORD(v10) = IOLockAlloc(this);
    *((_QWORD *)this + 88) = v10;
    this = v10;
    IOLockInitWithState(v10, 0LL);
  }
  if ( !*((_QWORD *)v4 + 89) )
  {
    LODWORD(v11) = IOLockAlloc(this);
    *((_QWORD *)v4 + 89) = v11;
    this = v11;
    IOLockInitWithState(v11, 0LL);
  }
  if ( !*((_QWORD *)v4 + 82) )
  {
    LODWORD(v12) = IORecursiveLockAlloc(this);
    *((_QWORD *)v4 + 82) = v12;
  }
  v8 = 0;
  v13 = IOCommandGate::commandGate(v4, 0LL, v9);
  *((_QWORD *)v4 + 8) = v13;
  if ( !v13 )
    goto LABEL_47;
  v127 = 1024;
  if ( PE_parse_boot_argn("if80211_packet_pool_size", &v127, 4LL) )
  {
    LODWORD(v14) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)v4 + 56LL))(v4);
    v15 = OSMetaClass::getClassName(v14);
    IOLog("%s::%s packet pool size -> %u\n", v15, "initWithInterface", v127, v16, v17);
  }
  v18 = v127;
  *((_WORD *)v4 + 272) = v127;
  *((_WORD *)v4 + 273) = v18;
  *((_WORD *)v4 + 274) = v18;
  *((_WORD *)v4 + 275) = v18;
  if ( PE_parse_boot_argn("if80211_packet_pool_size_vo", (char *)v4 + 544, 2LL) )
  {
    LODWORD(v19) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)v4 + 56LL))(v4);
    v20 = OSMetaClass::getClassName(v19);
    IOLog("%s::%s packet pool size vo -> %u\n", v20, "initWithInterface", *((_WORD *)v4 + 272), v21, v22);
  }
  if ( PE_parse_boot_argn("if80211_packet_pool_size_vi", (char *)v4 + 546, 2LL) )
  {
    LODWORD(v23) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)v4 + 56LL))(v4);
    v24 = OSMetaClass::getClassName(v23);
    IOLog("%s::%s packet pool size vi -> %u\n", v24, "initWithInterface", *((_WORD *)v4 + 273), v25, v26);
  }
  v27 = v4;
  if ( PE_parse_boot_argn("if80211_packet_pool_size_be", (char *)v4 + 548, 2LL) )
  {
    LODWORD(v28) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)v4 + 56LL))(v4);
    v29 = OSMetaClass::getClassName(v28);
    IOLog("%s::%s packet pool size be -> %u\n", v29, "initWithInterface", *((_WORD *)v4 + 274), v30, v31);
  }
  v32 = 0LL;
  v33 = 1;
  if ( PE_parse_boot_argn("if80211_packet_pool_size_bk", (char *)v4 + 550, 2LL) )
  {
    LODWORD(v34) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)v4 + 56LL))(v4);
    v35 = OSMetaClass::getClassName(v34);
    v32 = 0LL;
    IOLog("%s::%s packet pool size bk -> %u\n", v35, "initWithInterface", *((_WORD *)v4 + 275), v36, v37);
  }
  v4 = 0LL;
  do
  {
    v38 = (IO80211CommandQueue *)*((_QWORD *)v27 + 8);
    if ( !v38 )
    {
      *((_QWORD *)v27 + v32 + 4) = 0LL;
LABEL_46:
      LODWORD(v60) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)v27 + 56LL))(v27);
      v61 = OSMetaClass::getClassName(v60);
      v8 = 0;
      IOLog("%s::%s cannot allocate fFreePacketDescriptorPool\n", v61, "initWithInterface", v61, v62, v63);
      v5 = off_7B078[0];
      goto LABEL_47;
    }
    v39 = *((_WORD *)v27 + v32 + 272);
    v40 = IO80211CommandQueue::withGateAndCapacity(v38, (IOCommandGate *)v39, 1);
    *((_QWORD *)v27 + v32 + 4) = v40;
    if ( !v40 )
      goto LABEL_46;
    if ( *((_WORD *)v27 + v32 + 272) )
    {
      v41 = 0;
      v125 = (unsigned __int8)v4;
      v124 = (signed int)v4;
      while ( 1 )
      {
        v42 = OSObject::operator new((OSObject *)&stru_20.maxprot, v39);
        IO80211PacketDescriptor::IO80211PacketDescriptor(v42);
        if ( !v42 )
        {
          LODWORD(v43) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)v27 + 56LL))(v27);
          v44 = OSMetaClass::getClassName(v43);
          IOLog("%s::%s cannot enqueue %p\n", v44, "initWithInterface", 0LL, v45, v46);
          goto LABEL_34;
        }
        if ( !(unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v42 + 296LL))(v42, v125) )
          break;
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v42 + 32LL))(v42);
        *(_DWORD *)(v42 + 52) = (unsigned __int16)(v33 + v41);
        v39 = v42;
        IO80211CommandQueue::lockEnqueue(*((IO80211CommandQueue **)v27 + v32 + 4), (IO80211QueueDescriptor *)v42);
        ++v41;
        if ( v41 >= *((_WORD *)v27 + v32 + 272) )
          goto LABEL_34;
      }
      LODWORD(v47) = (*(int (__fastcall **)(IO80211AWDLPeerManager *))(*(_QWORD *)v27 + 56LL))(v27);
      v48 = OSMetaClass::getClassName(v47);
      IOLog("%s::%s cannot enqueue %p\n", v48, "initWithInterface", v42, v49, v50);
      (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v42 + 40LL))(v42, v48);
LABEL_34:
      v33 += v41;
      LODWORD(v4) = v124;
    }
    ++v32;
    v4 = (IO80211PeerManager *)(unsigned int)((_DWORD)v4 + 1);
  }
  while ( (unsigned int)v32 < 4 );
  *((_DWORD *)v27 + 173) = 1;
  *((_BYTE *)v27 + 156) = 1;
  *((_DWORD *)v27 + 106) = 192;
  *((_DWORD *)v27 + 108) = 0xFFFF;
  v51 = OSIncrementAtomic(_log_debug_flip);
  v52 = 0LL;
  v5 = off_7B078[0];
  if ( !v51 )
  {
    v53 = (__int64)_log_debug_buffer;
    do
    {
      if ( !*(_QWORD *)v53 )
      {
        LODWORD(v54) = kalloc(2048LL);
        *(_QWORD *)v53 = v54;
        if ( !v54 )
        {
          LODWORD(v55) = (*(int (__cdecl **)(IO80211AWDLPeerManager *))(*(_QWORD *)v27 + 56LL))(v27);
          v56 = OSMetaClass::getClassName(v55);
          IOLog(
            "%s::%s cannot allocate log buffer %u size %u \n",
            v56,
            "initWithInterface",
            (unsigned int)v52,
            2048LL,
            v57);
        }
      }
      ++v52;
      v53 += 8LL;
    }
    while ( v52 != 4 );
  }
  v4 = v27;
  v58 = (IO80211VirtualInterface *)*((_QWORD *)v27 + 16);
  if ( !v58 || (unsigned int)IO80211VirtualInterface::getInterfaceRole(v58) != 4 )
    goto LABEL_49;
  for ( i = IO80211AWDLMulticastPeer::withAddressAndManager(
              (IO80211AWDLMulticastPeer *)&bcast_address,
              v27,
              (IO80211AWDLPeerManager *)v9);
        ;
        i = IO80211Peer::withAddressAndManager(
              (IO80211Peer *)&bcast_address,
              (const unsigned __int8 *)v4,
              (IO80211PeerManager *)v9) )
  {
    *((_QWORD *)v4 + 9) = i;
    if ( !i )
    {
      v8 = 0;
      goto LABEL_47;
    }
    *(_BYTE *)(i + 477) = 1;
    *(_BYTE *)(i + 522) = 1;
    LODWORD(v65) = IOTimerEventSource::timerEventSource(v4, IO80211PeerManager::handleTimer);
    *((_QWORD *)v4 + 80) = v65;
    if ( !v65 )
    {
      LODWORD(v73) = (*(int (__fastcall **)(IO80211PeerManager *, int (__fastcall *)(__int64)))(*(_QWORD *)v4 + 56LL))(
                       v4,
                       IO80211PeerManager::handleTimer);
      v74 = OSMetaClass::getClassName(v73);
      v8 = 0;
      IO80211PeerManager::logDebug(
        v4,
        "%s::%s  Unable to instantiate timer\n",
        v74,
        (__int64)"initWithInterface",
        v75,
        v76);
      goto LABEL_47;
    }
    v66 = IO80211PeerManager::getController(v4);
    LODWORD(v67) = (*(int (__fastcall **)(__int64, int (__fastcall *)(__int64)))(*(_QWORD *)v66 + 1672LL))(
                     v66,
                     IO80211PeerManager::handleTimer);
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v67 + 320LL))(v67, *((_QWORD *)v4 + 80));
    v68 = (IO80211Interface *)*((_QWORD *)v4 + 17);
    if ( v68 )
    {
      LODWORD(v69) = IO80211Interface::getControllerWorkLoop(v68);
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v69 + 320LL))(v69, *((_QWORD *)v4 + 8));
      v70 = v4;
      v72 = IO80211Peer::withAddressAndManager((IO80211Peer *)&null_address, (const unsigned __int8 *)v4, v71);
      *((_QWORD *)v4 + 10) = v72;
      if ( !v72 )
        goto LABEL_62;
      *(_BYTE *)(v72 + 477) = 1;
      *(_BYTE *)(v72 + 522) = 1;
      IO80211Peer::addPhyStatistics((IO80211Peer *)v72);
    }
    else
    {
      v77 = (IO80211VirtualInterface *)*((_QWORD *)v4 + 16);
      if ( v77 )
      {
        if ( (unsigned int)IO80211VirtualInterface::getInterfaceRole(v77) != 2
          && (unsigned int)IO80211VirtualInterface::getInterfaceRole(*((IO80211VirtualInterface **)v4 + 16)) != 1 )
        {
          v85 = IO80211CommandQueue::withGateAndCapacity(
                  *((IO80211CommandQueue **)v4 + 8),
                  (IOCommandGate *)&stru_20,
                  16);
          *((_QWORD *)v4 + 11) = v85;
          if ( !v85 )
          {
            LODWORD(v122) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)v4 + 56LL))(
                              v4,
                              32LL);
            v81 = OSMetaClass::getClassName(v122);
            v84 = (__int64)"%s::%s can't allocate peer list\n";
            goto LABEL_91;
          }
          v86 = IO80211CommandQueue::withGateAndCapacity(
                  *((IO80211CommandQueue **)v4 + 8),
                  (IOCommandGate *)0x1000000,
                  1);
          *((_QWORD *)v4 + 91) = v86;
          if ( !v86 )
          {
            LODWORD(v123) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)v4 + 56LL))(
                              v4,
                              0x1000000LL);
            v81 = OSMetaClass::getClassName(v123);
            v84 = (__int64)"%s::%s can't allocate peer flush list\n";
            goto LABEL_91;
          }
        }
        else
        {
          v70 = v4;
          v79 = IO80211Peer::withAddressAndManager((IO80211Peer *)&null_address, (const unsigned __int8 *)v4, v78);
          *((_QWORD *)v4 + 10) = v79;
          if ( !v79 )
          {
LABEL_62:
            LODWORD(v80) = (*(int (__fastcall **)(IO80211PeerManager *, IO80211PeerManager *))(*(_QWORD *)v4 + 56LL))(
                             v4,
                             v70);
            v81 = OSMetaClass::getClassName(v80);
            v84 = (__int64)"%s::%s can't allocate unicast peer\n";
LABEL_91:
            v8 = 0;
            IOLog(v84, v81, "initWithInterface", v81, v82, v83);
            goto LABEL_47;
          }
          *(_BYTE *)(v79 + 477) = 1;
          *(_BYTE *)(v79 + 522) = 1;
        }
        if ( (unsigned int)IO80211VirtualInterface::getInterfaceRole(*((IO80211VirtualInterface **)v4 + 16)) == 5 )
          *((_DWORD *)v4 + 167) = 1;
        LODWORD(v87) = IO80211VirtualInterface::getWorkLoop(*((IO80211VirtualInterface **)v4 + 16));
        (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v87 + 320LL))(v87, *((_QWORD *)v4 + 8));
      }
    }
    v88 = IO80211CommandQueue::withGateAndCapacity(*((IO80211CommandQueue **)v4 + 8), (IOCommandGate *)0x1000000, 1);
    *((_QWORD *)v4 + 92) = v88;
    if ( !v88 )
    {
      LODWORD(v102) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)v4 + 56LL))(
                        v4,
                        0x1000000LL);
      v81 = OSMetaClass::getClassName(v102);
      v84 = (__int64)"%s::%s can't allocate mbuf flush list\n";
      goto LABEL_91;
    }
    v89 = IO80211CommandQueue::withGateAndCapacity(
            *((IO80211CommandQueue **)v4 + 8),
            (IOCommandGate *)&stru_68.segname[8],
            1);
    *((_QWORD *)v4 + 93) = v89;
    if ( !v89 )
    {
      LODWORD(v103) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)v4 + 56LL))(v4, 128LL);
      v81 = OSMetaClass::getClassName(v103);
      v84 = (__int64)"%s::%s can't allocate _driverCommands list\n";
      goto LABEL_91;
    }
    LODWORD(v90) = IOTimerEventSource::timerEventSource(v4, IO80211PeerManager::handleMonitorTimer);
    *((_QWORD *)v4 + 79) = v90;
    if ( !v90 )
    {
      LODWORD(v104) = (*(int (__fastcall **)(IO80211PeerManager *, int (__fastcall *)(__int64)))(*(_QWORD *)v4 + 56LL))(
                        v4,
                        IO80211PeerManager::handleMonitorTimer);
      v81 = OSMetaClass::getClassName(v104);
      v84 = (__int64)"%s::%s  Unable to instantiate fMonitorTimer timer\n";
      goto LABEL_91;
    }
    v91 = IO80211PeerManager::handleUnflowControlTimer;
    LODWORD(v92) = IOTimerEventSource::timerEventSource(v4, IO80211PeerManager::handleUnflowControlTimer);
    *((_QWORD *)v4 + 77) = v92;
    if ( !v92 )
    {
      LODWORD(v121) = (*(int (__fastcall **)(IO80211PeerManager *, void (__fastcall *)(IO80211PeerManager *)))(*(_QWORD *)v4 + 56LL))(
                        v4,
                        IO80211PeerManager::handleUnflowControlTimer);
      v81 = OSMetaClass::getClassName(v121);
      v84 = (__int64)"%s::%s  Unable to instantiate _driverCommandsTimers timer\n";
      goto LABEL_91;
    }
    v93 = (IO80211Interface *)*((_QWORD *)v4 + 17);
    if ( v93 )
    {
      LODWORD(v94) = IO80211Interface::getControllerWorkLoop(v93);
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v94 + 320LL))(v94, *((_QWORD *)v4 + 79));
      LODWORD(v95) = IO80211Interface::getControllerWorkLoop(*((IO80211Interface **)v4 + 17));
      v91 = (void (__fastcall *)(IO80211PeerManager *))*((_QWORD *)v4 + 77);
      (*(void (__fastcall **)(__int64, void (__fastcall *)(IO80211PeerManager *)))(*(_QWORD *)v95 + 320LL))(v95, v91);
    }
    v96 = (IO80211VirtualInterface *)*((_QWORD *)v4 + 16);
    if ( v96 && (LODWORD(v97) = IO80211VirtualInterface::getWorkLoop(v96), v97) )
    {
      LODWORD(v98) = IO80211VirtualInterface::getWorkLoop(*((IO80211VirtualInterface **)v4 + 16));
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v98 + 320LL))(v98, *((_QWORD *)v4 + 79));
      LODWORD(v99) = IO80211VirtualInterface::getWorkLoop(*((IO80211VirtualInterface **)v4 + 16));
      v100 = *((_QWORD *)v4 + 77);
      v101 = v99;
      (*(void (__fastcall **)(Stopwatch *, unsigned __int64))(*(_QWORD *)v99 + 320LL))(v99, v100);
    }
    else
    {
      LODWORD(v105) = (*(int (__fastcall **)(IO80211PeerManager *, void (__fastcall *)(IO80211PeerManager *)))(*(_QWORD *)v4 + 56LL))(
                        v4,
                        v91);
      v101 = "%s::%s can't add monitoring timer\n";
      v100 = OSMetaClass::getClassName(v105);
      IOLog("%s::%s can't add monitoring timer\n", v100, "initWithInterface", v100, v106, v107);
    }
    *((_BYTE *)v4 + 560) = 1;
    v108 = v127;
    *((_DWORD *)v4 + 105) = v127 - 8;
    *((_DWORD *)v4 + 135) = v108 >> 1;
    *((_DWORD *)v4 + 107) = 0;
    v109 = Stopwatch::withUptime(v101, v100);
    *((_QWORD *)v4 + 30) = v109;
    v110 = v109;
    Stopwatch::reset((Stopwatch *)v109);
    *((_DWORD *)v4 + 127) = 8000;
    *((_DWORD *)v4 + 128) = 4000;
    *((_DWORD *)v4 + 129) = 80;
    *((_BYTE *)v4 + 552) = 0;
    *((_DWORD *)v4 + 118) = 1000;
    *((_QWORD *)v4 + 58) = 644245094403LL;
    if ( *((_DWORD *)v4 + 98) )
    {
      LODWORD(v111) = IOSimpleLockAlloc(v110);
      *((_QWORD *)v4 + 48) = v111;
      IOSimpleLockInit(v111);
    }
    v126 = 1;
    v112 = mbuf_allocpacket(0LL, 64LL, &v126, (char *)v4 + 760);
    if ( v112 || !*((_QWORD *)v4 + 95) )
    {
      LODWORD(v118) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)v4 + 56LL))(v4, 64LL);
      v119 = OSMetaClass::getClassName(v118);
      v8 = 0;
      IOLog("%s::%s cannot allocate mbuf size %u err %d\n", v119, "initWithInterface", 64LL, (unsigned int)v112, v120);
    }
    else
    {
      *((_DWORD *)v4 + 172) = 5000;
      *((_DWORD *)v4 + 131) = 5;
      bzero(&v128, 0x40uLL);
      v128 = 114;
      v129 = 118;
      v130 = 105;
      v131 = 58;
      v113 = IO80211PeerManager::getBSDName(v4);
      strlcpy(&v128, v113, 0x3CuLL);
      v8 = 1;
      if ( PE_parse_boot_argn(&v128, (char *)v4 + 496, 4LL) )
      {
        LODWORD(v114) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)v4 + 56LL))(v4);
        v115 = OSMetaClass::getClassName(v114);
        v116 = IO80211PeerManager::getBSDName(v4);
        IOLog("%s::%s <%s> rvi -> %u\n", v115, "initWithInterface", v116, *((_DWORD *)v4 + 124), v117);
      }
    }
LABEL_47:
    if ( *(_QWORD *)v5 == v132 )
      break;
LABEL_49:
    ;
  }
  return v8;
}
// 20: using guessed type segment_command_64 stru_20;
// 68: using guessed type section_64 stru_68;
// 77FDC: using guessed type int null_address;
// 77FF0: using guessed type _QWORD bcast_address;
// 7B078: using guessed type __int64 off_7B078[7];
// 822A0: using guessed type __int64 `vtable for'IO80211QueueDescriptor[2];
// 844D0: using guessed type __int64 _log_debug_buffer[4];
// C76F0: using guessed type int __cdecl IOLockAlloc(_QWORD);
// C7700: using guessed type int __fastcall IOLockInitWithState(_QWORD, _QWORD);
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7748: using guessed type int __cdecl IORecursiveLockAlloc(_QWORD);
// C7768: using guessed type int __fastcall IOSimpleLockAlloc(_QWORD);
// C7778: using guessed type int __fastcall IOSimpleLockInit(_QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C77D8: using guessed type int __fastcall PE_parse_boot_argn(_QWORD, _QWORD, _QWORD);
// C7C78: using guessed type int __fastcall IOTimerEventSource::timerEventSource(_QWORD, _QWORD);
// C8BB8: using guessed type int __fastcall kalloc(_QWORD);
// C8BE8: using guessed type int __fastcall mbuf_allocpacket(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000043DD4) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::doDisable(IO80211PeerManager *this, char *a2)
{
  OSMetaClass *v2; // rax@1
  __int64 v3; // rax@1
  __int64 v4; // r9@1
  __int64 result; // rax@1

  LODWORD(v2) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
  v3 = OSMetaClass::getClassName(v2);
  IO80211PeerManager::logDebug(this, "%s::%s   source [%s]\n", v3, (__int64)"doDisable", (__int64)a2, v4);
  *((_QWORD *)this + 18) = getAbsoluteTime();
  (*(void (__fastcall **)(IO80211PeerManager *, _QWORD))(*(_QWORD *)this + 424LL))(this, "%s::%s   source [%s]\n");
  IO80211PeerManager::removeAllPeers(this);
  result = IO80211PeerManager::flushFreeMbufs(this);
  *((_BYTE *)this + 652) = 0;
  *((_BYTE *)this + 653) = 0;
  *((_DWORD *)this + 162) = 0;
  return result;
}

//----- (0000000000043E52) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::logDebug(IO80211PeerManager *this, const char *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // rbx@1
  char v8; // [sp+0h] [bp-60h]@1
  __int64 v9; // [sp+10h] [bp-50h]@1
  __int64 v10; // [sp+18h] [bp-48h]@1
  __int64 v11; // [sp+20h] [bp-40h]@1
  __int64 v12; // [sp+28h] [bp-38h]@1
  __va_list_tag v13; // [sp+30h] [bp-30h]@1
  __int64 v14; // [sp+50h] [bp-10h]@1
  char v15; // [sp+70h] [bp+10h]@0

  v12 = a6;
  v11 = a5;
  v10 = a4;
  v9 = a3;
  v6 = off_7B078[0];
  v14 = *(_QWORD *)off_7B078[0];
  v13.reg_save_area = &v8;
  v13.overflow_arg_area = &v15;
  v13.fp_offset = 48;
  v13.gp_offset = 16;
  IO80211PeerManager::vlogDebug(this, 0LL, a2, &v13);
  return *(_QWORD *)v6;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000043EBE) ----------------------------------------------------
void __fastcall IO80211PeerManager::printPERReport(IO80211PeerManager *this)
{
  ;
}

//----- (0000000000043EC4) ----------------------------------------------------
int __fastcall IO80211PeerManager::removeAllPeers(IO80211PeerManager *this)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdi@1
  __int64 v3; // rdi@3
  IO80211Peer *v4; // rdi@5
  __int64 v5; // rax@7
  __int64 v6; // rdi@7
  int v7; // eax@8
  __int64 v9; // [sp+8h] [bp-58h]@3
  __int64 v10; // [sp+10h] [bp-50h]@3
  __int64 (__fastcall *v11)(__int64, __int64); // [sp+18h] [bp-48h]@3
  __int64 v12; // [sp+20h] [bp-40h]@3
  __int64 v13; // [sp+28h] [bp-38h]@3
  __int64 v14; // [sp+30h] [bp-30h]@3
  __int64 v15; // [sp+38h] [bp-28h]@3
  __int64 v16; // [sp+40h] [bp-20h]@3
  __int64 v17; // [sp+48h] [bp-18h]@3
  __int64 v18; // [sp+50h] [bp-10h]@3

  v1 = (__int64)this;
  v2 = *((_QWORD *)this + 82);
  if ( v2 )
  {
    IORecursiveLockLock(v2);
    ++*(_DWORD *)(v1 + 664);
  }
  v18 = 0LL;
  v17 = 0LL;
  v16 = 0LL;
  v15 = 0LL;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 0LL;
  v10 = 0LL;
  v9 = 0LL;
  v11 = _addToFlush;
  v3 = *(_QWORD *)(v1 + 88);
  if ( v3 )
    IO80211CommandQueue::map(
      v3,
      (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_removePeers,
      v1,
      0LL,
      (__int64)&v9,
      -1);
  v4 = *(IO80211Peer **)(v1 + 80);
  if ( v4 )
    IO80211Peer::flushQueues(v4, 0);
  LODWORD(v5) = IO80211Peer::flushQueues(*(IO80211Peer **)(v1 + 72), 0);
  v6 = *(_QWORD *)(v1 + 656);
  if ( v6 )
  {
    v7 = *(_DWORD *)(v1 + 664);
    if ( v7 )
      *(_DWORD *)(v1 + 664) = v7 - 1;
    LODWORD(v5) = IORecursiveLockUnlock(v6, 0LL);
  }
  return IO80211PeerManager::removeFlushedPeers((IO80211PeerManager *)v1, v5);
}
// C7758: using guessed type int __cdecl IORecursiveLockLock(_QWORD);
// C7760: using guessed type int __fastcall IORecursiveLockUnlock(_QWORD, _QWORD);

//----- (0000000000043FB4) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::flushFreeMbufs(IO80211PeerManager *this)
{
  __int64 result; // rax@1
  __int64 v2; // rdi@1
  int v3; // [sp+Ch] [bp-4h]@1

  result = (__int64)this;
  v3 = 60000;
  v2 = *((_QWORD *)this + 92);
  if ( v2 )
    result = IO80211CommandQueue::map(
               v2,
               (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_clearFlushedPacket,
               result,
               (__int64)&v3,
               0LL,
               -1);
  return result;
}

//----- (0000000000043FF4) ----------------------------------------------------
char __fastcall IO80211PeerManager::doEnable(IO80211PeerManager *this, char *a2)
{
  __int64 v2; // rax@1
  __int64 v3; // rax@2
  __int64 v5; // [sp+8h] [bp-18h]@1
  int v6; // [sp+10h] [bp-10h]@1

  (*(void (__fastcall **)(IO80211PeerManager *, char *))(*(_QWORD *)this + 432LL))(this, a2);
  *((_QWORD *)this + 18) = getAbsoluteTime();
  v6 = 0;
  LOBYTE(v2) = 1;
  v5 = 1LL;
  if ( *((_QWORD *)this + 10) )
  {
    v3 = IO80211PeerManager::getController(this);
    LOBYTE(v2) = IO80211Controller::getBSSIDData(v3, &v5);
    if ( (_BYTE)v2 )
    {
      v2 = *((_QWORD *)this + 10);
      *(_WORD *)(v2 + 36) = v6;
      *(_DWORD *)(v2 + 32) = HIDWORD(v5);
    }
  }
  if ( *((_DWORD *)this + 173) )
    LOBYTE(v2) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 79) + 464LL))(
                   *((_QWORD *)this + 79),
                   *((_DWORD *)this + 172));
  *((_WORD *)this + 326) = 1;
  return v2;
}

//----- (000000000004408A) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::getController(IO80211PeerManager *this)
{
  __int64 result; // rax@2
  IO80211Interface *v2; // rdi@3

  if ( *((_QWORD *)this + 16) )
  {
    result = IO80211VirtualInterface::getController(*((IO80211VirtualInterface **)this + 16));
  }
  else
  {
    v2 = (IO80211Interface *)*((_QWORD *)this + 17);
    if ( v2 )
      result = IO80211Interface::getController(v2);
    else
      result = 0LL;
  }
  return result;
}

//----- (00000000000440BA) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::failToEnable(IO80211PeerManager *this)
{
  OSMetaClass *v1; // rax@1
  __int64 v2; // rax@1
  __int64 v3; // r8@1
  __int64 v4; // r9@1
  __int64 result; // rax@1

  (*(void (__cdecl **)(IO80211PeerManager *))(*(_QWORD *)this + 424LL))(this);
  *((_QWORD *)this + 18) = getAbsoluteTime();
  LODWORD(v1) = (*(int (__cdecl **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
  v2 = OSMetaClass::getClassName(v1);
  result = IO80211PeerManager::logDebug(this, "%s::%s\n", v2, (__int64)"failToEnable", v3, v4);
  *((_WORD *)this + 326) = 0;
  return result;
}

//----- (0000000000044114) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::enableGated(IO80211PeerManager *this, void *a2, void *a3, void *a4, void *a5, void *a6)
{
  if ( !*((_BYTE *)this + 653) )
  {
    *((_BYTE *)this + 653) = 1;
    (*(void (__fastcall **)(IO80211PeerManager *, void *, void *, void *, void *, void *))(*(_QWORD *)this + 400LL))(
      this,
      a2,
      a3,
      a4,
      a5,
      a6);
  }
  return 0LL;
}

//----- (0000000000044136) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::disableGated(IO80211PeerManager *this, void *a2, void *a3, void *a4, void *a5, void *a6)
{
  if ( *((_BYTE *)this + 653) )
  {
    IOLog("%s Error: disable while enabling [%s] -> try to disable anyhow!!\n", "disableGated", a2, a4, a5, a6);
    *((_BYTE *)this + 653) = 0;
  }
  (*(void (__fastcall **)(IO80211PeerManager *, void *, void *, void *, void *, void *))(*(_QWORD *)this + 408LL))(
    this,
    a2,
    a3,
    a4,
    a5,
    a6);
  return 0LL;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000044182) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::enable(IO80211PeerManager *this, const char *a2)
{
  const char *v2; // r15@1
  signed __int64 v3; // r14@1
  __int64 v4; // rax@1
  OSMetaClass *v5; // rax@2
  __int64 v6; // ST40_8@2
  __int64 v7; // ST38_8@2
  __int64 v8; // rax@2
  __int64 v9; // rax@2
  __int64 v10; // r12@2
  __int64 v11; // rax@2
  __int64 v12; // rax@2
  int v13; // eax@2
  int v14; // ST20_4@2
  int v15; // ST18_4@2
  __int64 v16; // rax@4
  __int64 result; // rax@5
  __int64 v18; // r15@6
  __int64 v19; // rax@6
  __int64 v20; // r12@6
  __int64 v21; // rax@6
  __int64 v22; // rax@6
  __int64 v23; // r13@6
  __int64 v24; // r14@6
  __int64 v25; // rax@6
  __int64 v26; // rax@6
  int v27; // ST00_4@6

  v2 = a2;
  v3 = 0x2000000000LL;
  v4 = IO80211PeerManager::getPeerManagerLogFlags(this);
  if ( _bittest((const unsigned __int64 *)&v4, 0x25u) )
  {
    LODWORD(v5) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
    v6 = OSMetaClass::getClassName(v5);
    v7 = (__int64)IO80211PeerManager::getBSDName(this);
    current_thread(this, a2);
    v8 = IO80211PeerManager::getController(this);
    LODWORD(v9) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v8 + 1672LL))(v8);
    v10 = (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v9 + 312LL))(v9);
    v11 = IO80211PeerManager::getController(this);
    LODWORD(v12) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v11 + 1672LL))(v11);
    v13 = (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v12 + 304LL))(v12);
    v14 = *((_BYTE *)this + 652);
    v15 = *((_BYTE *)this + 653);
    v3 = 0x2000000000LL;
    a2 = 0;
    IO80211PeerManager::logDebug(
      this,
      0x2000000000LL,
      "%s::%s: <%s> enable t=%p ing %u ont %u _enabling %u _enabled %u %s\n",
      v6,
      (__int64)"enable",
      v7);
  }
  if ( IO80211PeerManager::getController(this) )
  {
    v16 = IO80211PeerManager::getController(this);
    a2 = (const char *)this;
    (*(void (__fastcall **)(__int64, IO80211PeerManager *, __int64 (__fastcall *)(IO80211PeerManager *__hidden, void *, void *, void *, void *, void *), IO80211PeerManager *, const char *, _QWORD))(*(_QWORD *)v16 + 2128LL))(
      v16,
      this,
      IO80211PeerManager::enableGated,
      this,
      v2,
      0LL);
  }
  result = IO80211PeerManager::getPeerManagerLogFlags(this);
  if ( result & v3 )
  {
    v18 = (__int64)IO80211PeerManager::getBSDName(this);
    LODWORD(v19) = current_thread(this, a2);
    v20 = v19;
    v21 = IO80211PeerManager::getController(this);
    LODWORD(v22) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v21 + 1672LL))(v21);
    v23 = v3;
    v24 = (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v22 + 312LL))(v22);
    v25 = IO80211PeerManager::getController(this);
    LODWORD(v26) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v25 + 1672LL))(v25);
    v27 = (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v26 + 304LL))(v26);
    result = IO80211PeerManager::logDebug(
               this,
               v23,
               "<%s> enable Done t=%p ing %u ont %u\n",
               v18,
               v20,
               (unsigned int)v24);
  }
  return result;
}
// C8A50: using guessed type int __fastcall current_thread(_QWORD, _QWORD);

//----- (0000000000044362) ----------------------------------------------------
char __fastcall IO80211PeerManager::shouldLog(IO80211PeerManager *this, __int64 a2)
{
  return (a2 == 0) | ((IO80211PeerManager::getPeerManagerLogFlags(this) & a2) != 0);
}

//----- (0000000000044386) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::logDebug(IO80211PeerManager *this, __int64 a2, const char *a3, __int64 a4, __int64 a5, __int64 a6)
{
  const char *v6; // r14@1
  __int64 v7; // r12@1
  __int64 v8; // rax@1
  char v10; // [sp+0h] [bp-70h]@3
  __int64 v11; // [sp+18h] [bp-58h]@1
  __int64 v12; // [sp+20h] [bp-50h]@1
  __int64 v13; // [sp+28h] [bp-48h]@1
  __va_list_tag v14; // [sp+30h] [bp-40h]@3
  __int64 v15; // [sp+48h] [bp-28h]@1
  char v16; // [sp+80h] [bp+10h]@0

  v6 = a3;
  v13 = a6;
  v12 = a5;
  v11 = a4;
  v7 = off_7B078[0];
  v15 = *(_QWORD *)off_7B078[0];
  v8 = IO80211PeerManager::getPeerManagerLogFlags(this);
  if ( !a2 || a2 & v8 )
  {
    v14.reg_save_area = &v10;
    v14.overflow_arg_area = &v16;
    v14.fp_offset = 48;
    v14.gp_offset = 24;
    IO80211PeerManager::vlogDebug(this, a2, v6, &v14);
  }
  return *(_QWORD *)v7;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000044414) ----------------------------------------------------
char *__fastcall IO80211PeerManager::getBSDName(IO80211PeerManager *this)
{
  char *result; // rax@2
  IO80211Interface *v2; // rdi@3

  if ( *((_QWORD *)this + 16) )
  {
    result = IO80211VirtualInterface::getBSDName(*((IO80211VirtualInterface **)this + 16));
  }
  else
  {
    v2 = (IO80211Interface *)*((_QWORD *)this + 17);
    if ( v2 )
      result = IO80211Interface::getBSDName(v2, 0LL);
    else
      result = "unknown";
  }
  return result;
}

//----- (0000000000044448) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::disable(IO80211PeerManager *this, const char *a2)
{
  const char *v2; // r14@1
  __int64 v3; // r13@1
  __int64 v4; // rax@1
  __int64 v5; // ST10_8@2
  __int64 v6; // rax@2
  __int64 v7; // r13@2
  __int64 v8; // rax@2
  __int64 v9; // rax@2
  const char *v10; // r12@2
  unsigned int v11; // er14@2
  __int64 v12; // rax@2
  __int64 v13; // rax@2
  int v14; // ST00_4@2
  __int64 v15; // r8@2
  __int64 v16; // r9@2
  __int64 v17; // rax@4
  __int64 result; // rax@5
  __int64 v19; // r15@6
  __int64 v20; // rax@6
  __int64 v21; // r12@6
  __int64 v22; // rax@6
  __int64 v23; // rax@6
  __int64 v24; // r14@6
  __int64 v25; // rax@6
  __int64 v26; // rax@6
  int v27; // ST00_4@6

  v2 = a2;
  v3 = 0x2000000000LL;
  v4 = IO80211PeerManager::getPeerManagerLogFlags(this);
  if ( _bittest((const unsigned __int64 *)&v4, 0x25u) )
  {
    v5 = (__int64)IO80211PeerManager::getBSDName(this);
    LODWORD(v6) = current_thread(this, a2);
    v7 = v6;
    v8 = IO80211PeerManager::getController(this);
    LODWORD(v9) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v8 + 1672LL))(v8);
    v10 = a2;
    v11 = (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v9 + 312LL))(v9);
    v12 = IO80211PeerManager::getController(this);
    LODWORD(v13) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v12 + 1672LL))(v12);
    v14 = (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v13 + 304LL))(v13);
    v15 = v7;
    v3 = 0x2000000000LL;
    a2 = 0;
    v16 = v11;
    v2 = v10;
    IO80211PeerManager::logDebug(this, 0x2000000000LL, "<%s> disable t=%p ing %u ont %u\n", v5, v15, v16);
  }
  if ( IO80211PeerManager::getController(this) )
  {
    v17 = IO80211PeerManager::getController(this);
    a2 = (const char *)this;
    (*(void (__fastcall **)(__int64, IO80211PeerManager *, __int64 (__fastcall *)(IO80211PeerManager *__hidden, void *, void *, void *, void *, void *), IO80211PeerManager *, const char *, _QWORD))(*(_QWORD *)v17 + 2128LL))(
      v17,
      this,
      IO80211PeerManager::disableGated,
      this,
      v2,
      0LL);
  }
  result = IO80211PeerManager::getPeerManagerLogFlags(this);
  if ( result & v3 )
  {
    v19 = (__int64)IO80211PeerManager::getBSDName(this);
    LODWORD(v20) = current_thread(this, a2);
    v21 = v20;
    v22 = IO80211PeerManager::getController(this);
    LODWORD(v23) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v22 + 1672LL))(v22);
    v24 = (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v23 + 312LL))(v23);
    v25 = IO80211PeerManager::getController(this);
    LODWORD(v26) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v25 + 1672LL))(v25);
    v27 = (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v26 + 304LL))(v26);
    result = IO80211PeerManager::logDebug(
               this,
               v3,
               "<%s> disable Done t=%p ing %u ont %u\n",
               v19,
               v21,
               (unsigned int)v24);
  }
  return result;
}
// C8A50: using guessed type int __fastcall current_thread(_QWORD, _QWORD);

//----- (00000000000445DE) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::reset(IO80211PeerManager *this)
{
  OSMetaClass *v1; // rax@1
  __int64 v2; // rax@1
  __int64 v3; // r8@1
  __int64 v4; // r9@1

  (*(void (__cdecl **)(IO80211PeerManager *))(*(_QWORD *)this + 424LL))(this);
  LODWORD(v1) = (*(int (__cdecl **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
  v2 = OSMetaClass::getClassName(v1);
  IO80211PeerManager::logDebug(this, "%s::%s \n", v2, (__int64)"reset", v3, v4);
  IO80211PeerManager::removeAllPeers(this);
  IO80211PeerManager::flushFreeMbufs(this);
  return 0LL;
}

//----- (0000000000044636) ----------------------------------------------------
IO80211CommandQueue *__fastcall IO80211PeerManager::allocateQueue(IO80211PeerManager *this, IOCommandGate *a2, signed int a3)
{
  IO80211CommandQueue *v3; // rdi@1
  IO80211CommandQueue *result; // rax@2

  v3 = (IO80211CommandQueue *)*((_QWORD *)this + 8);
  if ( v3 )
    result = IO80211CommandQueue::withGateAndCapacity(v3, a2, a3);
  else
    result = 0LL;
  return result;
}

//----- (000000000004464E) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::packetSpace(__int64 a1, unsigned int a2)
{
  __int64 result; // rax@1
  __int64 v3; // rcx@2
  int v4; // edx@3

  result = 0LL;
  if ( a2 <= 3 )
  {
    v3 = *(_QWORD *)(a1 + 8LL * a2 + 32);
    if ( v3 )
    {
      v4 = *(_DWORD *)(v3 + 48) - *(_DWORD *)(a1 + 420);
      if ( v4 < 0 )
        v4 = 0;
      result = (unsigned int)(*(_DWORD *)(v3 + 52) - v4);
      if ( (signed int)result < 0 )
        result = 0LL;
    }
  }
  return result;
}

//----- (000000000004467E) ----------------------------------------------------
bool __fastcall IO80211PeerManager::fcTryLock(IO80211PeerManager *this)
{
  IO80211PeerManager *v1; // rcx@1
  __int64 v2; // rdi@1
  bool result; // al@1

  v1 = this;
  v2 = *((_QWORD *)this + 88);
  result = 1;
  if ( v2 )
  {
    if ( *((_DWORD *)v1 + 180) )
      result = IOLockTryLock(v2) != 0;
  }
  return result;
}
// C7718: using guessed type int __cdecl IOLockTryLock(_QWORD);

//----- (00000000000446A8) ----------------------------------------------------
int __fastcall IO80211PeerManager::fcLock(IO80211PeerManager *this)
{
  IO80211PeerManager *v1; // rax@1
  __int64 v2; // rdi@1

  v1 = this;
  v2 = *((_QWORD *)this + 88);
  if ( v2 && *((_DWORD *)v1 + 180) )
    LODWORD(v1) = IOLockLock(v2);
  return (signed int)v1;
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);

//----- (00000000000446CC) ----------------------------------------------------
int __fastcall IO80211PeerManager::fcUnlock(IO80211PeerManager *this)
{
  IO80211PeerManager *v1; // rax@1
  __int64 v2; // rdi@1

  v1 = this;
  v2 = *((_QWORD *)this + 88);
  if ( v2 && *((_DWORD *)v1 + 180) )
    LODWORD(v1) = IOLockUnlock(v2);
  return (signed int)v1;
}
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);

//----- (00000000000446F0) ----------------------------------------------------
int __fastcall IO80211PeerManager::handleTimer(__int64 a1)
{
  *(_DWORD *)(a1 + 152) = 31;
  return IO80211PeerManager::requestTxPacket((IO80211PeerManager *)a1, "handleTimer");
}

//----- (000000000004470C) ----------------------------------------------------
int __fastcall IO80211PeerManager::handleMonitorTimer(__int64 a1)
{
  int result; // eax@1

  result = (*(int (__cdecl **)(__int64))(*(_QWORD *)a1 + 304LL))(a1);
  if ( (_BYTE)result )
    result = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(a1 + 632) + 464LL))(
               *(_QWORD *)(a1 + 632),
               *(_DWORD *)(a1 + 688));
  return result;
}

//----- (0000000000044748) ----------------------------------------------------
void __fastcall IO80211PeerManager::handleUnflowControlTimer(IO80211PeerManager *this)
{
  IO80211PeerManager::unflowControlStack(this);
}

//----- (0000000000044752) ----------------------------------------------------
void __fastcall IO80211PeerManager::free(IO80211PeerManager *this)
{
  IO80211PeerManager *v1; // r14@1
  __int64 v2; // rdi@1
  __int64 v3; // rdi@3
  __int64 v4; // rdi@5
  __int64 v5; // rdi@7
  __int64 v6; // r15@9
  __int64 v7; // rbx@9
  IO80211CommandQueue *v8; // rdi@10
  __int64 v9; // rdi@11
  __int64 v10; // rbx@15
  __int64 v11; // rdi@16
  __int64 v12; // rdi@19
  __int64 v13; // rdi@22
  __int64 v14; // rdi@24
  IO80211CommandQueue *v15; // rdi@26
  __int64 v16; // rdi@27
  IO80211CommandQueue *v17; // rdi@30
  __int64 v18; // rdi@31
  IO80211CommandQueue *v19; // rdi@33
  __int64 v20; // rdi@34
  __int64 v21; // rdi@36
  __int64 v22; // rdi@38

  v1 = this;
  v2 = *((_QWORD *)this + 88);
  if ( v2 )
  {
    IOLockFree(v2);
    *((_QWORD *)v1 + 88) = 0LL;
  }
  v3 = *((_QWORD *)v1 + 89);
  if ( v3 )
  {
    IOLockFree(v3);
    *((_QWORD *)v1 + 89) = 0LL;
  }
  v4 = *((_QWORD *)v1 + 82);
  if ( v4 )
  {
    IORecursiveLockFree(v4);
    *((_QWORD *)v1 + 82) = 0LL;
  }
  v5 = *((_QWORD *)v1 + 8);
  if ( v5 )
  {
    (*(void (**)(void))(*(_QWORD *)v5 + 40LL))();
    *((_QWORD *)v1 + 8) = 0LL;
  }
  v6 = 0LL;
  v7 = 0LL;
  while ( 1 )
  {
    v8 = (IO80211CommandQueue *)*((_QWORD *)v1 + v7 + 4);
    if ( v8 )
    {
      IO80211CommandQueue::flush(v8);
      v9 = *((_QWORD *)v1 + v7 + 4);
      if ( v9 )
        (*(void (**)(void))(*(_QWORD *)v9 + 40LL))();
      *((_QWORD *)v1 + v7 + 4) = 0LL;
    }
    ++v7;
    if ( v7 == 4 )
    {
      v10 = 0LL;
      while ( 1 )
      {
        v11 = _log_debug_buffer[v6];
        if ( v11 )
          kfree(v11, 2048LL);
        ++v6;
        if ( v6 == 4 )
        {
          while ( 1 )
          {
            v12 = _logCC_debug_buffer[v10];
            if ( v12 )
              kfree(v12, 2048LL);
            ++v10;
            if ( v10 == 4 )
            {
              v13 = *((_QWORD *)v1 + 9);
              if ( v13 )
                (*(void (**)(void))(*(_QWORD *)v13 + 40LL))();
              *((_QWORD *)v1 + 9) = 0LL;
              v14 = *((_QWORD *)v1 + 10);
              if ( v14 )
                (*(void (**)(void))(*(_QWORD *)v14 + 40LL))();
              *((_QWORD *)v1 + 10) = 0LL;
              v15 = (IO80211CommandQueue *)*((_QWORD *)v1 + 11);
              if ( v15 )
              {
                IO80211CommandQueue::flush(v15);
                v16 = *((_QWORD *)v1 + 11);
                if ( v16 )
                  (*(void (**)(void))(*(_QWORD *)v16 + 40LL))();
                *((_QWORD *)v1 + 11) = 0LL;
              }
              v17 = (IO80211CommandQueue *)*((_QWORD *)v1 + 92);
              if ( v17 )
              {
                IO80211CommandQueue::flush(v17);
                v18 = *((_QWORD *)v1 + 92);
                if ( v18 )
                  (*(void (**)(void))(*(_QWORD *)v18 + 40LL))();
              }
              *((_QWORD *)v1 + 92) = 0LL;
              v19 = (IO80211CommandQueue *)*((_QWORD *)v1 + 93);
              if ( v19 )
              {
                IO80211CommandQueue::flush(v19);
                v20 = *((_QWORD *)v1 + 93);
                if ( v20 )
                  (*(void (**)(void))(*(_QWORD *)v20 + 40LL))();
              }
              *((_QWORD *)v1 + 93) = 0LL;
              v21 = *((_QWORD *)v1 + 79);
              if ( v21 )
                (*(void (**)(void))(*(_QWORD *)v21 + 40LL))();
              *((_QWORD *)v1 + 79) = 0LL;
              v22 = *((_QWORD *)v1 + 77);
              if ( v22 )
                (*(void (**)(void))(*(_QWORD *)v22 + 40LL))();
              *((_QWORD *)v1 + 77) = 0LL;
              if ( *((_QWORD *)v1 + 48) )
                IOSimpleLockFree();
              JUMPOUT(__CS__, `vtable for'IO80211QueueDescriptor[20]);
            }
          }
        }
      }
    }
  }
}
// 822A0: using guessed type __int64 `vtable for'IO80211QueueDescriptor[2];
// 844D0: using guessed type __int64 _log_debug_buffer[4];
// 84520: using guessed type __int64 _logCC_debug_buffer[4];
// C76F8: using guessed type int __fastcall IOLockFree(_QWORD);
// C7750: using guessed type int __cdecl IORecursiveLockFree(_QWORD);
// C7770: using guessed type int IOSimpleLockFree(void);
// C8BC8: using guessed type int __fastcall kfree(_QWORD, _QWORD);

//----- (000000000004495D) ----------------------------------------------------
__int64 __fastcall _compareByMac(IO80211QueueDescriptor *a1, IO80211QueueDescriptor *a2)
{
  int v2; // ecx@1
  __int64 result; // rax@1

  v2 = memcmp((char *)a1 + 32, (char *)a2 + 32, 6uLL);
  result = 1LL;
  if ( v2 >= 0 )
    result = (unsigned int)-(v2 != 0);
  return result;
}

//----- (0000000000044984) ----------------------------------------------------
signed __int64 __fastcall _macAddressEqual(__int64 a1, __int64 a2, const void *a3)
{
  signed __int64 result; // rax@1

  result = 1LL;
  if ( a2 )
    result = memcmp((const void *)(a2 + 32), a3, 6uLL) == 0;
  return result;
}

//----- (00000000000449B4) ----------------------------------------------------
signed __int64 __fastcall IO80211PeerManager::macAddressEqual(IO80211PeerManager *this, IO80211Peer *a2, unsigned __int8 *a3)
{
  signed __int64 result; // rax@1

  result = 1LL;
  if ( a2 )
    result = memcmp((char *)a2 + 32, a3, 6uLL) == 0;
  return result;
}

//----- (00000000000449E3) ----------------------------------------------------
signed __int64 __fastcall _macAddressEqualAndLru(__int64 a1, __int64 a2, const void *a3)
{
  signed __int64 result; // rax@1
  bool v4; // zf@3

  result = 1LL;
  if ( a2 && a3 )
  {
    v4 = memcmp((const void *)(a2 + 32), a3, 6uLL) == 0;
    result = 17LL;
    if ( !v4 )
      result = 0LL;
  }
  return result;
}

//----- (0000000000044A1B) ----------------------------------------------------
signed __int64 __fastcall _macAddressEqualAndRemove(__int64 a1, __int64 a2, const void *a3)
{
  signed __int64 result; // rax@1

  result = 1LL;
  if ( a2 )
  {
    if ( a3 )
      result = 5 * (unsigned int)(memcmp((const void *)(a2 + 32), a3, 6uLL) == 0);
  }
  return result;
}

//----- (0000000000044A52) ----------------------------------------------------
__int64 __fastcall _countCachedPeers(__int64 a1, __int64 a2, __int64 a3)
{
  if ( *(_BYTE *)(a2 + 522) )
    ++*(_DWORD *)a3;
  return 0LL;
}

//----- (0000000000044A66) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::findPeer(IO80211PeerManager *this, unsigned __int8 *a2, char a3)
{
  __int64 v3; // rax@1
  IO80211PeerManager *v4; // r14@1
  __int64 v5; // rbx@1
  __int64 v6; // rdi@2
  signed __int64 (__fastcall *v7)(__int64, __int64, const void *); // rsi@4
  OSMetaClass *v8; // rax@5
  __int64 v9; // rax@5
  __int64 v10; // r8@5
  __int64 v11; // r9@5

  v3 = (__int64)a2;
  v4 = this;
  v5 = 0LL;
  if ( a2 )
  {
    v6 = *((_QWORD *)this + 11);
    if ( v6 )
    {
      if ( a3 )
        v7 = _macAddressEqualAndLru;
      else
        v7 = _macAddressEqual;
      v5 = IO80211CommandQueue::map(
             v6,
             (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))v7,
             (__int64)v4,
             v3,
             0LL,
             -1);
    }
    else
    {
      LODWORD(v8) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)v4 + 56LL))(v4);
      v9 = OSMetaClass::getClassName(v8);
      v5 = 0LL;
      IO80211PeerManager::logDebug(v4, "%s::%s findPeer with no peers\n", v9, (__int64)"findPeer", v10, v11);
    }
  }
  return v5;
}

//----- (0000000000044AE6) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::performCacheOperation(IO80211PeerManager *this, __int64 (__fastcall *a2)(__int64 a1, __int64 a2, __int64 a3))
{
  __int64 v2; // r14@1
  IO80211PeerManager *v3; // r13@1
  __int64 v4; // rdi@1
  __int64 v5; // rdi@3
  __int64 v6; // rdi@5
  int v7; // eax@6
  int v8; // er15@10
  int v9; // ebx@10
  OSMetaClass *v10; // rax@10
  __int64 v11; // r11@10
  int v12; // eax@10
  int v13; // ecx@10
  int v14; // edx@10
  int v15; // esi@10
  int v16; // ST20_4@11
  signed int v17; // er15@11
  __int64 v18; // rbx@12
  int v19; // ST30_4@12
  int v20; // ST08_4@13
  int v21; // ST00_4@13
  __int64 v22; // rcx@13
  __int64 v23; // r8@13
  __int64 v24; // r9@13
  __int64 v25; // r8@13
  __int64 v26; // r9@13
  __int64 v27; // rbx@13
  __int64 v28; // rcx@14
  int v29; // ST08_4@17
  int v30; // ST00_4@17
  int v31; // er15@18
  OSMetaClass *v32; // rax@19
  __int64 v33; // rax@19
  int v35; // [sp+38h] [bp-48h]@18
  int v36; // [sp+3Ch] [bp-44h]@18
  __int64 v37; // [sp+40h] [bp-40h]@18
  int v38; // [sp+54h] [bp-2Ch]@3

  v2 = (__int64)a2;
  v3 = this;
  v4 = *((_QWORD *)this + 82);
  if ( v4 )
  {
    IORecursiveLockLock(v4);
    ++*((_DWORD *)v3 + 166);
  }
  v38 = 0;
  v5 = *((_QWORD *)v3 + 11);
  if ( v5 )
  {
    a2 = _countCachedPeers;
    IO80211CommandQueue::map(
      v5,
      (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countCachedPeers,
      (__int64)v3,
      (__int64)&v38,
      0LL,
      -1);
  }
  v6 = *((_QWORD *)v3 + 82);
  if ( v6 )
  {
    v7 = *((_DWORD *)v3 + 166);
    if ( v7 )
      *((_DWORD *)v3 + 166) = v7 - 1;
    IORecursiveLockUnlock(v6, a2);
  }
  if ( !*(_DWORD *)(v2 + 4) )
  {
    v8 = v38;
    v9 = *((_DWORD *)v3 + 40) - 1;
    LODWORD(v10) = (*(int (__fastcall **)(IO80211PeerManager *, __int64 (__fastcall *)(__int64, __int64, __int64)))(*(_QWORD *)v3 + 56LL))(
                     v3,
                     a2);
    v11 = OSMetaClass::getClassName(v10);
    v12 = *(_BYTE *)(v2 + 10);
    v13 = *(_BYTE *)(v2 + 11);
    v14 = *(_BYTE *)(v2 + 12);
    v15 = *(_BYTE *)(v2 + 13);
    if ( v9 < (unsigned int)v8 )
    {
      v16 = *((_DWORD *)v3 + 40);
      IO80211PeerManager::logDebug(
        v3,
        "%s::%s Cannot add %02x:%02x:%02x:%02x:%02x:%02x, peer cache is full max %u\n",
        v11,
        (__int64)"performCacheOperation",
        *(_BYTE *)(v2 + 8),
        *(_BYTE *)(v2 + 9));
      v17 = -536870210;
      return (unsigned int)v17;
    }
    v18 = *(_BYTE *)(v2 + 44);
    v19 = *(_BYTE *)(v2 + 45);
    IO80211PeerManager::logDebug(
      v3,
      0x200000000LL,
      "%s::%s Adding peer (%02X:%02X:%02X:%02X:%02X:%02X):  AMPDU(%d), VHT CAPABLE(%d)\n",
      v11,
      (__int64)"performCacheOperation",
      *(_BYTE *)(v2 + 8));
    if ( *(_BYTE *)(v2 + 44) )
    {
      v20 = *(_BYTE *)(v2 + 43);
      v21 = *(_DWORD *)(v2 + 39);
      IO80211PeerManager::logDebug(
        v3,
        0x200000000LL,
        "HT Params: HT info(%02x) AMPDU parameters(%02x), HT extended capability(%04x), Tx Beamforming capability(%08x), Asel cap(%02x)\n",
        *(_WORD *)(v2 + 18),
        *(_BYTE *)(v2 + 20),
        *(_WORD *)(v2 + 37));
      IO80211PeerManager::logDebug(v3, 0x200000000LL, "MCS: ", v22, v23, v24);
      v27 = 0LL;
      do
        IO80211PeerManager::logDebug(v3, 0x200000000LL, "%u ", *(_BYTE *)(v2 + v27++ + 21), v25, v26);
      while ( v27 != 16 );
      IO80211PeerManager::logDebug(v3, 0x200000000LL, "\n", v28, v25, v26);
    }
    if ( *(_BYTE *)(v2 + 45) )
    {
      v29 = *(_WORD *)(v2 + 58);
      v30 = *(_WORD *)(v2 + 56);
      IO80211PeerManager::logDebug(
        v3,
        0x200000000LL,
        "VHT Params: Info(%08x), Rx MCS Map(%04x), Rx High LGI Rate(%04x), Tx MCS Map(%04x), Tx High LGI Rate(%04x)\n",
        *(_DWORD *)(v2 + 48),
        *(_WORD *)(v2 + 52),
        *(_WORD *)(v2 + 54));
    }
  }
  v36 = 143;
  v35 = -2144835128;
  v37 = v2;
  v31 = IO80211PeerManager::ioctl_internal(v3, (__int64)&v35);
  if ( v31 )
  {
    LODWORD(v32) = (*(int (__fastcall **)(IO80211PeerManager *, int *))(*(_QWORD *)v3 + 56LL))(v3, &v35);
    v33 = OSMetaClass::getClassName(v32);
    IO80211PeerManager::logDebug(
      v3,
      "%s::%s ret %d opcode %u\n",
      v33,
      (__int64)"performCacheOperation",
      (unsigned int)v31,
      *(_DWORD *)(v2 + 4));
    v17 = -536870212;
  }
  else
  {
    v17 = 0;
    if ( (*(_DWORD *)(v2 + 4) | 2) == 3 )
      (*(void (__fastcall **)(IO80211PeerManager *, signed __int64, __int64, signed __int64))(*(_QWORD *)v3 + 480LL))(
        v3,
        51LL,
        v2,
        60LL);
  }
  return (unsigned int)v17;
}
// C7758: using guessed type int __cdecl IORecursiveLockLock(_QWORD);
// C7760: using guessed type int __fastcall IORecursiveLockUnlock(_QWORD, _QWORD);

//----- (0000000000044DB0) ----------------------------------------------------
int __fastcall IO80211PeerManager::lockDataPath(IO80211PeerManager *this)
{
  IO80211PeerManager *v1; // rbx@1
  __int64 v2; // rdi@1
  int result; // eax@2

  v1 = this;
  v2 = *((_QWORD *)this + 82);
  if ( v2 )
  {
    result = IORecursiveLockLock(v2);
    ++*((_DWORD *)v1 + 166);
  }
  return result;
}
// C7758: using guessed type int __cdecl IORecursiveLockLock(_QWORD);

//----- (0000000000044DD8) ----------------------------------------------------
int __fastcall IO80211PeerManager::unlockDataPath(IO80211PeerManager *this, __int64 a2)
{
  IO80211PeerManager *v2; // rax@1
  __int64 v3; // rdi@1
  int v4; // ecx@2

  v2 = this;
  v3 = *((_QWORD *)this + 82);
  if ( v3 )
  {
    v4 = *((_DWORD *)v2 + 166);
    if ( v4 )
      *((_DWORD *)v2 + 166) = v4 - 1;
    LODWORD(v2) = IORecursiveLockUnlock(v3, a2);
  }
  return (signed int)v2;
}
// C7760: using guessed type int __fastcall IORecursiveLockUnlock(_QWORD, _QWORD);

//----- (0000000000044E06) ----------------------------------------------------
int __fastcall IO80211PeerManager::ioctl_internal(IO80211PeerManager *a1, __int64 a2)
{
  __int64 v2; // rax@1
  int result; // eax@2

  v2 = IO80211PeerManager::getController(a1);
  if ( v2 )
    result = (*(int (__fastcall **)(__int64, IO80211PeerManager *, signed int (__fastcall *)(__int64, __int64), IO80211PeerManager *, __int64, _QWORD))(*(_QWORD *)v2 + 2128LL))(
               v2,
               a1,
               IO80211PeerManager::ioctl_internal_gated,
               a1,
               a2,
               0LL);
  else
    result = -536870911;
  return result;
}

//----- (0000000000044E62) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::addPeer(IO80211PeerManager *this, IO80211Peer *a2)
{
  IO80211Peer *v2; // r12@1
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rdi@4
  int v6; // ecx@4
  IO80211PeerManager *v7; // rdx@6
  OSMetaClass *v8; // rax@7
  __int64 v9; // rax@7
  int v10; // ST20_4@7
  int v11; // ST18_4@7
  int v12; // ST10_4@7
  int v13; // ST08_4@7
  int v14; // ST00_4@7
  __int64 v15; // rsi@8
  IO80211QueueDescriptor *v16; // rax@8
  __int64 v17; // r13@8
  OSMetaClass *v18; // rax@12
  OSMetaClass *v19; // rdi@12
  __int64 v20; // r13@12
  __int64 v21; // rax@12
  int v22; // ST30_4@12
  int v23; // ST28_4@12
  int v24; // ST20_4@12
  int v25; // ST18_4@12
  int v26; // ST10_4@12
  int v27; // ST08_4@12

  v2 = a2;
  v3 = (__int64)this;
  v4 = *((_QWORD *)this + 10);
  if ( v4 )
  {
    if ( !(*(_BYTE *)a2 & 1) )
    {
      memcpy((void *)(v4 + 32), (const void *)a2, 6uLL);
      v4 = *((_QWORD *)this + 10);
    }
  }
  else
  {
    v5 = *((_QWORD *)this + 11);
    v6 = *(_DWORD *)(v5 + 48);
    v4 = 0LL;
    if ( v6 == 0x1000000 || *(_DWORD *)(v5 + 52) < (unsigned int)(*(_DWORD *)(v5 + 68) * v6) )
    {
      v4 = IO80211CommandQueue::map(
             v5,
             (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_macAddressEqualAndLru,
             v3,
             (__int64)a2,
             0LL,
             -1);
      if ( v4 )
      {
        LODWORD(v8) = (*(int (__fastcall **)(__int64, signed __int64 (__fastcall *)(__int64, __int64, const void *)))(*(_QWORD *)v3 + 56LL))(
                        v3,
                        _macAddressEqualAndLru);
        v9 = OSMetaClass::getClassName(v8);
        v10 = *((_BYTE *)a2 + 5);
        v11 = *((_BYTE *)a2 + 4);
        v12 = *((_BYTE *)a2 + 3);
        v13 = *((_BYTE *)a2 + 2);
        v14 = *((_BYTE *)a2 + 1);
        IO80211PeerManager::logDebug(
          (IO80211PeerManager *)v3,
          0x200000000LL,
          "%s::%s EXIST %02X:%02X:%02X:%02X:%02X:%02X\n",
          v9,
          (__int64)"addPeer",
          *(_BYTE *)a2);
      }
      else
      {
        v15 = v3;
        v16 = (IO80211QueueDescriptor *)IO80211Peer::withAddressAndManager(v2, (const unsigned __int8 *)v3, v7);
        v17 = (__int64)v16;
        v4 = 0LL;
        if ( v16 )
        {
          v15 = (__int64)v16;
          if ( IO80211CommandQueue::lockEnqueue(*(IO80211CommandQueue **)(v3 + 88), v16) )
          {
            v4 = v17;
          }
          else
          {
            (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v17 + 40LL))(v17, v15);
            v4 = 0LL;
          }
        }
        LODWORD(v18) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v3 + 56LL))(v3, v15);
        v19 = v18;
        v20 = OSMetaClass::getClassName(v18);
        LODWORD(v21) = current_thread(v19, v15);
        v22 = *((_BYTE *)v2 + 5);
        v23 = *((_BYTE *)v2 + 4);
        v24 = *((_BYTE *)v2 + 3);
        v25 = *((_BYTE *)v2 + 2);
        v26 = *((_BYTE *)v2 + 1);
        v27 = *(_BYTE *)v2;
        IO80211PeerManager::logDebug(
          (IO80211PeerManager *)v3,
          0x200000000LL,
          "%s::%s <%p> %s %02X:%02X:%02X:%02X:%02X:%02X %p\n",
          v20,
          (__int64)"addPeer",
          v21);
      }
    }
  }
  return v4;
}
// C8A50: using guessed type int __fastcall current_thread(_QWORD, _QWORD);

//----- (0000000000045042) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::setPeerCacheControl(IO80211PeerManager *this, __int64 a2)
{
  __int64 result; // rax@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  int v5; // ST20_4@2
  int v6; // ST18_4@2
  int v7; // ST10_4@2
  int v8; // ST08_4@2
  int v9; // ST00_4@2
  unsigned int v10; // eax@4
  unsigned int v11; // ecx@4
  bool v12; // zf@4

  result = 22LL;
  if ( *((_QWORD *)this + 11) )
  {
    LODWORD(v3) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
    v4 = OSMetaClass::getClassName(v3);
    v5 = *(_BYTE *)(a2 + 13);
    v6 = *(_BYTE *)(a2 + 12);
    v7 = *(_BYTE *)(a2 + 11);
    v8 = *(_BYTE *)(a2 + 10);
    v9 = *(_BYTE *)(a2 + 9);
    IO80211PeerManager::logDebug(
      this,
      0x200000000LL,
      "%s::%s %02X:%02X:%02X:%02X:%02X:%02X\n",
      v4,
      (__int64)"setPeerCacheControl",
      *(_BYTE *)(a2 + 8));
    if ( *(_BYTE *)(a2 + 44) != 1 )
      *(_BYTE *)(a2 + 44) = 0;
    v10 = IO80211PeerManager::performCacheOperation(this, (__int64 (__fastcall *)(__int64, __int64, __int64))a2);
    v11 = v10;
    v12 = v10 == 0;
    result = 22LL;
    if ( v12 )
      result = v11;
  }
  return result;
}

//----- (00000000000450F6) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::uncache(IO80211PeerManager *this, ether_addr *a2)
{
  __int64 v2; // r15@1
  unsigned int v3; // ebx@1
  OSMetaClass *v4; // rax@2
  __int64 v5; // rax@2
  __int64 v7; // [sp+0h] [bp-60h]@1
  __int64 v8; // [sp+8h] [bp-58h]@1
  __int64 v9; // [sp+10h] [bp-50h]@1
  __int64 v10; // [sp+18h] [bp-48h]@1
  __int64 v11; // [sp+20h] [bp-40h]@1
  __int64 v12; // [sp+28h] [bp-38h]@1
  __int64 v13; // [sp+30h] [bp-30h]@1
  int v14; // [sp+38h] [bp-28h]@1
  __int64 v15; // [sp+40h] [bp-20h]@1

  v2 = off_7B078[0];
  v15 = *(_QWORD *)off_7B078[0];
  v14 = 0;
  v13 = 0LL;
  v12 = 0LL;
  v11 = 0LL;
  v10 = 0LL;
  v9 = 0LL;
  v8 = 0LL;
  LODWORD(v7) = 1;
  memcpy(&v8, a2, 6uLL);
  HIDWORD(v7) = 2;
  v3 = IO80211PeerManager::performCacheOperation(this, (__int64 (__fastcall *)(__int64, __int64, __int64))&v7);
  if ( v3 )
  {
    LODWORD(v4) = (*(int (__fastcall **)(IO80211PeerManager *, __int64 *))(*(_QWORD *)this + 56LL))(this, &v7);
    v5 = OSMetaClass::getClassName(v4);
    IO80211PeerManager::logDebug(this, "%s::%s ret %d opcode %u\n", v5, (__int64)"uncache", v3, HIDWORD(v7));
  }
  return *(_QWORD *)v2;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (00000000000451CE) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::removePeer(IO80211PeerManager *this, IO80211Peer *a2)
{
  IO80211Peer *v2; // r15@1
  IO80211PeerManager *v3; // r14@1
  signed int v4; // ebx@1
  __int64 v5; // rax@2
  int v6; // er8@3
  int v7; // er10@3
  int v8; // edx@3
  int v9; // edi@3
  int v10; // ebx@3
  __int64 v11; // rcx@3
  int v12; // eax@4
  int v13; // ST38_4@5
  IO80211Peer *v14; // rax@6
  IO80211VirtualInterface *v15; // rdi@9

  v2 = a2;
  v3 = this;
  v4 = -536870212;
  if ( a2 )
  {
    v5 = IO80211PeerManager::getPeerManagerLogFlags(this);
    if ( _bittest((const unsigned __int64 *)&v5, 0x21u) )
    {
      a2 = 0;
      v6 = *((_BYTE *)v2 + 33);
      v7 = *((_BYTE *)v2 + 34);
      v8 = *((_BYTE *)v2 + 35);
      v9 = *((_BYTE *)v2 + 36);
      v10 = *((_BYTE *)v2 + 37);
      v11 = *((_QWORD *)v3 + 11);
      if ( v11 )
        v12 = *(_DWORD *)(v11 + 52);
      v13 = *((_DWORD *)v3 + 130);
      IO80211PeerManager::logDebug(
        v3,
        0x200000000LL,
        "%s %s %02X:%02X:%02X:%02X:%02X:%02X peer=%p num %d do=%u\n",
        (__int64)"removePeer",
        (__int64)"OK",
        *((_BYTE *)v2 + 32));
    }
    v14 = (IO80211Peer *)*((_QWORD *)v3 + 10);
    if ( v14 )
    {
      v4 = 0;
      if ( v14 == v2 )
        bzero((char *)v2 + 32, 6uLL);
    }
    else
    {
      v15 = (IO80211VirtualInterface *)*((_QWORD *)v3 + 16);
      if ( v15 && *((_DWORD *)v3 + 130) )
      {
        a2 = (IO80211Peer *)((char *)v2 + 32);
        IO80211VirtualInterface::postPeerAbsence(v15, (ether_addr *)((char *)v2 + 32));
      }
      if ( *((_DWORD *)v3 + 189) && *((_BYTE *)v2 + 522) )
      {
        *((_BYTE *)v2 + 522) = 0;
        *((_BYTE *)v2 + 477) = 0;
        a2 = (IO80211Peer *)((char *)v2 + 32);
        IO80211PeerManager::uncache(v3, (ether_addr *)((char *)v2 + 32));
      }
      (*(void (__fastcall **)(IO80211Peer *, IO80211Peer *))(*(_QWORD *)v2 + 288LL))(v2, a2);
      (*(void (__fastcall **)(IO80211Peer *))(*(_QWORD *)v2 + 40LL))(v2);
      v4 = 0;
    }
  }
  return (unsigned int)v4;
}

//----- (0000000000045319) ----------------------------------------------------
__int64 __fastcall _addToFlush(__int64 a1, __int64 a2)
{
  *(_BYTE *)(a2 + 12) = 0;
  IO80211CommandQueue::lockEnqueue(*(IO80211CommandQueue **)(a1 + 728), (IO80211QueueDescriptor *)a2);
  return 0LL;
}

//----- (0000000000045331) ----------------------------------------------------
signed __int64 _removePeers()
{
  return 12LL;
}

//----- (000000000004533C) ----------------------------------------------------
int __usercall IO80211PeerManager::removeFlushedPeers@<eax>(IO80211PeerManager *this@<rdi>, __int64 a2@<rax>)
{
  IO80211PeerManager *v2; // rbx@1
  IO80211CommandQueue *v3; // rdi@1

  v2 = this;
  v3 = (IO80211CommandQueue *)*((_QWORD *)this + 91);
  if ( v3 )
  {
    while ( 1 )
    {
      a2 = IO80211CommandQueue::lockDequeue(v3, 0);
      if ( !a2 )
        break;
      (*(void (__fastcall **)(IO80211PeerManager *, __int64))(*(_QWORD *)v2 + 456LL))(v2, a2);
      v3 = (IO80211CommandQueue *)*((_QWORD *)v2 + 91);
    }
  }
  return a2;
}

//----- (000000000004537C) ----------------------------------------------------
int __fastcall IO80211PeerManager::removePeer(IO80211PeerManager *this, unsigned __int8 *a2)
{
  __int64 v2; // r15@1
  __int64 v3; // rbx@1
  int result; // eax@1
  __int64 v5; // rdi@2
  __int64 v6; // r14@4
  __int64 v7; // rdi@6
  int v8; // eax@7

  v2 = (__int64)a2;
  v3 = (__int64)this;
  result = -536870212;
  if ( a2 )
  {
    v5 = *((_QWORD *)this + 82);
    if ( v5 )
    {
      IORecursiveLockLock(v5);
      ++*(_DWORD *)(v3 + 664);
    }
    v6 = *(_QWORD *)(v3 + 80);
    if ( !v6 )
    {
      a2 = (unsigned __int8 *)_macAddressEqualAndRemove;
      v6 = IO80211CommandQueue::map(
             *(_QWORD *)(v3 + 88),
             (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_macAddressEqualAndRemove,
             v3,
             v2,
             0LL,
             -1);
    }
    v7 = *(_QWORD *)(v3 + 656);
    if ( v7 )
    {
      v8 = *(_DWORD *)(v3 + 664);
      if ( v8 )
        *(_DWORD *)(v3 + 664) = v8 - 1;
      IORecursiveLockUnlock(v7, a2);
    }
    result = 0;
    if ( v6 )
      result = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v3 + 456LL))(v3, v6);
  }
  return result;
}
// C7758: using guessed type int __cdecl IORecursiveLockLock(_QWORD);
// C7760: using guessed type int __fastcall IORecursiveLockUnlock(_QWORD, _QWORD);

//----- (000000000004542D) ----------------------------------------------------
char *__fastcall stringFromScanSource(unsigned int a1)
{
  char *result; // rax@2

  if ( a1 > 0xA )
    result = "unknown";
  else
    result = off_7D8E0[a1];
  return result;
}
// 7D8E0: using guessed type char *off_7D8E0[11];

//----- (0000000000045450) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::setScanningState(IO80211PeerManager *this, unsigned int a2, char a3, __int64 a4)
{
  unsigned int v4; // er15@1
  IO80211PeerManager *v5; // r12@1
  unsigned int v6; // eax@3
  signed __int64 v7; // rsi@4
  char v8; // r14@4
  unsigned int v9; // edx@4
  int v10; // er13@10
  int v11; // er13@12
  __int64 result; // rax@12
  __int64 v13; // r14@13
  __int64 v14; // rbx@13
  OSMetaClass *v15; // rax@13
  __int64 v16; // rcx@13
  int v17; // edi@13
  char *v18; // rax@14
  unsigned int v19; // edx@20
  __int64 v20; // r15@25
  __int64 v21; // rbx@25
  OSMetaClass *v22; // rax@25
  __int64 v23; // r10@25
  int v24; // er8@25
  char *v25; // r9@26
  int v26; // edx@27
  int v27; // ecx@28
  int v28; // edi@28
  unsigned int v29; // [sp+4Ch] [bp-34h]@25
  __int64 v30; // [sp+50h] [bp-30h]@24

  v4 = a2;
  v5 = this;
  *((_DWORD *)this + 114) = 0;
  if ( a3 )
  {
    if ( a4 )
    {
      v6 = *(_DWORD *)(a4 + 68);
      if ( v6 )
      {
        v7 = a4 + 80;
        v8 = 1;
        v9 = 0;
        do
        {
          if ( *(_DWORD *)(v7 - 4) > 0xBu || *(_DWORD *)v7 )
            v8 = 0;
          v7 += 12LL;
          ++v9;
        }
        while ( v9 < v6 );
      }
      else
      {
        v6 = 0;
        v8 = 1;
      }
      if ( v6 <= *((_DWORD *)this + 116) && v8 & 1 )
        *((_DWORD *)this + 114) = 1;
      v19 = *(_WORD *)(a4 + 60);
      if ( v19 > *((_DWORD *)this + 117) )
        *((_DWORD *)this + 114) = 0;
      if ( v6 * v19 > *((_DWORD *)this + 118) )
        *((_DWORD *)this + 114) = 0;
    }
    v30 = a4;
    v11 = *((_DWORD *)this + 139) | ((v4 != 6) + 1);
    if ( IO80211PeerManager::getPeerManagerLogFlags(this) & 0x400000 )
    {
      v29 = v4;
      v20 = *((_QWORD *)this + 73);
      v21 = getAbsoluteTime() - v20;
      LODWORD(v22) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
      v23 = OSMetaClass::getClassName(v22);
      v24 = *((_DWORD *)this + 139);
      if ( v29 <= 0xA )
        v25 = off_7D8E0[v29];
      v26 = *((_DWORD *)this + 114);
      if ( v30 )
      {
        v27 = *(_DWORD *)(v30 + 68);
        v28 = *(_WORD *)(v30 + 60);
      }
      IO80211PeerManager::logDebug(
        v5,
        0x400000LL,
        "%s::%s %s %u -> %u %llu.%03llu from %s lvl %u num %u dwell %u 2.4GHz %u \n",
        v23,
        (__int64)"setScanningState",
        (__int64)"On");
    }
    result = getAbsoluteTime();
    *((_QWORD *)v5 + 72) = result;
  }
  else
  {
    v10 = *((_DWORD *)this + 139);
    if ( !v10 )
      *((_QWORD *)this + 73) = getAbsoluteTime();
    v11 = ((a2 == 6) - 3) & v10;
    result = IO80211PeerManager::getPeerManagerLogFlags(this);
    if ( result & 0x400000 )
    {
      v13 = *((_QWORD *)this + 72);
      v14 = getAbsoluteTime() - v13;
      LODWORD(v15) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
      v16 = OSMetaClass::getClassName(v15);
      v17 = *((_DWORD *)this + 139);
      if ( a2 <= 0xA )
        v18 = off_7D8E0[a2];
      result = IO80211PeerManager::logDebug(
                 v5,
                 0x400000LL,
                 "%s::%s %s %u -> %u %llu.%03llu from %s\n",
                 v16,
                 (__int64)"setScanningState",
                 (__int64)"Off");
    }
  }
  *((_DWORD *)v5 + 139) = v11;
  return result;
}
// 7D8E0: using guessed type char *off_7D8E0[11];

//----- (0000000000045776) ----------------------------------------------------
void IO80211PeerManager::setJoiningState()
{
  ;
}

//----- (000000000004577C) ----------------------------------------------------
int __fastcall IO80211PeerManager::setInfraChannel(__int64 a1, __int64 a2)
{
  int result; // eax@2

  if ( a2 )
  {
    *(_DWORD *)(a1 + 104) = *(_DWORD *)(a2 + 4);
    *(_DWORD *)(a1 + 108) = *(_DWORD *)(a2 + 8);
    *(_BYTE *)(a1 + 96) = 0;
    result = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)a1 + 320LL))(a1, 9LL);
  }
  return result;
}

//----- (00000000000457AA) ----------------------------------------------------
int __fastcall IO80211PeerManager::getIfNet(IO80211PeerManager *this)
{
  int result; // eax@2
  __int64 v2; // rdi@3

  if ( *((_QWORD *)this + 16) )
  {
    result = IO80211VirtualInterface::getIfnet(*((IO80211VirtualInterface **)this + 16));
  }
  else
  {
    v2 = *((_QWORD *)this + 17);
    if ( v2 )
      result = (*(int (**)(void))(*(_QWORD *)v2 + 2408LL))();
    else
      result = 0;
  }
  return result;
}

//----- (00000000000457DE) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::dumpPacket(__int64 a1, signed __int64 a2, __int64 a3)
{
  return IO80211PeerManager::dumpPacket(a1, a2, (char *)a2, a3);
}

//----- (00000000000457F2) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::dumpPacket(__int64 a1, signed __int64 a2, char *a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r14@2
  __int64 v6; // r13@5
  __int64 v7; // rbx@5
  __int64 v8; // rax@5
  __int64 v9; // rcx@5
  __int64 v10; // rbx@5
  char v11; // r12@5
  unsigned int v12; // er15@6
  __int64 v13; // rax@7
  __int64 v14; // rbx@12
  __int64 v15; // rsi@12
  char *v16; // r8@12
  unsigned int v17; // eax@12
  unsigned int v18; // ebx@12
  unsigned int v19; // er14@12
  int v20; // edi@13
  signed __int64 v21; // rcx@14
  size_t *v22; // r12@17
  char *v23; // r13@17
  int v24; // eax@17
  __int64 v25; // rcx@17
  char *v26; // rdi@21
  unsigned int v27; // eax@21
  __int64 v28; // rbx@25
  void *v29; // r13@26
  const void *v30; // rax@29
  __int64 v31; // r12@29
  const void *v32; // rsi@29
  __int64 v33; // rax@29
  __int64 v34; // r14@32
  int v35; // ST00_4@37
  __int64 v36; // rdx@37
  __int64 v37; // rcx@37
  __int64 v38; // r8@37
  __int64 v39; // r9@37
  unsigned int v40; // esi@37
  signed int v41; // ebx@39
  int v42; // ST50_4@40
  int v43; // ST48_4@40
  int v44; // ST40_4@40
  int v45; // ST38_4@40
  int v46; // ST30_4@40
  int v47; // ST28_4@40
  int v48; // ST20_4@40
  int v49; // ST18_4@40
  int v50; // ST10_4@40
  int v51; // ST08_4@40
  int v52; // ST00_4@40
  bool v53; // cf@40
  IO80211VirtualInterface *v54; // rdi@43
  __mbuf *v56; // [sp+58h] [bp-488h]@8
  __int64 v57; // [sp+60h] [bp-480h]@12
  __int64 v58; // [sp+98h] [bp-448h]@6
  char v59; // [sp+98h] [bp-448h]@13
  __int64 v60; // [sp+98h] [bp-448h]@25
  __int64 v61; // [sp+A0h] [bp-440h]@5
  unsigned int v62; // [sp+A0h] [bp-440h]@27
  char *v63; // [sp+A8h] [bp-438h]@1
  char *v64; // [sp+A8h] [bp-438h]@26
  char v65[64]; // [sp+B0h] [bp-430h]@12
  char v66; // [sp+F0h] [bp-3F0h]@12
  __int64 v67; // [sp+130h] [bp-3B0h]@12
  int v68; // [sp+138h] [bp-3A8h]@12
  char v69; // [sp+13Ch] [bp-3A4h]@12
  char v70; // [sp+13Dh] [bp-3A3h]@21
  char v71; // [sp+148h] [bp-398h]@12
  char v72; // [sp+149h] [bp-397h]@12
  char v73; // [sp+14Ah] [bp-396h]@12
  char v74; // [sp+14Bh] [bp-395h]@12
  int v75; // [sp+14Ch] [bp-394h]@12
  char *v76; // [sp+150h] [bp-390h]@12
  __int16 v77; // [sp+158h] [bp-388h]@12
  __int16 v78; // [sp+15Ah] [bp-386h]@12
  __int16 v79; // [sp+15Ch] [bp-384h]@12
  __int16 v80; // [sp+15Eh] [bp-382h]@21
  __int16 v81; // [sp+160h] [bp-380h]@12
  int v82; // [sp+164h] [bp-37Ch]@12
  char v83; // [sp+168h] [bp-378h]@12
  __int64 v84; // [sp+4B0h] [bp-30h]@1

  v63 = a3;
  v4 = off_7B078[0];
  v84 = *(_QWORD *)off_7B078[0];
  if ( !buf_kernel_addrperm )
  {
    v5 = a4;
    read_random(&buf_kernel_addrperm, 8u);
    LOBYTE(buf_kernel_addrperm) = buf_kernel_addrperm | 1;
    a2 = 8LL;
    read_random(&vm_kernel_addrperm, 8u);
    a4 = v5;
    vm_kernel_addrperm |= 1u;
  }
  if ( a4 && *(_QWORD *)(a4 + 16) )
  {
    v6 = v4;
    v7 = a4;
    v8 = getAbsoluteTime();
    v9 = v7;
    v61 = v8;
    v10 = *(_QWORD *)(v7 + 16);
    v11 = 0;
    if ( v10 )
    {
      v58 = v9;
      v12 = 0;
      do
      {
        v12 += mbuf_len(v10);
        LODWORD(v13) = mbuf_next(v10, a2);
        v10 = v13;
        ++v11;
      }
      while ( v13 );
      v9 = v58;
      v56 = *(__mbuf **)(v58 + 16);
    }
    else
    {
      v56 = 0LL;
      v12 = 0;
    }
    v4 = v6;
    if ( *(_DWORD *)(a1 + 164) || *(_DWORD *)(a1 + 500) )
    {
      v14 = v9;
      bzero(&v66, 0x40uLL);
      bzero(v65, 0x40uLL);
      strlcpy(&v66, v63, 0x40uLL);
      v57 = a1;
      strlcpy(v65, (const char *)(a1 + 172), 0x40uLL);
      v67 = v61;
      v69 = 0;
      v68 = OSIncrementAtomic(&_logCount) & 0xFFFFFF;
      v71 = v11;
      v77 = v12;
      v72 = mbuf_get_traffic_class(*(_QWORD *)(v14 + 16));
      v78 = mbuf_leadingspace(*(_QWORD *)(v14 + 16), a1 + 172);
      v73 = *(_BYTE *)v14;
      v79 = *(_WORD *)(v14 + 8);
      v81 = 0;
      v74 = 0;
      v75 = *(_DWORD *)(v14 + 24);
      v15 = v14;
      v76 = buf_kernel_addrperm_addr(*(void **)(v14 + 16));
      v82 = 0;
      v16 = &v83;
      v17 = *(_DWORD *)(v14 + 28);
      v18 = 0;
      v19 = 840;
      if ( v17 )
      {
        v59 = 0;
        v20 = 0;
        do
        {
          v21 = 16LL * v18;
          if ( *(_QWORD *)(v15 + v21 + 40)
            && *(_WORD *)(v15 + v21 + 34)
            && v20 + (unsigned int)*(_WORD *)(v15 + v21 + 34) + 4 < v19 )
          {
            v22 = (size_t *)(v15 + v21 + 34);
            *(_WORD *)v16 = *(_WORD *)(v15 + v21 + 32);
            *((_WORD *)v16 + 1) = *(_WORD *)v22;
            v23 = v16;
            memcpy(v16 + 4, *(const void **)(v15 + v21 + 40), *(_WORD *)v22);
            v24 = *(_WORD *)v22;
            v25 = (unsigned int)(v24 + 4);
            v16 = &v23[v25];
            v20 += v24 + 4;
            v19 -= v25;
            ++v59;
            v17 = *(_DWORD *)(v15 + 28);
          }
          ++v18;
        }
        while ( v18 < v17 );
      }
      else
      {
        v59 = 0;
        v20 = 0;
      }
      v70 = v59;
      v80 = v20;
      v26 = (char *)(unsigned int)(v20 + 184);
      v27 = *(_DWORD *)(v15 + 4);
      if ( v12 <= v27 )
      {
        v64 = v26;
        v34 = v57;
      }
      else
      {
        v74 |= 1u;
        if ( v19 > v27 )
          v19 = v27;
        if ( v19 )
        {
          v28 = *(_QWORD *)(v15 + 16);
          v60 = v15;
          if ( v28 )
          {
            v29 = v16;
            LODWORD(v64) = (_DWORD)v26;
            do
            {
              v62 = v19;
              if ( v19 > mbuf_len(v28) )
                v19 = mbuf_len(v28);
              LODWORD(v30) = mbuf_data(v28);
              v31 = v19;
              v32 = v30;
              memcpy(v29, v30, v19);
              v64 = (char *)(v19 + (unsigned int)v64);
              LODWORD(v33) = mbuf_next(v28, v32);
              v28 = v33;
              v19 = v62 - v19;
              if ( !v19 )
                break;
              v29 = (char *)v29 + v31;
            }
            while ( v33 );
          }
          else
          {
            v64 = v26;
          }
        }
        else
        {
          v64 = v26;
          v60 = v15;
        }
        v34 = v57;
        v56 = *(__mbuf **)(v57 + 760);
        mbuf_setlen(*(_QWORD *)(v57 + 760), 0LL);
        v15 = v60;
      }
      if ( *(_DWORD *)(v34 + 168) )
      {
        v35 = *(_DWORD *)(v15 + 4);
        IOLog(
          "tap with offset %u rvi_enable %u log_io %u [%s] [%s] desired_size %u mlen %u\n",
          v64,
          *(_DWORD *)(v34 + 500),
          *(_DWORD *)(v34 + 164),
          &v66,
          v65);
        v40 = *(_DWORD *)(v34 + 168);
        if ( v40 >= 2 )
        {
          IOLog("Dumping (%u):\n", v40 - 1, v36, v37, v38, v39);
          if ( *(_DWORD *)(v34 + 168) != 1 )
          {
            v41 = 7;
            do
            {
              v42 = (unsigned __int8)v65[v41 + 8];
              v43 = (unsigned __int8)v65[v41 + 7];
              v44 = (unsigned __int8)v65[v41 + 6];
              v45 = (unsigned __int8)v65[v41 + 5];
              v46 = (unsigned __int8)v65[v41 + 4];
              v47 = (unsigned __int8)v65[v41 + 3];
              v48 = (unsigned __int8)v65[v41 + 2];
              v49 = (unsigned __int8)v65[v41 + 1];
              v50 = (unsigned __int8)v65[v41];
              v51 = (unsigned __int8)v65[v41 - 1];
              v52 = (unsigned __int8)v65[v41 - 2];
              v34 = v57;
              IOLog(
                "%02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x\n",
                (unsigned __int8)v65[v41 - 7],
                (unsigned __int8)v65[v41 - 6],
                (unsigned __int8)v65[v41 - 5],
                (unsigned __int8)v65[v41 - 4],
                (unsigned __int8)v65[v41 - 3]);
              v53 = v41 + 9 < (unsigned int)(*(_DWORD *)(v57 + 168) - 1);
              v41 += 16;
            }
            while ( v53 );
          }
        }
      }
      v4 = off_7B078[0];
      if ( *(_DWORD *)(v34 + 164) || *(_DWORD *)(v34 + 500) )
      {
        v54 = *(IO80211VirtualInterface **)(v34 + 128);
        if ( v54 )
          IO80211VirtualInterface::bpfTapInput(v54, v56, 0x93u, v65, (unsigned int)v64);
      }
    }
  }
  return *(_QWORD *)v4;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 844A8: using guessed type __int64 _logCount;
// 844B0: using guessed type __int64 buf_kernel_addrperm;
// 844B8: using guessed type char vm_kernel_addrperm;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C30: using guessed type int __fastcall mbuf_get_traffic_class(_QWORD);
// C8C40: using guessed type int __fastcall mbuf_leadingspace(_QWORD, _QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C58: using guessed type int __fastcall mbuf_next(_QWORD, _QWORD);
// C8CB0: using guessed type int __fastcall mbuf_setlen(_QWORD, _QWORD);
// 457F2: using guessed type char var_430[64];

//----- (0000000000045E70) ----------------------------------------------------
void __fastcall IO80211PeerManager::unflowControlStack(IO80211PeerManager *this)
{
  IO80211PeerManager *v1; // rbx@1
  unsigned __int64 v2; // rax@4
  bool v3; // cf@4
  bool v4; // zf@4
  signed __int64 v5; // rax@4
  signed __int64 v6; // rcx@4
  IONetworkInterface *v7; // rdi@7
  __int64 v8; // rdi@10

  v1 = this;
  if ( IO80211PeerManager::getPeerManagerLogFlags(this) & 0x80 )
    IO80211PeerManager::printFlowControl(this, (int *)&stru_68.segname[8], "unflowControlStack");
  if ( *((_BYTE *)this + 236) )
  {
    Stopwatch::stop(*((Stopwatch **)this + 30));
    v2 = Stopwatch::getElapsed_us(*((Stopwatch **)this + 30));
    v3 = v2 < 0xC8;
    v4 = v2 == 200;
    v5 = 0x0CCCCCCCCCCCCCCCDLL * v2 >> 64 >> 3;
    v6 = 20LL;
    if ( v3 || v4 )
      v6 = v5;
    ++*((_DWORD *)this + v6 + 62);
    Stopwatch::reset(*((Stopwatch **)this + 30));
  }
  v7 = (IONetworkInterface *)*((_QWORD *)this + 17);
  if ( v7 && *((_BYTE *)v1 + 216) )
  {
    ++*((_DWORD *)v1 + 55);
    IONetworkInterface::signalOutputThread(v7, 0);
  }
  else
  {
    v8 = *((_QWORD *)v1 + 16);
    if ( v8 )
    {
      if ( (unsigned __int8)(*(int (__cdecl **)(__int64))(*(_QWORD *)v8 + 2224LL))(v8) )
        (*(void (**)(void))(**((_QWORD **)v1 + 16) + 2216LL))();
    }
  }
}
// 68: using guessed type section_64 stru_68;

//----- (0000000000045F50) ----------------------------------------------------
int __fastcall IO80211PeerManager::printFlowControl(IO80211PeerManager *this, int *a2, const char *a3)
{
  IO80211PeerManager *v3; // rbx@1
  __int64 v4; // rax@1
  __int64 v5; // rax@1
  int v6; // ST9C_4@1
  __int64 v7; // rax@1
  __int64 v8; // rax@1
  int v9; // ST98_4@1
  __int64 v10; // rax@1
  __int64 v11; // rax@1
  __int64 v12; // rax@1
  __int64 v13; // rdi@1
  int v14; // er14@2
  __int64 v15; // rax@2
  __int64 v16; // rdi@3
  int v17; // er14@4
  __int64 v18; // rax@6
  __int64 v19; // rdi@6
  int v20; // er11@6
  int v21; // eax@7
  __int64 v22; // rdi@8
  int v23; // eax@9
  __int64 v24; // rdi@10
  int v25; // eax@11
  __int64 v26; // rdi@12
  int v27; // eax@13
  int v28; // ST78_4@14
  int v29; // ST40_4@14
  int v30; // ST38_4@14
  int v31; // ST30_4@14
  int v32; // ST18_4@14
  int v33; // ST10_4@14
  __int64 v35; // [sp+88h] [bp-58h]@6
  __int64 v36; // [sp+90h] [bp-50h]@1
  __int64 v37; // [sp+A0h] [bp-40h]@1
  __int64 v38; // [sp+A8h] [bp-38h]@1
  int v39; // [sp+B4h] [bp-2Ch]@1

  v38 = (__int64)a3;
  v37 = (__int64)a2;
  v3 = this;
  IOLockLock(*((_QWORD *)this + 89));
  v4 = IO80211PeerManager::getController(this);
  LODWORD(v5) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v4 + 1672LL))(v4);
  v6 = (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v5 + 304LL))(v5);
  v7 = IO80211PeerManager::getController(this);
  LODWORD(v8) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v7 + 1672LL))(v7);
  v9 = (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v8 + 312LL))(v8);
  v10 = IO80211PeerManager::getController(this);
  LODWORD(v11) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v10 + 1672LL))(v10);
  LODWORD(v12) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v11 + 296LL))(v11);
  v36 = v12;
  v39 = 0;
  v13 = *((_QWORD *)this + 17);
  if ( v13 )
  {
    v14 = *((_BYTE *)v3 + 216);
    LODWORD(v15) = (*(int (**)(void))(*(_QWORD *)v13 + 2408LL))();
  }
  else
  {
    v16 = *((_QWORD *)v3 + 16);
    if ( !v16 )
      goto LABEL_6;
    v17 = (unsigned __int8)(*(int (**)(void))(*(_QWORD *)v16 + 2224LL))();
    v15 = IO80211VirtualInterface::getIfnet(*((IO80211VirtualInterface **)v3 + 16));
  }
  a2 = &v39;
  v16 = v15;
  ifnet_get_sndq_len(v15, &v39);
LABEL_6:
  LODWORD(v18) = current_thread(v16, a2);
  v35 = v18;
  *((_BYTE *)v3 + 560);
  v19 = *((_QWORD *)v3 + 4);
  v20 = *(_DWORD *)(v19 + 52);
  if ( v19 )
  {
    v21 = *(_DWORD *)(v19 + 48) - *((_DWORD *)v3 + 105);
    *(_DWORD *)(v19 + 52);
  }
  v22 = *((_QWORD *)v3 + 5);
  if ( v22 )
  {
    v23 = *(_DWORD *)(v22 + 48) - *((_DWORD *)v3 + 105);
    *(_DWORD *)(v22 + 52);
  }
  v24 = *((_QWORD *)v3 + 6);
  if ( v24 )
  {
    v25 = *(_DWORD *)(v24 + 48) - *((_DWORD *)v3 + 105);
    *(_DWORD *)(v24 + 52);
  }
  v26 = *((_QWORD *)v3 + 7);
  if ( v26 )
  {
    v27 = *(_DWORD *)(v26 + 48) - *((_DWORD *)v3 + 105);
    *(_DWORD *)(v26 + 52);
  }
  v28 = *((_DWORD *)v3 + 38);
  v29 = *(_DWORD *)(*((_QWORD *)v3 + 7) + 52LL);
  v30 = *(_DWORD *)(*((_QWORD *)v3 + 6) + 52LL);
  v31 = *(_DWORD *)(*((_QWORD *)v3 + 5) + 52LL);
  v32 = *((_DWORD *)v3 + 134);
  v33 = *(_DWORD *)(*((_QWORD *)v3 + 93) + 52LL);
  IO80211PeerManager::logDebug(
    v3,
    v37,
    "outFlow <%s> t=%p wt=%p ont %u ing %u size %u numCmd %u %s buf [%u %u %u %u] ps [%u %u %u %u] FC %u netStack %u req x%x\n",
    v38,
    v35,
    v36);
  return IOLockUnlock(*((_QWORD *)v3 + 89));
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C8A50: using guessed type int __fastcall current_thread(_QWORD, _QWORD);
// C8B00: using guessed type int __fastcall ifnet_get_sndq_len(_QWORD, _QWORD);

//----- (00000000000461CE) ----------------------------------------------------
void __usercall IO80211PeerManager::sendUnflowControlStack(IO80211PeerManager *this@<rdi>, __int64 a2@<rax>, unsigned int a3@<esi>)
{
  IO80211PeerManager *v3; // rbx@1
  __int64 v4; // rcx@5
  int v5; // edx@6
  IO80211Interface *v6; // rdi@15
  __int64 v7; // rax@16

  v3 = this;
  ++*((_DWORD *)v3 + 109);
  if ( *((_BYTE *)this + 652) )
  {
    ++*((_DWORD *)this + 110);
    if ( *((_DWORD *)this + 134) < 5 )
    {
      a2 = 0LL;
      if ( a3 <= 3 )
      {
        v4 = *((_QWORD *)this + a3 + 4);
        if ( v4 )
        {
          v5 = *(_DWORD *)(v4 + 48) - *((_DWORD *)this + 105);
          if ( v5 < 0 )
            v5 = 0;
          a2 = (unsigned int)(*(_DWORD *)(v4 + 52) - v5);
          if ( (signed int)a2 < 0 )
            a2 = 0LL;
        }
      }
      if ( (unsigned int)a2 < *((_DWORD *)this + 135) )
      {
        ++*((_DWORD *)this + 58);
        return;
      }
    }
    else
    {
      ++*((_DWORD *)this + 111);
    }
    if ( *((_BYTE *)this + 236) )
      Stopwatch::start(*((Stopwatch **)this + 30), a2);
    v6 = (IO80211Interface *)*((_QWORD *)this + 17);
    if ( v6
      && (LODWORD(v7) = IO80211Interface::getControllerWorkLoop(v6),
          (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v7 + 312LL))(v7)) )
      IO80211PeerManager::unflowControlStack(v3);
    else
      (*(void (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)v3 + 77) + 464LL))(*((_QWORD *)v3 + 77), 0LL);
  }
}

//----- (000000000004629A) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::doFreePacket(IO80211PeerManager *this, IO80211PacketDescriptor *a2)
{
  IO80211PacketDescriptor *v2; // r13@1
  signed int v3; // ebx@1
  __int64 v4; // r14@2
  __int16 v5; // bx@3
  __int64 v6; // rax@7
  int v7; // ecx@8
  __int64 v8; // rax@10
  __int64 v10; // r12@14
  __int16 v11; // cx@16
  OSMetaClass *v12; // rax@18
  __int64 v13; // rsi@18
  __int64 v14; // r8@18
  __int64 v15; // r9@18
  OSMetaClass *v16; // rax@19
  __int64 v17; // rsi@19
  __int64 v18; // r8@19
  __int64 v19; // r9@19

  v2 = a2;
  v3 = -536870176;
  if ( a2 )
  {
    v4 = *((_BYTE *)a2 + 40);
    if ( *((_BYTE *)a2 + 48) & 1 )
    {
      ++*((_DWORD *)this + 100);
      v10 = OSObject::operator new((OSObject *)&stru_20.maxprot, (unsigned __int64)a2);
      IO80211PacketDescriptor::IO80211PacketDescriptor(v10);
      if ( v10 )
      {
        if ( (unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v10 + 296LL))(v10, (unsigned int)v4) )
        {
          *(_QWORD *)(v10 + 32) = *((_QWORD *)a2 + 4);
          *(_BYTE *)(v10 + 40) = *((_BYTE *)a2 + 40);
          *(_BYTE *)(v10 + 41) = *((_BYTE *)a2 + 41);
          *(_BYTE *)(v10 + 42) = *((_BYTE *)a2 + 42);
          *(_BYTE *)(v10 + 43) = *((_BYTE *)a2 + 43);
          *(_DWORD *)(v10 + 44) = *((_DWORD *)a2 + 11);
          v11 = *((_WORD *)a2 + 24) | 0x100;
          *(_DWORD *)(v10 + 52) = *((_DWORD *)a2 + 13);
          *(_WORD *)(v10 + 56) = *((_WORD *)a2 + 28);
          *(_WORD *)(v10 + 60) = *((_WORD *)a2 + 30);
          *(_WORD *)(v10 + 58) = *((_WORD *)a2 + 29);
          *(_QWORD *)(v10 + 64) = *((_QWORD *)a2 + 8);
          *(_QWORD *)(v10 + 72) = *((_QWORD *)a2 + 9);
          *(_WORD *)(v10 + 48) = v11;
          *((_QWORD *)a2 + 4) = 0LL;
          *((_BYTE *)a2 + 48) &= 0xFEu;
          IO80211CommandQueue::lockEnqueue(*((IO80211CommandQueue **)this + 92), (IO80211QueueDescriptor *)v10);
        }
        else
        {
          LODWORD(v16) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
          v17 = OSMetaClass::getClassName(v16);
          IOLog("%s::%s cannot allocate IO80211PacketDescriptor %p\n", v17, "doFreePacket", v10, v18, v19);
          (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v10 + 40LL))(v10, v17);
        }
      }
      else
      {
        LODWORD(v12) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
        v13 = OSMetaClass::getClassName(v12);
        IOLog("%s::%s cannot allocate IO80211PacketDescriptor %p\n", v13, "doFreePacket", 0LL, v14, v15);
      }
    }
    ++*((_DWORD *)this + 244);
    v5 = *((_WORD *)v2 + 24);
    (*(void (__fastcall **)(IO80211PacketDescriptor *))(*(_QWORD *)v2 + 288LL))(v2);
    if ( HIBYTE(v5) & 1 )
    {
      (*(void (__fastcall **)(IO80211PacketDescriptor *))(*(_QWORD *)v2 + 40LL))(v2);
      v3 = 0;
    }
    else
    {
      OSDecrementAtomic((char *)this + 1020);
      v3 = 0;
      if ( !IO80211CommandQueue::lockEnqueue(*((IO80211CommandQueue **)this + v4 + 4), v2) )
      {
        (*(void (__fastcall **)(IO80211PacketDescriptor *, IO80211PacketDescriptor *))(*(_QWORD *)v2 + 40LL))(v2, v2);
        v3 = -536870181;
      }
    }
    if ( (unsigned int)v4 <= 3 )
    {
      v6 = *((_QWORD *)this + v4 + 4);
      if ( v6 )
      {
        v7 = *(_DWORD *)(v6 + 48) - *((_DWORD *)this + 105);
        if ( v7 < 0 )
          v7 = 0;
        v8 = (unsigned int)(*(_DWORD *)(v6 + 52) - v7);
        if ( (signed int)v8 >= 0 && (unsigned int)v8 >= 0x11 )
          IO80211PeerManager::sendUnflowControlStack(this, v8, v4);
      }
    }
  }
  return (unsigned int)v3;
}
// 20: using guessed type segment_command_64 stru_20;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C77C8: using guessed type int __fastcall OSDecrementAtomic(_QWORD);

//----- (00000000000464C2) ----------------------------------------------------
int __fastcall IO80211PeerManager::vlogDebug(IO80211PeerManager *this, __int64 a2, const char *a3, __va_list_tag *a4)
{
  void *v4; // rax@1
  void *v5; // r15@1
  __int64 v6; // rax@1
  unsigned int v7; // er13@1
  __int64 v8; // rcx@1
  void **v9; // r14@7
  __int64 v10; // rbx@7
  void *v11; // rbx@13
  IO80211VirtualInterface *v12; // rdi@13
  int v13; // eax@14
  IO80211Interface *v14; // rdi@15
  char *v15; // rax@17
  int v16; // eax@17
  char *v17; // r14@17
  __int64 v18; // rbx@17
  size_t v19; // r12@17
  __int64 v20; // r15@20
  __int64 v21; // rsi@20
  unsigned __int64 v22; // r12@21
  bool v23; // dl@21
  signed int v24; // er13@21
  __int64 v25; // r14@22
  char *v26; // rdi@22
  __int64 v27; // rcx@25
  __int64 v28; // rax@32
  __int64 v29; // rdx@32
  __int64 v30; // rcx@32
  __int64 v31; // r8@32
  __int64 v32; // r9@32
  __int64 v33; // rdi@35
  IO80211VirtualInterface *v34; // rdi@36
  int v36; // [sp+4h] [bp-4Ch]@7
  char *v37; // [sp+8h] [bp-48h]@1
  struct __va_list_tag *v38; // [sp+10h] [bp-40h]@1
  __int64 v39; // [sp+18h] [bp-38h]@1
  IO80211PeerManager *v40; // [sp+20h] [bp-30h]@1

  v38 = a4;
  v37 = (char *)a3;
  v40 = this;
  LODWORD(v4) = current_thread(this, a2);
  v5 = v4;
  v6 = IO80211PeerManager::getPeerManagerLogFlags(this);
  v7 = 0;
  v39 = a2 & 0x7FFFFFFFFFFFFFFFLL;
  v8 = (__int64)_log_debug_buffer_owner;
  if ( !(a2 & 0x7FFFFFFFFFFFFFFFLL) || (v6 &= a2 & 0x7FFFFFFFFFFFFFFFLL) != 0 )
  {
    while ( (_DWORD)v5 != *(_DWORD *)v8 )
    {
      ++v7;
      v8 += 4LL;
      if ( v7 > 3 )
        goto LABEL_7;
    }
    if ( v7 != -1 )
      goto LABEL_20;
LABEL_7:
    v36 = OSIncrementAtomic(&_logCount) & 0xFFFFFF;
    v9 = (void **)_log_debug_buffer;
    v7 = 0;
    v10 = 0LL;
    while ( 1 )
    {
      LODWORD(v6) = OSCompareAndSwap(0LL, (unsigned int)v5, (char *)_log_debug_buffer_owner + v10);
      if ( (_BYTE)v6 )
        break;
      ++v9;
      v10 += 4LL;
      ++v7;
      if ( v7 > 3 )
        return v6;
    }
    if ( (v7 & 0x80000000) != 0 || !*v9 )
      return v6;
    *(_DWORD *)((char *)_log_buffer_size + v10) = 184;
    v11 = *v9;
    memset(*v9, 0, 0xB8uLL);
    *((_BYTE *)v11 + 140) = 2;
    *((_QWORD *)v11 + 16) = getAbsoluteTime();
    *((_QWORD *)v11 + 18) = vm_kernel_addrperm_addr(v5);
    *((_DWORD *)v11 + 34) = v36;
    v12 = (IO80211VirtualInterface *)*((_QWORD *)this + 16);
    if ( v12 )
    {
      v13 = IO80211VirtualInterface::linkState(v12);
    }
    else
    {
      v14 = (IO80211Interface *)*((_QWORD *)v40 + 17);
      v13 = 0;
      if ( v14 )
        v13 = IO80211Interface::linkState(v14);
    }
    *((_DWORD *)v11 + 38) = v13;
    v15 = IO80211PeerManager::getBSDName(v40);
    strlcpy((char *)v11 + 64, v15, 0x40uLL);
    v16 = strlen((const char *)v11 + 64);
    v17 = (char *)v11;
    *((_BYTE *)v11 + (v16 & 0xFFFFFFFF) + 64) = 32;
    v18 = (v16 + 1) & 0xFFFFFFFF;
    v19 = (unsigned int)(62 - v16);
    proc_selfname(&v17[v18 + 64], v19);
    if ( !strncmp("kernel_task", &v17[v18 + 64], v19) )
    {
      strlcpy(&v17[v18 + 64], "ktask", 6uLL);
      memset(&v17[v18 + 69], 0, 6uLL);
    }
    LODWORD(v6) = strlcpy(v17, (const char *)v40 + 172, 0x40uLL);
LABEL_20:
    v20 = (signed int)v7;
    v21 = (__int64)_log_buffer_size;
    if ( *((_DWORD *)_log_buffer_size + (signed int)v7) )
    {
      v22 = *((_DWORD *)_log_buffer_size + (signed int)v7);
      v23 = 1;
      v24 = 2048;
      if ( v22 <= 0x7FF )
      {
        v6 = (__int64)_log_debug_buffer;
        v25 = _log_debug_buffer[v20];
        v26 = (char *)(v22 + _log_debug_buffer[v20]);
        if ( v26 )
        {
          LODWORD(v6) = vsnprintf(v26, 2047 - (signed int)v22, v37, v38);
          if ( (signed int)v6 <= 0 )
          {
            v24 = v22;
            v21 = (__int64)_log_buffer_size;
            v23 = 1;
          }
          else
          {
            v21 = (__int64)_log_buffer_size;
            v23 = 1;
            if ( (signed int)v6 <= 2047 - (signed int)v22 )
            {
              v27 = (signed int)v6 - 1;
              v23 = *(_BYTE *)(v25 + v27 + v22) == 10;
              if ( *(_BYTE *)(v25 + v27 + v22) == 10 )
                LODWORD(v27) = v6;
              v24 = v22 + v27 + 1;
            }
          }
        }
        else
        {
          v24 = v22;
        }
      }
      if ( v23 && v24 )
      {
        v28 = IO80211PeerManager::getPeerManagerLogFlags(v40);
        if ( !v39 || v39 & v28 )
        {
          if ( *((_DWORD *)v40 + 126) )
          {
            v33 = *((_QWORD *)v40 + 95);
            if ( v33 )
            {
              mbuf_setlen(v33, 0LL);
              v34 = (IO80211VirtualInterface *)*((_QWORD *)v40 + 16);
              if ( v34 )
                IO80211VirtualInterface::bpfTapInput(
                  v34,
                  *((__mbuf **)v40 + 95),
                  0x93u,
                  (void *)_log_debug_buffer[v20],
                  (unsigned int)v24);
            }
          }
        }
        if ( !v39 )
          IOLog("%s", _log_debug_buffer[v20] + 184, v29, v30, v31, v32);
        *(_DWORD *)(v21 + 4 * v20) = 0;
      }
      else
      {
        *(_DWORD *)(v21 + 4 * v20) = v24;
        if ( v24 )
          return v6;
      }
    }
    v6 = (__int64)_log_debug_buffer_owner;
    *((_DWORD *)_log_debug_buffer_owner + v20) = 0;
  }
  return v6;
}
// 844A8: using guessed type __int64 _logCount;
// 844C0: using guessed type __int64 _log_buffer_size[2];
// 844D0: using guessed type __int64 _log_debug_buffer[4];
// 844F0: using guessed type __int64 _log_debug_buffer_owner[2];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C77B8: using guessed type int __fastcall OSCompareAndSwap(_QWORD, _QWORD, _QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C8A50: using guessed type int __fastcall current_thread(_QWORD, _QWORD);
// C8CB0: using guessed type int __fastcall mbuf_setlen(_QWORD, _QWORD);
// C8D18: using guessed type int __fastcall proc_selfname(_QWORD, _QWORD);

//----- (000000000004682E) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::getPeerManagerLogFlags(IO80211PeerManager *this)
{
  __int64 result; // rax@2
  IO80211Interface *v2; // rdi@3

  if ( *((_QWORD *)this + 16) )
  {
    result = IO80211VirtualInterface::debugFlags(*((IO80211VirtualInterface **)this + 16));
  }
  else
  {
    v2 = (IO80211Interface *)*((_QWORD *)this + 17);
    if ( v2 )
      result = IO80211Interface::debugFlags(v2);
    else
      result = 0LL;
  }
  return result;
}

//----- (000000000004685E) ----------------------------------------------------
bool __fastcall IO80211PeerManager::shouldVerboseLog(IO80211PeerManager *this, __int64 a2)
{
  return (a2 & *((_QWORD *)this + 85)) != 0;
}

//----- (000000000004686E) ----------------------------------------------------
void __fastcall IO80211PeerManager::initUserPrintContext(IO80211PeerManager *a1, __int64 a2, char *a3, int a4)
{
  IO80211PeerManager::initUserPrintContext(a1, a2, (void *)a2, a3, a4);
}

//----- (0000000000046884) ----------------------------------------------------
void __fastcall IO80211PeerManager::initUserPrintContext(IO80211PeerManager *this, __int64 a2, void *a3, char *a4, int a5)
{
  int v5; // ebx@1
  void *v6; // r12@1
  IO80211PeerManager *v7; // r14@1
  __int64 v8; // rax@3
  unsigned int v9; // ebx@3
  void **v10; // r13@4
  __int64 v11; // r15@4
  void *v12; // rdi@11
  void *v13; // rax@12
  IO80211VirtualInterface *v14; // rdi@12
  int v15; // eax@13
  IO80211Interface *v16; // rdi@14
  __int64 v17; // rbx@16
  char *v18; // rax@16
  unsigned int v19; // eax@17
  char *v20; // [sp+0h] [bp-30h]@1

  v5 = a5;
  v20 = a4;
  v6 = a3;
  v7 = this;
  if ( a3 )
  {
    bzero(a3, 0x58uLL);
    if ( *((_DWORD *)this + 126)
      && (*((_DWORD *)v6 + 4) = 147,
          LODWORD(v8) = IO80211PeerManager::getIfNet(this),
          *((_QWORD *)v6 + 1) = v8,
          *((_DWORD *)v6 + 12) = v5,
          *((_QWORD *)v6 + 9) = *((_QWORD *)this + 95),
          v9 = 0,
          *((_DWORD *)this + 126)) )
    {
      v10 = (void **)_log_debug_buffer;
      v11 = 0LL;
      while ( !(unsigned __int8)OSCompareAndSwap(0LL, 1LL, (char *)_log_debug_buffer_owner + v11) )
      {
        v11 += 4LL;
        ++v10;
        ++v9;
        if ( v9 > 3 )
          return;
      }
      if ( (_DWORD)v11 != -4 )
      {
        *(_DWORD *)((char *)_log_buffer_size + v11) = 0;
        v12 = *v10;
        if ( *v10 )
        {
          *((_QWORD *)v6 + 8) = v12;
          bzero(v12, 0xB8uLL);
          *(_BYTE *)(*((_QWORD *)v6 + 8) + 140LL) = 2;
          *(_QWORD *)(*((_QWORD *)v6 + 8) + 128LL) = getAbsoluteTime();
          LODWORD(v13) = current_thread(v12, 184LL);
          *(_QWORD *)(*((_QWORD *)v6 + 8) + 144LL) = vm_kernel_addrperm_addr(v13);
          v14 = (IO80211VirtualInterface *)*((_QWORD *)v7 + 16);
          if ( v14 )
          {
            v15 = IO80211VirtualInterface::linkState(v14);
          }
          else
          {
            v16 = (IO80211Interface *)*((_QWORD *)v7 + 17);
            v15 = 0;
            if ( v16 )
              v15 = IO80211Interface::linkState(v16);
          }
          v17 = *((_QWORD *)v6 + 8);
          *(_DWORD *)(v17 + 152) = v15;
          v18 = IO80211PeerManager::getBSDName(v7);
          strlcpy((char *)(v17 + 64), v18, 0x40uLL);
          if ( v20 )
          {
            v19 = strlen((const char *)(*((_QWORD *)v6 + 8) + 64LL));
            *(_BYTE *)(*((_QWORD *)v6 + 8) + v19 + 64LL) = 32;
            strlcpy((char *)(*((_QWORD *)v6 + 8) + v19 + 1 + 64LL), v20, 63 - v19);
          }
          strlcpy(*((char **)v6 + 8), (const char *)v7 + 172, 0x40uLL);
          *((_QWORD *)v6 + 3) = *v10;
          *((_QWORD *)v6 + 4) = 790273984328LL;
        }
        *(_DWORD *)((char *)_log_debug_buffer_owner + v11) = 0;
      }
    }
    else
    {
      *((_DWORD *)v6 + 8) = 1024;
    }
  }
}
// 844C0: using guessed type __int64 _log_buffer_size[2];
// 844D0: using guessed type __int64 _log_debug_buffer[4];
// 844F0: using guessed type __int64 _log_debug_buffer_owner[2];
// C77B8: using guessed type int __fastcall OSCompareAndSwap(_QWORD, _QWORD, _QWORD);
// C8A50: using guessed type int __fastcall current_thread(_QWORD, _QWORD);

//----- (0000000000046A7C) ----------------------------------------------------
void __fastcall IO80211PeerManager::logUserPrint(IO80211PeerManager *this, IO80211QueueDescriptor *a2, int a3, char *a4)
{
  IO80211PeerManager::logUserPrint(this, (__int64)a2, a2, a3, a4);
}

//----- (0000000000046A92) ----------------------------------------------------
void __fastcall IO80211PeerManager::logUserPrint(IO80211PeerManager *this, __int64 a2, IO80211QueueDescriptor *a3, int a4, char *a5)
{
  unsigned int v5; // er12@1
  __int64 *v6; // r14@2
  __int64 v7; // r15@2
  IO80211PeerManager *v8; // r12@8
  __int64 v9; // rax@8
  __int64 v10; // rbx@8
  void *v11; // rax@8
  IO80211VirtualInterface *v12; // rdi@8
  int v13; // eax@9
  IO80211Interface *v14; // rdi@10
  char *v15; // rbx@12
  char *v16; // rax@12
  int v17; // eax@13
  IO80211QueueDescriptor *v18; // [sp+8h] [bp-98h]@1
  const char *v19; // [sp+10h] [bp-90h]@1
  int v20; // [sp+18h] [bp-88h]@1
  IO80211PeerManager *v21; // [sp+18h] [bp-88h]@9
  __int64 v22; // [sp+20h] [bp-80h]@8
  __int64 v23; // [sp+28h] [bp-78h]@8
  __int64 v24; // [sp+30h] [bp-70h]@8
  __int64 v25; // [sp+38h] [bp-68h]@8
  __int64 v26; // [sp+40h] [bp-60h]@8
  __int64 v27; // [sp+48h] [bp-58h]@8
  __int64 v28; // [sp+50h] [bp-50h]@8
  __int64 v29; // [sp+58h] [bp-48h]@8
  char *v30; // [sp+60h] [bp-40h]@8
  __int64 v31; // [sp+68h] [bp-38h]@8
  __int64 v32; // [sp+70h] [bp-30h]@8

  v19 = a5;
  v20 = a4;
  v18 = a3;
  v5 = 0;
  if ( a3 )
  {
    v6 = _log_debug_buffer;
    v7 = 0LL;
    while ( !(unsigned __int8)OSCompareAndSwap(0LL, 4289724415LL, (char *)_log_debug_buffer_owner + v7) )
    {
      v7 += 4LL;
      ++v6;
      ++v5;
      if ( v5 > 3 )
        return;
    }
    if ( (_DWORD)v7 != -4 )
    {
      *(_DWORD *)((char *)_log_buffer_size + v7) = 0;
      if ( *v6 )
      {
        v32 = 0LL;
        v31 = 0LL;
        v30 = 0LL;
        v29 = 0LL;
        v28 = 0LL;
        v27 = 0LL;
        v26 = 0LL;
        v25 = 0LL;
        v24 = 0LL;
        v22 = 0LL;
        LODWORD(v24) = 147;
        v8 = this;
        LODWORD(v9) = IO80211PeerManager::getIfNet(this);
        v23 = v9;
        LODWORD(v28) = v20;
        v10 = *v6;
        v30 = (char *)v10;
        memset((void *)v10, 0, 0xB8uLL);
        *(_BYTE *)(v10 + 140) = 2;
        *(_QWORD *)(v10 + 128) = getAbsoluteTime();
        LODWORD(v11) = current_thread(v10, 0LL);
        *(_QWORD *)(v10 + 144) = vm_kernel_addrperm_addr(v11);
        v12 = (IO80211VirtualInterface *)*((_QWORD *)this + 16);
        if ( v12 )
        {
          v21 = v8;
          v13 = IO80211VirtualInterface::linkState(v12);
        }
        else
        {
          v14 = (IO80211Interface *)*((_QWORD *)v8 + 17);
          v21 = v8;
          v13 = 0;
          if ( v14 )
            v13 = IO80211Interface::linkState(v14);
        }
        v15 = v30;
        *((_DWORD *)v30 + 38) = v13;
        v16 = IO80211PeerManager::getBSDName(v21);
        strlcpy(v15 + 64, v16, 0x40uLL);
        if ( v19 )
        {
          v17 = strlen(v15 + 64);
          v30[v17 + 64] = 32;
          strlcpy(&v30[v17 + 1 + 64], v19, (unsigned int)(63 - v17));
          v15 = v30;
        }
        strlcpy(v15, (const char *)v21 + 172, 0x40uLL);
        v25 = *v6;
        v26 = 790273984328LL;
        v31 = *((_QWORD *)v21 + 95);
        (*(void (__fastcall **)(IO80211QueueDescriptor *, __int64 *))(*(_QWORD *)v18 + 280LL))(v18, &v22);
      }
      *(_DWORD *)((char *)_log_debug_buffer_owner + v7) = 0;
    }
  }
}
// 844C0: using guessed type __int64 _log_buffer_size[2];
// 844D0: using guessed type __int64 _log_debug_buffer[4];
// 844F0: using guessed type __int64 _log_debug_buffer_owner[2];
// C77B8: using guessed type int __fastcall OSCompareAndSwap(_QWORD, _QWORD, _QWORD);
// C8A50: using guessed type int __fastcall current_thread(_QWORD, _QWORD);

//----- (0000000000046CE6) ----------------------------------------------------
int __fastcall IO80211PeerManager::vlogDebugBPF(IO80211PeerManager *this, __int64 a2, const char *a3, __va_list_tag *a4)
{
  return IO80211PeerManager::vlogDebug(this, a2 | 0x8000000000000000LL, a3, a4);
}

//----- (0000000000046D00) ----------------------------------------------------
int __fastcall IO80211PeerManager::reportTransmitStatus(IO80211PeerManager *this, __int64 a2, int a3, __int64 a4)
{
  __int64 v4; // r12@1
  int v5; // er14@1
  __int64 v6; // rbx@1
  int *v7; // rax@2
  int *v8; // r13@2
  int v9; // ST74_4@3
  __int64 v10; // rdi@4
  __int64 v11; // rax@7
  IO80211PacketDescriptor *v12; // rax@14
  IO80211Peer *v13; // rdi@15
  __int64 v14; // rdi@20
  IO80211VirtualInterface *v15; // rdi@25
  IONetworkInterface *v16; // rdi@27
  IO80211PacketDescriptor *v17; // rsi@29
  int v18; // er15@32
  int v19; // er14@32
  int v20; // er8@32
  int v21; // ecx@32
  int v22; // edx@32
  int v23; // esi@32
  int v24; // edi@33
  int v25; // ST58_4@34
  __int64 v26; // rdi@35
  int v27; // eax@36
  __int64 v29; // [sp+68h] [bp-78h]@32
  int v30; // [sp+70h] [bp-70h]@32
  __int64 v31; // [sp+78h] [bp-68h]@4
  int v32[2]; // [sp+80h] [bp-60h]@4
  IO80211PacketDescriptor *v33; // [sp+88h] [bp-58h]@4
  __int64 v34; // [sp+90h] [bp-50h]@4
  __int64 v35; // [sp+98h] [bp-48h]@4
  __int64 v36; // [sp+A0h] [bp-40h]@4
  __int64 v37; // [sp+A8h] [bp-38h]@4
  __int64 v38; // [sp+B0h] [bp-30h]@4

  v4 = a4;
  v5 = a3;
  v6 = (__int64)this;
  if ( a2 )
  {
    mbuf_get_traffic_class(a2);
    LODWORD(v7) = mbuf_data(a2);
    v8 = v7;
  }
  else
  {
    v9 = *(_BYTE *)(a4 + 45);
    v8 = &null_address;
  }
  v38 = 0LL;
  v37 = 0LL;
  v36 = 0LL;
  v35 = 0LL;
  v33 = 0LL;
  *(_QWORD *)v32 = 0LL;
  v31 = a2;
  v34 = v4;
  v32[0] = v5;
  v10 = *((_QWORD *)this + 82);
  if ( v10 )
  {
    IORecursiveLockLock(v10);
    ++*(_DWORD *)(v6 + 664);
  }
  if ( a2 )
  {
    LODWORD(v11) = *(_BYTE *)v8 & 1;
  }
  else
  {
    v11 = *(_QWORD *)(v6 + 72);
    if ( v11 )
      LOBYTE(v11) = *(_DWORD *)(v4 + 40) >> 14 == *(_DWORD *)(v11 + 248);
    else
      LOBYTE(v11) = 0;
    LODWORD(v11) = (unsigned __int8)v11;
  }
  if ( (_DWORD)v11 )
    IO80211Peer::reportTransmitStatus(*(IO80211Peer **)(v6 + 72), (__int64)&v31);
  v12 = v33;
  if ( !v33 )
  {
    v13 = *(IO80211Peer **)(v6 + 80);
    if ( v13 )
      IO80211Peer::reportTransmitStatus(v13, (__int64)&v31);
    else
      IO80211CommandQueue::map(
        *(_QWORD *)(v6 + 88),
        (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_reportTransmitStatus,
        v6,
        (__int64)&v31,
        0LL,
        -1);
    v12 = v33;
    if ( !v33 )
    {
      IO80211CommandQueue::map(
        *(_QWORD *)(v6 + 736),
        (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_reclaimFlushedPacket,
        v6,
        (__int64)&v31,
        0LL,
        -1);
      v12 = v33;
      if ( !v33 )
        goto LABEL_46;
    }
  }
  v14 = *((_QWORD *)v12 + 4);
  if ( v14 && !(*((_BYTE *)v12 + 48) & 1) )
  {
    LODWORD(v12) = mbuf_data(v14);
    if ( *(_BYTE *)v12 & 1 )
      ++*(_DWORD *)(v6 + 772);
    else
      ++*(_DWORD *)(v6 + 768);
    v15 = *(IO80211VirtualInterface **)(v6 + 128);
    if ( v15 )
      LODWORD(v12) = IO80211VirtualInterface::reportTransmitCompletionStatus(v15, *((__mbuf **)v33 + 4));
    v16 = *(IONetworkInterface **)(v6 + 136);
    if ( v16 )
      LODWORD(v12) = IONetworkInterface::reportTransmitCompletionStatus(v16, *((__mbuf **)v33 + 4), v32[0], 0, 0, 0);
  }
  v17 = v33;
  if ( v33 )
  {
    if ( (_BYTE)v35 )
      LODWORD(v12) = IO80211PeerManager::doFreePacket((IO80211PeerManager *)v6, v33);
  }
  else
  {
LABEL_46:
    v30 = v5;
    ++*(_DWORD *)(v6 + 1024);
    v29 = (__int64)IO80211PeerManager::getBSDName((IO80211PeerManager *)v6);
    v18 = *(_BYTE *)v8;
    v19 = *((_BYTE *)v8 + 1);
    v20 = *((_BYTE *)v8 + 2);
    v21 = *((_BYTE *)v8 + 3);
    v22 = *((_BYTE *)v8 + 4);
    v23 = *((_BYTE *)v8 + 5);
    if ( v4 )
      v24 = *(_DWORD *)(v4 + 40);
    v25 = *(_DWORD *)(v6 + 1024);
    v17 = 0LL;
    LODWORD(v12) = IO80211PeerManager::logDebug(
                     (IO80211PeerManager *)v6,
                     0LL,
                     "%s<%s> packet not found: status %x peerfound %u pkt %p ac %u m=%p [%02X:%02X:%02X:%02X:%02X:%02X] tag=%x unrec=%u\n",
                     (__int64)"reportTransmitStatus",
                     v29,
                     (unsigned int)v30);
  }
  v26 = *(_QWORD *)(v6 + 656);
  if ( v26 )
  {
    v27 = *(_DWORD *)(v6 + 664);
    if ( v27 )
      *(_DWORD *)(v6 + 664) = v27 - 1;
    LODWORD(v12) = IORecursiveLockUnlock(v26, v17);
  }
  if ( HIDWORD(v37) )
  {
    OSBitOrAtomic(HIDWORD(v37), v6 + 152);
    LODWORD(v12) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v6 + 640) + 464LL))(*(_QWORD *)(v6 + 640), 0LL);
  }
  if ( (_WORD)v38 )
    ++*(_DWORD *)(v6 + 984);
  return (signed int)v12;
}
// 77FDC: using guessed type int null_address;
// C7758: using guessed type int __cdecl IORecursiveLockLock(_QWORD);
// C7760: using guessed type int __fastcall IORecursiveLockUnlock(_QWORD, _QWORD);
// C77B0: using guessed type int __fastcall OSBitOrAtomic(_QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C30: using guessed type int __fastcall mbuf_get_traffic_class(_QWORD);

//----- (0000000000047012) ----------------------------------------------------
__int64 __fastcall _reportTransmitStatus(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rdi@1
  __int64 v5; // rcx@4
  __int64 result; // rax@4
  int v7; // [sp+8h] [bp-18h]@2
  __int16 v8; // [sp+Ch] [bp-14h]@2

  v3 = a3;
  v4 = *(_QWORD *)a3;
  if ( *(_QWORD *)a3
    && (v8 = 0, v7 = 0, mbuf_copydata(v4, 0LL, 6LL, &v7), *(_QWORD *)v3)
    && !memcmp((const void *)(a2 + 32), &v7, 6uLL)
    || (v5 = *(_QWORD *)(v3 + 24), result = 0LL, v5) && *(_DWORD *)(v5 + 40) >> 14 == *(_DWORD *)(a2 + 248) )
  {
    *(_BYTE *)(v3 + 33) = 1;
    IO80211Peer::reportTransmitStatus((IO80211Peer *)a2, v3);
    result = 3 * (unsigned int)(*(_QWORD *)(v3 + 16) != 0LL);
  }
  return result;
}
// C8BF0: using guessed type int __fastcall mbuf_copydata(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000470A4) ----------------------------------------------------
signed __int64 __fastcall _reclaimFlushedPacket(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rcx@3
  signed __int64 result; // rax@3

  if ( *(_QWORD *)a3 && *(_QWORD *)(a2 + 32) == *(_QWORD *)a3
    || (v3 = *(_QWORD *)(a3 + 24), result = 0LL, v3) && *(_DWORD *)(v3 + 40) == *(_DWORD *)(a2 + 52) )
  {
    *(_QWORD *)(a3 + 16) = a2;
    *(_BYTE *)(a3 + 32) = 1;
    *(_BYTE *)(a2 + 48) &= 0xFEu;
    result = 5LL;
  }
  return result;
}

//----- (00000000000470DC) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::checkForCacheablePeers(IO80211PeerManager *this)
{
  __int64 v1; // rbx@1
  __int64 v2; // r12@1
  __int64 v3; // rdi@1
  unsigned int v4; // er14@3
  __int64 v5; // r15@3
  __int64 v6; // rdi@3
  int v7; // eax@4
  __int64 v8; // rax@8
  OSMetaClass *v9; // rax@9
  __int64 v10; // rax@9
  __int64 result; // rax@11
  char v12; // [sp+28h] [bp-68h]@3
  int v13; // [sp+30h] [bp-60h]@9
  __int64 v14; // [sp+68h] [bp-28h]@1

  v1 = (__int64)this;
  v2 = off_7B078[0];
  v14 = *(_QWORD *)off_7B078[0];
  v3 = *((_QWORD *)this + 82);
  if ( v3 )
  {
    IORecursiveLockLock(v3);
    ++*(_DWORD *)(v1 + 664);
  }
  v4 = 0;
  v5 = IO80211CommandQueue::map(
         *(_QWORD *)(v1 + 88),
         (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_findUncachedPeer,
         v1,
         (__int64)&v12,
         0LL,
         -1);
  v6 = *(_QWORD *)(v1 + 656);
  if ( v6 )
  {
    v7 = *(_DWORD *)(v1 + 664);
    if ( v7 )
      *(_DWORD *)(v1 + 664) = v7 - 1;
    IORecursiveLockUnlock(v6, _findUncachedPeer);
  }
  if ( v5 )
  {
    v8 = IO80211PeerManager::getPeerManagerLogFlags((IO80211PeerManager *)v1);
    if ( _bittest((const unsigned __int64 *)&v8, 0x21u) )
    {
      LODWORD(v9) = (*(int (__fastcall **)(__int64, signed __int64 (__fastcall *)(__int64, IO80211Peer *, void *)))(*(_QWORD *)v1 + 56LL))(
                      v1,
                      _findUncachedPeer);
      v10 = OSMetaClass::getClassName(v9);
      IO80211PeerManager::logDebug(
        (IO80211PeerManager *)v1,
        0x200000000LL,
        "%s::%s Found cacheable peer: %02x:%02x:%02x:%02x:%02x:%02x\n",
        v10,
        (__int64)"checkForCacheablePeers",
        (unsigned __int8)v13);
    }
    v4 = IO80211PeerManager::performCacheOperation(
           (IO80211PeerManager *)v1,
           (__int64 (__fastcall *)(__int64, __int64, __int64))&v12);
  }
  result = *(_QWORD *)v2;
  if ( *(_QWORD *)v2 == v14 )
    result = v4;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C7758: using guessed type int __cdecl IORecursiveLockLock(_QWORD);
// C7760: using guessed type int __fastcall IORecursiveLockUnlock(_QWORD, _QWORD);

//----- (0000000000047213) ----------------------------------------------------
signed __int64 __fastcall _findUncachedPeer(__int64 a1, IO80211Peer *a2, void *a3)
{
  void *v3; // r14@1
  char v4; // cl@2
  signed __int64 result; // rax@2

  v3 = a3;
  if ( !IO80211Peer::hasQueuedPackets(a2) || (v4 = IO80211Peer::cacheControlPending(a2, v3), result = 1LL, !v4) )
    result = 0LL;
  return result;
}

//----- (000000000004724A) ----------------------------------------------------
int __fastcall IO80211PeerManager::disableWorkLoopSources(IO80211PeerManager *this)
{
  IO80211PeerManager *v1; // rbx@1
  __int64 v2; // rdi@1
  int result; // eax@2
  __int64 v4; // rdi@3
  __int64 v5; // rdi@5
  IO80211CommandQueue *v6; // rdi@7

  v1 = this;
  v2 = *((_QWORD *)this + 80);
  if ( v2 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v2 + 536LL))(v2);
    result = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 80) + 344LL))(*((_QWORD *)v1 + 80));
  }
  v4 = *((_QWORD *)v1 + 77);
  if ( v4 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v4 + 536LL))(v4);
    result = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 77) + 344LL))(*((_QWORD *)v1 + 77));
  }
  v5 = *((_QWORD *)v1 + 79);
  if ( v5 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v5 + 536LL))(v5);
    result = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 79) + 344LL))(*((_QWORD *)v1 + 79));
  }
  v6 = (IO80211CommandQueue *)*((_QWORD *)v1 + 93);
  if ( v6 )
  {
    *((_DWORD *)v1 + 134) = 0;
    result = IO80211CommandQueue::flush(v6);
  }
  *((_BYTE *)v1 + 628) = 0;
  return result;
}

//----- (00000000000472EC) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::enableWorkLoopSources(IO80211PeerManager *this)
{
  IO80211PeerManager *v1; // rbx@1
  __int64 v2; // rdi@1
  __int64 v3; // rdi@3
  __int64 v4; // rdi@5
  __int64 result; // rax@7
  OSMetaClass *v6; // rax@8
  __int64 v7; // rax@8
  __int64 v8; // r9@8
  IO80211PeerManager *v9; // rdi@8
  signed __int64 v10; // rbx@8

  v1 = this;
  v2 = *((_QWORD *)this + 80);
  if ( v2 )
    (*(void (**)(void))(*(_QWORD *)v2 + 336LL))();
  v3 = *((_QWORD *)v1 + 77);
  if ( v3 )
    (*(void (**)(void))(*(_QWORD *)v3 + 336LL))();
  v4 = *((_QWORD *)v1 + 79);
  if ( v4 )
    (*(void (**)(void))(*(_QWORD *)v4 + 336LL))();
  result = IO80211PeerManager::getPeerManagerLogFlags(v1);
  if ( _bittest((const unsigned __int64 *)&result, 0x25u) )
  {
    LODWORD(v6) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)v1 + 56LL))(v1);
    v7 = OSMetaClass::getClassName(v6);
    v8 = *((_BYTE *)v1 + 628);
    v9 = v1;
    v10 = (signed __int64)((char *)v1 + 628);
    result = IO80211PeerManager::logDebug(
               v9,
               0x2000000000LL,
               "%s::%s was %u -> 1\n",
               v7,
               (__int64)"enableWorkLoopSources",
               v8);
  }
  else
  {
    v10 = (signed __int64)((char *)v1 + 628);
  }
  *(_BYTE *)v10 = 1;
  return result;
}

//----- (000000000004739E) ----------------------------------------------------
char __fastcall IO80211PeerManager::reportDataPathEvents(IO80211PeerManager *this, __int64 a2, void *a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // r15@1
  __int64 v7; // r14@1
  unsigned int v8; // ebx@1
  __int64 v9; // r12@1
  signed int v10; // eax@1
  char v11; // r13@1
  OSMetaClass *v12; // rax@6
  OSMetaClass *v13; // rdi@6
  __int64 v14; // rbx@6
  __int64 v15; // r12@6
  __int64 v16; // rax@6
  int v17; // ST20_4@6
  int v18; // ST18_4@6
  int v19; // ST10_4@6
  int v20; // ST08_4@6
  int v21; // ST00_4@6
  __int64 v22; // rdi@8
  __int64 v23; // rdi@10
  int v24; // eax@11
  OSMetaClass *v25; // rax@18
  OSMetaClass *v26; // rdi@18
  __int64 v27; // r12@18
  __int64 v28; // rax@18
  int v29; // ST20_4@18
  int v30; // ST18_4@18
  int v31; // ST10_4@18
  int v32; // ST08_4@18
  int v33; // ST00_4@18
  unsigned int v34; // ecx@23
  int v35; // er12@24
  int v36; // er15@24
  unsigned int v37; // er14@25
  OSMetaClass *v38; // rax@26
  __int64 v39; // rcx@26
  const char *v40; // rdx@26
  __int64 v41; // r8@26
  __int64 v42; // rsi@26
  __int64 v43; // r9@26
  OSMetaClass *v44; // rax@27
  __int64 v45; // rdx@27
  const char *v46; // rsi@27
  OSMetaClass *v47; // rax@29
  __int64 v48; // rdx@29
  __int64 v49; // r8@29
  __int64 v50; // r9@31
  char v51; // si@34
  OSMetaClass *v52; // rax@35
  __int64 v53; // rdx@38
  __int64 v54; // rcx@38
  __int64 v55; // r8@38
  __int64 v56; // r9@38
  __int64 v57; // rcx@39
  int v58; // ST18_4@41
  int v59; // ST10_4@41
  int v60; // ST08_4@41
  int v61; // ST00_4@41
  OSMetaClass *v62; // rax@45
  __int64 v64; // rcx@52
  int v65; // ST28_4@54
  int v66; // ST20_4@54
  int v67; // ST18_4@54
  int v68; // ST10_4@54
  int v69; // ST08_4@54
  int v70; // ST00_4@54
  __int64 v71; // rdi@55
  __int64 v72; // rax@57
  __int64 v73; // rbx@57
  __int64 v74; // r12@57
  bool v75; // zf@57
  signed int v76; // eax@57
  signed __int64 v77; // r13@59
  signed __int64 v78; // rsi@59
  __int64 v79; // r9@59
  IO80211PeerManager *v80; // r15@60
  IO80211VirtualInterface *v81; // rdi@61
  __int64 v82; // rax@62
  __int64 v83; // rdi@63
  __int64 v84; // rax@64
  __int64 v85; // rdx@65
  __int64 v86; // r9@65
  int v87; // ecx@67
  __int64 v88; // rdx@67
  int v89; // er11@68
  int v90; // er13@69
  __int64 v91; // rdx@69
  int v92; // edi@70
  int v93; // edx@71
  __int64 v94; // rax@71
  int v95; // ebx@72
  int v96; // ST40_4@73
  int v97; // ST38_4@73
  int v98; // ST30_4@73
  __int64 v99; // rdi@75
  signed int v100; // eax@79
  __int64 (__fastcall *v101)(__int64, __int64, __int64); // rsi@81
  __int64 v102; // rdi@81
  int v103; // eax@82
  unsigned int v104; // ebx@85
  __int64 v105; // r13@85
  unsigned int v106; // er12@86
  OSMetaClass *v107; // rax@86
  __int64 v108; // rcx@86
  int v109; // edi@86
  OSMetaClass *v110; // rax@89
  __int64 v111; // r10@89
  signed int v112; // eax@90
  __int64 v113; // rcx@92
  bool v114; // bl@94
  __int64 v115; // rdi@96
  __int64 v116; // rbx@98
  int v117; // eax@99
  __int64 v118; // rdi@99
  __int64 v119; // rax@100
  signed int v120; // eax@100
  __int64 *v121; // r15@103
  signed __int64 v122; // rsi@103
  __int64 v123; // r9@103
  IO80211VirtualInterface *v124; // rdi@105
  __int64 v125; // rax@106
  __int64 v126; // rdi@107
  __int64 v127; // rax@108
  __int64 v128; // rdx@109
  __int64 v129; // r9@109
  int v130; // er8@111
  __int64 v131; // rdx@111
  int v132; // er12@112
  int v133; // er11@113
  __int64 v134; // rsi@113
  int v135; // edi@114
  int v136; // er13@115
  __int64 v137; // rax@115
  int v138; // edx@116
  int v139; // ST40_4@117
  int v140; // ST38_4@117
  int v141; // ST30_4@117
  __int64 v142; // rdi@119
  int v143; // eax@120
  int v144; // eax@125
  int v145; // edx@125
  int v146; // esi@125
  int v147; // ST20_4@125
  const char *v148; // rsi@127
  IO80211PeerManager *v149; // rdi@127
  __int64 v150; // r12@128
  int v151; // ST40_4@128
  int v152; // ST30_4@128
  int v153; // ST28_4@128
  int v154; // ST20_4@128
  int v155; // ST10_4@128
  int v156; // ST08_4@128
  __int64 v157; // rdi@131
  int v158; // eax@132
  OSMetaClass *v159; // rax@137
  __int64 v160; // rax@137
  int v161; // ST28_4@137
  int v162; // ST20_4@137
  int v163; // ST18_4@137
  int v164; // ST10_4@137
  int v165; // ST08_4@137
  int v166; // ST00_4@137
  unsigned int v167; // [sp+54h] [bp-7Ch]@65
  IO80211PeerManager *v168; // [sp+58h] [bp-78h]@67
  unsigned int v169; // [sp+58h] [bp-78h]@86
  IO80211PeerManager *v170; // [sp+58h] [bp-78h]@107
  signed int v171; // [sp+60h] [bp-70h]@59
  unsigned int v172; // [sp+64h] [bp-6Ch]@81
  void *v173; // [sp+68h] [bp-68h]@75
  unsigned int v174; // [sp+70h] [bp-60h]@75
  int v175; // [sp+7Ch] [bp-54h]@105
  __int64 v176; // [sp+80h] [bp-50h]@96
  unsigned int v177; // [sp+88h] [bp-48h]@96
  int v178; // [sp+94h] [bp-3Ch]@61
  __int64 v179; // [sp+98h] [bp-38h]@55
  unsigned int v180; // [sp+A0h] [bp-30h]@55

  v6 = a4;
  v7 = (__int64)a3;
  v8 = a2;
  v9 = (__int64)this;
  v10 = 0;
  v11 = 1;
  if ( (signed int)a2 <= 11 )
  {
    if ( (_DWORD)a2 == 4 )
      return v11 & (v10 == 0);
LABEL_44:
    if ( IO80211PeerManager::getPeerManagerLogFlags(this) & 0x400000010LL )
    {
      LODWORD(v62) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
      v39 = OSMetaClass::getClassName(v62);
      v40 = "%s::%s unknown event %u\n";
      v41 = (__int64)"reportDataPathEvents";
      v42 = 17179869200LL;
      v43 = v8;
LABEL_46:
      IO80211PeerManager::logDebug(this, v42, v40, v39, v41, v43);
    }
LABEL_47:
    v10 = 0;
    return v11 & (v10 == 0);
  }
  if ( (signed int)a2 <= 31 )
  {
    if ( (_DWORD)a2 == 12 )
    {
      LODWORD(v12) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
      v13 = v12;
      v14 = v9;
      v15 = OSMetaClass::getClassName(v12);
      LODWORD(v16) = current_thread(v13, a2);
      v17 = *(_BYTE *)(v7 + 5);
      v18 = *(_BYTE *)(v7 + 4);
      v19 = *(_BYTE *)(v7 + 3);
      v20 = *(_BYTE *)(v7 + 2);
      v21 = *(_BYTE *)(v7 + 1);
      IO80211PeerManager::logDebug(
        (IO80211PeerManager *)v14,
        "%s::%s APPLE80211_M_STA_ARRIVE thread=%p %02X:%02X:%02X:%02X:%02X:%02x\n",
        v15,
        (__int64)"reportDataPathEvents",
        v16,
        *(_BYTE *)v7);
      if ( (unsigned __int64)v6 >= 6 && v7 )
      {
        v22 = *(_QWORD *)(v14 + 656);
        if ( v22 )
        {
          IORecursiveLockLock(v22);
          ++*(_DWORD *)(v14 + 664);
        }
        (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v14 + 440LL))(v14, v7);
        v23 = *(_QWORD *)(v14 + 656);
        v10 = 0;
        if ( v23 )
        {
          v24 = *(_DWORD *)(v14 + 664);
          if ( v24 )
            *(_DWORD *)(v14 + 664) = v24 - 1;
          IORecursiveLockUnlock(v23, v7);
          goto LABEL_47;
        }
        return v11 & (v10 == 0);
      }
      LODWORD(v44) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v14 + 56LL))(
                       v14,
                       "%s::%s APPLE80211_M_STA_ARRIVE thread=%p %02X:%02X:%02X:%02X:%02X:%02x\n");
      v45 = OSMetaClass::getClassName(v44);
      v46 = "%s::%s APPLE80211_M_STA_ARRIVE short message %lu %p\n";
    }
    else
    {
      if ( (_DWORD)a2 != 13 )
        goto LABEL_44;
      LODWORD(v25) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
      v26 = v25;
      v14 = v9;
      v27 = OSMetaClass::getClassName(v25);
      LODWORD(v28) = current_thread(v26, a2);
      v29 = *(_BYTE *)(v7 + 5);
      v30 = *(_BYTE *)(v7 + 4);
      v31 = *(_BYTE *)(v7 + 3);
      v32 = *(_BYTE *)(v7 + 2);
      v33 = *(_BYTE *)(v7 + 1);
      IO80211PeerManager::logDebug(
        (IO80211PeerManager *)v14,
        "%s::%s APPLE80211_M_STA_LEAVE thread=%p %02X:%02X:%02X:%02X:%02X:%02x\n",
        v27,
        (__int64)"reportDataPathEvents",
        v28,
        *(_BYTE *)v7);
      if ( (unsigned __int64)v6 >= 6 && v7 )
      {
        (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v14 + 448LL))(v14, v7);
        goto LABEL_47;
      }
      LODWORD(v52) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v14 + 56LL))(
                       v14,
                       "%s::%s APPLE80211_M_STA_LEAVE thread=%p %02X:%02X:%02X:%02X:%02X:%02x\n");
      v45 = OSMetaClass::getClassName(v52);
      v46 = "%s::%s APPLE80211_M_STA_LEAVE shorts message %lu %p\n";
    }
    IO80211PeerManager::logDebug((IO80211PeerManager *)v14, v46, v45, (__int64)"reportDataPathEvents", v6, v7);
    goto LABEL_47;
  }
  if ( (signed int)a2 > 38 )
  {
    if ( (signed int)a2 > 48 )
    {
      switch ( (_DWORD)a2 )
      {
        case 0x31:
          LODWORD(v47) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
          v48 = OSMetaClass::getClassName(v47);
          v49 = (__int64)"complete";
          if ( !*(_DWORD *)v7 )
            v49 = (__int64)"in progress";
          v50 = (__int64)"true";
          if ( !*(_DWORD *)v7 )
            v50 = (__int64)"false";
          IO80211PeerManager::logDebug(
            this,
            "%s::%s APPLE80211_M_RESET_INTERFACE received, chip reset %s, opening datapath: %s\n",
            v48,
            (__int64)"reportDataPathEvents",
            v49,
            v50);
          if ( *(_DWORD *)v7 != 1 )
            goto LABEL_47;
          v51 = 1;
          goto LABEL_95;
        default:
          goto LABEL_44;
        case 0x32:
          v11 = 0;
          v10 = 0;
          if ( *((_QWORD *)this + 17) )
            return v11 & (v10 == 0);
          v11 = 0;
          v10 = 0;
          if ( !a3 )
            return v11 & (v10 == 0);
          if ( IO80211PeerManager::getPeerManagerLogFlags(this) & 0x10 )
          {
            v64 = (__int64)"open ";
            if ( *(_DWORD *)(v7 + 8) == 1 )
              v64 = (__int64)"close";
            v65 = *(_BYTE *)(v7 + 5);
            v66 = *(_BYTE *)(v7 + 4);
            v67 = *(_BYTE *)(v7 + 3);
            v68 = *(_BYTE *)(v7 + 2);
            v69 = *(_BYTE *)(v7 + 1);
            v70 = *(_BYTE *)v7;
            IO80211PeerManager::logDebug(
              this,
              16LL,
              " CREDIT_GRANT(%s) num %u type %u %02X:%02X:%02X:%02X:%02X:%02x ",
              v64,
              *(_DWORD *)(v7 + 12),
              *(_DWORD *)(v7 + 16));
          }
          v179 = v7;
          v180 = 0;
          v71 = *((_QWORD *)this + 82);
          if ( v71 )
          {
            IORecursiveLockLock(v71);
            ++*(_DWORD *)(v9 + 664);
          }
          v72 = IO80211CommandQueue::map(
                  *(_QWORD *)(v9 + 88),
                  (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_doPeerCredit,
                  v9,
                  (__int64)&v179,
                  0LL,
                  -1);
          v73 = v9;
          v74 = v72;
          v75 = v72 == 0;
          v76 = -536870160;
          if ( !v75 )
            v76 = 0;
          v171 = v76;
          v77 = v73 + 152;
          v78 = v73 + 152;
          OSBitOrAtomic(v180, v73 + 152);
          if ( IO80211PeerManager::getPeerManagerLogFlags((IO80211PeerManager *)v73) & 0x10 )
          {
            v80 = (IO80211PeerManager *)v73;
            if ( v74 )
            {
              v178 = 0;
              v81 = *(IO80211VirtualInterface **)(v73 + 128);
              if ( v81 )
              {
                v82 = IO80211VirtualInterface::getIfnet(v81);
                v78 = (signed __int64)&v178;
                ifnet_get_sndq_len(v82, &v178);
              }
              v83 = *(_QWORD *)(v73 + 136);
              if ( v83 )
              {
                LODWORD(v84) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v83 + 2408LL))(v83, v78);
                ifnet_get_sndq_len(v84, &v178);
              }
              v167 = *(_DWORD *)v77;
              v85 = *(_QWORD *)(v74 + 48);
              v86 = 0LL;
              if ( v85 )
                v86 = *(_DWORD *)(v85 + 52);
              v168 = (IO80211PeerManager *)(v73 + 152);
              v87 = *(_WORD *)(v74 + 82);
              v88 = *(_QWORD *)(v74 + 56);
              if ( v88 )
                v89 = *(_DWORD *)(v88 + 52);
              v90 = *(_WORD *)(v74 + 84);
              v91 = *(_QWORD *)(v74 + 64);
              if ( v91 )
                v92 = *(_DWORD *)(v91 + 52);
              v93 = *(_WORD *)(v74 + 86);
              v94 = *(_QWORD *)(v74 + 72);
              if ( v94 )
                v95 = *(_DWORD *)(v94 + 52);
              v96 = *(_DWORD *)(v74 + 108);
              v97 = *(_DWORD *)(v74 + 112);
              v98 = *(_DWORD *)(v74 + 104);
              v78 = 16LL;
              v73 = (__int64)v80;
              IO80211PeerManager::logDebug(
                v80,
                16LL,
                "-> x%x num h/q %u/%u %u/%u %u/%u %u/%u state %u credits %d/%d netQueue %u\n",
                v167,
                *(_WORD *)(v74 + 80),
                v86);
              v77 = (signed __int64)v168;
            }
            else
            {
              v78 = 16LL;
              IO80211PeerManager::logDebug(
                (IO80211PeerManager *)v73,
                16LL,
                "no peers %p x%x\n",
                *(_QWORD *)(v73 + 88),
                *(_DWORD *)(v73 + 152),
                v79);
            }
          }
          v157 = *(_QWORD *)(v73 + 656);
          if ( v157 )
          {
            v158 = *(_DWORD *)(v73 + 664);
            if ( v158 )
              *(_DWORD *)(v73 + 664) = v158 - 1;
            IORecursiveLockUnlock(v157, v78);
          }
          if ( !v74 && IO80211PeerManager::getPeerManagerLogFlags((IO80211PeerManager *)v73) & 0x10 )
          {
            LODWORD(v159) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v73 + 56LL))(v73, v78);
            v160 = OSMetaClass::getClassName(v159);
            v161 = *(_DWORD *)(v73 + 152);
            v162 = *(_BYTE *)(v7 + 5);
            v163 = *(_BYTE *)(v7 + 4);
            v164 = *(_BYTE *)(v7 + 3);
            v165 = *(_BYTE *)(v7 + 2);
            v166 = *(_BYTE *)(v7 + 1);
            IO80211PeerManager::logDebug(
              (IO80211PeerManager *)v73,
              16LL,
              "%s::%s APPLE80211_M_PEER_CREDIT_GRANT not found %02X:%02X:%02X:%02X:%02X:%02X bf x%x\n",
              v160,
              (__int64)"reportDataPathEvents",
              *(_BYTE *)v7);
          }
          if ( !*(_DWORD *)v77 )
            goto LABEL_142;
          v148 = "PeerCreditGrant";
          goto LABEL_140;
        case 0x33:
          v11 = 0;
          v10 = 0;
          if ( *((_QWORD *)this + 17) )
            return v11 & (v10 == 0);
          v173 = a3;
          v174 = 0;
          v99 = *((_QWORD *)this + 82);
          if ( v99 )
          {
            IORecursiveLockLock(v99);
            ++*(_DWORD *)(v9 + 664);
          }
          if ( *(_DWORD *)(v7 + 4) == 1 )
            (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v9 + 440LL))(v9, v7 + 8);
          v75 = IO80211CommandQueue::map(
                  *(_QWORD *)(v9 + 88),
                  (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_doCacheControl,
                  v9,
                  (__int64)&v173,
                  0LL,
                  -1) == 0;
          v100 = -536870160;
          if ( !v75 )
            v100 = 0;
          v171 = v100;
          v172 = 0;
          v101 = _countCachedPeers;
          IO80211CommandQueue::map(
            *(_QWORD *)(v9 + 88),
            (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_countCachedPeers,
            v9,
            (__int64)&v172,
            0LL,
            -1);
          v102 = *(_QWORD *)(v9 + 656);
          if ( v102 )
          {
            v103 = *(_DWORD *)(v9 + 664);
            if ( v103 )
              *(_DWORD *)(v9 + 664) = v103 - 1;
            IORecursiveLockUnlock(v102, _countCachedPeers);
          }
          v104 = *(_DWORD *)(v9 + 160);
          v105 = v9;
          if ( v104 )
          {
            v106 = v172;
            v169 = *(_DWORD *)(*(_QWORD *)(v105 + 88) + 52LL);
            LODWORD(v107) = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(__int64, __int64, __int64)))(*(_QWORD *)v105 + 56LL))(
                              v105,
                              _countCachedPeers);
            v108 = OSMetaClass::getClassName(v107);
            v109 = *(_DWORD *)(*(_QWORD *)(v105 + 88) + 52LL);
            v101 = 0;
            IO80211PeerManager::logDebug(
              (IO80211PeerManager *)v105,
              0x200000000LL,
              "%s::%s cached_peers(%d), numPeers(%u), cache_space(%s), uncached_peers(%s)\n",
              v108,
              (__int64)"reportDataPathEvents",
              v172);
            if ( v106 < v104 && v169 > v106 )
              IO80211PeerManager::checkForCacheablePeers((IO80211PeerManager *)v105);
          }
          LODWORD(v110) = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(__int64, __int64, __int64)))(*(_QWORD *)v105 + 56LL))(
                            v105,
                            v101);
          v111 = OSMetaClass::getClassName(v110);
          v150 = *(_BYTE *)(v7 + 10);
          v151 = *(_DWORD *)(*(_QWORD *)(v105 + 88) + 52LL);
          v152 = *(_BYTE *)(v7 + 13);
          v153 = *(_BYTE *)(v7 + 12);
          v154 = *(_BYTE *)(v7 + 11);
          v73 = v105;
          v155 = *(_BYTE *)(v7 + 9);
          v156 = *(_BYTE *)(v7 + 8);
          v11 = 0;
          IO80211PeerManager::logDebug(
            (IO80211PeerManager *)v73,
            8598323200LL,
            "%s::%s APPLE80211_M_PEER_CACHE_CONTROL opcode %u %s %02X:%02X:%02X:%02X:%02X:%02X numCached %u numPeers %u\n",
            v111,
            (__int64)"reportDataPathEvents",
            *(_DWORD *)(v7 + 4));
          if ( !v174 )
            goto LABEL_143;
          OSBitOrAtomic(v174, v73 + 152);
          v148 = "CacheControl";
LABEL_140:
          v149 = (IO80211PeerManager *)v73;
          goto LABEL_141;
        case 0x3A:
          v112 = 1;
          if ( *((_BYTE *)this + 156) )
            v112 = *(_DWORD *)a3;
          v113 = (__int64)"open ";
          if ( !v112 )
            v113 = (__int64)"close";
          v114 = v112 != 0;
          v11 = 0;
          IO80211PeerManager::logDebug(this, 16LL, " IFACE_STATE(%s)\n", v113, a5, a6);
          v51 = v114;
LABEL_95:
          IO80211PeerManager::setDataPathState(this, v51);
          break;
      }
      goto LABEL_47;
    }
    if ( (_DWORD)a2 == 39 )
    {
      v34 = 0;
      if ( a3 )
      {
        v34 = *((_DWORD *)a3 + 1);
        v35 = *((_WORD *)a3 + 5);
        v36 = *((_WORD *)a3 + 7);
      }
      v37 = v34;
      if ( !(IO80211PeerManager::getPeerManagerLogFlags(this) & 0x10) )
        goto LABEL_47;
      LODWORD(v38) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
      v39 = OSMetaClass::getClassName(v38);
      v40 = "%s::%s APPLE80211_M_RSSI_CHANGED RSSI %d noise %d snr %d\n";
      v41 = (__int64)"reportDataPathEvents";
      v42 = 16LL;
      v43 = v37;
      goto LABEL_46;
    }
    if ( (_DWORD)a2 != 40 )
      goto LABEL_44;
    if ( IO80211PeerManager::getPeerManagerLogFlags(this) & 0x10 )
    {
      v57 = (__int64)"open ";
      if ( *(_DWORD *)(v7 + 8) == 1 )
        v57 = (__int64)"close";
      v58 = *(_BYTE *)(v7 + 5);
      v59 = *(_BYTE *)(v7 + 4);
      v60 = *(_BYTE *)(v7 + 3);
      v61 = *(_BYTE *)(v7 + 2);
      IO80211PeerManager::logDebug(
        this,
        16LL,
        " PEER_STATE(%s) %02X:%02X:%02X:%02X:%02X:%02X \n",
        v57,
        *(_BYTE *)v7,
        *(_BYTE *)(v7 + 1));
    }
    if ( *((_QWORD *)this + 17) )
    {
      v11 = 0;
      IO80211PeerManager::logDebug(
        this,
        "Unexpected APPLE80211_M_PEER_STATE event on infra! Ignoring\n",
        v53,
        v54,
        v55,
        v56);
      goto LABEL_47;
    }
    v176 = v7;
    v177 = 0;
    v115 = *((_QWORD *)this + 82);
    if ( v115 )
    {
      IORecursiveLockLock(v115);
      ++*(_DWORD *)(v9 + 664);
    }
    v116 = *(_QWORD *)(v9 + 80);
    if ( v116 )
    {
      v117 = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v116 + 392LL))(
               *(_QWORD *)(v9 + 80),
               *(_DWORD *)(v7 + 8));
      v118 = (unsigned int)v117;
      v177 = v117;
      v171 = 0;
    }
    else
    {
      v119 = IO80211CommandQueue::map(
               *(_QWORD *)(v9 + 88),
               (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_setPeerState,
               v9,
               (__int64)&v176,
               0LL,
               -1);
      v116 = v119;
      v75 = v119 == 0;
      v120 = -536870160;
      if ( !v75 )
        v120 = 0;
      v171 = v120;
      v118 = v177;
    }
    v121 = (__int64 *)(v9 + 152);
    v122 = v9 + 152;
    OSBitOrAtomic(v118, v9 + 152);
    if ( IO80211PeerManager::getPeerManagerLogFlags((IO80211PeerManager *)v9) & 0x10 )
    {
      if ( v116 )
      {
        v175 = 0;
        v124 = *(IO80211VirtualInterface **)(v9 + 128);
        if ( v124 )
        {
          v125 = IO80211VirtualInterface::getIfnet(v124);
          v122 = (signed __int64)&v175;
          ifnet_get_sndq_len(v125, &v175);
        }
        v126 = *(_QWORD *)(v9 + 136);
        v170 = (IO80211PeerManager *)v9;
        if ( v126 )
        {
          LODWORD(v127) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v126 + 2408LL))(v126, v122);
          ifnet_get_sndq_len(v127, &v175);
        }
        v128 = *(_QWORD *)(v116 + 48);
        v129 = 0LL;
        if ( v128 )
          v129 = *(_DWORD *)(v128 + 52);
        v130 = *(_WORD *)(v116 + 82);
        v131 = *(_QWORD *)(v116 + 56);
        if ( v131 )
          v132 = *(_DWORD *)(v131 + 52);
        v133 = *(_WORD *)(v116 + 84);
        v134 = *(_QWORD *)(v116 + 64);
        if ( v134 )
          v135 = *(_DWORD *)(v134 + 52);
        v136 = *(_WORD *)(v116 + 86);
        v137 = *(_QWORD *)(v116 + 72);
        if ( v137 )
          v138 = *(_DWORD *)(v137 + 52);
        v139 = *(_DWORD *)(v116 + 108);
        v140 = *(_DWORD *)(v116 + 112);
        v141 = *(_DWORD *)(v116 + 104);
        v122 = 16LL;
        v9 = (__int64)v170;
        IO80211PeerManager::logDebug(
          v170,
          16LL,
          "-> x%x num h/q %u/%u %u/%u %u/%u %u/%u state %u credits %d/%d netStack %u\n",
          *(_DWORD *)v121,
          *(_WORD *)(v116 + 80),
          v129);
      }
      else
      {
        v122 = 16LL;
        IO80211PeerManager::logDebug(
          (IO80211PeerManager *)v9,
          16LL,
          "no peers %p x%x\n",
          *(_QWORD *)(v9 + 88),
          *(_DWORD *)(v9 + 152),
          v123);
      }
    }
    v142 = *(_QWORD *)(v9 + 656);
    if ( v142 )
    {
      v143 = *(_DWORD *)(v9 + 664);
      if ( v143 )
        *(_DWORD *)(v9 + 664) = v143 - 1;
      IORecursiveLockUnlock(v142, v122);
    }
    if ( v171 && IO80211PeerManager::getPeerManagerLogFlags((IO80211PeerManager *)v9) & 0x10 )
    {
      v144 = *(_BYTE *)(v7 + 3);
      v145 = *(_BYTE *)(v7 + 4);
      v146 = *(_BYTE *)(v7 + 5);
      *(_DWORD *)(v7 + 8);
      v147 = *(_DWORD *)(v9 + 152);
      IO80211PeerManager::logDebug(
        (IO80211PeerManager *)v9,
        16LL,
        " APPLE80211_M_PEER_STATE not found %02X:%02X:%02X:%02X:%02X:%02X state %s bf x%x\n",
        *(_BYTE *)v7,
        *(_BYTE *)(v7 + 1),
        *(_BYTE *)(v7 + 2));
    }
    if ( *(_DWORD *)v121 )
    {
      v148 = "PeerState";
      v149 = (IO80211PeerManager *)v9;
LABEL_141:
      IO80211PeerManager::requestTxPacket(v149, v148);
    }
LABEL_142:
    v11 = 0;
LABEL_143:
    v10 = v171;
  }
  else if ( (_DWORD)a2 != 32 )
  {
    goto LABEL_44;
  }
  return v11 & (v10 == 0);
}
// C7758: using guessed type int __cdecl IORecursiveLockLock(_QWORD);
// C7760: using guessed type int __fastcall IORecursiveLockUnlock(_QWORD, _QWORD);
// C77B0: using guessed type int __fastcall OSBitOrAtomic(_QWORD, _QWORD);
// C8A50: using guessed type int __fastcall current_thread(_QWORD, _QWORD);
// C8B00: using guessed type int __fastcall ifnet_get_sndq_len(_QWORD, _QWORD);

//----- (000000000004805C) ----------------------------------------------------
int __fastcall IO80211PeerManager::setDataPathState(IO80211PeerManager *this, char a2)
{
  int result; // eax@1
  __int64 v3; // r9@1
  __int64 v4; // rcx@3

  *((_BYTE *)this + 560) = a2;
  result = IO80211PeerManager::getPeerManagerLogFlags(this);
  if ( result & 0x10 && *((_BYTE *)this + 680) & 0x10 )
  {
    v4 = (__int64)"Close";
    if ( a2 )
      v4 = (__int64)"Open";
    result = IO80211PeerManager::logDebug(
               this,
               16LL,
               "  set Datapath %s needsTrigger %u\n",
               v4,
               *((_BYTE *)this + 561),
               v3);
  }
  if ( *((_BYTE *)this + 560) )
    result = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 80) + 464LL))(*((_QWORD *)this + 80), 0LL);
  return result;
}

//----- (00000000000480DC) ----------------------------------------------------
signed __int64 __fastcall _doPeerCredit(__int64 a1, __int64 a2, const void **a3)
{
  const void **v3; // rbx@1
  int v4; // ecx@1
  signed __int64 result; // rax@1

  v3 = a3;
  v4 = memcmp((const void *)(a2 + 32), *a3, 6uLL);
  result = 0LL;
  if ( !v4 )
  {
    *((_DWORD *)v3 + 2) = IO80211Peer::doCreditGrant((IO80211Peer *)a2, (__int64)*v3);
    result = 17LL;
  }
  return result;
}

//----- (000000000004811A) ----------------------------------------------------
int __fastcall IO80211PeerManager::requestTxPacket(IO80211PeerManager *this, const char *a2)
{
  IO80211PeerManager *v2; // rbx@1
  __int64 v3; // rax@2
  __int64 v4; // rax@3
  unsigned __int64 v5; // r12@3
  IO80211VirtualInterface *v6; // rdi@3
  char *v7; // rax@4
  OSMetaClass *v8; // rax@5
  __int64 v9; // rax@5
  __int64 v10; // r9@5
  signed __int64 v11; // r12@6
  IO80211Interface *v12; // rdi@7
  __int64 v13; // r9@9
  __int64 v14; // rcx@10
  __int64 v15; // r8@10
  int v16; // eax@10
  unsigned int v17; // er14@11
  __int64 v18; // rax@12
  __int64 v19; // rsi@12

  v2 = this;
  if ( !*((_BYTE *)this + 652) )
  {
    LODWORD(v8) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
    v9 = OSMetaClass::getClassName(v8);
    LODWORD(v3) = IO80211PeerManager::logDebug(
                    this,
                    0x400000000LL,
                    "%s::%s no enabled",
                    v9,
                    (__int64)"requestTxPacket",
                    v10);
    return v3;
  }
  *((_BYTE *)this + 561) = 0;
  v3 = IO80211PeerManager::getPeerManagerLogFlags(this);
  if ( !(v3 & 0x400000000LL) )
  {
    v11 = (signed __int64)((char *)this + 152);
    goto LABEL_11;
  }
  v4 = getAbsoluteTime();
  v5 = v4;
  v6 = (IO80211VirtualInterface *)*((_QWORD *)this + 16);
  if ( v6 )
  {
    v7 = IO80211VirtualInterface::getBSDName(v6);
  }
  else
  {
    v12 = (IO80211Interface *)*((_QWORD *)v2 + 17);
    if ( !v12 )
    {
      v13 = (__int64)"?";
      goto LABEL_10;
    }
    v7 = IO80211Interface::getBSDName(v12, v4);
  }
  v13 = (__int64)v7;
LABEL_10:
  v14 = 19342813113834067LL * (v5 >> 9) >> 64 >> 11;
  v15 = 2361183241434822607LL * ((v5 - 1000000000 * v14) >> 3) >> 64 >> 4;
  v11 = (signed __int64)((char *)v2 + 152);
  v16 = *((_DWORD *)v2 + 38);
  LODWORD(v3) = IO80211PeerManager::logDebug(v2, 0x400000000LL, "%llu.%06llu <%s> reqTx %x src %s\n", v14, v15, v13);
LABEL_11:
  v17 = *(_DWORD *)v11;
  if ( *(_DWORD *)v11 )
  {
    v18 = IO80211PeerManager::getController(v2);
    v19 = *((_QWORD *)v2 + 16);
    if ( !v19 )
      v19 = *((_QWORD *)v2 + 17);
    LODWORD(v3) = (*(int (__fastcall **)(__int64, __int64, _QWORD))(*(_QWORD *)v18 + 3152LL))(v18, v19, v17);
  }
  return v3;
}

//----- (00000000000482A2) ----------------------------------------------------
signed __int64 __fastcall _setPeerState(__int64 a1, __int64 a2, const void **a3)
{
  const void **v3; // r14@1
  int v4; // ecx@1
  signed __int64 result; // rax@1

  v3 = a3;
  v4 = memcmp((const void *)(a2 + 32), *a3, 6uLL);
  result = 0LL;
  if ( !v4 )
  {
    *((_DWORD *)v3 + 2) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a2 + 392LL))(a2, *((_DWORD *)*v3 + 2));
    result = 1LL;
    if ( !*((_DWORD *)*v3 + 2) )
      result = 17LL;
  }
  return result;
}

//----- (00000000000482F7) ----------------------------------------------------
signed __int64 __fastcall _doCacheControl(__int64 a1, __int64 a2, __int64 *a3)
{
  __int64 *v3; // r14@1
  __int64 v4; // rbx@1
  int v5; // ecx@1
  signed __int64 result; // rax@1

  v3 = a3;
  v4 = *a3;
  v5 = memcmp((const void *)(a2 + 32), (const void *)(*a3 + 8), 6uLL);
  result = 0LL;
  if ( !v5 )
  {
    *((_DWORD *)v3 + 2) = IO80211Peer::doCacheControl((IO80211Peer *)a2, v4);
    result = 1LL;
    if ( *(_DWORD *)(v4 + 4) == 1 )
      result = 17LL;
  }
  return result;
}

//----- (0000000000048350) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::captureInfraPacket(IO80211PeerManager *this, __mbuf **a2)
{
  return 0LL;
}

//----- (0000000000048358) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::dequeueStackOutputPackets(IO80211PeerManager *this, signed int a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // r15@1
  signed __int64 v5; // rax@1
  __int64 v6; // rax@8
  int v7; // ecx@9
  int v8; // er13@11
  __int64 v9; // rdi@13
  int v10; // er12@13
  __int64 v11; // rdi@15
  unsigned int v12; // ecx@17
  __int64 result; // rax@21
  __mbuf *v14; // rbx@24
  unsigned int v15; // er12@25
  __mbuf *v16; // rax@26
  __mbuf *v17; // r13@26
  signed __int64 v18; // rsi@26
  int v19; // eax@27
  OSMetaClass *v20; // rax@38
  __int64 v21; // rax@38
  __int64 v22; // r9@38
  OSMetaClass *v23; // rax@39
  __int64 v24; // rax@39
  __int64 v25; // r8@39
  __int64 v26; // r9@39
  char v27; // [sp+8h] [bp-98h]@27
  int v28; // [sp+Ch] [bp-94h]@27
  int v29; // [sp+10h] [bp-90h]@27
  __mbuf *v30; // [sp+18h] [bp-88h]@27
  int v31; // [sp+20h] [bp-80h]@27
  int v32; // [sp+24h] [bp-7Ch]@27
  __int64 v33; // [sp+28h] [bp-78h]@27
  __int64 v34; // [sp+30h] [bp-70h]@27
  __int64 v35; // [sp+38h] [bp-68h]@27
  __int64 v36; // [sp+40h] [bp-60h]@27
  __int64 v37; // [sp+48h] [bp-58h]@27
  __int64 v38; // [sp+50h] [bp-50h]@27
  __int64 v39; // [sp+58h] [bp-48h]@27
  __int64 v40; // [sp+60h] [bp-40h]@27
  unsigned int v41; // [sp+6Ch] [bp-34h]@14
  __mbuf *v42; // [sp+70h] [bp-30h]@14

  v3 = a3;
  v4 = (__int64)this;
  v5 = 3LL;
  if ( a2 <= 199 )
  {
LABEL_2:
    v5 = 0LL;
    goto LABEL_8;
  }
  if ( a2 == 200 )
  {
    v5 = 1LL;
    goto LABEL_8;
  }
  if ( a2 != 800 )
  {
    if ( a2 == 700 )
    {
      v5 = 2LL;
      goto LABEL_8;
    }
    goto LABEL_2;
  }
LABEL_8:
  v6 = *((_QWORD *)this + v5 + 4);
  if ( !v6 )
    goto LABEL_40;
  v7 = *(_DWORD *)(v6 + 48) - *((_DWORD *)this + 105);
  if ( v7 < 0 )
    v7 = 0;
  v8 = *(_DWORD *)(v6 + 52) - v7;
  if ( v8 < 0 || *(_DWORD *)(v6 + 52) == v7 )
  {
LABEL_40:
    *(_BYTE *)(v4 + 216) = 1;
    return 3758097086LL;
  }
  v9 = *((_QWORD *)this + 17);
  v10 = 0;
  if ( v9 )
    v10 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, __mbuf **, _QWORD, int *))(*(_QWORD *)v9 + 2536LL))(
            v9,
            (unsigned int)v8,
            (unsigned int)a2,
            &v42,
            0LL,
            &v41);
  v11 = *(_QWORD *)(v4 + 128);
  if ( v11 )
    v10 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, __mbuf **, _QWORD, int *))(*(_QWORD *)v11 + 2152LL))(
            v11,
            (unsigned int)v8,
            (unsigned int)a2,
            &v42,
            0LL,
            &v41);
  v12 = v41;
  if ( v3 )
    *(_DWORD *)v3 = v41;
  if ( v12 == v8 )
    *(_BYTE *)(v4 + 216) = 1;
  result = 0LL;
  if ( v10 != -536870176 )
  {
    if ( v10 )
    {
      result = 3758097086LL;
      if ( v10 != -536870210 )
      {
        LODWORD(v20) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v4 + 56LL))(v4);
        v21 = OSMetaClass::getClassName(v20);
        IO80211PeerManager::logDebug(
          (IO80211PeerManager *)v4,
          "%s::%s dequeueOutputPacketsWithServiceClass returns %x \n",
          v21,
          (__int64)"dequeueStackOutputPackets",
          (unsigned int)v10,
          v22);
        result = (unsigned int)v10;
      }
    }
    else if ( v12 )
    {
      v14 = v42;
      if ( v42 )
      {
        v15 = 1;
        while ( 1 )
        {
          LODWORD(v16) = mbuf_nextpkt(v14);
          v17 = v16;
          v18 = 0LL;
          mbuf_setnextpkt(v14, 0LL);
          if ( IO80211PeerManager::getPeerManagerLogFlags((IO80211PeerManager *)v4) & 0x200000000000LL )
          {
            v27 = 1;
            v28 = 0;
            v29 = 0;
            v30 = v14;
            v31 = 0;
            v32 = 0;
            v40 = 0LL;
            v39 = 0LL;
            v38 = 0LL;
            v37 = 0LL;
            v36 = 0LL;
            v35 = 0LL;
            v34 = 0LL;
            v33 = 0LL;
            v19 = 0;
            if ( v4 )
            {
              if ( *(_QWORD *)(v4 + 680) & 0x200000000000LL )
              {
                v19 = *(_DWORD *)(v4 + 432);
              }
              else
              {
                v19 = *(_DWORD *)(v4 + 424);
                if ( !*(_DWORD *)(v4 + 424) )
                {
                  v18 = (signed __int64)v14;
                  v19 = getLengthBeforeSensitivePayload(0, v14);
                }
              }
            }
            v28 = v19;
            IO80211PeerManager::dumpPacket(v4, v18, "Net ", (__int64)&v27);
          }
          if ( (*(int (__fastcall **)(__int64, __mbuf *))(*(_QWORD *)v4 + 464LL))(v4, v14) )
            break;
          result = 0LL;
          if ( v15 < v41 )
          {
            ++v15;
            v14 = v17;
            if ( v17 )
              continue;
          }
          return result;
        }
        ++*(_DWORD *)(v4 + 964);
        LODWORD(v23) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v4 + 56LL))(v4);
        v24 = OSMetaClass::getClassName(v23);
        IO80211PeerManager::logDebug(
          (IO80211PeerManager *)v4,
          "%s::%s cannot queue packet\n",
          v24,
          (__int64)"dequeueStackOutputPackets",
          v25,
          v26);
        goto LABEL_40;
      }
    }
  }
  return result;
}
// C8C60: using guessed type int __fastcall mbuf_nextpkt(_QWORD);
// C8CC0: using guessed type int __fastcall mbuf_setnextpkt(_QWORD, _QWORD);

//----- (0000000000048646) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::getMulticastPackets(__int64 a1, __int64 a2)
{
  unsigned int v2; // ecx@1
  unsigned int v3; // eax@1
  int v4; // ebx@3
  __int64 v5; // rbx@6
  __int64 v6; // rax@8
  __int64 v7; // rax@9
  __int64 v9; // [sp+8h] [bp-48h]@4
  __int64 v10; // [sp+10h] [bp-40h]@4
  int v11; // [sp+18h] [bp-38h]@4
  int v12; // [sp+1Ch] [bp-34h]@4
  int v13; // [sp+20h] [bp-30h]@4
  int v14; // [sp+24h] [bp-2Ch]@4
  int v15; // [sp+28h] [bp-28h]@4
  int v16; // [sp+2Ch] [bp-24h]@4
  int v17; // [sp+30h] [bp-20h]@4

  v2 = *(_WORD *)(a2 + 6);
  v3 = *(_WORD *)(a2 + 2);
  if ( v2 <= v3 )
    LOWORD(v3) = *(_WORD *)(a2 + 6);
  v4 = 0;
  if ( (_WORD)v3 )
  {
    v9 = 0LL;
    v10 = 0LL;
    v11 = 0;
    v12 = 0;
    v13 = (unsigned __int16)v3;
    v14 = 0;
    v15 = *(_DWORD *)(a1 + 988);
    v16 = 0;
    v17 = 0;
    if ( *(_DWORD *)(a1 + 152) & 0x10 )
    {
      (*(void (__fastcall **)(_QWORD, __int64 *))(**(_QWORD **)(a1 + 72) + 368LL))(*(_QWORD *)(a1 + 72), &v9);
      if ( v9 )
      {
        v5 = *(_QWORD *)(a2 + 24);
        if ( v5 )
        {
          while ( 1 )
          {
            LODWORD(v7) = mbuf_nextpkt(v5);
            if ( !v7 )
              break;
            LODWORD(v6) = mbuf_nextpkt(v5);
            v5 = v6;
          }
          mbuf_setnextpkt(v5, v9);
        }
        else
        {
          *(_QWORD *)(a2 + 24) = v9;
        }
        v4 = v17;
        *(_DWORD *)(a1 + 808) += v17;
        *(_WORD *)(a2 + 2) -= v4;
        *(_WORD *)(a2 + 6) -= v4;
      }
      else
      {
        OSBitAndAtomic(4294967279LL, a1 + 152);
        v4 = 0;
        (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD))(**(_QWORD **)(a1 + 72) + 376LL))(
          *(_QWORD *)(a1 + 72),
          (unsigned __int8)v11,
          0LL);
      }
    }
  }
  return (unsigned int)v4;
}
// C77A8: using guessed type int __fastcall OSBitAndAtomic(_QWORD, _QWORD);
// C8C60: using guessed type int __fastcall mbuf_nextpkt(_QWORD);
// C8CC0: using guessed type int __fastcall mbuf_setnextpkt(_QWORD, _QWORD);

//----- (000000000004876A) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::getUnicastPackets(IO80211PeerManager *this, __int64 a2, int a3)
{
  int v3; // er15@1
  __int64 v4; // r14@1
  __int64 v5; // rbx@1
  __int64 v6; // rsi@1
  unsigned int v7; // eax@1
  unsigned int v8; // ecx@1
  unsigned int v9; // edx@3
  unsigned __int16 v10; // ax@3
  int v11; // er12@5
  __int64 v12; // rdx@6
  char *v13; // rcx@7
  unsigned int v14; // eax@7
  __int64 v15; // rdi@10
  __int64 (__fastcall *v16)(IO80211PeerManager *, __int64, __int64); // rsi@11
  __int64 v17; // rdi@13
  __int64 v18; // r13@14
  __int64 v19; // rax@15
  __int64 v20; // rbx@15
  OSMetaClass *v21; // rax@15
  __int64 v22; // ST68_8@15
  int v23; // ST48_4@15
  int v24; // ST40_4@15
  int v25; // ST38_4@15
  int v26; // ST30_4@15
  int v27; // ST28_4@15
  int v28; // ST20_4@15
  __int64 v29; // rbx@16
  __int64 v30; // rax@18
  __int64 v31; // rax@19
  __int64 v32; // rdi@24
  char *v34; // [sp+68h] [bp-68h]@10
  __int64 v35; // [sp+70h] [bp-60h]@10
  __int64 v36; // [sp+78h] [bp-58h]@7
  __int64 v37; // [sp+80h] [bp-50h]@7
  int v38; // [sp+88h] [bp-48h]@7
  int v39; // [sp+8Ch] [bp-44h]@7
  int v40; // [sp+90h] [bp-40h]@7
  int v41; // [sp+94h] [bp-3Ch]@7
  int v42; // [sp+98h] [bp-38h]@7
  int v43; // [sp+9Ch] [bp-34h]@7
  int v44; // [sp+A0h] [bp-30h]@7

  v3 = a3;
  v4 = a2;
  v5 = (__int64)this;
  v6 = (unsigned int)a3;
  v7 = *(_WORD *)(v4 + 2LL * (unsigned int)a3 + 8);
  v8 = *(_WORD *)(v4 + 4);
  if ( v7 <= v8 )
    LOWORD(v8) = *(_WORD *)(v4 + 2LL * (unsigned int)a3 + 8);
  v9 = *(_WORD *)(v4 + 2);
  v10 = v8;
  if ( (unsigned __int16)v8 > v9 )
    v10 = *(_WORD *)(v4 + 2);
  v11 = 0;
  if ( v10 )
  {
    v12 = *((_DWORD *)this + 38);
    if ( _bittest((const unsigned int *)&v12, v3) )
    {
      v13 = (char *)this + 152;
      v36 = 0LL;
      v37 = 0LL;
      v38 = v3;
      v39 = 0;
      v40 = v10;
      v41 = 0;
      v42 = *((_DWORD *)this + 247);
      v43 = 0;
      v44 = 0;
      v14 = *(_WORD *)(v4 + 2 * v6 + 8);
      if ( v14 < 2 )
      {
        if ( !(_WORD)v14 )
          return (unsigned int)v11;
      }
      else
      {
        ++*((_DWORD *)this + 112);
      }
      v34 = (char *)this + 152;
      v35 = v6;
      v15 = *((_QWORD *)this + 10);
      if ( v15 )
      {
        v16 = (__int64 (__fastcall *)(IO80211PeerManager *, __int64, __int64))&v36;
        (*(void (__fastcall **)(__int64, __int64 *, __int64, char *))(*(_QWORD *)v15 + 368LL))(v15, &v36, v12, v13);
      }
      else
      {
        v16 = _getPacket;
        IO80211CommandQueue::map(
          *(_QWORD *)(v5 + 88),
          (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_getPacket,
          v5,
          (__int64)&v36,
          0LL,
          -1);
      }
      v17 = v36;
      *(_DWORD *)(v5 + 832) += v43;
      if ( v17 )
      {
        v18 = v5;
        if ( mbuf_get_traffic_class(v17) != v3 )
        {
          LODWORD(v19) = mbuf_data(v17);
          v20 = v19;
          LODWORD(v21) = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IO80211PeerManager *, __int64, __int64)))(*(_QWORD *)v18 + 56LL))(
                           v18,
                           v16);
          v22 = OSMetaClass::getClassName(v21);
          mbuf_get_traffic_class(v17);
          mbuf_data(v17);
          mbuf_len(v17);
          v23 = *(_BYTE *)(v20 + 5);
          v24 = *(_BYTE *)(v20 + 4);
          v25 = *(_BYTE *)(v20 + 3);
          v26 = *(_BYTE *)(v20 + 2);
          v27 = *(_BYTE *)(v20 + 1);
          v28 = *(_BYTE *)v20;
          IO80211PeerManager::logDebug(
            (IO80211PeerManager *)v18,
            16LL,
            "%s::%s got unicast with wrong ac !! %u/%u m=%p data=%p len=%lu %02x:%02x:%02x:%02x:%02x:%02x\n",
            v22,
            (__int64)"getUnicastPackets",
            (unsigned int)v3);
        }
        v29 = *(_QWORD *)(v4 + 8 * v35 + 24);
        if ( v29 )
        {
          while ( 1 )
          {
            LODWORD(v31) = mbuf_nextpkt(v29);
            if ( !v31 )
              break;
            LODWORD(v30) = mbuf_nextpkt(v29);
            v29 = v30;
          }
          mbuf_setnextpkt(v29, v17);
        }
        else
        {
          *(_QWORD *)(v4 + 8 * v35 + 24) = v17;
        }
        v11 = v44;
        *(_DWORD *)(v18 + 812) += v44;
        *(_DWORD *)(v18 + 4 * v35 + 816) += v11;
        *(_WORD *)(v4 + 2) -= v11;
        *(_WORD *)(v4 + 4) -= v11;
        *(_WORD *)(v4 + 2 * v35 + 8) -= v11;
      }
      else
      {
        OSBitAndAtomic((unsigned int)~(1 << v3), v34);
        if ( *(_QWORD *)(v5 + 80) )
          (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD))(**(_QWORD **)(v5 + 72) + 376LL))(
            *(_QWORD *)(v5 + 72),
            (unsigned __int8)v3,
            0LL);
        v32 = *(_QWORD *)(v5 + 88);
        if ( v32 )
        {
          v11 = 0;
          IO80211CommandQueue::map(
            v32,
            (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_updateNumHostPackets,
            v5,
            (__int64)&v36,
            0LL,
            -1);
        }
      }
    }
  }
  return (unsigned int)v11;
}
// C77A8: using guessed type int __fastcall OSBitAndAtomic(_QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C30: using guessed type int __fastcall mbuf_get_traffic_class(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C60: using guessed type int __fastcall mbuf_nextpkt(_QWORD);
// C8CC0: using guessed type int __fastcall mbuf_setnextpkt(_QWORD, _QWORD);

//----- (0000000000048A24) ----------------------------------------------------
__int64 __fastcall _getPacket(IO80211PeerManager *this, __int64 a2, __int64 a3)
{
  __int64 v3; // r15@1
  __int64 v4; // rbx@1
  IO80211PeerManager *v5; // r14@1
  __int64 v6; // rax@1
  __int64 v7; // rdi@1
  __int64 v8; // rsi@1
  int v9; // er12@1
  __int64 v10; // r13@2
  __int64 v11; // rax@2
  __int64 v12; // r8@2
  int v13; // edx@3
  __int64 v14; // rcx@3
  __int64 v15; // ST38_8@4
  int v16; // ST28_4@4
  int v17; // ST20_4@4
  int v18; // ST18_4@4
  int v19; // ST10_4@4
  int v20; // ST08_4@4
  int v21; // ST00_4@4
  int v22; // ecx@5
  __int64 result; // rax@5
  int v24; // ecx@6
  int v25; // edx@6

  v3 = a3;
  v4 = a2;
  v5 = this;
  *(_DWORD *)(a3 + 20) = 0;
  v6 = *(_QWORD *)a2;
  v7 = a2;
  v8 = a3;
  v9 = (*(int (__fastcall **)(__int64, __int64))(v6 + 368))(v7, a3);
  if ( v9 < 0 )
  {
    v10 = *(_DWORD *)(v3 + 16);
    LODWORD(v11) = current_thread(v7, v8);
    v12 = *(_QWORD *)(v4 + 8 * v10 + 48);
    if ( v12 )
    {
      v13 = *(_DWORD *)(v12 + 52);
      v14 = *(_QWORD *)(v4 + 8 * v10 + 48);
    }
    v15 = *(_QWORD *)v3;
    v16 = *(_BYTE *)(v4 + 37);
    v17 = *(_BYTE *)(v4 + 36);
    v18 = *(_BYTE *)(v4 + 35);
    v19 = *(_BYTE *)(v4 + 34);
    v20 = *(_BYTE *)(v4 + 33);
    v21 = *(_BYTE *)(v4 + 32);
    IO80211PeerManager::logDebug(
      v5,
      "%s fail %d <%p> peer %p %02X:%02X:%02X:%02X:%02X:%02X size %u got %p ac %u q %p\n",
      (__int64)"_getPacket",
      (unsigned int)v9,
      v11,
      v4);
  }
  v22 = *(_DWORD *)(v3 + 20);
  result = 0LL;
  if ( v22 )
  {
    *(_DWORD *)(v3 + 24) -= v22;
    v24 = *(_DWORD *)(v4 + 228) + v22;
    *(_DWORD *)(v4 + 228) = v24;
    result = 0LL;
    v25 = 0;
    if ( !(*(_BYTE *)(v4 + 32) & 1) )
    {
      v25 = 1;
      if ( !*((_QWORD *)v5 + 17) )
      {
        v25 = 1;
        if ( (*(_BYTE *)(v4 + 37) & 0xF) != 15 )
          v25 = (*(_BYTE *)(v4 + 37) + 1) & 0xF;
      }
    }
    *((_DWORD *)v5 + 132) = v25;
    if ( *((_DWORD *)v5 + 131) - 1 < (unsigned int)v24 )
    {
      *(_DWORD *)(v4 + 228) = 0;
      result = 32LL;
    }
  }
  return result;
}
// C8A50: using guessed type int __fastcall current_thread(_QWORD, _QWORD);

//----- (0000000000048B7C) ----------------------------------------------------
__int64 __fastcall _updateNumHostPackets(__int64 a1, __int64 a2, __int64 a3)
{
  (*(void (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)a2 + 376LL))(a2, *(_BYTE *)(a3 + 16), 0LL);
  return 0LL;
}

//----- (0000000000048B98) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::dequeueTxPacket(IO80211PeerManager *this, signed __int64 a2)
{
  __int64 v2; // r13@1
  __int64 v3; // r14@1
  signed __int64 v4; // rax@1
  __int64 v5; // rdi@3
  unsigned __int64 v6; // rax@7
  __int64 v7; // r12@7
  __int64 v8; // r15@7
  __int64 v9; // rax@7
  int v10; // eax@7
  int v11; // er9@7
  int v12; // er10@7
  int v13; // er11@7
  int v14; // er8@7
  int v15; // edx@7
  int v16; // esi@7
  __int64 v17; // rcx@7
  int v18; // edi@8
  signed __int64 v19; // rbx@9
  int v20; // ST48_4@9
  signed int v21; // er15@10
  unsigned int v22; // eax@15
  int v23; // ecx@15
  int v24; // edx@15
  signed __int64 i; // rbx@15
  __int64 v26; // rdi@21
  int v27; // eax@22
  unsigned __int64 v28; // rax@26
  __int64 v29; // rbx@26
  __int64 v30; // r12@26
  __int64 v31; // rax@26
  __int64 v32; // rbx@27
  __int64 v33; // rdi@28
  __int64 v34; // rax@31
  __int64 result; // rax@33
  __int64 v36; // [sp+58h] [bp-48h]@7
  signed __int64 v37; // [sp+58h] [bp-48h]@15
  int v38; // [sp+60h] [bp-40h]@15
  int v39; // [sp+64h] [bp-3Ch]@15
  unsigned int v40; // [sp+68h] [bp-38h]@15
  int v41; // [sp+6Ch] [bp-34h]@15
  __int64 v42; // [sp+70h] [bp-30h]@1

  v2 = a2;
  v3 = (__int64)this;
  v42 = *(_QWORD *)off_7B078[0];
  v4 = 3LL;
  do
    *(_QWORD *)(a2 + 8 * v4++) = 0LL;
  while ( v4 != 11 );
  v5 = *((_QWORD *)this + 82);
  if ( v5 )
  {
    IORecursiveLockLock(v5);
    ++*(_DWORD *)(v3 + 664);
  }
  if ( *(_BYTE *)(v3 + 560) )
  {
    if ( IO80211PeerManager::getPeerManagerLogFlags((IO80211PeerManager *)v3) & 0x400000000LL )
    {
      v6 = getAbsoluteTime();
      v7 = 19342813113834067LL * (v6 >> 9) >> 64 >> 11;
      v8 = 4835703278458516699LL * (v6 - 1000000000 * v7) >> 64 >> 18;
      LODWORD(v9) = current_thread(v3, a2);
      v36 = v9;
      IO80211PeerManager::getBSDName((IO80211PeerManager *)v3);
      v10 = *(_WORD *)(a2 + 2);
      v11 = *(_WORD *)(a2 + 4);
      v12 = *(_WORD *)(a2 + 6);
      v13 = *(_WORD *)(a2 + 8);
      v14 = *(_WORD *)(a2 + 10);
      v15 = *(_WORD *)(a2 + 12);
      v16 = *(_WORD *)(a2 + 14);
      v17 = *(_QWORD *)(v3 + 88);
      if ( v17 )
        v18 = *(_DWORD *)(v17 + 52);
      v19 = v3 + 152;
      v20 = *(_DWORD *)(v3 + 152);
      a2 = 0x400000000LL;
      IO80211PeerManager::logDebug(
        (IO80211PeerManager *)v3,
        0x400000000LL,
        "%llu.%03llu DQUREQ <%p> <%s> total %u maxu %u maxm %u pktcnt[%u %u %u %u] numpeers %u reqTx %x\n",
        v7,
        v8,
        v36);
    }
    else
    {
      v19 = v3 + 152;
    }
    *(_WORD *)(v2 + 88) = *(_DWORD *)v19;
    v21 = 0;
    if ( *(_WORD *)(v2 + 6) )
    {
      a2 = v2;
      v21 = IO80211PeerManager::getMulticastPackets(v3, v2);
    }
    if ( *(_WORD *)(v2 + 4) )
    {
      v37 = v19;
      v22 = (*(_WORD *)v2 & 2u) >> 1;
      v23 = (*(_WORD *)v2 & 2) == 0;
      v24 = 3 * v23;
      v38 = 3 * v23;
      v39 = 2;
      v40 = 3 * v22;
      v41 = 1;
      for ( i = 1LL; ; ++i )
      {
        a2 = v2;
        v21 += IO80211PeerManager::getUnicastPackets((IO80211PeerManager *)v3, v2, v24);
        if ( i == 4 )
          break;
        v24 = *(&v38 + i);
      }
      if ( v21 >= 2 )
        ++*(_DWORD *)(v3 + 452);
      v19 = v37;
    }
  }
  else
  {
    *(_WORD *)(a2 + 88) = 0;
    *(_BYTE *)(v3 + 561) = 1;
    v19 = v3 + 152;
    v21 = 0;
  }
  *(_WORD *)(v2 + 88) = *(_DWORD *)v19;
  v26 = *(_QWORD *)(v3 + 656);
  if ( v26 )
  {
    v27 = *(_DWORD *)(v3 + 664);
    if ( v27 )
      *(_DWORD *)(v3 + 664) = v27 - 1;
    IORecursiveLockUnlock(v26, a2);
  }
  if ( IO80211PeerManager::getPeerManagerLogFlags((IO80211PeerManager *)v3) & 0x400000000LL )
  {
    v28 = getAbsoluteTime();
    v29 = 19342813113834067LL * (v28 >> 9) >> 64 >> 11;
    v30 = 4835703278458516699LL * (v28 - 1000000000 * v29) >> 64 >> 18;
    v31 = (__int64)IO80211PeerManager::getBSDName((IO80211PeerManager *)v3);
    IO80211PeerManager::logDebug(
      (IO80211PeerManager *)v3,
      0x400000000LL,
      "%llu.%03llu <%s> DQUREQ -> got %d\n",
      v29,
      v30,
      v31);
  }
  v32 = 0LL;
  if ( v21 )
  {
    do
    {
      v33 = *(_QWORD *)(v2 + 8 * v32 + 24);
      *(_WORD *)(v2 + 2 * v32 + 8) = 0;
      if ( v33 )
      {
        *(_WORD *)(v2 + 2 * v32 + 8) = 1;
        while ( 1 )
        {
          LODWORD(v34) = mbuf_nextpkt(v33);
          if ( !v34 )
            break;
          ++*(_WORD *)(v2 + 2 * v32 + 8);
          v33 = v34;
        }
      }
      ++v32;
    }
    while ( v32 != 8 );
  }
  result = *(_QWORD *)off_7B078[0];
  if ( *(_QWORD *)off_7B078[0] == v42 )
    result = (unsigned int)v21;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C7758: using guessed type int __cdecl IORecursiveLockLock(_QWORD);
// C7760: using guessed type int __fastcall IORecursiveLockUnlock(_QWORD, _QWORD);
// C8A50: using guessed type int __fastcall current_thread(_QWORD, _QWORD);
// C8C60: using guessed type int __fastcall mbuf_nextpkt(_QWORD);

//----- (0000000000048EDC) ----------------------------------------------------
__int64 __usercall IO80211PeerManager::stackHasPackets@<rax>(IO80211PeerManager *this@<rdi>, __int64 a2@<rax>)
{
  IO80211PeerManager *v2; // rbx@1
  IO80211VirtualInterface *v3; // rdi@1
  __int64 v4; // rax@2
  __int64 v5; // rdi@3
  __int64 v6; // rax@4
  __int64 v8; // [sp-4h] [bp-10h]@1

  v8 = a2;
  v2 = this;
  HIDWORD(v8) = 0;
  v3 = (IO80211VirtualInterface *)*((_QWORD *)this + 16);
  if ( v3 )
  {
    v4 = IO80211VirtualInterface::getIfnet(v3);
    ifnet_get_sndq_len(v4, (char *)&v8 + 4);
  }
  v5 = *((_QWORD *)v2 + 17);
  if ( v5 )
  {
    LODWORD(v6) = (*(int (__cdecl **)(__int64))(*(_QWORD *)v5 + 2408LL))(v5);
    ifnet_get_sndq_len(v6, (char *)&v8 + 4);
  }
  return HIDWORD(v8);
}
// C8B00: using guessed type int __fastcall ifnet_get_sndq_len(_QWORD, _QWORD);

//----- (0000000000048F34) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::outputStart(IO80211PeerManager *this)
{
  IO80211PeerManager *v1; // r12@1
  __int64 v2; // r15@1
  __int64 v3; // rdi@1
  __int64 v4; // rax@4
  signed int v5; // er14@4
  __int64 v6; // rdi@12
  int v7; // er13@15
  int v8; // ebx@15
  int v9; // ST10_4@15
  __int64 v11; // [sp+20h] [bp-40h]@1
  __int64 v12; // [sp+28h] [bp-38h]@1
  __int64 v13; // [sp+30h] [bp-30h]@1

  v1 = this;
  v2 = off_7B078[0];
  v13 = *(_QWORD *)off_7B078[0];
  v12 = 0LL;
  v11 = 0LL;
  v3 = *((_QWORD *)this + 88);
  if ( v3 && *((_DWORD *)v1 + 180) && !IOLockTryLock(v3) )
    goto LABEL_19;
  ++*((_DWORD *)v1 + 56);
  LODWORD(v4) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64, char *))(*(_QWORD *)v1 + 488LL))(
                  v1,
                  800LL,
                  (char *)&v12 + 4);
  v5 = -536870210;
  if ( (_DWORD)v4 != -536870210 )
  {
    LODWORD(v4) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64, __int64 *))(*(_QWORD *)v1 + 488LL))(
                    v1,
                    700LL,
                    &v12);
    if ( (_DWORD)v4 != -536870210 )
    {
      LODWORD(v4) = (*(int (__fastcall **)(IO80211PeerManager *, _QWORD, __int64 *))(*(_QWORD *)v1 + 488LL))(
                      v1,
                      0LL,
                      &v11);
      if ( (_DWORD)v4 != -536870210 )
      {
        LODWORD(v4) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64, char *))(*(_QWORD *)v1 + 488LL))(
                        v1,
                        200LL,
                        (char *)&v11 + 4);
        v5 = v4;
      }
    }
  }
  if ( (unsigned int)IO80211PeerManager::stackHasPackets(v1, v4) )
  {
    if ( IO80211PeerManager::getPeerManagerLogFlags(v1) & 0x80 )
      IO80211PeerManager::printFlowControl(v1, (int *)&stru_68.segname[8], " outputStart remain");
    *((_BYTE *)v1 + 216) = 1;
  }
  v6 = *((_QWORD *)v1 + 88);
  if ( v6 && *((_DWORD *)v1 + 180) )
    IOLockUnlock(v6);
  v7 = HIDWORD(v12);
  v8 = v12 + HIDWORD(v11) + v11;
  v9 = *((_BYTE *)v1 + 216);
  IO80211PeerManager::logDebug(
    v1,
    0x400000000LL,
    "outputStart Got [%u %u %u %u]=%u FC: %u\n",
    (unsigned int)v11,
    HIDWORD(v11),
    (unsigned int)v12);
  if ( v7 + v8 )
    IO80211PeerManager::requestTxPacket(v1, "outputStart");
  while ( *(_QWORD *)v2 != v13 )
  {
LABEL_19:
    ++*((_DWORD *)v1 + 57);
    v5 = -536870187;
    if ( IO80211PeerManager::getPeerManagerLogFlags(v1) & 0x80 )
      IO80211PeerManager::printFlowControl(v1, (int *)&stru_68.segname[8], " outputStart wasLocked");
  }
  return (unsigned int)v5;
}
// 68: using guessed type section_64 stru_68;
// 7B078: using guessed type __int64 off_7B078[7];
// C7718: using guessed type int __cdecl IOLockTryLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);

//----- (0000000000049106) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::allocateDescriptor(IO80211PeerManager *this, __mbuf *a2)
{
  int v2; // er15@1
  __int64 v3; // rax@1
  __mbuf *v4; // rbx@3
  __int64 v5; // rax@4
  __mbuf *v6; // rax@7
  __int64 v7; // rax@10
  __int64 v8; // rbx@10
  char v9; // r15@11
  __int64 v10; // rax@11
  __int64 v12; // [sp+0h] [bp-90h]@1
  char v13; // [sp+8h] [bp-88h]@6
  int v14; // [sp+Ch] [bp-84h]@6
  int v15; // [sp+10h] [bp-80h]@6
  __mbuf *v16; // [sp+18h] [bp-78h]@6
  int v17; // [sp+20h] [bp-70h]@6
  int v18; // [sp+24h] [bp-6Ch]@6
  __int64 v19; // [sp+28h] [bp-68h]@6
  __int64 v20; // [sp+30h] [bp-60h]@6
  __int64 v21; // [sp+38h] [bp-58h]@6
  __int64 v22; // [sp+40h] [bp-50h]@6
  __int64 v23; // [sp+48h] [bp-48h]@6
  __int64 v24; // [sp+50h] [bp-40h]@6
  __int64 v25; // [sp+58h] [bp-38h]@6
  __int64 v26; // [sp+60h] [bp-30h]@6

  v2 = mbuf_get_traffic_class(a2);
  LODWORD(v3) = mbuf_data(a2);
  v12 = v3;
  if ( *((_DWORD *)this + 122) )
  {
    if ( a2 )
    {
      v4 = a2;
      do
      {
        LODWORD(v5) = mbuf_len(v4);
        if ( !v5 && *((_DWORD *)this + 119) )
        {
          v13 = 1;
          v14 = 80;
          v15 = 0;
          v16 = v4;
          v17 = 0;
          v18 = 0;
          v26 = 0LL;
          v25 = 0LL;
          v24 = 0LL;
          v23 = 0LL;
          v22 = 0LL;
          v21 = 0LL;
          v20 = 0LL;
          v19 = 0LL;
          IO80211PeerManager::dumpPacket((__int64)this, (signed __int64)a2, "Q null", (__int64)&v13);
        }
        mbuf_len(v4);
        LODWORD(v6) = mbuf_next(v4, a2);
        v4 = v6;
      }
      while ( v6 );
    }
  }
  else
  {
    mbuf_pkthdr_len(a2);
  }
  v7 = IO80211CommandQueue::lockDequeue(*((IO80211CommandQueue **)this + (unsigned int)v2 + 4), 0);
  v8 = v7;
  if ( v7 )
  {
    *(_QWORD *)(v7 + 32) = 0LL;
    *(_BYTE *)(v7 + 41) = 0;
    *(_WORD *)(v7 + 48) = 0;
    *(_DWORD *)(v7 + 52) = 0;
    *(_WORD *)(v7 + 56) = 0;
    *(_WORD *)(v7 + 60) = 0;
    *(_QWORD *)(v7 + 64) = 0LL;
    *(_QWORD *)(v7 + 72) = 0LL;
    *(_DWORD *)(v7 + 80) = 0;
    *(_WORD *)(v7 + 58) = -1;
    *(_BYTE *)(v7 + 12) = 0;
    *(_DWORD *)(v7 + 44) = OSIncrementAtomic((char *)&pktDescriptorAllocCount + 4 * (unsigned int)v2) & 0xFFFFFF | (v2 << 24);
    v9 = *(_BYTE *)v12;
    v10 = getAbsoluteTime();
    if ( v9 & 1 )
      *((_QWORD *)this + 75) = v10;
    else
      *((_QWORD *)this + 74) = v10;
    *(_QWORD *)(v8 + 72) = v10;
    *(_QWORD *)(v8 + 32) = a2;
  }
  else
  {
    ++*((_DWORD *)this + 142);
    v8 = 0LL;
  }
  return v8;
}
// 84E80: using guessed type _QWORD pktDescriptorAllocCount;
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C30: using guessed type int __fastcall mbuf_get_traffic_class(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C58: using guessed type int __fastcall mbuf_next(_QWORD, _QWORD);
// C8C68: using guessed type int __fastcall mbuf_pkthdr_len(_QWORD);

//----- (00000000000492EC) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::queuePacket(IO80211PeerManager *this, __mbuf *a2)
{
  __int64 v2; // rax@2
  int v3; // ecx@2
  __int64 result; // rax@19
  IO80211PacketDescriptor *v5; // rax@20
  __int64 v6; // rdx@20
  __int64 v7; // rcx@20
  __int64 v8; // r8@20
  __int64 v9; // r9@20

  if ( !*((_DWORD *)this + 123) )
    goto LABEL_20;
  LODWORD(v2) = mbuf_data(a2);
  v3 = *(_BYTE *)v2;
  if ( v3 == 1 )
  {
    if ( *(_BYTE *)(v2 + 1) )
      goto LABEL_20;
    if ( *(_BYTE *)(v2 + 2) == 94 && !*(_BYTE *)(v2 + 3) )
    {
LABEL_19:
      mbuf_freem(a2);
      return 0LL;
    }
  }
  if ( (unsigned __int8)v3 == 51
    && (*(_BYTE *)(v2 + 1) == 51 && !*(_BYTE *)(v2 + 2) && !*(_BYTE *)(v2 + 3)
     || *(_BYTE *)(v2 + 1) == 51
     && (!*(_BYTE *)(v2 + 2) && !*(_BYTE *)(v2 + 3) && !*(_BYTE *)(v2 + 4) && *(_BYTE *)(v2 + 5) == 251
      || *(_BYTE *)(v2 + 2) == 128 && !*(_BYTE *)(v2 + 3) && !*(_BYTE *)(v2 + 4) && *(_BYTE *)(v2 + 5) == 251)) )
    goto LABEL_19;
LABEL_20:
  v5 = (IO80211PacketDescriptor *)IO80211PeerManager::allocateDescriptor(this, a2);
  if ( v5 )
  {
    result = IO80211PeerManager::queuePacket(this, v5);
  }
  else
  {
    IO80211PeerManager::logDebug(this, "No free packet Descriptor packetSpace  \n", v6, v7, v8, v9);
    mbuf_freem(a2);
    result = 3758097085LL;
  }
  return result;
}
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);

//----- (00000000000493EA) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::queuePacket(IO80211PeerManager *this, IO80211PacketDescriptor *a2)
{
  IO80211PacketDescriptor *v2; // rbx@1
  __int64 v3; // r14@1
  __mbuf *v4; // r15@1
  __int64 v5; // rax@1
  __int64 v6; // rax@3
  __int64 v7; // rax@3
  unsigned __int64 v8; // rbx@4
  __int64 v9; // rax@4
  __int64 v10; // r13@4
  __int64 v11; // ST68_8@4
  unsigned __int64 v12; // r15@4
  __int64 v13; // r12@4
  int v14; // ST48_4@4
  int v15; // ST38_4@4
  int v16; // ST30_4@4
  int v17; // ST28_4@4
  int v18; // ST20_4@4
  int v19; // ST18_4@4
  int v20; // ST10_4@4
  __int64 v21; // rcx@4
  __int64 v22; // rax@6
  signed __int64 v23; // rsi@6
  int v24; // eax@6
  int v25; // eax@11
  __int64 v26; // rdi@17
  signed __int64 (__fastcall *v27)(__int64, __int64, __int64); // rsi@20
  int v28; // er13@20
  __int64 v29; // r12@22
  __int64 v30; // rdi@22
  IO80211Peer *v31; // rdi@23
  __int64 v32; // rax@28
  signed int v33; // ecx@28
  int v34; // eax@30
  signed int v35; // ST68_4@32
  unsigned int *v36; // rax@32
  unsigned int v37; // ST60_4@32
  __int64 v38; // rax@32
  unsigned int v39; // ST50_4@32
  __int64 v40; // rax@32
  unsigned int v41; // er13@32
  __int64 v42; // rax@32
  int v43; // ebx@32
  __int64 v44; // rax@32
  int v45; // er15@32
  __int64 v46; // rax@32
  int v47; // ST10_4@32
  __int64 v48; // rdi@37
  int v49; // eax@38
  __int64 result; // rax@46
  IO80211PacketDescriptor *v51; // [sp+58h] [bp-118h]@28
  __int64 v52; // [sp+60h] [bp-110h]@3
  char v53; // [sp+74h] [bp-FCh]@1
  char v54; // [sp+78h] [bp-F8h]@6
  int v55; // [sp+7Ch] [bp-F4h]@11
  int v56; // [sp+80h] [bp-F0h]@11
  __mbuf *v57; // [sp+88h] [bp-E8h]@11
  int v58; // [sp+90h] [bp-E0h]@11
  int v59; // [sp+94h] [bp-DCh]@11
  __int64 v60; // [sp+98h] [bp-D8h]@11
  __int16 *v61; // [sp+A0h] [bp-D0h]@11
  __int64 v62; // [sp+A8h] [bp-C8h]@11
  __int64 v63; // [sp+B0h] [bp-C0h]@11
  __int64 v64; // [sp+B8h] [bp-B8h]@11
  __int64 v65; // [sp+C0h] [bp-B0h]@11
  __int64 v66; // [sp+C8h] [bp-A8h]@11
  __int64 v67; // [sp+D0h] [bp-A0h]@11
  __int16 v68; // [sp+D8h] [bp-98h]@6
  __int16 v69; // [sp+DAh] [bp-96h]@6
  __int16 v70; // [sp+DCh] [bp-94h]@6
  __int16 v71; // [sp+DEh] [bp-92h]@6
  char v72; // [sp+E0h] [bp-90h]@6
  IO80211PacketDescriptor *v73; // [sp+E8h] [bp-88h]@1
  int v74; // [sp+F0h] [bp-80h]@1
  char v75; // [sp+F4h] [bp-7Ch]@1
  char *v76; // [sp+F8h] [bp-78h]@1
  char v77; // [sp+100h] [bp-70h]@1
  __int64 v78; // [sp+140h] [bp-30h]@1

  v2 = a2;
  v3 = (__int64)this;
  v78 = *(_QWORD *)off_7B078[0];
  v4 = (__mbuf *)*((_QWORD *)a2 + 4);
  v73 = 0LL;
  v74 = -536870210;
  v75 = 0;
  v76 = &v77;
  v53 = mbuf_get_traffic_class(v4);
  LODWORD(v5) = mbuf_data(v4);
  if ( *(_BYTE *)v5 & 1 )
    mbuf_set_traffic_class(v4, 0LL);
  LODWORD(v6) = mbuf_data(v4);
  v52 = v6;
  v7 = IO80211PeerManager::getPeerManagerLogFlags(this);
  if ( BYTE1(v7) & 1 )
  {
    v8 = *((_QWORD *)a2 + 9);
    LODWORD(v9) = mbuf_data(v4);
    v10 = v9;
    v11 = (__int64)v4;
    v12 = 19342813113834067LL * (v8 >> 9) >> 64 >> 11;
    v13 = 4835703278458516699LL * (v8 - 1000000000 * v12) >> 64 >> 18;
    mbuf_data(v11);
    mbuf_len(v11);
    v14 = *((_DWORD *)this + 38);
    v15 = *(_BYTE *)(v10 + 5);
    v16 = *(_BYTE *)(v10 + 4);
    v2 = a2;
    v17 = *(_BYTE *)(v10 + 3);
    v18 = *(_BYTE *)(v10 + 2);
    v19 = *(_BYTE *)(v10 + 1);
    v20 = *(_BYTE *)v10;
    v21 = v12;
    v4 = (__mbuf *)v11;
    IO80211PeerManager::logDebug(
      this,
      256LL,
      "%llu.%03llu QUPKT m=%p data=%p len=%lu dest %02x:%02x:%02x:%02x:%02x:%02x ac %u request=%x\n",
      v21,
      v13,
      v11);
  }
  if ( IO80211PeerManager::getPeerManagerLogFlags(this) & 0x20000 )
  {
    v68 = *(_DWORD *)(*((_QWORD *)this + 4) + 52LL);
    v69 = *(_DWORD *)(*((_QWORD *)this + 5) + 52LL);
    v70 = *(_DWORD *)(*((_QWORD *)this + 6) + 52LL);
    v71 = *(_DWORD *)(*((_QWORD *)this + 7) + 52LL);
    LODWORD(v22) = IO80211PeerManager::getIfNet(this);
    v23 = (signed __int64)&v72;
    ifnet_get_sndq_len(v22, &v72);
    v54 = 1;
    v24 = 0;
    if ( this )
    {
      if ( *((_BYTE *)this + 682) & 2 )
      {
        v24 = *((_DWORD *)this + 108);
      }
      else
      {
        v24 = *((_DWORD *)this + 106);
        if ( !*((_DWORD *)this + 106) )
        {
          v23 = (signed __int64)v4;
          v24 = getLengthBeforeSensitivePayload(0, v4);
        }
      }
    }
    v55 = v24;
    v56 = 0;
    v57 = v4;
    v58 = *((_DWORD *)v2 + 11);
    v59 = 1;
    v67 = 0LL;
    v66 = 0LL;
    v65 = 0LL;
    v64 = 0LL;
    v63 = 0LL;
    v62 = 0LL;
    v60 = 0LL;
    LODWORD(v60) = 786441;
    v61 = &v68;
    v25 = 0;
    if ( this )
    {
      if ( *((_BYTE *)this + 682) & 2 )
      {
        v25 = *((_DWORD *)this + 108);
      }
      else
      {
        v25 = *((_DWORD *)this + 106);
        if ( !*((_DWORD *)this + 106) )
        {
          v23 = (signed __int64)v4;
          v25 = getLengthBeforeSensitivePayload(0, v4);
        }
      }
    }
    v55 = v25;
    IO80211PeerManager::dumpPacket((__int64)this, v23, "QueuePacket", (__int64)&v54);
  }
  v26 = *((_QWORD *)this + 82);
  if ( v26 )
  {
    IORecursiveLockLock(v26);
    ++*(_DWORD *)(v3 + 664);
  }
  OSIncrementAtomic(v3 + 1020);
  if ( *(_BYTE *)v52 & 1 )
  {
    v27 = (signed __int64 (__fastcall *)(__int64, __int64, __int64))v2;
    v28 = IO80211Peer::queuePacket(*(IO80211Peer **)(v3 + 72), v2);
    if ( v28 )
      ++*(_DWORD *)(v3 + 968);
    v29 = *(_QWORD *)(v3 + 72);
    v30 = (1 << v53) | 0x10u;
  }
  else
  {
    v31 = *(IO80211Peer **)(v3 + 80);
    if ( v31 )
    {
      v27 = (signed __int64 (__fastcall *)(__int64, __int64, __int64))v2;
      v28 = IO80211Peer::queuePacket(v31, v2);
      if ( v28 )
        ++*(_DWORD *)(v3 + 968);
      v29 = *(_QWORD *)(v3 + 80);
    }
    else
    {
      v73 = v2;
      v27 = _queuePacket;
      v29 = IO80211CommandQueue::map(
              *(_QWORD *)(v3 + 88),
              (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_queuePacket,
              v3,
              (__int64)&v73,
              0LL,
              -1);
      if ( !v29 )
      {
        v51 = v2;
        LODWORD(v32) = mbuf_data(*((_QWORD *)v73 + 4));
        v33 = 15;
        if ( !(*(_BYTE *)v32 & 1) )
        {
          v33 = 0;
          if ( !*(_QWORD *)(v3 + 136) )
          {
            v34 = *(_BYTE *)(v32 + 5) & 0xF;
            v33 = 0;
            if ( v34 != 15 )
              v33 = v34;
          }
        }
        v35 = v33;
        LODWORD(v36) = mbuf_data(*((_QWORD *)v73 + 4));
        v37 = *(_BYTE *)v36;
        LODWORD(v38) = mbuf_data(*((_QWORD *)v73 + 4));
        v39 = *(_BYTE *)(v38 + 1);
        LODWORD(v40) = mbuf_data(*((_QWORD *)v73 + 4));
        v41 = *(_BYTE *)(v40 + 2);
        LODWORD(v42) = mbuf_data(*((_QWORD *)v73 + 4));
        v43 = *(_BYTE *)(v42 + 3);
        LODWORD(v44) = mbuf_data(*((_QWORD *)v73 + 4));
        v45 = *(_BYTE *)(v44 + 4);
        LODWORD(v46) = mbuf_data(*((_QWORD *)v73 + 4));
        v47 = *(_BYTE *)(v46 + 5);
        v27 = (signed __int64 (__fastcall *)(__int64, __int64, __int64))"Unable to find peer for queing packet. hash=%d expected_peer=%02X:%02X:%02X:%02X:%02X:%02X\n";
        IO80211PeerManager::logDebug(
          (IO80211PeerManager *)v3,
          "Unable to find peer for queing packet. hash=%d expected_peer=%02X:%02X:%02X:%02X:%02X:%02X\n",
          (unsigned int)v35,
          v37,
          v39,
          v41);
        v2 = v51;
      }
      v28 = v74;
    }
    v30 = (unsigned int)(1 << v53);
  }
  if ( !v28 )
  {
    v27 = (signed __int64 (__fastcall *)(__int64, __int64, __int64))(v3 + 152);
    OSBitOrAtomic(v30, v3 + 152);
  }
  v48 = *(_QWORD *)(v3 + 656);
  if ( v48 )
  {
    v49 = *(_DWORD *)(v3 + 664);
    if ( v49 )
      *(_DWORD *)(v3 + 664) = v49 - 1;
    IORecursiveLockUnlock(v48, v27);
  }
  if ( v28 )
  {
    IO80211PeerManager::doFreePacket((IO80211PeerManager *)v3, v2);
  }
  else
  {
    ++*(_DWORD *)(v3 + 932);
    if ( v29 && v75 )
      IO80211PeerManager::performCacheOperation(
        (IO80211PeerManager *)v3,
        (__int64 (__fastcall *)(__int64, __int64, __int64))&v77);
  }
  result = *(_QWORD *)off_7B078[0];
  if ( *(_QWORD *)off_7B078[0] == v78 )
    result = (unsigned int)v28;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C7758: using guessed type int __cdecl IORecursiveLockLock(_QWORD);
// C7760: using guessed type int __fastcall IORecursiveLockUnlock(_QWORD, _QWORD);
// C77B0: using guessed type int __fastcall OSBitOrAtomic(_QWORD, _QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C8B00: using guessed type int __fastcall ifnet_get_sndq_len(_QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C30: using guessed type int __fastcall mbuf_get_traffic_class(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C98: using guessed type int __fastcall mbuf_set_traffic_class(_QWORD, _QWORD);

//----- (000000000004996F) ----------------------------------------------------
signed __int64 __fastcall _queuePacket(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  const void *v4; // rax@1
  int v5; // ecx@1
  signed __int64 result; // rax@1
  int v7; // eax@2

  v3 = a3;
  LODWORD(v4) = mbuf_data(*(_QWORD *)(*(_QWORD *)a3 + 32LL));
  v5 = memcmp((const void *)(a2 + 32), v4, 6uLL);
  result = 0LL;
  if ( !v5 )
  {
    v7 = IO80211Peer::queuePacket((IO80211Peer *)a2, *(IO80211PacketDescriptor **)v3);
    *(_DWORD *)(v3 + 8) = v7;
    if ( v7 )
      *(_BYTE *)(v3 + 12) = 0;
    else
      *(_BYTE *)(v3 + 12) = IO80211Peer::cacheControlPending((IO80211Peer *)a2, *(void **)(v3 + 16));
    result = 17LL;
  }
  return result;
}
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);

//----- (00000000000499D2) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::getHashTableIndex(IO80211PeerManager *this, ether_addr *a2)
{
  __int64 result; // rax@1

  LOBYTE(result) = 15;
  if ( !(a2->octet[0] & 1) )
  {
    if ( *((_QWORD *)this + 17) || (LODWORD(result) = a2->octet[5] & 0xF, (_DWORD)result == 15) )
      LOBYTE(result) = 0;
  }
  return (unsigned __int8)result;
}

//----- (00000000000499FA) ----------------------------------------------------
char __fastcall IO80211PeerManager::doMonitorTimer(IO80211PeerManager *this)
{
  __int64 v1; // r12@1
  __int64 v2; // rax@1
  __int64 v3; // r15@3
  unsigned int v4; // ST1C_4@3
  __int64 v5; // r14@3
  int v6; // ST08_4@3
  int v7; // ST00_4@3
  int v8; // ST10_4@3
  int v9; // ebx@6
  __int64 v10; // rdi@9
  __int64 v11; // rdi@11
  __int64 v12; // rdi@14
  __int64 v13; // rax@16
  __int64 v14; // rdi@16
  int v15; // eax@17
  unsigned int v16; // ebx@21
  __int64 v18; // [sp+20h] [bp-E0h]@16
  __int64 v19; // [sp+28h] [bp-D8h]@16
  __int64 (__fastcall *v20)(__int64, __int64); // [sp+30h] [bp-D0h]@16
  __int64 v21; // [sp+38h] [bp-C8h]@16
  __int64 v22; // [sp+40h] [bp-C0h]@16
  __int64 v23; // [sp+48h] [bp-B8h]@16
  __int64 v24; // [sp+50h] [bp-B0h]@16
  __int64 v25; // [sp+58h] [bp-A8h]@16
  __int64 v26; // [sp+60h] [bp-A0h]@16
  __int64 v27; // [sp+68h] [bp-98h]@16
  __int64 v28; // [sp+70h] [bp-90h]@9
  __int64 v29; // [sp+78h] [bp-88h]@9
  __int64 v30; // [sp+80h] [bp-80h]@9
  __int64 v31; // [sp+88h] [bp-78h]@9
  __int64 v32; // [sp+90h] [bp-70h]@9
  __int64 v33; // [sp+98h] [bp-68h]@9
  __int64 v34; // [sp+A0h] [bp-60h]@9
  __int64 v35; // [sp+A8h] [bp-58h]@9
  __int64 v36; // [sp+B0h] [bp-50h]@9
  __int64 v37; // [sp+B8h] [bp-48h]@9
  __int64 v38; // [sp+C0h] [bp-40h]@9
  __int64 v39; // [sp+C8h] [bp-38h]@9
  __int64 v40; // [sp+D0h] [bp-30h]@9

  v1 = (__int64)this;
  ++*(_DWORD *)(v1 + 648);
  ++*(_DWORD *)(v1 + 696);
  v2 = IO80211PeerManager::getPeerManagerLogFlags(this);
  if ( v2 & 0x20000000 && *((_BYTE *)this + 683) & 0x20 )
  {
    v3 = (__int64)IO80211PeerManager::getBSDName(this);
    v4 = *((_BYTE *)this + 652);
    v5 = *((_QWORD *)this + 18);
    v6 = *((_DWORD *)this + 162);
    v7 = *((_DWORD *)this + 172);
    v8 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v5)) >> 64) >> 18;
    v2 = IO80211PeerManager::logDebug(
           this,
           0x20000000LL,
           "%s::%s monTimer en %u count %u stats %u last %u(ms)\n",
           v3,
           (__int64)"doMonitorTimer",
           v4);
  }
  if ( *((_BYTE *)this + 652) )
  {
    if ( !*((_DWORD *)this + 254) )
      goto LABEL_27;
    v9 = 0;
    do
      IO80211PeerManager::sendUnflowControlStack(this, v2, v9++);
    while ( v9 != 4 );
    if ( *((_BYTE *)this + 652) )
    {
LABEL_27:
      v40 = 0LL;
      v39 = 0LL;
      v38 = 0LL;
      v37 = 0LL;
      v36 = 0LL;
      v35 = 0LL;
      v34 = 0LL;
      v33 = 0LL;
      v32 = 0LL;
      v31 = 0LL;
      v30 = 0LL;
      v29 = 0LL;
      v28 = 0LL;
      v10 = *((_QWORD *)this + 9);
      if ( v10 )
        (*(void (__fastcall **)(__int64, __int64 *))(*(_QWORD *)v10 + 352LL))(v10, &v28);
      bzero(&v28, 0x68uLL);
      v11 = *(_QWORD *)(v1 + 80);
      if ( v11 )
        (*(void (__fastcall **)(__int64, __int64 *))(*(_QWORD *)v11 + 352LL))(v11, &v28);
      if ( *(_QWORD *)(v1 + 88) )
      {
        bzero(&v28, 0x68uLL);
        v12 = *(_QWORD *)(v1 + 656);
        if ( v12 )
        {
          IORecursiveLockLock(v12);
          ++*(_DWORD *)(v1 + 664);
        }
        v27 = 0LL;
        v26 = 0LL;
        v25 = 0LL;
        v24 = 0LL;
        v23 = 0LL;
        v22 = 0LL;
        v21 = 0LL;
        v19 = 0LL;
        v18 = 0LL;
        v20 = _addToFlush;
        v13 = IO80211CommandQueue::map(
                *(_QWORD *)(v1 + 88),
                (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_doMonitoring,
                v1,
                (__int64)&v28,
                (__int64)&v18,
                -1);
        v14 = *(_QWORD *)(v1 + 656);
        if ( v14 )
        {
          v15 = *(_DWORD *)(v1 + 664);
          if ( v15 )
            *(_DWORD *)(v1 + 664) = v15 - 1;
          LODWORD(v13) = IORecursiveLockUnlock(v14, _doMonitoring);
        }
        if ( HIDWORD(v28) )
        {
          v16 = 0;
          do
            v13 = IO80211PeerManager::uncache((IO80211PeerManager *)v1, (ether_addr *)&v29 + v16++);
          while ( v16 < HIDWORD(v28) );
        }
        IO80211PeerManager::removeFlushedPeers((IO80211PeerManager *)v1, v13);
      }
    }
  }
  return *(_BYTE *)(v1 + 652);
}
// C7758: using guessed type int __cdecl IORecursiveLockLock(_QWORD);
// C7760: using guessed type int __fastcall IORecursiveLockUnlock(_QWORD, _QWORD);

//----- (0000000000049CF9) ----------------------------------------------------
signed __int64 __fastcall _doMonitoring(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  signed __int64 result; // rax@1

  v3 = a3;
  *(_BYTE *)a3 = 0;
  (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)a2 + 352LL))(a2, a3);
  result = 12LL;
  if ( !*(_BYTE *)v3 )
    result = 0LL;
  return result;
}

//----- (0000000000049D28) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::outputPacket(IO80211PeerManager *this, __mbuf *a2)
{
  __int64 v2; // rax@1
  int v3; // eax@3
  unsigned int v4; // ebx@7
  char v6; // [sp+8h] [bp-78h]@2
  int v7; // [sp+Ch] [bp-74h]@2
  int v8; // [sp+10h] [bp-70h]@2
  __mbuf *v9; // [sp+18h] [bp-68h]@2
  int v10; // [sp+20h] [bp-60h]@2
  int v11; // [sp+24h] [bp-5Ch]@2
  __int64 v12; // [sp+28h] [bp-58h]@2
  __int64 v13; // [sp+30h] [bp-50h]@2
  __int64 v14; // [sp+38h] [bp-48h]@2
  __int64 v15; // [sp+40h] [bp-40h]@2
  __int64 v16; // [sp+48h] [bp-38h]@2
  __int64 v17; // [sp+50h] [bp-30h]@2
  __int64 v18; // [sp+58h] [bp-28h]@2
  __int64 v19; // [sp+60h] [bp-20h]@2

  ++*((_DWORD *)this + 194);
  v2 = IO80211PeerManager::getPeerManagerLogFlags(this);
  if ( _bittest((const unsigned __int64 *)&v2, 0x2Du) )
  {
    v6 = 1;
    v7 = 0;
    v8 = 0;
    v9 = a2;
    v10 = 0;
    v11 = 0;
    v19 = 0LL;
    v18 = 0LL;
    v17 = 0LL;
    v16 = 0LL;
    v15 = 0LL;
    v14 = 0LL;
    v13 = 0LL;
    v12 = 0LL;
    if ( *((_QWORD *)this + 85) & 0x200000000000LL )
    {
      v3 = *((_DWORD *)this + 108);
    }
    else
    {
      v3 = *((_DWORD *)this + 106);
      if ( !*((_DWORD *)this + 106) )
        v3 = getLengthBeforeSensitivePayload(0, a2);
    }
    v7 = v3;
    IO80211PeerManager::dumpPacket((__int64)this, (signed __int64)a2, "TxUp ", (__int64)&v6);
  }
  v4 = IO80211PeerManager::queuePacket(this, a2);
  if ( !v4 )
    IO80211PeerManager::requestTxPacket(this, "outputPacket");
  return v4;
}

//----- (0000000000049E2C) ----------------------------------------------------
signed int __fastcall IO80211PeerManager::ioctl_internal_gated(__int64 a1, __int64 a2)
{
  __int64 v2; // rax@1
  __int64 v3; // rcx@2
  int (__fastcall *v4)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // r9@3

  v2 = IO80211PeerManager::getController((IO80211PeerManager *)a1);
  if ( v2 )
  {
    v3 = *(_QWORD *)(a1 + 128);
    if ( v3 )
    {
      v4 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 3224LL);
      return v4(v2, *(_DWORD *)a2, *(_DWORD *)(a2 + 4), v3, *(_QWORD *)(a2 + 8));
    }
    v3 = *(_QWORD *)(a1 + 136);
    if ( v3 )
    {
      v4 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 3216LL);
      return v4(v2, *(_DWORD *)a2, *(_DWORD *)(a2 + 4), v3, *(_QWORD *)(a2 + 8));
    }
  }
  return -536870199;
}

//----- (0000000000049E90) ----------------------------------------------------
signed int __fastcall IO80211PeerManager::do_ioctl(IO80211PeerManager *this, unsigned int a2, unsigned int a3, void *a4)
{
  void *v4; // r14@1
  unsigned int v5; // er15@1
  __int64 v6; // rax@2
  int (__fastcall *v7)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // r9@2
  __int64 v8; // rcx@2

  v4 = a4;
  v5 = a3;
  if ( *((_QWORD *)this + 16) )
  {
    v6 = IO80211PeerManager::getController(this);
    v7 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v6 + 3224LL);
    v8 = *((_QWORD *)this + 16);
    return v7(v6, a2, v5, v8, v4);
  }
  if ( *((_QWORD *)this + 17) )
  {
    v6 = IO80211PeerManager::getController(this);
    v7 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v6 + 3216LL);
    v8 = *((_QWORD *)this + 17);
    return v7(v6, a2, v5, v8, v4);
  }
  return 14;
}

//----- (0000000000049F14) ----------------------------------------------------
void IO80211PeerManager::handlePERReportTimer()
{
  ;
}

//----- (0000000000049F1A) ----------------------------------------------------
char __fastcall IO80211PeerManager::inputPacket(IO80211PeerManager *this, signed __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  signed __int64 v4; // r13@1
  __int64 v5; // r14@1
  signed __int64 v6; // r15@1
  signed __int64 v7; // rax@1
  signed __int64 v8; // r12@1
  __int64 v9; // rax@2
  char v10; // bl@2
  __int64 v11; // r8@2
  __int64 v12; // r9@2
  int v13; // eax@4
  int v14; // eax@23
  __int64 v15; // rdi@24
  __int64 v16; // r13@27
  __int64 v17; // ST88_8@28
  __int64 v18; // rbx@29
  char v19; // r15@29
  char v20; // bl@35
  __int64 v21; // rdi@37
  int v22; // eax@38
  int v23; // eax@44
  __int64 v24; // rbx@48
  __int64 v25; // rax@50
  char *v26; // rdx@52
  char *v27; // rcx@54
  int v28; // eax@61
  int v29; // eax@76
  char *v30; // rbx@83
  __mbuf *v31; // r13@87
  char v32; // al@90
  unsigned __int64 v33; // rax@93
  OSMetaClass *v34; // rax@94
  __int64 v35; // rax@94
  __int64 v36; // r9@94
  unsigned __int16 v37; // cx@95
  bool v38; // al@95
  signed __int64 v39; // ST68_8@106
  unsigned int v40; // er15@106
  __int64 v41; // rcx@106
  __int16 v42; // ax@109
  int v43; // eax@110
  signed int v44; // er15@110
  unsigned __int64 v45; // rax@113
  OSMetaClass *v46; // rax@114
  __int64 v47; // r12@114
  __int64 v48; // rax@114
  unsigned int v49; // ebx@118
  __mbuf *v50; // r15@118
  __mbuf *v51; // rax@119
  __int64 v52; // rax@121
  OSMetaClass *v53; // rax@122
  __int64 v54; // r12@122
  int v55; // eax@122
  __int64 v56; // rax@123
  void *v57; // rax@126
  void *v58; // rbx@126
  IO80211Controller *v59; // rax@126
  __int64 v61; // rax@137
  int v62; // eax@138
  __int64 v63; // [sp+0h] [bp-1F0h]@0
  __int64 v64; // [sp+8h] [bp-1E8h]@0
  __int64 v65; // [sp+10h] [bp-1E0h]@0
  __int64 v66; // [sp+18h] [bp-1D8h]@0
  __int64 v67; // [sp+20h] [bp-1D0h]@0
  __int64 v68; // [sp+28h] [bp-1C8h]@0
  __int64 v69; // [sp+30h] [bp-1C0h]@0
  __int64 v70; // [sp+38h] [bp-1B8h]@0
  __int64 v71; // [sp+40h] [bp-1B0h]@0
  __int64 v72; // [sp+48h] [bp-1A8h]@0
  __int64 v73; // [sp+50h] [bp-1A0h]@0
  __int64 v74; // [sp+60h] [bp-190h]@35
  signed __int64 v75; // [sp+68h] [bp-188h]@25
  __int64 v76; // [sp+78h] [bp-178h]@25
  signed __int64 v77; // [sp+80h] [bp-170h]@25
  signed __int64 v78; // [sp+80h] [bp-170h]@87
  char v79; // [sp+88h] [bp-168h]@44
  char v80; // [sp+94h] [bp-15Ch]@0
  __int64 v81; // [sp+98h] [bp-158h]@134
  char v82; // [sp+A0h] [bp-150h]@58
  int v83; // [sp+A4h] [bp-14Ch]@58
  int v84; // [sp+A8h] [bp-148h]@58
  __int64 v85; // [sp+B0h] [bp-140h]@58
  int v86; // [sp+B8h] [bp-138h]@58
  int v87; // [sp+BCh] [bp-134h]@58
  __int64 v88; // [sp+C0h] [bp-130h]@58
  __int64 v89; // [sp+C8h] [bp-128h]@58
  __int64 v90; // [sp+D0h] [bp-120h]@58
  __int64 v91; // [sp+D8h] [bp-118h]@58
  __int64 v92; // [sp+E0h] [bp-110h]@58
  __int64 v93; // [sp+E8h] [bp-108h]@58
  __int64 v94; // [sp+F0h] [bp-100h]@58
  __int64 v95; // [sp+F8h] [bp-F8h]@58
  __int64 v96; // [sp+100h] [bp-F0h]@1
  __int64 v97; // [sp+108h] [bp-E8h]@1
  __int64 v98; // [sp+110h] [bp-E0h]@1
  __int64 v99; // [sp+118h] [bp-D8h]@1
  __int64 v100; // [sp+120h] [bp-D0h]@1
  __int64 v101; // [sp+128h] [bp-C8h]@1
  __int64 v102; // [sp+130h] [bp-C0h]@1
  __int64 v103; // [sp+138h] [bp-B8h]@1
  char v104; // [sp+140h] [bp-B0h]@36
  char v105; // [sp+180h] [bp-70h]@54
  __int64 v106; // [sp+1C0h] [bp-30h]@1

  v3 = a3;
  v4 = a2;
  v5 = (__int64)this;
  v106 = *(_QWORD *)off_7B078[0];
  v6 = *(_QWORD *)a2;
  LODWORD(v7) = mbuf_data(*(_QWORD *)a2);
  v8 = v7;
  v103 = 0LL;
  v102 = 0LL;
  v101 = 0LL;
  v100 = 0LL;
  v99 = 0LL;
  v98 = 0LL;
  v97 = 0LL;
  v96 = 0LL;
  if ( *(_BYTE *)(v7 + 6) & 1 )
  {
    v9 = (__int64)IO80211PeerManager::getBSDName(this);
    v10 = 0;
    a2 = 0x4000000000LL;
    IO80211PeerManager::logDebug(
      this,
      0x4000000000LL,
      "<%s> input packet with mcast source mac address -> drop\n",
      v9,
      v11,
      v12);
    HIDWORD(v98) = 5;
    goto LABEL_131;
  }
  v96 = v6;
  v97 = v3;
  LOBYTE(v98) = 0;
  if ( *(_BYTE *)v7 & 1 )
  {
    ++*((_DWORD *)this + 195);
    v13 = *(_BYTE *)v7;
    if ( v13 == 1 )
    {
      v80 = 1;
      if ( *(_BYTE *)(v8 + 1) )
        goto LABEL_24;
      if ( *(_BYTE *)(v8 + 2) == 94 && !*(_BYTE *)(v8 + 3) )
        goto LABEL_146;
    }
    v80 = 1;
    if ( (unsigned __int8)v13 == 51
      && (*(_BYTE *)(v8 + 1) == 51 && !*(_BYTE *)(v8 + 2) && !*(_BYTE *)(v8 + 3)
       || *(_BYTE *)(v8 + 1) == 51
       && (!*(_BYTE *)(v8 + 2) && !*(_BYTE *)(v8 + 3) && !*(_BYTE *)(v8 + 4) && *(_BYTE *)(v8 + 5) == 251
        || *(_BYTE *)(v8 + 2) == 128 && !*(_BYTE *)(v8 + 3) && !*(_BYTE *)(v8 + 4) && *(_BYTE *)(v8 + 5) == 251)) )
    {
LABEL_146:
      if ( *((_DWORD *)this + 123) )
        goto LABEL_130;
      ++*((_DWORD *)this + 201);
      v80 = 1;
    }
  }
  else
  {
    ++*((_DWORD *)this + 196);
    v14 = mbuf_get_traffic_class(v6);
    ++*((_DWORD *)this + (unsigned int)v14 + 197);
    *((_DWORD *)this + 209) += mbuf_pkthdr_len(v6);
    v80 = 0;
  }
LABEL_24:
  v15 = *((_QWORD *)this + 11);
  if ( v15 )
  {
    v76 = v3;
    v77 = a2;
    v75 = v6;
    if ( *(_QWORD *)(v5 + 656) )
    {
      IORecursiveLockLock(*(_QWORD *)(v5 + 656));
      ++*(_DWORD *)(v5 + 664);
      v15 = *(_QWORD *)(v5 + 88);
    }
    a2 = (signed __int64)_doInputPacket;
    v16 = IO80211CommandQueue::map(
            v15,
            (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_doInputPacket,
            v5,
            (__int64)&v96,
            0LL,
            -1);
    if ( !v16 )
    {
      v17 = (__int64)IO80211PeerManager::getBSDName((IO80211PeerManager *)v5);
      v73 = *(_QWORD *)(v5 + 72);
      LODWORD(v72) = *(_BYTE *)(v8 + 5);
      LODWORD(v71) = *(_BYTE *)(v8 + 4);
      LODWORD(v70) = *(_BYTE *)(v8 + 3);
      LODWORD(v69) = *(_BYTE *)(v8 + 2);
      LODWORD(v68) = *(_BYTE *)(v8 + 1);
      LODWORD(v67) = *(_BYTE *)v8;
      LODWORD(v66) = *(_BYTE *)(v8 + 11);
      LODWORD(v65) = *(_BYTE *)(v8 + 10);
      LODWORD(v64) = *(_BYTE *)(v8 + 9);
      LODWORD(v63) = *(_BYTE *)(v8 + 8);
      a2 = 0x400000000LL;
      IO80211PeerManager::logDebug(
        (IO80211PeerManager *)v5,
        0x400000000LL,
        "<%s> Peer not found.. %02X:%02X:%02X:%02X:%02X:%02X --> %02X:%02X:%02X:%02X:%02X:%02X mpeer=%p\n",
        v17,
        *(_BYTE *)(v8 + 6),
        *(_BYTE *)(v8 + 7));
    }
    v18 = 0LL;
    v19 = 0;
    if ( !v80 )
    {
      v18 = 0LL;
      if ( *(_DWORD *)(v5 + 668) )
      {
        a2 = v8;
        v18 = IO80211PeerManager::findPeer((IO80211PeerManager *)v5, (unsigned __int8 *)v8, 0);
      }
      if ( v16 && !(_DWORD)v103 )
      {
        a2 = (signed __int64)&v104;
        v19 = IO80211Peer::cacheControlPending((IO80211Peer *)v16, &v104);
      }
      else
      {
        v19 = 0;
      }
    }
    v21 = *(_QWORD *)(v5 + 656);
    v4 = v77;
    if ( v21 )
    {
      v22 = *(_DWORD *)(v5 + 664);
      if ( v22 )
        *(_DWORD *)(v5 + 664) = v22 - 1;
      IORecursiveLockUnlock(v21, a2);
    }
    v74 = v18;
    if ( v19 )
    {
      a2 = (signed __int64)&v104;
      IO80211PeerManager::performCacheOperation(
        (IO80211PeerManager *)v5,
        (__int64 (__fastcall *)(__int64, __int64, __int64))&v104);
    }
    v20 = v98;
    v6 = v75;
  }
  else
  {
    v76 = v3;
    a2 = v6;
    v20 = (*(int (__fastcall **)(_QWORD, signed __int64, __int64 *))(**(_QWORD **)(v5 + 80) + 328LL))(
            *(_QWORD *)(v5 + 80),
            v6,
            &v96);
    LOBYTE(v98) = v20;
    v74 = 0LL;
  }
  v79 = v20;
  v23 = IO80211PeerManager::getPeerManagerLogFlags((IO80211PeerManager *)v5);
  if ( !v20 )
  {
    v24 = v76;
    if ( v23 & 0x40000000 && HIDWORD(v98) == 4 )
    {
LABEL_72:
      v26 = "RxDrop: AWDL Parse Error ";
    }
    else
    {
      v25 = IO80211PeerManager::getPeerManagerLogFlags((IO80211PeerManager *)v5);
      if ( !_bittest((const unsigned __int64 *)&v25, 0x2Cu) )
        goto LABEL_86;
      if ( HIDWORD(v98) <= 0xBuLL )
      {
        v26 = "RxDrop: Unknown Peer ";
        switch ( (unsigned __int64)HIDWORD(v98) )
        {
          case 0uLL:
            v26 = "RxDrop: None ";
            goto LABEL_73;
          case 4uLL:
            goto LABEL_72;
          case 1uLL:
            goto LABEL_73;
          case 2uLL:
            v26 = "RxDrop: BAD Peer RSSI ";
            goto LABEL_73;
          case 3uLL:
            v26 = "RxDrop: Duplicate Rx Sequence ";
            goto LABEL_73;
          case 5uLL:
            v26 = "RxDrop: Bad Multicast Address ";
            goto LABEL_73;
          case 6uLL:
            v26 = "RxDrop: Peer Not Added ";
            goto LABEL_73;
          case 7uLL:
            v26 = "RxDrop: After adding ";
            goto LABEL_73;
          case 8uLL:
            v26 = "RxDrop: Not same BSSID ";
            goto LABEL_73;
          case 9uLL:
            v39 = v6;
            v40 = v99;
            bzero(&v105, 0LL);
            a2 = 64LL;
            v41 = v40;
            v6 = v39;
            v24 = v76;
            snprintf(
              &v105,
              0x40uLL,
              "RxDrop: Not Reachable 0x%x ",
              v41,
              v63,
              v64,
              v65,
              v66,
              v67,
              v68,
              v69,
              v70,
              v71,
              v72,
              v73);
            v26 = &v105;
            goto LABEL_73;
          case 0xAuLL:
            v26 = "RxDrop: Peer DataPath Closed ";
            goto LABEL_73;
          case 0xBuLL:
            v26 = "RxDrop: Too short ";
            goto LABEL_73;
          default:
            break;
        }
      }
      v26 = "RxDrop: Unknown Reason ";
    }
LABEL_73:
    v82 = 0;
    v83 = 0;
    v84 = 0;
    v85 = v6;
    v86 = HIDWORD(v102);
    v87 = 0;
    v95 = 0LL;
    v94 = 0LL;
    v93 = 0LL;
    v92 = 0LL;
    v91 = 0LL;
    v90 = 0LL;
    v89 = 0LL;
    v88 = 0LL;
    if ( v24 )
    {
      v87 = 1;
      LODWORD(v88) = 2621441;
      v89 = v24;
      *(_DWORD *)(v24 + 36) = v102;
    }
    if ( v80 )
    {
      v29 = 0;
      if ( v5 )
      {
        if ( !(*(_BYTE *)(v5 + 681) & 8) )
        {
LABEL_82:
          v29 = *(_DWORD *)(v5 + 424);
          if ( !*(_DWORD *)(v5 + 424) )
          {
            a2 = v6;
            v30 = v26;
            v29 = getLengthBeforeSensitivePayload(0, (__mbuf *)v6);
            v26 = v30;
          }
          goto LABEL_84;
        }
        goto LABEL_81;
      }
    }
    else
    {
      v29 = 0;
      if ( v5 )
      {
        if ( !(*(_BYTE *)(v5 + 681) & 2) )
          goto LABEL_82;
LABEL_81:
        v29 = *(_DWORD *)(v5 + 432);
        goto LABEL_84;
      }
    }
LABEL_84:
    v83 = v29;
    goto LABEL_85;
  }
  if ( !v80 )
  {
    if ( !(v23 & 0x20000) )
    {
LABEL_87:
      v78 = v4;
      v31 = (__mbuf *)v6;
      if ( *(_BYTE *)(v8 + 14) == 170 && *(_BYTE *)(v8 + 15) == 170 && *(_BYTE *)(v8 + 16) == 3 )
      {
        v32 = *(_BYTE *)(v8 + 17);
        if ( !v32 && *(_BYTE *)(v8 + 18) == 23 && *(_BYTE *)(v8 + 19) == 242 )
        {
          LODWORD(v33) = mbuf_len(v6);
          if ( v33 <= 0x1B )
          {
            LODWORD(v34) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v5 + 56LL))(v5);
            v35 = OSMetaClass::getClassName(v34);
            v10 = 0;
            a2 = 0x40000000LL;
            IO80211PeerManager::logDebug(
              (IO80211PeerManager *)v5,
              0x40000000LL,
              "%s::%s rx short mbuf -> drop!\n",
              v35,
              (__int64)"inputPacket",
              v36);
            goto LABEL_131;
          }
          v42 = *(_WORD *)(v8 + 26);
          v6 = 16LL;
          if ( v42 & 0xF )
          {
            v43 = v42 & 0xF;
            v44 = 14;
            do
            {
              v44 += *(_BYTE *)(v8 + (unsigned int)(v44 + 15)) + 2;
              --v43;
            }
            while ( v43 );
            v6 = (unsigned int)(v44 + 2);
          }
          LODWORD(v45) = mbuf_len(v31);
          if ( v45 < (unsigned int)v6 )
          {
            LODWORD(v46) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v5 + 56LL))(v5);
            v47 = OSMetaClass::getClassName(v46);
            LODWORD(v48) = mbuf_len(v31);
            v10 = 0;
            a2 = 0x40000000LL;
            IO80211PeerManager::logDebug(
              (IO80211PeerManager *)v5,
              0x40000000LL,
              "%s::%s wrong len %lu hdr_len %u\n",
              v47,
              (__int64)"inputPacket",
              v48);
            goto LABEL_131;
          }
          if ( !(_DWORD)v6 )
            goto LABEL_117;
          goto LABEL_116;
        }
        v37 = __ROL2__(*(_WORD *)(v8 + 12), 8);
        v38 = v32 != 0;
        if ( v37 <= 0x600u && !v38 && !*(_BYTE *)(v8 + 18) )
        {
          v6 = 8LL;
          if ( !*(_BYTE *)(v8 + 19) )
          {
LABEL_116:
            memmove((void *)(v8 + (unsigned int)v6), (const void *)v8, 0xCuLL);
            a2 = (unsigned int)v6;
            mbuf_adj(v31, (unsigned int)v6);
            goto LABEL_117;
          }
        }
      }
LABEL_117:
      if ( *(_DWORD *)(v5 + 484) )
      {
        v49 = 0;
        v50 = v31;
        if ( v31 )
        {
          do
          {
            v49 += mbuf_len(v50);
            LODWORD(v51) = mbuf_next(v50, a2);
            v50 = v51;
          }
          while ( v51 );
          v50 = v31;
        }
        LODWORD(v52) = mbuf_pkthdr_len(v50);
        v31 = v50;
        v6 = v49;
        if ( v52 != v49 )
        {
          LODWORD(v53) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v5 + 56LL))(v5, a2);
          v54 = OSMetaClass::getClassName(v53);
          v55 = mbuf_pkthdr_len(v31);
          IO80211PeerManager::logDebug(
            (IO80211PeerManager *)v5,
            "%s::%s incorrect mbuf len -> fixing. Got %u is %u\n",
            v54,
            (__int64)"inputPacket",
            (unsigned int)v55,
            v49);
          v82 = 0;
          v83 = 0;
          v84 = 0;
          v85 = (__int64)v31;
          v86 = 0;
          v87 = 0;
          v95 = 0LL;
          v94 = 0LL;
          v93 = 0LL;
          v92 = 0LL;
          v91 = 0LL;
          v90 = 0LL;
          v89 = 0LL;
          v88 = 0LL;
          IO80211PeerManager::dumpPacket(
            v5,
            (signed __int64)"%s::%s incorrect mbuf len -> fixing. Got %u is %u\n",
            " Incorrect Length: ",
            (__int64)&v82);
        }
        LODWORD(v56) = mbuf_data(v31);
        mbuf_pkthdr_setheader(v31, v56);
        a2 = v49;
        mbuf_pkthdr_setlen(v31, v49);
      }
      v10 = v79;
      if ( v79 )
      {
        if ( BYTE6(v99) & 0x10 )
        {
          v6 = (signed __int64)v31;
          LODWORD(v57) = mbuf_data(v31);
          v58 = v57;
          memcpy(v57, (const void *)(v5 + 118), 6uLL);
          memcpy((char *)v58 + 6, &v100, 6uLL);
          *(_QWORD *)v78 = 0LL;
          v59 = (IO80211Controller *)IO80211PeerManager::getController((IO80211PeerManager *)v5);
          a2 = (signed __int64)v31;
          IO80211Controller::inputInfraPacket(v59, v31);
        }
        else
        {
          v6 = (signed __int64)v31;
          if ( !*(_DWORD *)(v5 + 668) )
            goto LABEL_136;
          ++*(_DWORD *)(v5 + 672);
          if ( !v74 )
            goto LABEL_133;
          a2 = (signed __int64)v31;
          (*(void (__fastcall **)(__int64, __mbuf *))(*(_QWORD *)v5 + 464LL))(v5, v31);
          *(_QWORD *)v78 = 0LL;
        }
      }
      goto LABEL_130;
    }
LABEL_54:
    memset(&v105, 0, 0x40uLL);
    v27 = "r";
    if ( !((unsigned __int8)(BYTE6(v99) & 0x10) >> 4) )
      v27 = &byte_690F5;
    if ( v76 )
      *(_BYTE *)(v76 + 3);
    a2 = 64LL;
    snprintf(&v105, 0x40uLL, " Rx(%s%s%s) ", v27, v63, v64, v65, v66, v67, v68, v69, v70, v71, v72, v73);
    v82 = 0;
    v83 = 0;
    v84 = 0;
    v85 = v6;
    v86 = HIDWORD(v102);
    v87 = 0;
    v95 = 0LL;
    v94 = 0LL;
    v93 = 0LL;
    v92 = 0LL;
    v91 = 0LL;
    v90 = 0LL;
    v89 = 0LL;
    v88 = 0LL;
    if ( v76 )
    {
      v87 = 1;
      LODWORD(v88) = 2621441;
      v89 = v76;
    }
    if ( v80 )
    {
      v28 = 0;
      if ( v5 )
      {
        if ( !(*(_BYTE *)(v5 + 681) & 8) )
        {
LABEL_67:
          v28 = *(_DWORD *)(v5 + 424);
          if ( !*(_DWORD *)(v5 + 424) )
          {
            a2 = v6;
            v28 = getLengthBeforeSensitivePayload(0, (__mbuf *)v6);
          }
          goto LABEL_69;
        }
        goto LABEL_66;
      }
    }
    else
    {
      v28 = 0;
      if ( v5 )
      {
        if ( !(*(_BYTE *)(v5 + 681) & 2) )
          goto LABEL_67;
LABEL_66:
        v28 = *(_DWORD *)(v5 + 432);
        goto LABEL_69;
      }
    }
LABEL_69:
    v83 = v28;
    v26 = &v105;
LABEL_85:
    IO80211PeerManager::dumpPacket(v5, a2, v26, (__int64)&v82);
    goto LABEL_86;
  }
  if ( BYTE1(v23) & 8 )
    goto LABEL_54;
LABEL_86:
  if ( v79 )
    goto LABEL_87;
LABEL_130:
  v10 = 0;
LABEL_131:
  while ( *(_QWORD *)off_7B078[0] != v106 )
  {
LABEL_133:
    if ( v80 )
    {
      v81 = 0LL;
      a2 = 1LL;
      if ( !mbuf_dup(v6, 1LL, &v81) )
      {
        a2 = v81;
        (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v5 + 464LL))(v5, v81);
      }
    }
LABEL_136:
    v10 &= 1u;
    if ( v10 )
    {
      v61 = IO80211PeerManager::getPeerManagerLogFlags((IO80211PeerManager *)v5);
      v10 = 1;
      if ( _bittest((const unsigned __int64 *)&v61, 0x2Du) )
      {
        v82 = 0;
        v83 = 0;
        v84 = 0;
        v85 = v6;
        v86 = 0;
        v87 = 0;
        v95 = 0LL;
        v94 = 0LL;
        v93 = 0LL;
        v92 = 0LL;
        v91 = 0LL;
        v90 = 0LL;
        v89 = 0LL;
        v88 = 0LL;
        v62 = 0;
        if ( v5 )
        {
          if ( *(_QWORD *)(v5 + 680) & 0x200000000000LL )
          {
            v62 = *(_DWORD *)(v5 + 432);
          }
          else
          {
            v62 = *(_DWORD *)(v5 + 424);
            if ( !*(_DWORD *)(v5 + 424) )
            {
              a2 = v6;
              v62 = getLengthBeforeSensitivePayload(0, (__mbuf *)v6);
            }
          }
        }
        v83 = v62;
        IO80211PeerManager::dumpPacket(v5, a2, " RxUp ", (__int64)&v82);
      }
    }
  }
  return v10 & 1;
}
// 690F5: using guessed type char byte_690F5;
// 7B078: using guessed type __int64 off_7B078[7];
// C7758: using guessed type int __cdecl IORecursiveLockLock(_QWORD);
// C7760: using guessed type int __fastcall IORecursiveLockUnlock(_QWORD, _QWORD);
// C8BE0: using guessed type int __fastcall mbuf_adj(_QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C08: using guessed type int __fastcall mbuf_dup(_QWORD, _QWORD, _QWORD);
// C8C30: using guessed type int __fastcall mbuf_get_traffic_class(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C58: using guessed type int __fastcall mbuf_next(_QWORD, _QWORD);
// C8C68: using guessed type int __fastcall mbuf_pkthdr_len(_QWORD);
// C8C78: using guessed type int __fastcall mbuf_pkthdr_setheader(_QWORD, _QWORD);
// C8C80: using guessed type int __fastcall mbuf_pkthdr_setlen(_QWORD, _QWORD);

//----- (000000000004ACA0) ----------------------------------------------------
signed __int64 __fastcall _doInputPacket(__int64 a1, __int64 a2, __int64 *a3)
{
  __int64 v3; // r15@1
  __int64 v4; // r14@1
  __int64 v5; // rax@1
  int v6; // ecx@1
  signed __int64 result; // rax@1

  v3 = (__int64)a3;
  v4 = *a3;
  LODWORD(v5) = mbuf_data(*a3);
  v6 = memcmp((const void *)(a2 + 32), (const void *)(v5 + 6), 6uLL);
  result = 0LL;
  if ( !v6 )
  {
    *(_BYTE *)(v3 + 16) = (*(int (__fastcall **)(__int64, __int64, __int64))(*(_QWORD *)a2 + 328LL))(a2, v4, v3);
    result = 1LL;
  }
  return result;
}
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);

//----- (000000000004ACFB) ----------------------------------------------------
signed __int64 __fastcall _clearFlushedPacket(__int64 a1, __int64 a2, __int64 a3)
{
  signed __int64 result; // rax@3

  if ( a3 && a2 )
  {
    result = 12LL;
    if ( *(_WORD *)(a2 + 48) & 0x201 )
      result = 0LL;
  }
  else
  {
    result = 1LL;
  }
  return result;
}

//----- (000000000004AD24) ----------------------------------------------------
char __fastcall IO80211PeerManager::actionFrameInput(IO80211PeerManager *this, __mbuf *a2, __int64 a3, void *a4)
{
  return 1;
}

//----- (000000000004AD2C) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::getBufferPoolSize(__int64 a1, unsigned int a2)
{
  return *(_WORD *)(a1 + 2LL * a2 + 544);
}

//----- (000000000004AD3C) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::getBufferPoolSize(IO80211PeerManager *this)
{
  return *((_WORD *)this + 272) + *((_WORD *)this + 273) + *((_WORD *)this + 274) + (unsigned int)*((_WORD *)this + 275);
}

//----- (000000000004AD64) ----------------------------------------------------
int __fastcall IO80211PeerManager::requiresExplicitMBufRelease(IO80211PeerManager *this)
{
  __int64 v1; // rax@1

  v1 = IO80211PeerManager::getController(this);
  return (*(int (__fastcall **)(__int64))(*(_QWORD *)v1 + 3312LL))(v1);
}

//----- (000000000004AD7A) ----------------------------------------------------
signed __int64 __fastcall IO80211PeerManager::getPeerStats(__int64 a1, __int64 a2)
{
  bool v2; // zf@1
  signed __int64 result; // rax@1

  v2 = IO80211CommandQueue::map(
         *(_QWORD *)(a1 + 88),
         (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_getPeerStats,
         a1,
         a2,
         0LL,
         -1) == 0;
  result = 97LL;
  if ( !v2 )
    result = 0LL;
  return result;
}

//----- (000000000004ADB9) ----------------------------------------------------
signed __int64 __fastcall _getPeerStats(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  int v4; // ecx@1
  signed __int64 result; // rax@1

  v3 = a3;
  v4 = memcmp((const void *)(a2 + 32), (const void *)(a3 + 4), 6uLL);
  result = 0LL;
  if ( !v4 )
  {
    IO80211Peer::getStats(a2, v3);
    result = 1LL;
  }
  return result;
}

//----- (000000000004ADF6) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::setHtCapabilityIE(IO80211PeerManager *this, void *a2)
{
  __int64 v2; // r15@1
  signed int v3; // er14@1
  OSMetaClass *v4; // rax@2
  __int64 v5; // rax@2
  __int64 v6; // r9@2
  signed __int64 v7; // rax@3
  __int64 v8; // rax@7
  char *v9; // rbx@8
  signed __int64 v10; // r15@8
  OSMetaClass *v11; // rax@10
  __int64 v12; // rax@10
  __int64 result; // rax@11
  char v14; // [sp+10h] [bp-90h]@8
  __int64 v15; // [sp+70h] [bp-30h]@1

  v2 = off_7B078[0];
  v15 = *(_QWORD *)off_7B078[0];
  v3 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0x9Au, a2);
  if ( v3 )
  {
    LODWORD(v4) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    2150132168LL);
    v5 = OSMetaClass::getClassName(v4);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s  Unable to set ht capabilities ret %x\n",
      v5,
      (__int64)"setHtCapabilityIE",
      (unsigned int)v3,
      v6);
  }
  else
  {
    memcpy((char *)this + 332, (char *)a2 + 4, 0x1CuLL);
    *((_DWORD *)this + 90) = 0;
    v7 = 332LL;
    do
    {
      if ( *((_BYTE *)this + v7) )
        *((_DWORD *)this + 90) = v7 - 331;
      ++v7;
    }
    while ( v7 != 360 );
    v8 = IO80211PeerManager::getPeerManagerLogFlags(this);
    if ( _bittest((const unsigned __int64 *)&v8, 0x25u) )
    {
      v9 = &v14;
      v10 = 332LL;
      do
      {
        snprintf(v9, 3uLL, "%02X ", *((_BYTE *)this + v10++));
        v9 += 3;
      }
      while ( v10 != 360 );
      LODWORD(v11) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
      v12 = OSMetaClass::getClassName(v11);
      IO80211PeerManager::logDebug(
        this,
        0x2000000000LL,
        "%s::%s() set ht capabilities length %u : \n %s \n",
        v12,
        (__int64)"setHtCapabilityIE",
        *((_DWORD *)this + 90));
      v2 = off_7B078[0];
    }
  }
  result = *(_QWORD *)v2;
  if ( *(_QWORD *)v2 == v15 )
    result = (unsigned int)v3;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000004AF74) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::getHtCapabilityIE(IO80211PeerManager *this, void *a2)
{
  __int64 v2; // r15@1
  signed int v3; // er14@1
  OSMetaClass *v4; // rax@2
  __int64 v5; // rax@2
  __int64 v6; // r9@2
  signed __int64 v7; // rax@3
  __int64 v8; // rax@7
  char *v9; // rbx@8
  signed __int64 v10; // r15@8
  OSMetaClass *v11; // rax@10
  __int64 v12; // rax@10
  __int64 result; // rax@12
  char v14; // [sp+10h] [bp-90h]@8
  __int64 v15; // [sp+70h] [bp-30h]@1

  v2 = off_7B078[0];
  v15 = *(_QWORD *)off_7B078[0];
  v3 = IO80211PeerManager::do_ioctl(this, 0xC02869C9, 0x9Au, a2);
  if ( v3 )
  {
    LODWORD(v4) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    3223873993LL);
    v5 = OSMetaClass::getClassName(v4);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s  Unable to get ht capabilities ret %x\n",
      v5,
      (__int64)"getHtCapabilityIE",
      (unsigned int)v3,
      v6);
    *((_DWORD *)this + 90) = 0;
  }
  else
  {
    memcpy((char *)this + 332, (char *)a2 + 4, 0x1CuLL);
    *((_DWORD *)this + 90) = 0;
    v7 = 332LL;
    do
    {
      if ( *((_BYTE *)this + v7) )
        *((_DWORD *)this + 90) = v7 - 331;
      ++v7;
    }
    while ( v7 != 360 );
    v8 = IO80211PeerManager::getPeerManagerLogFlags(this);
    if ( _bittest((const unsigned __int64 *)&v8, 0x25u) )
    {
      v9 = &v14;
      v10 = 332LL;
      do
      {
        snprintf(v9, 3uLL, "%02X ", *((_BYTE *)this + v10++));
        v9 += 3;
      }
      while ( v10 != 360 );
      LODWORD(v11) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
      v12 = OSMetaClass::getClassName(v11);
      IO80211PeerManager::logDebug(
        this,
        0x2000000000LL,
        "%s::%s() got ht capabilities length %u : \n %s \n",
        v12,
        (__int64)"getHtCapabilityIE",
        *((_DWORD *)this + 90));
      v2 = off_7B078[0];
    }
    *((_BYTE *)this + 334) &= 0xEFu;
  }
  result = *(_QWORD *)v2;
  if ( *(_QWORD *)v2 == v15 )
    result = (unsigned int)v3;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000004B106) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::getVHtCapabilityIE(IO80211PeerManager *this, void *a2)
{
  __int64 v2; // r15@1
  signed int v3; // er14@1
  OSMetaClass *v4; // rax@2
  __int64 v5; // rax@2
  __int64 v6; // r9@2
  __int64 v7; // rax@3
  char *v8; // rbx@4
  signed __int64 v9; // r15@4
  OSMetaClass *v10; // rax@6
  __int64 v11; // rax@6
  __int64 result; // rax@7
  char v13; // [sp+10h] [bp-60h]@4
  __int64 v14; // [sp+40h] [bp-30h]@1

  v2 = off_7B078[0];
  v14 = *(_QWORD *)off_7B078[0];
  v3 = IO80211PeerManager::do_ioctl(this, 0xC02869C9, 0xD6u, a2);
  if ( v3 )
  {
    *((_BYTE *)this + 378) = 0;
    LODWORD(v4) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    3223873993LL);
    v5 = OSMetaClass::getClassName(v4);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s  Unable to get vht capabilities ret %x\n",
      v5,
      (__int64)"getVHtCapabilityIE",
      (unsigned int)v3,
      v6);
  }
  else
  {
    *((_BYTE *)this + 378) = 1;
    memcpy((char *)this + 364, (char *)a2 + 4, 0xEuLL);
    v7 = IO80211PeerManager::getPeerManagerLogFlags(this);
    if ( _bittest((const unsigned __int64 *)&v7, 0x25u) )
    {
      v8 = &v13;
      v9 = 364LL;
      do
      {
        snprintf(v8, 3uLL, "%02X ", *((_BYTE *)this + v9++));
        v8 += 3;
      }
      while ( v9 != 378 );
      LODWORD(v10) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
      v11 = OSMetaClass::getClassName(v10);
      IO80211PeerManager::logDebug(
        this,
        0x2000000000LL,
        "%s::%s() got vht capabilities length %u : \n %s \n",
        v11,
        (__int64)"getVHtCapabilityIE",
        14LL);
      v2 = off_7B078[0];
    }
  }
  result = *(_QWORD *)v2;
  if ( *(_QWORD *)v2 == v14 )
    result = (unsigned int)v3;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000004B25C) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::setVHtCapabilityIE(IO80211PeerManager *this, void *a2)
{
  __int64 v2; // rbx@1
  OSMetaClass *v3; // rax@1
  __int64 v4; // rax@1
  __int64 v5; // r8@1
  __int64 v6; // r9@1
  signed int v7; // er14@1
  OSMetaClass *v8; // rax@2
  __int64 v9; // rax@2
  __int64 v10; // r9@2
  __int64 v11; // rax@3
  char *v12; // rbx@4
  signed __int64 v13; // r15@4
  OSMetaClass *v14; // rax@6
  __int64 v15; // rax@6
  __int64 result; // rax@7
  char v17; // [sp+10h] [bp-60h]@4
  __int64 v18; // [sp+40h] [bp-30h]@1

  v2 = off_7B078[0];
  v18 = *(_QWORD *)off_7B078[0];
  LODWORD(v3) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
  v4 = OSMetaClass::getClassName(v3);
  IO80211PeerManager::logDebug(this, "%s::%s \n", v4, (__int64)"setVHtCapabilityIE", v5, v6);
  v7 = IO80211PeerManager::do_ioctl(this, 0x802869C8, 0xD6u, a2);
  if ( v7 )
  {
    LODWORD(v8) = (*(int (__fastcall **)(IO80211PeerManager *, signed __int64))(*(_QWORD *)this + 56LL))(
                    this,
                    2150132168LL);
    v9 = OSMetaClass::getClassName(v8);
    IO80211PeerManager::logDebug(
      this,
      "%s::%s  Unable to set vht capabilities ret %x\n",
      v9,
      (__int64)"setVHtCapabilityIE",
      (unsigned int)v7,
      v10);
  }
  else
  {
    *((_BYTE *)this + 378) = 1;
    memcpy((char *)this + 364, (char *)a2 + 4, 0xEuLL);
    v11 = IO80211PeerManager::getPeerManagerLogFlags(this);
    if ( _bittest((const unsigned __int64 *)&v11, 0x25u) )
    {
      v12 = &v17;
      v13 = 364LL;
      do
      {
        snprintf(v12, 3uLL, "%02X ", *((_BYTE *)this + v13++));
        v12 += 3;
      }
      while ( v13 != 378 );
      LODWORD(v14) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
      v15 = OSMetaClass::getClassName(v14);
      IO80211PeerManager::logDebug(
        this,
        0x2000000000LL,
        "%s::%s() set vht capabilities length %u : \n %s \n",
        v15,
        (__int64)"setVHtCapabilityIE",
        14LL);
      v2 = off_7B078[0];
    }
  }
  result = *(_QWORD *)v2;
  if ( *(_QWORD *)v2 == v18 )
    result = (unsigned int)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000004B3D6) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::postPeerPresence(IO80211PeerManager *this, ether_addr *a2, int a3, int a4, int a5, char *a6)
{
  IO80211VirtualInterface *v6; // rdi@1
  __int64 result; // rax@2

  v6 = (IO80211VirtualInterface *)*((_QWORD *)this + 16);
  if ( v6 )
    result = IO80211VirtualInterface::postPeerPresence(v6, a2, a3, a4, a5, a6);
  return result;
}

//----- (000000000004B3EE) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::getAwdlCtl(IO80211PeerManager *this, __int64 a2)
{
  __int64 v2; // r15@1
  unsigned int v3; // er12@1
  __int64 v4; // rdx@1
  __int64 v5; // rcx@1
  __int64 v6; // r8@1
  __int64 v7; // r9@1
  OSMetaClass *v8; // rax@2
  __int64 v9; // rax@2
  __int64 v10; // rax@5
  size_t v11; // rax@153
  __int64 v12; // r8@153
  __int64 v13; // r9@153
  int v15; // [sp+0h] [bp-90h]@0
  __int64 v16; // [sp+10h] [bp-80h]@5
  __int64 v17; // [sp+18h] [bp-78h]@5
  __int64 v18; // [sp+20h] [bp-70h]@5
  __int64 v19; // [sp+28h] [bp-68h]@5
  __int64 v20; // [sp+30h] [bp-60h]@5
  __int64 v21; // [sp+38h] [bp-58h]@5
  __int64 v22; // [sp+40h] [bp-50h]@5
  __int64 v23; // [sp+48h] [bp-48h]@5
  __int64 v24; // [sp+50h] [bp-40h]@5
  __int64 v25; // [sp+58h] [bp-38h]@5
  __int64 v26; // [sp+60h] [bp-30h]@5

  v2 = a2 + 4;
  v3 = strlen((const char *)(a2 + 4));
  if ( IO80211PeerManager::getPeerManagerLogFlags(this) & 0x20 )
  {
    LODWORD(v8) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
    v9 = OSMetaClass::getClassName(v8);
    v15 = *(_DWORD *)(a2 + 160);
    IO80211PeerManager::logDebug(this, 32LL, "%s::%s <%s> printed %u\n", v9, (__int64)"getAwdlCtl", v2);
  }
  if ( *((_DWORD *)this + 42) )
    IOLog("getAwdlCtl <%s>\n", v2, v4, v5, v6, v7);
  v26 = 0LL;
  v25 = 0LL;
  v24 = 0LL;
  v23 = 0LL;
  v22 = 0LL;
  v21 = 0LL;
  v20 = 0LL;
  v19 = 0LL;
  v18 = 0LL;
  v17 = 0LL;
  v16 = 0LL;
  v10 = *(_QWORD *)(a2 + 152);
  v16 = *(_QWORD *)(a2 + 152);
  v20 = *(_DWORD *)(a2 + 144);
  v21 = *(_DWORD *)(a2 + 160);
  if ( !v3 )
  {
LABEL_37:
    if ( v10 )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"allow_packet_forwarding", *((_DWORD *)this + 167), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 167);
      goto LABEL_156;
    }
    goto LABEL_41;
  }
  if ( !strncmp("allow_packet_forwarding", (const char *)v2, v3) )
  {
    v10 = *(_QWORD *)(a2 + 152);
    goto LABEL_37;
  }
  if ( !strncmp("allow_unknown_peers", (const char *)v2, v3) )
  {
LABEL_41:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"allow_unknown_peers", *((_DWORD *)this + 152), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 152);
      goto LABEL_156;
    }
    goto LABEL_45;
  }
  if ( !strncmp("block_mdns", (const char *)v2, v3) )
  {
LABEL_45:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"block_mdns", *((_DWORD *)this + 123), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 123);
      goto LABEL_156;
    }
    goto LABEL_49;
  }
  if ( !strncmp("do_fc_lock", (const char *)v2, v3) )
  {
LABEL_49:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"do_fc_lock", *((_DWORD *)this + 180), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 180);
      goto LABEL_156;
    }
    goto LABEL_53;
  }
  if ( !strncmp("do_opportunistic_flow_control", (const char *)v2, v3) )
  {
LABEL_53:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint(
        (__int64)&v16,
        "%s = %u\n",
        (__int64)"do_opportunistic_flow_control",
        *((_DWORD *)this + 254),
        v6,
        v7,
        v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 254);
      goto LABEL_156;
    }
    goto LABEL_57;
  }
  if ( !strncmp("enable_cache_update", (const char *)v2, v3) )
  {
LABEL_57:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"enable_cache_update", *((_DWORD *)this + 189), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 189);
      goto LABEL_156;
    }
    goto LABEL_61;
  }
  if ( !strncmp("log_io_to_dumper", (const char *)v2, v3) )
  {
LABEL_61:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"log_io_to_dumper", *((_DWORD *)this + 41), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 41);
      goto LABEL_156;
    }
    goto LABEL_65;
  }
  if ( !strncmp("log_null_mbufs", (const char *)v2, v3) )
  {
LABEL_65:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"log_null_mbufs", *((_DWORD *)this + 119), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 119);
      goto LABEL_156;
    }
    goto LABEL_69;
  }
  if ( !strncmp("lvl1_scans_max_total_dwell_time", (const char *)v2, v3) )
  {
LABEL_69:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint(
        (__int64)&v16,
        "%s = %u\n",
        (__int64)"lvl1_scans_max_total_dwell_time",
        *((_DWORD *)this + 118),
        v6,
        v7,
        v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 118);
      goto LABEL_156;
    }
    goto LABEL_73;
  }
  if ( !strncmp("lvl1_scans_max_dwell_time", (const char *)v2, v3) )
  {
LABEL_73:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"lvl1_scans_max_dwell_time", *((_DWORD *)this + 117), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 117);
      goto LABEL_156;
    }
    goto LABEL_77;
  }
  if ( !strncmp("lvl1_scans_max_num_channel", (const char *)v2, v3) )
  {
LABEL_77:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint(
        (__int64)&v16,
        "%s = %u\n",
        (__int64)"lvl1_scans_max_num_channel",
        *((_DWORD *)this + 116),
        v6,
        v7,
        v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 116);
      goto LABEL_156;
    }
    goto LABEL_81;
  }
  if ( !strncmp("max_num_free_mbuf_header", (const char *)v2, v3) )
  {
LABEL_81:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"max_num_free_mbuf_header", *((_DWORD *)this + 102), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 102);
      goto LABEL_156;
    }
    goto LABEL_85;
  }
  if ( !strncmp("max_packets_in_flight", (const char *)v2, v3) )
  {
LABEL_85:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"max_packets_in_flight", *((_DWORD *)this + 105), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 105);
      goto LABEL_156;
    }
    goto LABEL_89;
  }
  if ( !strncmp("mbuf_header_size", (const char *)v2, v3) )
  {
LABEL_89:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"mbuf_header_size", *((_DWORD *)this + 98), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 98);
      goto LABEL_156;
    }
    goto LABEL_93;
  }
  if ( !strncmp("monitor_timer_period", (const char *)v2, v3) )
  {
LABEL_93:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"monitor_timer_period", *((_DWORD *)this + 172), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 172);
      goto LABEL_156;
    }
    goto LABEL_97;
  }
  if ( !strncmp("run_monitor_timer_always", (const char *)v2, v3) )
  {
LABEL_97:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"run_monitor_timer_always", *((_DWORD *)this + 173), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 173);
      goto LABEL_156;
    }
    goto LABEL_101;
  }
  if ( !strncmp("non_verbose_packet_dump", (const char *)v2, v3) )
  {
LABEL_101:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"non_verbose_packet_dump", *((_DWORD *)this + 106), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 106);
      goto LABEL_156;
    }
    goto LABEL_105;
  }
  if ( !strncmp("verbose_packet_dump", (const char *)v2, v3) )
  {
LABEL_105:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"verbose_packet_dump", *((_DWORD *)this + 108), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 108);
      goto LABEL_156;
    }
    goto LABEL_109;
  }
  if ( !strncmp("peer_round_robin", (const char *)v2, v3) )
  {
LABEL_109:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"peer_round_robin", *((_DWORD *)this + 131), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 131);
      goto LABEL_156;
    }
    goto LABEL_113;
  }
  if ( !strncmp("pkt_tap_debug", (const char *)v2, v3) )
  {
LABEL_113:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"pkt_tap_debug", *((_DWORD *)this + 42), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 42);
      goto LABEL_156;
    }
    goto LABEL_117;
  }
  if ( !strncmp("removeDuplicatesRx", (const char *)v2, v3) )
  {
LABEL_117:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"removeDuplicatesRx", *((_DWORD *)this + 115), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 115);
      goto LABEL_156;
    }
    goto LABEL_121;
  }
  if ( !strncmp("rvi", (const char *)v2, v3) )
  {
LABEL_121:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"rvi", *((_DWORD *)this + 124), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 124);
      goto LABEL_156;
    }
    goto LABEL_125;
  }
  if ( !strncmp("rvi_enable", (const char *)v2, v3) )
  {
LABEL_125:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"rvi_enable", *((_DWORD *)this + 125), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 125);
      goto LABEL_156;
    }
    goto LABEL_129;
  }
  if ( !strncmp("suppress_non_open_packets", (const char *)v2, v3) )
  {
LABEL_129:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"suppress_non_open_packets", *((_DWORD *)this + 232), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 232);
      goto LABEL_156;
    }
    goto LABEL_133;
  }
  if ( !strncmp("uncache_threshold", (const char *)v2, v3) )
  {
LABEL_133:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"uncache_threshold", *((_DWORD *)this + 127), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 127);
      goto LABEL_156;
    }
    goto LABEL_137;
  }
  if ( !strncmp("uncache_packet_threshold", (const char *)v2, v3) )
  {
LABEL_137:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"uncache_packet_threshold", *((_DWORD *)this + 129), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 129);
      goto LABEL_156;
    }
    goto LABEL_141;
  }
  if ( !strncmp("uncache_threshold_fast", (const char *)v2, v3) )
  {
LABEL_141:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"uncache_threshold_fast", *((_DWORD *)this + 128), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 128);
      goto LABEL_156;
    }
    goto LABEL_145;
  }
  if ( !strncmp("unflow_control_threshold", (const char *)v2, v3) )
  {
LABEL_145:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"unflow_control_threshold", *((_DWORD *)this + 135), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 135);
      goto LABEL_156;
    }
    goto LABEL_149;
  }
  if ( !strncmp("verbose_dequeue", (const char *)v2, v3) )
  {
LABEL_149:
    if ( *(_QWORD *)(a2 + 152) )
      _userPrint((__int64)&v16, "%s = %u\n", (__int64)"verbose_dequeue", *((_DWORD *)this + 247), v6, v7, v15);
    if ( v3 )
    {
      *(_QWORD *)(a2 + 136) = *((_DWORD *)this + 247);
      goto LABEL_156;
    }
  }
  v11 = strlen("pkt_tap_name");
  if ( !strncmp("pkt_tap_name", (const char *)v2, v11) && *(_QWORD *)(a2 + 152) )
    _userPrint(
      (__int64)&v16,
      "pkt_tap_name = %s\n",
      (__int64)((char *)this + 172),
      (__int64)"pkt_tap_name = %s\n",
      v12,
      v13,
      v15);
LABEL_156:
  *(_DWORD *)(a2 + 160) += v21;
  return 0LL;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004BFEE) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::setAwdlCtl(IO80211PeerManager *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // r14@1
  IO80211PeerManager *v7; // r15@1
  OSMetaClass *v8; // rax@4
  __int64 v9; // rax@4
  const char *v10; // r12@4
  size_t v11; // rbx@6
  size_t v12; // rax@7
  __int64 v13; // r9@7
  size_t v14; // rbx@8
  size_t v15; // rax@9
  size_t v16; // rbx@10
  size_t v17; // rax@11
  size_t v18; // rbx@12
  size_t v19; // rax@13
  size_t v20; // rbx@14
  size_t v21; // rax@15
  size_t v22; // rbx@16
  size_t v23; // rax@17
  size_t v24; // rbx@18
  size_t v25; // rax@19
  size_t v26; // rbx@20
  size_t v27; // rax@21
  size_t v28; // rbx@22
  size_t v29; // rax@23
  size_t v30; // rbx@24
  size_t v31; // rax@25
  size_t v32; // rbx@26
  size_t v33; // rax@27
  __int64 v34; // rdx@27
  __int64 v35; // r9@27
  size_t v36; // rbx@28
  size_t v37; // rax@29
  size_t v38; // rbx@30
  size_t v39; // rax@31
  size_t v40; // rbx@32
  size_t v41; // rax@33
  size_t v42; // rbx@34
  size_t v43; // rax@35
  size_t v44; // rbx@36
  size_t v45; // rax@37
  size_t v46; // rbx@38
  size_t v47; // rax@39
  size_t v48; // rbx@40
  size_t v49; // rax@41
  size_t v50; // rbx@42
  size_t v51; // rax@43
  signed __int64 v52; // rdi@43
  __int64 v53; // r9@43
  size_t v54; // rbx@44
  size_t v55; // rax@45
  size_t v56; // rbx@46
  size_t v57; // rax@47
  size_t v58; // rbx@48
  size_t v59; // rax@49
  size_t v60; // rbx@50
  size_t v61; // rax@51
  size_t v62; // rbx@52
  size_t v63; // rax@53
  size_t v64; // rbx@54
  size_t v65; // rax@55
  size_t v66; // rbx@56
  size_t v67; // rax@57
  size_t v68; // rbx@58
  size_t v69; // rax@59
  size_t v70; // rbx@60
  size_t v71; // rax@61
  size_t v72; // rbx@62
  size_t v73; // rax@63
  size_t v74; // rbx@64
  size_t v75; // rax@65
  size_t v76; // rax@66
  unsigned __int64 v77; // rsi@66
  size_t v78; // rax@67
  signed int v79; // ebx@67
  size_t v80; // rax@68
  __int64 v81; // rcx@69
  __int64 v82; // r8@69
  char *v83; // rsi@70
  __int64 v84; // rdx@70
  __int64 v85; // rcx@89
  __int64 v86; // r8@89
  IO80211VirtualInterface *v87; // rdi@102
  IO80211Interface *v88; // rdi@104
  __int64 v89; // rcx@113
  __int64 v90; // r8@113
  __int64 v91; // rax@117
  unsigned int v92; // er12@134
  __int64 v93; // r13@136
  int v94; // er12@137
  __int64 v95; // rbx@138
  OSMetaClass *v96; // rax@142
  __int64 v97; // rax@142
  __int64 v98; // r9@142
  OSMetaClass *v99; // rax@143
  __int64 v100; // rax@143
  __int64 v101; // r9@143
  OSMetaClass *v103; // rax@152
  __int64 v104; // rax@152
  __int64 v105; // [sp+0h] [bp-90h]@0
  int v106; // [sp+Ch] [bp-84h]@135
  __int64 v107; // [sp+10h] [bp-80h]@6
  __int64 v108; // [sp+18h] [bp-78h]@6
  __int64 v109; // [sp+20h] [bp-70h]@6
  __int64 v110; // [sp+28h] [bp-68h]@6
  __int64 v111; // [sp+30h] [bp-60h]@6
  __int64 v112; // [sp+38h] [bp-58h]@6
  __int64 v113; // [sp+40h] [bp-50h]@6
  __int64 v114; // [sp+48h] [bp-48h]@6
  __int64 v115; // [sp+50h] [bp-40h]@6
  __int64 v116; // [sp+58h] [bp-38h]@6
  __int64 v117; // [sp+60h] [bp-30h]@6

  v6 = a2;
  v7 = this;
  if ( *((_DWORD *)this + 42) )
    IOLog("setAwdlCtl <%s> %llu\n", a2 + 4, *(_QWORD *)(a2 + 136), a4, a5, a6);
  if ( IO80211PeerManager::getPeerManagerLogFlags(this) & 0x20 )
  {
    LODWORD(v8) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
    v9 = OSMetaClass::getClassName(v8);
    v10 = (const char *)(a2 + 4);
    v105 = *(_QWORD *)(a2 + 136);
    IO80211PeerManager::logDebug(this, 32LL, "%s::%s <%s> %llu\n", v9, (__int64)"setAwdlCtl", a2 + 4);
  }
  else
  {
    v10 = (const char *)(a2 + 4);
  }
  v117 = 0LL;
  v116 = 0LL;
  v115 = 0LL;
  v114 = 0LL;
  v113 = 0LL;
  v112 = 0LL;
  v111 = 0LL;
  v110 = 0LL;
  v109 = 0LL;
  v108 = 0LL;
  v107 = 0LL;
  v107 = *(_QWORD *)(a2 + 152);
  v111 = *(_DWORD *)(a2 + 144);
  v11 = strnlen("allow_packet_forwarding", 0x80uLL);
  if ( v11 == strnlen(v10, 0x80uLL) )
  {
    v12 = strlen("allow_packet_forwarding");
    if ( !strncmp("allow_packet_forwarding", v10, v12) )
    {
      v81 = *((_DWORD *)this + 167);
      v82 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 167) = v82;
      v79 = 0;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_151;
      v83 = "%s : %u -> %u\n";
      v84 = (__int64)"allow_packet_forwarding";
      goto LABEL_150;
    }
  }
  v14 = strnlen("allow_unknown_peers", 0x80uLL);
  if ( v14 == strnlen(v10, 0x80uLL) )
  {
    v15 = strlen("allow_unknown_peers");
    if ( !strncmp("allow_unknown_peers", v10, v15) )
    {
      v81 = *((_DWORD *)this + 152);
      v82 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 152) = v82;
      v79 = 0;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_151;
      v83 = "%s : %u -> %u\n";
      v84 = (__int64)"allow_unknown_peers";
      goto LABEL_150;
    }
  }
  v16 = strnlen("block_mdns", 0x80uLL);
  if ( v16 == strnlen(v10, 0x80uLL) )
  {
    v17 = strlen("block_mdns");
    if ( !strncmp("block_mdns", v10, v17) )
    {
      v81 = *((_DWORD *)this + 123);
      v82 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 123) = v82;
      v79 = 0;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_151;
      v83 = "%s : %u -> %u\n";
      v84 = (__int64)"block_mdns";
      goto LABEL_150;
    }
  }
  v18 = strnlen("enable_cache_update", 0x80uLL);
  if ( v18 == strnlen(v10, 0x80uLL) )
  {
    v19 = strlen("enable_cache_update");
    if ( !strncmp("enable_cache_update", v10, v19) )
    {
      v81 = *((_DWORD *)this + 189);
      v82 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 189) = v82;
      v79 = 0;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_151;
      v83 = "%s : %u -> %u\n";
      v84 = (__int64)"enable_cache_update";
      goto LABEL_150;
    }
  }
  v20 = strnlen("do_fc_lock", 0x80uLL);
  if ( v20 == strnlen(v10, 0x80uLL) )
  {
    v21 = strlen("do_fc_lock");
    if ( !strncmp("do_fc_lock", v10, v21) )
    {
      v81 = *((_DWORD *)this + 180);
      v82 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 180) = v82;
      v79 = 0;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_151;
      v83 = "%s : %u -> %u\n";
      v84 = (__int64)"do_fc_lock";
      goto LABEL_150;
    }
  }
  v22 = strnlen("do_opportunistic_flow_control", 0x80uLL);
  if ( v22 == strnlen(v10, 0x80uLL) )
  {
    v23 = strlen("do_opportunistic_flow_control");
    if ( !strncmp("do_opportunistic_flow_control", v10, v23) )
    {
      v81 = *((_DWORD *)this + 254);
      v82 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 254) = v82;
      v79 = 0;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_151;
      v83 = "%s : %u -> %u\n";
      v84 = (__int64)"do_opportunistic_flow_control";
      goto LABEL_150;
    }
  }
  v24 = strnlen("dump_packet_queues", 0x80uLL);
  if ( v24 == strnlen(v10, 0x80uLL) )
  {
    v25 = strlen("dump_packet_queues");
    if ( !strncmp("dump_packet_queues", v10, v25) )
    {
      v81 = *((_DWORD *)this + 141);
      v82 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 141) = v82;
      v79 = 0;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_151;
      v83 = "%s : %u -> %u\n";
      v84 = (__int64)"dump_packet_queues";
      goto LABEL_150;
    }
  }
  v26 = strnlen("lvl1_scans_max_dwell_time", 0x80uLL);
  if ( v26 == strnlen(v10, 0x80uLL) )
  {
    v27 = strlen("lvl1_scans_max_dwell_time");
    if ( !strncmp("lvl1_scans_max_dwell_time", v10, v27) )
    {
      v81 = *((_DWORD *)this + 117);
      v82 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 117) = v82;
      v79 = 0;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_151;
      v83 = "%s : %u -> %u\n";
      v84 = (__int64)"lvl1_scans_max_dwell_time";
      goto LABEL_150;
    }
  }
  v28 = strnlen("lvl1_scans_max_num_channel", 0x80uLL);
  if ( v28 == strnlen(v10, 0x80uLL) )
  {
    v29 = strlen("lvl1_scans_max_num_channel");
    if ( !strncmp("lvl1_scans_max_num_channel", v10, v29) )
    {
      v81 = *((_DWORD *)this + 116);
      v82 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 116) = v82;
      v79 = 0;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_151;
      v83 = "%s : %u -> %u\n";
      v84 = (__int64)"lvl1_scans_max_num_channel";
      goto LABEL_150;
    }
  }
  v30 = strnlen("lvl1_scans_max_total_dwell_time", 0x80uLL);
  if ( v30 == strnlen(v10, 0x80uLL) )
  {
    v31 = strlen("lvl1_scans_max_total_dwell_time");
    if ( !strncmp("lvl1_scans_max_total_dwell_time", v10, v31) )
    {
      v81 = *((_DWORD *)this + 118);
      v82 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 118) = v82;
      v79 = 0;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_151;
      v83 = "%s : %u -> %u\n";
      v84 = (__int64)"lvl1_scans_max_total_dwell_time";
      goto LABEL_150;
    }
  }
  v32 = strnlen("log_io_to_dumper", 0x80uLL);
  if ( v32 != strnlen(v10, 0x80uLL) || (v33 = strlen("log_io_to_dumper"), strncmp("log_io_to_dumper", v10, v33)) )
  {
    v36 = strnlen("log_null_mbufs", 0x80uLL);
    if ( v36 == strnlen(v10, 0x80uLL) && (v37 = strlen("log_null_mbufs"), !strncmp("log_null_mbufs", v10, v37)) )
    {
      v81 = *((_DWORD *)this + 119);
      v82 = *(_DWORD *)(a2 + 136);
      *((_DWORD *)this + 119) = v82;
      v79 = 0;
      if ( !*(_QWORD *)(a2 + 152) )
        goto LABEL_151;
      v83 = "%s : %u -> %u\n";
      v84 = (__int64)"log_null_mbufs";
    }
    else
    {
      v38 = strnlen("monitor_timer_period", 0x80uLL);
      if ( v38 == strnlen(v10, 0x80uLL)
        && (v39 = strlen("monitor_timer_period"), !strncmp("monitor_timer_period", v10, v39)) )
      {
        v81 = *((_DWORD *)this + 172);
        v82 = *(_DWORD *)(a2 + 136);
        *((_DWORD *)this + 172) = v82;
        v79 = 0;
        if ( !*(_QWORD *)(a2 + 152) )
          goto LABEL_151;
        v83 = "%s : %u -> %u\n";
        v84 = (__int64)"monitor_timer_period";
      }
      else
      {
        v40 = strnlen("run_monitor_timer_always", 0x80uLL);
        if ( v40 == strnlen(v10, 0x80uLL)
          && (v41 = strlen("run_monitor_timer_always"), !strncmp("run_monitor_timer_always", v10, v41)) )
        {
          v81 = *((_DWORD *)this + 173);
          v82 = *(_DWORD *)(a2 + 136);
          *((_DWORD *)this + 173) = v82;
          v79 = 0;
          if ( !*(_QWORD *)(a2 + 152) )
            goto LABEL_151;
          v83 = "%s : %u -> %u\n";
          v84 = (__int64)"run_monitor_timer_always";
        }
        else
        {
          v42 = strnlen("max_packets_in_flight", 0x80uLL);
          if ( v42 == strnlen(v10, 0x80uLL)
            && (v43 = strlen("max_packets_in_flight"), !strncmp("max_packets_in_flight", v10, v43)) )
          {
            v81 = *((_DWORD *)this + 105);
            v82 = *(_DWORD *)(a2 + 136);
            *((_DWORD *)this + 105) = v82;
            v79 = 0;
            if ( !*(_QWORD *)(a2 + 152) )
              goto LABEL_151;
            v83 = "%s : %u -> %u\n";
            v84 = (__int64)"max_packets_in_flight";
          }
          else
          {
            v44 = strnlen("non_verbose_packet_dump", 0x80uLL);
            if ( v44 == strnlen(v10, 0x80uLL)
              && (v45 = strlen("non_verbose_packet_dump"), !strncmp("non_verbose_packet_dump", v10, v45)) )
            {
              v81 = *((_DWORD *)this + 106);
              v82 = *(_DWORD *)(a2 + 136);
              *((_DWORD *)this + 106) = v82;
              v79 = 0;
              if ( !*(_QWORD *)(a2 + 152) )
                goto LABEL_151;
              v83 = "%s : %u -> %u\n";
              v84 = (__int64)"non_verbose_packet_dump";
            }
            else
            {
              v46 = strnlen("verbose_packet_dump", 0x80uLL);
              if ( v46 == strnlen(v10, 0x80uLL)
                && (v47 = strlen("verbose_packet_dump"), !strncmp("verbose_packet_dump", v10, v47)) )
              {
                v81 = *((_DWORD *)this + 108);
                v82 = *(_DWORD *)(a2 + 136);
                *((_DWORD *)this + 108) = v82;
                v79 = 0;
                if ( !*(_QWORD *)(a2 + 152) )
                  goto LABEL_151;
                v83 = "%s : %u -> %u\n";
                v84 = (__int64)"verbose_packet_dump";
              }
              else
              {
                v48 = strnlen("max_num_free_mbuf_header", 0x80uLL);
                if ( v48 == strnlen(v10, 0x80uLL)
                  && (v49 = strlen("max_num_free_mbuf_header"), !strncmp("max_num_free_mbuf_header", v10, v49)) )
                {
                  v81 = *((_DWORD *)this + 102);
                  v82 = *(_DWORD *)(a2 + 136);
                  *((_DWORD *)this + 102) = v82;
                  v79 = 0;
                  if ( !*(_QWORD *)(a2 + 152) )
                    goto LABEL_151;
                  v83 = "%s : %u -> %u\n";
                  v84 = (__int64)"max_num_free_mbuf_header";
                }
                else
                {
                  v50 = strnlen("mbuf_header_size", 0x80uLL);
                  if ( v50 == strnlen(v10, 0x80uLL) )
                  {
                    v51 = strlen("mbuf_header_size");
                    v52 = (signed __int64)"mbuf_header_size";
                    if ( !strncmp("mbuf_header_size", v10, v51) )
                    {
                      v89 = *((_DWORD *)v7 + 98);
                      v90 = *(_DWORD *)(a2 + 136);
                      *((_DWORD *)v7 + 98) = v90;
                      v79 = 0;
                      if ( *(_QWORD *)(a2 + 152) )
                      {
                        v79 = 0;
                        v52 = (signed __int64)&v107;
                        _userPrint((__int64)&v107, "%s : %u -> %u\n", (__int64)"mbuf_header_size", v89, v90, v53, v105);
                      }
LABEL_115:
                      if ( *((_DWORD *)v7 + 98) && !*((_QWORD *)v7 + 48) )
                      {
                        LODWORD(v91) = IOSimpleLockAlloc(v52);
                        *((_QWORD *)v7 + 48) = v91;
                        IOSimpleLockInit(v91);
                      }
                      goto LABEL_151;
                    }
                  }
                  v54 = strnlen("peer_round_robin", 0x80uLL);
                  if ( v54 == strnlen(v10, 0x80uLL)
                    && (v55 = strlen("peer_round_robin"), !strncmp("peer_round_robin", v10, v55)) )
                  {
                    v81 = *((_DWORD *)v7 + 131);
                    v82 = *(_DWORD *)(a2 + 136);
                    *((_DWORD *)v7 + 131) = v82;
                    v79 = 0;
                    if ( !*(_QWORD *)(a2 + 152) )
                      goto LABEL_151;
                    v83 = "%s : %u -> %u\n";
                    v84 = (__int64)"peer_round_robin";
                  }
                  else
                  {
                    v56 = strnlen("pkt_tap_debug", 0x80uLL);
                    if ( v56 == strnlen(v10, 0x80uLL)
                      && (v57 = strlen("pkt_tap_debug"), !strncmp("pkt_tap_debug", v10, v57)) )
                    {
                      v81 = *((_DWORD *)v7 + 42);
                      v82 = *(_DWORD *)(a2 + 136);
                      *((_DWORD *)v7 + 42) = v82;
                      v79 = 0;
                      if ( !*(_QWORD *)(a2 + 152) )
                        goto LABEL_151;
                      v83 = "%s : %u -> %u\n";
                      v84 = (__int64)"pkt_tap_debug";
                    }
                    else
                    {
                      v58 = strnlen("removeDuplicatesRx", 0x80uLL);
                      if ( v58 == strnlen(v10, 0x80uLL)
                        && (v59 = strlen("removeDuplicatesRx"), !strncmp("removeDuplicatesRx", v10, v59)) )
                      {
                        v81 = *((_DWORD *)v7 + 115);
                        v82 = *(_DWORD *)(a2 + 136);
                        *((_DWORD *)v7 + 115) = v82;
                        v79 = 0;
                        if ( !*(_QWORD *)(a2 + 152) )
                          goto LABEL_151;
                        v83 = "%s : %u -> %u\n";
                        v84 = (__int64)"removeDuplicatesRx";
                      }
                      else
                      {
                        v60 = strnlen("suppress_non_open_packets", 0x80uLL);
                        if ( v60 == strnlen(v10, 0x80uLL)
                          && (v61 = strlen("suppress_non_open_packets"), !strncmp("suppress_non_open_packets", v10, v61)) )
                        {
                          v81 = *((_DWORD *)v7 + 232);
                          v82 = *(_DWORD *)(a2 + 136);
                          *((_DWORD *)v7 + 232) = v82;
                          v79 = 0;
                          if ( !*(_QWORD *)(a2 + 152) )
                            goto LABEL_151;
                          v83 = "%s : %u -> %u\n";
                          v84 = (__int64)"suppress_non_open_packets";
                        }
                        else
                        {
                          v62 = strnlen("rvi", 0x80uLL);
                          if ( v62 == strnlen(v10, 0x80uLL) && (v63 = strlen("rvi"), !strncmp("rvi", v10, v63)) )
                          {
                            v81 = *((_DWORD *)v7 + 124);
                            v82 = *(_DWORD *)(a2 + 136);
                            *((_DWORD *)v7 + 124) = v82;
                            v79 = 0;
                            if ( !*(_QWORD *)(a2 + 152) )
                              goto LABEL_151;
                            v83 = "%s : %u -> %u\n";
                            v84 = (__int64)"rvi";
                          }
                          else
                          {
                            v64 = strnlen("uncache_threshold", 0x80uLL);
                            if ( v64 == strnlen(v10, 0x80uLL)
                              && (v65 = strlen("uncache_threshold"), !strncmp("uncache_threshold", v10, v65)) )
                            {
                              v81 = *((_DWORD *)v7 + 127);
                              v82 = *(_DWORD *)(a2 + 136);
                              *((_DWORD *)v7 + 127) = v82;
                              v79 = 0;
                              if ( !*(_QWORD *)(a2 + 152) )
                                goto LABEL_151;
                              v83 = "%s : %u -> %u\n";
                              v84 = (__int64)"uncache_threshold";
                            }
                            else
                            {
                              v66 = strnlen("uncache_packet_threshold", 0x80uLL);
                              if ( v66 == strnlen(v10, 0x80uLL) )
                              {
                                v67 = strlen("uncache_packet_threshold");
                                if ( !strncmp("uncache_packet_threshold", v10, v67) )
                                  goto LABEL_155;
                              }
                              v68 = strnlen("uncache_threshold_fast", 0x80uLL);
                              if ( v68 == strnlen(v10, 0x80uLL) )
                              {
                                v69 = strlen("uncache_threshold_fast");
                                if ( !strncmp("uncache_threshold_fast", v10, v69) )
                                {
                                  v81 = *((_DWORD *)v7 + 128);
                                  v82 = *(_DWORD *)(a2 + 136);
                                  *((_DWORD *)v7 + 128) = v82;
                                  v79 = 0;
                                  if ( !*(_QWORD *)(a2 + 152) )
                                    goto LABEL_151;
                                  v83 = "%s : %u -> %u\n";
                                  v84 = (__int64)"uncache_threshold_fast";
                                  goto LABEL_150;
                                }
                              }
                              v70 = strnlen("uncache_packet_threshold", 0x80uLL);
                              if ( v70 == strnlen(v10, 0x80uLL)
                                && (v71 = strlen("uncache_packet_threshold"),
                                    !strncmp("uncache_packet_threshold", v10, v71)) )
                              {
LABEL_155:
                                v81 = *((_DWORD *)v7 + 129);
                                v82 = *(_DWORD *)(a2 + 136);
                                *((_DWORD *)v7 + 129) = v82;
                                v79 = 0;
                                if ( !*(_QWORD *)(a2 + 152) )
                                  goto LABEL_151;
                                v83 = "%s : %u -> %u\n";
                                v84 = (__int64)"uncache_packet_threshold";
                              }
                              else
                              {
                                v72 = strnlen("unflow_control_threshold", 0x80uLL);
                                if ( v72 == strnlen(v10, 0x80uLL)
                                  && (v73 = strlen("unflow_control_threshold"),
                                      !strncmp("unflow_control_threshold", v10, v73)) )
                                {
                                  v81 = *((_DWORD *)v7 + 135);
                                  v82 = *(_DWORD *)(a2 + 136);
                                  *((_DWORD *)v7 + 135) = v82;
                                  v79 = 0;
                                  if ( !*(_QWORD *)(a2 + 152) )
                                    goto LABEL_151;
                                  v83 = "%s : %u -> %u\n";
                                  v84 = (__int64)"unflow_control_threshold";
                                }
                                else
                                {
                                  v74 = strnlen("verbose_dequeue", 0x80uLL);
                                  if ( v74 != strnlen(v10, 0x80uLL)
                                    || (v75 = strlen("verbose_dequeue"), strncmp("verbose_dequeue", v10, v75)) )
                                  {
                                    v76 = strlen("packet_descriptor_pool_size");
                                    v52 = (signed __int64)"packet_descriptor_pool_size";
                                    v77 = (unsigned __int64)v10;
                                    if ( !strncmp("packet_descriptor_pool_size", v10, v76) )
                                    {
                                      v92 = *(_DWORD *)(v6 + 136);
                                      if ( (v92 & 0x80000000) != 0 )
                                      {
                                        LODWORD(v103) = (*(int (__fastcall **)(IO80211PeerManager *, unsigned __int64))(*(_QWORD *)v7 + 56LL))(
                                                          v7,
                                                          v77);
                                        v104 = OSMetaClass::getClassName(v103);
                                        v79 = 0;
                                        v52 = (signed __int64)v7;
                                        IO80211PeerManager::logDebug(
                                          v7,
                                          "%s::%s cannot reduce pool, size %u v %d\n",
                                          v104,
                                          (__int64)"setAwdlCtl",
                                          *((_WORD *)v7 + 272),
                                          v92);
                                      }
                                      else
                                      {
                                        v79 = 0;
                                        v106 = *(_DWORD *)(v6 + 136);
                                        if ( (signed int)v92 > 0 )
                                        {
                                          v93 = 0LL;
                                          do
                                          {
                                            v94 = 0;
                                            while ( 1 )
                                            {
                                              v95 = OSObject::operator new((OSObject *)&stru_20.maxprot, v77);
                                              IO80211PacketDescriptor::IO80211PacketDescriptor(v95);
                                              if ( !v95 )
                                              {
                                                LODWORD(v96) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)v7 + 56LL))(v7);
                                                v97 = OSMetaClass::getClassName(v96);
                                                v52 = (signed __int64)v7;
                                                v77 = (unsigned __int64)"%s::%s cannot init pkt descriptor %p\n";
                                                IO80211PeerManager::logDebug(
                                                  v7,
                                                  "%s::%s cannot init pkt descriptor %p\n",
                                                  v97,
                                                  (__int64)"setAwdlCtl",
                                                  0LL,
                                                  v98);
                                                goto LABEL_144;
                                              }
                                              if ( !(unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v95 + 296LL))(
                                                                       v95,
                                                                       (unsigned __int8)v93) )
                                                break;
                                              (*(void (__fastcall **)(__int64))(*(_QWORD *)v95 + 32LL))(v95);
                                              v52 = *((_QWORD *)v7 + v93 + 4);
                                              ++*(_DWORD *)(v52 + 48);
                                              v77 = v95;
                                              IO80211CommandQueue::lockEnqueue(
                                                (IO80211CommandQueue *)v52,
                                                (IO80211QueueDescriptor *)v95);
                                              ++*((_WORD *)v7 + v93 + 272);
                                              ++v94;
                                              if ( v94 >= v106 )
                                                goto LABEL_144;
                                            }
                                            LODWORD(v99) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)v7 + 56LL))(v7);
                                            v100 = OSMetaClass::getClassName(v99);
                                            v77 = (unsigned __int64)"%s::%s cannot init pkt descriptor %p\n";
                                            IO80211PeerManager::logDebug(
                                              v7,
                                              "%s::%s cannot init pkt descriptor %p\n",
                                              v100,
                                              (__int64)"setAwdlCtl",
                                              v95,
                                              v101);
                                            v52 = v95;
                                            (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v95 + 40LL))(
                                              v95,
                                              "%s::%s cannot init pkt descriptor %p\n");
LABEL_144:
                                            ++v93;
                                            v79 = 0;
                                          }
                                          while ( v93 != 4 );
                                        }
                                      }
                                    }
                                    else
                                    {
                                      v78 = strlen("pkt_tap_name=");
                                      v52 = (signed __int64)"pkt_tap_name=";
                                      v79 = 22;
                                      if ( !strncmp("pkt_tap_name=", v10, v78) )
                                      {
                                        bzero((char *)v7 + 172, 0x20uLL);
                                        v80 = strlen("pkt_tap_name=");
                                        v52 = (signed __int64)((char *)v7 + 172);
                                        strlcpy((char *)v7 + 172, (const char *)(v6 + v80 + 4), 0x20uLL);
                                        v79 = 0;
                                      }
                                    }
                                    goto LABEL_115;
                                  }
                                  v81 = *((_DWORD *)v7 + 247);
                                  v82 = *(_DWORD *)(a2 + 136);
                                  *((_DWORD *)v7 + 247) = v82;
                                  v79 = 0;
                                  if ( !*(_QWORD *)(a2 + 152) )
                                    goto LABEL_151;
                                  v83 = "%s : %u -> %u\n";
                                  v84 = (__int64)"verbose_dequeue";
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
LABEL_150:
    v79 = 0;
    _userPrint((__int64)&v107, v83, v84, v81, v82, v13, v105);
    goto LABEL_151;
  }
  v85 = *((_DWORD *)this + 41);
  v86 = *(_DWORD *)(a2 + 136);
  *((_DWORD *)this + 41) = v86;
  if ( *(_QWORD *)(a2 + 152) )
  {
    _userPrint((__int64)&v107, "%s : %u -> %u\n", (__int64)"log_io_to_dumper", v85, v86, v35, v105);
    v86 = *((_DWORD *)this + 41);
  }
  if ( (_DWORD)v86 )
  {
    *((_DWORD *)this + 126) = 1;
    v79 = 0;
    IO80211PeerManager::logDebug(this, "Logging started....\n", v34, v85, v86, v35);
  }
  else
  {
    v79 = 0;
    if ( !*((_DWORD *)this + 125) )
    {
      v87 = (IO80211VirtualInterface *)*((_QWORD *)this + 16);
      if ( v87 )
        IO80211VirtualInterface::setDebugFlags(v87, 0LL);
      v88 = (IO80211Interface *)*((_QWORD *)v7 + 17);
      if ( v88 )
        IO80211Interface::setDebugFlags(v88, 0LL);
      *((_QWORD *)v7 + 85) = 0LL;
      *((_DWORD *)v7 + 126) = 0;
    }
  }
LABEL_151:
  *(_DWORD *)(v6 + 160) += v112;
  return (unsigned int)v79;
}
// 20: using guessed type segment_command_64 stru_20;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7768: using guessed type int __fastcall IOSimpleLockAlloc(_QWORD);
// C7778: using guessed type int __fastcall IOSimpleLockInit(_QWORD);

//----- (000000000004D2BA) ----------------------------------------------------
char __fastcall IO80211PeerManager::isInfraRedirectSupported(IO80211PeerManager *this)
{
  return *(_BYTE *)(IO80211PeerManager::getController(this) + 312);
}

//----- (000000000004D2CC) ----------------------------------------------------
int __fastcall IO80211PeerManager::printPeers(IO80211PeerManager *this, __int64 a2, int a3)
{
  IO80211PeerManager *v3; // rbx@1
  __int64 v4; // rdi@1
  int result; // eax@2
  __int64 v6; // rdi@3
  __int64 v7; // rdi@5
  __int64 v8; // [sp+0h] [bp-60h]@1
  __int64 v9; // [sp+8h] [bp-58h]@1
  __int64 v10; // [sp+10h] [bp-50h]@1
  __int64 v11; // [sp+18h] [bp-48h]@1
  __int64 v12; // [sp+20h] [bp-40h]@1
  __int64 v13; // [sp+28h] [bp-38h]@1
  __int64 v14; // [sp+30h] [bp-30h]@1
  __int64 v15; // [sp+38h] [bp-28h]@1
  __int64 v16; // [sp+40h] [bp-20h]@1
  __int64 v17; // [sp+48h] [bp-18h]@1
  __int64 v18; // [sp+50h] [bp-10h]@1

  v3 = this;
  v18 = 0LL;
  v17 = 0LL;
  v16 = 0LL;
  v15 = 0LL;
  v14 = 0LL;
  v13 = 0LL;
  v12 = 0LL;
  v11 = 0LL;
  v10 = 0LL;
  v9 = 0LL;
  v8 = 0LL;
  HIDWORD(v14) = a3;
  v4 = *((_QWORD *)this + 9);
  if ( v4 )
    result = (*(int (__fastcall **)(__int64, __int64 *))(*(_QWORD *)v4 + 280LL))(v4, &v8);
  v6 = *((_QWORD *)v3 + 10);
  if ( v6 )
    result = (*(int (__fastcall **)(__int64, __int64 *))(*(_QWORD *)v6 + 280LL))(v6, &v8);
  v7 = *((_QWORD *)v3 + 11);
  if ( v7 )
    result = IO80211CommandQueue::print(v7, (__int64)&v8);
  return result;
}

//----- (000000000004D378) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::printDataPath(IO80211PeerManager *this, __int64 a2)
{
  IO80211PeerManager *v2; // rbx@1
  __int64 v3; // r14@1
  __int64 v4; // r14@1
  __int64 v5; // r14@1
  __int64 v6; // rax@1
  __int64 v7; // rax@1
  signed __int128 v8; // t2@1
  __int64 v9; // r13@1
  IO80211VirtualInterface *v10; // rdi@1
  char *v11; // rax@2
  IO80211Interface *v12; // rdi@3
  __int64 v13; // rdx@5
  int v14; // ST38_4@6
  int v15; // ST30_4@6
  int v16; // ST28_4@6
  int v17; // ST20_4@6
  int v18; // ST18_4@6
  int v19; // ST10_4@6
  int v20; // ST08_4@6
  int v21; // ST50_4@6
  int v22; // ST48_4@6
  int v23; // ST40_4@6
  int v24; // ST38_4@6
  int v25; // ST30_4@6
  int v26; // ST28_4@6
  int v27; // ST20_4@6
  int v28; // ST18_4@6
  int v29; // ST10_4@6
  int v30; // ST10_4@6
  int v31; // ST08_4@6
  __int64 v32; // rdx@7
  __int64 v33; // rcx@7
  __int64 v34; // r8@7
  __int64 v35; // r9@7
  unsigned int v36; // ST60_4@9
  unsigned int v37; // er13@9
  unsigned int v38; // ST58_4@9
  __int64 v39; // r14@9
  unsigned __int64 v40; // r14@9
  __int64 v41; // r15@9
  __int64 v42; // rax@9
  int v43; // ST10_4@9
  int v44; // ST08_4@9
  __int64 v45; // rsi@9
  __int64 v46; // rdx@9
  __int64 v47; // rcx@9
  __int64 v48; // r8@9
  __int64 v49; // r9@9
  IO80211VirtualInterface *v50; // rdi@9
  __int64 v51; // rax@10
  int v52; // er14@10
  unsigned __int8 v53; // al@10
  __int64 v54; // rdi@11
  __int64 v55; // rax@12
  int v56; // eax@12
  __int64 v57; // r14@12
  __int64 v58; // r12@12
  int v59; // ST38_4@12
  int v60; // ST30_4@12
  int v61; // ST28_4@12
  int v62; // ST20_4@12
  int v63; // ST10_4@12
  __int64 v64; // r14@14
  __int64 v65; // rax@14
  __int64 v66; // r8@14
  __int64 v67; // r9@14
  __int64 v68; // rdx@14
  __int64 v69; // rcx@14
  __int64 v70; // r8@14
  __int64 v71; // r9@14
  __int64 v72; // rdi@16
  int v73; // er15@16
  __int64 v74; // rdi@19
  __int64 v75; // rdi@22
  char v77; // [sp+0h] [bp-A0h]@6
  char v78; // [sp+0h] [bp-A0h]@9
  char v79; // [sp+0h] [bp-A0h]@14
  unsigned __int64 v80; // [sp+58h] [bp-48h]@1
  unsigned __int64 v81; // [sp+60h] [bp-40h]@1
  __int64 v82; // [sp+68h] [bp-38h]@1
  unsigned int v83; // [sp+70h] [bp-30h]@12
  unsigned int v84; // [sp+74h] [bp-2Ch]@10

  v82 = a2;
  v2 = this;
  v3 = *((_QWORD *)this + 124);
  v81 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v3)) >> 64) >> 18;
  v4 = *((_QWORD *)this + 125);
  v80 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v4)) >> 64) >> 18;
  v5 = *((_QWORD *)this + 126);
  v6 = getAbsoluteTime();
  v8 = 4835703278458516699LL * (v6 - v5);
  v7 = 4835703278458516699LL * (v6 - v5);
  v9 = *((_QWORD *)&v8 + 1) >> 18;
  v10 = (IO80211VirtualInterface *)*((_QWORD *)this + 16);
  if ( v10 )
  {
    v11 = IO80211VirtualInterface::getBSDName(v10);
  }
  else
  {
    v12 = (IO80211Interface *)*((_QWORD *)v2 + 17);
    if ( !v12 )
    {
      v13 = (__int64)"unknown";
      goto LABEL_6;
    }
    v11 = IO80211Interface::getBSDName(v12, v7);
  }
  v13 = (__int64)v11;
LABEL_6:
  v14 = *((_DWORD *)v2 + 241);
  v15 = *((_DWORD *)v2 + 245);
  v16 = *((_DWORD *)v2 + 195);
  v17 = *((_DWORD *)v2 + 196);
  v18 = *((_DWORD *)v2 + 243);
  v19 = *((_DWORD *)v2 + 244);
  v20 = *((_DWORD *)v2 + 194);
  _userPrint(
    a2,
    "<%s> output: U%u (TxReported %u) M%u (TXReported %u) totalout %u, free'd: %u/%u input: U%u M%u\n   noack %u dropped %u\n",
    v13,
    *((_DWORD *)v2 + 203),
    *((_DWORD *)v2 + 192),
    *((_DWORD *)v2 + 202),
    *((_DWORD *)v2 + 193));
  v21 = *((_DWORD *)v2 + 188);
  v22 = *(_DWORD *)(*((_QWORD *)v2 + 93) + 52LL);
  v23 = *((_DWORD *)v2 + 113);
  v24 = *((_DWORD *)v2 + 112);
  v25 = *(_DWORD *)(*((_QWORD *)v2 + 92) + 52LL);
  v26 = *((_DWORD *)v2 + 104);
  v27 = *((_DWORD *)v2 + 103);
  v28 = *((_DWORD *)v2 + 101);
  v29 = *((_DWORD *)v2 + 162);
  _userPrint(
    a2,
    "    lastUcast Tx %u.%03u Rx %u.%03u RxMacst %u.%03u tmr %u nummbuf %u alloc %u reuse %u numFlushedMbufs %u (numhighreq %u numhighdequeue %u) driverCommand %u/%u\n",
    (unsigned int)v81 / 0x3E8uLL,
    (unsigned int)v81 % 0x3E8,
    (unsigned int)v80 / 0x3E8uLL,
    (unsigned int)v80 % 0x3E8,
    (unsigned int)v9 / 0x3E8);
  v30 = *((_DWORD *)v2 + 256);
  v31 = *((_DWORD *)v2 + 100);
  _userPrint(
    a2,
    "    freePools %u %u %u %u _num_no_packet_descriptor %u _num_fw_packets_freed %u _numUnrecognizedPackets %u\n",
    *(_DWORD *)(*((_QWORD *)v2 + 4) + 52LL),
    *(_DWORD *)(*((_QWORD *)v2 + 5) + 52LL),
    *(_DWORD *)(*((_QWORD *)v2 + 6) + 52LL),
    *(_DWORD *)(*((_QWORD *)v2 + 7) + 52LL),
    *((_DWORD *)v2 + 142));
  if ( IO80211PeerManager::getController(v2) && *(_BYTE *)(IO80211PeerManager::getController(v2) + 312) )
    _userPrint(a2, "    infraRedirect enabled\n", v32, v33, v34, v35, v77);
  v36 = *((_DWORD *)v2 + 38);
  v37 = *((_BYTE *)v2 + 560);
  v38 = *((_DWORD *)v2 + 139);
  v39 = *((_QWORD *)v2 + 72);
  v40 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v39)) >> 64) >> 18;
  v41 = *((_QWORD *)v2 + 73);
  v42 = getAbsoluteTime();
  v43 = *((_DWORD *)v2 + 174);
  v44 = *((_DWORD *)v2 + 168);
  v45 = (__int64)"     req=0x%x dp-open %u scanning %u sinceStartScan %u(ms) sinceStopScan %u(ms) _num_fwd_packets %u Monitor=%u\n";
  _userPrint(
    v82,
    "     req=0x%x dp-open %u scanning %u sinceStartScan %u(ms) sinceStopScan %u(ms) _num_fwd_packets %u Monitor=%u\n",
    v36,
    v37,
    v38,
    (unsigned int)v40,
    (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (v42 - v41)) >> 64) >> 18);
  v50 = (IO80211VirtualInterface *)*((_QWORD *)v2 + 16);
  if ( v50 )
  {
    v84 = 0;
    v51 = IO80211VirtualInterface::getIfnet(v50);
    v52 = ifnet_get_sndq_len(v51, &v84);
    v53 = (*(int (__fastcall **)(_QWORD, int *))(**((_QWORD **)v2 + 16) + 2224LL))(*((_QWORD *)v2 + 16), &v84);
    v45 = (__int64)" vif qlen %u err %d, stackFC(%d) numEnqueueFailed %u\n";
    _userPrint(
      v82,
      " vif qlen %u err %d, stackFC(%d) numEnqueueFailed %u\n",
      v84,
      (unsigned int)v52,
      v53,
      *((_DWORD *)v2 + 242),
      v78);
  }
  v54 = *((_QWORD *)v2 + 17);
  if ( v54 )
  {
    v83 = 0;
    LODWORD(v55) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v54 + 2408LL))(v54, v45);
    v56 = ifnet_get_sndq_len(v55, &v83);
    v57 = *((_DWORD *)v2 + 56);
    v58 = *((_BYTE *)v2 + 628);
    v59 = *((_DWORD *)v2 + 58);
    v60 = *((_DWORD *)v2 + 111);
    v61 = *((_DWORD *)v2 + 110);
    v62 = *((_DWORD *)v2 + 109);
    v63 = *((_DWORD *)v2 + 57);
    _userPrint(
      v82,
      " if qlen %u err %d, stackFC(%d) numEnqueueFailed %u _numUnflowControl %u wasNotlocked %u waslocked %u _workLookEnabled %u (%u/%u/%u) _num_packets_no_space %u\n",
      v83,
      (unsigned int)v56,
      *((_BYTE *)v2 + 216),
      *((_DWORD *)v2 + 242),
      *((_DWORD *)v2 + 55));
  }
  if ( *((_DWORD *)v2 + 139) )
  {
    v64 = *((_QWORD *)v2 + 72);
    v65 = getAbsoluteTime();
    v66 = 19342813113834067LL * ((unsigned __int64)(v65 - v64) >> 9) >> 64 >> 11;
    _userPrint(
      v82,
      "     scanning since %llu.%03llu\n",
      v66,
      (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (v65 - v64 - 1000000000 * v66)) >> 64) >> 18,
      v66,
      v67,
      v78);
  }
  else
  {
    _userPrint(v82, "  \n", v46, v47, v48, v49, v78);
  }
  v72 = *((_QWORD *)v2 + 9);
  v73 = 0;
  if ( v72 && *(_DWORD *)(v82 + 32) )
    v73 = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v72 + 280LL))(v72, v82);
  v74 = *((_QWORD *)v2 + 10);
  if ( v74 && *(_DWORD *)(v82 + 32) )
    v73 += (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v74 + 280LL))(v74, v82);
  v75 = *((_QWORD *)v2 + 11);
  if ( v75 )
    v73 += IO80211CommandQueue::print(v75, v82);
  if ( *((_QWORD *)v2 + 92) && *(_BYTE *)(v82 + 48) & 2 )
  {
    _userPrint(v82, "  Flushed packets:\n", v68, v69, v70, v71, v79);
    IO80211CommandQueue::print(*((_QWORD *)v2 + 92), v82);
  }
  return (unsigned int)v73;
}
// C8B00: using guessed type int __fastcall ifnet_get_sndq_len(_QWORD, _QWORD);

//----- (000000000004D8A8) ----------------------------------------------------
void __fastcall IO80211PeerManager::setPeerManagerLogFlags(IO80211PeerManager *this)
{
  ;
}

//----- (000000000004D8AE) ----------------------------------------------------
void __fastcall IO80211PeerManager::setPeerManagerVerboseLogFlags(IO80211PeerManager *this, __int64 a2)
{
  *((_QWORD *)this + 85) = a2;
}

//----- (000000000004D8BC) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::setLogFlags(IO80211PeerManager *this, __int64 a2)
{
  __int64 v2; // r15@1
  IO80211PeerManager *v3; // rbx@1
  __int64 v4; // r14@1
  signed int v5; // er12@1
  __int64 v6; // r13@1
  unsigned __int64 v7; // rax@1
  IO80211VirtualInterface *v8; // rdi@8
  IO80211Interface *v9; // rdi@10
  OSMetaClass *v10; // rax@13
  __int64 v11; // ST20_8@13
  __int64 v12; // rax@13
  __int64 v13; // ST18_8@13
  int v14; // ST00_4@13

  v2 = a2;
  v3 = this;
  v4 = IO80211PeerManager::getPeerManagerLogFlags(this);
  v5 = 0;
  v6 = 0LL;
  v7 = *(_DWORD *)(a2 + 4);
  if ( v7 <= 5 )
  {
    switch ( v7 )
    {
      case 0uLL:
        v6 = v4 ^ *(_QWORD *)(a2 + 8);
        goto LABEL_8;
      case 1uLL:
        v6 = v4 | *(_QWORD *)(a2 + 8);
        goto LABEL_8;
      case 2uLL:
        v6 = v4 & ~*(_QWORD *)(a2 + 8);
        goto LABEL_8;
      case 3uLL:
        v6 = *(_QWORD *)(a2 + 8);
        goto LABEL_8;
      case 4uLL:
LABEL_8:
        v8 = (IO80211VirtualInterface *)*((_QWORD *)this + 16);
        if ( v8 )
        {
          a2 = v6;
          IO80211VirtualInterface::setDebugFlags(v8, v6);
        }
        v9 = (IO80211Interface *)*((_QWORD *)v3 + 17);
        if ( v9 )
        {
          a2 = v6;
          IO80211Interface::setDebugFlags(v9, v6);
        }
        *((_QWORD *)v3 + 85) = *(_QWORD *)(v2 + 16);
        if ( IO80211PeerManager::getPeerManagerLogFlags(v3) & 0x20 )
        {
          LODWORD(v10) = (*(int (__fastcall **)(IO80211PeerManager *, __int64))(*(_QWORD *)v3 + 56LL))(v3, a2);
          v11 = OSMetaClass::getClassName(v10);
          v12 = (__int64)IO80211PeerManager::getBSDName(v3);
          v13 = *((_QWORD *)v3 + 85);
          v14 = *(_DWORD *)(v2 + 4);
          v5 = 0;
          IO80211PeerManager::logDebug(
            v3,
            32LL,
            "%s::%s <%s> op %u : 0x%llx - 0x%llx verbose 0x%llx\n",
            v11,
            (__int64)"setLogFlags",
            v12);
        }
        break;
      case 5uLL:
        return (unsigned int)v5;
      default:
        goto LABEL_2;
    }
  }
  else
  {
LABEL_2:
    v5 = 22;
  }
  return (unsigned int)v5;
}

//----- (000000000004D9FC) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::getLogFlags(IO80211PeerManager *this, __int64 a2)
{
  OSMetaClass *v2; // rax@2
  __int64 v3; // r15@2
  __int64 v4; // rax@2
  __int64 v5; // ST08_8@2
  __int64 v6; // ST00_8@2

  *(_QWORD *)(a2 + 8) = IO80211PeerManager::getPeerManagerLogFlags(this);
  *(_QWORD *)(a2 + 16) = *((_QWORD *)this + 85);
  if ( IO80211PeerManager::getPeerManagerLogFlags(this) & 0x20 )
  {
    LODWORD(v2) = (*(int (__fastcall **)(IO80211PeerManager *))(*(_QWORD *)this + 56LL))(this);
    v3 = OSMetaClass::getClassName(v2);
    v4 = (__int64)IO80211PeerManager::getBSDName(this);
    v5 = *((_QWORD *)this + 85);
    v6 = *(_QWORD *)(a2 + 8);
    IO80211PeerManager::logDebug(this, 32LL, "%s::%s <%s> %llx - verbose %llx\n", v3, (__int64)"getLogFlags", v4);
  }
  return 0LL;
}

//----- (000000000004DA90) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::printPackets(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  IO80211VirtualInterface *v5; // rdi@1
  char *v6; // rax@2
  IO80211Interface *v7; // rdi@3
  const char *i; // r12@5
  size_t v9; // rax@6
  size_t v10; // rdx@6
  __int64 v11; // rcx@8
  __int64 v12; // r8@8
  int v13; // er10@8
  __int64 v14; // r9@8
  int v15; // er11@8
  int v16; // er12@8
  int v17; // er13@8
  char v19; // [sp+40h] [bp-40h]@1
  __int64 v20; // [sp+50h] [bp-30h]@1

  v2 = a1;
  v3 = off_7B078[0];
  v20 = *(_QWORD *)off_7B078[0];
  v4 = (__int64)memset(&v19, 32, 0x10uLL);
  v5 = *(IO80211VirtualInterface **)(a1 + 128);
  if ( v5 )
  {
    v6 = IO80211VirtualInterface::getBSDName(v5);
  }
  else
  {
    v7 = *(IO80211Interface **)(v2 + 136);
    if ( !v7 )
      goto LABEL_10;
    v6 = IO80211Interface::getBSDName(v7, v4);
  }
  for ( i = v6; ; i = "unknown" )
  {
    v9 = (unsigned int)strlen(i);
    v10 = 16LL;
    if ( (unsigned int)v9 <= 0x10 )
      v10 = v9;
    strlcpy(&v19, i, v10);
    getAbsoluteTime();
    v11 = *(_DWORD *)(v2 + 812);
    v12 = *(_DWORD *)(v2 + 832) >> 10;
    v13 = *(_DWORD *)(v2 + 780);
    v14 = *(_DWORD *)(v2 + 784);
    v15 = *(_DWORD *)(v2 + 836) >> 10;
    v16 = *(_DWORD *)(v2 + 808);
    v17 = *(_DWORD *)(v2 + 984);
    v2 = *(_DWORD *)(v2 + 964);
    _userPrint(
      a2,
      "%s tx %7upkts %9ukB - rx %7upkts %9ukB - mcast tx %6upkts rx %6upkts - txFail %u txOverflow %u now %llu.%03llu\n",
      (__int64)&v19,
      v11,
      v12,
      v14,
      v15);
    if ( *(_QWORD *)v3 == v20 )
      break;
LABEL_10:
    ;
  }
  return 0LL;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000004DBF6) ----------------------------------------------------
__int64 __fastcall _packetStats(__int64 a1, __int64 a2, __int64 a3)
{
  IO80211Peer::packetStats(a2, a3);
  return 0LL;
}

//----- (000000000004DC0A) ----------------------------------------------------
signed __int64 __fastcall IO80211PeerManager::getExtendedStats(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  IO80211Peer *v3; // rdi@1

  v2 = a1;
  v3 = *(IO80211Peer **)(a1 + 80);
  if ( v3 )
  {
    *(_DWORD *)(a2 + 8) = IO80211Peer::getPacketStatsRealTimeTx(v3);
    *(_DWORD *)(a2 + 12) = IO80211Peer::getPacketStatsRealTimeRx(*(IO80211Peer **)(v2 + 80));
    *(_DWORD *)(a2 + 16) = 8 * *(_DWORD *)(v2 + 688);
  }
  return 1LL;
}

//----- (000000000004DC4E) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::printHashTable(IO80211PeerManager *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // rax@1
  __int64 result; // rax@2

  v6 = *((_QWORD *)this + 11);
  if ( v6 )
  {
    IO80211PeerManager::logDebug(
      this,
      "%s: %d  total _num_buckets: %u, Num entries: %u \n",
      (__int64)"printHashTable",
      5019LL,
      *(_DWORD *)(v6 + 68),
      *(_DWORD *)(v6 + 52));
    result = IO80211CommandQueue::map(
               *((_QWORD *)this + 11),
               (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_printMac,
               (__int64)this,
               0LL,
               0LL,
               -1);
  }
  else
  {
    result = IO80211PeerManager::logDebug(this, "%s: %d No peerList \n", (__int64)"printHashTable", 5022LL, a5, a6);
  }
  return result;
}

//----- (000000000004DCCC) ----------------------------------------------------
__int64 __fastcall _printMac(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  IO80211Peer::logDebug(
    (IO80211Peer *)a2,
    "%s: %d  bucket no %u \n",
    (__int64)"_printMac",
    4970LL,
    *(_BYTE *)(a2 + 12),
    a6);
  IO80211Peer::printMac((IO80211Peer *)a2);
  return 0LL;
}

//----- (000000000004DD08) ----------------------------------------------------
__int64 __usercall IO80211PeerManager::printState@<rax>(__int64 a1@<rax>, __int64 a2@<rdi>, __int64 a3@<rsi>)
{
  __int64 v3; // r13@1
  IO80211VirtualInterface *v4; // rdi@1
  __int64 v5; // rax@2
  int v6; // ebx@2
  __int64 v7; // rcx@2
  __int64 v8; // r8@2
  __int64 v9; // r9@2
  __int64 v10; // rdi@4
  __int64 v11; // rax@5
  __int64 v12; // r8@5
  __int64 v13; // r9@5
  IO80211VirtualInterface *v14; // rdi@7
  char *v15; // rax@8
  IO80211Interface *v16; // rdi@9
  __int64 v17; // r12@11
  __int64 v18; // r15@12
  __int64 v19; // rbx@14
  unsigned __int64 v20; // rbx@14
  __int64 v21; // rbx@15
  unsigned __int64 v22; // rcx@15
  __int64 v23; // rbx@15
  __int64 v24; // r8@15
  __int64 v25; // r9@15
  __int64 v26; // rdi@16
  __int64 v27; // rdi@18
  __int64 v28; // rdi@20
  __int64 v29; // rcx@21
  __int64 v30; // r8@21
  __int64 v31; // r9@21
  char v32; // ST00_1@21
  char v34; // [sp+0h] [bp-80h]@0
  char v35; // [sp+0h] [bp-80h]@14
  __int64 v36; // [sp+20h] [bp-60h]@8
  int v37; // [sp+2Ch] [bp-54h]@1
  __int64 v38; // [sp+30h] [bp-50h]@1
  __int64 v39; // [sp+38h] [bp-48h]@1
  __int64 v40; // [sp+40h] [bp-40h]@1
  __int64 v41; // [sp+48h] [bp-38h]@1
  __int64 v42; // [sp+50h] [bp-30h]@1

  v3 = a2;
  v42 = 0LL;
  v41 = 0LL;
  v40 = 0LL;
  v39 = 0LL;
  v38 = 0LL;
  v37 = 0;
  v4 = *(IO80211VirtualInterface **)(a2 + 128);
  if ( v4 )
  {
    v5 = IO80211VirtualInterface::getIfnet(v4);
    v6 = ifnet_get_sndq_len(v5, &v37);
    LODWORD(a1) = (*(int (__fastcall **)(_QWORD, int *))(**(_QWORD **)(v3 + 128) + 2224LL))(*(_QWORD *)(v3 + 128), &v37);
    if ( v6 )
      a1 = _userPrint(a3, "Error getting stack queue info %x\n", (unsigned int)v6, v7, v8, v9, v34);
  }
  v10 = *(_QWORD *)(v3 + 136);
  if ( v10 )
  {
    LODWORD(v11) = (*(int (**)(void))(*(_QWORD *)v10 + 2408LL))();
    LODWORD(a1) = ifnet_get_sndq_len(v11, &v37);
    if ( (_DWORD)a1 )
      a1 = _userPrint(a3, "Error getting stack queue info %x\n", (unsigned int)a1, (unsigned int)a1, v12, v13, v34);
  }
  v14 = *(IO80211VirtualInterface **)(v3 + 128);
  if ( v14 )
  {
    v36 = a3;
    v15 = IO80211VirtualInterface::getBSDName(v14);
LABEL_11:
    v17 = (__int64)v15;
    goto LABEL_12;
  }
  v36 = a3;
  v16 = *(IO80211Interface **)(v3 + 136);
  if ( v16 )
  {
    v15 = IO80211Interface::getBSDName(v16, a1);
    goto LABEL_11;
  }
  v17 = (__int64)"unknown";
LABEL_12:
  v18 = (__int64)"disabled";
  if ( *(_BYTE *)(v3 + 652) )
    v18 = (__int64)"enabled";
  v19 = *(_QWORD *)(v3 + 144);
  v20 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v19)) >> 64) >> 18;
  _userPrint(
    v36,
    "<%s> interface state is %s last %u(ms), ac-req 0x%x, network stack queue len %u %s\n",
    v17,
    v18,
    (unsigned int)v20,
    *(_DWORD *)(v3 + 152),
    v37);
  if ( *(_DWORD *)(v3 + 556) )
  {
    v21 = *(_QWORD *)(v3 + 576);
    v22 = getAbsoluteTime() - v21;
    v23 = 19342813113834067LL * (v22 >> 9) >> 64 >> 11;
    _userPrint(
      v36,
      "     Scanning since %llu.%03llu\n",
      v23,
      4835703278458516699LL * (v22 - 1000000000 * v23) >> 64 >> 18,
      v24,
      v25,
      v35);
  }
  v26 = *(_QWORD *)(v3 + 72);
  if ( v26 )
  {
    IO80211Peer::packetStats(v26, (__int64)&v38);
    _userPrint(
      v36,
      "     Multicast packets in queue [be %u bk %u vi %u vo %u] of which [be %u bk %u vi %u vo %u] are in  flight\n",
      (unsigned int)v38,
      HIDWORD(v38),
      (unsigned int)v39,
      HIDWORD(v39),
      v40);
  }
  v27 = *(_QWORD *)(v3 + 80);
  if ( v27 )
  {
    IO80211Peer::packetStats(v27, (__int64)&v38);
    _userPrint(
      v36,
      "     Unicast packets in queue [be %u bk %u vi %u vo %u] of which [be %u bk %u vi %u vo %u] are in  flight\n",
      (unsigned int)v38,
      HIDWORD(v38),
      (unsigned int)v39,
      HIDWORD(v39),
      v40);
  }
  v28 = *(_QWORD *)(v3 + 88);
  if ( v28 )
  {
    IO80211CommandQueue::map(
      v28,
      (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_packetStats,
      v3,
      (__int64)&v38,
      0LL,
      -1);
    _userPrint(
      v36,
      "     Unicast packets in queue [be %u bk %u vi %u vo %u] of which [be %u bk %u vi %u vo %u] are in  flight\n",
      (unsigned int)v38,
      HIDWORD(v38),
      (unsigned int)v39,
      HIDWORD(v39),
      v40);
    _userPrint(
      v36,
      "      Is a P2P interface, num peers %u\n",
      *(_DWORD *)(*(_QWORD *)(v3 + 88) + 52LL),
      v29,
      v30,
      v31,
      v32);
  }
  return *(_DWORD *)(v36 + 40);
}
// C8B00: using guessed type int __fastcall ifnet_get_sndq_len(_QWORD, _QWORD);

//----- (000000000004E022) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::handleDebugCmd(IO80211PeerManager *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // r14@1
  IO80211PeerManager *v7; // r15@1
  __int64 v8; // rcx@1
  int v9; // eax@1
  bool v10; // zf@1
  __int64 result; // rax@1
  const char *v12; // r12@3
  char *v13; // rax@5
  size_t v14; // rbx@6
  __int64 v15; // rcx@6
  __int64 v16; // r8@6
  __int64 v17; // r9@6
  size_t v18; // rax@7
  __int64 v19; // rdi@8
  signed __int64 v20; // rbx@10
  IO80211PeerManager *v21; // r12@11
  __int64 v22; // r15@11
  __int64 *v23; // rsi@12
  __int64 v24; // rax@13
  __int64 v25; // rdi@19
  int v26; // eax@20
  char *v27; // rax@25
  __int64 v28; // rsi@25
  size_t v29; // rbx@26
  size_t v30; // rax@27
  __int64 v31; // rdi@28
  __int64 v32; // rdi@30
  int v33; // eax@31
  char *v34; // rax@38
  size_t v35; // rbx@39
  size_t v36; // rax@40
  __int64 v37; // rdi@41
  __int64 v38; // rdi@43
  int v39; // eax@44
  char *v40; // rax@52
  size_t v41; // rbx@53
  size_t v42; // rax@54
  __int64 v43; // rdi@55
  __int64 v44; // rdi@57
  int v45; // eax@58
  char *v46; // rax@66
  size_t v47; // rbx@67
  size_t v48; // rax@68
  __int64 v49; // rdi@69
  __int64 v50; // rdi@71
  int v51; // eax@72
  char *v52; // rax@79
  size_t v53; // rbx@80
  size_t v54; // rax@81
  __int64 v55; // rdi@82
  __int64 v56; // rdi@84
  int v57; // eax@85
  char *v58; // rax@92
  size_t v59; // rbx@93
  size_t v60; // rax@94
  __int64 v61; // rdi@95
  __int64 v62; // rdi@97
  int v63; // eax@98
  size_t v64; // rbx@104
  size_t v65; // rax@105
  __int64 v66; // rax@105
  signed __int64 v67; // [sp+0h] [bp-90h]@0
  __int64 v68; // [sp+8h] [bp-88h]@10
  __int64 v69; // [sp+10h] [bp-80h]@1
  __int64 v70; // [sp+18h] [bp-78h]@1
  __int64 v71; // [sp+20h] [bp-70h]@1
  __int64 v72; // [sp+28h] [bp-68h]@1
  __int64 v73; // [sp+30h] [bp-60h]@1
  __int64 v74; // [sp+38h] [bp-58h]@1
  __int64 v75; // [sp+40h] [bp-50h]@1
  __int64 v76; // [sp+48h] [bp-48h]@1
  __int64 v77; // [sp+50h] [bp-40h]@1
  __int64 v78; // [sp+58h] [bp-38h]@1
  __int64 v79; // [sp+60h] [bp-30h]@1

  v6 = a2;
  v7 = this;
  v79 = 0LL;
  v78 = 0LL;
  v77 = 0LL;
  v76 = 0LL;
  v75 = 0LL;
  v74 = 0LL;
  v73 = 0LL;
  v72 = 0LL;
  v71 = 0LL;
  v70 = 0LL;
  v69 = 0LL;
  v8 = *(_QWORD *)(a2 + 1456);
  v69 = *(_QWORD *)(a2 + 1456);
  v9 = *(_DWORD *)(a2 + 1452);
  LODWORD(v73) = v9;
  HIDWORD(v75) = *(_WORD *)(a2 + 4);
  v74 = *(_DWORD *)(a2 + 1464);
  v10 = v9 == 0;
  result = 22LL;
  if ( !v10 && v8 )
  {
    v12 = (const char *)(a2 + 8);
    if ( *(_BYTE *)(a2 + 8) )
    {
      if ( strchr((const char *)(a2 + 8), 61)
        && (v13 = strchr((const char *)(a2 + 8), 61), !strncasecmp((const char *)(a2 + 8), "print_peers", v13 - v12))
        || (v14 = strlen((const char *)(a2 + 8)), v14 == strlen("print_peers"))
        && (v18 = strlen("print_peers"), !strncasecmp((const char *)(a2 + 8), "print_peers", v18)) )
      {
        v19 = *((_QWORD *)this + 82);
        if ( v19 )
        {
          IORecursiveLockLock(v19);
          ++*((_DWORD *)v7 + 166);
        }
        v67 = a2 + 8;
        v20 = a2 + 1352;
        v68 = a2;
        if ( !memcmp((const void *)(a2 + 1352), &null_address, 6uLL) )
        {
          v23 = &v69;
          v21 = v7;
          (*(void (__fastcall **)(IO80211PeerManager *, __int64 *))(*(_QWORD *)v7 + 520LL))(v7, &v69);
        }
        else
        {
          v21 = v7;
          v22 = 0LL;
          do
          {
            v23 = (__int64 *)&null_address;
            if ( memcmp((const void *)(v20 + v22), &null_address, 6uLL) )
            {
              v23 = (__int64 *)(v20 + v22);
              v24 = IO80211PeerManager::findPeer(v21, (unsigned __int8 *)(v20 + v22), 1);
              if ( v24 )
              {
                LODWORD(v75) = 2;
                v23 = &v69;
                (*(void (__fastcall **)(__int64, __int64 *))(*(_QWORD *)v24 + 280LL))(v24, &v69);
              }
            }
            v22 += 6LL;
          }
          while ( v22 != 96 );
        }
        v7 = v21;
        v25 = *((_QWORD *)v21 + 82);
        v6 = v68;
        v12 = (const char *)v67;
        if ( v25 )
        {
          v26 = *((_DWORD *)v7 + 166);
          if ( v26 )
            *((_DWORD *)v7 + 166) = v26 - 1;
          IORecursiveLockUnlock(v25, v23);
        }
      }
    }
    else
    {
      _userPrint((__int64)&v69, "%s\n", (__int64)"print_peers", v8, a5, a6, v67);
    }
    if ( *v12 )
    {
      if ( strchr(v12, 61)
        && (v27 = strchr(v12, 61), v28 = (__int64)"print_peers_ht", !strncasecmp(v12, "print_peers_ht", v27 - v12))
        || (v29 = strlen(v12), v29 == strlen("print_peers_ht"))
        && (v30 = strlen("print_peers_ht"), v28 = (__int64)"print_peers_ht", !strncasecmp(v12, "print_peers_ht", v30)) )
      {
        v31 = *((_QWORD *)v7 + 82);
        if ( v31 )
        {
          IORecursiveLockLock(v31);
          ++*((_DWORD *)v7 + 166);
        }
        (*(void (__fastcall **)(IO80211PeerManager *, __int64))(*(_QWORD *)v7 + 528LL))(v7, v28);
        v32 = *((_QWORD *)v7 + 82);
        if ( v32 )
        {
          v33 = *((_DWORD *)v7 + 166);
          if ( v33 )
            *((_DWORD *)v7 + 166) = v33 - 1;
          IORecursiveLockUnlock(v32, v28);
        }
      }
    }
    else if ( *(_QWORD *)(v6 + 1456) )
    {
      _userPrint((__int64)&v69, "%s\n", (__int64)"print_peers_ht", v15, v16, v17, v67);
    }
    if ( *v12 )
    {
      if ( strchr(v12, 61) && (v34 = strchr(v12, 61), !strncasecmp(v12, "print_all_peers", v34 - v12))
        || (v35 = strlen(v12), v35 == strlen("print_all_peers"))
        && (v36 = strlen("print_all_peers"), !strncasecmp(v12, "print_all_peers", v36)) )
      {
        v37 = *((_QWORD *)v7 + 82);
        if ( v37 )
        {
          IORecursiveLockLock(v37);
          ++*((_DWORD *)v7 + 166);
        }
        LODWORD(v75) = 1;
        (*(void (__fastcall **)(IO80211PeerManager *, __int64 *))(*(_QWORD *)v7 + 520LL))(v7, &v69);
        v38 = *((_QWORD *)v7 + 82);
        if ( v38 )
        {
          v39 = *((_DWORD *)v7 + 166);
          if ( v39 )
            *((_DWORD *)v7 + 166) = v39 - 1;
          IORecursiveLockUnlock(v38, &v69);
        }
        *(_DWORD *)(v6 + 1464) = 0;
      }
    }
    else if ( *(_QWORD *)(v6 + 1456) )
    {
      _userPrint((__int64)&v69, "%s\n", (__int64)"print_all_peers", v15, v16, v17, v67);
    }
    if ( *v12 )
    {
      if ( strchr(v12, 61) && (v40 = strchr(v12, 61), !strncasecmp(v12, "print_cached_peers", v40 - v12))
        || (v41 = strlen(v12), v41 == strlen("print_cached_peers"))
        && (v42 = strlen("print_cached_peers"), !strncasecmp(v12, "print_cached_peers", v42)) )
      {
        v43 = *((_QWORD *)v7 + 82);
        if ( v43 )
        {
          IORecursiveLockLock(v43);
          ++*((_DWORD *)v7 + 166);
        }
        LODWORD(v75) = 16;
        (*(void (__fastcall **)(IO80211PeerManager *, __int64 *))(*(_QWORD *)v7 + 520LL))(v7, &v69);
        v44 = *((_QWORD *)v7 + 82);
        if ( v44 )
        {
          v45 = *((_DWORD *)v7 + 166);
          if ( v45 )
            *((_DWORD *)v7 + 166) = v45 - 1;
          IORecursiveLockUnlock(v44, &v69);
        }
        *(_DWORD *)(v6 + 1464) = 0;
      }
    }
    else if ( *(_QWORD *)(v6 + 1456) )
    {
      _userPrint((__int64)&v69, "%s\n", (__int64)"print_cached_peers", v15, v16, v17, v67);
    }
    if ( *v12 )
    {
      if ( strchr(v12, 61) && (v46 = strchr(v12, 61), !strncasecmp(v12, "print_all_peers_verbose", v46 - v12))
        || (v47 = strlen(v12), v47 == strlen("print_all_peers_verbose"))
        && (v48 = strlen("print_all_peers_verbose"), !strncasecmp(v12, "print_all_peers_verbose", v48)) )
      {
        LODWORD(v75) = 3;
        v49 = *((_QWORD *)v7 + 82);
        if ( v49 )
        {
          IORecursiveLockLock(v49);
          ++*((_DWORD *)v7 + 166);
        }
        (*(void (__fastcall **)(IO80211PeerManager *, __int64 *))(*(_QWORD *)v7 + 520LL))(v7, &v69);
        v50 = *((_QWORD *)v7 + 82);
        if ( v50 )
        {
          v51 = *((_DWORD *)v7 + 166);
          if ( v51 )
            *((_DWORD *)v7 + 166) = v51 - 1;
          IORecursiveLockUnlock(v50, &v69);
        }
      }
    }
    else if ( *(_QWORD *)(v6 + 1456) )
    {
      _userPrint((__int64)&v69, "%s\n", (__int64)"print_all_peers_verbose", v15, v16, v17, v67);
    }
    if ( *v12 )
    {
      if ( strchr(v12, 61) && (v52 = strchr(v12, 61), !strncasecmp(v12, "print_state", v52 - v12))
        || (v53 = strlen(v12), v53 == strlen("print_state"))
        && (v54 = strlen("print_state"), !strncasecmp(v12, "print_state", v54)) )
      {
        v55 = *((_QWORD *)v7 + 82);
        if ( v55 )
        {
          IORecursiveLockLock(v55);
          ++*((_DWORD *)v7 + 166);
        }
        (*(void (__fastcall **)(IO80211PeerManager *, __int64 *))(*(_QWORD *)v7 + 504LL))(v7, &v69);
        v56 = *((_QWORD *)v7 + 82);
        if ( v56 )
        {
          v57 = *((_DWORD *)v7 + 166);
          if ( v57 )
            *((_DWORD *)v7 + 166) = v57 - 1;
          IORecursiveLockUnlock(v56, &v69);
        }
      }
    }
    else if ( *(_QWORD *)(v6 + 1456) )
    {
      _userPrint((__int64)&v69, "%s\n", (__int64)"print_state", v15, v16, v17, v67);
    }
    if ( *v12 )
    {
      if ( strchr(v12, 61) && (v58 = strchr(v12, 61), !strncasecmp(v12, "print_packets", v58 - v12))
        || (v59 = strlen(v12), v59 == strlen("print_packets"))
        && (v60 = strlen("print_packets"), !strncasecmp(v12, "print_packets", v60)) )
      {
        v61 = *((_QWORD *)v7 + 82);
        if ( v61 )
        {
          IORecursiveLockLock(v61);
          ++*((_DWORD *)v7 + 166);
        }
        IO80211PeerManager::printPackets((__int64)v7, (__int64)&v69);
        v62 = *((_QWORD *)v7 + 82);
        if ( v62 )
        {
          v63 = *((_DWORD *)v7 + 166);
          if ( v63 )
            *((_DWORD *)v7 + 166) = v63 - 1;
          IORecursiveLockUnlock(v62, &v69);
        }
      }
    }
    else if ( *(_QWORD *)(v6 + 1456) )
    {
      _userPrint((__int64)&v69, "%s\n", (__int64)"print_packets", v15, v16, v17, v67);
    }
    if ( *v12 )
    {
      v64 = strlen(v12);
      if ( v64 == strlen("unflow_control") )
      {
        v65 = strlen("unflow_control");
        LODWORD(v66) = strncasecmp(v12, "unflow_control", v65);
        if ( !(_DWORD)v66 )
          IO80211PeerManager::sendUnflowControlStack(v7, v66, 0);
      }
    }
    else if ( *(_QWORD *)(v6 + 1456) )
    {
      _userPrint(
        (__int64)&v69,
        "%s : %s\n",
        (__int64)"unflow_control",
        (__int64)"send an unflow control to the network stack",
        v16,
        v17,
        v67);
    }
    *(_DWORD *)(v6 + 1464) += v74;
    result = 0LL;
  }
  return result;
}
// 77FDC: using guessed type int null_address;
// C7758: using guessed type int __cdecl IORecursiveLockLock(_QWORD);
// C7760: using guessed type int __fastcall IORecursiveLockUnlock(_QWORD, _QWORD);

//----- (000000000004E8E4) ----------------------------------------------------
void __fastcall IO80211QueueDescriptor::freeResources(IO80211QueueDescriptor *this)
{
  ;
}

//----- (000000000004E8EA) ----------------------------------------------------
void IO80211PeerManager::handleChannelSwitchAnnouncement()
{
  ;
}

//----- (000000000004E8F0) ----------------------------------------------------
char IO80211PeerManager::interfaceStateChange()
{
  return 1;
}

//----- (000000000004E8F8) ----------------------------------------------------
void __fastcall IO80211PeerManager::setInfraTxState(IO80211PeerManager *this)
{
  ;
}

//----- (000000000004E8FE) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::handle11zPacket(IO80211PeerManager *this, __mbuf *a2)
{
  return 0LL;
}

//----- (000000000004E906) ----------------------------------------------------
void __fastcall IO80211PeerManager::cachedPeerHasChangedInfra(IO80211PeerManager *this, IO80211Peer *a2)
{
  ;
}

//----- (000000000004E90C) ----------------------------------------------------
__int64 __fastcall IO80211PeerManager::MetaClass::~MetaClass(IO80211PeerManager::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000004E920) ----------------------------------------------------
__int64 `global constructor keyed to'_a_9()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(
    &IO80211PeerManager::gMetaClass,
    "IO80211PeerManager",
    &IO80211QueueDescriptor::gMetaClass,
    1032LL);
  result = (__int64)off_7D800;
  IO80211PeerManager::gMetaClass = off_7D800;
  return result;
}
// 7D800: using guessed type __int64 (__fastcall *off_7D800[2])(IO80211PeerManager::MetaClass *__hidden this);
// 84480: using guessed type _QWORD IO80211PeerManager::gMetaClass;
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004E960) ----------------------------------------------------
__int64 `global destructor keyed to'_a_9()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211PeerManager::gMetaClass);
}
// 84480: using guessed type _QWORD IO80211PeerManager::gMetaClass;

//----- (000000000004E980) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::MetaClass::MetaClass(IO80211P2PInterface::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211P2PInterface", &IO80211VirtualInterface::gMetaClass, 360LL);
  result = (__int64)off_7E360;
  *(_QWORD *)this = off_7E360;
  return result;
}
// 7E360: using guessed type __int64 (__fastcall *off_7E360[2])(IO80211P2PInterface::MetaClass *__hidden this);
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004E9B2) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::MetaClass::~MetaClass(IO80211P2PInterface::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000004E9BC) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::IO80211P2PInterface(__int64 a1)
{
  __int64 result; // rax@1

  IO80211VirtualInterface::IO80211VirtualInterface(a1);
  result = (__int64)off_7D960;
  *(_QWORD *)a1 = off_7D960;
  return result;
}
// 7D960: using guessed type __int64 (__fastcall *off_7D960[2])(IO80211P2PInterface *__hidden this);

//----- (000000000004E9DC) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::IO80211P2PInterface(__int64 a1)
{
  __int64 result; // rax@1

  IO80211VirtualInterface::IO80211VirtualInterface(a1);
  result = (__int64)off_7D960;
  *(_QWORD *)a1 = off_7D960;
  return result;
}
// 7D960: using guessed type __int64 (__fastcall *off_7D960[2])(IO80211P2PInterface *__hidden this);

//----- (000000000004E9FC) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::~IO80211P2PInterface(IO80211P2PInterface *this)
{
  return IO80211VirtualInterface::~IO80211VirtualInterface(this);
}

//----- (000000000004EA06) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::~IO80211P2PInterface(IO80211P2PInterface *this)
{
  return IO80211VirtualInterface::~IO80211VirtualInterface(this);
}

//----- (000000000004EA10) ----------------------------------------------------
void __fastcall IO80211P2PInterface::~IO80211P2PInterface(IO80211P2PInterface *this)
{
  IO80211VirtualInterface::~IO80211VirtualInterface(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000004EA32) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::getMetaClass(IO80211P2PInterface *this)
{
  return (__int64)&IO80211P2PInterface::gMetaClass;
}
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EA40) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::MetaClass::MetaClass(IO80211P2PInterface::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211P2PInterface", &IO80211VirtualInterface::gMetaClass, 360LL);
  result = (__int64)off_7E360;
  *(_QWORD *)this = off_7E360;
  return result;
}
// 7E360: using guessed type __int64 (__fastcall *off_7E360[2])(IO80211P2PInterface::MetaClass *__hidden this);
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004EA72) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::MetaClass::alloc(IO80211P2PInterface::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_158.segname[8], a2);
  IO80211VirtualInterface::IO80211VirtualInterface(v2);
  *(_QWORD *)v2 = off_7D960;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211P2PInterface::gMetaClass);
  return v2;
}
// 158: using guessed type segment_command_64 stru_158;
// 7D960: using guessed type __int64 (__fastcall *off_7D960[2])(IO80211P2PInterface *__hidden this);
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EAB2) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::IO80211P2PInterface(__int64 a1)
{
  IO80211VirtualInterface::IO80211VirtualInterface(a1);
  *(_QWORD *)a1 = off_7D960;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211P2PInterface::gMetaClass);
}
// 7D960: using guessed type __int64 (__fastcall *off_7D960[2])(IO80211P2PInterface *__hidden this);
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EAE2) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::IO80211P2PInterface(__int64 a1)
{
  IO80211VirtualInterface::IO80211VirtualInterface(a1);
  *(_QWORD *)a1 = off_7D960;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211P2PInterface::gMetaClass);
}
// 7D960: using guessed type __int64 (__fastcall *off_7D960[2])(IO80211P2PInterface *__hidden this);
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EB12) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface0(IO80211P2PInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211P2PInterface::gMetaClass, 0);
}
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EB26) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface1(IO80211P2PInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211P2PInterface::gMetaClass, 1);
}
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EB3C) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface2(IO80211P2PInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211P2PInterface::gMetaClass, 2);
}
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EB52) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface3(IO80211P2PInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211P2PInterface::gMetaClass, 3);
}
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EB68) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface4(IO80211P2PInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211P2PInterface::gMetaClass, 4);
}
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EB7E) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface5(IO80211P2PInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211P2PInterface::gMetaClass, 5);
}
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EB94) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface6(IO80211P2PInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211P2PInterface::gMetaClass, 6);
}
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EBAA) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface7(IO80211P2PInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211P2PInterface::gMetaClass, 7);
}
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EBC0) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface8(IO80211P2PInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211P2PInterface::gMetaClass, 8);
}
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EBD6) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface9(IO80211P2PInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211P2PInterface::gMetaClass, 9);
}
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EBEC) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface10(IO80211P2PInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211P2PInterface::gMetaClass, 10);
}
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EC02) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface11(IO80211P2PInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211P2PInterface::gMetaClass, 11);
}
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EC18) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface12(IO80211P2PInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211P2PInterface::gMetaClass, 12);
}
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EC2E) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface13(IO80211P2PInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211P2PInterface::gMetaClass, 13);
}
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EC44) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface14(IO80211P2PInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211P2PInterface::gMetaClass, 14);
}
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EC5A) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::_RESERVEDIO80211P2PInterface15(IO80211P2PInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211P2PInterface::gMetaClass, 15);
}
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EC70) ----------------------------------------------------
char __fastcall IO80211P2PInterface::init(IO80211P2PInterface *this, IO80211Controller *a2, ether_addr *a3, unsigned int a4, const char *a5)
{
  const char *v5; // r13@1
  unsigned int v6; // er12@1
  ether_addr *v7; // r14@1
  OSMetaClass *v8; // rax@2
  __int64 v9; // rax@2
  __int64 v10; // r9@2
  ether_addr *v11; // rcx@3
  char result; // al@5
  __int64 v13; // rax@7

  v5 = a5;
  v6 = a4;
  v7 = a3;
  if ( (unsigned __int8)((int (__cdecl *)(IO80211P2PInterface *))`vtable for'IO80211VirtualInterface[268])(this) )
  {
    LODWORD(v8) = (*(int (__cdecl **)(IO80211P2PInterface *))(*(_QWORD *)this + 56LL))(this);
    v9 = OSMetaClass::getClassName(v8);
    IOLog("%s::%s <%s> role %u\n", v9, "init", v5, v6, v10);
    if ( !*((_QWORD *)this + 18) )
    {
      if ( (unsigned int)IO80211VirtualInterface::getInterfaceRole(this) == 4 )
      {
        *((_QWORD *)a2 + 42) = this;
        *((_QWORD *)this + 18) = IO80211AWDLPeerManager::withInterface(this, 0LL, v7, v11);
      }
      else
      {
        IO80211VirtualInterface::setDebugFlags(this, *((_QWORD *)this + 20));
      }
    }
    v13 = IO80211VirtualInterface::getIfnet(this);
    ifnet_set_eflags(v13, 0x20000LL, 0x20000LL);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 817F0: using guessed type __int64 `vtable for'IO80211VirtualInterface[2];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8B68: using guessed type int __fastcall ifnet_set_eflags(_QWORD, _QWORD, _QWORD);

//----- (000000000004ED42) ----------------------------------------------------
size_t __fastcall IO80211P2PInterface::setUnitNumber(IO80211P2PInterface *this, const char *a2)
{
  int v2; // eax@1
  signed int v3; // er15@2

  v2 = IO80211VirtualInterface::getInterfaceRole(this);
  if ( (unsigned int)(v2 - 1) > 2 )
    goto LABEL_11;
  v3 = 0;
  if ( v2 != 1 )
  {
    if ( v2 == 3 )
      v3 = 1;
    else
      v3 = 2;
  }
  if ( !IO80211VirtualInterfaceNamerMarkInterfaceUnitUsed(a2, v3) )
LABEL_11:
    JUMPOUT(__CS__, `vtable for'IO80211VirtualInterface[285]);
  return IO80211VirtualInterface::setUnitNumber(this, a2, v3);
}
// 817F0: using guessed type __int64 `vtable for'IO80211VirtualInterface[2];

//----- (000000000004EDBE) ----------------------------------------------------
__int64 __fastcall IO80211P2PInterface::MetaClass::~MetaClass(IO80211P2PInterface::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000004EDD0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_10()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(
    &IO80211P2PInterface::gMetaClass,
    "IO80211P2PInterface",
    &IO80211VirtualInterface::gMetaClass,
    360LL);
  result = (__int64)off_7E360;
  IO80211P2PInterface::gMetaClass = off_7E360;
  return result;
}
// 7E360: using guessed type __int64 (__fastcall *off_7E360[2])(IO80211P2PInterface::MetaClass *__hidden this);
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004EE10) ----------------------------------------------------
__int64 `global destructor keyed to'_a_10()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211P2PInterface::gMetaClass);
}
// 84548: using guessed type _QWORD IO80211P2PInterface::gMetaClass;

//----- (000000000004EE21) ----------------------------------------------------
__int64 __fastcall IO80211InitPeerFoundEventData(__int64 a1, int a2, const void *a3, __int64 a4, unsigned int a5)
{
  __int64 v5; // r13@1
  const void *v6; // r12@1
  char v7; // r15@1
  unsigned int v8; // er15@5
  unsigned int v9; // eax@5
  __int64 v10; // r12@5
  bool v11; // cf@5
  int *v12; // r14@6
  __int64 v13; // rbx@6
  unsigned int v14; // er15@6
  unsigned int v15; // er14@11
  size_t v16; // r14@13
  void *v17; // rax@14
  void *v18; // rax@16
  __int64 v19; // rax@19
  int *v20; // rbx@21
  __int64 v21; // r14@21
  unsigned int v22; // er15@21
  unsigned int v23; // ebx@26
  size_t v24; // rbx@28
  void *v25; // rax@29
  const void *v26; // r12@29
  void *v27; // rax@31
  __int64 v28; // rax@34
  const void *v29; // r14@35
  __int64 v30; // rax@36
  __int64 v31; // rax@37
  __int64 v32; // rax@39
  __int16 v33; // ax@40
  __int64 v34; // rax@40
  unsigned __int16 v35; // cx@41
  __int64 v36; // rax@42
  __int64 v37; // r14@42
  __int16 v38; // ax@43
  __int16 v39; // ax@43
  signed int v40; // eax@44
  signed int v41; // edx@45
  int v42; // eax@45
  __int64 v43; // rax@47
  signed int v45; // [sp+Ch] [bp-64h]@6
  unsigned int v46; // [sp+20h] [bp-50h]@20
  const void *v47; // [sp+28h] [bp-48h]@14
  void *v48; // [sp+28h] [bp-48h]@29
  const void *v49; // [sp+30h] [bp-40h]@21
  int v50; // [sp+38h] [bp-38h]@6
  int v51; // [sp+40h] [bp-30h]@5
  int v52; // [sp+44h] [bp-2Ch]@21

  v5 = a4;
  v6 = a3;
  v7 = 0;
  if ( !a4 )
    return (unsigned __int8)v7;
  if ( !a3 )
    return (unsigned __int8)v7;
  if ( !a1 )
    return (unsigned __int8)v7;
  if ( (a5 & 0x80000000) != 0 )
    return (unsigned __int8)v7;
  v8 = a5;
  bzero((void *)a1, 0x3CuLL);
  *(_DWORD *)a1 = a2;
  memcpy((void *)(a1 + 6), v6, 6uLL);
  v9 = v8;
  v51 = 82989056;
  v10 = 0LL;
  v11 = v8 < 3;
  v7 = 0;
  if ( v11 )
    return (unsigned __int8)v7;
  v12 = &v51;
  v13 = v5;
  v14 = v9;
  v45 = v9;
  v50 = 0;
  do
  {
    if ( *(_BYTE *)v13 == 221
      && (unsigned int)*(_BYTE *)(v13 + 1) >= 4
      && v14 >= 6
      && !memcmp((const void *)(v13 + 2), v12, 4uLL) )
    {
      v15 = *(_BYTE *)(v13 + 1);
      if ( v15 + 2 <= v14 && v15 >= 5 )
      {
        v16 = v15 - 4;
        if ( v10 )
        {
          v47 = (const void *)v10;
          LODWORD(v17) = IOMalloc((unsigned int)(v16 + v50));
          v10 = (__int64)v17;
          if ( !v17 )
          {
            IOFree(v47, (unsigned int)v50);
LABEL_56:
            v7 = 0;
            return (unsigned __int8)v7;
          }
          memcpy(v17, v47, (unsigned int)v50);
          memcpy((void *)(v10 + (unsigned int)v50), (const void *)(v13 + 6), v16);
          IOFree(v47, (unsigned int)v50);
          v50 += v16;
        }
        else
        {
          LODWORD(v18) = IOMalloc(v16);
          v10 = (__int64)v18;
          if ( !v18 )
            goto LABEL_56;
          memcpy(v18, (const void *)(v13 + 6), v16);
          v50 = v16;
        }
      }
      v12 = &v51;
    }
    v19 = (unsigned int)*(_BYTE *)(v13 + 1) + 2;
    v14 -= v19;
    v13 += v19;
  }
  while ( v14 > 2 );
  v46 = 0;
  v7 = 0;
  if ( !v10 )
    return (unsigned __int8)v7;
  v52 = 161115984;
  v20 = &v52;
  v21 = v5;
  v49 = 0LL;
  v22 = v45;
  while ( 1 )
  {
    if ( *(_BYTE *)v21 != 221
      || (unsigned int)*(_BYTE *)(v21 + 1) < 4
      || v22 < 6
      || memcmp((const void *)(v21 + 2), v20, 4uLL) )
      goto LABEL_34;
    v23 = *(_BYTE *)(v21 + 1);
    if ( v23 + 2 <= v22 && v23 >= 5 )
      break;
LABEL_33:
    v20 = &v52;
LABEL_34:
    v28 = (unsigned int)*(_BYTE *)(v21 + 1) + 2;
    v22 -= v28;
    v21 += v28;
    if ( v22 <= 2 )
    {
      v29 = v49;
      if ( !v49 )
      {
LABEL_49:
        v7 = 0;
        goto LABEL_53;
      }
      v30 = _findP2PSubIE(2u, (__int64)v49, v46);
      if ( !v30 )
        goto LABEL_48;
      *(_BYTE *)(a1 + 4) = *(_BYTE *)(v30 + 3);
      *(_BYTE *)(a1 + 5) = *(_BYTE *)(v30 + 4);
      v31 = _findP2PSubIE(6u, (__int64)v49, v46);
      if ( v31 )
      {
        *(_BYTE *)(a1 + 12) = *(_BYTE *)(v31 + 3);
        *(_BYTE *)(a1 + 13) = *(_BYTE *)(v31 + 4);
      }
      v32 = _findWPSSubIE(0x1008u, v10, v50);
      if ( v32
        && (v33 = __ROL2__(*(_WORD *)(v32 + 4), 8),
            *(_WORD *)(a1 + 14) = v33,
            (v34 = _findWPSSubIE(0x1011u, v10, v50)) != 0)
        && (v35 = __ROL2__(*(_WORD *)(v34 + 2), 8), v35 <= 0x20u)
        && (*(_BYTE *)(a1 + 48) = v35,
            memcpy((void *)(a1 + 16), (const void *)(v34 + 4), (unsigned __int8)v35),
            v36 = _findWPSSubIE(0x1054u, v10, v50),
            (v37 = v36) != 0) )
      {
        v38 = __ROL2__(*(_WORD *)(v36 + 4), 8);
        *(_WORD *)(a1 + 49) = v38;
        memcpy((void *)(a1 + 51), (const void *)(v37 + 6), 4uLL);
        v39 = __ROL2__(*(_WORD *)(v37 + 10), 8);
        *(_WORD *)(a1 + 55) = v39;
        v7 = 1;
        if ( !*(_BYTE *)(a1 + 13) )
        {
          v40 = v45;
          v29 = v49;
          if ( v45 >= 3 )
          {
            while ( 1 )
            {
              v41 = v40;
              v42 = *(_BYTE *)(v5 + 1);
              if ( *(_BYTE *)v5 == 3 && v42 == 1 )
                break;
              v43 = (unsigned int)(v42 + 2);
              v5 += v43;
              v40 = v41 - v43;
              if ( v40 <= 2 )
                goto LABEL_48;
            }
            *(_BYTE *)(a1 + 13) = *(_BYTE *)(v5 + 2);
            goto LABEL_52;
          }
LABEL_48:
          v7 = 0;
LABEL_52:
          IOFree(v29, v46);
          goto LABEL_53;
        }
      }
      else
      {
        v7 = 0;
      }
      v29 = v49;
      goto LABEL_52;
    }
  }
  v24 = v23 - 4;
  if ( !v49 )
  {
    LODWORD(v27) = IOMalloc(v24);
    if ( !v27 )
      goto LABEL_49;
    v49 = v27;
    memcpy(v27, (const void *)(v21 + 6), v24);
    v46 = v24;
    goto LABEL_33;
  }
  v48 = (void *)v10;
  LODWORD(v25) = IOMalloc((unsigned int)v24 + v46);
  v26 = v25;
  if ( v25 )
  {
    memcpy(v25, v49, v46);
    memcpy((char *)v26 + v46, (const void *)(v21 + 6), v24);
    IOFree(v49, v46);
    v46 += v24;
    v49 = v26;
    v10 = (__int64)v48;
    goto LABEL_33;
  }
  IOFree(v49, v46);
  v7 = 0;
  v10 = (__int64)v48;
LABEL_53:
  IOFree(v10, (unsigned int)v50);
  return (unsigned __int8)v7;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000004F2B6) ----------------------------------------------------
__int64 __fastcall _findWPSSubIE(unsigned __int16 a1, __int64 a2, int a3)
{
  __int64 result; // rax@1
  int v4; // er8@2
  unsigned __int16 v5; // di@3
  __int16 v6; // di@4
  unsigned __int16 v7; // cx@4
  unsigned __int16 v8; // di@7

  result = 0LL;
  if ( (unsigned int)a3 >= 5 )
  {
    v4 = a1;
    result = 0LL;
    do
    {
      v5 = __ROL2__(*(_WORD *)a2, 8);
      if ( v5 == v4 )
      {
        v6 = *(_WORD *)(a2 + 2);
        v7 = __ROL2__(*(_WORD *)(a2 + 2), 8);
        if ( (unsigned int)a3 >= (unsigned __int64)v7 + 4 )
          return a2;
      }
      else
      {
        v6 = *(_WORD *)(a2 + 2);
      }
      v8 = __ROL2__(v6, 8);
      a3 = a3 - 4 - v8;
      a2 += v8 + 4LL;
    }
    while ( (unsigned int)a3 > 4 );
  }
  return result;
}

//----- (000000000004F313) ----------------------------------------------------
__int64 __fastcall _findP2PSubIE(unsigned __int8 a1, __int64 a2, unsigned __int64 a3)
{
  __int64 result; // rax@1
  int v4; // ecx@2
  unsigned __int16 v5; // di@4
  signed __int64 v6; // rdi@7

  result = 0LL;
  if ( (unsigned int)a3 >= 4 )
  {
    v4 = a1;
    do
    {
      if ( *(_BYTE *)a2 == v4 )
      {
        a3 = (unsigned int)a3;
        v5 = *(_WORD *)(a2 + 1);
        result = a2;
        if ( (unsigned int)a3 >= (unsigned __int64)*(_WORD *)(a2 + 1) + 3 )
          return result;
      }
      else
      {
        v5 = *(_WORD *)(a2 + 1);
        a3 = (unsigned int)a3;
      }
      v6 = v5 + 3LL;
      result = 0LL;
      if ( a3 < v6 )
        break;
      LODWORD(a3) = a3 - v6;
      a2 += v6;
      result = 0LL;
    }
    while ( (unsigned int)a3 > 3 );
  }
  return result;
}

//----- (000000000004F368) ----------------------------------------------------
__int64 __fastcall _rijndaelKeySetupEnc(__int64 a1, __int64 a2)
{
  unsigned int v2; // ecx@1
  unsigned int v3; // er15@1
  unsigned int v4; // edx@1
  __int64 v5; // rbx@1
  __int64 result; // rax@1
  __int64 v7; // rsi@1

  v2 = _byteswap_ulong(*(_DWORD *)a2);
  *(_DWORD *)a1 = v2;
  v3 = _byteswap_ulong(*(_DWORD *)(a2 + 4));
  *(_DWORD *)(a1 + 4) = v3;
  v4 = _byteswap_ulong(*(_DWORD *)(a2 + 8));
  *(_DWORD *)(a1 + 8) = v4;
  v5 = (*(_BYTE *)(a2 + 12) << 24) | ((unsigned int)*(_BYTE *)(a2 + 13) << 16);
  LODWORD(result) = _byteswap_ulong(*(_DWORD *)(a2 + 12));
  *(_DWORD *)(a1 + 12) = result;
  v7 = 0LL;
  do
  {
    v2 ^= *(_DWORD *)((char *)rcon + v7) ^ *((_DWORD *)Te4 + (unsigned __int8)((unsigned int)result >> 16)) & 0xFF000000 ^ *((_DWORD *)Te4 + BYTE1(result)) & 0xFF0000 ^ *((_DWORD *)Te4 + (unsigned __int8)result) & 0xFF00 ^ *((_BYTE *)Te4 + 4 * ((unsigned int)result >> 24));
    *(_DWORD *)(a1 + 4 * v7 + 16) = v2;
    v3 ^= v2;
    *(_DWORD *)(a1 + 4 * v7 + 20) = v3;
    v4 ^= v3;
    *(_DWORD *)(a1 + 4 * v7 + 24) = v4;
    result = v4 ^ (unsigned int)result;
    *(_DWORD *)(a1 + 4 * v7 + 28) = result;
    v7 += 4LL;
  }
  while ( v7 != 40 );
  return result;
}
// 78000: using guessed type __int64 Te4[128];
// 78400: using guessed type __int64 rcon[6];

//----- (000000000004F486) ----------------------------------------------------
signed __int64 __fastcall _rijndaelKeySetupDec(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  signed __int64 v3; // rdx@1
  signed __int64 result; // rax@1
  int v5; // esi@2
  int v6; // esi@2
  int v7; // esi@2
  int v8; // esi@2
  signed int v9; // esi@2
  int v10; // ecx@3
  int v11; // edx@3
  int v12; // edx@3
  int v13; // edx@3

  _rijndaelKeySetupEnc(a1, a2);
  v2 = 0LL;
  v3 = 43LL;
  result = 28LL;
  do
  {
    v5 = *(_DWORD *)(a1 + 4 * v2);
    *(_DWORD *)(a1 + 4 * v2) = *(_DWORD *)(a1 + 4 * v3 - 12);
    *(_DWORD *)(a1 + 4 * v3 - 12) = v5;
    v6 = *(_DWORD *)(a1 + 4 * v2 + 4);
    *(_DWORD *)(a1 + 4 * v2 + 4) = *(_DWORD *)(a1 + 4 * v3 - 8);
    *(_DWORD *)(a1 + 4 * v3 - 8) = v6;
    v7 = *(_DWORD *)(a1 + 4 * v2 + 8);
    *(_DWORD *)(a1 + 4 * v2 + 8) = *(_DWORD *)(a1 + 4 * v3 - 4);
    *(_DWORD *)(a1 + 4 * v3 - 4) = v7;
    v8 = *(_DWORD *)(a1 + 4 * v2 + 12);
    *(_DWORD *)(a1 + 4 * v2 + 12) = *(_DWORD *)(a1 + 4 * v3);
    *(_DWORD *)(a1 + 4 * v3) = v8;
    v2 += 4LL;
    v9 = v3 - 7;
    v3 -= 4LL;
  }
  while ( (signed int)v2 < v9 );
  do
  {
    v10 = *(_DWORD *)(a1 + result - 12);
    *(_DWORD *)(a1 + result - 12) = *((_DWORD *)Td3
                                    + *((_BYTE *)Te4 + 4 * (unsigned __int8)*(_DWORD *)(a1 + result - 12))) ^ *((_DWORD *)Td2 + *((_BYTE *)Te4 + 4 * BYTE1(v10))) ^ *((_DWORD *)Td0 + *((_BYTE *)Te4 + 4 * (*(_DWORD *)(a1 + result - 12) >> 24))) ^ *((_DWORD *)Td1 + *((_BYTE *)Te4 + 4 * (unsigned __int8)(*(_DWORD *)(a1 + result - 12) >> 16)));
    v11 = *(_DWORD *)(a1 + result - 8);
    *(_DWORD *)(a1 + result - 8) = *((_DWORD *)Td3 + *((_BYTE *)Te4 + 4 * (unsigned __int8)*(_DWORD *)(a1 + result - 8))) ^ *((_DWORD *)Td2 + *((_BYTE *)Te4 + 4 * BYTE1(v11))) ^ *((_DWORD *)Td0 + *((_BYTE *)Te4 + 4 * (*(_DWORD *)(a1 + result - 8) >> 24))) ^ *((_DWORD *)Td1 + *((_BYTE *)Te4 + 4 * (unsigned __int8)(*(_DWORD *)(a1 + result - 8) >> 16)));
    v12 = *(_DWORD *)(a1 + result - 4);
    *(_DWORD *)(a1 + result - 4) = *((_DWORD *)Td3 + *((_BYTE *)Te4 + 4 * (unsigned __int8)*(_DWORD *)(a1 + result - 4))) ^ *((_DWORD *)Td2 + *((_BYTE *)Te4 + 4 * BYTE1(v12))) ^ *((_DWORD *)Td0 + *((_BYTE *)Te4 + 4 * (*(_DWORD *)(a1 + result - 4) >> 24))) ^ *((_DWORD *)Td1 + *((_BYTE *)Te4 + 4 * (unsigned __int8)(*(_DWORD *)(a1 + result - 4) >> 16)));
    v13 = *(_DWORD *)(a1 + result);
    *(_DWORD *)(a1 + result) = *((_DWORD *)Td3 + *((_BYTE *)Te4 + 4 * (unsigned __int8)*(_DWORD *)(a1 + result))) ^ *((_DWORD *)Td2 + *((_BYTE *)Te4 + 4 * BYTE1(v13))) ^ *((_DWORD *)Td0 + *((_BYTE *)Te4 + 4 * (*(_DWORD *)(a1 + result) >> 24))) ^ *((_DWORD *)Td1 + *((_BYTE *)Te4 + 4 * (unsigned __int8)(*(_DWORD *)(a1 + result) >> 16)));
    result += 16LL;
  }
  while ( (_DWORD)result != 172 );
  return result;
}
// 78000: using guessed type __int64 Te4[128];
// 78430: using guessed type __int64 Td0[128];
// 78830: using guessed type __int64 Td1[128];
// 78C30: using guessed type __int64 Td2[128];
// 79030: using guessed type __int64 Td3[128];

//----- (000000000004F612) ----------------------------------------------------
__int64 __fastcall _rijndaelEncrypt(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // ST28_8@1
  __int64 v4; // ST38_8@1
  unsigned int v5; // ecx@1
  unsigned int v6; // ebx@1
  unsigned int v7; // er12@1
  unsigned int v8; // edx@1
  unsigned int v9; // eax@1
  int v10; // ebx@1
  __int64 v11; // ST40_8@1
  __int64 v12; // ST30_8@1
  unsigned __int8 v13; // si@1
  int v14; // edx@1
  int v15; // ecx@1
  int v16; // eax@1
  int v17; // ST10_4@1
  int v18; // ST08_4@1
  int v19; // er9@1
  int v20; // ebx@1
  int v21; // ecx@1
  int v22; // eax@1
  unsigned int v23; // ST18_4@1
  int v24; // er12@1
  int v25; // edx@1
  int v26; // eax@1
  int v27; // ebx@1
  int v28; // eax@1
  int v29; // er11@1
  __int64 v30; // ST40_8@1
  unsigned int v31; // er9@1
  __int64 v32; // ST20_8@1
  __int64 v33; // ST30_8@1
  int v34; // ebx@1
  int v35; // eax@1
  int v36; // er8@1
  int v37; // ecx@1
  int v38; // er10@1
  int v39; // edi@1
  int v40; // eax@1
  int v41; // edx@1
  int v42; // ST08_4@1
  int v43; // ebx@1
  int v44; // ecx@1
  int v45; // eax@1
  int v46; // ecx@1
  int v47; // edx@1
  int v48; // er12@1
  int v49; // ebx@1
  unsigned int v50; // er9@1
  int v51; // ebx@1
  int v52; // edx@1
  int v53; // eax@1
  unsigned int v54; // er14@1
  __int64 v55; // ST20_8@1
  int v56; // ebx@1
  int v57; // er9@1
  int v58; // edx@1
  int v59; // er9@1
  __int64 v60; // ST08_8@1
  int v61; // eax@1
  int v62; // ecx@1
  int v63; // er12@1
  int v64; // esi@1
  int v65; // edx@1
  int v66; // er9@1
  unsigned int v67; // ebx@1
  int v68; // eax@1
  unsigned int v69; // eax@1
  unsigned int v70; // ebx@1
  int v71; // eax@1
  unsigned int v72; // er9@1
  __int64 result; // rax@1

  v3 = a3;
  v4 = a1;
  v5 = *(_DWORD *)(a1 + 4) ^ _byteswap_ulong(*(_DWORD *)(a2 + 4));
  v6 = *(_DWORD *)(a1 + 8) ^ _byteswap_ulong(*(_DWORD *)(a2 + 8));
  v7 = v6;
  v8 = *(_DWORD *)a1 ^ _byteswap_ulong(*(_DWORD *)a2);
  v9 = *(_DWORD *)(a1 + 12) ^ _byteswap_ulong(*(_DWORD *)(a2 + 12));
  v10 = *((_DWORD *)Te3 + (unsigned __int8)v9) ^ *((_DWORD *)Te2 + BYTE1(v6)) ^ *((_DWORD *)Te0 + (v8 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)(v5 >> 16));
  v11 = (unsigned __int8)v8;
  v12 = BYTE1(v8);
  v13 = v5;
  v14 = *(_DWORD *)(a1 + 28) ^ *((_DWORD *)Te3 + (unsigned __int8)v7) ^ *((_DWORD *)Te2 + BYTE1(v5)) ^ *((_DWORD *)Te0 + (v9 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)(v8 >> 16));
  v15 = *((_DWORD *)Te2 + BYTE1(v9)) ^ *((_DWORD *)Te0 + (v5 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)(v7 >> 16));
  v16 = *(_DWORD *)(a1 + 24) ^ *((_DWORD *)Te3 + v13) ^ *((_DWORD *)Te2 + v12) ^ *((_DWORD *)Te0 + (v7 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)(v9 >> 16));
  v17 = *(_DWORD *)(a1 + 16) ^ v10;
  v18 = *(_DWORD *)(a1 + 20) ^ *((_DWORD *)Te3 + v11) ^ v15;
  v19 = *(_DWORD *)(a1 + 40) ^ *((_DWORD *)Te3 + (unsigned __int8)v18) ^ *((_DWORD *)Te2 + BYTE1(v17)) ^ *((_DWORD *)Te0 + ((unsigned int)v16 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v14 >> 16));
  v20 = *(_DWORD *)(a1 + 44) ^ *((_DWORD *)Te3 + (unsigned __int8)v16) ^ *((_DWORD *)Te2 + BYTE1(v18)) ^ *((_DWORD *)Te0 + ((unsigned int)v14 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v17 >> 16));
  v21 = *(_DWORD *)(a1 + 36) ^ *((_DWORD *)Te3 + (unsigned __int8)v17) ^ *((_DWORD *)Te2 + BYTE1(v14)) ^ *((_DWORD *)Te0 + ((unsigned int)v18 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v16 >> 16));
  v22 = *(_DWORD *)(a1 + 32) ^ *((_DWORD *)Te3 + (unsigned __int8)v14) ^ *((_DWORD *)Te2 + BYTE1(v16)) ^ *((_DWORD *)Te0 + ((unsigned int)v17 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v18 >> 16));
  v23 = v22;
  v24 = *(_DWORD *)(a1 + 52) ^ *((_DWORD *)Te3 + (unsigned __int8)v22) ^ *((_DWORD *)Te2 + BYTE1(v20)) ^ *((_DWORD *)Te0 + ((unsigned int)v21 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v19 >> 16));
  v25 = *(_DWORD *)(a1 + 56) ^ *((_DWORD *)Te3 + (unsigned __int8)v21) ^ *((_DWORD *)Te2 + BYTE1(v22)) ^ *((_DWORD *)Te0 + ((unsigned int)v19 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v20 >> 16));
  v26 = *((_DWORD *)Te2 + BYTE1(v21)) ^ *((_DWORD *)Te0 + ((unsigned int)v20 >> 24)) ^ *((_DWORD *)Te1
                                                                                       + (unsigned __int8)((unsigned int)v22 >> 16));
  v27 = *(_DWORD *)(a1 + 48) ^ *((_DWORD *)Te3 + (unsigned __int8)v20) ^ *((_DWORD *)Te2 + BYTE1(v19)) ^ *((_DWORD *)Te0 + (v23 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v21 >> 16));
  v28 = *(_DWORD *)(a1 + 60) ^ *((_DWORD *)Te3 + (unsigned __int8)v19) ^ v26;
  v29 = *((_DWORD *)Te3 + (unsigned __int8)v28) ^ *((_DWORD *)Te2 + BYTE1(v25)) ^ *((_DWORD *)Te0
                                                                                  + ((unsigned int)v27 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v24 >> 16));
  v30 = (unsigned __int8)v27;
  v31 = v28;
  v32 = BYTE1(v28);
  v33 = BYTE1(v27);
  v34 = *(_DWORD *)(a1 + 76) ^ *((_DWORD *)Te3 + (unsigned __int8)v25) ^ *((_DWORD *)Te2 + BYTE1(v24)) ^ *((_DWORD *)Te0 + ((unsigned int)v28 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v27 >> 16));
  v35 = *(_DWORD *)(a1 + 64) ^ v29;
  v36 = *(_DWORD *)(a1 + 64) ^ v29;
  v37 = *(_DWORD *)(a1 + 72) ^ *((_DWORD *)Te3 + (unsigned __int8)v24) ^ *((_DWORD *)Te2 + v33) ^ *((_DWORD *)Te0
                                                                                                  + ((unsigned int)v25 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)(v31 >> 16));
  v38 = *(_DWORD *)(a1 + 68) ^ *((_DWORD *)Te3 + v30) ^ *((_DWORD *)Te2 + v32) ^ *((_DWORD *)Te0
                                                                                 + ((unsigned int)v24 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v25 >> 16));
  v39 = *(_DWORD *)(a1 + 88) ^ *((_DWORD *)Te3 + (unsigned __int8)v38) ^ *((_DWORD *)Te2 + BYTE1(v35)) ^ *((_DWORD *)Te0 + ((unsigned int)v37 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v34 >> 16));
  v40 = *(_DWORD *)(v4 + 92) ^ *((_DWORD *)Te3 + (unsigned __int8)v37) ^ *((_DWORD *)Te2 + BYTE1(v38)) ^ *((_DWORD *)Te0 + ((unsigned int)v34 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v36 >> 16));
  v41 = *(_DWORD *)(v4 + 84) ^ *((_DWORD *)Te3 + (unsigned __int8)v36) ^ *((_DWORD *)Te2 + BYTE1(v34)) ^ *((_DWORD *)Te0 + ((unsigned int)v38 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v37 >> 16));
  v42 = *(_DWORD *)(v4 + 80) ^ *((_DWORD *)Te3 + (unsigned __int8)v34) ^ *((_DWORD *)Te2 + BYTE1(v37)) ^ *((_DWORD *)Te0 + ((unsigned int)v36 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v38 >> 16));
  LODWORD(v30) = *(_DWORD *)(v4 + 100) ^ *((_DWORD *)Te3 + (unsigned __int8)v42) ^ *((_DWORD *)Te2 + BYTE1(v40)) ^ *((_DWORD *)Te0 + ((unsigned int)v41 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v39 >> 16));
  v43 = *(_DWORD *)(v4 + 104) ^ *((_DWORD *)Te3 + (unsigned __int8)v41) ^ *((_DWORD *)Te2 + BYTE1(v42)) ^ *((_DWORD *)Te0 + ((unsigned int)v39 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v40 >> 16));
  LOBYTE(v23) = *(_BYTE *)(v4 + 104) ^ *((_BYTE *)Te3 + 4 * (unsigned __int8)v41) ^ *((_BYTE *)Te2 + 4 * BYTE1(v42)) ^ *((_BYTE *)Te0 + 4 * ((unsigned int)v39 >> 24)) ^ *((_BYTE *)Te1 + 4 * (unsigned __int8)((unsigned int)v40 >> 16));
  v44 = *((_DWORD *)Te2 + BYTE1(v41)) ^ *((_DWORD *)Te0 + ((unsigned int)v40 >> 24)) ^ *((_DWORD *)Te1
                                                                                       + (unsigned __int8)((unsigned int)v42 >> 16));
  v45 = *(_DWORD *)(v4 + 96) ^ *((_DWORD *)Te3 + (unsigned __int8)v40) ^ *((_DWORD *)Te2 + BYTE1(v39)) ^ *((_DWORD *)Te0 + ((unsigned int)v42 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v41 >> 16));
  v46 = *(_DWORD *)(v4 + 108) ^ *((_DWORD *)Te3 + (unsigned __int8)v39) ^ v44;
  v47 = *((_DWORD *)Te3 + (unsigned __int8)v46) ^ *((_DWORD *)Te2 + BYTE1(v43)) ^ *((_DWORD *)Te0
                                                                                  + ((unsigned int)v45 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v30 >> 16));
  v48 = *(_DWORD *)(v4 + 116) ^ *((_DWORD *)Te3 + (unsigned __int8)v45) ^ *((_DWORD *)Te2 + BYTE1(v46)) ^ *((_DWORD *)Te0 + ((unsigned int)v30 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v43 >> 16));
  v49 = *(_DWORD *)(v4 + 120) ^ *((_DWORD *)Te3 + (unsigned __int8)v30) ^ *((_DWORD *)Te2 + BYTE1(v45)) ^ *((_DWORD *)Te0 + ((unsigned int)v43 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v46 >> 16));
  v50 = v49;
  v51 = *((_DWORD *)Te2 + BYTE1(v49)) ^ *((_DWORD *)Te0 + ((*(_DWORD *)(v4 + 112) ^ (unsigned int)v47) >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v48 >> 16));
  v52 = *(_DWORD *)(v4 + 112) ^ v47;
  v53 = *(_DWORD *)(v4 + 124) ^ *((_DWORD *)Te3 + (unsigned __int8)v23) ^ *((_DWORD *)Te2 + BYTE1(v30)) ^ *((_DWORD *)Te0 + ((unsigned int)v46 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v45 >> 16));
  v54 = v50;
  v55 = (unsigned __int8)v52;
  v56 = *(_DWORD *)(v4 + 128) ^ *((_DWORD *)Te3 + (unsigned __int8)v53) ^ v51;
  v57 = *((_DWORD *)Te3 + (unsigned __int8)v48) ^ *((_DWORD *)Te2 + BYTE1(v52)) ^ *((_DWORD *)Te0 + (v50 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v53 >> 16));
  v58 = *(_DWORD *)(v4 + 140) ^ *((_DWORD *)Te3 + (unsigned __int8)v54) ^ *((_DWORD *)Te2 + BYTE1(v48)) ^ *((_DWORD *)Te0 + ((unsigned int)v53 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v52 >> 16));
  v59 = *(_DWORD *)(v4 + 136) ^ v57;
  v60 = BYTE1(v58);
  v61 = *(_DWORD *)(v4 + 132) ^ *((_DWORD *)Te3 + v55) ^ *((_DWORD *)Te2 + BYTE1(v53)) ^ *((_DWORD *)Te0
                                                                                         + ((unsigned int)v48 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)(v54 >> 16));
  v62 = *(_DWORD *)(v4 + 156) ^ *((_DWORD *)Te3 + (unsigned __int8)v59) ^ *((_DWORD *)Te2 + BYTE1(v61)) ^ *((_DWORD *)Te0 + ((unsigned int)v58 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v56 >> 16));
  v63 = *(_DWORD *)(v4 + 152) ^ *((_DWORD *)Te3 + (unsigned __int8)v61) ^ *((_DWORD *)Te2 + BYTE1(v56)) ^ *((_DWORD *)Te0 + ((unsigned int)v59 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v58 >> 16));
  v64 = *((_DWORD *)Te4 + BYTE1(v63));
  v65 = *(_DWORD *)(v4 + 144) ^ *((_DWORD *)Te3 + (unsigned __int8)v58) ^ *((_DWORD *)Te2 + BYTE1(v59)) ^ *((_DWORD *)Te0 + ((unsigned int)v56 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v61 >> 16));
  v66 = *(_DWORD *)(v4 + 148) ^ *((_DWORD *)Te3 + (unsigned __int8)v56) ^ *((_DWORD *)Te2 + v60) ^ *((_DWORD *)Te0 + ((unsigned int)v61 >> 24)) ^ *((_DWORD *)Te1 + (unsigned __int8)((unsigned int)v59 >> 16));
  v67 = *((_DWORD *)Te4 + ((unsigned int)v65 >> 24)) & 0xFF000000 | *((_DWORD *)Te4
                                                                    + (unsigned __int8)((unsigned int)v66 >> 16)) & 0xFF0000;
  v68 = *(_DWORD *)(v4 + 160) ^ (v67 | (unsigned __int16)(v64 & 0xFF00) | *((_BYTE *)Te4 + 4 * (unsigned __int8)v62));
  *(_BYTE *)v3 = (unsigned int)v68 >> 24;
  *(_BYTE *)(v3 + 1) = (unsigned int)v68 >> 16;
  *(_BYTE *)(v3 + 2) = BYTE1(v68);
  *(_BYTE *)(v3 + 3) = v68;
  v69 = *(_DWORD *)(v4 + 164) ^ (*((_DWORD *)Te4 + ((unsigned int)v66 >> 24)) & 0xFF000000 | *((_DWORD *)Te4
                                                                                             + (unsigned __int8)((unsigned int)v63 >> 16)) & 0xFF0000 | *((_DWORD *)Te4 + BYTE1(v62)) & 0xFF00 | *((_BYTE *)Te4 + 4 * (unsigned __int8)v65));
  *(_BYTE *)(v3 + 4) = v69 >> 24;
  *(_BYTE *)(v3 + 5) = v69 >> 16;
  *(_BYTE *)(v3 + 6) = BYTE1(v69);
  *(_BYTE *)(v3 + 7) = v69;
  v70 = *((_DWORD *)Te4 + ((unsigned int)v63 >> 24)) & 0xFF000000 | *((_DWORD *)Te4
                                                                    + (unsigned __int8)((unsigned int)v62 >> 16)) & 0xFF0000;
  v71 = *(_DWORD *)(v4 + 168) ^ (v70 | *((_DWORD *)Te4 + BYTE1(v65)) & 0xFF00 | *((_BYTE *)Te4 + 4
                                                                                               * (unsigned __int8)v66));
  *(_BYTE *)(v3 + 8) = (unsigned int)v71 >> 24;
  *(_BYTE *)(v3 + 9) = (unsigned int)v71 >> 16;
  *(_BYTE *)(v3 + 10) = BYTE1(v71);
  *(_BYTE *)(v3 + 11) = v71;
  v72 = *((_DWORD *)Te4 + ((unsigned int)v62 >> 24)) & 0xFF000000 | *((_DWORD *)Te4
                                                                    + (unsigned __int8)((unsigned int)v65 >> 16)) & 0xFF0000 | *((_DWORD *)Te4 + BYTE1(v66)) & 0xFF00;
  result = *(_DWORD *)(v4 + 172) ^ (v72 | *((_BYTE *)Te4 + 4 * (unsigned __int8)v63));
  *(_BYTE *)(v3 + 12) = (*(_DWORD *)(v4 + 172) ^ (v72 | *((_BYTE *)Te4 + 4 * (unsigned __int8)v63))) >> 24;
  *(_BYTE *)(v3 + 13) = (unsigned int)result >> 16;
  *(_BYTE *)(v3 + 14) = BYTE1(result);
  *(_BYTE *)(v3 + 15) = result;
  return result;
}
// 78000: using guessed type __int64 Te4[128];
// 79430: using guessed type __int64 Te0[128];
// 79830: using guessed type __int64 Te1[128];
// 79C30: using guessed type __int64 Te2[128];
// 7A030: using guessed type __int64 Te3[30];

//----- (00000000000500B4) ----------------------------------------------------
__int64 __fastcall _rijndaelDecrypt(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // ST20_8@1
  __int64 v4; // ST28_8@1
  unsigned int v5; // ebx@1
  unsigned int v6; // er8@1
  int v7; // er12@1
  unsigned int v8; // edx@1
  unsigned int v9; // eax@1
  __int64 v10; // ST38_8@1
  int v11; // ecx@1
  unsigned int v12; // edi@1
  __int64 v13; // ST30_8@1
  int v14; // edx@1
  int v15; // ecx@1
  int v16; // ebx@1
  int v17; // eax@1
  int v18; // ebx@1
  __int64 v19; // ST18_8@1
  __int64 v20; // ST10_8@1
  int v21; // edi@1
  int v22; // edx@1
  __int64 v23; // r8@1
  unsigned int v24; // er14@1
  int v25; // edx@1
  int v26; // ebx@1
  int v27; // edx@1
  int v28; // edi@1
  int v29; // ecx@1
  int v30; // eax@1
  int v31; // edx@1
  int v32; // eax@1
  __int64 v33; // ST38_8@1
  int v34; // er10@1
  __int64 v35; // ST18_8@1
  unsigned int v36; // er12@1
  int v37; // edx@1
  int v38; // ebx@1
  int v39; // ecx@1
  int v40; // eax@1
  int v41; // ecx@1
  __int64 v42; // ST18_8@1
  __int64 v43; // ST10_8@1
  int v44; // edi@1
  int v45; // ST08_4@1
  int v46; // er11@1
  int v47; // edx@1
  int v48; // ebx@1
  int v49; // edx@1
  int v50; // esi@1
  int v51; // ecx@1
  int v52; // eax@1
  int v53; // edx@1
  int v54; // eax@1
  __int64 v55; // ST38_8@1
  __int64 v56; // ST10_8@1
  int v57; // er11@1
  int v58; // edx@1
  __int64 v59; // r15@1
  unsigned int v60; // ebx@1
  int v61; // edx@1
  int v62; // eax@1
  int v63; // er10@1
  int v64; // er9@1
  int v65; // edx@1
  int v66; // ecx@1
  int v67; // eax@1
  __int64 v68; // ST30_8@1
  __int64 v69; // r8@1
  int v70; // ecx@1
  int v71; // er11@1
  int v72; // edx@1
  unsigned int v73; // ebx@1
  unsigned int v74; // ebx@1
  unsigned int v75; // edi@1
  int v76; // ebx@1
  unsigned int v77; // er9@1
  __int64 result; // rax@1

  v3 = a3;
  v4 = a1;
  v5 = *(_DWORD *)a1 ^ _byteswap_ulong(*(_DWORD *)a2);
  v6 = _byteswap_ulong(*(_DWORD *)(a2 + 4));
  v7 = *(_DWORD *)(a1 + 4) ^ v6;
  v8 = *(_DWORD *)(a1 + 8) ^ _byteswap_ulong(*(_DWORD *)(a2 + 8));
  v9 = *(_DWORD *)(a1 + 12) ^ _byteswap_ulong(*(_DWORD *)(a2 + 12));
  v10 = (unsigned __int8)v8;
  v11 = *((_DWORD *)Td3 + (unsigned __int8)v9) ^ *((_DWORD *)Td2 + BYTE1(v5)) ^ *((_DWORD *)Td0 + (v8 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v7 >> 16));
  v12 = v5;
  v13 = BYTE1(v8);
  v14 = *(_DWORD *)(v4 + 28) ^ *((_DWORD *)Td3 + (unsigned __int8)v5) ^ *((_DWORD *)Td2 + BYTE1(v7)) ^ *((_DWORD *)Td0 + (v9 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)(v8 >> 16));
  v15 = *(_DWORD *)(v4 + 24) ^ v11;
  v16 = *((_DWORD *)Td2 + BYTE1(v9)) ^ *((_DWORD *)Td0 + ((unsigned int)v7 >> 24)) ^ *((_DWORD *)Td1
                                                                                     + (unsigned __int8)(v5 >> 16));
  v17 = *(_DWORD *)(v4 + 16) ^ *((_DWORD *)Td3 + (unsigned __int8)v7) ^ *((_DWORD *)Td2 + v13) ^ *((_DWORD *)Td0
                                                                                                 + (v12 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)(v9 >> 16));
  v18 = *(_DWORD *)(v4 + 20) ^ *((_DWORD *)Td3 + v10) ^ v16;
  v19 = (unsigned __int8)v14;
  v20 = BYTE1(v14);
  v21 = *(_DWORD *)(v4 + 32) ^ *((_DWORD *)Td3 + (unsigned __int8)v18) ^ *((_DWORD *)Td2 + BYTE1(v15)) ^ *((_DWORD *)Td0 + ((unsigned int)v17 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v14 >> 16));
  LODWORD(v10) = v21;
  v22 = *(_DWORD *)(v4 + 44) ^ *((_DWORD *)Td3 + (unsigned __int8)v17) ^ *((_DWORD *)Td2 + BYTE1(v18)) ^ *((_DWORD *)Td0 + ((unsigned int)v14 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v15 >> 16));
  v23 = BYTE1(v22);
  v24 = v22;
  v25 = *((_DWORD *)Td2 + BYTE1(v17)) ^ *((_DWORD *)Td0 + ((unsigned int)v15 >> 24)) ^ *((_DWORD *)Td1
                                                                                       + (unsigned __int8)((unsigned int)v18 >> 16));
  v26 = *(_DWORD *)(v4 + 36) ^ *((_DWORD *)Td3 + (unsigned __int8)v15) ^ *((_DWORD *)Td2 + v20) ^ *((_DWORD *)Td0
                                                                                                  + ((unsigned int)v18 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v17 >> 16));
  v27 = *(_DWORD *)(v4 + 40) ^ *((_DWORD *)Td3 + v19) ^ v25;
  v28 = *(_DWORD *)(v4 + 52) ^ *((_DWORD *)Td3 + (unsigned __int8)v27) ^ *((_DWORD *)Td2 + v23) ^ *((_DWORD *)Td0
                                                                                                  + ((unsigned int)v26 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v21 >> 16));
  v29 = *(_DWORD *)(v4 + 48) ^ *((_DWORD *)Td3 + (unsigned __int8)v26) ^ *((_DWORD *)Td2 + BYTE1(v27)) ^ *((_DWORD *)Td0 + ((unsigned int)v10 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)(v24 >> 16));
  v30 = *((_DWORD *)Td2 + BYTE1(v26)) ^ *((_DWORD *)Td0 + (v24 >> 24)) ^ *((_DWORD *)Td1
                                                                         + (unsigned __int8)((unsigned int)v27 >> 16));
  v31 = *(_DWORD *)(v4 + 56) ^ *((_DWORD *)Td3 + (unsigned __int8)v24) ^ *((_DWORD *)Td2 + BYTE1(v10)) ^ *((_DWORD *)Td0 + ((unsigned int)v27 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v26 >> 16));
  v32 = *(_DWORD *)(v4 + 60) ^ *((_DWORD *)Td3 + (unsigned __int8)v10) ^ v30;
  v33 = (unsigned __int8)v31;
  v34 = *((_DWORD *)Td3 + (unsigned __int8)v32) ^ *((_DWORD *)Td2 + BYTE1(v29)) ^ *((_DWORD *)Td0
                                                                                  + ((unsigned int)v31 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v28 >> 16));
  v35 = BYTE1(v31);
  v36 = v29;
  v37 = *(_DWORD *)(v4 + 76) ^ *((_DWORD *)Td3 + (unsigned __int8)v29) ^ *((_DWORD *)Td2 + BYTE1(v28)) ^ *((_DWORD *)Td0 + ((unsigned int)v32 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v31 >> 16));
  v38 = *(_DWORD *)(v4 + 72) ^ v34;
  v39 = *((_DWORD *)Td2 + BYTE1(v32)) ^ *((_DWORD *)Td0 + ((unsigned int)v28 >> 24)) ^ *((_DWORD *)Td1
                                                                                       + (unsigned __int8)((unsigned int)v29 >> 16));
  v40 = *(_DWORD *)(v4 + 64) ^ *((_DWORD *)Td3 + (unsigned __int8)v28) ^ *((_DWORD *)Td2 + v35) ^ *((_DWORD *)Td0
                                                                                                  + (v36 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v32 >> 16));
  v41 = *(_DWORD *)(v4 + 68) ^ *((_DWORD *)Td3 + v33) ^ v39;
  v42 = (unsigned __int8)v37;
  v43 = BYTE1(v37);
  v44 = *(_DWORD *)(v4 + 80) ^ *((_DWORD *)Td3 + (unsigned __int8)v41) ^ *((_DWORD *)Td2 + BYTE1(v38)) ^ *((_DWORD *)Td0 + ((unsigned int)v40 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v37 >> 16));
  v45 = *(_DWORD *)(v4 + 92) ^ *((_DWORD *)Td3 + (unsigned __int8)v40) ^ *((_DWORD *)Td2 + BYTE1(v41)) ^ *((_DWORD *)Td0 + ((unsigned int)v37 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v38 >> 16));
  v46 = *(_DWORD *)(v4 + 92) ^ *((_DWORD *)Td3 + (unsigned __int8)v40) ^ *((_DWORD *)Td2 + BYTE1(v41)) ^ *((_DWORD *)Td0 + ((unsigned int)v37 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v38 >> 16));
  v47 = *((_DWORD *)Td0 + ((unsigned int)v38 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v41 >> 16));
  v48 = *(_DWORD *)(v4 + 84) ^ *((_DWORD *)Td3 + (unsigned __int8)(*(_BYTE *)(v4 + 72) ^ v34)) ^ *((_DWORD *)Td2 + v43) ^ *((_DWORD *)Td0 + ((unsigned int)v41 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v40 >> 16));
  v49 = *(_DWORD *)(v4 + 88) ^ *((_DWORD *)Td3 + v42) ^ *((_DWORD *)Td2 + BYTE1(v40)) ^ v47;
  v50 = *(_DWORD *)(v4 + 100) ^ *((_DWORD *)Td3 + (unsigned __int8)v49) ^ *((_DWORD *)Td2 + BYTE1(v45)) ^ *((_DWORD *)Td0 + ((unsigned int)v48 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v44 >> 16));
  v51 = *(_DWORD *)(v4 + 96) ^ *((_DWORD *)Td3 + (unsigned __int8)v48) ^ *((_DWORD *)Td2 + BYTE1(v49)) ^ *((_DWORD *)Td0 + ((unsigned int)v44 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v46 >> 16));
  v52 = *((_DWORD *)Td2 + BYTE1(v48)) ^ *((_DWORD *)Td0 + ((unsigned int)v45 >> 24)) ^ *((_DWORD *)Td1
                                                                                       + (unsigned __int8)((unsigned int)v49 >> 16));
  v53 = *(_DWORD *)(v4 + 104) ^ *((_DWORD *)Td3 + (unsigned __int8)v46) ^ *((_DWORD *)Td2 + BYTE1(v44)) ^ *((_DWORD *)Td0 + ((unsigned int)v49 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v48 >> 16));
  v54 = *(_DWORD *)(v4 + 108) ^ *((_DWORD *)Td3 + (unsigned __int8)v44) ^ v52;
  v55 = (unsigned __int8)v53;
  LODWORD(v23) = *((_DWORD *)Td3 + (unsigned __int8)v54) ^ *((_DWORD *)Td2 + BYTE1(v51)) ^ *((_DWORD *)Td0
                                                                                           + ((unsigned int)v53 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v50 >> 16));
  v56 = BYTE1(v53);
  v57 = *(_DWORD *)(v4 + 124) ^ *((_DWORD *)Td3 + (unsigned __int8)v51) ^ *((_DWORD *)Td2 + BYTE1(v50)) ^ *((_DWORD *)Td0 + ((unsigned int)v54 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v53 >> 16));
  v58 = *(_DWORD *)(v4 + 120) ^ v23;
  v59 = BYTE1(v58);
  v60 = *(_DWORD *)(v4 + 120) ^ v23;
  v61 = *((_DWORD *)Td2 + BYTE1(v54)) ^ *((_DWORD *)Td0 + ((unsigned int)v50 >> 24)) ^ *((_DWORD *)Td1
                                                                                       + (unsigned __int8)((unsigned int)v51 >> 16));
  v62 = *(_DWORD *)(v4 + 112) ^ *((_DWORD *)Td3 + (unsigned __int8)v50) ^ *((_DWORD *)Td2 + v56) ^ *((_DWORD *)Td0 + ((unsigned int)v51 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v54 >> 16));
  v63 = *(_DWORD *)(v4 + 116) ^ *((_DWORD *)Td3 + v55) ^ v61;
  v64 = *(_DWORD *)(v4 + 128) ^ *((_DWORD *)Td3 + (unsigned __int8)v63) ^ *((_DWORD *)Td2 + v59) ^ *((_DWORD *)Td0 + ((unsigned int)v62 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v57 >> 16));
  v65 = *(_DWORD *)(v4 + 140) ^ *((_DWORD *)Td3 + (unsigned __int8)v62) ^ *((_DWORD *)Td2 + BYTE1(v63)) ^ *((_DWORD *)Td0 + ((unsigned int)v57 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)(v60 >> 16));
  v66 = *(_DWORD *)(v4 + 132) ^ *((_DWORD *)Td3 + (unsigned __int8)(*(_BYTE *)(v4 + 120) ^ v23)) ^ *((_DWORD *)Td2 + BYTE1(v57)) ^ *((_DWORD *)Td0 + ((unsigned int)v63 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v62 >> 16));
  v67 = *(_DWORD *)(v4 + 136) ^ *((_DWORD *)Td3 + (unsigned __int8)v57) ^ *((_DWORD *)Td2 + BYTE1(v62)) ^ *((_DWORD *)Td0 + (v60 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v63 >> 16));
  v68 = (unsigned __int8)v66;
  LODWORD(v55) = *(_DWORD *)(v4 + 148) ^ *((_DWORD *)Td3 + (unsigned __int8)v67) ^ *((_DWORD *)Td2 + BYTE1(v65)) ^ *((_DWORD *)Td0 + ((unsigned int)v66 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v64 >> 16));
  v69 = BYTE1(v66);
  v70 = *(_DWORD *)(v4 + 152) ^ *((_DWORD *)Td3 + (unsigned __int8)v65) ^ *((_DWORD *)Td2 + BYTE1(v64)) ^ *((_DWORD *)Td0 + ((unsigned int)v67 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v66 >> 16));
  v71 = *(_DWORD *)(v4 + 144) ^ *((_DWORD *)Td3 + v68) ^ *((_DWORD *)Td2 + BYTE1(v67)) ^ *((_DWORD *)Td0
                                                                                         + ((unsigned int)v64 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v65 >> 16));
  v72 = *(_DWORD *)(v4 + 156) ^ *((_DWORD *)Td3 + (unsigned __int8)v64) ^ *((_DWORD *)Td2 + v69) ^ *((_DWORD *)Td0 + ((unsigned int)v65 >> 24)) ^ *((_DWORD *)Td1 + (unsigned __int8)((unsigned int)v67 >> 16));
  v73 = *(_DWORD *)(v4 + 160) ^ (*((_DWORD *)Td4 + ((unsigned int)v71 >> 24)) & 0xFF000000 | *((_DWORD *)Td4
                                                                                             + (unsigned __int8)((unsigned int)v72 >> 16)) & 0xFF0000 | *((_DWORD *)Td4 + BYTE1(v70)) & 0xFF00 | *((_BYTE *)Td4 + 4 * (unsigned __int8)v55));
  *(_BYTE *)v3 = BYTE3(v73);
  *(_BYTE *)(v3 + 1) = v73 >> 16;
  *(_BYTE *)(v3 + 2) = BYTE1(v73);
  *(_BYTE *)(v3 + 3) = v73;
  v74 = *(_DWORD *)(v4 + 164) ^ (*((_DWORD *)Td4 + ((unsigned int)v55 >> 24)) & 0xFF000000 | *((_DWORD *)Td4
                                                                                             + (unsigned __int8)((unsigned int)v71 >> 16)) & 0xFF0000 | *((_DWORD *)Td4 + BYTE1(v72)) & 0xFF00 | *((_BYTE *)Td4 + 4 * (unsigned __int8)v70));
  *(_BYTE *)(v3 + 4) = v74 >> 24;
  *(_BYTE *)(v3 + 5) = v74 >> 16;
  *(_BYTE *)(v3 + 6) = BYTE1(v74);
  *(_BYTE *)(v3 + 7) = v74;
  v75 = *((_DWORD *)Td4 + ((unsigned int)v70 >> 24)) & 0xFF000000 | *((_DWORD *)Td4
                                                                    + (unsigned __int8)((unsigned int)v55 >> 16)) & 0xFF0000;
  v76 = *(_DWORD *)(v4 + 168) ^ (v75 | *((_DWORD *)Td4 + BYTE1(v71)) & 0xFF00 | *((_BYTE *)Td4 + 4
                                                                                               * (unsigned __int8)v72));
  *(_BYTE *)(v3 + 8) = (unsigned int)v76 >> 24;
  *(_BYTE *)(v3 + 9) = (unsigned int)v76 >> 16;
  *(_BYTE *)(v3 + 10) = BYTE1(v76);
  *(_BYTE *)(v3 + 11) = v76;
  v77 = *((_DWORD *)Td4 + ((unsigned int)v72 >> 24)) & 0xFF000000 | *((_DWORD *)Td4
                                                                    + (unsigned __int8)((unsigned int)v70 >> 16)) & 0xFF0000 | *((_DWORD *)Td4 + BYTE1(v55)) & 0xFF00;
  result = *(_DWORD *)(v4 + 172) ^ (v77 | *((_BYTE *)Td4 + 4 * (unsigned __int8)v71));
  *(_BYTE *)(v3 + 12) = (*(_DWORD *)(v4 + 172) ^ (v77 | *((_BYTE *)Td4 + 4 * (unsigned __int8)v71))) >> 24;
  *(_BYTE *)(v3 + 13) = (unsigned int)result >> 16;
  *(_BYTE *)(v3 + 14) = BYTE1(result);
  *(_BYTE *)(v3 + 15) = result;
  return result;
}
// 78430: using guessed type __int64 Td0[128];
// 78830: using guessed type __int64 Td1[128];
// 78C30: using guessed type __int64 Td2[128];
// 79030: using guessed type __int64 Td3[128];
// 7A430: using guessed type __int64 Td4[128];

//----- (0000000000050B72) ----------------------------------------------------
__int64 __fastcall aes_wrap(__int64 a1, int a2, const void *a3, void *a4)
{
  const void *v4; // r14@1
  int v5; // er13@1
  void *v6; // r12@1
  int v7; // eax@1
  int v8; // ecx@1
  int v9; // er12@2
  int v10; // eax@2
  const void *v11; // r14@2
  int v12; // ST28_4@3
  void *v14; // [sp+8h] [bp-118h]@1
  void *v15; // [sp+10h] [bp-110h]@1
  int v16; // [sp+20h] [bp-100h]@2
  int v17; // [sp+24h] [bp-FCh]@2
  char v18; // [sp+30h] [bp-F0h]@1
  char v19; // [sp+E0h] [bp-40h]@3
  char v20; // [sp+E8h] [bp-38h]@3
  __int64 v21; // [sp+F0h] [bp-30h]@1

  v14 = a4;
  v4 = a3;
  v5 = a2;
  v21 = *(_QWORD *)off_7B078[0];
  v6 = (char *)a4 + 8;
  v15 = (char *)a4 + 8;
  memset(a4, 166, 8uLL);
  memcpy(v6, v4, 8 * a2);
  _rijndaelKeySetupEnc((__int64)&v18, a1);
  v7 = 0;
  v8 = 1;
  do
  {
    v16 = v8;
    v17 = v7;
    v9 = v8;
    v10 = v5;
    v11 = v15;
    if ( v5 > 0 )
    {
      do
      {
        v12 = v10;
        memcpy(&v19, v14, 8uLL);
        memcpy(&v20, v11, 8uLL);
        _rijndaelEncrypt((__int64)&v18, (__int64)&v19, (__int64)&v19);
        memcpy(v14, &v19, 8uLL);
        *((_BYTE *)v14 + 7) ^= v9;
        memcpy((void *)v11, &v20, 8uLL);
        v11 = (char *)v11 + 8;
        ++v9;
        v10 = v12 - 1;
      }
      while ( v12 != 1 );
    }
    v7 = v17 + 1;
    v5 = a2;
    v8 = a2 + v16;
  }
  while ( v17 != 5 );
  return *(_QWORD *)off_7B078[0];
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000050CE7) ----------------------------------------------------
signed __int64 __fastcall aes_unwrap(__int64 a1, int a2, const void *a3, void *a4)
{
  void *v4; // r14@1
  const void *v5; // rbx@1
  int v6; // er12@1
  char *v7; // rdx@1
  int v8; // ecx@1
  int v9; // eax@1
  int v10; // ebx@2
  const void *v11; // r14@2
  void *i; // r15@2
  __int64 v13; // rcx@5
  signed __int64 result; // rax@6
  __int64 v15; // rcx@8
  void *v16; // [sp+10h] [bp-120h]@1
  int v17; // [sp+20h] [bp-110h]@2
  int v18; // [sp+2Ch] [bp-104h]@2
  char v19; // [sp+30h] [bp-100h]@1
  char v20; // [sp+E0h] [bp-50h]@3
  char v21; // [sp+E7h] [bp-49h]@3
  char v22; // [sp+E8h] [bp-48h]@1
  char v23[8]; // [sp+F8h] [bp-38h]@1
  __int64 v24; // [sp+100h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v24 = *(_QWORD *)off_7B078[0];
  memcpy(v23, a3, 8uLL);
  memcpy(v4, (char *)v5 + 8, 8 * a2);
  _rijndaelKeySetupDec((__int64)&v19, a1);
  v16 = (char *)v4 + 8 * a2 - 8;
  v7 = &v22;
  v8 = 6 * a2;
  v9 = 5;
  do
  {
    v17 = v9;
    v18 = v8;
    v10 = v8;
    v11 = v16;
    for ( i = v7; v6 > 0; --v10 )
    {
      memcpy(&v20, v23, 8uLL);
      v21 ^= v10;
      memcpy(i, v11, 8uLL);
      _rijndaelDecrypt((__int64)&v19, (__int64)&v20, (__int64)&v20);
      memcpy(v23, &v20, 8uLL);
      memcpy((void *)v11, i, 8uLL);
      v11 = (char *)v11 - 8;
      --v6;
    }
    v7 = (char *)i;
    v6 = a2;
    v8 = v18 - a2;
    v9 = v17 - 1;
  }
  while ( v17 > 0 );
  v13 = 0LL;
  do
  {
    result = 0xFFFFFFFFLL;
    if ( (unsigned __int8)v23[v13] != 166 )
      break;
    ++v13;
    result = 0LL;
  }
  while ( (signed int)v13 <= 7 );
  v15 = *(_QWORD *)off_7B078[0];
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 50CE7: using guessed type char var_38[8];

//----- (0000000000050E70) ----------------------------------------------------
__int64 __fastcall omac1_aes_128(__int64 a1, signed __int64 a2, unsigned __int64 a3, __int64 a4)
{
  __int64 v4; // r13@1
  unsigned __int64 v5; // r14@1
  signed __int64 v6; // r12@1
  signed __int64 v7; // r15@2
  signed __int64 v8; // r13@2
  __int64 v9; // rax@3
  unsigned __int64 v10; // r15@8
  __int64 v11; // rbx@10
  __int64 v12; // rax@12
  __int64 v13; // rcx@13
  unsigned __int64 v15; // [sp+8h] [bp-118h]@2
  __int64 v16; // [sp+10h] [bp-110h]@2
  unsigned __int64 v17; // [sp+18h] [bp-108h]@2
  char v18; // [sp+20h] [bp-100h]@1
  char v19[16]; // [sp+D0h] [bp-50h]@10
  char v20[16]; // [sp+E0h] [bp-40h]@1
  __int64 v21; // [sp+F0h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v21 = *(_QWORD *)off_7B078[0];
  _rijndaelKeySetupEnc((__int64)&v18, a1);
  memset(v20, 0, 0x10uLL);
  if ( v5 < 0x10 )
  {
    v10 = v5;
    v17 = v5;
  }
  else
  {
    v16 = v4;
    v7 = v5 - 16;
    v15 = (v5 - 16) & 0xFFFFFFFFFFFFFFF0LL;
    v17 = v5;
    v8 = a2;
    do
    {
      v9 = 0LL;
      do
      {
        v20[v9] ^= *(_BYTE *)(v8 + v9);
        ++v9;
      }
      while ( v9 != 16 );
      if ( v5 >= 0x11 )
        _rijndaelEncrypt((__int64)&v18, (__int64)v20, (__int64)v20);
      v8 += 16LL;
      v5 -= 16LL;
    }
    while ( v5 > 0xF );
    v10 = v7 - v15;
    v6 = v15 + 16 + a2;
    v4 = v16;
  }
  v11 = 0LL;
  memset(v19, 0, 0x10uLL);
  _rijndaelEncrypt((__int64)&v18, (__int64)v19, (__int64)v19);
  gf_mulx((__int64)v19);
  if ( v10 || !v17 )
  {
    v12 = 0LL;
    if ( v10 )
    {
      v13 = 0LL;
      do
      {
        v20[v13] ^= *(_BYTE *)(v6 + v12++);
        v13 = (unsigned int)v12;
      }
      while ( (unsigned int)v12 < v10 );
    }
    v20[v10] ^= 0x80u;
    gf_mulx((__int64)v19);
    v11 = 0LL;
  }
  do
  {
    v19[v11] ^= v20[v11];
    ++v11;
  }
  while ( v11 != 16 );
  _rijndaelEncrypt((__int64)&v18, (__int64)v19, v4);
  return *(_QWORD *)off_7B078[0];
}
// 7B078: using guessed type __int64 off_7B078[7];
// 50E70: using guessed type char var_40[16];
// 50E70: using guessed type char var_50[16];

//----- (0000000000051009) ----------------------------------------------------
char __fastcall gf_mulx(__int64 a1)
{
  char v1; // si@1
  signed __int64 v2; // rcx@1
  char v3; // dl@1
  char v4; // r8@2
  char result; // al@2
  char v6; // cl@3

  v1 = *(_BYTE *)a1;
  v2 = 1LL;
  v3 = *(_BYTE *)a1;
  do
  {
    v4 = *(_BYTE *)(a1 + v2);
    result = 2 * v3 | (*(_BYTE *)(a1 + v2) >> 7);
    *(_BYTE *)(a1 + v2++ - 1) = result;
    v3 = v4;
  }
  while ( v2 != 16 );
  v6 = 2 * *(_BYTE *)(a1 + 15);
  if ( v1 < 0 )
    v6 ^= 0x87u;
  *(_BYTE *)(a1 + 15) = v6;
  return result;
}

//----- (0000000000051048) ----------------------------------------------------
__int64 __fastcall aes_128_encrypt_block(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  char v5; // [sp+8h] [bp-C8h]@1

  v3 = a3;
  _rijndaelKeySetupEnc((__int64)&v5, a1);
  return _rijndaelEncrypt((__int64)&v5, a2, v3);
}

//----- (000000000005108F) ----------------------------------------------------
__int64 __fastcall aes_128_ctr_encrypt(__int64 a1, const void *a2, __int64 a3, unsigned __int64 a4)
{
  unsigned __int64 v4; // rbx@1
  __int64 v5; // r13@1
  unsigned __int64 v6; // r14@2
  signed __int64 v7; // rax@2
  signed int v8; // ecx@5
  __int64 v9; // rdx@7
  char *v10; // rsi@7
  signed __int64 v11; // rcx@9
  bool v12; // zf@10
  char v14; // [sp+0h] [bp-100h]@1
  char v15; // [sp+B0h] [bp-50h]@2
  char v16[16]; // [sp+C0h] [bp-40h]@1
  __int64 v17; // [sp+D0h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v17 = *(_QWORD *)off_7B078[0];
  _rijndaelKeySetupEnc((__int64)&v14, a1);
  memcpy(v16, a2, 0x10uLL);
  if ( v4 )
  {
    do
    {
      v6 = v4;
      _rijndaelEncrypt((__int64)&v14, (__int64)v16, (__int64)&v15);
      v7 = 16LL;
      if ( v4 < 0x10 )
        v7 = v4;
      if ( (signed int)v7 > 0 )
      {
        v8 = 16;
        if ( v4 < 0x10 )
          v8 = v4;
        v9 = v5;
        v10 = &v15;
        do
        {
          *(_BYTE *)v9++ ^= *v10++;
          --v8;
        }
        while ( v8 );
      }
      v5 += v7;
      v4 -= v7;
      v11 = 15LL;
      do
      {
        v12 = v16[v11]++ == -1;
        if ( !v12 )
          break;
        --v11;
      }
      while ( (signed int)v11 + 1 > 0 );
    }
    while ( v6 != v7 );
  }
  return *(_QWORD *)off_7B078[0];
}
// 7B078: using guessed type __int64 off_7B078[7];
// 5108F: using guessed type char var_40[16];

//----- (000000000005117B) ----------------------------------------------------
signed __int64 __fastcall aes_128_eax_encrypt(__int64 a1, const void *a2, unsigned __int64 a3, const void *a4, size_t a5, const void *a6, unsigned __int64 a7, __int64 a8)
{
  size_t v8; // r12@1
  unsigned __int64 v9; // r13@1
  __int64 v10; // rbx@1
  signed __int64 v11; // r13@5
  signed __int64 v12; // rax@5
  signed __int64 v13; // r14@5
  signed __int64 result; // rax@5
  __int64 v15; // rax@6
  __int64 v16; // rcx@9
  const void *v17; // [sp+10h] [bp-80h]@1
  size_t v18; // [sp+18h] [bp-78h]@1
  const void *v19; // [sp+20h] [bp-70h]@1
  char v20[16]; // [sp+30h] [bp-60h]@6
  char v21[16]; // [sp+40h] [bp-50h]@6
  char v22[16]; // [sp+50h] [bp-40h]@6
  __int64 v23; // [sp+60h] [bp-30h]@1

  v19 = a6;
  v18 = a5;
  v17 = a4;
  v8 = a3;
  v9 = a7;
  v10 = off_7B078[0];
  v23 = *(_QWORD *)off_7B078[0];
  if ( a3 > a7 )
    v9 = a3;
  if ( v9 < a5 )
    v9 = a5;
  v11 = v9 + 16;
  LODWORD(v12) = IOMalloc(v11);
  v13 = v12;
  result = 0xFFFFFFFFLL;
  if ( v13 )
  {
    memset((void *)v13, 0, 0xFuLL);
    *(_BYTE *)(v13 + 15) = 0;
    memcpy((void *)(v13 + 16), a2, v8);
    omac1_aes_128(a1, v13, v8 + 16, (__int64)v22);
    *(_BYTE *)(v13 + 15) = 1;
    memcpy((void *)(v13 + 16), v17, v18);
    omac1_aes_128(a1, v13, v18 + 16, (__int64)v21);
    aes_128_ctr_encrypt(a1, v22, (__int64)v19, a7);
    *(_BYTE *)(v13 + 15) = 2;
    memcpy((void *)(v13 + 16), v19, a7);
    omac1_aes_128(a1, v13, a7 + 16, (__int64)v20);
    IOFree(v13, v11);
    v15 = 0LL;
    do
    {
      *(_BYTE *)(a8 + v15) = v21[v15] ^ v22[v15] ^ v20[v15];
      ++v15;
    }
    while ( v15 != 16 );
    v10 = off_7B078[0];
    result = 0LL;
  }
  v16 = *(_QWORD *)v10;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// 5117B: using guessed type char var_40[16];
// 5117B: using guessed type char var_50[16];
// 5117B: using guessed type char var_60[16];

//----- (00000000000512F8) ----------------------------------------------------
signed __int64 __fastcall aes_128_eax_decrypt(__int64 a1, const void *a2, size_t a3, const void *a4, size_t a5, const void *a6, size_t a7, __int64 a8)
{
  size_t v8; // r14@1
  const void *v9; // r12@1
  size_t v10; // r15@1
  size_t v11; // rbx@1
  signed __int64 v12; // rbx@5
  signed __int64 v13; // rax@5
  signed __int64 v14; // r13@5
  signed __int64 result; // rax@5
  const void *v16; // ST10_8@6
  __int64 v17; // r12@6
  __int64 v18; // rcx@10
  const void *v19; // [sp+20h] [bp-70h]@1
  char v20[16]; // [sp+30h] [bp-60h]@6
  char v21[16]; // [sp+40h] [bp-50h]@6
  char v22[16]; // [sp+50h] [bp-40h]@6
  __int64 v23; // [sp+60h] [bp-30h]@1

  v19 = a6;
  v8 = a5;
  v9 = a4;
  v10 = a3;
  v11 = a7;
  v23 = *(_QWORD *)off_7B078[0];
  if ( a3 > a7 )
    v11 = a3;
  if ( v11 < a5 )
    v11 = a5;
  v12 = v11 + 16;
  LODWORD(v13) = IOMalloc(v12);
  v14 = v13;
  result = 0xFFFFFFFFLL;
  if ( v14 )
  {
    v16 = v9;
    v17 = 0LL;
    memset((void *)v14, 0, 0xFuLL);
    *(_BYTE *)(v14 + 15) = 0;
    memcpy((void *)(v14 + 16), a2, v10);
    omac1_aes_128(a1, v14, v10 + 16, (__int64)v22);
    *(_BYTE *)(v14 + 15) = 1;
    memcpy((void *)(v14 + 16), v16, v8);
    omac1_aes_128(a1, v14, v8 + 16, (__int64)v21);
    *(_BYTE *)(v14 + 15) = 2;
    memcpy((void *)(v14 + 16), v19, a7);
    omac1_aes_128(a1, v14, a7 + 16, (__int64)v20);
    IOFree(v14, v12);
    while ( 1 )
    {
      result = 4294967294LL;
      if ( *(_BYTE *)(a8 + v17) != (unsigned __int8)(v21[v17] ^ v22[v17] ^ v20[v17]) )
        break;
      ++v17;
      if ( (signed int)v17 > 15 )
      {
        aes_128_ctr_encrypt(a1, v22, (__int64)v19, a7);
        result = 0LL;
        break;
      }
    }
  }
  v18 = *(_QWORD *)off_7B078[0];
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// 512F8: using guessed type char var_40[16];
// 512F8: using guessed type char var_50[16];
// 512F8: using guessed type char var_60[16];

//----- (0000000000051476) ----------------------------------------------------
__int64 __fastcall aes_128_cbc_encrypt(__int64 a1, const void *a2, void *a3, unsigned __int64 a4)
{
  unsigned __int64 v4; // r14@1
  void *v5; // rbx@1
  unsigned __int64 v6; // r14@1
  int v7; // er13@2
  __int64 v8; // rax@3
  char v10; // [sp+0h] [bp-F0h]@1
  char v11[16]; // [sp+B0h] [bp-40h]@1
  __int64 v12; // [sp+C0h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v12 = *(_QWORD *)off_7B078[0];
  _rijndaelKeySetupEnc((__int64)&v10, a1);
  memcpy(v11, a2, 0x10uLL);
  v6 = v4 >> 4;
  if ( (signed int)v6 > 0 )
  {
    v7 = 0;
    do
    {
      v8 = 0LL;
      do
      {
        v11[v8] ^= *((_BYTE *)v5 + v8);
        ++v8;
      }
      while ( v8 != 16 );
      _rijndaelEncrypt((__int64)&v10, (__int64)v11, (__int64)v11);
      memcpy(v5, v11, 0x10uLL);
      v5 = (char *)v5 + 16;
      ++v7;
    }
    while ( v7 != (_DWORD)v6 );
  }
  return *(_QWORD *)off_7B078[0];
}
// 7B078: using guessed type __int64 off_7B078[7];
// 51476: using guessed type char var_40[16];

//----- (000000000005153E) ----------------------------------------------------
__int64 __fastcall aes_128_cbc_decrypt(__int64 a1, const void *a2, __int64 a3, unsigned __int64 a4)
{
  unsigned __int64 v4; // r14@1
  __int64 v5; // rbx@1
  unsigned __int64 v6; // r14@1
  int v7; // er12@2
  __int64 v8; // rax@3
  char v10; // [sp+0h] [bp-100h]@1
  char v11; // [sp+B0h] [bp-50h]@3
  char v12[16]; // [sp+C0h] [bp-40h]@1
  __int64 v13; // [sp+D0h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  v13 = *(_QWORD *)off_7B078[0];
  _rijndaelKeySetupDec((__int64)&v10, a1);
  memcpy(v12, a2, 0x10uLL);
  v6 = v4 >> 4;
  if ( (signed int)v6 > 0 )
  {
    v7 = 0;
    do
    {
      memcpy(&v11, (const void *)v5, 0x10uLL);
      _rijndaelDecrypt((__int64)&v10, v5, v5);
      v8 = 0LL;
      do
      {
        *(_BYTE *)(v5 + v8) ^= v12[v8];
        ++v8;
      }
      while ( v8 != 16 );
      memcpy(v12, &v11, 0x10uLL);
      v5 += 16LL;
      ++v7;
    }
    while ( v7 != (_DWORD)v6 );
  }
  return *(_QWORD *)off_7B078[0];
}
// 7B078: using guessed type __int64 off_7B078[7];
// 5153E: using guessed type char var_40[16];

//----- (0000000000051620) ----------------------------------------------------
__int64 __fastcall IO80211ActionFrameDescriptor::MetaClass::MetaClass(IO80211ActionFrameDescriptor::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211ActionFrameDescriptor", &IO80211QueueDescriptor::gMetaClass, 96LL);
  result = (__int64)off_7E5A0;
  *(_QWORD *)this = off_7E5A0;
  return result;
}
// 7E5A0: using guessed type __int64 (__fastcall *off_7E5A0[2])(IO80211ActionFrameDescriptor::MetaClass *__hidden this);
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000051652) ----------------------------------------------------
__int64 __fastcall IO80211ActionFrameDescriptor::MetaClass::~MetaClass(IO80211ActionFrameDescriptor::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000005165C) ----------------------------------------------------
__int64 __fastcall IO80211ActionFrameDescriptor::IO80211ActionFrameDescriptor(__int64 a1)
{
  __int64 result; // rax@1

  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  result = (__int64)off_7E460;
  *(_QWORD *)a1 = off_7E460;
  return result;
}
// 7E460: using guessed type __int64 (__fastcall *off_7E460[2])(IO80211ActionFrameDescriptor *__hidden this);

//----- (000000000005167C) ----------------------------------------------------
__int64 __fastcall IO80211ActionFrameDescriptor::IO80211ActionFrameDescriptor(__int64 a1)
{
  __int64 result; // rax@1

  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  result = (__int64)off_7E460;
  *(_QWORD *)a1 = off_7E460;
  return result;
}
// 7E460: using guessed type __int64 (__fastcall *off_7E460[2])(IO80211ActionFrameDescriptor *__hidden this);

//----- (000000000005169C) ----------------------------------------------------
__int64 __fastcall IO80211ActionFrameDescriptor::~IO80211ActionFrameDescriptor(IO80211ActionFrameDescriptor *this)
{
  return IO80211QueueDescriptor::~IO80211QueueDescriptor(this);
}

//----- (00000000000516A6) ----------------------------------------------------
__int64 __fastcall IO80211ActionFrameDescriptor::~IO80211ActionFrameDescriptor(IO80211ActionFrameDescriptor *this)
{
  return IO80211QueueDescriptor::~IO80211QueueDescriptor(this);
}

//----- (00000000000516B0) ----------------------------------------------------
void __fastcall IO80211ActionFrameDescriptor::~IO80211ActionFrameDescriptor(IO80211ActionFrameDescriptor *this)
{
  IO80211QueueDescriptor::~IO80211QueueDescriptor(this);
  OSObject::operator delete((void *)this);
}

//----- (00000000000516D2) ----------------------------------------------------
__int64 __fastcall IO80211ActionFrameDescriptor::getMetaClass(IO80211ActionFrameDescriptor *this)
{
  return (__int64)&IO80211ActionFrameDescriptor::gMetaClass;
}
// 84570: using guessed type _QWORD IO80211ActionFrameDescriptor::gMetaClass;

//----- (00000000000516E0) ----------------------------------------------------
__int64 __fastcall IO80211ActionFrameDescriptor::MetaClass::MetaClass(IO80211ActionFrameDescriptor::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211ActionFrameDescriptor", &IO80211QueueDescriptor::gMetaClass, 96LL);
  result = (__int64)off_7E5A0;
  *(_QWORD *)this = off_7E5A0;
  return result;
}
// 7E5A0: using guessed type __int64 (__fastcall *off_7E5A0[2])(IO80211ActionFrameDescriptor::MetaClass *__hidden this);
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000051712) ----------------------------------------------------
__int64 __fastcall IO80211ActionFrameDescriptor::MetaClass::alloc(IO80211ActionFrameDescriptor::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20.nsects, a2);
  IO80211QueueDescriptor::IO80211QueueDescriptor(v2);
  *(_QWORD *)v2 = off_7E460;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211ActionFrameDescriptor::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 7E460: using guessed type __int64 (__fastcall *off_7E460[2])(IO80211ActionFrameDescriptor *__hidden this);
// 84570: using guessed type _QWORD IO80211ActionFrameDescriptor::gMetaClass;

//----- (0000000000051752) ----------------------------------------------------
__int64 __fastcall IO80211ActionFrameDescriptor::IO80211ActionFrameDescriptor(__int64 a1)
{
  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  *(_QWORD *)a1 = off_7E460;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211ActionFrameDescriptor::gMetaClass);
}
// 7E460: using guessed type __int64 (__fastcall *off_7E460[2])(IO80211ActionFrameDescriptor *__hidden this);
// 84570: using guessed type _QWORD IO80211ActionFrameDescriptor::gMetaClass;

//----- (0000000000051782) ----------------------------------------------------
__int64 __fastcall IO80211ActionFrameDescriptor::IO80211ActionFrameDescriptor(__int64 a1)
{
  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  *(_QWORD *)a1 = off_7E460;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211ActionFrameDescriptor::gMetaClass);
}
// 7E460: using guessed type __int64 (__fastcall *off_7E460[2])(IO80211ActionFrameDescriptor *__hidden this);
// 84570: using guessed type _QWORD IO80211ActionFrameDescriptor::gMetaClass;

//----- (00000000000517B2) ----------------------------------------------------
char __fastcall IO80211ActionFrameDescriptor::initWithAddr(IO80211ActionFrameDescriptor *this, ether_addr *a2)
{
  char result; // al@2

  if ( (unsigned __int8)((int (*)(void))`vtable for'IO80211QueueDescriptor[19])() )
  {
    memcpy((char *)this + 76, a2, 6uLL);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 822A0: using guessed type __int64 `vtable for'IO80211QueueDescriptor[2];

//----- (00000000000517F0) ----------------------------------------------------
int __fastcall IO80211ActionFrameDescriptor::freeResources(IO80211ActionFrameDescriptor *this, unsigned __int8 a2)
{
  IO80211ActionFrameDescriptor *v2; // rbx@1
  __int64 v3; // rdi@1
  int result; // eax@3

  v2 = this;
  v3 = *((_QWORD *)this + 4);
  if ( v3 && !(a2 ^ 1) )
    result = mbuf_freem(v3);
  *((_QWORD *)v2 + 4) = 0LL;
  return result;
}
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);

//----- (000000000005181C) ----------------------------------------------------
__int64 __fastcall IO80211ActionFrameDescriptor::print(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // r15@1
  int v4; // ST60_4@1
  int v5; // ST5C_4@1
  int v6; // ST58_4@1
  int v7; // ST54_4@1
  int v8; // er14@1
  int v9; // er12@1
  __int64 v10; // rdi@1
  char v12; // [sp+64h] [bp-3Ch]@1
  unsigned int v13; // [sp+68h] [bp-38h]@1
  unsigned int v14; // [sp+6Ch] [bp-34h]@1

  v2 = (unsigned __int64)(19342813113834067LL * (unsigned __int128)(*(_QWORD *)(a1 + 40) >> 9) >> 64) >> 11;
  v3 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (*(_QWORD *)(a1 + 40) - 1000000000 * v2)) >> 64) >> 18;
  v14 = *(_BYTE *)(a1 + 76);
  v13 = *(_BYTE *)(a1 + 77);
  v12 = *(_BYTE *)(a1 + 78);
  v4 = *(_BYTE *)(a1 + 79);
  v5 = *(_BYTE *)(a1 + 80);
  v6 = *(_BYTE *)(a1 + 81);
  v7 = *(_BYTE *)(a1 + 52);
  *(_BYTE *)(a1 + 64);
  v8 = *(_DWORD *)(a1 + 68);
  v9 = *(_DWORD *)(a1 + 72);
  v10 = *(_QWORD *)(a1 + 32);
  if ( v10 )
    mbuf_len(v10);
  _userPrint(
    a2,
    "%llu.%03llu [%02X:%02X:%02X:%02X:%02X:%02X] ch %u %s tk %u userTk %u len %zu\n",
    v2,
    v3,
    v14,
    v13,
    v12);
  return 0LL;
}
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);

//----- (000000000005194A) ----------------------------------------------------
void __fastcall IO80211QueueDescriptor::freeResources(IO80211QueueDescriptor *this)
{
  ;
}

//----- (0000000000051950) ----------------------------------------------------
__int64 __fastcall IO80211ActionFrameDescriptor::MetaClass::~MetaClass(IO80211ActionFrameDescriptor::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000051960) ----------------------------------------------------
__int64 `global constructor keyed to'_a_11()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(
    &IO80211ActionFrameDescriptor::gMetaClass,
    "IO80211ActionFrameDescriptor",
    &IO80211QueueDescriptor::gMetaClass,
    96LL);
  result = (__int64)off_7E5A0;
  IO80211ActionFrameDescriptor::gMetaClass = off_7E5A0;
  return result;
}
// 7E5A0: using guessed type __int64 (__fastcall *off_7E5A0[2])(IO80211ActionFrameDescriptor::MetaClass *__hidden this);
// 84570: using guessed type _QWORD IO80211ActionFrameDescriptor::gMetaClass;
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000519A0) ----------------------------------------------------
__int64 `global destructor keyed to'_a_11()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211ActionFrameDescriptor::gMetaClass);
}
// 84570: using guessed type _QWORD IO80211ActionFrameDescriptor::gMetaClass;

//----- (00000000000519C0) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::MetaClass::MetaClass(IO80211CommandQueue::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211CommandQueue", off_7B030[0], 80LL);
  result = (__int64)off_7E7D0;
  *(_QWORD *)this = off_7E7D0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 7E7D0: using guessed type __int64 (__fastcall *off_7E7D0[2])(IO80211CommandQueue::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000519F2) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::MetaClass::~MetaClass(IO80211CommandQueue::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000519FC) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::IO80211CommandQueue(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_7E6A0;
  *(_QWORD *)a1 = off_7E6A0;
  return result;
}
// 7E6A0: using guessed type __int64 (__fastcall *off_7E6A0[2])(IO80211CommandQueue *__hidden this);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000051A1C) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::IO80211CommandQueue(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_7E6A0;
  *(_QWORD *)a1 = off_7E6A0;
  return result;
}
// 7E6A0: using guessed type __int64 (__fastcall *off_7E6A0[2])(IO80211CommandQueue *__hidden this);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000051A3C) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::~IO80211CommandQueue(IO80211CommandQueue *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000051A46) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::~IO80211CommandQueue(IO80211CommandQueue *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000051A50) ----------------------------------------------------
void __fastcall IO80211CommandQueue::~IO80211CommandQueue(IO80211CommandQueue *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000051A72) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::getMetaClass(IO80211CommandQueue *this)
{
  return (__int64)&IO80211CommandQueue::gMetaClass;
}
// 84598: using guessed type _QWORD IO80211CommandQueue::gMetaClass;

//----- (0000000000051A80) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::MetaClass::MetaClass(IO80211CommandQueue::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211CommandQueue", off_7B030[0], 80LL);
  result = (__int64)off_7E7D0;
  *(_QWORD *)this = off_7E7D0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 7E7D0: using guessed type __int64 (__fastcall *off_7E7D0[2])(IO80211CommandQueue::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000051AB2) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::MetaClass::alloc(IO80211CommandQueue::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20.filesize, a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_7E6A0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211CommandQueue::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 7E6A0: using guessed type __int64 (__fastcall *off_7E6A0[2])(IO80211CommandQueue *__hidden this);
// 84598: using guessed type _QWORD IO80211CommandQueue::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000051AF2) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::IO80211CommandQueue(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_7E6A0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211CommandQueue::gMetaClass);
}
// 7E6A0: using guessed type __int64 (__fastcall *off_7E6A0[2])(IO80211CommandQueue *__hidden this);
// 84598: using guessed type _QWORD IO80211CommandQueue::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000051B22) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::IO80211CommandQueue(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_7E6A0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211CommandQueue::gMetaClass);
}
// 7E6A0: using guessed type __int64 (__fastcall *off_7E6A0[2])(IO80211CommandQueue *__hidden this);
// 84598: using guessed type _QWORD IO80211CommandQueue::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000051B52) ----------------------------------------------------
IO80211CommandQueue *__fastcall IO80211CommandQueue::withGateAndCapacity(IO80211CommandQueue *this, IOCommandGate *a2, signed int a3)
{
  signed int v3; // er14@1
  IO80211CommandQueue *v4; // rbx@1

  v3 = a3;
  v4 = (IO80211CommandQueue *)OSObject::operator new((OSObject *)&stru_20.filesize, (unsigned __int64)a2);
  OSObject::OSObject(v4);
  *(_QWORD *)v4 = off_7E6A0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211CommandQueue::gMetaClass);
  if ( v4 && !IO80211CommandQueue::initWithGateAndCapacity(v4, this, (int)a2, v3) )
  {
    (*(void (__fastcall **)(IO80211CommandQueue *, IO80211CommandQueue *))(*(_QWORD *)v4 + 40LL))(v4, this);
    v4 = 0LL;
  }
  return v4;
}
// 20: using guessed type segment_command_64 stru_20;
// 7E6A0: using guessed type __int64 (__fastcall *off_7E6A0[2])(IO80211CommandQueue *__hidden this);
// 84598: using guessed type _QWORD IO80211CommandQueue::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000051BD2) ----------------------------------------------------
char __fastcall IO80211CommandQueue::initWithGateAndCapacity(IO80211CommandQueue *this, IOCommandGate *a2, int a3, signed int a4)
{
  signed int v4; // ebx@1
  int v5; // er14@1
  signed int v6; // eax@2
  __int64 v7; // rax@4
  __int64 v8; // rax@7
  char result; // al@7

  v4 = a4;
  v5 = a3;
  if ( !(unsigned __int8)(*(int (**)(void))(off_7B068[0] + 152))() )
    goto LABEL_11;
  v6 = 1;
  if ( v4 )
    v6 = v4;
  *((_DWORD *)this + 17) = v6;
  LODWORD(v7) = kalloc(16LL * (unsigned int)v6);
  *((_QWORD *)this + 9) = v7;
  if ( v7 )
  {
    for ( ; v4; --v4 )
    {
      *(_QWORD *)v7 = v7;
      *(_QWORD *)(v7 + 8) = v7;
      v7 += 16LL;
    }
    (*(void (__fastcall **)(IOCommandGate *))(*(_QWORD *)a2 + 32LL))(a2);
    *((_QWORD *)this + 7) = a2;
    LODWORD(v8) = IOLockAlloc(a2);
    *((_QWORD *)this + 3) = v8;
    IOLockInitWithState(v8, 0LL);
    *((_DWORD *)this + 12) = v5;
    result = 1;
  }
  else
  {
LABEL_11:
    result = 0;
  }
  return result;
}
// 7B068: using guessed type __int64 off_7B068[9];
// C76F0: using guessed type int __cdecl IOLockAlloc(_QWORD);
// C7700: using guessed type int __fastcall IOLockInitWithState(_QWORD, _QWORD);
// C8BB8: using guessed type int __fastcall kalloc(_QWORD);

//----- (0000000000051C66) ----------------------------------------------------
int __fastcall IO80211CommandQueue::releaseResources(IO80211CommandQueue *this)
{
  IO80211CommandQueue *v1; // rbx@1
  int result; // eax@1
  __int64 v3; // rdi@1
  __int64 v4; // rdi@3

  v1 = this;
  result = IO80211CommandQueue::lockFlush(this);
  v3 = *((_QWORD *)this + 7);
  if ( v3 )
  {
    result = (*(int (__cdecl **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
    *((_QWORD *)v1 + 7) = 0LL;
  }
  v4 = *((_QWORD *)v1 + 9);
  if ( v4 )
    result = kfree(v4, 16LL * *((_DWORD *)v1 + 17));
  return result;
}
// C8BC8: using guessed type int __fastcall kfree(_QWORD, _QWORD);

//----- (0000000000051CAE) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::lockFlush(IO80211CommandQueue *this)
{
  unsigned int v1; // er15@1

  IOLockLock(*((_QWORD *)this + 3));
  *((_BYTE *)this + 32) = 1;
  *((_QWORD *)this + 5) = "/SourceCache/AirPortFamily_kexts/AirPortFamily-710.55/BaseClass/IO80211CommandQueue.cpp";
  *((_DWORD *)this + 9) = 677;
  v1 = IO80211CommandQueue::flush(this);
  IO80211CommandQueue::unlock(
    this,
    "/SourceCache/AirPortFamily_kexts/AirPortFamily-710.55/BaseClass/IO80211CommandQueue.cpp");
  return v1;
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);

//----- (0000000000051D04) ----------------------------------------------------
int __fastcall IO80211CommandQueue::dump(IO80211CommandQueue *this)
{
  unsigned int v1; // er14@2
  __int64 v2; // rax@3
  signed __int64 v3; // r13@3
  __int64 v4; // rbx@3
  signed __int64 v5; // rax@3
  __int64 v6; // r9@3

  if ( *((_DWORD *)this + 17) )
  {
    v1 = 0;
    do
    {
      v2 = *((_QWORD *)this + 9);
      v3 = 16LL * v1;
      v4 = *(_QWORD *)(v2 + v3);
      LODWORD(v5) = IOLog(
                      "dump size %u cmdQ %p first %p n %p p %p\n",
                      *((_DWORD *)this + 13),
                      v2 + v3,
                      v4,
                      *(_QWORD *)(v2 + v3),
                      *(_QWORD *)(v2 + v3 + 8));
      while ( v4 )
      {
        v5 = v3 + *((_QWORD *)this + 9);
        if ( v4 == v5 )
          break;
        LODWORD(v5) = IOLog(
                        "     cmd %p %p next %p prev %p\n",
                        v4,
                        *(_QWORD *)(*(_QWORD *)(v4 + 16) + 24LL),
                        *(_QWORD *)(v4 + 16),
                        *(_QWORD *)(v4 + 24),
                        v6);
        v4 = *(_QWORD *)(v4 + 16);
      }
      ++v1;
    }
    while ( v1 < *((_DWORD *)this + 17) );
  }
  return v5;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000051DA6) ----------------------------------------------------
char __fastcall IO80211CommandQueue::enqueue(IO80211CommandQueue *this, IO80211QueueDescriptor *a2)
{
  int v2; // ecx@1
  char v3; // r14@3
  __int64 v4; // r15@4
  OSMetaClass *v5; // rax@5
  __int64 v6; // rax@5
  __int64 v7; // r9@5
  signed __int64 v8; // rax@6
  __int64 v9; // rdx@6

  v2 = *((_DWORD *)this + 12);
  if ( v2 == 0x1000000 || *((_DWORD *)this + 13) < (unsigned int)(*((_DWORD *)this + 17) * v2) )
  {
    (*(void (__fastcall **)(IO80211QueueDescriptor *))(*(_QWORD *)a2 + 32LL))(a2);
    OSIncrementAtomic((char *)this + 52);
    v4 = *((_BYTE *)a2 + 12);
    if ( (unsigned int)v4 >= *((_DWORD *)this + 17) )
    {
      LODWORD(v5) = (*(int (__fastcall **)(IO80211CommandQueue *))(*(_QWORD *)this + 56LL))(this);
      v6 = OSMetaClass::getClassName(v5);
      IOLog("%s:%s Got hash: %d whereas NumBuckets: %d \n", v6, "enqueue", (unsigned int)v4, *((_DWORD *)this + 17), v7);
      v4 = 0LL;
    }
    v8 = *((_QWORD *)this + 9) + 16 * v4;
    v9 = *(_QWORD *)(v8 + 8);
    if ( v8 == v9 )
      *(_QWORD *)v8 = a2;
    else
      *(_QWORD *)(v9 + 16) = a2;
    *((_QWORD *)a2 + 3) = v9;
    *((_QWORD *)a2 + 2) = v8;
    *(_QWORD *)(v8 + 8) = a2;
    v3 = 1;
    if ( *((_DWORD *)this + 16) )
      (*(void (__fastcall **)(_QWORD, _QWORD, signed __int64))(**((_QWORD **)this + 7) + 488LL))(
        *((_QWORD *)this + 7),
        *((_QWORD *)this + 9),
        1LL);
  }
  else
  {
    v3 = 0;
  }
  return v3;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);

//----- (0000000000051E84) ----------------------------------------------------
int __fastcall IO80211CommandQueue::lock(IO80211CommandQueue *this, const char *a2, int a3)
{
  int v3; // er14@1
  int result; // eax@1

  v3 = a3;
  result = IOLockLock(*((_QWORD *)this + 3));
  *((_BYTE *)this + 32) = 1;
  *((_QWORD *)this + 5) = a2;
  *((_DWORD *)this + 9) = v3;
  return result;
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);

//----- (0000000000051EB8) ----------------------------------------------------
int __fastcall IO80211CommandQueue::unlock(IO80211CommandQueue *this, const char *a2)
{
  const char *v2; // r15@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rsi@2
  char v5[8]; // rcx@2
  char v6[8]; // r9@2

  v2 = a2;
  if ( !*((_BYTE *)this + 32) )
  {
    LODWORD(v3) = (*(int (__cdecl **)(IO80211CommandQueue *))(*(_QWORD *)this + 56LL))(this);
    v4 = OSMetaClass::getClassName(v3);
    *(_QWORD *)v5 = *((_QWORD *)this + 5);
    *(_QWORD *)v6 = "unknown";
    if ( !*(_QWORD *)v5 )
      *(_QWORD *)v5 = "unknown";
    if ( v2 )
      *(_QWORD *)v6 = v2;
    IOLog(
      "%s::%s trying to re-unlock, previous %s line %d, at %s line %d\n",
      v4,
      "unlock",
      *(_QWORD *)v5,
      *((_DWORD *)this + 9),
      *(_QWORD *)v6);
  }
  *((_QWORD *)this + 5) = 0LL;
  *((_DWORD *)this + 9) = 0;
  return IOLockUnlock(*((_QWORD *)this + 3));
}
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000051F3E) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::dequeue(IO80211CommandQueue *this, unsigned int a2)
{
  unsigned __int8 v2; // bl@1
  OSMetaClass *v3; // rax@2
  __int64 v4; // rax@2
  __int64 v5; // r9@2
  __int64 v6; // rcx@3
  signed __int64 v7; // rdx@3
  signed __int64 v8; // rsi@3
  __int64 v9; // rbx@3
  __int64 result; // rax@3
  __int64 v11; // rax@4

  v2 = a2;
  if ( a2 >= *((_DWORD *)this + 17) )
  {
    LODWORD(v3) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
    v4 = OSMetaClass::getClassName(v3);
    IOLog("%s:%s Got hash: %d whereas NumBuckets: %d \n", v4, "dequeue", a2, *((_DWORD *)this + 17), v5);
    v2 = 0;
  }
  v6 = *((_QWORD *)this + 9);
  v7 = 16LL * v2;
  v8 = v6 + v7;
  v9 = *(_QWORD *)(v6 + v7);
  result = 0LL;
  if ( v6 + v7 != v9 )
  {
    v11 = *(_QWORD *)(v9 + 16);
    if ( v8 == v11 )
      *(_QWORD *)(v6 + v7 + 8) = v8;
    else
      *(_QWORD *)(v11 + 24) = v8;
    *(_QWORD *)(v6 + v7) = v11;
    *(_QWORD *)(v9 + 16) = 0LL;
    *(_QWORD *)(v9 + 24) = 0LL;
    OSDecrementAtomic((char *)this + 52);
    result = v9;
    if ( v9 )
    {
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 40LL))(v9);
      result = v9;
    }
  }
  return result;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C77C8: using guessed type int __fastcall OSDecrementAtomic(_QWORD);

//----- (0000000000051FE8) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::dequeueBlocking(IO80211CommandQueue *this, char a2)
{
  __int64 result; // rax@1

  for ( result = IO80211CommandQueue::dequeue(this, a2); !result; result = IO80211CommandQueue::dequeue(this, a2) )
  {
    OSIncrementAtomic((char *)this + 64);
    (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 7) + 480LL))(
      *((_QWORD *)this + 7),
      *((_QWORD *)this + 9),
      0LL);
    OSDecrementAtomic((char *)this + 64);
  }
  return result;
}
// C77C8: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);

//----- (0000000000052048) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::flush(IO80211CommandQueue *this)
{
  unsigned int v1; // er13@2
  unsigned int v2; // er12@2
  __int64 v3; // rbx@6

  if ( *((_DWORD *)this + 17) )
  {
    v1 = 0;
    v2 = 0;
    while ( *((_DWORD *)this + 13) )
    {
      while ( 1 )
      {
        v3 = IO80211CommandQueue::dequeue(this, (unsigned __int8)v1);
        if ( !v3 )
          break;
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 288LL))(v3);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
        ++v2;
      }
      ++v1;
      if ( v1 >= *((_DWORD *)this + 17) )
        return v2;
    }
  }
  return 0;
}

//----- (00000000000520BE) ----------------------------------------------------
char __fastcall IO80211CommandQueue::lockEnqueue(IO80211CommandQueue *this, IO80211QueueDescriptor *a2)
{
  char v2; // r14@1

  IOLockLock(*((_QWORD *)this + 3));
  *((_BYTE *)this + 32) = 1;
  *((_QWORD *)this + 5) = "/SourceCache/AirPortFamily_kexts/AirPortFamily-710.55/BaseClass/IO80211CommandQueue.cpp";
  *((_DWORD *)this + 9) = 277;
  v2 = IO80211CommandQueue::enqueue(this, a2);
  IO80211CommandQueue::unlock(
    this,
    "/SourceCache/AirPortFamily_kexts/AirPortFamily-710.55/BaseClass/IO80211CommandQueue.cpp");
  return v2;
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);

//----- (000000000005211A) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::lockDequeue(IO80211CommandQueue *this, unsigned int a2)
{
  __int64 v2; // r14@1

  IOLockLock(*((_QWORD *)this + 3));
  *((_BYTE *)this + 32) = 1;
  *((_QWORD *)this + 5) = "/SourceCache/AirPortFamily_kexts/AirPortFamily-710.55/BaseClass/IO80211CommandQueue.cpp";
  *((_DWORD *)this + 9) = 288;
  v2 = IO80211CommandQueue::dequeue(this, a2);
  IO80211CommandQueue::unlock(
    this,
    "/SourceCache/AirPortFamily_kexts/AirPortFamily-710.55/BaseClass/IO80211CommandQueue.cpp");
  return v2;
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);

//----- (0000000000052176) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::lockDequeueBlocking(IO80211CommandQueue *this)
{
  __int64 result; // rax@1

  for ( result = IO80211CommandQueue::lockDequeue(this, 0); !result; result = IO80211CommandQueue::lockDequeue(this, 0) )
  {
    OSIncrementAtomic((char *)this + 64);
    (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 7) + 480LL))(
      *((_QWORD *)this + 7),
      *((_QWORD *)this + 9),
      0LL);
    OSDecrementAtomic((char *)this + 64);
  }
  return result;
}
// C77C8: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);

//----- (00000000000521C8) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::lockMap(IO80211CommandQueue *this, int (__fastcall *a2)(_QWORD, _QWORD, _QWORD, _QWORD), __int64 a3, __int64 a4, __int64 a5, int a6)
{
  int v6; // ST14_4@1
  __int64 v7; // ST08_8@1
  __int64 v8; // r12@1
  __int64 v9; // r13@1
  __int64 v10; // rbx@1

  v6 = a6;
  v7 = a5;
  v8 = a4;
  v9 = a3;
  IOLockLock(*((_QWORD *)this + 3));
  *((_BYTE *)this + 32) = 1;
  *((_QWORD *)this + 5) = "/SourceCache/AirPortFamily_kexts/AirPortFamily-710.55/BaseClass/IO80211CommandQueue.cpp";
  *((_DWORD *)this + 9) = 319;
  v10 = IO80211CommandQueue::map((__int64)this, a2, v9, v8, v7, v6);
  IO80211CommandQueue::unlock(
    this,
    "/SourceCache/AirPortFamily_kexts/AirPortFamily-710.55/BaseClass/IO80211CommandQueue.cpp");
  return v10;
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);

//----- (000000000005224C) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::map(__int64 a1, int (__fastcall *a2)(_QWORD, _QWORD, _QWORD, _QWORD), __int64 a3, __int64 a4, __int64 a5, int a6)
{
  __int64 v6; // rbx@1
  unsigned int v7; // er8@10
  int v8; // er9@10
  __int64 result; // rax@10
  __int64 v10; // rcx@14
  signed __int64 v11; // rdx@14
  signed __int64 v12; // r12@14
  int v13; // esi@14
  __int64 v14; // r14@17
  signed __int64 v15; // rcx@17
  __int64 v16; // r13@20
  char v17; // r15@22
  signed __int64 v18; // rsi@22
  signed __int64 v19; // r12@22
  signed __int64 v20; // rax@22
  unsigned int v21; // eax@24
  OSMetaClass *v22; // rax@27
  __int64 v23; // rax@27
  __int64 v24; // rax@29
  __int64 v25; // rcx@34
  __int64 v26; // rcx@37
  signed __int64 v27; // rdx@39
  __int64 v28; // rcx@39
  __int64 v29; // rcx@42
  OSMetaClass *v30; // rax@47
  __int64 v31; // r8@47
  __int64 v32; // r9@47
  OSMetaClass *v33; // rax@49
  signed __int64 v34; // rcx@49
  __int64 v35; // r8@49
  __int64 v36; // r9@49
  __int64 v37; // rdi@49
  OSMetaClass *v38; // rax@55
  __int64 v39; // r8@55
  __int64 v40; // r9@55
  OSMetaClass *v41; // rax@57
  __int64 v42; // rax@62
  __int64 v43; // rcx@62
  signed __int64 v44; // rax@64
  __int64 v45; // rax@66
  __int64 v46; // rcx@66
  void (__fastcall *v47)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@74
  __int64 v48; // rax@79
  __int64 v49; // rcx@79
  __int64 v50; // rax@85
  __int64 v51; // rax@93
  __int64 v52; // rcx@108
  __int64 v53; // [sp+30h] [bp-A0h]@16
  int v54; // [sp+3Ch] [bp-94h]@12
  signed __int64 v55; // [sp+40h] [bp-90h]@41
  signed __int64 v56; // [sp+48h] [bp-88h]@19
  int v57; // [sp+54h] [bp-7Ch]@1
  signed __int64 v58; // [sp+58h] [bp-78h]@12
  __int64 v59; // [sp+60h] [bp-70h]@1
  bool v60; // [sp+6Ch] [bp-64h]@2
  __int64 v61; // [sp+70h] [bp-60h]@1
  __int64 v62; // [sp+78h] [bp-58h]@1
  int (__fastcall *v63)(_QWORD, _QWORD, _QWORD, _QWORD); // [sp+88h] [bp-48h]@1
  signed __int64 v64; // [sp+90h] [bp-40h]@14
  __int64 v65; // [sp+98h] [bp-38h]@19
  __int64 v66; // [sp+A0h] [bp-30h]@12

  v57 = a6;
  v6 = a5;
  v62 = a4;
  v61 = a3;
  v63 = a2;
  v59 = a1;
  if ( a5 )
    v60 = *(_DWORD *)(a5 + 8) == 1;
  else
    v60 = 0;
  if ( a6 == -1 )
  {
    a6 = *(_DWORD *)(a1 + 68) - 1;
    v57 = 0;
  }
  else if ( a5 && *(_BYTE *)(a5 + 52) )
  {
    a6 = *(_DWORD *)(a5 + 56);
  }
  v7 = *(_DWORD *)(a1 + 68);
  v8 = a6 + 1;
  result = 0LL;
  if ( v8 >= v7 )
    v8 = 0;
  v54 = v8;
  v58 = a1 + 52;
  v66 = 0LL;
  while ( 1 )
  {
    *(_DWORD *)(a1 + 12) = v57;
    *(_DWORD *)(a1 + 16) = v8;
    v10 = *(_QWORD *)(a1 + 72);
    v11 = 16LL * (unsigned int)v57;
    v12 = v10 + v11;
    v64 = v10 + v11;
    v13 = v57 + 1;
    if ( v57 + 1 >= v7 )
      v13 = result;
    v57 = v13;
    v53 = *(_QWORD *)(v10 + v11);
    if ( v12 != v53 )
    {
      v14 = v6;
      v15 = v10 + v11 + 8;
      if ( v60 )
        v53 = *(_QWORD *)v15;
      v56 = v15;
      v65 = v53;
      while ( 1 )
      {
        v16 = v65;
        if ( !v65 )
        {
          v6 = v14;
LABEL_101:
          a1 = v59;
          result = 0LL;
          v8 = v54;
          goto LABEL_102;
        }
        v6 = v14;
        if ( v65 == v12 )
          goto LABEL_101;
        v17 = v63(v61, v65, v62, v14);
        v18 = v65 + 24;
        v19 = v65 + 16;
        v20 = v65 + 16;
        if ( v60 )
          v20 = v65 + 24;
        v65 = *(_QWORD *)v20;
        v21 = *(_DWORD *)(v59 + 48);
        if ( v21 <= 0x3E8 )
          v21 = 1000;
        if ( (unsigned int)v66 >= v21 )
        {
          LODWORD(v22) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v59 + 56LL))(v59);
          v23 = OSMetaClass::getClassName(v22);
          IOLog(
            "%s:%s Infinite loop count %u this %p start %u stop %u cmd %p chain %p nextCmd %p action 0x%u func %p\n",
            v23,
            "map",
            v66,
            v59,
            (unsigned int)v57);
          v18 = v16 + 24;
          v19 = v16 + 16;
        }
        if ( !v14 )
          goto LABEL_61;
        v24 = *(_QWORD *)(v14 + 24);
        if ( !v24 || !(v17 & 0xC0) )
          goto LABEL_61;
        if ( v17 & 0x40 )
        {
          if ( v64 == v16 )
          {
            *(_QWORD *)(v24 + 16) = v64;
            if ( *(_QWORD *)v64 == v64 )
            {
              *(_QWORD *)(v24 + 24) = v64;
              *(_QWORD *)v64 = v24;
              v27 = v56;
            }
            else
            {
              v27 = v56;
              v28 = *(_QWORD *)v56;
              *(_QWORD *)(v24 + 24) = *(_QWORD *)v56;
              *(_QWORD *)(v28 + 16) = v24;
            }
            v55 = v18;
            v56 = v27;
            *(_QWORD *)v27 = v24;
          }
          else
          {
            *(_QWORD *)(v24 + 16) = v16;
            if ( *(_QWORD *)v64 == v16 )
            {
              *(_QWORD *)(v24 + 24) = v64;
              *(_QWORD *)v64 = v24;
            }
            else
            {
              v25 = *(_QWORD *)v18;
              *(_QWORD *)(v24 + 24) = *(_QWORD *)v18;
              *(_QWORD *)(v25 + 16) = v24;
            }
            *(_QWORD *)v18 = v24;
            v55 = v18;
          }
          if ( *(_QWORD *)(v24 + 16) == v24 )
          {
            LODWORD(v30) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v59 + 56LL))(v59);
            v18 = OSMetaClass::getClassName(v30);
            IOLog("%s:%s insert before causes elt loop\n", v18, "map", v18, v31, v32);
          }
          if ( *(_QWORD *)(v16 + 16) != v16 )
            goto LABEL_59;
          LODWORD(v33) = (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v59 + 56LL))(v59);
          v34 = OSMetaClass::getClassName(v33);
          v37 = (__int64)"%s:%s insert before causes cmd loop\n";
        }
        else
        {
          if ( v64 == v16 )
          {
            *(_QWORD *)(v24 + 24) = v64;
            v29 = *(_QWORD *)v64;
            if ( *(_QWORD *)v64 == v64 )
            {
              *(_QWORD *)(v24 + 16) = v64;
              *(_QWORD *)v56 = v24;
            }
            else
            {
              *(_QWORD *)(v24 + 16) = v29;
              *(_QWORD *)(v29 + 24) = v24;
            }
            v55 = v18;
            *(_QWORD *)v64 = v24;
          }
          else
          {
            *(_QWORD *)(v24 + 24) = v16;
            if ( *(_QWORD *)v56 == v16 )
            {
              *(_QWORD *)(v24 + 16) = v64;
              *(_QWORD *)v56 = v24;
            }
            else
            {
              v26 = *(_QWORD *)v19;
              *(_QWORD *)(v24 + 16) = *(_QWORD *)v19;
              *(_QWORD *)(v26 + 24) = v24;
            }
            v55 = v18;
            *(_QWORD *)v19 = v24;
          }
          if ( *(_QWORD *)(v24 + 16) == v24 )
          {
            LODWORD(v38) = (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v59 + 56LL))(v59);
            v18 = OSMetaClass::getClassName(v38);
            IOLog("%s:%s insert after causes elt loop\n", v18, "map", v18, v39, v40);
          }
          if ( *(_QWORD *)(v16 + 16) != v16 )
            goto LABEL_59;
          LODWORD(v41) = (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v59 + 56LL))(v59);
          v34 = OSMetaClass::getClassName(v41);
          v37 = (__int64)"%s:%s insert after causes cmd loop\n";
        }
        v18 = v34;
        IOLog(v37, v34, "map", v34, v35, v36);
LABEL_59:
        (*(void (__fastcall **)(_QWORD, signed __int64))(**(_QWORD **)(v14 + 24) + 32LL))(*(_QWORD *)(v14 + 24), v18);
        OSIncrementAtomic(v58);
        v18 = v55;
        if ( *(_DWORD *)(v59 + 64) )
        {
          (*(void (__fastcall **)(_QWORD, _QWORD, signed __int64))(**(_QWORD **)(v59 + 56) + 488LL))(
            *(_QWORD *)(v59 + 56),
            *(_QWORD *)(v59 + 72),
            1LL);
          v18 = v55;
        }
LABEL_61:
        v66 = (unsigned int)(v66 + 1);
        if ( v17 & 0xC )
        {
          v42 = *(_QWORD *)v19;
          v43 = *(_QWORD *)v18;
          v12 = v64;
          if ( v64 == v42 )
            *(_QWORD *)v56 = v43;
          else
            *(_QWORD *)(v42 + 24) = v43;
          if ( v64 == v43 )
            *(_QWORD *)v64 = v42;
          else
            *(_QWORD *)(v43 + 16) = v42;
          *(_QWORD *)(v16 + 16) = 0LL;
          *(_QWORD *)(v16 + 24) = 0LL;
          OSDecrementAtomic(v58);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v16 + 40LL))(v16);
          if ( v17 & 8 )
          {
            if ( v14 && (v47 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(v14 + 16)) != 0LL )
            {
              v47(v61, v16, v62, *(_QWORD *)v14);
            }
            else
            {
              (*(void (__fastcall **)(__int64))(*(_QWORD *)v16 + 288LL))(v16);
              (*(void (__fastcall **)(__int64))(*(_QWORD *)v16 + 40LL))(v16);
            }
          }
        }
        else
        {
          v44 = v19;
          v12 = v64;
          if ( v17 & 0x10 )
          {
            if ( v16 != v53 )
            {
              v45 = *(_QWORD *)v44;
              v46 = *(_QWORD *)v18;
              if ( v64 == v45 )
                *(_QWORD *)v56 = v46;
              else
                *(_QWORD *)(v45 + 24) = v46;
              if ( v64 == v46 )
                *(_QWORD *)v64 = v45;
              else
                *(_QWORD *)(v46 + 16) = v45;
              *(_QWORD *)(v16 + 16) = 0LL;
              *(_QWORD *)(v16 + 24) = 0LL;
              v50 = *(_QWORD *)v64;
              if ( v64 == *(_QWORD *)v64 )
                *(_QWORD *)v56 = v16;
              else
                *(_QWORD *)(v50 + 24) = v16;
              *(_QWORD *)(v16 + 16) = v50;
              *(_QWORD *)(v16 + 24) = v64;
              *(_QWORD *)v64 = v16;
            }
          }
          else if ( v17 & 0x20 && v65 != v64 )
          {
            v48 = *(_QWORD *)v44;
            v49 = *(_QWORD *)v18;
            if ( v64 == v48 )
              *(_QWORD *)v56 = v49;
            else
              *(_QWORD *)(v48 + 24) = v49;
            if ( v64 == v49 )
              *(_QWORD *)v64 = v48;
            else
              *(_QWORD *)(v49 + 16) = v48;
            *(_QWORD *)(v16 + 16) = 0LL;
            *(_QWORD *)(v16 + 24) = 0LL;
            v51 = *(_QWORD *)v56;
            if ( v64 == *(_QWORD *)v56 )
              *(_QWORD *)v64 = v16;
            else
              *(_QWORD *)(v51 + 16) = v16;
            *(_QWORD *)(v16 + 24) = v51;
            *(_QWORD *)(v16 + 16) = v64;
            *(_QWORD *)v56 = v16;
          }
        }
        if ( v17 & 1 )
        {
          result = 0LL;
          if ( !(v17 & 2) )
            result = v16;
          v6 = v14;
          goto LABEL_107;
        }
      }
    }
    v66 = (unsigned int)(v66 + 1);
LABEL_102:
    if ( v57 == v8 )
      break;
    v7 = *(_DWORD *)(a1 + 68);
  }
LABEL_107:
  if ( v6 )
  {
    v52 = *(_QWORD *)(v6 + 64);
    if ( v52 )
      *(_DWORD *)v52 = v66;
  }
  return result;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C77C8: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);

//----- (0000000000052857) ----------------------------------------------------
signed __int64 __fastcall _insert(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  __int64 v6; // r14@1
  __int64 v7; // rdi@1
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD); // rax@1
  __int64 v9; // r8@2
  __int64 v10; // r9@2
  int v11; // er12@2
  __int64 v12; // rdi@2
  char v13[8]; // rdx@5
  __int64 v14; // rcx@8
  signed __int64 v15; // rsi@8
  __int64 v16; // rax@8
  char *v17; // rcx@10
  __int64 v18; // rcx@14
  __int64 v19; // rdx@16
  signed __int64 result; // rax@16
  __int64 v21; // rsi@16
  signed __int64 v22; // r15@19
  int v23; // eax@25
  __int64 v24; // rdi@34
  __int64 v25; // rdx@36
  char v26; // [sp+0h] [bp-30h]@0

  v4 = a4;
  v5 = a2;
  v6 = a1;
  v7 = *(_QWORD *)(a4 + 24);
  v8 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD))(a4 + 40);
  if ( a4 )
  {
    v11 = v8(v7, a2, *(_QWORD *)a4);
    v12 = *(_QWORD *)v4;
    if ( *(_QWORD *)v4 && *(_DWORD *)(v12 + 52) )
    {
      if ( (unsigned int)(v11 + 1) > 3 )
        *(_QWORD *)v13 = "unknown";
      else
        *(_QWORD *)v13 = off_7E8B0[v11 + 1];
      v14 = *(_QWORD *)(v6 + 72);
      v15 = 16LL * *(_BYTE *)(a2 + 12);
      v16 = 0LL;
      if ( v14 + v15 != *(_QWORD *)(v14 + v15) )
        v16 = *(_QWORD *)(v14 + v15 + 8);
      v17 = &byte_690F5;
      if ( v16 != v5 )
        v17 = "(last) ";
      _userPrint(
        v12,
        "_insert result %s %scompared with (elt %p hash 0x%0x cmd %p hash 0x%02x):\n",
        *(__int64 *)v13,
        (__int64)v17,
        *(_QWORD *)(v4 + 24),
        *(_BYTE *)(*(_QWORD *)(v4 + 24) + 12LL),
        v5);
      (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v5 + 280LL))(v5, *(_QWORD *)v4);
    }
  }
  else
  {
    v11 = v8(v7, a2, 0LL);
  }
  if ( v11 == 2 || (v18 = *(_BYTE *)(*(_QWORD *)(v4 + 24) + 12LL), (_DWORD)v18 != *(_BYTE *)(v5 + 12)) )
  {
    *(_DWORD *)(v4 + 48) = -3;
    return 3LL;
  }
  if ( v11 != -1 )
  {
    if ( !v11 )
    {
      v23 = *(_DWORD *)(v4 + 32);
      if ( v23 & 4 )
      {
        *(_DWORD *)(v4 + 48) = -2;
        return 1LL;
      }
      if ( v23 & 2 )
      {
        *(_DWORD *)(v4 + 48) = 0;
        return 79LL;
      }
    }
    v22 = v4 + 32;
    goto LABEL_30;
  }
  v19 = *(_QWORD *)(v6 + 72);
  v18 *= 16LL;
  result = 0LL;
  v21 = 0LL;
  if ( v19 + v18 != *(_QWORD *)(v19 + v18) )
    v21 = *(_QWORD *)(v19 + v18 + 8);
  if ( v21 == v5 )
  {
    v22 = v4 + 32;
    if ( !(*(_BYTE *)(v4 + 32) & 1) && *(_DWORD *)(v6 + 52) < *(_DWORD *)(v6 + 48) )
    {
      *(_DWORD *)(v4 + 48) = 0;
      return 129LL;
    }
LABEL_30:
    if ( *(_BYTE *)v22 & 1 )
    {
      *(_DWORD *)(v4 + 48) = -5;
      result = 1LL;
    }
    else if ( *(_DWORD *)(v6 + 52) >= *(_DWORD *)(v6 + 48) )
    {
      *(_DWORD *)(v4 + 48) = -1;
      result = 1LL;
    }
    else
    {
      *(_DWORD *)(v4 + 48) = 0;
      if ( v4 )
      {
        v24 = *(_QWORD *)v4;
        if ( *(_QWORD *)v4 )
        {
          if ( *(_DWORD *)(v24 + 52) )
          {
            v25 = (__int64)"Before";
            if ( (*(_DWORD *)v22 & 8u) >> 3 )
              v25 = (__int64)"After";
            _userPrint(v24, "return insert %s\n", v25, v18, v9, v10, v26);
          }
        }
      }
      result = 8 * (*(_DWORD *)v22 & 8u) + 65;
    }
  }
  return result;
}
// 690F5: using guessed type char byte_690F5;
// 7E8B0: using guessed type char *off_7E8B0[6];

//----- (0000000000052A5E) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::getLast(IO80211CommandQueue *this, __int64 a2)
{
  __int64 v2; // rcx@1
  signed __int64 v3; // rsi@1
  __int64 result; // rax@1

  v2 = *((_QWORD *)this + 9);
  v3 = 16 * a2;
  result = 0LL;
  if ( v2 + v3 != *(_QWORD *)(v2 + v3) )
    result = *(_QWORD *)(v2 + v3 + 8);
  return result;
}

//----- (0000000000052A7E) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::lockInsert(IO80211CommandQueue *this, __int64 a2, __int64 a3, __int64 a4, unsigned int a5, __int64 a6)
{
  __int64 v6; // ST10_8@1
  unsigned int v7; // ST0C_4@1
  __int64 v8; // r12@1
  __int64 v9; // r13@1
  unsigned int v10; // ebx@1

  v6 = a6;
  v7 = a5;
  v8 = a4;
  v9 = a3;
  IOLockLock(*((_QWORD *)this + 3));
  *((_BYTE *)this + 32) = 1;
  *((_QWORD *)this + 5) = "/SourceCache/AirPortFamily_kexts/AirPortFamily-710.55/BaseClass/IO80211CommandQueue.cpp";
  *((_DWORD *)this + 9) = 561;
  v10 = IO80211CommandQueue::insert(this, a2, v9, v8, v7, v6);
  IO80211CommandQueue::unlock(
    this,
    "/SourceCache/AirPortFamily_kexts/AirPortFamily-710.55/BaseClass/IO80211CommandQueue.cpp");
  return v10;
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);

//----- (0000000000052B00) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::insert(IO80211CommandQueue *this, __int64 a2, __int64 a3, __int64 a4, unsigned int a5, __int64 a6)
{
  __int64 v6; // r10@1
  unsigned int v7; // er12@1
  __int64 v8; // r15@1
  __int64 v9; // r14@1
  __int64 v10; // ST20_8@3
  OSMetaClass *v11; // rax@3
  __int64 v12; // rax@3
  int v13; // ST08_4@3
  int v14; // er9@4
  __int64 v15; // rax@4
  __int64 result; // rax@7
  OSMetaClass *v17; // rax@11
  __int64 v18; // rax@11
  __int64 v19; // [sp+28h] [bp-78h]@1
  __int64 v20; // [sp+30h] [bp-70h]@1
  __int64 v21; // [sp+38h] [bp-68h]@1
  __int64 v22; // [sp+40h] [bp-60h]@1
  __int64 v23; // [sp+48h] [bp-58h]@1
  __int64 v24; // [sp+50h] [bp-50h]@1
  __int64 v25; // [sp+58h] [bp-48h]@1
  __int64 v26; // [sp+60h] [bp-40h]@1
  __int64 v27; // [sp+68h] [bp-38h]@1
  __int64 v28; // [sp+70h] [bp-30h]@1

  v6 = a6;
  v7 = a5;
  v8 = a4;
  v9 = a3;
  v28 = 0LL;
  v27 = 0LL;
  v26 = 0LL;
  v25 = 0LL;
  v24 = 0LL;
  v23 = 0LL;
  v22 = 0LL;
  v21 = 0LL;
  v20 = 0LL;
  v19 = 0LL;
  if ( a4 && *(_DWORD *)(a4 + 52) )
  {
    v10 = a6;
    LODWORD(v11) = (*(int (**)(void))(*(_QWORD *)this + 56LL))();
    v12 = OSMetaClass::getClassName(v11);
    v13 = *(_DWORD *)(v8 + 52);
    _userPrint(
      v8,
      "%s::%s %p hash 0x%02x size %u verbose %u method %u\n",
      v12,
      (__int64)"insert",
      v9,
      *(_BYTE *)(v9 + 12),
      *((_DWORD *)this + 13));
    v6 = v10;
  }
  v14 = *(_BYTE *)(v9 + 12);
  v15 = 0LL;
  if ( (unsigned int)v14 < *((_DWORD *)this + 17) )
    v15 = *(_BYTE *)(v9 + 12);
  if ( *((_QWORD *)this + 9) + 16 * v15 == *(_QWORD *)(*((_QWORD *)this + 9) + 16 * v15) )
  {
    result = 4294967291LL;
    if ( v7 != 3 )
    {
      if ( v8 )
      {
        if ( *(_DWORD *)(v8 + 52) )
        {
          LODWORD(v17) = (*(int (__fastcall **)(IO80211CommandQueue *))(*(_QWORD *)this + 56LL))(this);
          v18 = OSMetaClass::getClassName(v17);
          _userPrint(
            v8,
            "%s::%s enqueue first method %u size %u capacity %u\n",
            v18,
            (__int64)"insert",
            v7,
            *((_DWORD *)this + 13),
            *((_DWORD *)this + 12));
        }
      }
      result = (unsigned int)((unsigned __int8)~IO80211CommandQueue::enqueue(this, (IO80211QueueDescriptor *)v9) << 31 >> 31);
    }
  }
  else
  {
    LODWORD(v23) = v7;
    v22 = v9;
    v24 = a2;
    v19 = v8;
    v21 = v6;
    LODWORD(v25) = -6;
    IO80211CommandQueue::map(
      (__int64)this,
      (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_insert,
      (__int64)this,
      0LL,
      (__int64)&v19,
      v14);
    result = (unsigned int)v25;
  }
  return result;
}

//----- (0000000000052C9C) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::getNext(IO80211CommandQueue *this, IO80211QueueDescriptor *a2)
{
  __int64 result; // rax@1

  result = 0LL;
  if ( a2 )
    result = *((_QWORD *)a2 + 2);
  return result;
}

//----- (0000000000052CAE) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::getFirst(IO80211CommandQueue *this, __int64 a2)
{
  signed __int64 v2; // rdx@1
  __int64 result; // rax@1

  v2 = *((_QWORD *)this + 9) + 16 * a2;
  result = 0LL;
  if ( v2 != *(_QWORD *)v2 )
    result = *(_QWORD *)v2;
  return result;
}

//----- (0000000000052CCE) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::countEntries(IO80211CommandQueue *this, unsigned int a2)
{
  __int64 result; // rax@1
  __int64 v3; // rax@2
  signed __int64 v4; // rdx@2
  signed __int64 v5; // rcx@2
  __int64 v6; // rdx@2

  result = 0LL;
  if ( a2 < *((_DWORD *)this + 17) )
  {
    v3 = *((_QWORD *)this + 9);
    v4 = 16LL * (unsigned __int8)a2;
    v5 = v3 + v4;
    v6 = *(_QWORD *)(v3 + v4);
    for ( result = 0LL; v6 != v5; v6 = *(_QWORD *)(v6 + 16) )
    {
      if ( !v6 )
        break;
      result = (unsigned int)(result + 1);
    }
  }
  return result;
}

//----- (0000000000052D06) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::lockCountEntries(IO80211CommandQueue *this, unsigned int a2)
{
  if ( a2 < *((_DWORD *)this + 17) )
  {
    IOLockLock(*((_QWORD *)this + 3));
    *((_BYTE *)this + 32) = 1;
    *((_QWORD *)this + 5) = "/SourceCache/AirPortFamily_kexts/AirPortFamily-710.55/BaseClass/IO80211CommandQueue.cpp";
    *((_DWORD *)this + 9) = 666;
    IO80211CommandQueue::lockCountEntries(this, a2);
    IO80211CommandQueue::unlock(
      this,
      "/SourceCache/AirPortFamily_kexts/AirPortFamily-710.55/BaseClass/IO80211CommandQueue.cpp");
  }
  return 0LL;
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);

//----- (0000000000052D64) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::print(__int64 a1, __int64 a2)
{
  __int64 result; // rax@1
  unsigned int v3; // ebx@3
  __int64 v4; // [sp+8h] [bp-78h]@2
  __int64 v5; // [sp+10h] [bp-70h]@2
  __int64 v6; // [sp+18h] [bp-68h]@2
  __int64 v7; // [sp+20h] [bp-60h]@2
  __int64 v8; // [sp+28h] [bp-58h]@2
  __int64 v9; // [sp+30h] [bp-50h]@2
  __int64 v10; // [sp+38h] [bp-48h]@2
  __int64 v11; // [sp+40h] [bp-40h]@2
  __int64 v12; // [sp+48h] [bp-38h]@2
  __int64 v13; // [sp+50h] [bp-30h]@2

  result = 0LL;
  if ( a2 )
  {
    v13 = 0LL;
    v12 = 0LL;
    v11 = 0LL;
    v10 = 0LL;
    v9 = 0LL;
    v8 = 0LL;
    v7 = 0LL;
    v6 = 0LL;
    v5 = 0LL;
    v4 = a2;
    if ( *(_DWORD *)(a1 + 68) )
    {
      v3 = 0;
      do
        IO80211CommandQueue::map(
          a1,
          (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))_doUserPrint,
          0LL,
          0LL,
          (__int64)&v4,
          v3++);
      while ( v3 < *(_DWORD *)(a1 + 68) );
    }
    result = *(_DWORD *)(a2 + 40);
  }
  return result;
}

//----- (0000000000052E1E) ----------------------------------------------------
signed __int64 __fastcall _doUserPrint(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  signed __int64 result; // rax@1

  v4 = a4;
  result = 3LL;
  if ( *(_QWORD *)a4 && a2 )
  {
    result = 1LL;
    if ( *(_DWORD *)(*(_QWORD *)a4 + 32LL) )
    {
      (*(void (__fastcall **)(__int64))(*(_QWORD *)a2 + 280LL))(a2);
      result = *(_DWORD *)(*(_QWORD *)v4 + 32LL) == 0;
    }
  }
  return result;
}

//----- (0000000000052E68) ----------------------------------------------------
__int64 __fastcall IO80211CommandQueue::MetaClass::~MetaClass(IO80211CommandQueue::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000052E80) ----------------------------------------------------
__int64 `global constructor keyed to'_a_12()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IO80211CommandQueue::gMetaClass, "IO80211CommandQueue", off_7B030[0], 80LL);
  result = (__int64)off_7E7D0;
  IO80211CommandQueue::gMetaClass = off_7E7D0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 7E7D0: using guessed type __int64 (__fastcall *off_7E7D0[2])(IO80211CommandQueue::MetaClass *__hidden this);
// 84598: using guessed type _QWORD IO80211CommandQueue::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000052EC0) ----------------------------------------------------
__int64 `global destructor keyed to'_a_12()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211CommandQueue::gMetaClass);
}
// 84598: using guessed type _QWORD IO80211CommandQueue::gMetaClass;

//----- (0000000000052EE0) ----------------------------------------------------
__int64 __fastcall IO80211Controller::MetaClass::MetaClass(IO80211Controller::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211Controller", off_7B020[0], 456LL);
  result = (__int64)off_7F6B0;
  *(_QWORD *)this = off_7F6B0;
  return result;
}
// 7B020: using guessed type _QWORD off_7B020[18];
// 7F6B0: using guessed type __int64 (__fastcall *off_7F6B0[2])(IO80211Controller::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000052F12) ----------------------------------------------------
__int64 __fastcall IO80211Controller::MetaClass::~MetaClass(IO80211Controller::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000052F1C) ----------------------------------------------------
__int64 __fastcall IO80211Controller::IO80211Controller(IOEthernetController *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOEthernetController::IOEthernetController(a1, a2);
  result = (__int64)off_7E8F0;
  *(_QWORD *)a1 = off_7E8F0;
  return result;
}
// 7E8F0: using guessed type __int64 (__fastcall *off_7E8F0[2])(IO80211Controller *__hidden this);

//----- (0000000000052F3C) ----------------------------------------------------
__int64 __fastcall IO80211Controller::~IO80211Controller(IO80211Controller *this)
{
  return IOEthernetController::~IOEthernetController(this);
}

//----- (0000000000052F46) ----------------------------------------------------
__int64 __fastcall IO80211Controller::~IO80211Controller(IO80211Controller *this)
{
  return IOEthernetController::~IOEthernetController(this);
}

//----- (0000000000052F50) ----------------------------------------------------
void __fastcall IO80211Controller::~IO80211Controller(IO80211Controller *this)
{
  IOEthernetController::~IOEthernetController(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000052F72) ----------------------------------------------------
__int64 __fastcall IO80211Controller::getMetaClass(IO80211Controller *this)
{
  return (__int64)&IO80211Controller::gMetaClass;
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;

//----- (0000000000052F80) ----------------------------------------------------
__int64 __fastcall IO80211Controller::MetaClass::MetaClass(IO80211Controller::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211Controller", off_7B020[0], 456LL);
  result = (__int64)off_7F6B0;
  *(_QWORD *)this = off_7F6B0;
  return result;
}
// 7B020: using guessed type _QWORD off_7B020[18];
// 7F6B0: using guessed type __int64 (__fastcall *off_7F6B0[2])(IO80211Controller::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000052FB2) ----------------------------------------------------
__int64 __fastcall IO80211Controller::MetaClass::alloc(IO80211Controller::MetaClass *this)
{
  return 0LL;
}

//----- (0000000000052FBA) ----------------------------------------------------
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller0(IO80211Controller *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Controller::gMetaClass, 0);
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;

//----- (0000000000052FCE) ----------------------------------------------------
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller1(IO80211Controller *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Controller::gMetaClass, 1);
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;

//----- (0000000000052FE4) ----------------------------------------------------
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller2(IO80211Controller *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Controller::gMetaClass, 2);
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;

//----- (0000000000052FFA) ----------------------------------------------------
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller3(IO80211Controller *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Controller::gMetaClass, 3);
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;

//----- (0000000000053010) ----------------------------------------------------
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller4(IO80211Controller *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Controller::gMetaClass, 4);
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;

//----- (0000000000053026) ----------------------------------------------------
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller5(IO80211Controller *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Controller::gMetaClass, 5);
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;

//----- (000000000005303C) ----------------------------------------------------
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller6(IO80211Controller *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Controller::gMetaClass, 6);
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;

//----- (0000000000053052) ----------------------------------------------------
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller7(IO80211Controller *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Controller::gMetaClass, 7);
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;

//----- (0000000000053068) ----------------------------------------------------
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller8(IO80211Controller *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Controller::gMetaClass, 8);
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;

//----- (000000000005307E) ----------------------------------------------------
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller9(IO80211Controller *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Controller::gMetaClass, 9);
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;

//----- (0000000000053094) ----------------------------------------------------
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller10(IO80211Controller *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Controller::gMetaClass, 10);
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;

//----- (00000000000530AA) ----------------------------------------------------
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller11(IO80211Controller *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Controller::gMetaClass, 11);
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;

//----- (00000000000530C0) ----------------------------------------------------
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller12(IO80211Controller *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Controller::gMetaClass, 12);
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;

//----- (00000000000530D6) ----------------------------------------------------
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller13(IO80211Controller *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Controller::gMetaClass, 13);
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;

//----- (00000000000530EC) ----------------------------------------------------
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller14(IO80211Controller *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Controller::gMetaClass, 14);
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;

//----- (0000000000053102) ----------------------------------------------------
__int64 __fastcall IO80211Controller::_RESERVEDIO80211Controller15(IO80211Controller *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Controller::gMetaClass, 15);
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;

//----- (0000000000053118) ----------------------------------------------------
char __fastcall IO80211Controller::start(IO80211Controller *this, IOService *a2)
{
  __int64 v2; // rdx@1
  __int64 v3; // rcx@1
  __int64 v4; // r8@1
  __int64 v5; // r9@1
  char v6; // r15@2
  __int64 v7; // rax@2
  __int64 v8; // rdx@3
  __int64 v9; // rcx@3
  __int64 v10; // r8@3
  __int64 v11; // r9@3

  if ( (unsigned __int8)(*(int (__cdecl **)(IO80211Controller *))(off_7B060[0] + 1488))(this) )
  {
    v6 = 0;
    LODWORD(v7) = registerPrioritySleepWakeInterest(IO80211Controller::powerChangeHandler, this, 0LL);
    *((_QWORD *)this + 51) = v7;
    if ( v7 )
    {
      *((_QWORD *)this + 52) = a2;
      (*(void (__fastcall **)(IOService *))(*(_QWORD *)a2 + 32LL))(a2);
      if ( (unsigned int)IO8LogInit((__int64)a2, (__int64)this) )
        IOLog("IO80211Controller::start: IO8LogInit failed.\n", this, v8, v9, v10, v11);
      else
        *((_BYTE *)this + 440) = 1;
      v6 = 1;
    }
  }
  else
  {
    v6 = 0;
    IOLog("IO80211Controller::start fails\n", a2, v2, v3, v4, v5);
  }
  return v6;
}
// 7B060: using guessed type __int64 off_7B060[10];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8D40: using guessed type int __fastcall registerPrioritySleepWakeInterest(_QWORD, _QWORD, _QWORD);

//----- (00000000000531AE) ----------------------------------------------------
__int64 __usercall IO80211Controller::powerChangeHandler@<rax>(IO80211Controller *this@<rdi>, void *a2@<rsi>, void *a3@<rdx>, IOService *a4@<r8>, void *a5@<r9>, __int64 a6@<rax>)
{
  signed int v6; // ebx@1
  __int64 v7; // rax@1
  signed int v8; // ecx@1
  __int64 v9; // rax@8
  __int64 v11; // [sp-4h] [bp-10h]@1

  v11 = a6;
  v6 = (signed int)a3;
  HIDWORD(v11) = (_DWORD)a3;
  LODWORD(v7) = OSMetaClassBase::safeMetaCast(this, &IO80211Controller::gMetaClass);
  v8 = -536870212;
  if ( v7 )
  {
    v8 = 0;
    if ( v6 <= -536870273 )
    {
      if ( v6 != -536870320 )
        return (unsigned int)v8;
      goto LABEL_8;
    }
    if ( v6 == -536870272 || v6 == -536870128 || v6 == -536870112 )
    {
LABEL_8:
      LODWORD(v9) = (*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v7 + 2224LL))(
                      v7,
                      &IO80211Controller::gMetaClass);
      v8 = (*(int (__fastcall **)(__int64, int (__fastcall *)(IO80211Controller *, OSObject *, void *, void *, void *, void *), char *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v9 + 456LL))(
             v9,
             IO80211Controller::powerChangeGated,
             (char *)&v11 + 4,
             0LL,
             0LL,
             0LL);
      return (unsigned int)v8;
    }
  }
  return (unsigned int)v8;
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000053232) ----------------------------------------------------
int __fastcall IO80211Controller::init(IO80211Controller *this, OSDictionary *a2)
{
  *((_QWORD *)this + 40) = 0LL;
  *((_QWORD *)this + 41) = 0LL;
  *((_QWORD *)this + 51) = 0LL;
  *((_QWORD *)this + 52) = 0LL;
  *((_QWORD *)this + 56) = 0LL;
  IO80211VirtualInterfaceNamerRetain();
  return (*(int (**)(void))(off_7B060[0] + 600))();
}
// 7B060: using guessed type __int64 off_7B060[10];

//----- (0000000000053292) ----------------------------------------------------
int __fastcall IO80211Controller::free(IO80211Controller *this)
{
  IO80211Controller *v1; // rbx@1
  __int64 v2; // rdi@1
  __int64 v3; // rdi@3

  v1 = this;
  v2 = *((_QWORD *)this + 52);
  if ( v2 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
    *((_QWORD *)v1 + 52) = 0LL;
  }
  v3 = *((_QWORD *)v1 + 54);
  if ( v3 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v3 + 280LL))(v3);
    *((_QWORD *)v1 + 54) = 0LL;
  }
  IO80211VirtualInterfaceNamerRelease();
  return (*(int (__fastcall **)(IO80211Controller *))(off_7B060[0] + 160))(v1);
}
// 7B060: using guessed type __int64 off_7B060[10];

//----- (00000000000532F4) ----------------------------------------------------
int __fastcall IO80211Controller::stop(IO80211Controller *this, IOService *a2)
{
  IO80211Controller *v2; // rbx@1
  __int64 v3; // rdi@3
  __int64 v4; // rdi@5
  __int64 v5; // rdi@7

  v2 = this;
  if ( *((_BYTE *)this + 440) )
  {
    IO8LogDeinit();
    *((_BYTE *)this + 440) = 0;
  }
  v3 = *((_QWORD *)this + 40);
  if ( v3 )
    (*(void (**)(void))(*(_QWORD *)v3 + 40LL))();
  *((_QWORD *)v2 + 40) = 0LL;
  v4 = *((_QWORD *)v2 + 52);
  if ( v4 )
  {
    (*(void (**)(void))(*(_QWORD *)v4 + 40LL))();
    *((_QWORD *)v2 + 52) = 0LL;
  }
  v5 = *((_QWORD *)v2 + 51);
  if ( v5 )
  {
    (*(void (**)(void))(*(_QWORD *)v5 + 280LL))();
    *((_QWORD *)v2 + 51) = 0LL;
  }
  return (*(int (__fastcall **)(IO80211Controller *))(off_7B060[0] + 1496))(v2);
}
// 7B060: using guessed type __int64 off_7B060[10];

//----- (0000000000053388) ----------------------------------------------------
__int64 __fastcall IO80211Controller::enable(IO80211Controller *this, IONetworkInterface *a2)
{
  __int64 v2; // rax@1
  __int64 v3; // rbx@1
  __int64 result; // rax@1
  char v5; // cl@2
  bool v6; // r15@4
  __int64 v7; // rax@6
  __int64 v8; // rax@11
  __int64 v9; // [sp+0h] [bp-30h]@10
  __int64 v10; // [sp+8h] [bp-28h]@10
  __int64 v11; // [sp+10h] [bp-20h]@10

  LODWORD(v2) = OSMetaClassBase::safeMetaCast(a2, IO80211Interface::metaClass);
  v3 = v2;
  result = 3758097084LL;
  if ( v3 )
  {
    v5 = IO80211Interface::enabledBySystem((IO80211Interface *)v3);
    result = 0LL;
    if ( !v5 )
    {
      if ( *(_BYTE *)(v3 + 504) )
        v6 = (unsigned int)IO80211Interface::linkState((IO80211Interface *)v3) == 2;
      else
        v6 = 0;
      IO80211Interface::startOutputQueues((IO80211Interface *)v3);
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v3 + 2728LL))(v3, 1LL);
      LOBYTE(v7) = IO80211Interface::poweredOnByUser((IO80211Interface *)v3);
      if ( (_BYTE)v7 || (LOBYTE(v7) = IO80211Interface::netBooting((IO80211Interface *)v3), (_BYTE)v7) )
      {
        if ( v6 )
        {
          IO80211Interface::postMessage((IO80211Interface *)v3, 0LL, v7, 0LL, 1);
        }
        else
        {
          v11 = 4294967297LL;
          v10 = 4294967297LL;
          v9 = 1LL;
          HIDWORD(v9) = IO80211Controller::radioCountForInterface(this, (IO80211Interface *)v3);
          if ( !(*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)this + 3216LL))(
                  this,
                  2150132168LL,
                  19LL,
                  v3,
                  &v9) )
          {
            LOBYTE(v8) = IO80211Interface::netBooting((IO80211Interface *)v3);
            if ( !(_BYTE)v8 )
              IO80211Interface::postMessage((IO80211Interface *)v3, 0LL, v8, 0LL, 1);
            IO80211Interface::configureAntennae((IO80211Interface *)v3);
          }
        }
      }
      IO80211Interface::configureBpfOutputQueues((IO80211Interface *)v3, 1u);
      result = 0LL;
    }
  }
  return result;
}
// 7F790: using guessed type _QWORD IO80211Interface::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000534CC) ----------------------------------------------------
signed __int64 __fastcall IO80211Controller::radioCountForInterface(IO80211Controller *this, IO80211Interface *a2)
{
  signed __int64 result; // rax@2
  __int64 v3; // [sp+8h] [bp-8h]@1

  v3 = 1LL;
  if ( (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211Interface *, __int64 *))(*(_QWORD *)this + 3216LL))(
         this,
         3223873993LL,
         54LL,
         a2,
         &v3)
    || (result = HIDWORD(v3), !HIDWORD(v3)) )
  {
    result = 1LL;
  }
  else if ( (unsigned int)result >= 5 )
  {
    HIDWORD(v3) = 4;
    result = 4LL;
  }
  return result;
}

//----- (0000000000053526) ----------------------------------------------------
__int64 __fastcall IO80211Controller::disable(IO80211Controller *this, IONetworkInterface *a2)
{
  IO80211Interface *v2; // rax@1
  IO80211Interface *v3; // r15@1
  signed int v4; // ebx@1
  __int64 v5; // rdx@6
  __int64 v6; // rcx@6
  __int64 v7; // r8@6
  __int64 v8; // r9@6
  __int64 v9; // rax@8
  __int64 v11; // [sp+8h] [bp-38h]@8
  __int64 v12; // [sp+10h] [bp-30h]@8
  __int64 v13; // [sp+18h] [bp-28h]@8
  __int64 v14; // [sp+20h] [bp-20h]@6

  LODWORD(v2) = OSMetaClassBase::safeMetaCast(a2, IO80211Interface::metaClass);
  v3 = v2;
  v4 = -536870212;
  if ( v2 )
  {
    if ( IO80211Interface::enabledBySystem(v2) )
    {
      (*(void (__fastcall **)(IO80211Interface *, _QWORD))(*(_QWORD *)v3 + 2728LL))(v3, 0LL);
      IO80211Interface::stopOutputQueues(v3);
      if ( *((_BYTE *)this + 424) && *((_BYTE *)v3 + 504) && (unsigned int)IO80211Interface::linkState(v3) == 2 )
      {
        v14 = 25769803777LL;
        if ( (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211Interface *, __int64 *))(*(_QWORD *)this + 3216LL))(
               this,
               2150132168LL,
               5LL,
               v3,
               &v14) )
          IOLog("IO80211Controller::disable: Failed to enable WoW.\n", 2150132168LL, v5, v6, v7, v8);
      }
      else
      {
        v13 = 0LL;
        v12 = 0LL;
        v11 = 1LL;
        HIDWORD(v11) = IO80211Controller::radioCountForInterface(this, v3);
        LODWORD(v9) = (*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211Interface *, __int64 *))(*(_QWORD *)this + 3216LL))(
                        this,
                        2150132168LL,
                        19LL,
                        v3,
                        &v11);
        if ( !(_DWORD)v9 )
          IO80211Interface::postMessage(v3, 0LL, v9, 0LL, 1);
      }
    }
    v4 = 0;
    IO80211Interface::configureBpfOutputQueues(v3, 0);
  }
  return (unsigned int)v4;
}
// 7F790: using guessed type _QWORD IO80211Interface::metaClass;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000005365C) ----------------------------------------------------
char __usercall IO80211Controller::configureInterface@<al>(IO80211Controller *this@<rdi>, IONetworkInterface *a2@<rsi>, char a3@<al>)
{
  IONetworkInterface *v3; // r15@1
  IONetworkInterface *v4; // rax@1
  IONetworkInterface *v5; // r14@1
  __int64 v6; // rax@2
  __int64 v7; // rsi@2
  __int64 v8; // rax@2
  __int64 v9; // rdx@2
  __int64 v10; // rcx@2
  __int64 v11; // r8@2
  __int64 v12; // r9@2
  __int64 v13; // rbx@2
  char result; // al@5
  __int64 v15; // rbx@6
  void (__fastcall *v16)(_QWORD, _QWORD); // r15@7
  __int64 v17; // rax@7
  void (__fastcall *v18)(_QWORD, _QWORD); // rbx@8
  __int64 v19; // rax@8
  void (__fastcall *v20)(_QWORD, _QWORD); // rbx@8
  __int64 v21; // rax@8
  void (__fastcall *v22)(_QWORD, _QWORD); // rbx@8
  __int64 v23; // rax@8
  int (__fastcall *v24)(_QWORD, _QWORD, _QWORD, _QWORD); // r15@11
  __int64 v25; // rax@11
  __int64 v26; // rdx@11
  char v27; // [sp-8h] [bp-20h]@1

  v27 = a3;
  v3 = a2;
  LODWORD(v4) = OSMetaClassBase::safeMetaCast(a2, IO80211Interface::metaClass);
  v5 = v4;
  if ( !v4 )
    goto LABEL_14;
  IONetworkInterface::setInterfaceSubType(v4, 3u);
  LODWORD(v6) = (*(int (__fastcall **)(IO80211Controller *, _QWORD))(*(_QWORD *)this + 696LL))(this, "IOMACAddress");
  v7 = *(_QWORD *)off_7B038[0];
  LODWORD(v8) = OSMetaClassBase::safeMetaCast(v6, *(_QWORD *)off_7B038[0]);
  v13 = v8;
  if ( v8 )
  {
    IO8Log("IO80211Controller::configureInterface: Setting mac address on interface\n", v7, v9, v10, v11, v12, v27);
    v7 = (__int64)"IOMACAddress";
    (*(void (__fastcall **)(IONetworkInterface *, _QWORD, __int64))(*(_QWORD *)v3 + 616LL))(v3, "IOMACAddress", v13);
  }
  if ( *((_QWORD *)v5 + 41) )
    return IO80211Interface::configureInterface(v5) == 0;
  v15 = IO80211Interface::getOutputQueue(v5);
  if ( v15 )
  {
    v16 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v5 + 2272LL);
    LODWORD(v17) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v15 + 376LL))(v15, v7);
    v16(v5, v17);
    if ( *((_BYTE *)v5 + 465) )
    {
      v18 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v5 + 2272LL);
      LODWORD(v19) = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)v5 + 59) + 376LL))(*((_QWORD *)v5 + 59));
      v18(v5, v19);
      v20 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v5 + 2272LL);
      LODWORD(v21) = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)v5 + 60) + 376LL))(*((_QWORD *)v5 + 60));
      v20(v5, v21);
      v22 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v5 + 2272LL);
      LODWORD(v23) = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)v5 + 61) + 376LL))(*((_QWORD *)v5 + 61));
      v22(v5, v23);
      result = (*(int (__fastcall **)(IONetworkInterface *, IONetworkInterface *, int (__fastcall *)(IO80211Interface *, __mbuf *, void *), _QWORD))(*(_QWORD *)v5 + 2200LL))(
                 v5,
                 v5,
                 IO80211Interface::queueWMEPacket,
                 0LL);
    }
    else
    {
      v24 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v5 + 2200LL);
      LODWORD(v25) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v15 + 368LL))(v15);
      result = v24(v5, v15, v25, v26);
    }
  }
  else
  {
LABEL_14:
    result = 0;
  }
  return result;
}
// 7B038: using guessed type _QWORD off_7B038[15];
// 7F790: using guessed type _QWORD IO80211Interface::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000537FA) ----------------------------------------------------
int __fastcall IO80211Controller::setInfraChannel(__int64 a1, __int64 a2)
{
  __int64 v2; // rax@1
  __int64 v3; // rsi@1
  int v4; // ecx@1
  int result; // eax@2
  __int64 v6; // rdi@5

  v2 = a2;
  v3 = a1 + 384;
  v4 = *(_DWORD *)(v2 + 4);
  if ( *(_DWORD *)(a1 + 388) == v4 )
  {
    result = *(_DWORD *)(v2 + 8);
    if ( *(_DWORD *)(a1 + 392) == result )
      return result;
  }
  else
  {
    result = *(_DWORD *)(v2 + 8);
  }
  *(_DWORD *)(a1 + 388) = v4;
  *(_DWORD *)(a1 + 392) = result;
  v6 = *(_QWORD *)(a1 + 336);
  if ( v6 )
    result = IO80211VirtualInterface::setInfraChannel(v6, v3);
  return result;
}

//----- (0000000000053844) ----------------------------------------------------
__int64 __fastcall IO80211Controller::getHtCapabilityLength(IO80211Controller *this)
{
  return *((_DWORD *)this + 77);
}

//----- (0000000000053850) ----------------------------------------------------
char *__fastcall IO80211Controller::getHtCapability(IO80211Controller *this)
{
  return (char *)this + 280;
}

//----- (000000000005385E) ----------------------------------------------------
int __fastcall IO80211Controller::setHtCapability(__int64 a1, const void *a2)
{
  signed __int64 v2; // rax@1
  unsigned int v3; // ebx@5
  __int64 v4; // rax@5
  __int64 v5; // rsi@5
  __int64 v6; // r8@5
  __int64 v7; // r9@5
  __int64 v8; // rdx@5
  __int64 v9; // rcx@5
  __int64 v10; // r8@5
  __int64 v11; // r9@5

  *(_DWORD *)(a1 + 308) = 0;
  memcpy((void *)(a1 + 280), a2, 0x1CuLL);
  v2 = -28LL;
  do
  {
    if ( *(_BYTE *)(a1 + v2 + 308) )
      *(_DWORD *)(a1 + 308) = v2 + 29;
    ++v2;
  }
  while ( v2 );
  v3 = 0;
  LODWORD(v4) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 904LL))(a1, 0LL);
  v5 = v4;
  IOLog("%s::%s len %u\n", v4, "setHtCapability", *(_DWORD *)(a1 + 308), v6, v7);
  if ( *(_DWORD *)(a1 + 308) )
  {
    do
    {
      v5 = *(_BYTE *)(a1 + v3 + 280);
      IOLog("%02x ", v5, v8, v9, v10, v11);
      ++v3;
    }
    while ( v3 < *(_DWORD *)(a1 + 308) );
  }
  return IOLog("\n", v5, v8, v9, v10, v11);
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000053920) ----------------------------------------------------
int __fastcall IO80211Controller::setCurrentChannel(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  int result; // eax@1
  IO80211Interface *v4; // rdi@3
  char v5; // si@5

  v2 = a1;
  result = IO80211Interface::linkState(*(IO80211Interface **)(a1 + 328));
  if ( result == 2 )
  {
    if ( a2 )
    {
      result = *(_DWORD *)(a2 + 4);
      *(_DWORD *)(a1 + 400) = result;
      *(_DWORD *)(a1 + 404) = *(_DWORD *)(a2 + 8);
      v4 = *(IO80211Interface **)(a1 + 328);
      if ( *(_DWORD *)(v2 + 388) != result )
      {
        if ( !v4 )
          return result;
        v5 = 0;
        return IO80211Interface::setDataPathState(v4, v5);
      }
    }
    else
    {
      *(_QWORD *)(a1 + 400) = 0LL;
      v4 = *(IO80211Interface **)(a1 + 328);
    }
    if ( !v4 )
      return result;
    v5 = 1;
    return IO80211Interface::setDataPathState(v4, v5);
  }
  return result;
}

//----- (000000000005399A) ----------------------------------------------------
int __fastcall IO80211Controller::printChannels(IO80211Controller *this)
{
  __int64 v1; // rax@1
  int v2; // ST00_4@1

  LODWORD(v1) = (*(int (__fastcall **)(IO80211Controller *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
  v2 = *((_DWORD *)this + 98);
  return IOLog(
           "%s::%s current %u flags=0x%u, infra %u flags=0x%u\n",
           v1,
           "printChannels",
           *((_DWORD *)this + 100),
           *((_DWORD *)this + 101),
           *((_DWORD *)this + 97));
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000539EA) ----------------------------------------------------
int __fastcall IO80211Controller::scanStarted(__int64 a1, __int64 a2, int a3)
{
  int result; // eax@1
  __int64 v4; // rdi@1

  result = a3;
  v4 = *(_QWORD *)(a1 + 336);
  if ( v4 )
    result = IO80211VirtualInterface::setScanningState(v4, a2, 1u);
  return result;
}

//----- (0000000000053A10) ----------------------------------------------------
int __fastcall IO80211Controller::scanDone(__int64 a1, __int64 a2, int a3)
{
  int result; // eax@1
  __int64 v4; // rdi@1

  result = a3;
  v4 = *(_QWORD *)(a1 + 336);
  if ( v4 )
    result = IO80211VirtualInterface::setScanningState(v4, a2, 0);
  return result;
}

//----- (0000000000053A32) ----------------------------------------------------
int __fastcall IO80211Controller::handleChannelSwitchAnnouncement(__int64 a1)
{
  __int64 v1; // rdi@1
  int result; // eax@2

  v1 = *(_QWORD *)(a1 + 336);
  if ( v1 )
    result = IO80211VirtualInterface::handleChannelSwitchAnnouncement(v1);
  return result;
}

//----- (0000000000053A4A) ----------------------------------------------------
int __fastcall IO80211Controller::joinStarted(__int64 a1, __int64 a2)
{
  IO80211VirtualInterface *v2; // rdi@1
  int result; // eax@2

  v2 = *(IO80211VirtualInterface **)(a1 + 336);
  if ( v2 )
    result = IO80211VirtualInterface::setJoiningState(v2, a2, 1u);
  return result;
}

//----- (0000000000053A68) ----------------------------------------------------
int __fastcall IO80211Controller::joinDone(__int64 a1, __int64 a2)
{
  IO80211VirtualInterface *v2; // rdi@1
  int result; // eax@2

  v2 = *(IO80211VirtualInterface **)(a1 + 336);
  if ( v2 )
    result = IO80211VirtualInterface::setJoiningState(v2, a2, 0);
  return result;
}

//----- (0000000000053A82) ----------------------------------------------------
int __fastcall IO80211Controller::infraBSSIDChange(IO80211Controller *this)
{
  IO80211VirtualInterface *v1; // rdi@1
  int result; // eax@2

  v1 = (IO80211VirtualInterface *)*((_QWORD *)this + 42);
  if ( v1 )
    result = IO80211VirtualInterface::infraBSSIDChange(v1);
  return result;
}

//----- (0000000000053A9A) ----------------------------------------------------
char __fastcall IO80211Controller::checkForInfraPacketRedirect(IO80211Controller *this, __mbuf **a2)
{
  IO80211VirtualInterface *v2; // rdi@2
  char v3; // cl@3
  char result; // al@3

  if ( !*((_BYTE *)this + 312)
    || (v2 = (IO80211VirtualInterface *)*((_QWORD *)this + 42)) == 0LL
    || (v3 = IO80211VirtualInterface::captureInfraPacket(v2, a2), result = 1, !v3) )
    result = 0;
  return result;
}

//----- (0000000000053AC4) ----------------------------------------------------
int __fastcall IO80211Controller::inputInfraPacket(IO80211Controller *this, __mbuf *a2)
{
  IO80211Controller *v2; // r15@1
  __int64 v3; // rdi@1
  unsigned int v4; // ebx@2
  __mbuf *v5; // r12@3
  __mbuf *v6; // rax@4
  int result; // eax@6

  v2 = this;
  v3 = *((_QWORD *)this + 41);
  if ( v3 )
  {
    v4 = 0;
    if ( a2 )
    {
      v5 = a2;
      do
      {
        v4 += mbuf_len(v5);
        LODWORD(v6) = mbuf_next(v5, a2);
        v5 = v6;
      }
      while ( v6 );
      v3 = *((_QWORD *)v2 + 41);
    }
    result = (*(int (__fastcall **)(__int64, __mbuf *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v3 + 2168LL))(
               v3,
               a2,
               v4,
               0LL,
               0LL);
  }
  else
  {
    result = mbuf_freem(a2);
  }
  return result;
}
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C58: using guessed type int __fastcall mbuf_next(_QWORD, _QWORD);

//----- (0000000000053B3E) ----------------------------------------------------
__int64 __fastcall IO80211Controller::getOutputQueue(IO80211Controller *this)
{
  IO80211Interface *v1; // rdi@1
  __int64 result; // rax@1

  v1 = (IO80211Interface *)*((_QWORD *)this + 41);
  result = 0LL;
  if ( v1 )
    result = IO80211Interface::getOutputQueue(v1);
  return result;
}

//----- (0000000000053B58) ----------------------------------------------------
char __fastcall IO80211Controller::getBSSIDData(__int64 a1, void *a2)
{
  char v2; // r14@1
  __int64 v3; // rax@1
  int v4; // er12@2
  __int64 v5; // rax@3
  __int64 v6; // r8@3
  __int64 v7; // r9@3

  v2 = 0;
  memset(a2, 0, 0xCuLL);
  *(_DWORD *)a2 = 1;
  LODWORD(v3) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(a1 + 328), IO80211Interface::metaClass);
  if ( v3 )
  {
    v4 = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, void *))(*(_QWORD *)a1 + 3216LL))(
           a1,
           3223873993LL,
           9LL,
           v3,
           a2);
    v2 = 1;
    if ( v4 )
    {
      v2 = 0;
      LODWORD(v5) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 904LL))(a1, 0LL);
      IOLog("%s::%s(): Get failure: APPLE80211_IOC_BSSID: %d\n", v5, "getBSSIDData", (unsigned int)v4, v6, v7);
      memset(a2, 0, 0xCuLL);
    }
  }
  return v2;
}
// 7F790: using guessed type _QWORD IO80211Interface::metaClass;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000053C10) ----------------------------------------------------
bool __fastcall IO80211Controller::getBeaconPeriod(__int64 a1, void *a2)
{
  bool v2; // r15@1
  __int64 v3; // rax@1

  v2 = 0;
  memset(a2, 0, 8uLL);
  *(_DWORD *)a2 = 1;
  LODWORD(v3) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(a1 + 328), IO80211Interface::metaClass);
  if ( v3 )
    v2 = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, void *))(*(_QWORD *)a1 + 3216LL))(
           a1,
           3223873993LL,
           166LL,
           v3,
           a2) == 0;
  return v2;
}
// 7F790: using guessed type _QWORD IO80211Interface::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000053C84) ----------------------------------------------------
char __fastcall IO80211Controller::getInfraExtendedStats(__int64 a1, __int64 a2)
{
  char v2; // bl@1
  __int64 v3; // rax@2
  int v5; // [sp+0h] [bp-50h]@1
  int v6; // [sp+Ch] [bp-44h]@5

  v2 = 0;
  memset(&v5, 0, 0x34uLL);
  v5 = 1;
  if ( (unsigned int)*(_WORD *)(a2 + 26) <= 3 )
  {
    LODWORD(v3) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(a1 + 328), IO80211Interface::metaClass);
    if ( v3
      && !(*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, int *))(*(_QWORD *)a1 + 3216LL))(
            a1,
            3223873993LL,
            16LL,
            v3,
            &v5) )
    {
      *(_DWORD *)(a2 + 28) = v6;
      v2 = 1;
    }
    else
    {
      v2 = 0;
    }
  }
  return v2;
}
// 7F790: using guessed type _QWORD IO80211Interface::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000053D10) ----------------------------------------------------
char __fastcall IO80211Controller::getInfraChannel(__int64 a1, void *a2)
{
  __int64 v2; // r14@1
  char v3; // r15@1
  __int64 v4; // rdi@1
  IO80211Interface *v5; // rax@2
  IO80211Interface *v6; // r15@2
  int v7; // ebx@4
  __int64 v8; // rax@5
  __int64 v9; // r8@5
  __int64 v10; // r9@5

  v2 = a1;
  v3 = 0;
  memset(a2, 0, 0x10uLL);
  *(_DWORD *)a2 = 1;
  v4 = *(_QWORD *)(a1 + 328);
  if ( v4 )
  {
    LODWORD(v5) = OSMetaClassBase::safeMetaCast(v4, IO80211Interface::metaClass);
    v6 = v5;
    if ( v5 && (unsigned int)IO80211Interface::linkState(v5) == 2 )
    {
      v7 = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, IO80211Interface *, void *))(*(_QWORD *)v2 + 3216LL))(
             v2,
             3223873993LL,
             4LL,
             v6,
             a2);
      v3 = 1;
      if ( v7 )
      {
        v3 = 0;
        LODWORD(v8) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v2 + 904LL))(v2, 0LL);
        IOLog("%s::%s() Get of APPLE80211_IOC_CHANNEL failed: %d\n", v8, "getInfraChannel", (unsigned int)v7, v9, v10);
      }
    }
    else
    {
      v3 = 0;
    }
  }
  return v3;
}
// 7F790: using guessed type _QWORD IO80211Interface::metaClass;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000053DCE) ----------------------------------------------------
int __fastcall IO80211Controller::setCountryCode(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1
  __int64 v4; // rax@2
  int result; // eax@3

  v2 = a1;
  *(_DWORD *)a2 = 1;
  v3 = *(_QWORD *)(a1 + 328);
  if ( v3 && (LODWORD(v4) = OSMetaClassBase::safeMetaCast(v3, IO80211Interface::metaClass), v4) )
    result = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64))(*(_QWORD *)v2 + 3216LL))(
               v2,
               2150132168LL,
               51LL,
               v4,
               a2);
  else
    result = -1;
  return result;
}
// 7F790: using guessed type _QWORD IO80211Interface::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000053E30) ----------------------------------------------------
bool __fastcall IO80211Controller::getCountryCode(__int64 a1, void *a2)
{
  __int64 v2; // r14@1
  bool v3; // bl@1
  __int64 v4; // rdi@1
  __int64 v5; // rax@2

  v2 = a1;
  v3 = 0;
  memset(a2, 0, 8uLL);
  *(_DWORD *)a2 = 1;
  v4 = *(_QWORD *)(a1 + 328);
  if ( v4 )
  {
    LODWORD(v5) = OSMetaClassBase::safeMetaCast(v4, IO80211Interface::metaClass);
    if ( v5 )
      v3 = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, void *))(*(_QWORD *)v2 + 3216LL))(
             v2,
             3223873993LL,
             51LL,
             v5,
             a2) == 0;
    else
      v3 = 0;
  }
  return v3;
}
// 7F790: using guessed type _QWORD IO80211Interface::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000053EAA) ----------------------------------------------------
int __fastcall IO80211Controller::outputStart(IO80211Controller *this, IONetworkInterface *a2)
{
  IO80211Interface *v2; // rax@1
  int result; // eax@2

  LODWORD(v2) = OSMetaClassBase::safeMetaCast(a2, IO80211Interface::metaClass);
  if ( v2 )
    result = IO80211Interface::outputStart(v2);
  else
    result = 0;
  return result;
}
// 7F790: using guessed type _QWORD IO80211Interface::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000053EE6) ----------------------------------------------------
int __fastcall IO80211Controller::inputPacket(IO80211Controller *this, __mbuf *a2)
{
  __int64 v2; // rbx@1
  int (__fastcall *v3)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // r15@1
  int v4; // eax@1

  v2 = *((_QWORD *)this + 41);
  v3 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 2168LL);
  v4 = mbuf_len(a2);
  return v3(v2, a2, (unsigned int)v4, 0LL, 0LL);
}
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);

//----- (0000000000053F28) ----------------------------------------------------
bool __fastcall IO80211Controller::createWorkLoop(IO80211Controller *this, unsigned __int64 a2)
{
  __int64 v2; // rax@1

  v2 = IO80211WorkLoop::workLoop(this, a2);
  *((_QWORD *)this + 40) = v2;
  return v2 != 0;
}

//----- (0000000000053F4A) ----------------------------------------------------
__int64 __fastcall IO80211Controller::getWorkLoop(IO80211Controller *this)
{
  return *((_QWORD *)this + 40);
}

//----- (0000000000053F58) ----------------------------------------------------
int __fastcall IO80211Controller::getNetworkInterface(IO80211Controller *this)
{
  return OSMetaClassBase::safeMetaCast(*((_QWORD *)this + 41), IO80211Interface::metaClass);
}
// 7F790: using guessed type _QWORD IO80211Interface::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000053F74) ----------------------------------------------------
signed __int64 IO80211Controller::getHardwareAddress()
{
  return 3758097095LL;
}

//----- (0000000000053F80) ----------------------------------------------------
__int64 __fastcall IO80211Controller::createInterface(IO80211Controller *this)
{
  __int64 v1; // rax@1
  __int64 v2; // rbx@1

  LODWORD(v1) = (*(int (**)(void))(*(_QWORD *)IO80211Interface::metaClass + 136LL))();
  v2 = v1;
  if ( v1 && !(unsigned __int8)(*(int (__fastcall **)(__int64, IO80211Controller *))(*(_QWORD *)v1 + 2136LL))(v1, this) )
  {
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
    v2 = 0LL;
  }
  return v2;
}
// 7F790: using guessed type _QWORD IO80211Interface::metaClass;

//----- (0000000000053FCC) ----------------------------------------------------
signed int __fastcall IO80211Controller::apple80211_ioctl(IO80211Controller *this, IO80211Interface *a2, IO80211VirtualInterface *a3, __ifnet *a4, __int64 a5, void *a6)
{
  int (__fastcall *v6)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // rax@2

  if ( a5 == 2150132168LL )
  {
    v6 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 3336LL);
    return v6(this, a2, a3, a4, a6);
  }
  if ( a5 == 3223873993LL )
  {
    v6 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 3328LL);
    return v6(this, a2, a3, a4, a6);
  }
  return 102;
}

//----- (0000000000054008) ----------------------------------------------------
__int64 __fastcall IO80211Controller::inputMonitorPacket(IO80211Controller *this, __mbuf *a2, unsigned int a3, void *a4, __int64 a5)
{
  return IO80211Interface::monitorModeInputPacket(*((IO80211Interface **)this + 41), a2, a3, a4, a5);
}

//----- (000000000005401A) ----------------------------------------------------
int __fastcall IO80211Controller::apple80211_ioctl_get(IO80211Controller *this, IO80211Interface *a2, IO80211VirtualInterface *a3, __ifnet *a4, void *a5)
{
  void *v5; // rbx@1
  IO80211VirtualInterface *v6; // r14@1
  __int64 v7; // rax@1
  __int64 v8; // r13@1
  int result; // eax@1
  int v10; // ecx@3
  __int64 (__fastcall *v11)(IO80211Controller *); // r9@5
  int v12; // [sp+0h] [bp-2Ch]@2

  v5 = a5;
  v6 = a3;
  LODWORD(v7) = proc_self(this, a2, a3, a4);
  v8 = v7;
  result = 3;
  if ( v8 )
  {
    v12 = proc_is64bit(v8);
    proc_rele(v8);
    result = 22;
    if ( v5 )
    {
      v10 = *((_DWORD *)v5 + 4);
      result = 102;
      if ( v10 > 0 && v10 <= SLODWORD(gGetHandlerTableCount[0]) )
      {
        v11 = gGetHandlerTable[v10 - 1];
        if ( v11 )
          result = ((int (__fastcall *)(IO80211Controller *, IO80211Interface *, IO80211VirtualInterface *, void *, _QWORD))v11)(
                     this,
                     a2,
                     v6,
                     v5,
                     v12 != 0);
      }
    }
  }
  return result;
}
// 83330: using guessed type __int64 (__fastcall *gGetHandlerTable[2])(IO80211Controller *this);
// 83A40: using guessed type __int64 gGetHandlerTableCount[2];
// C8CF8: using guessed type int __fastcall proc_is64bit(_QWORD);
// C8D08: using guessed type int __fastcall proc_rele(_QWORD);
// C8D10: using guessed type int __fastcall proc_self(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000540C6) ----------------------------------------------------
int __fastcall IO80211Controller::apple80211_ioctl_set(IO80211Controller *this, IO80211Interface *a2, IO80211VirtualInterface *a3, __ifnet *a4, void *a5)
{
  void *v5; // rbx@1
  IO80211VirtualInterface *v6; // r14@1
  __int64 v7; // rax@1
  __int64 v8; // r13@1
  int result; // eax@1
  int v10; // ecx@3
  __int64 (__fastcall *v11)(IO80211Controller *); // r9@5
  int v12; // [sp+0h] [bp-2Ch]@2

  v5 = a5;
  v6 = a3;
  LODWORD(v7) = proc_self(this, a2, a3, a4);
  v8 = v7;
  result = 3;
  if ( v8 )
  {
    v12 = proc_is64bit(v8);
    proc_rele(v8);
    result = 22;
    if ( v5 )
    {
      v10 = *((_DWORD *)v5 + 4);
      result = 102;
      if ( v10 > 0 && v10 <= SLODWORD(gSetHandlerTableCount[0]) )
      {
        v11 = gSetHandlerTable[v10 - 1];
        if ( v11 )
          result = ((int (__fastcall *)(IO80211Controller *, IO80211Interface *, IO80211VirtualInterface *, void *, _QWORD))v11)(
                     this,
                     a2,
                     v6,
                     v5,
                     v12 != 0);
      }
    }
  }
  return result;
}
// 83A50: using guessed type __int64 (__fastcall *gSetHandlerTable[2])(IO80211Controller *this);
// 84160: using guessed type __int64 gSetHandlerTableCount[2];
// C8CF8: using guessed type int __fastcall proc_is64bit(_QWORD);
// C8D08: using guessed type int __fastcall proc_rele(_QWORD);
// C8D10: using guessed type int __fastcall proc_self(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000054172) ----------------------------------------------------
int __fastcall IO80211Controller::stringFromReturn(IO80211Controller *this, int a2)
{
  int result; // eax@2
  __int64 v3; // rax@3

  if ( (a2 & 0xFFFFC000) == -528351232 )
  {
    result = (unsigned __int64)convertApple80211ReturnToString(a2);
  }
  else
  {
    v3 = *((_QWORD *)this + 52);
    if ( v3 )
      result = (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v3 + 1920LL))(*((_QWORD *)this + 52));
    else
      result = (*(int (**)(void))(off_7B060[0] + 1936))();
  }
  return result;
}
// 7B060: using guessed type __int64 off_7B060[10];

//----- (00000000000541B6) ----------------------------------------------------
int __fastcall IO80211Controller::errnoFromReturn(IO80211Controller *this, int a2)
{
  int result; // eax@2
  __int64 v3; // rax@3

  if ( (a2 & 0xFFFFC000) == -528351232 )
  {
    result = convertApple80211ReturnToErrno(a2);
  }
  else
  {
    v3 = *((_QWORD *)this + 52);
    if ( v3 )
      result = (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v3 + 1928LL))(*((_QWORD *)this + 52));
    else
      result = (*(int (**)(void))(off_7B060[0] + 1944))();
  }
  return result;
}
// 7B060: using guessed type __int64 off_7B060[10];

//----- (00000000000541FA) ----------------------------------------------------
__int64 __fastcall IO80211Controller::getASSOCIATE_RESULT(__int64 a1, IO80211Interface *a2, IO80211VirtualInterface *a3, __int64 a4)
{
  __int64 v4; // r14@1
  IO80211VirtualInterface *v5; // r15@1
  int v6; // eax@2
  int v7; // eax@8
  int v8; // ebx@10
  int v9; // eax@12
  int v10; // eax@18
  __int64 v11; // rbx@26
  __int64 v12; // rax@26
  __int64 v13; // rdx@37
  __int64 v14; // rcx@37
  __int64 v15; // r8@37
  __int64 v16; // r9@37
  __int64 v17; // rdx@38
  __int64 v18; // rcx@38
  __int64 v19; // r8@38
  __int64 v20; // r9@38
  __int64 v22; // rdx@66
  __int64 v23; // rcx@66
  __int64 v24; // r8@66
  __int64 v25; // r9@66
  __int64 v26; // rdx@67
  __int64 v27; // rcx@67
  __int64 v28; // r8@67
  __int64 v29; // r9@67
  char v30; // [sp+0h] [bp-70h]@0
  __int64 v31; // [sp+8h] [bp-68h]@26
  int v32; // [sp+18h] [bp-58h]@1
  int v33; // [sp+1Ch] [bp-54h]@15
  int v34; // [sp+20h] [bp-50h]@1
  int v35; // [sp+24h] [bp-4Ch]@5
  int v36; // [sp+30h] [bp-40h]@1
  int v37; // [sp+38h] [bp-38h]@21
  int v38; // [sp+40h] [bp-30h]@1
  int v39; // [sp+44h] [bp-2Ch]@16

  v4 = a4;
  v5 = a3;
  bzero(&v38, 8uLL);
  v38 = 1;
  bzero(&v36, 0xCuLL);
  v36 = 1;
  bzero(&v34, 0x10uLL);
  v34 = 1;
  bzero(&v32, 8uLL);
  v32 = 1;
  if ( v5 )
    v6 = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, IO80211VirtualInterface *, int *))(*(_QWORD *)a1 + 3224LL))(
           a1,
           3223873993LL,
           29LL,
           v5,
           &v34);
  else
    v6 = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, IO80211Interface *, int *))(*(_QWORD *)a1 + 3216LL))(
           a1,
           3223873993LL,
           29LL,
           a2,
           &v34);
  if ( !v6 && v35 == 2 )
  {
    *(_DWORD *)(v4 + 4) = 21;
LABEL_42:
    v8 = 0;
    return (unsigned int)v8;
  }
  if ( v5 )
    v7 = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, IO80211VirtualInterface *, int *))(*(_QWORD *)a1 + 3224LL))(
           a1,
           3223873993LL,
           50LL,
           v5,
           &v38);
  else
    v7 = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, IO80211Interface *, int *))(*(_QWORD *)a1 + 3216LL))(
           a1,
           3223873993LL,
           50LL,
           a2,
           &v38);
  v8 = v7;
  if ( !v7 )
  {
    v9 = v5 ? (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211VirtualInterface *, int *))(*(_QWORD *)a1 + 3224LL))(
                a1,
                3223873993LL,
                15LL,
                v5,
                &v32) : (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, int *))(*(_QWORD *)a1 + 3216LL))(
                          a1,
                          3223873993LL,
                          15LL,
                          a2,
                          &v32);
    v8 = v9;
    if ( !v9 )
    {
      if ( v33 == 1 && !v39 )
      {
        v10 = v5 ? (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211VirtualInterface *, int *))(*(_QWORD *)a1 + 3224LL))(
                     a1,
                     3223873993LL,
                     2LL,
                     v5,
                     &v36) : (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, int *))(*(_QWORD *)a1 + 3216LL))(
                               a1,
                               3223873993LL,
                               2LL,
                               a2,
                               &v36);
        if ( !v10 && (v37 == 2 || v37 == 8) )
        {
          if ( a2 )
          {
            if ( IO80211Interface::supplicantInitialized(a2) && !IO80211Interface::supplicantExchangeComplete(a2) )
            {
              io80211_get_calendar_time((__int64)&v31);
              v11 = v31;
              v12 = IO80211Interface::authTimeout(a2);
              goto LABEL_35;
            }
          }
          else if ( (unsigned __int8)IO80211VirtualInterface::supplicantInitialized(v5)
                 && !(unsigned __int8)IO80211VirtualInterface::supplicantExchangeComplete(v5) )
          {
            io80211_get_calendar_time((__int64)&v31);
            v11 = v31;
            v12 = IO80211VirtualInterface::authTimeout(v5);
LABEL_35:
            if ( v11 > (unsigned __int64)v12 )
            {
              if ( a2 )
              {
                if ( IO80211Interface::debugFlags(a2) & 2 )
                {
                  IOLog("Association request timing out!\n", 3223873993LL, v13, v14, v15, v16);
                  IO8Log("Association request timing out!\n", 3223873993LL, v17, v18, v19, v20, v30);
                }
                *(_DWORD *)(v4 + 4) = 22;
                if ( !v5 )
                  goto LABEL_71;
              }
              else
              {
                if ( !v5 )
                {
                  *(_DWORD *)(v4 + 4) = 22;
LABEL_71:
                  v8 = 0;
                  (*(void (__fastcall **)(__int64, signed __int64, signed __int64, IO80211Interface *, _QWORD))(*(_QWORD *)a1 + 3216LL))(
                    a1,
                    2150132168LL,
                    22LL,
                    a2,
                    0LL);
                  return (unsigned int)v8;
                }
                if ( IO80211VirtualInterface::debugFlags(v5) & 2 )
                {
                  IOLog("Association request timing out!\n", 3223873993LL, v22, v23, v24, v25);
                  IO8Log("Association request timing out!\n", 3223873993LL, v26, v27, v28, v29, v30);
                }
                *(_DWORD *)(v4 + 4) = 22;
              }
              v8 = 0;
              (*(void (__fastcall **)(__int64, signed __int64, signed __int64, IO80211VirtualInterface *, _QWORD))(*(_QWORD *)a1 + 3224LL))(
                a1,
                2150132168LL,
                22LL,
                v5,
                0LL);
              return (unsigned int)v8;
            }
LABEL_41:
            *(_DWORD *)(v4 + 4) = 0;
            goto LABEL_42;
          }
        }
      }
      if ( v39 <= 65534 )
      {
        switch ( v39 )
        {
          case 0:
            *(_DWORD *)(v4 + 4) = 1;
            break;
          default:
            goto LABEL_33;
          case 1:
            *(_DWORD *)(v4 + 4) = 2;
            break;
          case 10:
            *(_DWORD *)(v4 + 4) = 3;
            break;
          case 11:
            *(_DWORD *)(v4 + 4) = 4;
            break;
          case 12:
            *(_DWORD *)(v4 + 4) = 5;
            break;
          case 13:
            *(_DWORD *)(v4 + 4) = 6;
            break;
          case 14:
            *(_DWORD *)(v4 + 4) = 7;
            break;
          case 15:
            *(_DWORD *)(v4 + 4) = 8;
            break;
          case 16:
            *(_DWORD *)(v4 + 4) = 9;
            break;
          case 17:
            *(_DWORD *)(v4 + 4) = 10;
            break;
          case 18:
            *(_DWORD *)(v4 + 4) = 11;
            break;
          case 25:
            *(_DWORD *)(v4 + 4) = 12;
            break;
          case 26:
            *(_DWORD *)(v4 + 4) = 13;
            break;
          case 27:
            *(_DWORD *)(v4 + 4) = 23;
            break;
          case 28:
            *(_DWORD *)(v4 + 4) = 24;
            break;
          case 40:
            *(_DWORD *)(v4 + 4) = 14;
            break;
          case 41:
            *(_DWORD *)(v4 + 4) = 15;
            break;
          case 42:
            *(_DWORD *)(v4 + 4) = 16;
            break;
          case 43:
            *(_DWORD *)(v4 + 4) = 17;
            break;
          case 44:
            *(_DWORD *)(v4 + 4) = 18;
            break;
          case 45:
            *(_DWORD *)(v4 + 4) = 19;
            break;
          case 46:
            *(_DWORD *)(v4 + 4) = 20;
            break;
        }
        goto LABEL_42;
      }
      if ( v39 != 0xFFFF )
      {
LABEL_33:
        *(_DWORD *)(v4 + 4) = 0xFFFF;
        goto LABEL_42;
      }
      goto LABEL_41;
    }
  }
  return (unsigned int)v8;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000054700) ----------------------------------------------------
__int64 __fastcall IO80211Controller::getProvider(IO80211Controller *this)
{
  return *((_QWORD *)this + 52);
}

//----- (000000000005470E) ----------------------------------------------------
char __fastcall IO80211Controller::attachInterface(IO80211Controller *this, IONetworkInterface **a2, unsigned __int8 a3)
{
  char v3; // r14@1

  v3 = (*(int (__fastcall **)(IO80211Controller *, IONetworkInterface **, _QWORD))(off_7B060[0] + 2512))(this, a2, a3);
  if ( v3 )
  {
    if ( !*((_QWORD *)this + 41) )
      *((_QWORD *)this + 41) = *a2;
    (*(void (__fastcall **)(IO80211Controller *, _QWORD))(*(_QWORD *)this + 1456LL))(this, 0LL);
  }
  return v3;
}
// 7B060: using guessed type __int64 off_7B060[10];

//----- (0000000000054766) ----------------------------------------------------
char __fastcall IO80211Controller::attachVirtualInterface(IO80211Controller *this, IO80211VirtualInterface **a2, ether_addr *a3, unsigned int a4, char a5)
{
  char v5; // r15@1
  IO80211VirtualInterface *v6; // rax@1
  IO80211VirtualInterface *v7; // r12@1

  v5 = a5;
  LODWORD(v6) = (*(int (__fastcall **)(IO80211Controller *, ether_addr *, _QWORD))(*(_QWORD *)this + 3344LL))(
                  this,
                  a3,
                  a4);
  v7 = v6;
  if ( !v6 )
    return 0;
  if ( !(unsigned __int8)(*(int (__fastcall **)(IO80211VirtualInterface *, IO80211Controller *))(*(_QWORD *)v6 + 1648LL))(
                           v6,
                           this) )
  {
    (*(void (__fastcall **)(IO80211VirtualInterface *))(*(_QWORD *)v7 + 40LL))(v7);
    return 0;
  }
  if ( v5 )
    (*(void (__fastcall **)(IO80211VirtualInterface *, _QWORD))(*(_QWORD *)v7 + 1456LL))(v7, 0LL);
  *a2 = v7;
  return 1;
}

//----- (00000000000547D4) ----------------------------------------------------
int __fastcall IO80211Controller::detachVirtualInterface(IO80211Controller *this, IO80211VirtualInterface *a2, unsigned __int8 a3)
{
  return (*(int (__fastcall **)(IO80211VirtualInterface *, _QWORD))(*(_QWORD *)a2 + 1536LL))(
           a2,
           2 * (unsigned int)a3 + 1);
}

//----- (00000000000547F2) ----------------------------------------------------
__int64 __fastcall IO80211Controller::createVirtualInterface(IO80211Controller *this, ether_addr *a2, unsigned int a3)
{
  unsigned int v3; // ebx@1
  ether_addr *v4; // r14@1
  IO80211Controller *v5; // r15@1
  __int64 v6; // r12@1
  __int64 v7; // rax@4
  __int64 v8; // rax@5
  __int64 v9; // r8@5
  __int64 v10; // rdi@5
  IO80211Controller *v11; // rsi@5
  ether_addr *v12; // rdx@5
  signed __int64 v13; // rcx@5
  __int64 v14; // rax@6
  __int64 v15; // rax@8

  v3 = a3;
  v4 = a2;
  v5 = this;
  v6 = 0LL;
  if ( a3 == 6 )
  {
    LODWORD(v14) = (*(int (**)(void))(*(_QWORD *)IO80211VirtualInterface::metaClass + 136LL))();
    v6 = v14;
    if ( !v14 )
      return v6;
    v8 = *(_QWORD *)v14;
    v9 = (__int64)"wds";
    v13 = 6LL;
    goto LABEL_10;
  }
  if ( a3 == 5 )
  {
    LODWORD(v15) = (*(int (**)(void))(*(_QWORD *)IO80211VirtualInterface::metaClass + 136LL))();
    v6 = v15;
    if ( !v15 )
      return v6;
    v8 = *(_QWORD *)v15;
    v9 = (__int64)"ap";
    v13 = 5LL;
LABEL_10:
    v10 = v6;
    v11 = v5;
    v12 = v4;
    goto LABEL_11;
  }
  if ( a3 - 1 > 2 )
    return v6;
  LODWORD(v7) = (*(int (**)(void))(*(_QWORD *)IO80211P2PInterface::metaClass + 136LL))();
  v6 = v7;
  if ( !v7 )
    return v6;
  v8 = *(_QWORD *)v7;
  v9 = (__int64)"p2p";
  v10 = v6;
  v11 = v5;
  v12 = v4;
  v13 = v3;
LABEL_11:
  if ( !(unsigned __int8)(*(int (__fastcall **)(__int64, IO80211Controller *, ether_addr *, signed __int64, __int64))(v8 + 2128))(
                           v10,
                           v11,
                           v12,
                           v13,
                           v9) )
  {
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 40LL))(v6);
    v6 = 0LL;
  }
  return v6;
}
// 7D940: using guessed type _QWORD IO80211P2PInterface::metaClass;
// 817E0: using guessed type _QWORD IO80211VirtualInterface::metaClass;

//----- (00000000000548DA) ----------------------------------------------------
int __fastcall IO80211Controller::dataLinkLayerAttachComplete(IO80211Controller *this, IO80211Interface *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // rax@1
  OSDictionary *v7; // rdx@2
  __int64 v8; // r15@3
  __int64 v9; // rax@3

  LODWORD(v6) = IOLog(
                  "IO80211Controller::dataLinkLayerAttachComplete():  adding AppleEFINVRAM notification\n",
                  a2,
                  a3,
                  a4,
                  a5,
                  a6);
  if ( !*((_QWORD *)this + 54) )
  {
    LODWORD(v6) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 52) + 696LL))(
                    *((_QWORD *)this + 52),
                    "built-in");
    if ( v6 )
    {
      v8 = *(_QWORD *)off_7B0A8;
      v9 = IOService::serviceMatching("AppleEFINVRAM", 0LL, v7);
      LODWORD(v6) = IOService::addMatchingNotification(v8, v9, IO80211Interface::efiNVRAMPublished, a2, 0LL, 0LL);
      *((_QWORD *)this + 54) = v6;
    }
  }
  return v6;
}
// 7B0A8: using guessed type __int64 off_7B0A8;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8538: using guessed type int __fastcall IOService::addMatchingNotification(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000054964) ----------------------------------------------------
char __fastcall IO80211Controller::useAppleRSNSupplicant(IO80211Controller *this, IO80211Interface *a2)
{
  return (unsigned __int8)(*((_BYTE *)a2 + 336) & 2) >> 1;
}

//----- (0000000000054974) ----------------------------------------------------
char __fastcall IO80211Controller::useAppleRSNSupplicant(IO80211Controller *this, IO80211VirtualInterface *a2)
{
  return (unsigned __int8)(*((_BYTE *)a2 + 136) & 2) >> 1;
}

//----- (0000000000054984) ----------------------------------------------------
int __fastcall IO80211Controller::getHardwareAddressForInterface(__int64 a1, __int64 a2, __int64 a3)
{
  return (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)a1 + 2848LL))(a1, a3);
}

//----- (0000000000054998) ----------------------------------------------------
int __fastcall IO80211Controller::requestPacketTx(IO80211Controller *this, void *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  return IOLog("IO80211Controller::requestPacketTx\n", a2, a3, a4, a5, a6);
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000549AC) ----------------------------------------------------
__int64 __fastcall IO80211Controller::awdlSendInfraPacket(IO80211Controller *this, __mbuf *a2)
{
  IO80211Interface *v2; // rdi@1
  __int64 result; // rax@1

  v2 = (IO80211Interface *)*((_QWORD *)this + 41);
  result = 0xFFFFFFFFLL;
  if ( v2 )
  {
    IO80211Interface::queueWMEPacket(v2, a2, (void *)v2);
    result = 0LL;
  }
  return result;
}

//----- (00000000000549CE) ----------------------------------------------------
__int64 __fastcall IO80211Controller::handle11zPacket(IO80211Controller *this, __mbuf *a2)
{
  IO80211VirtualInterface *v2; // rdi@1

  v2 = (IO80211VirtualInterface *)*((_QWORD *)this + 42);
  if ( v2 )
    IO80211VirtualInterface::handle11zPacket(v2, a2);
  else
    mbuf_freem(a2);
  return 0LL;
}
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);

//----- (00000000000549F2) ----------------------------------------------------
__int64 __fastcall IO80211Controller::bpfOutputPacket(IO80211Controller *this, OSObject *a2, __int64 a3, __mbuf *a4)
{
  mbuf_freem(a4);
  return 1LL;
}
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);

//----- (0000000000054A06) ----------------------------------------------------
__int64 __fastcall IO80211Controller::copyIn(IO80211Controller *this, __int64 a2, void *a3, __int64 a4)
{
  __int64 v4; // r14@1
  void *v5; // r15@1

  v4 = a4;
  v5 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 32LL))();
  (*(void (**)(void))(**((_QWORD **)this + 40) + 376LL))();
  LODWORD(v4) = copyin(a2, v5, v4);
  (*(void (**)(void))(**((_QWORD **)this + 40) + 384LL))();
  (*(void (__fastcall **)(IO80211Controller *))(*(_QWORD *)this + 40LL))(this);
  return (unsigned int)v4;
}
// C8A40: using guessed type int __fastcall copyin(_QWORD, _QWORD, _QWORD);

//----- (0000000000054A6A) ----------------------------------------------------
__int64 __fastcall IO80211Controller::copyOut(IO80211Controller *this, const void *a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1

  v4 = a4;
  v5 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 32LL))();
  (*(void (**)(void))(**((_QWORD **)this + 40) + 376LL))();
  LODWORD(v4) = copyout(a2, v5, v4);
  (*(void (**)(void))(**((_QWORD **)this + 40) + 384LL))();
  (*(void (__fastcall **)(IO80211Controller *))(*(_QWORD *)this + 40LL))(this);
  return (unsigned int)v4;
}
// C8A48: using guessed type int __fastcall copyout(_QWORD, _QWORD, _QWORD);

//----- (0000000000054ACE) ----------------------------------------------------
int __fastcall IO80211Controller::powerChangeGated(IO80211Controller *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  int v6; // eax@1

  v6 = *(_DWORD *)a2;
  if ( *(_DWORD *)a2 <= -536870273 )
  {
    if ( v6 != -536870320 )
      return 0;
    return (*(int (__fastcall **)(IO80211Controller *, OSObject *, void *, void *, void *, void *))(*(_QWORD *)this
                                                                                                  + 3232LL))(
             this,
             a2,
             a3,
             a4,
             a5,
             a6);
  }
  switch ( v6 )
  {
    case -536870272:
      *((_BYTE *)this + 424) = 1;
      (*(void (__fastcall **)(IO80211Controller *, _QWORD, void *, void *, void *, void *))(*(_QWORD *)this + 672LL))(
        this,
        "IO80211WokeSystem",
        a3,
        a4,
        a5,
        a6);
      break;
    case -536870112:
      *((_BYTE *)this + 424) = 0;
      break;
    case -536870128:
      return (*(int (__fastcall **)(IO80211Controller *, OSObject *, void *, void *, void *, void *))(*(_QWORD *)this + 3232LL))(
               this,
               a2,
               a3,
               a4,
               a5,
               a6);
  }
  return 0;
}

//----- (0000000000054B2A) ----------------------------------------------------
signed __int64 __fastcall IO80211Controller::setVirtualHardwareAddress(IO80211Controller *this, IO80211VirtualInterface *a2, ether_addr *a3)
{
  return 102LL;
}

//----- (0000000000054B36) ----------------------------------------------------
__int64 __fastcall IO80211Controller::enableVirtualInterface(IO80211Controller *this, IO80211VirtualInterface *a2)
{
  return 0LL;
}

//----- (0000000000054B3E) ----------------------------------------------------
__int64 __fastcall IO80211Controller::disableVirtualInterface(IO80211Controller *this, IO80211VirtualInterface *a2)
{
  return 0LL;
}

//----- (0000000000054B46) ----------------------------------------------------
signed __int64 __fastcall IO80211Controller::apple80211VirtualRequest(IO80211Controller *this, __int64 a2, __int64 a3, IO80211VirtualInterface *a4, void *a5)
{
  return 102LL;
}

//----- (0000000000054B52) ----------------------------------------------------
signed __int64 __fastcall IO80211Controller::monitorModeSetEnabled(IO80211Controller *this, IO80211Interface *a2)
{
  return 6LL;
}

//----- (0000000000054B5E) ----------------------------------------------------
int __fastcall IO80211Controller::apple80211_ioctl(IO80211Controller *this, IO80211Interface *a2, __ifnet *a3, __int64 a4, void *a5)
{
  return (*(int (__fastcall **)(IO80211Controller *, IO80211Interface *, _QWORD, __ifnet *, __int64, void *))(*(_QWORD *)this + 3200LL))(
           this,
           a2,
           0LL,
           a3,
           a4,
           a5);
}

//----- (0000000000054B7A) ----------------------------------------------------
__int64 __fastcall IO80211Controller::stopDMA(IO80211Controller *this)
{
  return 102LL;
}

//----- (0000000000054B86) ----------------------------------------------------
__int64 __fastcall IO80211Controller::hardwareOutputQueueDepth(IO80211Controller *this, IO80211Interface *a2)
{
  return 0LL;
}

//----- (0000000000054B8E) ----------------------------------------------------
signed __int64 IO80211Controller::performCountryCodeOperation()
{
  return 102LL;
}

//----- (0000000000054B9A) ----------------------------------------------------
signed __int64 IO80211Controller::enableFeature()
{
  return 102LL;
}

//----- (0000000000054BA6) ----------------------------------------------------
__int64 __fastcall IO80211Controller::requiresExplicitMBufRelease(IO80211Controller *this)
{
  return 0LL;
}

//----- (0000000000054BAE) ----------------------------------------------------
__int64 __fastcall IO80211Controller::MetaClass::~MetaClass(IO80211Controller::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000054BC0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_13()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IO80211Controller::gMetaClass, "IO80211Controller", off_7B020[0], 456LL);
  result = (__int64)off_7F6B0;
  IO80211Controller::gMetaClass = off_7F6B0;
  return result;
}
// 7B020: using guessed type _QWORD off_7B020[18];
// 7F6B0: using guessed type __int64 (__fastcall *off_7F6B0[2])(IO80211Controller::MetaClass *__hidden this);
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000054C00) ----------------------------------------------------
__int64 `global destructor keyed to'_a_13()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211Controller::gMetaClass);
}
// 845C0: using guessed type _QWORD IO80211Controller::gMetaClass;

//----- (0000000000054C11) ----------------------------------------------------
char *__fastcall ssidBufToString(unsigned __int8 *a1, unsigned __int64 a2, char *a3)
{
  char *v3; // r14@1
  size_t v4; // rbx@1

  v3 = a3;
  v4 = 32LL;
  if ( a2 <= 0x20 )
    v4 = a2;
  memcpy(a3, a1, v4);
  v3[v4] = 0;
  return v3;
}

//----- (0000000000054C46) ----------------------------------------------------
__int64 __fastcall timespecSub(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rcx@1
  unsigned int v4; // esi@1
  __int64 result; // rax@1
  unsigned int v6; // edi@1
  bool v7; // cf@1
  int v8; // edi@1

  v3 = *(_QWORD *)a1 - *(_QWORD *)a2;
  *(_QWORD *)a3 = v3;
  v4 = *(_DWORD *)(a2 + 8);
  result = *(_DWORD *)(a1 + 8);
  v6 = *(_DWORD *)(a1 + 8);
  v7 = v6 < v4;
  v8 = v6 - v4;
  if ( v7 )
  {
    *(_QWORD *)a3 = v3 - 1;
    *(_DWORD *)(a3 + 8) = result + 1000000000 - v4;
  }
  else
  {
    *(_DWORD *)(a3 + 8) = v8;
  }
  return result;
}

//----- (0000000000054C78) ----------------------------------------------------
__int64 getAbsoluteTime(void)
{
  __int64 v1; // [sp+0h] [bp-10h]@1
  unsigned int v2; // [sp+8h] [bp-8h]@1

  clock_get_calendar_nanotime(&v1, &v2);
  return 1000000000 * v1 + v2;
}
// C8A28: using guessed type int __fastcall clock_get_calendar_nanotime(_QWORD, _QWORD);

//----- (0000000000054CA1) ----------------------------------------------------
int __fastcall io80211_get_calendar_time(__int64 a1)
{
  return clock_get_calendar_nanotime(a1, a1 + 8);
}
// C8A28: using guessed type int __fastcall clock_get_calendar_nanotime(_QWORD, _QWORD);

//----- (0000000000054CAF) ----------------------------------------------------
bool __fastcall procIsSuperuser(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rax@1
  __int64 v5; // rbx@1
  bool v6; // r14@2

  LODWORD(v4) = proc_self(a1, a2, a3, a4);
  v5 = v4;
  if ( v4 )
  {
    v6 = proc_suser(v4) == 0;
    proc_rele(v5);
  }
  else
  {
    v6 = 0;
  }
  return v6;
}
// C8D08: using guessed type int __fastcall proc_rele(_QWORD);
// C8D10: using guessed type int __fastcall proc_self(_QWORD, _QWORD, _QWORD, _QWORD);
// C8D28: using guessed type int __fastcall proc_suser(_QWORD);

//----- (0000000000054CE6) ----------------------------------------------------
__int64 __fastcall calculateChannelBandwidth(int a1)
{
  __int64 result; // rax@1

  result = 20LL;
  if ( !(a1 & 2) )
  {
    result = 40LL;
    if ( !(a1 & 4) )
      result = (a1 << 21 >> 31) & 0x50;
  }
  return result;
}

//----- (0000000000054D0D) ----------------------------------------------------
__int64 __fastcall channelToFrequency(int a1, unsigned int a2)
{
  __int64 result; // rax@2
  signed int v3; // ecx@9

  if ( a2 & 8 )
  {
    result = 0LL;
    if ( (unsigned int)(a1 - 1) > 0xD )
      return result;
    if ( (unsigned int)a1 > 0xC8 )
      return result;
    result = 2484LL;
    if ( a1 == 14 )
      return result;
  }
  else
  {
    result = 0LL;
    if ( (unsigned int)a1 > 0xC8 )
      return result;
  }
  if ( a2 & 4 )
    a1 = a1 + ((a2 >> 7) & 4) - 2;
  v3 = 5000;
  if ( a2 & 8 )
    v3 = 2407;
  return (unsigned int)(v3 + 5 * a1);
}

//----- (0000000000054D70) ----------------------------------------------------
__int64 __fastcall IO80211Interface::MetaClass::MetaClass(IO80211Interface::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211Interface", off_7B018[0], 592LL);
  result = (__int64)off_80320;
  *(_QWORD *)this = off_80320;
  return result;
}
// 7B018: using guessed type _QWORD off_7B018[19];
// 80320: using guessed type __int64 (__fastcall *off_80320[2])(IO80211Interface::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000054DA2) ----------------------------------------------------
__int64 __fastcall IO80211Interface::MetaClass::~MetaClass(IO80211Interface::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000054DAC) ----------------------------------------------------
__int64 __fastcall IO80211Interface::IO80211Interface(IOEthernetInterface *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOEthernetInterface::IOEthernetInterface(a1, a2);
  result = (__int64)off_7F7B0;
  *(_QWORD *)a1 = off_7F7B0;
  return result;
}
// 7F7B0: using guessed type __int64 (__fastcall *off_7F7B0[2])(IO80211Interface *__hidden this);

//----- (0000000000054DCC) ----------------------------------------------------
__int64 __fastcall IO80211Interface::IO80211Interface(IOEthernetInterface *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOEthernetInterface::IOEthernetInterface(a1, a2);
  result = (__int64)off_7F7B0;
  *(_QWORD *)a1 = off_7F7B0;
  return result;
}
// 7F7B0: using guessed type __int64 (__fastcall *off_7F7B0[2])(IO80211Interface *__hidden this);

//----- (0000000000054DEC) ----------------------------------------------------
__int64 __fastcall IO80211Interface::~IO80211Interface(IO80211Interface *this)
{
  return IOEthernetInterface::~IOEthernetInterface(this);
}

//----- (0000000000054DF6) ----------------------------------------------------
__int64 __fastcall IO80211Interface::~IO80211Interface(IO80211Interface *this)
{
  return IOEthernetInterface::~IOEthernetInterface(this);
}

//----- (0000000000054E00) ----------------------------------------------------
void __fastcall IO80211Interface::~IO80211Interface(IO80211Interface *this)
{
  IOEthernetInterface::~IOEthernetInterface(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000054E22) ----------------------------------------------------
__int64 __fastcall IO80211Interface::getMetaClass(IO80211Interface *this)
{
  return (__int64)&IO80211Interface::gMetaClass;
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000054E30) ----------------------------------------------------
__int64 __fastcall IO80211Interface::MetaClass::MetaClass(IO80211Interface::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211Interface", off_7B018[0], 592LL);
  result = (__int64)off_80320;
  *(_QWORD *)this = off_80320;
  return result;
}
// 7B018: using guessed type _QWORD off_7B018[19];
// 80320: using guessed type __int64 (__fastcall *off_80320[2])(IO80211Interface::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000054E62) ----------------------------------------------------
IOEthernetInterface *__fastcall IO80211Interface::MetaClass::alloc(IO80211Interface::MetaClass *this, unsigned __int64 a2)
{
  IOEthernetInterface *v2; // rbx@1

  v2 = (IOEthernetInterface *)OSObject::operator new((OSObject *)stru_240.segname, a2);
  IOEthernetInterface::IOEthernetInterface(v2, (const OSMetaClass *)&IO80211Interface::gMetaClass);
  *(_QWORD *)v2 = off_7F7B0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211Interface::gMetaClass);
  return v2;
}
// 240: using guessed type section_64;
// 7F7B0: using guessed type __int64 (__fastcall *off_7F7B0[2])(IO80211Interface *__hidden this);
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000054EA2) ----------------------------------------------------
__int64 __fastcall IO80211Interface::IO80211Interface(IOEthernetInterface *a1)
{
  IOEthernetInterface::IOEthernetInterface(a1, (const OSMetaClass *)&IO80211Interface::gMetaClass);
  *(_QWORD *)a1 = off_7F7B0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211Interface::gMetaClass);
}
// 7F7B0: using guessed type __int64 (__fastcall *off_7F7B0[2])(IO80211Interface *__hidden this);
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000054ED2) ----------------------------------------------------
__int64 __fastcall IO80211Interface::IO80211Interface(IOEthernetInterface *a1)
{
  IOEthernetInterface::IOEthernetInterface(a1, (const OSMetaClass *)&IO80211Interface::gMetaClass);
  *(_QWORD *)a1 = off_7F7B0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211Interface::gMetaClass);
}
// 7F7B0: using guessed type __int64 (__fastcall *off_7F7B0[2])(IO80211Interface *__hidden this);
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000054F02) ----------------------------------------------------
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface0(IO80211Interface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Interface::gMetaClass, 0);
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000054F16) ----------------------------------------------------
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface1(IO80211Interface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Interface::gMetaClass, 1);
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000054F2C) ----------------------------------------------------
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface2(IO80211Interface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Interface::gMetaClass, 2);
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000054F42) ----------------------------------------------------
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface3(IO80211Interface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Interface::gMetaClass, 3);
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000054F58) ----------------------------------------------------
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface4(IO80211Interface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Interface::gMetaClass, 4);
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000054F6E) ----------------------------------------------------
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface5(IO80211Interface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Interface::gMetaClass, 5);
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000054F84) ----------------------------------------------------
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface6(IO80211Interface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Interface::gMetaClass, 6);
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000054F9A) ----------------------------------------------------
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface7(IO80211Interface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Interface::gMetaClass, 7);
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000054FB0) ----------------------------------------------------
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface8(IO80211Interface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Interface::gMetaClass, 8);
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000054FC6) ----------------------------------------------------
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface9(IO80211Interface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Interface::gMetaClass, 9);
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000054FDC) ----------------------------------------------------
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface10(IO80211Interface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Interface::gMetaClass, 10);
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000054FF2) ----------------------------------------------------
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface11(IO80211Interface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Interface::gMetaClass, 11);
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000055008) ----------------------------------------------------
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface12(IO80211Interface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Interface::gMetaClass, 12);
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (000000000005501E) ----------------------------------------------------
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface13(IO80211Interface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Interface::gMetaClass, 13);
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000055034) ----------------------------------------------------
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface14(IO80211Interface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Interface::gMetaClass, 14);
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (000000000005504A) ----------------------------------------------------
__int64 __fastcall IO80211Interface::_RESERVEDIO80211Interface15(IO80211Interface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211Interface::gMetaClass, 15);
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000055060) ----------------------------------------------------
char __fastcall IO80211Interface::init(IO80211Interface *this, IONetworkController *a2)
{
  IO80211Interface *v2; // rbx@1
  __int64 v3; // r13@1
  __int64 v4; // rax@1
  __int64 v5; // rax@2
  char v6; // r15@2
  __int64 v7; // rax@2
  __int64 v8; // rax@3
  int v9; // eax@4
  void *v10; // rdi@4
  __int64 v11; // rax@6
  char v12; // cl@8
  IO80211Interface *v13; // rdi@12
  __int64 v14; // rdx@12
  __int64 v15; // rax@16
  __int64 v16; // r12@16
  __int64 v17; // rax@16
  __int64 v18; // rax@17
  __int64 v19; // rax@18
  __int64 v20; // rax@19
  __int64 v21; // rax@20
  __int64 v22; // rax@21
  __int64 v23; // rax@23
  __int64 v25; // [sp+0h] [bp-50h]@12
  int v26; // [sp+8h] [bp-48h]@12
  __int64 v27; // [sp+10h] [bp-40h]@3
  int v28; // [sp+18h] [bp-38h]@3
  __int64 v29; // [sp+20h] [bp-30h]@1

  v2 = this;
  v3 = off_7B078[0];
  v29 = *(_QWORD *)off_7B078[0];
  LODWORD(v4) = OSMetaClassBase::safeMetaCast(a2, IO80211Controller::metaClass);
  if ( !v4 )
    goto LABEL_22;
  *((_QWORD *)this + 56) = a2;
  (*(void (__fastcall **)(IONetworkController *, _QWORD))(*(_QWORD *)a2 + 32LL))(a2, IO80211Controller::metaClass);
  *((_BYTE *)this + 505) = 0;
  *((_BYTE *)this + 344) = 0;
  *((_BYTE *)this + 345) = 0;
  *((_DWORD *)this + 90) = 0;
  *((_BYTE *)this + 364) = 0;
  *((_QWORD *)this + 47) = 0LL;
  *((_QWORD *)this + 48) = 0LL;
  *((_QWORD *)this + 49) = 0LL;
  *((_BYTE *)this + 400) = 0;
  *((_QWORD *)this + 52) = 0LL;
  *((_QWORD *)this + 53) = 0LL;
  *((_QWORD *)this + 54) = 0LL;
  *((_QWORD *)this + 57) = 0LL;
  *((_BYTE *)this + 464) = 0;
  *((_DWORD *)this + 127) = -1;
  *((_BYTE *)this + 466) = 0;
  *((_BYTE *)this + 467) = 0;
  *((_QWORD *)this + 73) = 0LL;
  LODWORD(v5) = (*(int (**)(void))(**((_QWORD **)this + 56) + 1672LL))();
  v6 = 0;
  LODWORD(v7) = IOGatedOutputQueue::withTarget(this, 2745LL, 0LL, v5, 0LL);
  *((_QWORD *)this + 55) = v7;
  if ( !v7 )
    goto LABEL_23;
  v28 = 0;
  v27 = 1LL;
  LODWORD(v8) = IOMalloc(8LL);
  *((_QWORD *)this + 67) = v8;
  if ( !v8 )
  {
LABEL_22:
    v6 = 0;
    goto LABEL_23;
  }
  *((_BYTE *)this + 465) = 0;
  v9 = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, __int64 *))(**((_QWORD **)this + 56) + 3216LL))(
         *((_QWORD *)this + 56),
         3223873993LL,
         12LL,
         this,
         &v27);
  v10 = (void *)*((_QWORD *)this + 67);
  if ( v9 )
  {
    bzero(v10, 8uLL);
  }
  else
  {
    memcpy(v10, (char *)&v27 + 4, 8uLL);
    v11 = *((_QWORD *)v2 + 67);
    if ( *(_BYTE *)(v11 + 2) & 2 )
      *((_BYTE *)v2 + 465) = 1;
    v12 = *(_BYTE *)(v11 + 3);
    if ( v12 & 8 )
    {
      *(_WORD *)((char *)v2 + 465) = 256;
      v12 = *(_BYTE *)(v11 + 3);
    }
    if ( v12 & 0x10 )
      *((_BYTE *)v2 + 467) = 1;
  }
  v26 = 0;
  v25 = 1LL;
  v13 = (IO80211Interface *)*((_QWORD *)v2 + 56);
  if ( (*(int (__fastcall **)(IO80211Interface *, signed __int64, signed __int64, IO80211Interface *, __int64 *))(*(_QWORD *)v13 + 3216LL))(
         v13,
         3223873993LL,
         80LL,
         v2,
         &v25) )
    *((_DWORD *)v2 + 133) = -75;
  else
    *((_DWORD *)v2 + 133) = HIDWORD(v25);
  if ( !*((_BYTE *)v2 + 465)
    || (LODWORD(v15) = (*(int (__cdecl **)(_QWORD, signed __int64, __int64))(**((_QWORD **)v2 + 56) + 1672LL))(
                         *((_QWORD *)v2 + 56),
                         3223873993LL,
                         v14),
        v16 = v15,
        v6 = 0,
        LODWORD(v17) = IOGatedOutputQueue::withTarget(v2, 2745LL, 0LL, v15, 0LL),
        (*((_QWORD *)v2 + 59) = v17) != 0LL)
    && (v6 = 0,
        LODWORD(v18) = IOGatedOutputQueue::withTarget(v2, 2745LL, 0LL, v16, 0LL),
        (*((_QWORD *)v2 + 60) = v18) != 0LL)
    && (v6 = 0,
        v13 = v2,
        LODWORD(v19) = IOGatedOutputQueue::withTarget(v2, 2745LL, 0LL, v16, 0LL),
        (*((_QWORD *)v2 + 61) = v19) != 0LL) )
  {
    LODWORD(v20) = IOLockAlloc(v13);
    *((_QWORD *)v2 + 69) = v20;
    if ( v20 )
    {
      LODWORD(v21) = IOMalloc(8LL);
      *((_QWORD *)v2 + 68) = v21;
      if ( v21 )
      {
        *(_QWORD *)v21 = 0LL;
        *(_QWORD *)((char *)v2 + 564) = 0LL;
        LODWORD(v22) = IO80211AllocateBpfTapThreadCall(v2);
        *((_QWORD *)v2 + 72) = v22;
        *((_QWORD *)v2 + 42) = 17179869218LL;
        v6 = (*(int (__fastcall **)(IO80211Interface *, IONetworkController *))(off_7B058[0] + 2152))(v2, a2);
        goto LABEL_23;
      }
    }
    goto LABEL_22;
  }
LABEL_23:
  v23 = *(_QWORD *)v3;
  if ( *(_QWORD *)v3 == v29 )
    LOBYTE(v23) = v6;
  return v23;
}
// 7B058: using guessed type __int64 off_7B058[11];
// 7B078: using guessed type __int64 off_7B078[7];
// 7E8D0: using guessed type _QWORD IO80211Controller::metaClass;
// C76F0: using guessed type int __cdecl IOLockAlloc(_QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// C7B08: using guessed type int __fastcall IOGatedOutputQueue::withTarget(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000553B4) ----------------------------------------------------
int __usercall IO80211Interface::free@<eax>(IO80211Interface *this@<rdi>, __int64 a2@<rax>)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1
  __int64 v4; // rdi@3
  signed __int64 v5; // rsi@5
  int v6; // eax@5
  __int64 v7; // rdi@5
  __int64 v8; // rdi@7
  __int64 v9; // rdi@9
  __int64 v10; // rdi@11
  __int64 v11; // rdi@13
  __int64 v12; // rdi@15
  __int64 v13; // rdi@17
  __int64 v14; // rdi@19
  __int64 v15; // rdi@21
  __int64 v16; // rdi@23

  v2 = (__int64)this;
  IO80211Interface::terminateSupplicant(this, a2);
  v3 = *((_QWORD *)this + 67);
  if ( v3 )
  {
    IOFree(v3, 8LL);
    *(_QWORD *)(v2 + 536) = 0LL;
  }
  v4 = *(_QWORD *)(v2 + 384);
  if ( v4 )
  {
    ifnet_remove_multicast(v4);
    ifmaddr_release(*(_QWORD *)(v2 + 384));
    *(_QWORD *)(v2 + 384) = 0LL;
  }
  v5 = 0LL;
  IO80211Interface::setCountermeasuresTimer(v2, 0LL);
  IO80211Interface::freePMKSACache((IO80211Interface *)v2, v6);
  v7 = *(_QWORD *)(v2 + 424);
  if ( v7 )
  {
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v7 + 280LL))(v7, 0LL);
    *(_QWORD *)(v2 + 424) = 0LL;
  }
  v8 = *(_QWORD *)(v2 + 520);
  if ( v8 )
    thread_call_free(v8, 0LL);
  v9 = *(_QWORD *)(v2 + 440);
  if ( v9 )
  {
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v9 + 40LL))(v9, 0LL);
    *(_QWORD *)(v2 + 440) = 0LL;
  }
  v10 = *(_QWORD *)(v2 + 448);
  if ( v10 )
  {
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v10 + 40LL))(v10, 0LL);
    *(_QWORD *)(v2 + 448) = 0LL;
  }
  v11 = *(_QWORD *)(v2 + 472);
  if ( v11 )
  {
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v11 + 40LL))(v11, 0LL);
    *(_QWORD *)(v2 + 472) = 0LL;
  }
  v12 = *(_QWORD *)(v2 + 480);
  if ( v12 )
  {
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v12 + 40LL))(v12, 0LL);
    *(_QWORD *)(v2 + 480) = 0LL;
  }
  v13 = *(_QWORD *)(v2 + 488);
  if ( v13 )
  {
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v13 + 40LL))(v13, 0LL);
    *(_QWORD *)(v2 + 488) = 0LL;
  }
  v14 = *(_QWORD *)(v2 + 552);
  if ( v14 )
    IOLockFree(v14);
  v15 = *(_QWORD *)(v2 + 544);
  if ( v15 )
  {
    IO80211BPFListFree(v15);
    v5 = 8LL;
    IOFree(*(_QWORD *)(v2 + 544), 8LL);
  }
  v16 = *(_QWORD *)(v2 + 576);
  if ( v16 )
    thread_call_free(v16, v5);
  return (*(int (__fastcall **)(__int64, signed __int64))(off_7B058[0] + 160))(v2, v5);
}
// 7B058: using guessed type __int64 off_7B058[11];
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C76F8: using guessed type int __fastcall IOLockFree(_QWORD);
// C8AB0: using guessed type int __fastcall ifmaddr_release(_QWORD);
// C8B50: using guessed type int __cdecl ifnet_remove_multicast(_QWORD);
// C8DD0: using guessed type int __fastcall thread_call_free(_QWORD, _QWORD);

//----- (000000000005553A) ----------------------------------------------------
int __usercall IO80211Interface::terminateSupplicant@<eax>(IO80211Interface *this@<rdi>, __int64 a2@<rax>)
{
  IO80211Interface *v2; // rbx@1
  __int64 v3; // rdi@1
  char *v4; // rax@3
  __int64 v5; // rdx@3
  __int64 v6; // r8@3
  __int64 v7; // r9@3
  __int64 v8; // rax@3
  __int64 v9; // rax@3
  __int64 v10; // rdx@3
  __int64 v11; // r8@3
  __int64 v12; // r9@3
  char v14; // [sp+0h] [bp-10h]@0

  v2 = this;
  v3 = *((_QWORD *)this + 47);
  if ( v3 )
  {
    if ( *((_BYTE *)v2 + 432) & 4 )
    {
      v4 = IO80211Interface::getBSDName(v2, a2);
      LODWORD(v8) = IOLog("%s: Terminating supplicant.\n", v4, v5, v4, v6, v7);
      v9 = (__int64)IO80211Interface::getBSDName(v2, v8);
      IO8Log("%s: Terminating supplicant.\n", v9, v10, v9, v11, v12, v14);
      v3 = *((_QWORD *)v2 + 47);
    }
    LODWORD(a2) = (*(int (**)(void))(*(_QWORD *)v3 + 40LL))();
    *((_QWORD *)v2 + 47) = 0LL;
  }
  return a2;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000555AE) ----------------------------------------------------
void __fastcall IO80211Interface::setCountermeasuresTimer(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1
  __int64 v4; // rax@3
  RSNSupplicant *v5; // rdi@7

  v2 = a1;
  v3 = *(_QWORD *)(a1 + 392);
  if ( v3 != a2 )
  {
    if ( v3 )
    {
      (*(void (**)(void))(*(_QWORD *)v3 + 536LL))();
      LODWORD(v4) = (*(int (**)(void))(**(_QWORD **)(v2 + 448) + 1672LL))();
      if ( v4 )
        (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v4 + 328LL))(v4, *(_QWORD *)(v2 + 392));
      (*(void (**)(void))(**(_QWORD **)(v2 + 392) + 40LL))();
    }
    if ( !a2 )
    {
      v5 = *(RSNSupplicant **)(v2 + 376);
      if ( v5 )
        RSNSupplicant::setCounterMeasures(v5, 0);
    }
    *(_QWORD *)(v2 + 392) = a2;
  }
}

//----- (000000000005562E) ----------------------------------------------------
int __usercall IO80211Interface::freePMKSACache@<eax>(IO80211Interface *this@<rdi>, int result@<eax>)
{
  IO80211Interface *v2; // rbx@1
  __int64 v3; // rdi@3
  __int64 v4; // rax@4

  v2 = this;
  while ( 1 )
  {
    v3 = *((_QWORD *)v2 + 52);
    if ( !v3 )
      break;
    v4 = *(_QWORD *)v3;
    if ( *(_QWORD *)v3 )
      *(_QWORD *)(v4 + 8) = *(_QWORD *)(v3 + 8);
    **(_QWORD **)(v3 + 8) = v4;
    result = IOFree(v3, 96LL);
  }
  return result;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (0000000000055670) ----------------------------------------------------
signed int __fastcall IO80211Interface::performCommand(IO80211Interface *this, IONetworkController *a2, __int64 a3, void *a4, void *a5)
{
  signed __int64 v5; // rax@2
  signed __int64 v6; // rax@8
  char v7; // al@15
  char v8; // cl@19
  signed int result; // eax@19
  signed __int64 v10; // rax@20
  signed __int64 v11; // rdx@21
  signed __int64 v12; // rdx@28
  signed __int64 v13; // rdx@32
  __int64 v14; // [sp+18h] [bp-28h]@1

  v14 = a3;
  if ( a3 <= 2149607881LL )
  {
    v5 = 2149345738LL;
    goto LABEL_6;
  }
  if ( a3 > 3223873992LL )
  {
    v6 = 3223873993LL;
  }
  else
  {
    if ( a3 <= 2149870023LL )
    {
      v5 = 2149607882LL;
LABEL_6:
      if ( a3 == v5 )
      {
LABEL_15:
        v7 = IO80211InterfaceValidateNet80211Command(a3, (__int64)a2, a3, (__int64)a4);
        goto LABEL_19;
      }
      return (*(int (**)(void))(off_7B058[0] + 2416))();
    }
    if ( a3 > 2150132167LL )
    {
      if ( a3 > 3223087562LL )
      {
        if ( a3 == 3223087563LL || a3 == 3223349707LL )
          goto LABEL_15;
        v6 = 3223611849LL;
      }
      else
      {
        v6 = 2150132168LL;
      }
    }
    else
    {
      v6 = 2149870024LL;
    }
  }
  if ( a3 != v6 )
    return (*(int (**)(void))(off_7B058[0] + 2416))();
  v7 = IO80211InterfaceValidateApple80211Command(a3, (__int64)a2, a3, (__int64)a4);
LABEL_19:
  v8 = v7;
  result = 22;
  if ( !v8 )
    return result;
  v10 = 2149607882LL;
  if ( v14 <= 2149607881LL )
  {
    v11 = 2149345738LL;
    goto LABEL_26;
  }
  if ( v14 > 3223873992LL )
  {
    v12 = 3223873993LL;
  }
  else
  {
    if ( v14 <= 2149870023LL )
    {
      v11 = 2149607882LL;
LABEL_26:
      if ( v14 != v11 )
        return (*(int (__fastcall **)(IONetworkController *, IO80211Interface *, __int64 (__fastcall *)(IO80211Interface *, void *, void *, void *, void *, void *), IO80211Interface *, IONetworkController *, __int64 *))(*(_QWORD *)a2 + 2128LL))(
                 a2,
                 this,
                 IO80211Interface::performGatedCommand,
                 this,
                 a2,
                 &v14);
      goto LABEL_40;
    }
    if ( v14 <= 2150132167LL )
    {
      v13 = 2149870024LL;
      goto LABEL_35;
    }
    if ( v14 <= 3223087562LL )
    {
      v13 = 2150132168LL;
LABEL_35:
      if ( v14 == v13 )
      {
        v10 = 2150132168LL;
        goto LABEL_40;
      }
      return (*(int (__fastcall **)(IONetworkController *, IO80211Interface *, __int64 (__fastcall *)(IO80211Interface *, void *, void *, void *, void *, void *), IO80211Interface *, IONetworkController *, __int64 *))(*(_QWORD *)a2 + 2128LL))(
               a2,
               this,
               IO80211Interface::performGatedCommand,
               this,
               a2,
               &v14);
    }
    if ( v14 == 3223087563LL || v14 == 3223349707LL )
    {
      v10 = 3223349707LL;
      goto LABEL_40;
    }
    v12 = 3223611849LL;
  }
  if ( v14 == v12 )
  {
    v10 = 3223873993LL;
LABEL_40:
    v14 = v10;
  }
  return (*(int (__fastcall **)(IONetworkController *, IO80211Interface *, __int64 (__fastcall *)(IO80211Interface *, void *, void *, void *, void *, void *), IO80211Interface *, IONetworkController *, __int64 *))(*(_QWORD *)a2 + 2128LL))(
           a2,
           this,
           IO80211Interface::performGatedCommand,
           this,
           a2,
           &v14);
}
// 7B058: using guessed type __int64 off_7B058[11];

//----- (0000000000055822) ----------------------------------------------------
__int64 __fastcall IO80211Interface::performGatedCommand(IO80211Interface *this, void *a2, void *a3, void *a4, void *a5, void *a6)
{
  void *v6; // r12@1
  __int64 v7; // rbx@1
  __int64 v8; // r15@1
  __int64 v9; // rax@1
  __int64 v10; // r13@1
  signed int v11; // er14@1
  __int64 v12; // rcx@2
  int v13; // er12@2
  __int64 v14; // r12@7
  char v15; // al@7
  __int64 v16; // rbx@8
  __int64 v17; // r12@11
  char v18; // al@11
  __int64 v19; // rbx@12
  __int64 result; // rax@16
  void *v21; // [sp+8h] [bp-98h]@1
  char v22; // [sp+26h] [bp-7Ah]@7
  char v23; // [sp+27h] [bp-79h]@11
  char v24[8]; // [sp+28h] [bp-78h]@7
  __int64 v25; // [sp+30h] [bp-70h]@7
  __int64 v26; // [sp+38h] [bp-68h]@7
  __int64 v27; // [sp+40h] [bp-60h]@7
  char v28[8]; // [sp+48h] [bp-58h]@11
  __int64 v29; // [sp+50h] [bp-50h]@11
  __int64 v30; // [sp+58h] [bp-48h]@11
  __int64 v31; // [sp+60h] [bp-40h]@11
  __int64 v32; // [sp+68h] [bp-38h]@11
  __int64 v33; // [sp+70h] [bp-30h]@1

  v6 = a5;
  v21 = a4;
  v7 = off_7B078[0];
  v33 = *(_QWORD *)off_7B078[0];
  v8 = *(_QWORD *)a3;
  LODWORD(v9) = proc_self(this, a2, a3, a4);
  v10 = v9;
  v11 = 22;
  if ( !v9 )
    goto LABEL_16;
  v12 = (__int64)v6;
  v13 = 102;
  if ( v8 > 2150132167LL )
  {
    if ( v8 == 2150132168LL )
      goto LABEL_20;
    if ( v8 == 3223349707LL )
    {
LABEL_7:
      v27 = 0LL;
      v26 = 0LL;
      v25 = 0LL;
      *(_QWORD *)v24 = 0LL;
      v14 = v12;
      v15 = IO80211InterfaceUserlandToKernelNet80211Commmand(v24, (char *)v12, (__int64)&v22, v12);
      v7 = off_7B078[0];
      if ( !v15 )
        goto LABEL_16;
      v16 = v14;
      v13 = net80211_ioctl((__int64)v24, v8, (IO80211Controller *)a2, (__int64)this);
      if ( v13 )
        goto LABEL_15;
      *(_WORD *)(v16 + 20) = WORD2(v26);
      *(_WORD *)(v16 + 18) = WORD1(v26);
      goto LABEL_14;
    }
    if ( v8 == 3223873993LL )
    {
LABEL_20:
      v32 = 0LL;
      v31 = 0LL;
      v30 = 0LL;
      v29 = 0LL;
      *(_QWORD *)v28 = 0LL;
      v17 = v12;
      v18 = IO80211InterfaceUserlandToKernelApple80211Commmand(v28, (char *)v12, (__int64)&v23, v12);
      v7 = off_7B078[0];
      if ( !v18 )
        goto LABEL_16;
      v19 = v17;
      v13 = (*(int (__fastcall **)(void *, IO80211Interface *, _QWORD, void *, __int64, char *))(*(_QWORD *)a2 + 3200LL))(
              a2,
              this,
              0LL,
              v21,
              v8,
              v28);
      if ( !v13 )
      {
        *(_DWORD *)(v19 + 24) = v31;
        *(_DWORD *)(v19 + 20) = HIDWORD(v30);
LABEL_14:
        v13 = 0;
        goto LABEL_15;
      }
    }
  }
  else if ( v8 == 2149607882LL )
  {
    goto LABEL_7;
  }
LABEL_15:
  proc_rele(v10);
  v11 = v13;
  v7 = off_7B078[0];
LABEL_16:
  result = *(_QWORD *)v7;
  if ( *(_QWORD *)v7 == v33 )
    result = (unsigned int)v11;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C8D08: using guessed type int __fastcall proc_rele(_QWORD);
// C8D10: using guessed type int __fastcall proc_self(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000559FE) ----------------------------------------------------
__int64 __fastcall IO80211Interface::getController(IO80211Interface *this)
{
  return *((_QWORD *)this + 56);
}

//----- (0000000000055A0C) ----------------------------------------------------
__int64 __fastcall IO80211Interface::finishAttachToDataLinkLayer(IO80211Interface *this)
{
  __int64 v1; // r13@1
  __int64 v2; // rax@1
  __int64 v3; // r14@1
  signed int v4; // er15@1
  __int64 v5; // rax@2
  __int64 v6; // rax@2
  IO80211ScanManager *v7; // rax@2
  unsigned int v8; // eax@5
  __int64 v9; // r8@5
  __int64 v10; // r9@5
  __int64 result; // rax@8
  int v12; // [sp+20h] [bp-60h]@2
  __int16 v13; // [sp+24h] [bp-5Ch]@2
  __int64 v14; // [sp+28h] [bp-58h]@5
  __int64 v15; // [sp+30h] [bp-50h]@5
  char v16; // [sp+38h] [bp-48h]@2
  char v17; // [sp+39h] [bp-47h]@2
  __int16 v18; // [sp+3Ah] [bp-46h]@2
  char v19; // [sp+3Ch] [bp-44h]@2
  unsigned __int8 v20; // [sp+3Dh] [bp-43h]@2
  char v21; // [sp+3Eh] [bp-42h]@2
  char v22[16]; // [sp+40h] [bp-40h]@2
  __int64 v23; // [sp+50h] [bp-30h]@1

  v1 = off_7B078[0];
  v23 = *(_QWORD *)off_7B078[0];
  (*(void (__fastcall **)(_QWORD, IO80211Interface *))(**((_QWORD **)this + 56) + 3272LL))(*((_QWORD *)this + 56), this);
  LODWORD(v2) = (*(int (__fastcall **)(IO80211Interface *))(*(_QWORD *)this + 2408LL))(this);
  v3 = v2;
  v4 = -536870212;
  if ( v2 )
  {
    v13 = -28149;
    v12 = -544013567;
    bzero(&v16, 0x14uLL);
    v16 = 20;
    v17 = 18;
    v19 = 6;
    v21 = 6;
    v18 = ifnet_index(v3);
    memcpy(&v22[v20], &v12, 6uLL);
    ifnet_add_multicast(v3, &v16, (char *)this + 384);
    LODWORD(v5) = ifnet_lladdr(v3);
    *((_QWORD *)this + 57) = v5;
    *((_BYTE *)this + 464) = ifnet_type(v3, &v16);
    IO80211Interface::updateStaticProperties(this);
    LODWORD(v6) = registerPrioritySleepWakeInterest(IO80211Interface::powerChangeHandler, this, 0LL);
    *((_QWORD *)this + 53) = v6;
    LODWORD(v7) = (*(int (__fastcall **)(_QWORD, IO80211Interface *))(*(_QWORD *)IO80211ScanManager::metaClass + 136LL))(
                    IO80211ScanManager::metaClass,
                    this);
    *((_QWORD *)this + 62) = v7;
    if ( v7 )
    {
      if ( (unsigned __int8)IO80211ScanManager::initWithControllerAndInterface(
                              v7,
                              *((IO80211Controller **)this + 56),
                              this) )
      {
        if ( *(_BYTE *)(*((_QWORD *)this + 67) + 3LL) & 1 )
        {
          v14 = 0LL;
          v15 = 0LL;
          v8 = IO80211Interface::bpfAttach(
                 (__int64)this,
                 12,
                 0x40u,
                 (__int64)this,
                 (__int64)IO80211Interface::bpfOutputPacket,
                 0LL,
                 0LL,
                 0LL,
                 0LL);
          if ( v8 )
            IOLog("IO80211Interface::finishAttachToDataLinkLayer: bpfAttach(%d) failed (%d)\n", 12LL, v8, v8, v9, v10);
        }
        ifnet_set_eflags(v3, 0x200000LL, 0x200000LL);
        v4 = 0;
      }
    }
  }
  result = *(_QWORD *)v1;
  if ( *(_QWORD *)v1 == v23 )
    result = (unsigned int)v4;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 810A0: using guessed type _QWORD IO80211ScanManager::metaClass;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8AB8: using guessed type int __fastcall ifnet_add_multicast(_QWORD, _QWORD, _QWORD);
// C8B08: using guessed type int __fastcall ifnet_index(_QWORD);
// C8B18: using guessed type int __fastcall ifnet_lladdr(_QWORD);
// C8B68: using guessed type int __fastcall ifnet_set_eflags(_QWORD, _QWORD, _QWORD);
// C8BA8: using guessed type int __fastcall ifnet_type(_QWORD, _QWORD);
// C8D40: using guessed type int __fastcall registerPrioritySleepWakeInterest(_QWORD, _QWORD, _QWORD);
// 55A0C: using guessed type char var_40[16];

//----- (0000000000055BE4) ----------------------------------------------------
__int64 __fastcall IO80211Interface::updateStaticProperties(IO80211Interface *this)
{
  __int64 v1; // r15@1
  size_t v2; // rdx@2
  size_t v3; // rdx@6
  char v4[8]; // rdx@11
  char v6; // [sp+8h] [bp-238h]@9
  int v7; // [sp+Ch] [bp-234h]@10
  char v8; // [sp+10h] [bp-230h]@2
  int v9; // [sp+118h] [bp-128h]@1
  unsigned __int16 v10; // [sp+11Ch] [bp-124h]@2
  char v11; // [sp+11Eh] [bp-122h]@4
  __int64 v12; // [sp+220h] [bp-20h]@1

  v1 = off_7B078[0];
  v12 = *(_QWORD *)off_7B078[0];
  __bzero(&v9, 264LL);
  v9 = 1;
  if ( !(*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, int *))(**((_QWORD **)this + 56)
                                                                                                 + 3216LL))(
          *((_QWORD *)this + 56),
          3223873993LL,
          44LL,
          this,
          &v9) )
  {
    bzero(&v8, 0x101uLL);
    v2 = 256LL;
    if ( v10 < 0x100uLL )
      v2 = v10;
    memcpy(&v8, &v11, v2);
    (*(void (__fastcall **)(IO80211Interface *, _QWORD, char *))(*(_QWORD *)this + 624LL))(
      this,
      "IO80211HardwareVersion",
      &v8);
  }
  v9 = 1;
  if ( !(*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, int *))(**((_QWORD **)this + 56)
                                                                                                 + 3216LL))(
          *((_QWORD *)this + 56),
          3223873993LL,
          43LL,
          this,
          &v9) )
  {
    bzero(&v8, 0x101uLL);
    v3 = 256LL;
    if ( v10 < 0x100uLL )
      v3 = v10;
    memcpy(&v8, &v11, v3);
    (*(void (__fastcall **)(IO80211Interface *, _QWORD, char *))(*(_QWORD *)this + 624LL))(
      this,
      "IO80211DriverVersion",
      &v8);
  }
  if ( !(*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, char *))(**((_QWORD **)this + 56)
                                                                                                  + 3216LL))(
          *((_QWORD *)this + 56),
          3223873993LL,
          28LL,
          this,
          &v6) )
  {
    if ( (unsigned int)(v7 - 1) > 6 )
      *(_QWORD *)v4 = "Unknown";
    else
      *(_QWORD *)v4 = off_804A0[v7 - 1];
    (*(void (__fastcall **)(IO80211Interface *, _QWORD, char[8]))(*(_QWORD *)this + 624LL))(
      this,
      "IO80211Locale",
      *(_QWORD *)v4);
  }
  IO80211Interface::updateCountryCodeProperty(this, 0);
  return *(_QWORD *)v1;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 804A0: using guessed type char *off_804A0[7];
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000055D9C) ----------------------------------------------------
int __fastcall IO80211Interface::powerChangeHandler(IO80211Interface *this, void *a2, void *a3, __int64 a4, IOService *a5, void *a6)
{
  int v6; // er14@1
  __int64 v7; // rax@1
  __int64 v8; // rbx@1
  int result; // eax@1
  __int64 v10; // rdi@2
  __int64 v11; // rax@5
  int v12; // [sp+Ch] [bp-14h]@5

  v6 = (signed int)a3;
  LODWORD(v7) = OSMetaClassBase::safeMetaCast(this, &IO80211Interface::gMetaClass);
  v8 = v7;
  result = -536870212;
  if ( v8 )
  {
    v10 = *(_QWORD *)(v8 + 448);
    if ( v10 )
    {
      if ( v6 == -536870272 || (result = 0, v6 == -536870112) )
      {
        v12 = 0;
        LODWORD(v11) = (*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v10 + 2224LL))(
                         v10,
                         &IO80211Interface::gMetaClass);
        result = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IO80211Interface *__hidden, OSObject *, void *, void *, void *, void *), __int64, int *, _QWORD, _QWORD))(*(_QWORD *)v11 + 456LL))(
                   v11,
                   IO80211Interface::performCountryCodeOpGated,
                   v8,
                   &v12,
                   0LL,
                   0LL);
      }
    }
  }
  return result;
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000055E1E) ----------------------------------------------------
__int64 __fastcall IO80211Interface::bpfAttach(IO80211Interface *this, int a2, unsigned int a3)
{
  return IO80211Interface::bpfAttach(
           (__int64)this,
           a2,
           a3,
           (__int64)this,
           (__int64)IO80211Interface::bpfOutputPacket,
           0LL,
           0LL,
           0LL,
           0LL);
}

//----- (0000000000055E68) ----------------------------------------------------
__int64 __fastcall IO80211Interface::finishAttachToDataLinkLayerGated(IO80211Interface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  return IO80211Interface::finishAttachToDataLinkLayer(a2);
}

//----- (0000000000055E76) ----------------------------------------------------
int __fastcall IO80211Interface::attachToDataLinkLayer(IO80211Interface *this, unsigned int a2, void *a3)
{
  void *v3; // r14@1
  int result; // eax@1
  __int64 v5; // rax@2

  v3 = a3;
  IONetworkInterface::installOutputPreEnqueueHandler(
    this,
    (int (__cdecl *)(void *, void *, __mbuf *))IO80211Interface::outputPreEnqueueHandler,
    (void *)this,
    0LL);
  result = (*(int (__fastcall **)(IO80211Interface *, _QWORD, void *))(off_7B058[0] + 2480))(this, a2, v3);
  if ( !result )
  {
    LODWORD(v5) = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)this + 56) + 2224LL))(*((_QWORD *)this + 56));
    result = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IO80211Interface *__hidden, OSObject *, void *, void *, void *, void *), IO80211Interface *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v5 + 456LL))(
               v5,
               IO80211Interface::finishAttachToDataLinkLayerGated,
               this,
               0LL,
               0LL,
               0LL);
  }
  return result;
}
// 7B058: using guessed type __int64 off_7B058[11];

//----- (0000000000055EFC) ----------------------------------------------------
__int64 __fastcall IO80211Interface::outputPreEnqueueHandler(IO80211Interface *this, void *a2, void *a3, __mbuf *a4)
{
  __mbuf *v4; // rbx@1
  IO80211Interface *v5; // r14@1
  int v6; // er13@4
  __mbuf *v7; // rax@5
  __mbuf *v8; // rax@5
  __int64 v9; // r12@6
  __int64 v10; // rax@7
  __int64 v11; // rax@10
  int v12; // er15@11
  IO80211PeerManager *v13; // rdi@12
  __int64 v14; // rax@14
  __int64 v15; // r9@14
  IO80211PeerManager *v16; // rdi@18
  __int64 v17; // rax@20
  __int64 v18; // r9@20
  unsigned int v20; // [sp+8h] [bp-38h]@20
  unsigned int v21; // [sp+Ch] [bp-34h]@14
  __mbuf *v22; // [sp+10h] [bp-30h]@1

  v4 = (__mbuf *)a3;
  v5 = this;
  v22 = (__mbuf *)a3;
  if ( this && a3 && *((_QWORD *)this + 56) )
  {
    v6 = 0;
    while ( 1 )
    {
      LODWORD(v7) = mbuf_nextpkt(v4);
      v4 = v7;
      mbuf_setnextpkt(v22, 0LL);
      v8 = IO80211InterfaceClassifyAndFixupPacket(v5, v22);
      v22 = v8;
      if ( !v8 )
        goto LABEL_15;
      v9 = *(_QWORD *)(*((_QWORD *)v5 + 56) + 336LL);
      if ( !v9
        || (LODWORD(v10) = mbuf_data(v8), *(_WORD *)(v10 + 12) != 8)
        || !IO80211Controller::checkForInfraPacketRedirect(*((IO80211Controller **)v5 + 56), &v22) )
      {
        v12 = IONetworkInterface::enqueueOutputPacket(v5, v22, 0);
        if ( v12 )
        {
          if ( v9 )
          {
            v16 = *(IO80211PeerManager **)(v9 + 144);
            if ( v16 )
            {
              if ( IO80211PeerManager::shouldLog(v16, 256LL) )
              {
                v20 = 0;
                v17 = IO80211VirtualInterface::getIfnet((IO80211VirtualInterface *)v9);
                ifnet_get_sndq_len(v17, &v20);
                IOLog(
                  "%s cannot enqueue packet m=%p err %d len %u\n",
                  "outputPreEnqueueHandler",
                  v22,
                  (unsigned int)v12,
                  v20,
                  v18);
              }
            }
          }
        }
        goto LABEL_21;
      }
      if ( v22 )
      {
        v11 = IO80211VirtualInterface::getIfnet((IO80211VirtualInterface *)v9);
        v6 = ifnet_enqueue(v11, v22);
      }
      v12 = 0;
      if ( v6 )
        break;
LABEL_21:
      v22 = v4;
      v6 = v12;
      if ( !v4 )
        return 0LL;
    }
    v13 = *(IO80211PeerManager **)(v9 + 144);
    if ( v13 && IO80211PeerManager::shouldLog(v13, 256LL) )
    {
      v21 = 0;
      v14 = IO80211VirtualInterface::getIfnet((IO80211VirtualInterface *)v9);
      ifnet_get_sndq_len(v14, &v21);
      IOLog("%s cannot capture packet m=%p err %d len %u\n", "outputPreEnqueueHandler", v22, (unsigned int)v6, v21, v15);
    }
LABEL_15:
    v12 = v6;
    goto LABEL_21;
  }
  return 0LL;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8AE0: using guessed type int __fastcall ifnet_enqueue(_QWORD, _QWORD);
// C8B00: using guessed type int __fastcall ifnet_get_sndq_len(_QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C60: using guessed type int __fastcall mbuf_nextpkt(_QWORD);
// C8CC0: using guessed type int __fastcall mbuf_setnextpkt(_QWORD, _QWORD);

//----- (00000000000560C6) ----------------------------------------------------
int __fastcall IO80211Interface::detachFromDataLinkLayer(IO80211Interface *this, unsigned int a2, void *a3)
{
  void *v3; // r14@1
  IO80211Interface *v4; // rbx@1
  __int64 v5; // rdi@1
  __int64 v6; // rdi@3

  v3 = a3;
  v4 = this;
  v5 = *((_QWORD *)this + 48);
  if ( v5 )
  {
    ifnet_remove_multicast(v5);
    ifmaddr_release(*((_QWORD *)v4 + 48));
    *((_QWORD *)v4 + 48) = 0LL;
  }
  v6 = *((_QWORD *)v4 + 62);
  if ( v6 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v6 + 40LL))(v6);
    *((_QWORD *)v4 + 62) = 0LL;
  }
  return (*(int (__fastcall **)(IO80211Interface *, _QWORD, void *))(off_7B058[0] + 2488))(v4, a2, v3);
}
// 7B058: using guessed type __int64 off_7B058[11];
// C8AB0: using guessed type int __fastcall ifmaddr_release(_QWORD);
// C8B50: using guessed type int __cdecl ifnet_remove_multicast(_QWORD);

//----- (000000000005613E) ----------------------------------------------------
int __fastcall IO80211Interface::reportTransmitStatus(__int64 a1, __int64 a2, int a3, __int64 a4)
{
  IO80211PeerManager *v4; // rdi@1
  int result; // eax@2

  v4 = *(IO80211PeerManager **)(a1 + 328);
  if ( v4 )
  {
    result = IO80211PeerManager::reportTransmitStatus(v4, a2, a3, a4);
  }
  else if ( a2 )
  {
    result = mbuf_freem(a2);
  }
  return result;
}
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);

//----- (0000000000056164) ----------------------------------------------------
__int64 __usercall IO80211Interface::reportDataPathEventsGated@<rax>(IO80211Interface *this@<rdi>, void *a2@<rsi>, void *a3@<rdx>, void *a4@<rcx>, void *a5@<r8>, void *a6@<r9>, __int64 a7@<rax>)
{
  void *v7; // r14@1
  IO80211Interface *v8; // rbx@1
  unsigned int v9; // er15@1
  unsigned __int64 v10; // r12@1
  __int64 v11; // rdi@4
  char *v12; // rax@6

  v7 = a3;
  v8 = this;
  v9 = *(_DWORD *)a2;
  v10 = 0LL;
  if ( a4 )
    v10 = *(_QWORD *)a4;
  if ( this )
  {
    v11 = *((_QWORD *)this + 41);
    if ( !v11
      || (LODWORD(a7) = (*(int (__fastcall **)(__int64, _QWORD, void *, unsigned __int64, void *, void *))(*(_QWORD *)v11 + 480LL))(
                          v11,
                          v9,
                          a3,
                          v10,
                          a5,
                          a6),
          (_BYTE)a7) )
    {
      v12 = IO80211Interface::getBSDName(v8, a7);
      IO80211InterfacePostMessage(v12, v9, v7, v10);
    }
  }
  return 0LL;
}

//----- (00000000000561CE) ----------------------------------------------------
char *__usercall IO80211Interface::getBSDName@<rax>(IO80211Interface *this@<rdi>, __int64 a2@<rax>)
{
  __int64 v2; // rax@2
  __int64 v3; // r14@2
  __int64 v4; // rax@3
  __int64 v5; // r15@3
  int v6; // eax@3
  __int64 v8; // [sp-8h] [bp-20h]@1

  v8 = a2;
  if ( !*((_BYTE *)this + 400) )
  {
    LODWORD(v2) = (*(int (__cdecl **)(IO80211Interface *))(*(_QWORD *)this + 2408LL))(this);
    v3 = v2;
    if ( v2 )
    {
      LODWORD(v4) = ifnet_name(v2);
      v5 = v4;
      v6 = ifnet_unit(v3);
      snprintf((char *)this + 400, 0x10uLL, "%s%u", v5, (unsigned int)v6, v8);
    }
  }
  return (char *)this + 400;
}
// C8B20: using guessed type int __fastcall ifnet_name(_QWORD);
// C8BB0: using guessed type int __fastcall ifnet_unit(_QWORD);

//----- (0000000000056236) ----------------------------------------------------
bool __fastcall IO80211Interface::reportDataPathEvents(IO80211Interface *this, int a2, void *a3, __int64 a4)
{
  __int64 v5; // [sp+10h] [bp-10h]@1
  int v6; // [sp+1Ch] [bp-4h]@1

  v6 = a2;
  v5 = a4;
  return (*(int (__fastcall **)(_QWORD, IO80211Interface *, __int64 (__usercall *)@<rax>(IO80211Interface *@<rdi>, void *@<rsi>, void *@<rdx>, void *@<rcx>, void *@<r8>, void *@<r9>, __int64@<rax>), IO80211Interface *, int *, void *))(**((_QWORD **)this + 56) + 2128LL))(
           *((_QWORD *)this + 56),
           this,
           IO80211Interface::reportDataPathEventsGated,
           this,
           &v6,
           a3) != 0;
}

//----- (000000000005628A) ----------------------------------------------------
char __usercall IO80211Interface::postMessage@<al>(IO80211Interface *this@<rdi>, ether_addr *a2@<rdx>, __int64 a3@<rax>, __int64 a4@<rcx>, signed int a5@<esi>)
{
  __int64 v5; // r12@1
  ether_addr *v6; // r14@1
  __int64 v7; // rax@2
  char *v8; // rax@3
  RSNSupplicant *v9; // rdi@6
  IO80211PeerManager *v10; // rdi@10
  RSNSupplicant *v11; // rdi@17
  __int64 v12; // rax@23
  __int64 v13; // r8@23
  __int64 v14; // r9@23
  __int64 v16; // [sp+10h] [bp-30h]@2
  int v17; // [sp+1Ch] [bp-24h]@2

  v5 = a4;
  v6 = a2;
  if ( *((_QWORD *)this + 41) )
  {
    v17 = a5;
    v16 = a4;
    LOBYTE(v7) = (*(int (__fastcall **)(_QWORD, IO80211Interface *, __int64 (__usercall *)@<rax>(IO80211Interface *@<rdi>, void *@<rsi>, void *@<rdx>, void *@<rcx>, void *@<r8>, void *@<r9>, __int64@<rax>), IO80211Interface *, int *, ether_addr *))(**((_QWORD **)this + 56) + 2128LL))(
                   *((_QWORD *)this + 56),
                   this,
                   IO80211Interface::reportDataPathEventsGated,
                   this,
                   &v17,
                   a2);
  }
  else
  {
    v8 = IO80211Interface::getBSDName(this, a3);
    LOBYTE(v7) = IO80211InterfacePostMessage(v8, (unsigned int)a5, v6, v5);
  }
  if ( a5 > 38 )
  {
    switch ( a5 )
    {
      case 54:
        if ( v5 == 32 && v6 )
          LOBYTE(v7) = IO80211Controller::handleChannelSwitchAnnouncement(*((_QWORD *)this + 56));
        break;
      case 49:
        v10 = (IO80211PeerManager *)*((_QWORD *)this + 41);
        if ( v10 )
          LOBYTE(v7) = IO80211PeerManager::reset(v10);
        break;
      case 39:
        LOBYTE(v7) = IO80211Interface::reportDataTransferRates(this);
        break;
    }
  }
  else
  {
    v7 = (unsigned int)(a5 - 1);
    switch ( a5 )
    {
      case 5:
      case 6:
        v9 = (RSNSupplicant *)*((_QWORD *)this + 47);
        if ( v9 )
          LOBYTE(v7) = RSNSupplicant::micFailure(v9, v7, a5);
        break;
      case 18:
      case 19:
        v11 = (RSNSupplicant *)*((_QWORD *)this + 47);
        if ( v11 && v5 == 38 )
        {
          if ( a5 == 18 )
            LOBYTE(v7) = RSNSupplicant::ibssPeerArrived(v11, v6, v6[1].octet);
          else
            LOBYTE(v7) = RSNSupplicant::ibssPeerLeft(v11, v6);
        }
        break;
      case 1:
        IO80211Interface::updateBSSIDProperty(this);
        LOBYTE(v7) = IO80211Interface::updateChannelProperty(this);
        break;
      case 2:
        LOBYTE(v7) = IO80211Interface::updateSSIDProperty(this);
        break;
      case 3:
        IO80211Interface::updateBSSIDProperty(this);
        IO80211Interface::updateChannelProperty(this);
        LODWORD(v12) = (*(int (__fastcall **)(IO80211Interface *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
        IOLog("%s::IO80211Interface::%s bssid changed\n", v12, "postMessage", v12, v13, v14);
        LOBYTE(v7) = IO80211Controller::infraBSSIDChange(*((IO80211Controller **)this + 56));
        break;
      case 10:
        IO80211Controller::scanDone(*((_QWORD *)this + 56), 3LL, 0);
        LOBYTE(v7) = IO80211ScanManager::scanDone(*((IO80211ScanManager **)this + 62), 1);
        break;
      case 11:
        LOBYTE(v7) = IO80211Interface::updateCountryCodeProperty(this, 1);
        break;
      case 16:
        IO80211ScanManager::scanDone(*((IO80211ScanManager **)this + 62), 0);
        LOBYTE(v7) = IO80211Controller::scanDone(*((_QWORD *)this + 56), 2LL, 0);
        break;
      default:
        return v7;
    }
  }
  return v7;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000564F8) ----------------------------------------------------
__int64 __fastcall IO80211Interface::reportDataTransferRates(IO80211Interface *this)
{
  __int64 v1; // r14@1
  unsigned __int64 v2; // rax@4
  __int64 v3; // rbx@5
  char v4; // al@6
  __int64 v5; // rcx@9
  _QWORD *v6; // rdx@11
  signed __int64 v7; // rcx@13
  _QWORD *v8; // rax@13
  unsigned __int64 v9; // rcx@13
  unsigned __int16 v10; // si@13
  unsigned __int16 v11; // dx@13
  unsigned __int64 v12; // rcx@14
  bool v13; // cf@16
  bool v14; // zf@16
  bool v15; // cl@16
  signed __int64 v16; // rax@20
  unsigned __int64 v17; // rdx@24
  __int64 v19; // [sp+8h] [bp-48h]@9
  __int64 v20; // [sp+10h] [bp-40h]@9
  char v21; // [sp+18h] [bp-38h]@3
  char v22; // [sp+20h] [bp-30h]@5
  char v23[12]; // [sp+24h] [bp-2Ch]@7
  __int64 v24; // [sp+30h] [bp-20h]@1

  v1 = off_7B078[0];
  v24 = *(_QWORD *)off_7B078[0];
  if ( !*((_QWORD *)this + 46) )
    IO80211Interface::updateLinkSpeed(this);
  if ( !(*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, char *))(**((_QWORD **)this + 56)
                                                                                                  + 3216LL))(
          *((_QWORD *)this + 56),
          3223873993LL,
          181LL,
          this,
          &v21) )
  {
    LODWORD(v12) = 10;
    v8 = &AC_80_SISO_PHY_SNR_RATE_TABLE;
LABEL_19:
    v10 = *((_WORD *)v8 + 1);
    v11 = *((_WORD *)v8 + 2);
LABEL_20:
    v16 = (signed __int64)((char *)v8 + 4);
    do
    {
      if ( (unsigned int)*(_WORD *)(v16 - 4) <= 0x1D )
      {
        v10 = *(_WORD *)(v16 - 2);
        v11 = *(_WORD *)v16;
      }
      v16 += 6LL;
      LODWORD(v12) = v12 - 1;
    }
    while ( (_DWORD)v12 );
    goto LABEL_24;
  }
  v2 = *((_QWORD *)this + 46);
  if ( v2 < 0x337F981 )
  {
    v13 = v2 < 0xA7D8C0;
    v14 = v2 == 11000000;
    v15 = v2 > 0xA7D8C0;
    v8 = &B_PHY_SNR_RATE_TABLE;
    if ( !v13 && !v14 )
      v8 = &AG_PHY_SNR_RATE_TABLE;
    LODWORD(v12) = 4 * (unsigned __int8)v12 + 4;
    goto LABEL_19;
  }
  v3 = 0LL;
  if ( !(*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, char *))(**((_QWORD **)this + 56)
                                                                                                  + 3216LL))(
          *((_QWORD *)this + 56),
          3223873993LL,
          66LL,
          this,
          &v22) )
  {
    v4 = -1;
    do
      ++v4;
    while ( (unsigned __int8)v23[(unsigned __int8)v4] == 255 );
    v3 = (unsigned int)(unsigned __int8)v4 - 1;
  }
  v20 = 0LL;
  v19 = 1LL;
  (*(void (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, __int64 *))(**((_QWORD **)this + 56)
                                                                                                + 3216LL))(
    *((_QWORD *)this + 56),
    3223873993LL,
    4LL,
    this,
    &v19);
  v5 = 0LL;
  if ( (unsigned int)v3 <= 1 )
    v5 = v3;
  v6 = &N_40_NSS_PHY_SNR_RATE_TABLE;
  if ( !(BYTE4(v20) & 4) )
    v6 = &N_20_NSS_PHY_SNR_RATE_TABLE;
  v7 = 2 * v5;
  v8 = (_QWORD *)v6[v7];
  v9 = LODWORD(v6[v7 + 1]);
  v10 = *((_WORD *)v8 + 1);
  v11 = *((_WORD *)v8 + 2);
  if ( v9 >= 6 )
  {
    v12 = 2863311531u * v9 >> 34;
    goto LABEL_20;
  }
LABEL_24:
  v17 = 2951479051793528259LL * ((4294967296000000LL * v10 >> 32) * (unsigned __int64)v11 >> 2) >> 64 >> 2;
  if ( *((_DWORD *)this + 90) == 1 )
    v17 = 0LL;
  (*(void (__fastcall **)(IO80211Interface *, unsigned __int64, unsigned __int64, _QWORD, _QWORD))(off_7B050[0] + 2536))(
    this,
    v17,
    v17,
    0LL,
    0LL);
  return *(_QWORD *)v1;
}
// 7AB10: using guessed type _QWORD AG_PHY_SNR_RATE_TABLE;
// 7AB40: using guessed type _QWORD B_PHY_SNR_RATE_TABLE;
// 7AC50: using guessed type _QWORD AC_80_SISO_PHY_SNR_RATE_TABLE;
// 7B050: using guessed type __int64 off_7B050[12];
// 7B078: using guessed type __int64 off_7B078[7];
// 80460: using guessed type _QWORD N_20_NSS_PHY_SNR_RATE_TABLE;
// 80480: using guessed type _QWORD N_40_NSS_PHY_SNR_RATE_TABLE;
// 564F8: using guessed type char var_2C[12];

//----- (00000000000566E8) ----------------------------------------------------
int __fastcall IO80211Interface::updateBSSIDProperty(IO80211Interface *this)
{
  __int64 v1; // rax@1
  char *v2; // rax@3
  __int64 v4; // [sp+10h] [bp-20h]@1
  int v5; // [sp+18h] [bp-18h]@1

  v5 = 0;
  v4 = 1LL;
  *(_QWORD *)((char *)this + 564) = 0LL;
  LODWORD(v1) = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, __int64 *))(**((_QWORD **)this + 56) + 3216LL))(
                  *((_QWORD *)this + 56),
                  3223873993LL,
                  9LL,
                  this,
                  &v4);
  if ( (_DWORD)v1 )
  {
    (*(void (__fastcall **)(IO80211Interface *, _QWORD))(*(_QWORD *)this + 672LL))(this, "IO80211BSSID");
  }
  else
  {
    v2 = IO80211Interface::getBSDName(this, v1);
    IOLog(
      "%s: BSSID changed to %02x:%02x:%02x:%02x:%02x:%02x\n",
      v2,
      BYTE4(v4),
      BYTE5(v4),
      (unsigned __int8)(HIDWORD(v4) >> 16),
      HIDWORD(v4) >> 24);
    (*(void (__fastcall **)(IO80211Interface *, _QWORD, char *, signed __int64))(*(_QWORD *)this + 648LL))(
      this,
      "IO80211BSSID",
      (char *)&v4 + 4,
      6LL);
  }
  return (*(int (__fastcall **)(IO80211Interface *, _QWORD))(*(_QWORD *)this + 1456LL))(this, 0LL);
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000567CC) ----------------------------------------------------
int __fastcall IO80211Interface::updateChannelProperty(IO80211Interface *this)
{
  char v1[8]; // r14@4
  void (__fastcall *v2)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@10
  __int64 v3; // rax@11
  __int64 v4; // rdx@14
  __int64 v5; // r14@16
  char *v6; // rax@18
  __int64 v7; // r8@18
  __int64 v8; // r9@18
  unsigned int v9; // er14@18
  unsigned int v10; // er15@18
  __int64 v12; // [sp+8h] [bp-28h]@1
  unsigned int v13[2]; // [sp+10h] [bp-20h]@1

  *(_QWORD *)v13 = 0LL;
  v12 = 1LL;
  if ( (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, __int64 *))(**((_QWORD **)this + 56) + 3216LL))(
         *((_QWORD *)this + 56),
         3223873993LL,
         4LL,
         this,
         &v12) )
  {
    (*(void (__fastcall **)(IO80211Interface *, _QWORD))(*(_QWORD *)this + 672LL))(this, "IO80211Channel");
    (*(void (__fastcall **)(IO80211Interface *, _QWORD))(*(_QWORD *)this + 672LL))(this, "IO80211Band");
    (*(void (__fastcall **)(IO80211Interface *, _QWORD))(*(_QWORD *)this + 672LL))(this, "IO80211ExtensionChannel");
    (*(void (__fastcall **)(IO80211Interface *, _QWORD))(*(_QWORD *)this + 672LL))(this, "IO80211ChannelFrequency");
    (*(void (__fastcall **)(IO80211Interface *, _QWORD))(*(_QWORD *)this + 672LL))(this, "IO80211ChannelBandwidth");
  }
  else
  {
    if ( v13[1] & 8 )
    {
      *(_QWORD *)v1 = "2.4 GHz";
    }
    else
    {
      *(_QWORD *)v1 = 0LL;
      if ( v13[1] & 0x10 )
        *(_QWORD *)v1 = "5 GHz";
    }
    (*(void (__fastcall **)(IO80211Interface *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)this + 640LL))(
      this,
      "IO80211Channel",
      v13[0],
      32LL);
    if ( *(_QWORD *)v1 )
      (*(void (__fastcall **)(IO80211Interface *, _QWORD, char[8]))(*(_QWORD *)this + 624LL))(
        this,
        "IO80211Band",
        *(_QWORD *)v1);
    if ( v13[1] & 4 )
    {
      v2 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 640LL);
      if ( BYTE1(v13[1]) & 2 )
      {
        v2(this, "IO80211ExtensionChannel", v13[0] + 4, 32LL);
        v3 = (__int64)",+1";
      }
      else
      {
        v2(this, "IO80211ExtensionChannel", v13[0] - 4, 32LL);
        v3 = (__int64)",-1";
      }
    }
    else
    {
      (*(void (__fastcall **)(IO80211Interface *, _QWORD))(*(_QWORD *)this + 672LL))(this, "IO80211ExtensionChannel");
      v3 = (__int64)&byte_690F5;
    }
    v4 = (__int64)",80";
    if ( !(BYTE1(v13[1]) & 4) )
      v4 = v3;
    v5 = (__int64)",160";
    if ( !(BYTE1(v13[1]) & 8) )
      v5 = v4;
    v6 = IO80211Interface::getBSDName(this, v3);
    IOLog("%s: channel changed to %d%s\n", v6, v13[0], v5, v7, v8);
    v9 = channelToFrequency(v13[0], v13[1]);
    v10 = calculateChannelBandwidth(v13[1]);
    (*(void (__fastcall **)(IO80211Interface *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)this + 640LL))(
      this,
      "IO80211ChannelFrequency",
      v9,
      32LL);
    (*(void (__fastcall **)(IO80211Interface *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)this + 640LL))(
      this,
      "IO80211ChannelBandwidth",
      v10,
      32LL);
  }
  return (*(int (__fastcall **)(IO80211Interface *, _QWORD))(*(_QWORD *)this + 1456LL))(this, 0LL);
}
// 690F5: using guessed type char byte_690F5;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000569E8) ----------------------------------------------------
__int64 __fastcall IO80211Interface::updateSSIDProperty(IO80211Interface *this)
{
  __int64 v1; // r15@1
  size_t v2; // rdx@3
  char v4; // [sp+0h] [bp-70h]@3
  size_t v5; // [sp+28h] [bp-48h]@1
  __int64 v6; // [sp+30h] [bp-40h]@1
  __int64 v7; // [sp+38h] [bp-38h]@1
  __int64 v8; // [sp+40h] [bp-30h]@1
  __int64 v9; // [sp+48h] [bp-28h]@1
  __int64 v10; // [sp+50h] [bp-20h]@1

  v1 = off_7B078[0];
  v10 = *(_QWORD *)off_7B078[0];
  v9 = 0LL;
  v8 = 0LL;
  v7 = 0LL;
  v6 = 0LL;
  v5 = 0LL;
  LODWORD(v5) = 1;
  if ( (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, size_t *))(**((_QWORD **)this + 56) + 3216LL))(
         *((_QWORD *)this + 56),
         3223873993LL,
         1LL,
         this,
         &v5) )
  {
    (*(void (__fastcall **)(IO80211Interface *, _QWORD))(*(_QWORD *)this + 672LL))(this, "IO80211SSID");
  }
  else
  {
    bzero(&v4, 0x21uLL);
    v2 = 32LL;
    if ( HIDWORD(v5) < 0x20uLL )
      v2 = HIDWORD(v5);
    memcpy(&v4, &v6, v2);
    (*(void (__fastcall **)(IO80211Interface *, _QWORD, char *))(*(_QWORD *)this + 624LL))(this, "IO80211SSID", &v4);
  }
  (*(void (__fastcall **)(IO80211Interface *, _QWORD))(*(_QWORD *)this + 1456LL))(this, 0LL);
  return *(_QWORD *)v1;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000056ADA) ----------------------------------------------------
int __fastcall IO80211Interface::updateCountryCodeProperty(IO80211Interface *this, char a2)
{
  __int64 v2; // rax@3
  char *v3; // rax@4
  __int64 v4; // r8@4
  __int64 v5; // r9@4
  __int64 v6; // rax@4
  char *v7; // rsi@5
  __int64 v8; // rdx@5
  __int64 v9; // r8@5
  __int64 v10; // r9@5
  __int64 v11; // rdx@5
  __int64 v12; // rcx@5
  __int64 v13; // r8@5
  __int64 v14; // r9@5
  unsigned int v15; // eax@5
  __int64 v16; // rbx@6
  int v18; // [sp+8h] [bp-638h]@4
  unsigned int v19; // [sp+Ch] [bp-634h]@5
  int v20[384]; // [sp+14h] [bp-62Ch]@8
  char v21; // [sp+614h] [bp-2Ch]@3
  __int64 v22; // [sp+618h] [bp-28h]@1

  v22 = 1LL;
  if ( (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, __int64 *))(**((_QWORD **)this + 56) + 3216LL))(
         *((_QWORD *)this + 56),
         3223873993LL,
         51LL,
         this,
         &v22) )
  {
    (*(void (__fastcall **)(IO80211Interface *, _QWORD))(*(_QWORD *)this + 672LL))(this, "IO80211CountryCode");
  }
  else
  {
    bzero(&v21, 4uLL);
    memcpy(&v21, (char *)&v22 + 4, 3uLL);
    LODWORD(v2) = (*(int (__fastcall **)(IO80211Interface *, _QWORD, char *))(*(_QWORD *)this + 624LL))(
                    this,
                    "IO80211CountryCode",
                    &v21);
    if ( a2 )
    {
      v3 = IO80211Interface::getBSDName(this, v2);
      IOLog("%s: 802.11d country code set to '%s'.\n", v3, &v21, v3, v4, v5);
      __bzero(&v18, 1544LL);
      v18 = 1;
      LODWORD(v6) = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, int *))(**((_QWORD **)this + 56) + 3216LL))(
                      *((_QWORD *)this + 56),
                      3223873993LL,
                      27LL,
                      this,
                      &v18);
      if ( !(_DWORD)v6 )
      {
        v7 = IO80211Interface::getBSDName(this, v6);
        IOLog("%s: Supported channels", v7, v8, v7, v9, v10);
        v15 = v19;
        if ( v19 )
        {
          v16 = 0LL;
          do
          {
            v12 = 0LL;
            if ( (_DWORD)v16 )
            {
              v11 = (unsigned int)v20[3 * v16];
              v12 = 0LL;
              v7 = (char *)v20;
              do
              {
                if ( *(_DWORD *)v7 == (_DWORD)v11 )
                  break;
                v12 = (unsigned int)(v12 + 1);
                v7 += 12;
              }
              while ( (unsigned int)v12 < (unsigned int)v16 );
            }
            if ( (_DWORD)v16 == (_DWORD)v12 )
            {
              v7 = (char *)(unsigned int)v20[3 * v16];
              IOLog(" %u", v7, v11, v12, v13, v14);
              v15 = v19;
            }
            ++v16;
          }
          while ( (unsigned int)v16 < v15 && (unsigned int)v16 < 0x80 );
        }
        IOLog("\n", v7, v11, v12, v13, v14);
      }
    }
  }
  return (*(int (__fastcall **)(IO80211Interface *, _QWORD))(*(_QWORD *)this + 1456LL))(this, 0LL);
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);
// 56ADA: using guessed type int var_62C[384];

//----- (0000000000056C9A) ----------------------------------------------------
int __fastcall IO80211Interface::setPoweredOnByUser(IO80211Interface *this, unsigned __int8 a2)
{
  int result; // eax@1

  result = *((_BYTE *)this + 344);
  if ( result != a2 )
  {
    if ( a2 )
    {
      (*(void (__fastcall **)(_QWORD, IO80211Interface *, _QWORD))(**((_QWORD **)this + 56) + 3248LL))(
        *((_QWORD *)this + 56),
        this,
        0LL);
      result = IO80211Interface::configureAntennae(this);
    }
    *((_BYTE *)this + 344) = a2;
  }
  return result;
}

//----- (0000000000056CE4) ----------------------------------------------------
int __fastcall IO80211Interface::configureAntennae(IO80211Interface *this)
{
  __int64 v1; // rax@1
  __int64 v2; // r15@2
  __int64 v3; // rax@3
  int v4; // er14@3
  __int64 v5; // rbx@4
  char *v6; // rax@9
  __int64 v7; // r8@9
  __int64 v8; // r9@9
  __int64 v9; // rax@9
  __int64 v10; // rax@9
  __int64 v11; // r8@9
  __int64 v12; // r9@9
  __int64 v13; // rax@10
  char *v14; // rax@15
  __int64 v15; // r8@15
  __int64 v16; // r9@15
  __int64 v17; // rax@15
  __int64 v18; // rax@15
  __int64 v19; // r8@15
  __int64 v20; // r9@15
  __int64 v21; // rax@16
  __int64 v22; // rbx@17
  char *v23; // rax@22
  __int64 v24; // r8@22
  __int64 v25; // r9@22
  __int64 v26; // rax@22
  __int64 v27; // rax@22
  __int64 v28; // r8@22
  __int64 v29; // r9@22
  char *v30; // rax@28
  __int64 v31; // r8@28
  __int64 v32; // r9@28
  __int64 v33; // rax@28
  __int64 v34; // rax@28
  __int64 v35; // r8@28
  __int64 v36; // r9@28
  char v38; // [sp+0h] [bp-40h]@0
  int v39; // [sp+8h] [bp-38h]@10
  int v40; // [sp+Ch] [bp-34h]@10
  int v41; // [sp+10h] [bp-30h]@10

  LODWORD(v1) = (*(int (**)(void))(**((_QWORD **)this + 56) + 1664LL))();
  if ( v1 )
  {
    LODWORD(v1) = OSMetaClassBase::safeMetaCast(v1, *(_QWORD *)off_7B010[0]);
    v2 = v1;
    if ( v1 )
    {
      LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v1 + 696LL))(v1, "antenna-rx-diversity");
      v4 = -1;
      if ( v3 )
      {
        LODWORD(v3) = OSMetaClassBase::safeMetaCast(v3, *(_QWORD *)off_7B028[0]);
        v5 = v3;
        if ( v3 )
        {
          LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v3 + 400LL))(v3, "Aux", 3LL);
          v4 = 1;
          if ( !(_BYTE)v3 )
          {
            LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v5 + 400LL))(
                            v5,
                            "Main",
                            4LL);
            LOBYTE(v3) = ~(_BYTE)v3;
            v4 = (unsigned __int8)v3 << 31 >> 31;
          }
        }
      }
      if ( this && *((_BYTE *)this + 432) & 1 )
      {
        v6 = IO80211Interface::getBSDName(this, v3);
        LODWORD(v9) = IOLog("%s: setting diversity to: %d\n", v6, (unsigned int)v4, v6, v7, v8);
        v10 = (__int64)IO80211Interface::getBSDName(this, v9);
        IO8Log("%s: setting diversity to: %d\n", v10, (unsigned int)v4, v10, v11, v12, v38);
      }
      v39 = 1;
      v40 = 1;
      v41 = v4;
      LODWORD(v13) = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, int *))(**((_QWORD **)this + 56) + 3216LL))(
                       *((_QWORD *)this + 56),
                       2150132168LL,
                       39LL,
                       this,
                       &v39);
      if ( this && (_DWORD)v13 && (_DWORD)v13 != 45 && (_DWORD)v13 != 102 && *((_BYTE *)this + 432) & 2 )
      {
        v14 = IO80211Interface::getBSDName(this, v13);
        LODWORD(v17) = IOLog(
                         "%s: Error configuring antenna diversity (index = %d).\n",
                         v14,
                         (unsigned int)v4,
                         v14,
                         v15,
                         v16);
        v18 = (__int64)IO80211Interface::getBSDName(this, v17);
        IO8Log("%s: Error configuring antenna diversity (index = %d).\n", v18, (unsigned int)v4, v18, v19, v20, v38);
      }
      LODWORD(v21) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v2 + 696LL))(v2, "antenna-tx");
      if ( v21 )
      {
        LODWORD(v21) = OSMetaClassBase::safeMetaCast(v21, *(_QWORD *)off_7B028[0]);
        v22 = v21;
        if ( v21 )
        {
          LODWORD(v21) = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v21 + 400LL))(
                           v21,
                           "Aux",
                           3LL);
          v4 = 1;
          if ( !(_BYTE)v21 )
          {
            LODWORD(v21) = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v22 + 400LL))(
                             v22,
                             "Auto",
                             4LL);
            v4 = (unsigned __int8)v21 << 31 >> 31;
          }
        }
      }
      if ( this && *((_BYTE *)this + 432) & 1 )
      {
        v23 = IO80211Interface::getBSDName(this, v21);
        LODWORD(v26) = IOLog("%s: setting tx antenna: %d\n", v23, (unsigned int)v4, v23, v24, v25);
        v27 = (__int64)IO80211Interface::getBSDName(this, v26);
        IO8Log("%s: setting tx antenna: %d\n", v27, (unsigned int)v4, v27, v28, v29, v38);
      }
      v39 = 1;
      v40 = 1;
      v41 = v4;
      LODWORD(v1) = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, int *))(**((_QWORD **)this + 56) + 3216LL))(
                      *((_QWORD *)this + 56),
                      2150132168LL,
                      37LL,
                      this,
                      &v39);
      if ( this && (_DWORD)v1 && (_DWORD)v1 != 45 && (_DWORD)v1 != 102 && *((_BYTE *)this + 432) & 2 )
      {
        v30 = IO80211Interface::getBSDName(this, v1);
        LODWORD(v33) = IOLog(
                         "%s: Error configuring transmit antenna (index = %d).\n",
                         v30,
                         (unsigned int)v4,
                         v30,
                         v31,
                         v32);
        v34 = (__int64)IO80211Interface::getBSDName(this, v33);
        LODWORD(v1) = IO8Log(
                        "%s: Error configuring transmit antenna (index = %d).\n",
                        v34,
                        (unsigned int)v4,
                        v34,
                        v35,
                        v36,
                        v38);
      }
    }
  }
  return v1;
}
// 7B010: using guessed type _QWORD off_7B010[20];
// 7B028: using guessed type _QWORD off_7B028[17];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000056FEC) ----------------------------------------------------
char __fastcall IO80211Interface::poweredOnByUser(IO80211Interface *this)
{
  return *((_BYTE *)this + 344);
}

//----- (0000000000056FF8) ----------------------------------------------------
void __fastcall IO80211Interface::setEnabledBySystem(IO80211Interface *this, char a2)
{
  *((_BYTE *)this + 345) = a2;
}

//----- (0000000000057006) ----------------------------------------------------
char __fastcall IO80211Interface::enabledBySystem(IO80211Interface *this)
{
  return *((_BYTE *)this + 345);
}

//----- (0000000000057012) ----------------------------------------------------
void __fastcall IO80211Interface::setAuthTimeout(IO80211Interface *this, __int64 a2)
{
  *((_QWORD *)this + 44) = a2;
}

//----- (0000000000057020) ----------------------------------------------------
__int64 __fastcall IO80211Interface::authTimeout(IO80211Interface *this)
{
  return *((_QWORD *)this + 44);
}

//----- (000000000005702E) ----------------------------------------------------
int __fastcall IO80211Interface::stringFromReturn(IO80211Interface *this)
{
  IO80211Interface *v1; // rax@1
  __int64 v2; // rdi@1
  int result; // eax@2

  v1 = this;
  v2 = *((_QWORD *)this + 56);
  if ( v2 )
    result = (*(int (**)(void))(*(_QWORD *)v2 + 1920LL))();
  else
    result = (*(int (__fastcall **)(IO80211Interface *))(off_7B058[0] + 1936))(v1);
  return result;
}
// 7B058: using guessed type __int64 off_7B058[11];

//----- (0000000000057060) ----------------------------------------------------
int __fastcall IO80211Interface::errnoFromReturn(IO80211Interface *this)
{
  IO80211Interface *v1; // rax@1
  __int64 v2; // rdi@1
  int result; // eax@2

  v1 = this;
  v2 = *((_QWORD *)this + 56);
  if ( v2 )
    result = (*(int (**)(void))(*(_QWORD *)v2 + 1928LL))();
  else
    result = (*(int (__fastcall **)(IO80211Interface *))(off_7B058[0] + 1944))(v1);
  return result;
}
// 7B058: using guessed type __int64 off_7B058[11];

//----- (0000000000057092) ----------------------------------------------------
char __fastcall IO80211Interface::updateLinkSpeed(IO80211Interface *this)
{
  IO80211Interface *v1; // r12@1
  __int64 v2; // r14@1
  _QWORD *v3; // rax@6
  char v4; // dl@8
  __int64 v5; // rcx@8
  __int16 v6; // si@8
  int v7; // edi@9
  signed int v8; // edi@11
  char *v9; // rcx@17
  int v10; // eax@19
  char *v11; // rax@21
  int v12; // edx@21
  char *v13; // rax@25
  bool v14; // zf@25
  signed int v16; // esi@29
  __int64 v17; // rax@29
  unsigned int v18; // edx@29
  unsigned int v19; // edi@30
  int v20; // edx@41
  char v21; // si@42
  __int64 v22; // rcx@42
  _QWORD *v23; // rdx@42
  int v24; // edx@45
  int v25; // edx@49
  __int64 v26; // rdx@51
  signed __int64 v27; // rax@54
  __int64 v28; // rax@56
  __int64 v29; // [sp+0h] [bp-110h]@1
  __int64 v30; // [sp+8h] [bp-108h]@1
  __int64 v31; // [sp+10h] [bp-100h]@1
  int v32; // [sp+18h] [bp-F8h]@1
  unsigned __int16 v33; // [sp+1Ch] [bp-F4h]@20
  char v34; // [sp+24h] [bp-ECh]@21
  __int64 v35; // [sp+D8h] [bp-38h]@1
  __int64 v36; // [sp+E0h] [bp-30h]@1
  __int64 v37; // [sp+E8h] [bp-28h]@1

  v1 = this;
  v2 = off_7B078[0];
  v37 = *(_QWORD *)off_7B078[0];
  __bzero(&v32, 188LL);
  v32 = 1;
  v36 = 0LL;
  v35 = 1LL;
  v31 = 1LL;
  v30 = 0LL;
  v29 = 1LL;
  if ( !(*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, __int64 *))(**((_QWORD **)v1 + 56) + 3216LL))(
          *((_QWORD *)v1 + 56),
          3223873993LL,
          181LL,
          v1,
          &v31)
    && !(*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, __int64 *))(**((_QWORD **)this + 56) + 3216LL))(
          *((_QWORD *)this + 56),
          3223873993LL,
          4LL,
          this,
          &v29) )
    goto LABEL_29;
  if ( (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, __int64 *))(**((_QWORD **)this + 56) + 3216LL))(
         *((_QWORD *)this + 56),
         3223873993LL,
         66LL,
         this,
         &v35)
    || (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, __int64 *))(**((_QWORD **)this + 56) + 3216LL))(
         *((_QWORD *)this + 56),
         3223873993LL,
         4LL,
         this,
         &v29)
    || !(BYTE4(v30) & 6) )
  {
    v10 = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, int *))(**((_QWORD **)this + 56) + 3216LL))(
            *((_QWORD *)this + 56),
            3223873993LL,
            32LL,
            this,
            &v32);
    v9 = 0LL;
    if ( !v10 )
    {
      if ( v33 )
      {
        v11 = &v34;
        v12 = 0;
        LODWORD(v9) = 0;
        do
        {
          if ( *(_DWORD *)v11 > (unsigned int)v9 )
            LODWORD(v9) = *(_DWORD *)v11;
          v11 += 12;
          ++v12;
        }
        while ( (unsigned __int16)v12 < (unsigned int)v33 );
      }
      v13 = (char *)(unsigned int)(1000000 * (_DWORD)v9);
      v14 = (_DWORD)v9 == 5;
      v9 = &v13[(_QWORD)qword_7A120];
      if ( !v14 )
        v9 = v13;
    }
  }
  else
  {
    v3 = &MCS_RATE_TABLE_40MHZ;
    if ( !(BYTE4(v30) & 4) )
      v3 = &L"\a\a\r\x0E\x14\x16\x1A\x1D'+4:;AAH\r\x0E\x1A\x1D'+4:NWhtu\u0082\u0082\u0090\x14\x16'+;ANWu\u0082\u009c\x1A\x1D4:NWht\u009c\u0104\u0104\u0121\uffff\uffff'+4:AH;ANWbl4:AHAHNW[e[ehtNWblblu\u0082\u0089\u0098\u0089\u0098\u009cAHNW[eNW[ehtu\u0082htu\u0082\u0082\u0090\u0082\u0090\u008f\u009fblu\u0082\u0089\u0098u\u0082\u0089\u0098\u009c\u009c";
    v4 = *(_BYTE *)(*((_QWORD *)this + 67) + 2LL) & (1 << (((unsigned __int8)(BYTE4(v30) & 4) >> 2) ^ 3));
    v5 = 0LL;
    v6 = 0;
    do
    {
      v7 = *((_BYTE *)&v35 + (signed int)v5 / 8 + 4);
      if ( _bittest((const unsigned int *)&v7, v5 & 7) )
      {
        if ( v4 )
          v8 = *((_WORD *)v3 + 2 * v5 + 1);
        else
          v8 = *((_WORD *)v3 + 2 * v5);
        if ( v8 < v6 )
          LOWORD(v8) = v6;
        v6 = v8;
      }
      ++v5;
    }
    while ( v5 != 77 );
    v9 = 0LL;
    if ( v6 > 0 )
      v9 = (char *)(1000000 * v6 & 0xFFFFFFC0);
  }
  while ( 1 )
  {
    *((_QWORD *)v1 + 46) = v9;
    if ( *(_QWORD *)v2 == v37 )
      return 1;
LABEL_29:
    v16 = 1;
    LODWORD(v17) = 0;
    v18 = 0;
    do
    {
      v19 = ((unsigned int)WORD2(v31) >> (2 * v16 - 2)) & 3;
      if ( v19 != 3 )
      {
        LODWORD(v17) = 7;
        v18 = v16;
        if ( v19 )
        {
          if ( v19 == 2 )
          {
            LODWORD(v17) = 9;
          }
          else if ( v19 == 1 )
          {
            LODWORD(v17) = 8;
          }
          else
          {
            LODWORD(v17) = 0;
          }
          v18 = v16;
        }
      }
      ++v16;
    }
    while ( v16 != 9 );
    if ( BYTE5(v30) & 4 )
    {
      v9 = 0LL;
      if ( v18 >= 2 )
      {
        v20 = v18 - 1;
        v9 = 0LL;
        if ( (unsigned int)v20 <= 2 )
        {
          v21 = *(_BYTE *)(*((_QWORD *)v1 + 67) + 5LL) >> 3;
          v22 = (unsigned int)v20;
          v23 = &VHT_MCS_RATE_TABLE_80MHZ;
          goto LABEL_51;
        }
      }
    }
    else
    {
      v9 = 0LL;
      if ( BYTE4(v30) & 4 )
      {
        if ( v18 >= 2 )
        {
          v24 = v18 - 1;
          v9 = 0LL;
          if ( (unsigned int)v24 <= 2 )
          {
            v21 = *(_BYTE *)(*((_QWORD *)v1 + 67) + 2LL) >> 2;
            v22 = (unsigned int)v24;
            v23 = &VHT_MCS_RATE_TABLE_40MHZ;
            goto LABEL_51;
          }
        }
      }
      else if ( BYTE4(v30) & 2 )
      {
        v9 = 0LL;
        if ( v18 >= 2 )
        {
          v25 = v18 - 1;
          v9 = 0LL;
          if ( (unsigned int)v25 <= 2 )
          {
            v21 = *(_BYTE *)(*((_QWORD *)v1 + 67) + 2LL) >> 3;
            v22 = (unsigned int)v25;
            v23 = &VHT_MCS_RATE_TABLE_20MHZ;
LABEL_51:
            v26 = v23[v22];
            v9 = 0LL;
            if ( v26 && (unsigned int)v17 <= 9 )
            {
              v17 = (unsigned int)v17;
              if ( v21 & 1 )
                v27 = v26 + 4 * v17 + 2;
              else
                v27 = v26 + 4 * v17;
              v28 = *(_WORD *)v27;
              v9 = 0LL;
              if ( v28 > 0 )
                v9 = (char *)(1000000 * (_DWORD)v28 & 0xFFFFFFC0);
            }
          }
        }
      }
    }
  }
}
// 7A120: using guessed type __int64 qword_7A120[98];
// 7A890: using guessed type _QWORD MCS_RATE_TABLE_40MHZ;
// 7A9D0: using guessed type _QWORD MCS_RATE_TABLE_20MHZ;
// 7B078: using guessed type __int64 off_7B078[7];
// 80400: using guessed type _QWORD VHT_MCS_RATE_TABLE_80MHZ;
// 80420: using guessed type _QWORD VHT_MCS_RATE_TABLE_40MHZ;
// 80440: using guessed type _QWORD VHT_MCS_RATE_TABLE_20MHZ;
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000057436) ----------------------------------------------------
char __fastcall IO80211Interface::setLinkState(IO80211Interface *this, int a2, int a3)
{
  int v3; // er12@1
  IO80211Interface *v4; // r15@1
  char v5; // bl@1
  __int64 v6; // rax@2
  char *v7; // rax@3
  __int64 v8; // rdx@3
  __int64 v9; // r8@3
  __int64 v10; // r9@3
  __int64 v11; // r12@3
  __int64 v12; // rax@4
  IO80211PeerManager *v13; // rdi@4
  char *v14; // rbx@7
  __int64 v15; // rax@7
  __int64 v16; // r8@7
  __int64 v17; // r9@7
  __int64 v18; // rax@7
  RSNSupplicant *v19; // rdi@7
  char *v20; // rax@10
  __int64 v21; // rdx@10
  __int64 v22; // r8@10
  __int64 v23; // r9@10
  __int64 v24; // rax@10
  __int64 v25; // rax@10
  __int64 v26; // rdx@10
  __int64 v27; // r8@10
  __int64 v28; // r9@10
  IO80211PeerManager *v29; // rdi@12
  __int64 v30; // rax@15
  __int64 v31; // rax@15
  char v33; // [sp+0h] [bp-30h]@0
  ether_addr v34; // [sp+8h] [bp-28h]@2

  v3 = a3;
  v4 = this;
  v5 = 1;
  if ( *((_DWORD *)this + 90) != a2 )
  {
    v6 = a2 == 2;
    *(_DWORD *)&v34.octet[0] = a2 == 2;
    *(_DWORD *)&v34.octet[4] = a3;
    if ( a2 != 2 )
    {
      if ( a2 != 1 )
        return 0;
      v14 = IO80211Interface::getBSDName(this, v6);
      v15 = convertIEEEReasonToString(v3);
      IOLog("AirPort: Link Down on %s. Reason %u (%s).\n", v14, (unsigned int)v3, v15, v16, v17);
      *((_BYTE *)this + 364) = 1;
      (*(void (__fastcall **)(_QWORD, signed __int64, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 56) + 2432LL))(
        *((_QWORD *)this + 56),
        1LL,
        0LL,
        0LL,
        0LL);
      LODWORD(v18) = IO80211Interface::stopOutputQueues(this);
      v19 = (RSNSupplicant *)*((_QWORD *)this + 47);
      if ( v19 )
      {
        if ( v4 && *((_BYTE *)v4 + 432) & 4 )
        {
          v20 = IO80211Interface::getBSDName(v4, v18);
          LODWORD(v24) = IOLog("%s: link down event, informing supplicant.\n", v20, v21, v20, v22, v23);
          v25 = (__int64)IO80211Interface::getBSDName(v4, v24);
          IO8Log("%s: link down event, informing supplicant.\n", v25, v26, v25, v27, v28, v33);
          v19 = (RSNSupplicant *)*((_QWORD *)v4 + 47);
        }
        RSNSupplicant::linkDown(v19);
      }
      v29 = (IO80211PeerManager *)*((_QWORD *)v4 + 41);
      if ( v29 )
        IO80211PeerManager::disable(v29, "setLinkState");
      *((_QWORD *)v4 + 46) = 0LL;
      LODWORD(v12) = (*(int (__fastcall **)(IO80211Interface *, _QWORD, _QWORD, _QWORD, _QWORD))(off_7B050[0] + 2536))(
                       v4,
                       0LL,
                       0LL,
                       0LL,
                       0LL);
      goto LABEL_15;
    }
    v7 = IO80211Interface::getBSDName(this, v6);
    v5 = 0;
    IOLog("AirPort: Link Up on %s\n", v7, v8, v7, v9, v10);
    IO80211Interface::startOutputQueues(this);
    v11 = IONetworkController::getCurrentMedium(*((IONetworkController **)this + 56));
    if ( v11 )
    {
      IO80211Interface::updateLinkSpeed(this);
      IO80211Interface::reportDataTransferRates(this);
      *((_BYTE *)this + 364) = 1;
      LODWORD(v12) = (*(int (__fastcall **)(_QWORD, signed __int64, __int64, _QWORD, _QWORD))(**((_QWORD **)this + 56)
                                                                                            + 2432LL))(
                       *((_QWORD *)this + 56),
                       3LL,
                       v11,
                       *((_QWORD *)this + 46),
                       0LL);
      v13 = (IO80211PeerManager *)*((_QWORD *)this + 41);
      if ( v13 )
        v12 = IO80211PeerManager::enable(v13, "setLinkState");
LABEL_15:
      *((_DWORD *)v4 + 90) = a2;
      LOBYTE(v30) = IO80211Interface::postMessage(v4, &v34, v12, 8LL, 4);
      LOBYTE(v31) = IO80211Interface::postMessage(v4, 0LL, v30, 0LL, 2);
      IO80211Interface::postMessage(v4, 0LL, v31, 0LL, 3);
      return 1;
    }
  }
  return v5;
}
// 7B050: using guessed type __int64 off_7B050[12];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005765C) ----------------------------------------------------
int __fastcall IO80211Interface::stopOutputQueues(IO80211Interface *this)
{
  int result; // eax@2

  if ( *((_QWORD *)this + 41) )
  {
    IONetworkInterface::stopOutputThread(this, 0);
    IONetworkInterface::flushOutputQueue(this, 0);
    result = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2504LL))(
               this,
               0LL,
               0LL,
               0LL,
               0LL);
  }
  else
  {
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 55) + 312LL))(*((_QWORD *)this + 55));
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 55) + 328LL))(*((_QWORD *)this + 55));
    result = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 55) + 336LL))(*((_QWORD *)this + 55), 0LL);
    if ( *((_BYTE *)this + 465) )
    {
      (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 59) + 312LL))(*((_QWORD *)this + 59));
      (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 59) + 328LL))(*((_QWORD *)this + 59));
      (*(void (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 59) + 336LL))(*((_QWORD *)this + 59), 0LL);
      (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 61) + 312LL))(*((_QWORD *)this + 61));
      (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 61) + 328LL))(*((_QWORD *)this + 61));
      (*(void (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 61) + 336LL))(*((_QWORD *)this + 61), 0LL);
      (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 60) + 312LL))(*((_QWORD *)this + 60));
      (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 60) + 328LL))(*((_QWORD *)this + 60));
      result = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 60) + 336LL))(*((_QWORD *)this + 60), 0LL);
    }
  }
  return result;
}

//----- (0000000000057786) ----------------------------------------------------
__int64 __fastcall IO80211Interface::debugFlags(IO80211Interface *this)
{
  return *((_QWORD *)this + 54);
}

//----- (0000000000057794) ----------------------------------------------------
int __fastcall IO80211Interface::startOutputQueues(IO80211Interface *this)
{
  IO80211Interface *v1; // rbx@1
  IO80211PeerManager *v2; // rdi@1
  void (__fastcall *v3)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // r14@2
  unsigned int v4; // eax@2
  int result; // eax@2
  int v6; // er14@2
  __int64 v7; // rax@3
  __int64 v8; // r8@3
  __int64 v9; // r9@3

  v1 = this;
  v2 = (IO80211PeerManager *)*((_QWORD *)this + 41);
  if ( v2 )
  {
    v3 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v1 + 2504LL);
    v4 = IO80211PeerManager::getBufferPoolSize(v2);
    v3(v1, v4, 1LL, 0LL, 1LL);
    result = IONetworkInterface::startOutputThread(v1, 0);
    v6 = result;
    if ( result )
    {
      LODWORD(v7) = (*(int (__fastcall **)(IO80211Interface *, _QWORD))(*(_QWORD *)v1 + 904LL))(v1, 0LL);
      result = IOLog("%s::%s (%x)\n", v7, "startOutputQueues", (unsigned int)v6, v8, v9);
    }
  }
  else
  {
    (*(void (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)v1 + 55) + 336LL))(*((_QWORD *)v1 + 55), 256LL);
    result = (*(int (**)(void))(**((_QWORD **)v1 + 55) + 304LL))();
    if ( *((_BYTE *)v1 + 465) )
    {
      (*(void (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)v1 + 59) + 336LL))(*((_QWORD *)v1 + 59), 256LL);
      (*(void (**)(void))(**((_QWORD **)v1 + 59) + 304LL))();
      (*(void (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)v1 + 61) + 336LL))(*((_QWORD *)v1 + 61), 256LL);
      (*(void (**)(void))(**((_QWORD **)v1 + 61) + 304LL))();
      (*(void (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)v1 + 60) + 336LL))(*((_QWORD *)v1 + 60), 256LL);
      result = (*(int (**)(void))(**((_QWORD **)v1 + 60) + 304LL))();
    }
  }
  return result;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000578B8) ----------------------------------------------------
__int64 __fastcall IO80211Interface::linkState(IO80211Interface *this)
{
  return *((_DWORD *)this + 90);
}

//----- (00000000000578C4) ----------------------------------------------------
int __fastcall IO80211Interface::inputEvent(IO80211Interface *this, __int64 a2, void *a3)
{
  if ( (a2 & 0xFFFFFFFE) != -16777214 )
    return (*(int (__fastcall **)(IO80211Interface *, __int64, void *))(off_7B058[0] + 2208))(this, a2, a3);
  if ( *((_BYTE *)this + 364) == 1 )
  {
    *((_BYTE *)this + 364) = 0;
    return (*(int (__fastcall **)(IO80211Interface *, __int64, void *))(off_7B058[0] + 2208))(this, a2, a3);
  }
  return 0;
}
// 7B058: using guessed type __int64 off_7B058[11];

//----- (00000000000578FA) ----------------------------------------------------
char __fastcall IO80211Interface::initSupplicant(IO80211Interface *this, unsigned __int8 *a2, unsigned int a3)
{
  unsigned int v3; // er15@1
  __int64 v4; // rax@1
  char v5; // r14@1
  __int64 v6; // rbx@2
  __int64 v7; // r8@2
  __int64 v8; // r9@2

  v3 = a3;
  LODWORD(v4) = (*(int (__fastcall **)(_QWORD, IO80211Interface *))(**((_QWORD **)this + 56) + 3256LL))(
                  *((_QWORD *)this + 56),
                  this);
  v5 = 1;
  if ( (_BYTE)v4 )
  {
    IO80211Interface::terminateSupplicant(this, v4);
    v6 = OSObject::operator new((OSObject *)&stru_108.sectname[8], (unsigned __int64)this);
    RSNSupplicant::RSNSupplicant(v6);
    *((_QWORD *)this + 47) = v6;
    if ( !v6 )
      return 0;
    if ( !RSNSupplicant::initWithInterfaceIEAndMode((RSNSupplicant *)v6, this, a2, v3, v7, v8) )
    {
      (*(void (__fastcall **)(_QWORD, IO80211Interface *))(**((_QWORD **)this + 47) + 40LL))(
        *((_QWORD *)this + 47),
        this);
      *((_QWORD *)this + 47) = 0LL;
      return 0;
    }
  }
  return v5;
}
// 108: using guessed type section_64 stru_108;

//----- (0000000000057996) ----------------------------------------------------
int __fastcall IO80211Interface::resetSupplicant(IO80211Interface *this)
{
  RSNSupplicant *v1; // rdi@1
  int result; // eax@2

  v1 = (RSNSupplicant *)*((_QWORD *)this + 47);
  if ( v1 )
    result = RSNSupplicant::reset(v1);
  return result;
}

//----- (00000000000579AE) ----------------------------------------------------
char __fastcall IO80211Interface::setPMK(IO80211Interface *this, unsigned __int8 *a2)
{
  RSNSupplicant *v2; // rdi@1
  char result; // al@2
  char savedregs; // [sp+0h] [bp+0h]@0

  v2 = (RSNSupplicant *)*((_QWORD *)this + 47);
  if ( v2 )
  {
    RSNSupplicant::setPMK(v2, a2, savedregs);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00000000000579CC) ----------------------------------------------------
bool __fastcall IO80211Interface::supplicantExchangeComplete(IO80211Interface *this)
{
  RSNSupplicant *v1; // rdi@1
  bool result; // al@2

  v1 = (RSNSupplicant *)*((_QWORD *)this + 47);
  if ( v1 )
    result = (unsigned int)RSNSupplicant::state(v1) == 2;
  else
    result = 0;
  return result;
}

//----- (00000000000579EE) ----------------------------------------------------
int __fastcall IO80211Interface::outputEAPOLFrame(IO80211Interface *this, __mbuf *a2)
{
  (*(void (**)(void))(*(_QWORD *)this + 2488LL))();
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 56) + 2136LL))(
           *((_QWORD *)this + 56),
           a2,
           this);
}

//----- (0000000000057A22) ----------------------------------------------------
bool __fastcall IO80211Interface::supplicantInitialized(IO80211Interface *this)
{
  return *((_QWORD *)this + 47) != 0LL;
}

//----- (0000000000057A34) ----------------------------------------------------
int __fastcall IO80211Interface::cachePMKSA(IO80211Interface *this, unsigned __int8 *a2, size_t a3, ether_addr *a4, unsigned __int8 *a5)
{
  ether_addr *v5; // r13@1
  size_t v6; // rbx@1
  __int64 v7; // rax@1
  __int64 v8; // r15@1
  __int64 v9; // rcx@2
  char *v10; // r14@2
  __int64 v11; // rbx@3
  int v12; // eax@4
  unsigned __int8 *v14; // [sp+0h] [bp-40h]@1
  __int64 v15; // [sp+8h] [bp-38h]@2

  v14 = a5;
  v5 = a4;
  v6 = a3;
  IO80211Interface::purgePMKSACache(this);
  LODWORD(v7) = IOMalloc(96LL);
  v8 = v7;
  if ( v7 )
  {
    bzero((void *)v7, 0x60uLL);
    memcpy((void *)(v8 + 32), a2, v6);
    *(_QWORD *)(v8 + 64) = v6;
    memcpy((void *)(v8 + 16), v14, 0x10uLL);
    io80211_get_calendar_time((__int64)&v15);
    *(_QWORD *)(v8 + 72) = v15 + 43200;
    *(_DWORD *)(v8 + 80) = 1;
    memcpy((void *)(v8 + 84), v5, 6uLL);
    v9 = *((_QWORD *)this + 52);
    v10 = (char *)this + 416;
    while ( 1 )
    {
      v11 = v9;
      if ( !v9 )
        break;
      v12 = memcmp(v5, (const void *)(v9 + 84), 6uLL);
      v9 = *(_QWORD *)v11;
      if ( !v12 )
      {
        if ( v9 )
          *(_QWORD *)(v9 + 8) = *(_QWORD *)(v11 + 8);
        **(_QWORD **)(v11 + 8) = v9;
        IOFree(v11, 96LL);
        break;
      }
    }
    v7 = *(_QWORD *)v10;
    *(_QWORD *)v8 = *(_QWORD *)v10;
    if ( v7 )
      *(_QWORD *)(v7 + 8) = v8;
    *(_QWORD *)v10 = v8;
    *(_QWORD *)(v8 + 8) = v10;
  }
  return v7;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (0000000000057B46) ----------------------------------------------------
int __fastcall IO80211Interface::purgePMKSACache(IO80211Interface *this)
{
  int result; // eax@1
  __int64 v2; // rbx@1
  __int64 v3; // r12@2
  int v4; // ST00_4@6
  unsigned __int64 v5; // [sp+10h] [bp-30h]@1

  result = io80211_get_calendar_time((__int64)&v5);
  v2 = *((_QWORD *)this + 52);
  if ( v2 )
  {
    do
    {
      result = v5;
      v3 = *(_QWORD *)v2;
      if ( v5 > *(_QWORD *)(v2 + 72) )
      {
        if ( v3 )
          *(_QWORD *)(v3 + 8) = *(_QWORD *)(v2 + 8);
        **(_QWORD **)(v2 + 8) = v3;
        if ( *((_BYTE *)this + 432) & 4 )
        {
          v4 = *(_BYTE *)(v2 + 89);
          IOLog(
            "purgePMKSACache: Freeing PMKID for %02x:%02x:%02x:%02x:%02x:%02x\n",
            *(_BYTE *)(v2 + 84),
            *(_BYTE *)(v2 + 85),
            *(_BYTE *)(v2 + 86),
            *(_BYTE *)(v2 + 87),
            *(_BYTE *)(v2 + 88));
          IO8Log(
            "purgePMKSACache: Freeing PMKID for %02x:%02x:%02x:%02x:%02x:%02x\n",
            *(_BYTE *)(v2 + 84),
            *(_BYTE *)(v2 + 85),
            *(_BYTE *)(v2 + 86),
            *(_BYTE *)(v2 + 87),
            *(_BYTE *)(v2 + 88),
            *(_BYTE *)(v2 + 89));
        }
        result = IOFree(v2, 96LL);
      }
      v2 = v3;
    }
    while ( v3 );
  }
  return result;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000057C18) ----------------------------------------------------
__int64 __fastcall IO80211Interface::cachePMKSA(IO80211Interface *this, unsigned __int8 *a2, __int64 a3, ether_addr *a4)
{
  ether_addr *v4; // rbx@1
  __int64 v5; // r13@1
  __int64 result; // rax@1
  int v7; // ecx@2
  unsigned __int8 *v8; // r8@2
  int v9; // ST00_4@5
  __int64 v10; // rcx@7
  unsigned __int8 v11; // [sp+8h] [bp-48h]@2
  unsigned __int8 v12; // [sp+10h] [bp-40h]@3
  __int64 v13; // [sp+20h] [bp-30h]@1

  v4 = a4;
  v5 = off_7B078[0];
  v13 = *(_QWORD *)off_7B078[0];
  result = 22LL;
  if ( a3 == 32 )
  {
    v7 = (*(int (__fastcall **)(_QWORD, unsigned __int8 *))(**((_QWORD **)this + 56) + 2848LL))(
           *((_QWORD *)this + 56),
           &v11);
    result = 6LL;
    if ( !v7 )
    {
      RSNSupplicant::rsnPMKID((RSNSupplicant *)a2, v4->octet, &v11, &v12, v8);
      if ( this && *((_BYTE *)this + 432) & 4 )
      {
        v9 = v4->octet[5];
        IOLog(
          "IO80211Interface::cachePMKSA: Caching PMKID for %02x:%02x:%02x:%02x:%02x:%02x\n",
          v4->octet[0],
          v4->octet[1],
          v4->octet[2],
          v4->octet[3],
          v4->octet[4]);
        IO8Log(
          "IO80211Interface::cachePMKSA: Caching PMKID for %02x:%02x:%02x:%02x:%02x:%02x\n",
          v4->octet[0],
          v4->octet[1],
          v4->octet[2],
          v4->octet[3],
          v4->octet[4],
          v4->octet[5]);
      }
      IO80211Interface::cachePMKSA(this, a2, 0x20uLL, v4, &v12);
      result = 0LL;
    }
  }
  v10 = *(_QWORD *)v5;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000057D20) ----------------------------------------------------
__int64 __fastcall IO80211Interface::pmksaLookup(IO80211Interface *this, ether_addr *a2, unsigned __int8 *a3)
{
  unsigned __int8 *v3; // r14@1
  int v4; // ST00_4@4
  __int64 v5; // r12@5
  __int64 v6; // rbx@7

  v3 = a3;
  IO80211Interface::purgePMKSACache(this);
  if ( a2 && this && *((_BYTE *)this + 432) & 4 )
  {
    v4 = a2->octet[5];
    IOLog(
      "IO80211Interface::pmksaLookup: Looking up PMKSA for %02x:%02x:%02x:%02x:%02x:%02x.\n",
      a2->octet[0],
      a2->octet[1],
      a2->octet[2],
      a2->octet[3],
      a2->octet[4]);
    IO8Log(
      "IO80211Interface::pmksaLookup: Looking up PMKSA for %02x:%02x:%02x:%02x:%02x:%02x.\n",
      a2->octet[0],
      a2->octet[1],
      a2->octet[2],
      a2->octet[3],
      a2->octet[4],
      a2->octet[5]);
  }
  v5 = 0LL;
  if ( a2 || v3 )
  {
    v6 = *((_QWORD *)this + 52);
    v5 = 0LL;
    if ( v6 )
    {
      v5 = 0LL;
      while ( a2 && memcmp((const void *)(v6 + 84), a2, 6uLL) || v3 && memcmp((const void *)(v6 + 16), v3, 0x10uLL) )
      {
        v6 = *(_QWORD *)v6;
        if ( !v6 )
          return v5;
      }
      v5 = v6;
    }
  }
  return v5;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000057E20) ----------------------------------------------------
int __fastcall IO80211Interface::getPMKSAList(__int64 a1, __int64 a2)
{
  int result; // eax@1
  __int64 v3; // rbx@1
  signed __int64 v4; // rax@3
  int v5; // [sp+8h] [bp-28h]@1

  IO80211Interface::purgePMKSACache((IO80211Interface *)a1);
  result = io80211_get_calendar_time((__int64)&v5);
  *(_DWORD *)(a2 + 4) = 0;
  v3 = *(_QWORD *)(a1 + 416);
  if ( v3 )
  {
    result = 0;
    do
    {
      v4 = 16LL * (unsigned int)result;
      *(_DWORD *)(a2 + v4 + 8) = v5 + 43200 - *(_DWORD *)(v3 + 72);
      *(_DWORD *)(a2 + v4 + 12) = *(_DWORD *)(v3 + 80);
      memcpy((void *)(a2 + v4 + 16), (const void *)(v3 + 84), 6uLL);
      result = *(_DWORD *)(a2 + 4) + 1;
      *(_DWORD *)(a2 + 4) = result;
      if ( result == 128 )
        break;
      v3 = *(_QWORD *)v3;
    }
    while ( v3 );
  }
  return result;
}

//----- (0000000000057EB0) ----------------------------------------------------
signed __int64 __fastcall IO80211Interface::getExtendedStats(__int64 a1, __int64 a2)
{
  signed int v2; // er14@1
  __int64 v3; // rdi@3
  signed __int64 result; // rax@4

  v2 = 0;
  if ( (unsigned int)*(_WORD *)(a2 + 26) > 3
    || (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, __int64, __int64))(**(_QWORD **)(a1 + 448) + 3216LL))(
         *(_QWORD *)(a1 + 448),
         3223873993LL,
         165LL,
         a1,
         a2)
    || (v3 = *(_QWORD *)(a1 + 328), v2 = 1, !v3) )
    result = (unsigned int)v2;
  else
    result = IO80211PeerManager::getExtendedStats(v3, a2);
  return result;
}

//----- (0000000000057F22) ----------------------------------------------------
char __fastcall IO80211Interface::shouldRoam(__int64 a1, __int64 a2)
{
  char result; // al@2
  signed int v3; // edx@4
  __int64 v4; // rdi@5
  __int64 v5; // [sp+0h] [bp-20h]@1
  unsigned int v6; // [sp+8h] [bp-18h]@1

  v6 = 0;
  v5 = 1LL;
  if ( (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, __int64, __int64 *))(**(_QWORD **)(a1 + 448)
                                                                                         + 3216LL))(
         *(_QWORD *)(a1 + 448),
         3223873993LL,
         2LL,
         a1,
         &v5) )
  {
    result = 0;
  }
  else
  {
    result = 1;
    if ( v6 <= 8 )
    {
      v3 = 278;
      if ( _bittest((const unsigned int *)&v3, v6) )
      {
        v4 = *(_QWORD *)(a1 + 376);
        if ( v4 )
          result = RSNSupplicant::shouldRoam(v4, a2);
      }
    }
  }
  return result;
}

//----- (0000000000057FA2) ----------------------------------------------------
__int64 __fastcall IO80211Interface::willRoam(IO80211Interface *this, ether_addr *a2, char a3)
{
  char v3; // r15@1
  __int64 v4; // r13@1
  __int64 v5; // r14@5
  __int64 v6; // rax@5
  __int64 v7; // rdx@5
  __int64 v8; // rcx@5
  __int64 v9; // r8@5
  __int64 v10; // r9@5
  __int64 v11; // rdx@10
  __int64 v12; // rcx@10
  __int64 v13; // r8@10
  __int64 v14; // r9@10
  __int64 v15; // rax@11
  __int64 v16; // rdx@12
  char *v17; // rcx@12
  __int64 v18; // r8@12
  __int64 v19; // r9@12
  const char *v20; // rbx@12
  __int64 v21; // rax@14
  char *v22; // rax@17
  __int64 v23; // rdx@17
  __int64 v24; // r8@17
  __int64 v25; // r9@17
  __int64 v26; // rax@17
  __int64 v27; // rax@17
  __int64 v28; // rdx@17
  __int64 v29; // r8@17
  __int64 v30; // r9@17
  __int64 v31; // rax@21
  __int64 v32; // rax@21
  __int64 v33; // rdx@21
  __int64 v34; // r8@21
  __int64 v35; // r9@21
  char v37; // [sp+0h] [bp-160h]@0
  __int64 v38; // [sp+8h] [bp-158h]@26
  __int64 v39; // [sp+18h] [bp-148h]@1
  int v40; // [sp+20h] [bp-140h]@1
  int v41; // [sp+28h] [bp-138h]@5
  __int16 v42; // [sp+2Ch] [bp-134h]@23
  unsigned __int8 v43; // [sp+2Eh] [bp-132h]@24
  unsigned __int8 v44; // [sp+2Fh] [bp-131h]@11
  char v45; // [sp+44h] [bp-11Ch]@11
  char v46; // [sp+45h] [bp-11Bh]@11
  char v47; // [sp+46h] [bp-11Ah]@11
  __int64 v48; // [sp+130h] [bp-30h]@1

  v3 = a3;
  v4 = off_7B078[0];
  v48 = *(_QWORD *)off_7B078[0];
  v40 = 0;
  v39 = 1LL;
  if ( !*((_QWORD *)this + 47)
    || (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, __int64 *))(**((_QWORD **)this + 56) + 3216LL))(
         *((_QWORD *)this + 56),
         3223873993LL,
         2LL,
         this,
         &v39) )
    return *(_QWORD *)v4;
  if ( (unsigned int)(v40 - 1) < 2 )
  {
LABEL_14:
    v21 = RSNSupplicant::state(*((RSNSupplicant **)this + 47));
    if ( !(_DWORD)v21 )
    {
LABEL_26:
      io80211_get_calendar_time((__int64)&v38);
      *((_QWORD *)this + 44) = v38 + 15;
      return *(_QWORD *)v4;
    }
    if ( this && *((_BYTE *)this + 432) & 4 )
    {
      v22 = IO80211Interface::getBSDName(this, v21);
      LODWORD(v26) = IOLog("%s: roam event, sending supplicant link down message.\n", v22, v23, v22, v24, v25);
      v27 = (__int64)IO80211Interface::getBSDName(this, v26);
      IO8Log("%s: roam event, sending supplicant link down message.\n", v27, v28, v27, v29, v30, v37);
    }
LABEL_25:
    RSNSupplicant::linkDown(*((RSNSupplicant **)this + 47));
    goto LABEL_26;
  }
  if ( v40 != 4 )
  {
    if ( v40 != 8 )
      return *(_QWORD *)v4;
    goto LABEL_14;
  }
  v5 = IO80211Interface::pmksaLookup(this, a2, 0LL);
  __bzero(&v41, 264LL);
  v41 = 1;
  LODWORD(v6) = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, int *))(**((_QWORD **)this + 56) + 3216LL))(
                  *((_QWORD *)this + 56),
                  3223873993LL,
                  46LL,
                  this,
                  &v41);
  if ( !(_DWORD)v6 )
  {
    if ( v3 & 1 )
    {
LABEL_24:
      RSNSupplicant::updateIE(*((RSNSupplicant **)this + 47), &v43);
      goto LABEL_25;
    }
    if ( v5 )
    {
      if ( !this )
      {
        v45 = 1;
        v46 = 0;
        memcpy(&v47, (const void *)(v5 + 16), 0x10uLL);
        v44 = 38;
        goto LABEL_23;
      }
      if ( *((_BYTE *)this + 432) & 4 )
      {
        IOLog("appending pmkid", 3223873993LL, v7, v8, v9, v10);
        IO8Log("appending pmkid", 3223873993LL, v11, v12, v13, v14, v37);
      }
      v45 = 1;
      v46 = 0;
      v15 = (__int64)memcpy(&v47, (const void *)(v5 + 16), 0x10uLL);
      v44 = 38;
      if ( !(*((_BYTE *)this + 432) & 4) )
        goto LABEL_23;
      v17 = IO80211Interface::getBSDName(this, v15);
      v20 = "%s: roam event, pmksa found.\n";
    }
    else
    {
      v44 = 20;
      if ( !this || !(*((_BYTE *)this + 432) & 4) )
        goto LABEL_23;
      v17 = IO80211Interface::getBSDName(this, v6);
      v20 = "%s: roam event, no pmksa found.\n";
    }
    LODWORD(v31) = IOLog(v20, v17, v16, v17, v18, v19);
    v32 = (__int64)IO80211Interface::getBSDName(this, v31);
    IO8Log(v20, v32, v33, v32, v34, v35, v37);
LABEL_23:
    v42 = v44 + 2;
    (*(void (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, int *))(**((_QWORD **)this + 56)
                                                                                              + 3216LL))(
      *((_QWORD *)this + 56),
      2150132168LL,
      46LL,
      this,
      &v41);
    goto LABEL_24;
  }
  return *(_QWORD *)v4;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (00000000000582B2) ----------------------------------------------------
int __fastcall IO80211Interface::awsRespond(IO80211Interface *this, __int64 a2, unsigned int *a3, __int64 a4, __int16 a5)
{
  __int16 v5; // r14@1
  __int64 v6; // r12@1
  unsigned int *v7; // r13@1
  __mbuf *v8; // rax@1
  __int16 v9; // ST1C_2@4
  __mbuf *v10; // r14@4
  __int64 v11; // rax@4
  __int64 v12; // rbx@4
  __int64 v13; // rax@4
  __int16 v14; // ax@4
  void *v15; // rdx@4
  signed __int64 v16; // rbx@5
  unsigned int v17; // eax@6
  unsigned __int32 v18; // eax@6
  unsigned int v19; // eax@11
  __int64 v20; // rax@35
  __int64 v21; // r8@35
  __int64 v22; // r9@35
  char *v23; // rax@38
  char *v24; // rcx@38
  __int64 v25; // rdx@38
  __int64 v26; // rax@38
  __mbuf *v28; // [sp+0h] [bp-F0h]@4
  signed __int64 v29; // [sp+20h] [bp-D0h]@3
  int v30; // [sp+28h] [bp-C8h]@17
  int v31; // [sp+30h] [bp-C0h]@18
  int v32; // [sp+40h] [bp-B0h]@21
  unsigned int v33; // [sp+4Ch] [bp-A4h]@22
  int v34; // [sp+78h] [bp-78h]@13
  int v35; // [sp+7Ch] [bp-74h]@14
  unsigned int v36; // [sp+84h] [bp-6Ch]@15
  unsigned int v37; // [sp+94h] [bp-5Ch]@26
  int v38; // [sp+B0h] [bp-40h]@4
  unsigned int v39; // [sp+B4h] [bp-3Ch]@30
  unsigned int v40; // [sp+B8h] [bp-38h]@28
  unsigned int v41; // [sp+BCh] [bp-34h]@25
  unsigned int v42; // [sp+C0h] [bp-30h]@11

  v5 = a5;
  v6 = a4;
  v7 = a3;
  LODWORD(v8) = *((_BYTE *)this + 464);
  if ( (_DWORD)v8 == 6 )
  {
    if ( *((_QWORD *)this + 57) )
    {
      v29 = 8 * a4 + 26;
      LODWORD(v8) = (*(int (**)(void))(**((_QWORD **)this + 56) + 2344LL))();
      if ( v8 )
      {
        v9 = v5;
        v10 = v8;
        v28 = v8;
        mbuf_setlen(v8, v29);
        mbuf_setflags_mask(v10, 2LL, 2LL);
        mbuf_pkthdr_setlen(v10, v29);
        LODWORD(v11) = mbuf_data(v10);
        v12 = v11;
        LODWORD(v13) = mbuf_data(a2);
        memcpy((void *)v12, (const void *)(v13 + 6), 6uLL);
        memcpy((void *)(v12 + 6), *((const void **)this + 57), 6uLL);
        v14 = __ROL2__(8 * v6 + 12, 8);
        *(_WORD *)(v12 + 12) = v14;
        memcpy((void *)(v12 + 14), &AWS_SNAP_HEADER, 8uLL);
        *(_BYTE *)(v12 + 22) = 0;
        *(_BYTE *)(v12 + 23) = 1;
        *(_WORD *)(v12 + 24) = v9;
        bzero(&v38, 0x14uLL);
        v38 = 1;
        (*(void (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, int *))(**((_QWORD **)this + 56)
                                                                                                  + 3216LL))(
          *((_QWORD *)this + 56),
          3223873993LL,
          49LL,
          this,
          &v38);
        if ( v6 )
        {
          v16 = v12 + 30;
          while ( 1 )
          {
            --v6;
            v17 = *v7;
            *(_DWORD *)(v16 - 4) = *v7;
            v18 = _byteswap_ulong(v17);
            if ( (signed int)v18 > 1920168808 )
            {
              if ( v18 != 1920168809
                || (v34 = 1,
                    (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, int *))(**((_QWORD **)this + 56) + 3216LL))(
                      *((_QWORD *)this + 56),
                      3223873993LL,
                      16LL,
                      this,
                      &v34)) )
              {
LABEL_32:
                *(_DWORD *)v16 = 0;
                goto LABEL_33;
              }
              if ( v35 == 1 )
                v19 = v36;
              else
                v19 = v37;
              goto LABEL_31;
            }
            if ( (signed int)v18 <= 1918989412 )
              break;
            if ( v18 != 1918989413 )
              goto LABEL_32;
            v30 = 1;
            if ( (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, int *))(**((_QWORD **)this + 56) + 3216LL))(
                   *((_QWORD *)this + 56),
                   3223873993LL,
                   8LL,
                   this,
                   &v30) )
              goto LABEL_32;
            if ( v31 != 5 )
            {
              v19 = 2 * v31;
LABEL_31:
              *(_DWORD *)v16 = _byteswap_ulong(v19);
              goto LABEL_33;
            }
            *(_DWORD *)v16 = 184549376;
LABEL_33:
            ++v7;
            v16 += 8LL;
            if ( !v6 )
              goto LABEL_34;
          }
          if ( (signed int)v18 > 1852795250 )
          {
            if ( v18 != 1852795251 )
              goto LABEL_32;
            v32 = 1;
            if ( (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211Interface *, int *))(**((_QWORD **)this + 56) + 3216LL))(
                   *((_QWORD *)this + 56),
                   3223873993LL,
                   17LL,
                   this,
                   &v32) )
              goto LABEL_32;
            v19 = v33;
          }
          else if ( (signed int)v18 > 1701999735 )
          {
            if ( v18 == 1701999736 )
            {
              v19 = v40;
            }
            else if ( v18 == 1852666488 )
            {
              v19 = v41;
            }
            else
            {
              if ( v18 != 1852667000 )
                goto LABEL_32;
              v19 = v39;
            }
          }
          else
          {
            if ( v18 != 1701999224 )
              goto LABEL_32;
            v19 = v42;
          }
          goto LABEL_31;
        }
LABEL_34:
        if ( *((_QWORD *)this + 41) )
        {
          LODWORD(v20) = (*(int (__fastcall **)(IO80211Interface *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
          IOLog("%s::%s %p\n", v20, "awsRespond", *((_QWORD *)this + 41), v21, v22);
          (*(void (__fastcall **)(_QWORD, __mbuf *))(**((_QWORD **)this + 41) + 464LL))(*((_QWORD *)this + 41), v28);
          LODWORD(v8) = IO80211PeerManager::requestTxPacket(*((IO80211PeerManager **)this + 41), "awsRespond");
        }
        else if ( *((_BYTE *)this + 465) )
        {
          LODWORD(v8) = IO80211Interface::queueWMEPacket(this, v28, v15);
        }
        else
        {
          LODWORD(v23) = (*(int (**)(void))(**((_QWORD **)this + 55) + 368LL))();
          v24 = v23;
          v26 = *((_QWORD *)this + 55) + v25;
          if ( (unsigned __int8)v24 & 1 )
            v24 = *(char **)&v24[*(_QWORD *)v26 - 1];
          LODWORD(v8) = ((int (__fastcall *)(__int64, __mbuf *, _QWORD))v24)(v26, v28, 0LL);
        }
      }
    }
  }
  return (signed int)v8;
}
// 7AB64: using guessed type _QWORD AWS_SNAP_HEADER;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C80: using guessed type int __fastcall mbuf_pkthdr_setlen(_QWORD, _QWORD);
// C8CA8: using guessed type int __fastcall mbuf_setflags_mask(_QWORD, _QWORD, _QWORD);
// C8CB0: using guessed type int __fastcall mbuf_setlen(_QWORD, _QWORD);

//----- (0000000000058668) ----------------------------------------------------
int __fastcall IO80211Interface::queueWMEPacket(IO80211Interface *this, __mbuf *a2, void *a3)
{
  IO80211Interface *v3; // rax@1
  __int64 v4; // rdi@1
  int result; // eax@3

  v3 = this;
  v4 = *((_QWORD *)this + 41);
  if ( v4 )
  {
    if ( *((_DWORD *)v3 + 90) == 2 )
    {
      result = (*(int (__fastcall **)(__int64, __mbuf *, void *))(*(_QWORD *)v4 + 464LL))(v4, a2, a3);
    }
    else
    {
      mbuf_freem(a2);
      result = 0;
    }
  }
  else
  {
    result = IO80211InterfaceQueueWMEPacket(v3, a2);
  }
  return result;
}
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);

//----- (00000000000586A6) ----------------------------------------------------
int __fastcall IO80211Interface::inputAWSPacket(IO80211Interface *this, __mbuf *a2)
{
  __int64 v2; // rax@1
  __int64 v3; // r15@1
  signed __int64 v4; // rax@1
  __int64 v5; // rax@3
  __int64 v6; // r12@3
  unsigned __int64 v7; // r15@7
  __int64 v8; // rcx@7

  LODWORD(v2) = mbuf_len(a2);
  v3 = v2;
  v4 = v2 - 14;
  if ( (unsigned __int64)v4 >= 0x10 )
  {
    LODWORD(v4) = mbuf_len(a2);
    if ( (unsigned __int64)v4 >= 0xE )
    {
      LODWORD(v5) = mbuf_data(a2);
      v6 = v5;
      LODWORD(v4) = memcmp((const void *)(v5 + 14), &AWS_SNAP_HEADER, 8uLL);
      if ( !(_DWORD)v4 && !*(_BYTE *)(v6 + 22) && !*(_BYTE *)(v6 + 23) )
      {
        v7 = (unsigned __int64)(v3 - 26) >> 2;
        v8 = 7LL;
        if ( v7 <= 7 )
          v8 = v7;
        LODWORD(v4) = IO80211Interface::awsRespond(
                        this,
                        (__int64)a2,
                        (unsigned int *)(v6 + 26),
                        v8,
                        *(_WORD *)(v6 + 24));
      }
    }
  }
  return v4;
}
// 7AB64: using guessed type _QWORD AWS_SNAP_HEADER;
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);

//----- (000000000005874C) ----------------------------------------------------
__int64 __fastcall IO80211Interface::inputPacket(IO80211Interface *this, __mbuf *a2, unsigned int a3, __int64 a4, void *a5)
{
  unsigned int v5; // er14@1
  __mbuf *v6; // rax@1
  IO80211Interface *v7; // r12@1
  __int64 v8; // rdi@1
  char v9; // r15@1
  unsigned int v10; // ebx@2
  __int64 v11; // rax@4
  __int64 v12; // rax@4
  char *v13; // rbx@7
  __int64 v14; // rax@7
  __int64 v15; // r8@7
  __int64 v16; // r9@7
  __int64 v17; // rax@7
  __int64 v18; // rbx@7
  __int64 v19; // rax@7
  __int64 v20; // r8@7
  __int64 v21; // r9@7
  __int64 v22; // rax@8
  __int64 v23; // rax@10
  unsigned __int16 v24; // cx@10
  __int64 v25; // rax@12
  __int64 v26; // rax@15
  unsigned __int64 v27; // rax@18
  unsigned __int64 v28; // rax@19
  __int64 v29; // rax@24
  __int64 v30; // r14@27
  __int64 v31; // rax@27
  __int64 v32; // ST20_8@27
  int v33; // er13@27
  int v34; // er15@27
  __int16 v35; // ST10_2@27
  __int64 v36; // r14@29
  __int64 v37; // rax@29
  __int64 v38; // ST20_8@29
  int v39; // er13@29
  int v40; // ebx@29
  __int16 v41; // ST10_2@29
  char v43; // [sp+0h] [bp-60h]@0
  __mbuf *v44; // [sp+30h] [bp-30h]@1

  v5 = a3;
  v6 = a2;
  v7 = this;
  v44 = a2;
  v8 = *((_QWORD *)this + 41);
  v9 = 1;
  if ( !v8
    || (v10 = 0,
        a2 = (__mbuf *)&v44,
        v9 = (*(int (__fastcall **)(__int64, __mbuf **, _QWORD, __int64, void *))(*(_QWORD *)v8 + 384LL))(
               v8,
               &v44,
               0LL,
               a4,
               a5),
        (v6 = v44) != 0LL) )
  {
    if ( *((_QWORD *)v7 + 47) )
    {
      LODWORD(v11) = mbuf_data(v6);
      v12 = *(_WORD *)(v11 + 12);
      if ( (_DWORD)v12 == 36488 )
      {
        if ( v7 && *((_BYTE *)v7 + 432) & 4 )
        {
          v13 = IO80211Interface::getBSDName(v7, v12);
          LODWORD(v14) = mbuf_len(v44);
          LODWORD(v17) = IOLog("%s: Received EAPOL packet (length = %d)\n", v13, (unsigned int)v14, v14, v15, v16);
          v18 = (__int64)IO80211Interface::getBSDName(v7, v17);
          LODWORD(v19) = mbuf_len(v44);
          IO8Log("%s: Received EAPOL packet (length = %d)\n", v18, (unsigned int)v19, v19, v20, v21, v43);
        }
        a2 = v44;
        LOBYTE(v22) = RSNSupplicant::inputEAPOLFrame(*((RSNSupplicant **)v7 + 47), v44, v43);
        goto LABEL_14;
      }
      v6 = v44;
    }
    LODWORD(v23) = mbuf_data(v6);
    v24 = __ROL2__(*(_WORD *)(v23 + 12), 8);
    if ( v24 <= 0x5DCu )
    {
      a2 = v44;
      LODWORD(v22) = IO80211Interface::inputAWSPacket(v7, v44);
      goto LABEL_14;
    }
    LODWORD(v25) = mbuf_data(v44);
    v22 = *(_WORD *)(v25 + 12);
    if ( (_DWORD)v22 != 3465 )
    {
LABEL_14:
      if ( v9 )
      {
        v26 = (__int64)IO80211Interface::getBSDName(v7, v22);
        if ( v26 )
          IO80211Interface::getBSDName(v7, v26);
        if ( mbuf_flags(v44, a2) & 2 )
        {
          LODWORD(v27) = mbuf_len(v44);
          if ( v27 <= 0x1000 )
          {
            LODWORD(v28) = mbuf_len(v44);
            if ( v28 >= 0x12 && v5 <= 0x1000 && v5 >= 0x12 && mbuf_type(v44) != 2 )
            {
              if ( !(mbuf_flags(v44, a2) & 1) || (LODWORD(v29) = mbuf_datastart(v44), v29) )
                return (*(int (__fastcall **)(IO80211Interface *, __mbuf *, _QWORD, _QWORD, _QWORD))(off_7B058[0] + 2184))(
                         v7,
                         v44,
                         v5,
                         0LL,
                         0LL);
            }
          }
        }
        if ( *((_BYTE *)v7 + 436) & 0x40 )
        {
          v30 = (__int64)v44;
          LODWORD(v31) = mbuf_len(v44);
          v32 = v31;
          v33 = mbuf_type(v44);
          v34 = mbuf_flags(v44, a2);
          mbuf_datastart(v44);
          v35 = (*(int (__fastcall **)(IO80211Interface *))(*(_QWORD *)v7 + 2232LL))(v7);
          a2 = (__mbuf *)"IO80211 WARNING: Failed mbuf validity check: mbuf %p len %ldtype %d flags 0x%x data %p rcvif %s ifflags 0x%x\n";
          IO80211Interface::logDebug(
            v7,
            "IO80211 WARNING: Failed mbuf validity check: mbuf %p len %ldtype %d flags 0x%x data %p rcvif %s ifflags 0x%x\n",
            v30,
            v32,
            (unsigned int)v33,
            (unsigned int)v34);
        }
        if ( *((_QWORD *)v7 + 54) & 0x4000000000LL )
        {
          v36 = (__int64)v44;
          LODWORD(v37) = mbuf_len(v44);
          v38 = v37;
          v39 = mbuf_type(v44);
          v40 = mbuf_flags(v44, a2);
          mbuf_datastart(v44);
          v41 = (*(int (__fastcall **)(IO80211Interface *))(*(_QWORD *)v7 + 2232LL))(v7);
          IO80211Interface::logDebug(
            v7,
            "WARNING: Dropping invalid mbuf %p len %ld type %d flags 0x%x data %p rcvif %s ifflags 0x%x\n",
            v36,
            v38,
            (unsigned int)v39,
            (unsigned int)v40);
        }
      }
      mbuf_freem(v44);
      return 0;
    }
    IO80211Controller::handle11zPacket(*((IO80211Controller **)v7 + 56), v44);
    v10 = 0;
  }
  return v10;
}
// 7B058: using guessed type __int64 off_7B058[11];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C00: using guessed type int __fastcall mbuf_datastart(_QWORD);
// C8C10: using guessed type int __fastcall mbuf_flags(_QWORD, _QWORD);
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8CC8: using guessed type int __fastcall mbuf_type(_QWORD);

//----- (0000000000058A6C) ----------------------------------------------------
bool __fastcall IO80211Interface::shouldLog(IO80211Interface *this, __int64 a2)
{
  bool result; // al@1

  result = 1;
  if ( a2 )
    result = (a2 & *((_QWORD *)this + 54)) != 0;
  return result;
}

//----- (0000000000058A84) ----------------------------------------------------
__int64 __fastcall IO80211Interface::logDebug(IO80211Interface *this, const char *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // r15@1
  char v8; // [sp+0h] [bp-70h]@1
  __int64 v9; // [sp+10h] [bp-60h]@1
  __int64 v10; // [sp+18h] [bp-58h]@1
  __int64 v11; // [sp+20h] [bp-50h]@1
  __int64 v12; // [sp+28h] [bp-48h]@1
  int v13; // [sp+30h] [bp-40h]@1
  int v14; // [sp+34h] [bp-3Ch]@1
  char *v15; // [sp+38h] [bp-38h]@1
  char *v16; // [sp+40h] [bp-30h]@1
  __int64 v17; // [sp+50h] [bp-20h]@1
  char v18; // [sp+80h] [bp+10h]@0

  v12 = a6;
  v11 = a5;
  v10 = a4;
  v9 = a3;
  v6 = off_7B078[0];
  v17 = *(_QWORD *)off_7B078[0];
  v16 = &v8;
  v15 = &v18;
  v14 = 48;
  v13 = 16;
  IO8Logv(a2, (struct __va_list_tag *)&v13);
  IOLogv(a2);
  return *(_QWORD *)v6;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C7730: using guessed type int __fastcall IOLogv(_QWORD);

//----- (0000000000058B04) ----------------------------------------------------
int __fastcall IO80211Interface::outputPacket(IO80211Interface *this, __mbuf *a2, void *a3)
{
  if ( !*((_BYTE *)this + 465) )
    mbuf_pkthdr_setrcvif(a2, 0LL, a3);
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 56) + 2136LL))(
           *((_QWORD *)this + 56),
           a2,
           this);
}
// C8C88: using guessed type int __fastcall mbuf_pkthdr_setrcvif(_QWORD, _QWORD, _QWORD);

//----- (0000000000058B42) ----------------------------------------------------
int __fastcall IO80211Interface::setLinkQualityMetric(IO80211Interface *this, unsigned int a2)
{
  __int64 v2; // rax@1
  int result; // eax@3

  LODWORD(v2) = (*(int (__cdecl **)(IO80211Interface *))(*(_QWORD *)this + 2408LL))(this);
  if ( v2 && a2 + 2 <= 0x66 )
    result = ifnet_set_link_quality(v2, a2);
  else
    result = 22;
  return result;
}
// C8B80: using guessed type int __fastcall ifnet_set_link_quality(_QWORD, _QWORD);

//----- (0000000000058B7C) ----------------------------------------------------
void __usercall IO80211Interface::stopCountermeasures(__int64 a1@<rax>, __int64 a2@<rdi>)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1
  __int64 v4; // rdx@2
  __int64 v5; // rcx@2
  __int64 v6; // r8@2
  __int64 v7; // r9@2
  __int64 v8; // rdx@5
  __int64 v9; // rcx@5
  __int64 v10; // r8@5
  __int64 v11; // r9@5
  __int64 v12; // [sp+0h] [bp-10h]@1

  v12 = a1;
  v2 = a2;
  v3 = *(_QWORD *)(a2 + 448);
  if ( v3 )
  {
    v12 = 1LL;
    if ( (*(int (__fastcall **)(__int64, signed __int64, signed __int64, __int64, __int64 *))(*(_QWORD *)v3 + 3216LL))(
           v3,
           2150132168LL,
           30LL,
           v2,
           &v12) )
    {
      if ( v2 )
      {
        if ( *(_BYTE *)(v2 + 432) & 2 )
        {
          IOLog("setCounterMeasures: Error clearing TKIP countermeasures!\n", 2150132168LL, v4, v5, v6, v7);
          IO8Log("setCounterMeasures: Error clearing TKIP countermeasures!\n", 2150132168LL, v8, v9, v10, v11, v12);
        }
      }
    }
    else
    {
      IO80211Interface::setCountermeasuresTimer(v2, 0LL);
    }
  }
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000058BF4) ----------------------------------------------------
__int64 __fastcall IO80211Interface::getOutputQueue(IO80211Interface *this)
{
  return *((_QWORD *)this + 55);
}

//----- (0000000000058C02) ----------------------------------------------------
__int64 __fastcall IO80211Interface::performCountryCodeOpGated(IO80211Interface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  int v6; // eax@1
  signed int v7; // ecx@1

  v6 = (*(int (__fastcall **)(IO80211Interface *, OSObject *, _QWORD, void *, void *, void *))(*(_QWORD *)this + 3248LL))(
         this,
         a2,
         *(_DWORD *)a3,
         a4,
         a5,
         a6);
  v7 = -536870212;
  if ( !v6 )
    v7 = 0;
  return (unsigned int)v7;
}

//----- (0000000000058C20) ----------------------------------------------------
void __fastcall IO80211Interface::setPeerManagerLogFlag(IO80211Interface *this, int a2, char a3)
{
  int v3; // er9@1
  unsigned __int64 v4; // rsi@1
  signed int v5; // eax@1
  unsigned __int64 v6; // rsi@2
  IO80211PeerManager *v7; // rdi@4

  v3 = a2;
  v4 = *((_QWORD *)this + 54);
  v5 = 1 << a3;
  if ( v3 )
    v6 = v5 | v4;
  else
    v6 = ~v5 & v4;
  *((_QWORD *)this + 54) = v6;
  v7 = (IO80211PeerManager *)*((_QWORD *)this + 41);
  if ( v7 )
    IO80211PeerManager::setPeerManagerLogFlags(v7);
}

//----- (0000000000058C6C) ----------------------------------------------------
void __fastcall IO80211Interface::setDebugFlags(IO80211Interface *this, __int64 a2)
{
  IO80211PeerManager *v2; // rdi@1

  *((_QWORD *)this + 54) = a2;
  v2 = (IO80211PeerManager *)*((_QWORD *)this + 41);
  if ( v2 )
    IO80211PeerManager::setPeerManagerLogFlags(v2);
}

//----- (0000000000058C8C) ----------------------------------------------------
void __fastcall IO80211Interface::togglePeerManagerLogFlag(IO80211Interface *this, char a2)
{
  char v2; // cl@1
  unsigned __int64 v3; // rsi@1
  signed int v4; // eax@1
  __int64 v5; // rcx@1
  unsigned __int64 v6; // rsi@2
  IO80211PeerManager *v7; // rdi@4

  v2 = a2;
  v3 = *((_QWORD *)this + 54);
  v4 = 1 << v2;
  v5 = 1 << v2;
  if ( v3 & v5 )
    v6 = ~v4 & v3;
  else
    v6 = v5 | v3;
  *((_QWORD *)this + 54) = v6;
  v7 = (IO80211PeerManager *)*((_QWORD *)this + 41);
  if ( v7 )
    IO80211PeerManager::setPeerManagerLogFlags(v7);
}

//----- (0000000000058CD0) ----------------------------------------------------
__int64 __fastcall IO80211Interface::bpfAttach(__int64 a1, int a2, unsigned int a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7, __int64 a8, __int64 a9)
{
  unsigned int v9; // er15@1
  int v10; // er14@1
  __int64 v11; // r12@3
  __int64 v12; // rax@4
  __int64 v13; // r8@5
  __int64 v14; // rax@6
  __int64 v15; // rbx@7
  __int64 v16; // rax@8
  __int64 v17; // rcx@8
  __int64 v19; // [sp+20h] [bp-50h]@3
  __int64 v20; // [sp+28h] [bp-48h]@3
  __int64 v21; // [sp+30h] [bp-40h]@3

  v9 = a3;
  v10 = 22;
  if ( a4 && a5 )
  {
    v19 = a4;
    v20 = a5;
    v21 = a6;
    IOLog("bpfAttach len %lu dlt %lu\n", a3, (unsigned int)a2, a4, a5, a6);
    IOLockLock(*(_QWORD *)(a1 + 552));
    v11 = IO80211BPFNodeForDLT(a2, *(_QWORD *)(a1 + 544));
    if ( v11 )
    {
      v10 = 37;
    }
    else
    {
      LODWORD(v12) = (*(int (__fastcall **)(__int64))(*(_QWORD *)a1 + 2408LL))(a1);
      v10 = bpf_attach(v12, (unsigned int)a2, v9, _bpfOutput, IO80211BpfTap);
      v11 = 0LL;
      if ( !v10 )
      {
        v13 = a9;
        if ( !a9 )
        {
          LODWORD(v14) = (*(int (__fastcall **)(__int64))(*(_QWORD *)a1 + 1672LL))(a1);
          v13 = v14;
        }
        v15 = IO80211AllocBPFNode(v20, v21, a2, v19, v13, a7, a8);
        v10 = 12;
        v11 = 0LL;
        if ( v15 )
        {
          v16 = *(_QWORD *)(a1 + 544);
          v17 = *(_QWORD *)v16;
          *(_QWORD *)v15 = *(_QWORD *)v16;
          if ( v17 )
            *(_QWORD *)(v17 + 8) = v15;
          *(_QWORD *)v16 = v15;
          *(_QWORD *)(v15 + 8) = v16;
          v10 = 0;
          if ( *(_BYTE *)(a1 + 345) )
            IO80211ConfigureBPFOutputQueue(*(_DWORD *)(v15 + 16), 3, *(_QWORD *)(v15 + 24));
          v11 = v15;
        }
      }
    }
    IOLockUnlock(*(_QWORD *)(a1 + 552));
    if ( v10 && v11 )
      IO80211BPFNodeFree(v11);
  }
  return (unsigned int)v10;
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C89D0: using guessed type int __fastcall bpf_attach(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000058E61) ----------------------------------------------------
__int64 __fastcall _bpfOutput(__ifnet *a1, int a2, __mbuf *a3)
{
  __mbuf *v3; // r14@1
  IO80211Interface *v4; // rax@1
  int v5; // ebx@1

  v3 = a3;
  LODWORD(v4) = ifnet_softc(a1);
  v5 = IO80211Interface::bpfOutput(v4, a2, v3);
  if ( v5 )
    mbuf_freem(v3);
  return (unsigned int)v5;
}
// C8B90: using guessed type int __fastcall ifnet_softc(_QWORD);
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);

//----- (0000000000058E94) ----------------------------------------------------
int __fastcall IO80211Interface::bpfOutputPacket(IO80211Interface *this, __mbuf *a2, void *a3)
{
  __int64 v3; // rax@1

  LODWORD(v3) = mbuf_pkthdr_rcvif(a2, a2, a3);
  return (*(int (__fastcall **)(_QWORD, IO80211Interface *, _QWORD, __mbuf *))(**((_QWORD **)this + 56) + 3176LL))(
           *((_QWORD *)this + 56),
           this,
           *(_DWORD *)(v3 + 16),
           a2);
}
// C8C70: using guessed type int __fastcall mbuf_pkthdr_rcvif(_QWORD, _QWORD, _QWORD);

//----- (0000000000058ECA) ----------------------------------------------------
int __fastcall IO80211Interface::bpfOutput(IO80211Interface *this, int a2, __mbuf *a3)
{
  __mbuf *v3; // r14@1
  IO80211Interface *v4; // r12@1
  __int64 v5; // rax@1
  __int64 v6; // rdx@1
  __int64 v7; // rbx@1
  __int64 v8; // rdi@2
  signed int v10; // er15@4

  v3 = a3;
  v4 = this;
  IOLockLock(*((_QWORD *)this + 69));
  v5 = IO80211BPFNodeForDLT(a2, *((_QWORD *)this + 68));
  v7 = v5;
  if ( v5 )
  {
    mbuf_pkthdr_setrcvif(v3, v5, v6);
    v8 = *((_QWORD *)this + 41);
    if ( v8 )
      return (*(int (__fastcall **)(__int64, __mbuf *))(*(_QWORD *)v8 + 464LL))(v8, v3);
    v10 = 0;
    (*(void (__fastcall **)(_QWORD, __mbuf *, _QWORD))(**(_QWORD **)(v7 + 24) + 360LL))(*(_QWORD *)(v7 + 24), v3, 0LL);
    IOLockUnlock(*((_QWORD *)v4 + 69));
  }
  else
  {
    IOLockUnlock(*((_QWORD *)this + 69));
    v10 = 22;
  }
  return v10;
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C8C88: using guessed type int __fastcall mbuf_pkthdr_setrcvif(_QWORD, _QWORD, _QWORD);

//----- (0000000000058F74) ----------------------------------------------------
int __fastcall IO80211Interface::vlogDebug(IO80211Interface *this, __int64 a2, const char *a3, __va_list_tag *a4)
{
  const char *v4; // rbx@1
  int result; // eax@3

  v4 = a3;
  if ( !a2 || a2 & *((_QWORD *)this + 54) )
  {
    IO8Logv(a3, a4);
    result = IOLogv(v4);
  }
  return result;
}
// C7730: using guessed type int __fastcall IOLogv(_QWORD);

//----- (0000000000058FAE) ----------------------------------------------------
__int64 __fastcall IO80211Interface::logDebug(IO80211Interface *this, __int64 a2, const char *a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // rbx@1
  char v8; // [sp+0h] [bp-60h]@1
  __int64 v9; // [sp+18h] [bp-48h]@1
  __int64 v10; // [sp+20h] [bp-40h]@1
  __int64 v11; // [sp+28h] [bp-38h]@1
  __va_list_tag v12; // [sp+30h] [bp-30h]@1
  __int64 v13; // [sp+50h] [bp-10h]@1
  char v14; // [sp+70h] [bp+10h]@0

  v11 = a6;
  v10 = a5;
  v9 = a4;
  v6 = off_7B078[0];
  v13 = *(_QWORD *)off_7B078[0];
  v12.reg_save_area = &v8;
  v12.overflow_arg_area = &v14;
  v12.fp_offset = 48;
  v12.gp_offset = 24;
  IO80211Interface::vlogDebug(this, a2, a3, &v12);
  return *(_QWORD *)v6;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (000000000005900E) ----------------------------------------------------
void __fastcall IO80211Interface::vlogDebugBPF(IO80211Interface *this, __int64 a2, const char *a3, __va_list_tag *a4)
{
  ;
}

//----- (0000000000059014) ----------------------------------------------------
__int64 __fastcall IO80211Interface::monitorModeInputPacket(IO80211Interface *this, __mbuf *a2, unsigned int a3, void *a4, __int64 a5)
{
  __int64 v5; // r14@1
  void *v6; // r15@1
  unsigned int v7; // ebx@1
  __int64 v8; // rax@1

  v5 = a5;
  v6 = a4;
  v7 = a3;
  LODWORD(v8) = (*(int (**)(void))(*(_QWORD *)this + 2408LL))();
  bpf_tap_in(v8, v7, a2, v6, v5);
  return 0LL;
}
// C89D8: using guessed type int __fastcall bpf_tap_in(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000059052) ----------------------------------------------------
int __usercall IO80211Interface::bpfTapInput@<eax>(IO80211Interface *this@<rdi>, __mbuf *a2@<rsi>, void *a3@<rcx>, int result@<eax>, unsigned int a5@<edx>, __int64 a6@<r8>)
{
  __int64 v6; // r14@1
  void *v7; // r15@1
  unsigned int v8; // er12@1
  __int64 v9; // rax@2
  __int64 v10; // r8@2
  __int64 v11; // r9@2
  __int64 v12; // rax@2
  char v13; // [sp-8h] [bp-30h]@1

  v13 = result;
  v6 = a6;
  v7 = a3;
  v8 = a5;
  if ( !*((_BYTE *)this + 505) )
  {
    LODWORD(v9) = mbuf_pkthdr_len(a2);
    IO8Log("IO80211Interface::bpfTapInput: Received mlen = %u, dlt = %u\n", v9, v8, v9, v10, v11, v13);
    LODWORD(v12) = (*(int (__fastcall **)(IO80211Interface *))(*(_QWORD *)this + 2408LL))(this);
    result = bpf_tap_in(v12, v8, a2, v7, v6);
  }
  return result;
}
// C89D8: using guessed type int __fastcall bpf_tap_in(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8C68: using guessed type int __fastcall mbuf_pkthdr_len(_QWORD);

//----- (00000000000590D4) ----------------------------------------------------
int __fastcall IO80211Interface::outputStart(IO80211Interface *this)
{
  IO80211Interface *v1; // rcx@1
  __int64 v2; // rdi@1
  int result; // eax@1

  v1 = this;
  ++*((_DWORD *)v1 + 140);
  v2 = *((_QWORD *)this + 41);
  result = -536870210;
  if ( v2 )
  {
    result = -536870184;
    if ( *((_DWORD *)v1 + 90) == 2 )
      result = (*(int (**)(void))(*(_QWORD *)v2 + 472LL))();
  }
  return result;
}

//----- (000000000005910C) ----------------------------------------------------
int __fastcall IO80211Interface::configureInterface(IO80211Interface *this)
{
  IO80211Interface *v1; // rbx@1
  IO80211PeerManager *v2; // rdi@1
  int (__fastcall *v3)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // r14@2
  unsigned int v4; // eax@2
  int result; // eax@2

  v1 = this;
  v2 = (IO80211PeerManager *)*((_QWORD *)this + 41);
  if ( v2 )
  {
    v3 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v1 + 2504LL);
    v4 = IO80211PeerManager::getBufferPoolSize(v2);
    result = v3(v1, v4, 1LL, 0LL, 1LL);
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (0000000000059154) ----------------------------------------------------
int __fastcall IO80211Interface::setDataPathState(IO80211Interface *this, char a2)
{
  IO80211PeerManager *v2; // rdi@1
  int result; // eax@2

  v2 = (IO80211PeerManager *)*((_QWORD *)this + 41);
  if ( v2 )
    result = IO80211PeerManager::setDataPathState(v2, a2);
  return result;
}

//----- (0000000000059170) ----------------------------------------------------
__int64 __fastcall IO80211Interface::bpfTap(IO80211Interface *this, int a2, unsigned int a3)
{
  unsigned int v3; // er15@1
  IO80211Interface *v4; // r13@1
  __int64 v5; // rax@1
  __int64 v6; // rbx@1
  char *v7; // rcx@2
  __int64 v8; // rdi@3
  unsigned int v9; // er12@7
  unsigned __int64 v10; // rax@8
  signed __int64 v11; // rcx@9
  __int64 v12; // rax@13

  v3 = a3;
  v4 = this;
  IOLockLock(*((_QWORD *)this + 69));
  v5 = IO80211BPFNodeForDLT(a2, *((_QWORD *)this + 68));
  v6 = v5;
  if ( !v5 )
  {
    IOLockUnlock(*((_QWORD *)this + 69));
    return 22;
  }
  v7 = *(char **)(v5 + 40);
  if ( !v7 )
    goto LABEL_18;
  v8 = *(_QWORD *)(v5 + 32) + *(_QWORD *)(v5 + 48);
  if ( (unsigned __int8)v7 & 1 )
    v7 = *(char **)&v7[*(_QWORD *)v8 - 1];
  if ( !((int (__fastcall *)(__int64, _QWORD, _QWORD))v7)(v8, (unsigned int)a2, v3) )
LABEL_18:
    *(_DWORD *)(v6 + 56) = v3;
  IOLockUnlock(*((_QWORD *)v4 + 69));
  v9 = 0;
  if ( a2 > 191 )
  {
    if ( a2 != 192 )
      return v9;
  }
  else
  {
    v10 = (unsigned int)(a2 - 105);
    if ( (unsigned int)v10 > 0x3A )
      return v9;
    v11 = 288230376155906049LL;
    if ( !_bittest((const unsigned __int64 *)&v11, v10) )
      return v9;
  }
  LODWORD(v12) = (*(int (__fastcall **)(_QWORD, IO80211Interface *, _QWORD, _QWORD))(**((_QWORD **)v4 + 56) + 3184LL))(
                   *((_QWORD *)v4 + 56),
                   v4,
                   v3 != 0,
                   (unsigned int)a2);
  if ( !(_DWORD)v12 )
  {
    v9 = 0;
    IO80211Interface::postMessage(v4, 0LL, v12, 0LL, 8);
  }
  return v9;
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);

//----- (0000000000059272) ----------------------------------------------------
int __fastcall IO80211Interface::configureBpfOutputQueues(IO80211Interface *this, unsigned __int8 a2)
{
  __int64 i; // rbx@1

  IOLockLock(*((_QWORD *)this + 69));
  for ( i = **((_QWORD **)this + 68); i; i = *(_QWORD *)i )
    IO80211ConfigureBPFOutputQueue(*(_DWORD *)(i + 16), 3 * a2, *(_QWORD *)(i + 24));
  return IOLockUnlock(*((_QWORD *)this + 69));
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);

//----- (00000000000592D0) ----------------------------------------------------
__int64 __fastcall IO80211Interface::getOutputQueueForDLT(IO80211Interface *this, int a2)
{
  __int64 v2; // rcx@1
  __int64 result; // rax@1

  v2 = IO80211BPFNodeForDLT(a2, *((_QWORD *)this + 68));
  result = 0LL;
  if ( v2 )
    result = *(_QWORD *)(v2 + 24);
  return result;
}

//----- (00000000000592F6) ----------------------------------------------------
__int64 __fastcall IO80211Interface::setPidLock(IO80211Interface *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rax@1
  __int64 v5; // r12@1
  signed int v6; // ebx@1
  __int64 v8; // [sp+0h] [bp-30h]@4

  LODWORD(v4) = proc_self(this, a2, a3, a4);
  v5 = v4;
  v6 = 1;
  if ( v4 )
  {
    v6 = 1;
    if ( !proc_suser(v4) )
    {
      if ( (_BYTE)a2 )
      {
        io80211_get_calendar_time((__int64)&v8);
        *((_QWORD *)this + 64) = v8;
        *((_DWORD *)this + 127) = proc_selfpid(&v8, a2);
      }
      else
      {
        *((_DWORD *)this + 127) = -1;
      }
      v6 = 0;
    }
    proc_rele(v5);
  }
  return (unsigned int)v6;
}
// C8D08: using guessed type int __fastcall proc_rele(_QWORD);
// C8D10: using guessed type int __fastcall proc_self(_QWORD, _QWORD, _QWORD, _QWORD);
// C8D20: using guessed type int __fastcall proc_selfpid(_QWORD, _QWORD);
// C8D28: using guessed type int __fastcall proc_suser(_QWORD);

//----- (000000000005937A) ----------------------------------------------------
bool __fastcall IO80211Interface::pidLocked(IO80211Interface *this)
{
  signed int v1; // eax@1
  unsigned __int64 v3; // [sp+0h] [bp-40h]@2
  __int64 v4; // [sp+10h] [bp-30h]@2
  int v5; // [sp+18h] [bp-28h]@2
  char v6; // [sp+20h] [bp-20h]@2

  v1 = *((_DWORD *)this + 127);
  if ( v1 >= 0 )
  {
    io80211_get_calendar_time((__int64)&v6);
    v4 = *((_QWORD *)this + 64);
    v5 = 0;
    timespecSub((__int64)&v6, (__int64)&v4, (__int64)&v3);
    if ( v3 <= 0x3B )
    {
      v1 = *((_DWORD *)this + 127);
    }
    else
    {
      *((_DWORD *)this + 127) = -1;
      v1 = -1;
    }
  }
  return v1 >= 0;
}

//----- (00000000000593EC) ----------------------------------------------------
char __fastcall IO80211Interface::netBooting(IO80211Interface *this)
{
  return *((_BYTE *)this + 528);
}

//----- (00000000000593F8) ----------------------------------------------------
void __fastcall IO80211Interface::setNetBooting(IO80211Interface *this, char a2)
{
  *((_BYTE *)this + 528) = a2;
}

//----- (0000000000059406) ----------------------------------------------------
__int64 __fastcall IO80211Interface::netBootThreadGated(IO80211Interface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  IO80211Interface::netBootThread(a2, (IOService *)a3, (__int64)a3, (__int64)a4, (__int64)a5, (__int64)a6);
  return 0LL;
}

//----- (000000000005941A) ----------------------------------------------------
int __fastcall IO80211Interface::netBootThread(IO80211Interface *this, IOService *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  IO80211Interface *v6; // r14@1
  IO80211Interface *v7; // rsi@1
  IOService *v8; // rcx@1
  __int64 v9; // rbx@1
  int result; // eax@5

  v6 = a2;
  IOLog("IO80211Interface::netBootThread\n", a2, a3, a4, a5, a6);
  v7 = this;
  v9 = IO80211NetBootNub::nubWithControllerAndInterface(*((IO80211NetBootNub **)v7 + 56), v7, v6, v8);
  if ( v9 )
  {
    *((_BYTE *)this + 528) = 1;
    if ( (unsigned __int8)(*(int (__fastcall **)(__int64, IO80211Interface *))(*(_QWORD *)v9 + 1648LL))(v9, this) )
      (*(void (__fastcall **)(__int64, IO80211Interface *))(*(_QWORD *)v9 + 1472LL))(v9, this);
    v7 = 0LL;
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v9 + 1536LL))(v9, 0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 40LL))(v9);
  }
  (*(void (__fastcall **)(IO80211Interface *, IO80211Interface *))(*(_QWORD *)v6 + 40LL))(v6, v7);
  result = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)this + 56) + 40LL))(*((_QWORD *)this + 56));
  *((_BYTE *)this + 528) = 0;
  return result;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000594BC) ----------------------------------------------------
void __fastcall IO80211Interface::associateForNetBoot(IO80211Interface *this, IOService *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // rax@3
  __int64 v7; // rdx@4
  __int64 v8; // rcx@4

  if ( !*((_BYTE *)this + 528) )
  {
    IOLog("IO80211Interface::associateForNetBoot\n", a2, a3, a4, a5, a6);
    if ( !*((_QWORD *)this + 65) )
    {
      LODWORD(v6) = thread_call_allocate(net_boot_thread, this);
      *((_QWORD *)this + 65) = v6;
    }
    (*(void (__fastcall **)(IOService *))(*(_QWORD *)a2 + 32LL))(a2);
    (*(void (**)(void))(**((_QWORD **)this + 56) + 32LL))();
    thread_call_enter1(*((_QWORD *)this + 65), a2, v7, v8);
  }
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8DB0: using guessed type int __fastcall thread_call_allocate(_QWORD, _QWORD);
// C8DC8: using guessed type int __fastcall thread_call_enter1(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005952E) ----------------------------------------------------
int __fastcall net_boot_thread(void *a1, void *a2)
{
  __int64 v2; // rax@1

  LODWORD(v2) = (*(int (**)(void))(**((_QWORD **)a1 + 56) + 2224LL))();
  return (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IO80211Interface *, OSObject *, void *, void *, void *, void *), void *, void *, _QWORD, _QWORD))(*(_QWORD *)v2 + 456LL))(
           v2,
           IO80211Interface::netBootThreadGated,
           a1,
           a2,
           0LL,
           0LL);
}

//----- (0000000000059572) ----------------------------------------------------
__int64 __fastcall IO80211Interface::associateForNetBootGated(IO80211Interface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  IO80211Interface::associateForNetBoot(a2, (IOService *)a3, (__int64)a3, (__int64)a4, (__int64)a5, (__int64)a6);
  return 0LL;
}

//----- (0000000000059586) ----------------------------------------------------
char __fastcall IO80211Interface::efiNVRAMPublished(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // r14@1
  __int64 v7; // rbx@1
  __int64 v8; // rax@1
  __int64 v9; // rdx@1
  __int64 v10; // rcx@1
  __int64 v11; // r8@1
  __int64 v12; // r9@1
  IO80211PeerManager *v13; // rdi@2
  __int64 v14; // rax@4

  v6 = a3;
  v7 = a1;
  IOLog("IO80211Interface::efiNVRAMPublished():  \n", a2, a3, a4, a5, a6);
  LODWORD(v8) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v6 + 696LL))(
                  v6,
                  "37BCBEC7-A645-4215-979E-F5AE4D115F13:wireless-boot-data");
  if ( v8 )
  {
    IOLog(
      "\t\t\t\t found \"wireless-boot-data\" \n",
      "37BCBEC7-A645-4215-979E-F5AE4D115F13:wireless-boot-data",
      v9,
      v10,
      v11,
      v12);
    *(_QWORD *)(a1 + 432) |= 4uLL;
    v13 = *(IO80211PeerManager **)(a1 + 328);
    if ( v13 )
      IO80211PeerManager::setPeerManagerLogFlags(v13);
    LODWORD(v14) = (*(int (**)(void))(**(_QWORD **)(v7 + 448) + 2224LL))();
    (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(IO80211Interface *, OSObject *, void *, void *, void *, void *), __int64, __int64, _QWORD, _QWORD))(*(_QWORD *)v14 + 456LL))(
      v14,
      IO80211Interface::associateForNetBootGated,
      v7,
      v6,
      0LL,
      0LL);
  }
  return 1;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000059624) ----------------------------------------------------
__int64 *__fastcall IO80211Interface::apCompare(__int64 a1, __int64 *a2, __int64 *a3)
{
  __int64 *v3; // r15@1
  __int64 *v4; // r14@1
  __int64 v5; // r13@2
  int v6; // er12@2
  __int64 v7; // rbx@2
  int v8; // ecx@2
  signed int v9; // edx@2
  signed int v10; // esi@2
  __int64 *result; // rax@2
  int v12; // edx@6
  int v13; // ebx@6
  char v14; // si@6
  bool v15; // zf@8
  int v16; // eax@9
  __int64 v17; // rdx@9
  int v18; // edi@9
  int v19; // ecx@9
  __int64 v20; // rsi@10
  int v21; // edx@16
  int v22; // esi@16
  __int16 v23; // cx@24
  char v24; // bl@35

  v3 = a3;
  v4 = a2;
  if ( *(_BYTE *)(*(_QWORD *)(a1 + 536) + 6LL) & 4 )
  {
    v5 = *a2;
    v6 = _phyModeForAsr(*a2);
    v7 = *v3;
    v8 = _phyModeForAsr(*v3);
    v9 = *(_WORD *)(v7 + 22);
    v10 = *(_WORD *)(v5 + 22);
    result = v3;
    if ( v9 < v10 )
      result = v4;
    if ( v10 >= -67 && (signed __int16)v9 >= -67 )
    {
      v12 = *(_DWORD *)(v5 + 12);
      v13 = *(_DWORD *)(v7 + 12);
      v14 = v6 | v8;
      if ( ((unsigned __int8)v6 | (unsigned __int8)v8) & 0x80 )
      {
        if ( ((unsigned __int8)v6 ^ (unsigned __int8)v8) & 0x80 )
        {
          v15 = (v6 & 0x80u) >> 7 == 0;
          goto LABEL_47;
        }
        v23 = v12 | v13;
        if ( ((unsigned __int16)(v12 | v13) >> 8) & 8 )
        {
          if ( !((BYTE1(v12) ^ BYTE1(v13)) & 8) )
            return result;
          v15 = (v12 & 0x800u) >> 11 == 0;
          goto LABEL_47;
        }
        if ( HIBYTE(v23) & 4 )
        {
          if ( !((BYTE1(v12) ^ BYTE1(v13)) & 4) )
            return result;
          v15 = (v12 & 0x400u) >> 10 == 0;
          goto LABEL_47;
        }
        if ( !(v23 & 4) )
          return result;
        v24 = v12 ^ v13;
LABEL_45:
        if ( !(v24 & 4) )
          return result;
        v15 = (v12 & 4u) >> 2 == 0;
        goto LABEL_47;
      }
      if ( v14 & 0x10 )
      {
        if ( ((unsigned __int8)v6 ^ (unsigned __int8)v8) & 0x10 )
        {
          v15 = (v6 & 0x10u) >> 4 == 0;
        }
        else
        {
          if ( !(((unsigned __int8)v12 | (unsigned __int8)v13) & 0x10) )
            return result;
          v24 = v12 ^ v13;
          if ( !(v24 & 0x10) )
            goto LABEL_45;
          v15 = (v12 & 0x10u) >> 4 == 0;
        }
LABEL_47:
        if ( !v15 )
          v3 = v4;
        return v3;
      }
      if ( v14 & 2 )
      {
        if ( !(((unsigned __int8)v6 ^ (unsigned __int8)v8) & 2) )
          return result;
        v15 = (v6 & 2u) >> 1 == 0;
        goto LABEL_47;
      }
      if ( v14 & 8 && ((unsigned __int8)v6 ^ (unsigned __int8)v8) & 8 )
      {
        v15 = (v6 & 8u) >> 3 == 0;
        goto LABEL_47;
      }
    }
  }
  else
  {
    v16 = *(_DWORD *)(a1 + 532);
    v17 = *a2;
    v18 = *(_DWORD *)(*a2 + 12);
    v19 = *(_DWORD *)(*a2 + 12) & 0x10;
    if ( v19 && (v20 = *v3, *(_BYTE *)(*v3 + 12) & 0x10) || (v20 = *v3, v18 & 8) && *(_BYTE *)(v20 + 12) & 8 )
    {
      if ( *(_WORD *)(v17 + 22) > (signed int)*(_WORD *)(v20 + 22) )
        v3 = v4;
      return v3;
    }
    v21 = *(_WORD *)(v17 + 22);
    v22 = *(_WORD *)(v20 + 22);
    if ( v21 < v16 && v22 > v16 )
      return v3;
    if ( v22 < v16 && v21 > v16 )
      return v4;
    result = v3;
    if ( v19 )
      result = v4;
    if ( (signed int)*(_WORD *)(*result + 22) <= -68 )
    {
      v15 = result == v4;
      goto LABEL_47;
    }
  }
  return result;
}

//----- (00000000000597F8) ----------------------------------------------------
int __fastcall IO80211Interface::setWoWEnabled(IO80211Interface *this, unsigned __int8 a2)
{
  int result; // eax@1

  result = a2;
  if ( a2 != *((_BYTE *)this + 504) )
  {
    *((_BYTE *)this + 504) = a2;
    result = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2192LL))(this, 4278190084LL, 0LL);
  }
  return result;
}

//----- (0000000000059828) ----------------------------------------------------
char __fastcall IO80211Interface::shortGISupported40MHz(IO80211Interface *this)
{
  return (unsigned __int8)(*(_BYTE *)(*((_QWORD *)this + 67) + 2LL) & 4) >> 2;
}

//----- (000000000005983E) ----------------------------------------------------
char __fastcall IO80211Interface::shortGISupported20MHz(IO80211Interface *this)
{
  return (unsigned __int8)(*(_BYTE *)(*((_QWORD *)this + 67) + 2LL) & 8) >> 3;
}

//----- (0000000000059854) ----------------------------------------------------
__int64 __fastcall IO80211Interface::dequeueTxPackets(IO80211Interface *this)
{
  return 0LL;
}

//----- (000000000005985C) ----------------------------------------------------
int __fastcall IO80211Interface::dequeueTxPackets(__int64 a1, void *a2)
{
  __int64 v2; // rdi@1
  int result; // eax@2

  v2 = *(_QWORD *)(a1 + 328);
  if ( v2 )
  {
    result = (*(int (**)(void))(*(_QWORD *)v2 + 496LL))();
  }
  else
  {
    memset(a2, 0, 0x60uLL);
    result = 0;
  }
  return result;
}

//----- (0000000000059892) ----------------------------------------------------
int __fastcall IO80211Interface::getControllerWorkLoop(IO80211Interface *this)
{
  __int64 v1; // rdi@1
  int result; // eax@2

  v1 = *((_QWORD *)this + 56);
  if ( v1 )
    result = (*(int (**)(void))(*(_QWORD *)v1 + 1672LL))();
  else
    result = 0;
  return result;
}

//----- (00000000000598B0) ----------------------------------------------------
int __fastcall IO80211Interface::handleDebugCmd(__int64 a1)
{
  __int64 v1; // rdi@1
  int result; // eax@2

  v1 = *(_QWORD *)(a1 + 328);
  if ( v1 )
    result = (*(int (**)(void))(*(_QWORD *)v1 + 536LL))();
  else
    result = 45;
  return result;
}

//----- (00000000000598D4) ----------------------------------------------------
int __fastcall IO80211Interface::printPeers(IO80211Interface *this)
{
  __int64 v1; // rdi@1
  int result; // eax@2

  v1 = *((_QWORD *)this + 41);
  if ( v1 )
    result = (*(int (**)(void))(*(_QWORD *)v1 + 512LL))();
  return result;
}

//----- (00000000000598F4) ----------------------------------------------------
__int64 __fastcall IO80211Interface::MetaClass::~MetaClass(IO80211Interface::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000598FE) ----------------------------------------------------
__int64 __fastcall _phyModeForAsr(__int64 a1)
{
  unsigned __int8 v1; // al@1
  char v2; // dl@2
  signed __int64 v3; // rcx@2
  signed __int64 v4; // r10@2
  signed __int64 v5; // r11@2
  char v6; // r14@2
  char v7; // r8@2
  char v8; // r9@2
  __int64 v9; // rbx@2
  unsigned __int64 v10; // rsi@3
  char v11; // r15@4
  unsigned int v12; // er11@22
  __int64 result; // rax@22
  char v14; // r10@22
  char v15; // cl@22
  __int64 v16; // rsi@23
  signed int v17; // ecx@23
  __int64 v18; // rdx@23
  int v19; // ebx@25
  __int64 v20; // rbx@29
  int v21; // edx@32
  __int64 v22; // rcx@36
  int v23; // esi@38
  int v24; // edx@39
  unsigned int v25; // edx@56

  v1 = *(_BYTE *)(a1 + 34);
  if ( v1 )
  {
    v2 = 0;
    v3 = 18295942222713408LL;
    v4 = 2086LL;
    v5 = 8594128896LL;
    v6 = 0;
    v7 = 0;
    v8 = 0;
    v9 = 0LL;
    while ( 1 )
    {
      v10 = *(_DWORD *)(a1 + 4 * v9 + 36);
      if ( v10 > 0x36 )
        goto LABEL_61;
      v11 = 1;
      if ( _bittest((const unsigned __int64 *)&v3, v10) )
      {
        v6 = 1;
        goto LABEL_10;
      }
      if ( _bittest((const unsigned __int64 *)&v4, v10) )
        goto LABEL_12;
      if ( _bittest((const unsigned __int64 *)&v5, v10) )
        v7 = 1;
      else
LABEL_61:
        v8 = 1;
LABEL_10:
      if ( v2 )
      {
        v11 = v2;
LABEL_12:
        if ( v6 )
        {
          if ( v7 )
          {
            if ( v8 )
              goto LABEL_22;
            v8 = 0;
          }
          else
          {
            v7 = 0;
          }
        }
        else
        {
          v6 = 0;
        }
        goto LABEL_19;
      }
      v11 = 0;
LABEL_19:
      ++v9;
      v2 = v11;
      if ( (unsigned __int8)v9 >= (unsigned int)v1 )
        goto LABEL_22;
    }
  }
  v11 = 0;
  v6 = 0;
  v7 = 0;
  v8 = 0;
LABEL_22:
  v12 = *(_WORD *)(a1 + 138);
  result = 0LL;
  v14 = 0;
  v15 = 0;
  if ( v12 < 3 )
    goto LABEL_38;
  v16 = *(_QWORD *)(a1 + 144);
  v17 = *(_WORD *)(a1 + 138);
  v18 = *(_QWORD *)(a1 + 144);
  while ( *(_BYTE *)v18 != 61 )
  {
    LOBYTE(v19) = *(_BYTE *)(v18 + 1);
LABEL_29:
    v20 = (unsigned int)(unsigned __int8)v19 + 2;
    v17 -= v20;
    v18 += v20;
    if ( v17 <= 2 )
    {
      v14 = 0;
      goto LABEL_31;
    }
  }
  v19 = *(_BYTE *)(v18 + 1);
  if ( v17 - 2 < v19 )
    goto LABEL_29;
  v14 = 1;
  if ( (unsigned int)(v19 + 2) <= 0x17 )
    goto LABEL_29;
  do
  {
LABEL_31:
    if ( *(_BYTE *)v16 == 191 )
    {
      v21 = *(_BYTE *)(v16 + 1);
      if ( (signed int)(v12 - 2) >= v21 )
      {
        v15 = 1;
        if ( (unsigned int)(v21 + 2) > 0xD )
          goto LABEL_38;
      }
    }
    else
    {
      LOBYTE(v21) = *(_BYTE *)(v16 + 1);
    }
    v22 = (unsigned int)(unsigned __int8)v21 + 2;
    v12 -= v22;
    v16 += v22;
  }
  while ( (signed int)v12 > 2 );
  v15 = 0;
LABEL_38:
  v23 = *(_DWORD *)(a1 + 12);
  if ( v23 & 0x18 )
  {
    v24 = 0;
    if ( v23 & 0x10 )
    {
      if ( v6 && !v11 && !v8 )
        v24 = 2 * (((unsigned __int8)v14 & (unsigned __int8)v15) == 0);
    }
    else if ( v23 & 8 )
    {
      v24 = 0;
      if ( v11 && !v6 && !v8 )
        v24 = 4 * (v14 == 0);
      if ( (unsigned __int8)v6 | (unsigned __int8)v7 && !v8 && !v14 )
        v24 |= 8u;
    }
    result = v24 | 0x10u;
    if ( !v14 )
      result = (unsigned int)v24;
    if ( v14 )
    {
      v25 = result | 0x80;
      if ( !v15 )
        v25 = result;
      result = v25;
    }
  }
  return result;
}

//----- (0000000000059AE0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_14()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IO80211Interface::gMetaClass, "IO80211Interface", off_7B018[0], 592LL);
  result = (__int64)off_80320;
  IO80211Interface::gMetaClass = off_80320;
  return result;
}
// 7B018: using guessed type _QWORD off_7B018[19];
// 80320: using guessed type __int64 (__fastcall *off_80320[2])(IO80211Interface::MetaClass *__hidden this);
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000059B20) ----------------------------------------------------
__int64 `global destructor keyed to'_a_14()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211Interface::gMetaClass);
}
// 845E8: using guessed type _QWORD IO80211Interface::gMetaClass;

//----- (0000000000059B34) ----------------------------------------------------
char __fastcall IO80211InterfaceValidateApple80211Command(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rax@1
  __int64 v5; // rbx@1
  signed __int64 v6; // rax@4
  char v7; // r14@8

  LODWORD(v4) = proc_self(a1, a2, a3, a4);
  v5 = v4;
  if ( !v4 )
    return 0;
  if ( proc_is64bit(v4) )
  {
    if ( a1 == 2150132168LL )
      goto LABEL_8;
    v6 = 3223873993LL;
  }
  else
  {
    if ( a1 == 2149870024LL )
      goto LABEL_8;
    v6 = 3223611849LL;
  }
  if ( a1 != v6 )
  {
    v7 = 0;
    goto LABEL_10;
  }
LABEL_8:
  v7 = 1;
LABEL_10:
  proc_rele(v5);
  return v7;
}
// C8CF8: using guessed type int __fastcall proc_is64bit(_QWORD);
// C8D08: using guessed type int __fastcall proc_rele(_QWORD);
// C8D10: using guessed type int __fastcall proc_self(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000059B99) ----------------------------------------------------
char __fastcall IO80211InterfaceValidateNet80211Command(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rax@1
  __int64 v5; // rbx@1
  signed __int64 v6; // rax@4
  char v7; // r14@8

  LODWORD(v4) = proc_self(a1, a2, a3, a4);
  v5 = v4;
  if ( !v4 )
    return 0;
  if ( proc_is64bit(v4) )
  {
    if ( a1 == 2149607882LL )
      goto LABEL_8;
    v6 = 3223349707LL;
  }
  else
  {
    if ( a1 == 2149345738LL )
      goto LABEL_8;
    v6 = 3223087563LL;
  }
  if ( a1 != v6 )
  {
    v7 = 0;
    goto LABEL_10;
  }
LABEL_8:
  v7 = 1;
LABEL_10:
  proc_rele(v5);
  return v7;
}
// C8CF8: using guessed type int __fastcall proc_is64bit(_QWORD);
// C8D08: using guessed type int __fastcall proc_rele(_QWORD);
// C8D10: using guessed type int __fastcall proc_self(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000059BFE) ----------------------------------------------------
char __fastcall IO80211InterfaceUserlandToKernelApple80211Commmand(char *a1, char *a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // rax@1
  __int64 v6; // r15@1
  int v7; // er13@2
  char v8; // al@3
  char result; // al@5

  v4 = a3;
  LODWORD(v5) = proc_self(a1, a2, a3, a4);
  v6 = v5;
  if ( v5 )
  {
    v7 = proc_is64bit(v5);
    strlcpy(a1, a2, 0x10uLL);
    if ( v7 )
    {
      *((_DWORD *)a1 + 6) = *((_DWORD *)a2 + 6);
      *((_DWORD *)a1 + 4) = *((_DWORD *)a2 + 4);
      *((_DWORD *)a1 + 5) = *((_DWORD *)a2 + 5);
      *((_QWORD *)a1 + 4) = *((_QWORD *)a2 + 4);
      v8 = 1;
    }
    else
    {
      *((_DWORD *)a1 + 6) = *((_DWORD *)a2 + 6);
      *((_DWORD *)a1 + 4) = *((_DWORD *)a2 + 4);
      *((_DWORD *)a1 + 5) = *((_DWORD *)a2 + 5);
      *((_QWORD *)a1 + 4) = *(_QWORD *)(a2 + 28);
      v8 = 0;
    }
    *(_BYTE *)v4 = v8;
    proc_rele(v6);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}
// C8CF8: using guessed type int __fastcall proc_is64bit(_QWORD);
// C8D08: using guessed type int __fastcall proc_rele(_QWORD);
// C8D10: using guessed type int __fastcall proc_self(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000059CAE) ----------------------------------------------------
char __fastcall IO80211InterfaceUserlandToKernelNet80211Commmand(char *a1, char *a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // rax@1
  __int64 v6; // r15@1
  int v7; // er13@2
  char v8; // al@3
  char result; // al@5

  v4 = a3;
  LODWORD(v5) = proc_self(a1, a2, a3, a4);
  v6 = v5;
  if ( v5 )
  {
    v7 = proc_is64bit(v5);
    strlcpy(a1, a2, 0x10uLL);
    *((_WORD *)a1 + 8) = *((_WORD *)a2 + 8);
    *((_WORD *)a1 + 9) = *((_WORD *)a2 + 9);
    *((_WORD *)a1 + 10) = *((_WORD *)a2 + 10);
    if ( v7 )
    {
      *((_QWORD *)a1 + 3) = *((_QWORD *)a2 + 3);
      v8 = 1;
    }
    else
    {
      *((_QWORD *)a1 + 3) = *((_DWORD *)a2 + 6);
      v8 = 0;
    }
    *(_BYTE *)v4 = v8;
    proc_rele(v6);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}
// C8CF8: using guessed type int __fastcall proc_is64bit(_QWORD);
// C8D08: using guessed type int __fastcall proc_rele(_QWORD);
// C8D10: using guessed type int __fastcall proc_self(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000059D47) ----------------------------------------------------
__int64 __fastcall IO80211InterfacePostMessage(char *a1, unsigned __int64 a2, void *a3, unsigned __int64 a4)
{
  __int64 result; // rax@8
  int v5; // [sp+0h] [bp-60h]@5
  int v6; // [sp+4h] [bp-5Ch]@5
  int v7; // [sp+8h] [bp-58h]@5
  int v8; // [sp+Ch] [bp-54h]@5
  int v9; // [sp+10h] [bp-50h]@5
  char *v10; // [sp+18h] [bp-48h]@5
  int v11; // [sp+20h] [bp-40h]@6
  void *v12; // [sp+28h] [bp-38h]@6
  int v13; // [sp+30h] [bp-30h]@6

  if ( (!a4 || a3 && a4 <= 0x7F0) && (_DWORD)a2 != 58 )
  {
    v5 = 1;
    v6 = 6;
    v7 = 1;
    v8 = a2;
    v9 = 16;
    v10 = a1;
    if ( a4 )
    {
      v11 = a4;
      v12 = a3;
      v13 = 0;
    }
    else
    {
      v11 = 0;
    }
    result = IO80211QueueCall::kev_post_msg(&v5, a2);
  }
  return result;
}

//----- (0000000000059DB5) ----------------------------------------------------
__mbuf *__fastcall IO80211InterfaceClassifyAndFixupPacket(OSObject *a1, __mbuf *a2)
{
  __mbuf *v2; // rbx@1
  unsigned __int64 v3; // rax@4
  __int64 v4; // rax@7
  unsigned __int64 v5; // rax@8
  __int64 v6; // rax@10
  unsigned __int32 v7; // ebx@10
  __int64 v8; // rax@11
  unsigned __int64 v9; // rax@12
  __int64 v10; // rax@14
  int v11; // eax@15
  signed __int64 v12; // rsi@15
  __int64 v13; // rax@19
  __int64 v15; // [sp+0h] [bp-20h]@1
  __mbuf *v16; // [sp+8h] [bp-18h]@1

  v2 = a2;
  v16 = a2;
  v15 = 0LL;
  if ( !a2 || !a1 )
    return v16;
  if ( !mbuf_get_traffic_class(a2) )
  {
    LODWORD(v3) = mbuf_len(a2);
    if ( v3 <= 0xD )
    {
      v2 = 0LL;
      if ( mbuf_pullup(&v16, 14LL) )
        return v2;
      v2 = v16;
    }
    LODWORD(v4) = mbuf_data(v2);
    if ( *(_WORD *)(v4 + 12) == 8 )
    {
      LODWORD(v5) = mbuf_len(v16);
      if ( v5 > 0x21 || (v2 = 0LL, !mbuf_pullup(&v16, 34LL)) )
      {
        LODWORD(v6) = mbuf_data(v16);
        v7 = (unsigned int)*(_BYTE *)(v6 + 15) >> 2;
LABEL_15:
        v11 = v7 & 0x3FFFFFF8;
        v12 = 1LL;
        if ( (v7 & 0x3FFFFFF8) == 8 || v11 == 16 || (v12 = 2LL, (v11 | 8) == 40) )
        {
LABEL_19:
          mbuf_set_traffic_class(v16, v12);
          LODWORD(v13) = mbuf_data(v16);
          if ( *(_BYTE *)v13 & 1 && IO80211InterfaceDetermineWMEQueueByMulticastFixup(a1, v16, v7, &v15) )
            mbuf_set_traffic_class(
              v16,
              *((_DWORD *)IO80211InterfaceClassifyAndFixupPacket(OSObject *,__mbuf *)::ac2tc + v15));
          return v16;
        }
LABEL_18:
        v12 = 3 * (unsigned int)((v7 & 0x3FFFFFF0) == 48);
        goto LABEL_19;
      }
    }
    else
    {
      LODWORD(v8) = mbuf_data(v16);
      v7 = 0;
      if ( *(_WORD *)(v8 + 12) != 56710 )
        goto LABEL_18;
      LODWORD(v9) = mbuf_len(v16);
      if ( v9 > 0x35 || (v2 = 0LL, !mbuf_pullup(&v16, 54LL)) )
      {
        LODWORD(v10) = mbuf_data(v16);
        v7 = (_byteswap_ulong(*(_DWORD *)(v10 + 14)) >> 22) & 0x3F;
        goto LABEL_15;
      }
    }
  }
  return v2;
}
// 7AE40: using guessed type __int64 IO80211InterfaceClassifyAndFixupPacket(OSObject *,__mbuf *)::ac2tc[2];
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C30: using guessed type int __fastcall mbuf_get_traffic_class(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C90: using guessed type int __fastcall mbuf_pullup(_QWORD, _QWORD);
// C8C98: using guessed type int __fastcall mbuf_set_traffic_class(_QWORD, _QWORD);

//----- (0000000000059F41) ----------------------------------------------------
__int64 __fastcall IO80211InterfaceDetermineWMEQueueByMulticastFixup(OSObject *a1, __mbuf *a2, unsigned __int8 a3, __int64 *a4)
{
  __int64 *v4; // rbx@1
  unsigned __int8 v5; // r13@1
  __int64 v6; // rax@1
  __int64 v7; // r14@1
  bool v8; // cl@1
  __int64 result; // rax@1
  unsigned __int64 v10; // rax@3
  unsigned __int64 v11; // rcx@3
  __int64 v12; // rax@4
  __int64 v13; // rcx@4
  __int64 v14; // rax@5
  __int64 v15; // rcx@5
  __int64 v16; // rdx@8
  __int64 v17; // rcx@8
  __int64 v18; // r8@8
  __int64 v19; // r9@8
  __int64 v20; // rdx@9
  __int64 v21; // rcx@9
  __int64 v22; // r8@9
  __int64 v23; // r9@9
  __int64 v24; // rax@10
  __int64 v25; // rbx@10
  __int64 v26; // rax@10
  __int64 *v27; // [sp+0h] [bp-40h]@7
  __int16 v28; // [sp+16h] [bp-2Ah]@10

  v4 = a4;
  v5 = a3;
  LODWORD(v6) = OSMetaClassBase::safeMetaCast(a1, IO80211Interface::metaClass);
  v7 = v6;
  v8 = v6 == 0;
  result = 0LL;
  if ( v5 )
  {
    if ( !v8 )
    {
      LODWORD(v10) = mbuf_len(a2);
      v11 = v10;
      result = 0LL;
      if ( v11 >= 0xF )
      {
        LODWORD(v12) = mbuf_data(a2);
        v13 = v12;
        result = 0LL;
        if ( *(_WORD *)(v13 + 12) == 8 )
        {
          LODWORD(v14) = mbuf_data(a2);
          v15 = v14;
          result = 0LL;
          if ( *(_BYTE *)v15 & 1 )
          {
            result = 0LL;
            if ( *(_DWORD *)(v7 + 568) == 3 )
            {
              v27 = v4;
              if ( v7 && IO80211Interface::debugFlags((IO80211Interface *)v7) & 1 )
              {
                IOLog("touchup IPv4 Multicast with DSCP <0x%02x>\n", v5, v16, v17, v18, v19);
                IO8Log("touchup IPv4 Multicast with DSCP <0x%02x>\n", v5, v20, v21, v22, v23, (char)v4);
              }
              LODWORD(v24) = mbuf_data(a2);
              v25 = v24;
              *(_BYTE *)(v24 + 15) = 0;
              *(_WORD *)(v24 + 24) = 0;
              mbuf_inet_cksum(a2, 0LL, 14LL, 20LL, &v28);
              *(_WORD *)(v25 + 24) = v28;
              *v27 = 0LL;
              LODWORD(v26) = OSMetaClassBase::safeMetaCast(a1, IO80211Interface::metaClass);
              if ( v26 )
                result = *((_QWORD *)a1 + 55);
              else
                result = *((_QWORD *)a1 + 30);
            }
          }
        }
      }
    }
  }
  return result;
}
// 7F790: using guessed type _QWORD IO80211Interface::metaClass;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C38: using guessed type int __fastcall mbuf_inet_cksum(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);

//----- (000000000005A090) ----------------------------------------------------
__int64 __fastcall setWMEtclass(__mbuf *a1)
{
  __mbuf *v1; // rbx@1
  unsigned __int64 v2; // rax@2
  int v3; // ecx@3
  __int64 result; // rax@3
  __int64 v5; // rax@5
  unsigned __int64 v6; // rax@6
  int v7; // ecx@7
  __int64 v8; // rax@8
  unsigned __int8 v9; // al@8
  __int64 v10; // rax@9
  unsigned __int64 v11; // rax@10
  int v12; // ecx@11
  __int64 v13; // rax@12
  int v14; // ecx@14
  __mbuf *v15; // rdi@16
  signed __int64 v16; // rsi@16
  __mbuf *v17; // [sp+0h] [bp-10h]@1

  v1 = a1;
  v17 = a1;
  if ( mbuf_get_traffic_class(a1) )
    return 0LL;
  LODWORD(v2) = mbuf_len(a1);
  if ( v2 <= 0xD )
  {
    v3 = mbuf_pullup(&v17, 14LL);
    result = 22LL;
    if ( v3 )
      return result;
    v1 = v17;
  }
  LODWORD(v5) = mbuf_data(v1);
  if ( *(_WORD *)(v5 + 12) == 8 )
  {
    LODWORD(v6) = mbuf_len(v17);
    if ( v6 > 0x21 || (v7 = mbuf_pullup(&v17, 34LL), result = 22LL, !v7) )
    {
      LODWORD(v8) = mbuf_data(v17);
      v9 = *(_BYTE *)(v8 + 15) >> 2;
      goto LABEL_13;
    }
  }
  else
  {
    LODWORD(v10) = mbuf_data(v17);
    if ( *(_WORD *)(v10 + 12) != 56710 )
      return 0LL;
    LODWORD(v11) = mbuf_len(v17);
    if ( v11 > 0x35 || (v12 = mbuf_pullup(&v17, 54LL), result = 22LL, !v12) )
    {
      LODWORD(v13) = mbuf_data(v17);
      v9 = (_byteswap_ulong(*(_DWORD *)(v13 + 14)) >> 22) & 0x3F;
LABEL_13:
      if ( v9 )
      {
        v14 = v9 & 0x38;
        if ( v14 != 8 && v14 != 16 )
        {
          if ( (v9 & 0x30) == 32 )
          {
            v15 = v17;
            v16 = 2LL;
          }
          else
          {
            if ( v14 != 48 && v9 < 0x38u )
              return 0LL;
            v15 = v17;
            v16 = 3LL;
          }
        }
        else
        {
          v15 = v17;
          v16 = 1LL;
        }
        mbuf_set_traffic_class(v15, v16);
      }
      return 0LL;
    }
  }
  return result;
}
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C30: using guessed type int __fastcall mbuf_get_traffic_class(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C90: using guessed type int __fastcall mbuf_pullup(_QWORD, _QWORD);
// C8C98: using guessed type int __fastcall mbuf_set_traffic_class(_QWORD, _QWORD);

//----- (000000000005A1CF) ----------------------------------------------------
__int64 __fastcall IO80211InterfaceQueueWMEPacket(OSObject *a1, __mbuf *a2)
{
  __mbuf *v2; // rbx@1
  unsigned __int64 v3; // rax@1
  signed int v4; // er15@2
  __int64 v5; // rax@4
  unsigned __int64 v6; // rax@5
  __int64 v7; // rax@7
  unsigned __int8 v8; // r15@7
  __int64 v9; // rax@8
  unsigned __int64 v10; // rax@9
  __int64 v11; // rax@11
  __int64 v12; // rdx@13
  __int64 v13; // rbx@13
  int v14; // ecx@14
  __int64 v15; // rax@15
  char *v16; // rax@16
  __int64 v17; // rax@18
  __int64 v18; // rsi@19
  int v19; // eax@24
  __int64 v20; // r15@26
  __int64 v21; // rax@26
  char *v22; // rax@27
  int v23; // eax@29
  __int64 v24; // rax@30
  __int64 v25; // rax@32
  __int64 v26; // rax@34
  __int64 v27; // rax@37
  __int64 v28; // rax@41
  __int64 v29; // rax@51
  __int64 v31; // [sp+8h] [bp-28h]@13
  __mbuf *v32; // [sp+10h] [bp-20h]@1

  v2 = a2;
  v32 = a2;
  LODWORD(v3) = mbuf_len(a2);
  if ( v3 <= 0xD )
  {
    v4 = 22;
    if ( mbuf_pullup(&v32, 14LL) )
      return (unsigned int)v4;
    v2 = v32;
  }
  LODWORD(v5) = mbuf_data(v2);
  if ( *(_WORD *)(v5 + 12) != 8 )
  {
    LODWORD(v9) = mbuf_data(v32);
    if ( *(_WORD *)(v9 + 12) == 56710 )
    {
      LODWORD(v10) = mbuf_len(v32);
      if ( v10 <= 0x35 )
      {
        v4 = 22;
        if ( mbuf_pullup(&v32, 54LL) )
          return (unsigned int)v4;
      }
      LODWORD(v11) = mbuf_data(v32);
      v8 = (_byteswap_ulong(*(_DWORD *)(v11 + 14)) >> 22) & 0x3F;
    }
    else
    {
      v8 = 0;
    }
LABEL_13:
    v13 = IO80211InterfaceDetermineWMEQueueByMulticastFixup(a1, v32, v8, &v31);
    if ( v13 )
    {
      v18 = v31;
    }
    else
    {
      v14 = mbuf_get_traffic_class(v32);
      if ( (unsigned int)v14 <= 3 )
      {
        switch ( v14 )
        {
          case 1:
            v31 = 1LL;
            LODWORD(v17) = OSMetaClassBase::safeMetaCast(a1, IO80211Interface::metaClass);
            if ( v17 )
            {
              v16 = (char *)a1 + 472;
              v18 = 1LL;
            }
            else
            {
              v16 = (char *)a1 + 248;
              v18 = 1LL;
            }
            goto LABEL_22;
          case 0:
            goto LABEL_23;
          case 2:
            v31 = 2LL;
            LODWORD(v25) = OSMetaClassBase::safeMetaCast(a1, IO80211Interface::metaClass);
            if ( v25 )
            {
              v16 = (char *)a1 + 488;
              v18 = 2LL;
            }
            else
            {
              v16 = (char *)a1 + 264;
              v18 = 2LL;
            }
            goto LABEL_22;
          case 3:
            v31 = 3LL;
            LODWORD(v26) = OSMetaClassBase::safeMetaCast(a1, IO80211Interface::metaClass);
            if ( v26 )
            {
              v16 = (char *)a1 + 480;
              v18 = 3LL;
            }
            else
            {
              v16 = (char *)a1 + 256;
              v18 = 3LL;
            }
            goto LABEL_22;
          default:
            break;
        }
      }
      v31 = 0LL;
      LODWORD(v15) = OSMetaClassBase::safeMetaCast(a1, IO80211Interface::metaClass);
      if ( v15 )
        v16 = (char *)a1 + 440;
      else
        v16 = (char *)a1 + 240;
      v18 = 0LL;
LABEL_22:
      v13 = *(_QWORD *)v16;
      if ( *(_QWORD *)v16 )
        goto LABEL_55;
LABEL_23:
      if ( v8 )
      {
        v19 = v8 & 0x38;
        if ( v19 != 8 && v19 != 16 )
        {
          v23 = v8 & 0x30;
          if ( v23 == 48 )
          {
            v31 = 3LL;
            v20 = IO80211Interface::metaClass;
            LODWORD(v24) = OSMetaClassBase::safeMetaCast(a1, IO80211Interface::metaClass);
            if ( v24 )
            {
              v22 = (char *)a1 + 480;
              v18 = 3LL;
            }
            else
            {
              v22 = (char *)a1 + 256;
              v18 = 3LL;
            }
          }
          else if ( v23 == 32 )
          {
            v31 = 2LL;
            v20 = IO80211Interface::metaClass;
            LODWORD(v27) = OSMetaClassBase::safeMetaCast(a1, IO80211Interface::metaClass);
            if ( v27 )
            {
              v22 = (char *)a1 + 488;
              v18 = 2LL;
            }
            else
            {
              v22 = (char *)a1 + 264;
              v18 = 2LL;
            }
          }
          else
          {
            v31 = 0LL;
            v20 = IO80211Interface::metaClass;
            LODWORD(v28) = OSMetaClassBase::safeMetaCast(a1, IO80211Interface::metaClass);
            if ( v28 )
              v22 = (char *)a1 + 440;
            else
              v22 = (char *)a1 + 240;
            v18 = 0LL;
          }
        }
        else
        {
          v20 = IO80211Interface::metaClass;
          v31 = 1LL;
          LODWORD(v21) = OSMetaClassBase::safeMetaCast(a1, IO80211Interface::metaClass);
          if ( v21 )
          {
            v22 = (char *)a1 + 472;
            v18 = 1LL;
          }
          else
          {
            v22 = (char *)a1 + 248;
            v18 = 1LL;
          }
        }
        v13 = *(_QWORD *)v22;
        if ( *(_QWORD *)v22 )
          goto LABEL_55;
      }
      else
      {
        v20 = IO80211Interface::metaClass;
      }
      v31 = 0LL;
      LODWORD(v29) = OSMetaClassBase::safeMetaCast(a1, v20);
      if ( v29 )
        v13 = *((_QWORD *)a1 + 55);
      else
        v13 = *((_QWORD *)a1 + 30);
      v18 = 0LL;
    }
LABEL_55:
    mbuf_pkthdr_setrcvif(v32, v18, v12);
    v4 = 0;
    (*(void (__fastcall **)(__int64, __mbuf *, _QWORD))(*(_QWORD *)v13 + 360LL))(v13, v32, 0LL);
    return (unsigned int)v4;
  }
  LODWORD(v6) = mbuf_len(v32);
  if ( v6 > 0x21 || (v4 = 22, !mbuf_pullup(&v32, 34LL)) )
  {
    LODWORD(v7) = mbuf_data(v32);
    v8 = *(_BYTE *)(v7 + 15) >> 2;
    goto LABEL_13;
  }
  return (unsigned int)v4;
}
// 7F790: using guessed type _QWORD IO80211Interface::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C30: using guessed type int __fastcall mbuf_get_traffic_class(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C88: using guessed type int __fastcall mbuf_pkthdr_setrcvif(_QWORD, _QWORD, _QWORD);
// C8C90: using guessed type int __fastcall mbuf_pullup(_QWORD, _QWORD);

//----- (000000000005A5C0) ----------------------------------------------------
int __fastcall IO80211ConfigureBPFOutputQueue(__int64 a1, int a2, __int64 a3)
{
  __int64 v3; // rbx@1
  int result; // eax@2

  v3 = a3;
  if ( a2 )
  {
    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)a3 + 336LL))(a3, 32LL);
    result = (*(int (__fastcall **)(__int64))(*(_QWORD *)v3 + 304LL))(v3);
  }
  else
  {
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a3 + 312LL))(a3);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 328LL))(v3);
    result = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v3 + 336LL))(v3, 0LL);
  }
  return result;
}

//----- (000000000005A61F) ----------------------------------------------------
__int64 __fastcall IO80211BPFNodeForDLT(int a1, __int64 a2)
{
  __int64 v2; // rcx@1
  __int64 result; // rax@1

  v2 = *(_QWORD *)a2;
  result = 0LL;
  if ( *(_QWORD *)a2 )
  {
    result = 0LL;
    while ( *(_DWORD *)(v2 + 16) != a1 )
    {
      v2 = *(_QWORD *)v2;
      if ( !v2 )
        return result;
    }
    result = v2;
  }
  return result;
}

//----- (000000000005A643) ----------------------------------------------------
void __fastcall IO80211BPFListFree(__int64 a1)
{
  __int64 v1; // r14@1
  __int64 v2; // rbx@3
  __int64 v3; // rax@4
  __int64 v4; // rdi@6

  v1 = a1;
  while ( 1 )
  {
    v2 = *(_QWORD *)v1;
    if ( !*(_QWORD *)v1 )
      break;
    v3 = *(_QWORD *)v2;
    if ( *(_QWORD *)v2 )
      *(_QWORD *)(v3 + 8) = *(_QWORD *)(v2 + 8);
    **(_QWORD **)(v2 + 8) = v3;
    v4 = *(_QWORD *)(v2 + 24);
    if ( v4 )
      (*(void (**)(void))(*(_QWORD *)v4 + 40LL))();
    IOFree(v2, 64LL);
  }
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (000000000005A691) ----------------------------------------------------
int __fastcall IO80211BPFNodeFree(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdi@1

  v1 = a1;
  v2 = *(_QWORD *)(a1 + 24);
  if ( v2 )
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
  return IOFree(v1, 64LL);
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (000000000005A6BC) ----------------------------------------------------
__int64 __usercall IO80211AllocBPFNode@<rax>(__int64 a1@<rdx>, __int64 a2@<rcx>, int a3@<edi>, __int64 a4@<rsi>, __int64 a5@<r8>, __int64 a6, __int64 a7)
{
  __int64 v7; // r12@1
  __int64 v8; // r13@1
  __int64 v9; // r14@1
  __int64 v10; // rax@1
  __int64 v11; // rbx@1
  __int64 v12; // rax@2

  v7 = a5;
  v8 = a2;
  v9 = a1;
  LODWORD(v10) = IOMalloc(64LL);
  v11 = v10;
  if ( v10 )
  {
    LODWORD(v12) = IOGatedOutputQueue::withTarget(a4, v9, v8, v7, 0LL);
    *(_QWORD *)(v11 + 24) = v12;
    if ( v12 )
    {
      *(_QWORD *)(v11 + 32) = a4;
      *(_QWORD *)(v11 + 48) = a7;
      *(_QWORD *)(v11 + 40) = a6;
      *(_DWORD *)(v11 + 16) = a3;
      *(_DWORD *)(v11 + 56) = 0;
    }
    else
    {
      IOFree(v11, 64LL);
      v11 = 0LL;
    }
  }
  return v11;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// C7B08: using guessed type int __fastcall IOGatedOutputQueue::withTarget(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005A75F) ----------------------------------------------------
__int64 __fastcall IO80211BpfTap(__ifnet *a1, int a2, int a3)
{
  int v3; // er14@1
  __int64 v4; // rax@1
  __int64 v5; // rbx@1
  __int64 v6; // rax@1
  signed __int64 v7; // rcx@1
  signed __int64 v8; // rbx@1
  __int64 v9; // rbx@3
  __int64 v10; // rax@3
  __int64 v11; // rdx@3
  signed int v12; // ecx@3

  v3 = a3;
  LODWORD(v4) = ifnet_softc(a1);
  v5 = v4;
  LODWORD(v6) = OSMetaClassBase::safeMetaCast(v4, IO80211Interface::metaClass);
  v7 = v5 + 576;
  v8 = v5 + 328;
  if ( v6 )
    v8 = v7;
  v9 = *(_QWORD *)v8;
  LODWORD(v10) = IOMalloc(8LL);
  v12 = 12;
  if ( v10 )
  {
    *(_DWORD *)v10 = a2;
    *(_DWORD *)(v10 + 4) = v3;
    thread_call_enter1(v9, v10, v11, 12LL);
    v12 = 0;
  }
  return (unsigned int)v12;
}
// 7F790: using guessed type _QWORD IO80211Interface::metaClass;
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// C8B90: using guessed type int __fastcall ifnet_softc(_QWORD);
// C8DC8: using guessed type int __fastcall thread_call_enter1(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005A7D6) ----------------------------------------------------
int __fastcall IO80211AllocateBpfTapThreadCall(OSObject *a1)
{
  return thread_call_allocate(_bpfTapCallbackThread, a1);
}
// C8DB0: using guessed type int __fastcall thread_call_allocate(_QWORD, _QWORD);

//----- (000000000005A7ED) ----------------------------------------------------
int __fastcall _bpfTapCallbackThread(IO80211VirtualInterface *this, void *a2)
{
  __int64 v2; // rax@1
  __int64 v3; // rax@2

  LODWORD(v2) = OSMetaClassBase::safeMetaCast(this, IO80211Interface::metaClass);
  if ( v2 )
    v3 = IO80211Interface::getController(this);
  else
    v3 = IO80211VirtualInterface::getController(this);
  (*(void (__fastcall **)(__int64, IO80211VirtualInterface *, __int64 (__fastcall *)(IO80211Interface *, void *, void *, void *, void *), IO80211VirtualInterface *, void *, _QWORD))(*(_QWORD *)v3 + 2128LL))(
    v3,
    this,
    _bpfTapCallbackGated,
    this,
    a2,
    0LL);
  return IOFree(a2, 8LL);
}
// 7F790: using guessed type _QWORD IO80211Interface::metaClass;
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000005A867) ----------------------------------------------------
__int64 __fastcall _bpfTapCallbackGated(IO80211Interface *this, void *a2, void *a3, void *a4, void *a5)
{
  __int64 v5; // rax@1

  LODWORD(v5) = OSMetaClassBase::safeMetaCast(this, IO80211Interface::metaClass);
  if ( v5 )
    IO80211Interface::bpfTap(this, *(_DWORD *)a2, *((_DWORD *)a2 + 1));
  else
    IO80211VirtualInterface::bpfTap(this, *(_DWORD *)a2, *((_DWORD *)a2 + 1));
  return 0LL;
}
// 7F790: using guessed type _QWORD IO80211Interface::metaClass;
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000005A8AB) ----------------------------------------------------
__int64 __fastcall sha256_vector(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r12@1
  __int64 v5; // rbx@1
  __int64 v6; // r13@1
  __int64 v7; // rax@1
  __int64 v8; // r15@1
  char *v9; // r14@1
  __int64 result; // rax@3
  __int64 v11; // [sp+0h] [bp-40h]@1
  __int64 v12; // [sp+8h] [bp-38h]@1
  __int64 v13; // [sp+10h] [bp-30h]@1

  v12 = a4;
  v4 = a3;
  v5 = a2;
  v6 = a1;
  v13 = *(_QWORD *)off_7B078[0];
  LODWORD(v7) = ccsha256_di();
  v8 = v7;
  v9 = (char *)&v11
     - ((((*(_QWORD *)(v7 + 8) + *(_QWORD *)(v7 + 16) + 19LL) & 0xFFFFFFFFFFFFFFF8LL) + 15) & 0xFFFFFFFFFFFFFFF0LL);
  ccdigest_init(v7, v9);
  if ( a1 )
  {
    do
    {
      ccdigest_update(v8, v9, *(_QWORD *)v4, *(_QWORD *)v5);
      v5 += 8LL;
      v4 += 8LL;
      --v6;
    }
    while ( v6 );
  }
  (*(void (__fastcall **)(__int64, char *, __int64))(v8 + 56))(v8, v9, v12);
  cc_clear(*(_QWORD *)(v8 + 8) + *(_QWORD *)(v8 + 16) + 12LL, v9);
  result = *(_QWORD *)off_7B078[0];
  if ( *(_QWORD *)off_7B078[0] == v13 )
    result = 0LL;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C89F8: using guessed type int __fastcall cc_clear(_QWORD, _QWORD);
// C8A00: using guessed type int __fastcall ccdigest_init(_QWORD, _QWORD);
// C8A08: using guessed type int __fastcall ccdigest_update(_QWORD, _QWORD, _QWORD, _QWORD);
// C8A10: using guessed type int ccsha256_di(void);

//----- (000000000005A980) ----------------------------------------------------
__int64 __fastcall IO80211NetBootNub::MetaClass::MetaClass(IO80211NetBootNub::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211NetBootNub", off_7B040[0], 160LL);
  result = (__int64)off_80D70;
  *(_QWORD *)this = off_80D70;
  return result;
}
// 7B040: using guessed type _QWORD off_7B040[14];
// 80D70: using guessed type __int64 (__fastcall *off_80D70[2])(IO80211NetBootNub::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005A9B2) ----------------------------------------------------
__int64 __fastcall IO80211NetBootNub::MetaClass::~MetaClass(IO80211NetBootNub::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000005A9BC) ----------------------------------------------------
__int64 __fastcall IO80211NetBootNub::IO80211NetBootNub(__int64 a1)
{
  __int64 result; // rax@1

  IOService::IOService(a1);
  result = (__int64)off_80500;
  *(_QWORD *)a1 = off_80500;
  return result;
}
// 80500: using guessed type __int64 (__fastcall *off_80500[2])(IO80211NetBootNub *__hidden this);
// C85F8: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (000000000005A9DC) ----------------------------------------------------
__int64 __fastcall IO80211NetBootNub::IO80211NetBootNub(__int64 a1)
{
  __int64 result; // rax@1

  IOService::IOService(a1);
  result = (__int64)off_80500;
  *(_QWORD *)a1 = off_80500;
  return result;
}
// 80500: using guessed type __int64 (__fastcall *off_80500[2])(IO80211NetBootNub *__hidden this);
// C85F8: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (000000000005A9FC) ----------------------------------------------------
__int64 __fastcall IO80211NetBootNub::~IO80211NetBootNub(IO80211NetBootNub *this)
{
  return IOService::~IOService(this);
}

//----- (000000000005AA06) ----------------------------------------------------
__int64 __fastcall IO80211NetBootNub::~IO80211NetBootNub(IO80211NetBootNub *this)
{
  return IOService::~IOService(this);
}

//----- (000000000005AA10) ----------------------------------------------------
void __fastcall IO80211NetBootNub::~IO80211NetBootNub(IO80211NetBootNub *this)
{
  IOService::~IOService(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000005AA32) ----------------------------------------------------
__int64 __fastcall IO80211NetBootNub::getMetaClass(IO80211NetBootNub *this)
{
  return (__int64)&IO80211NetBootNub::gMetaClass;
}
// 84610: using guessed type _QWORD IO80211NetBootNub::gMetaClass;

//----- (000000000005AA40) ----------------------------------------------------
__int64 __fastcall IO80211NetBootNub::MetaClass::MetaClass(IO80211NetBootNub::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211NetBootNub", off_7B040[0], 160LL);
  result = (__int64)off_80D70;
  *(_QWORD *)this = off_80D70;
  return result;
}
// 7B040: using guessed type _QWORD off_7B040[14];
// 80D70: using guessed type __int64 (__fastcall *off_80D70[2])(IO80211NetBootNub::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005AA72) ----------------------------------------------------
__int64 __fastcall IO80211NetBootNub::MetaClass::alloc(IO80211NetBootNub::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_68.reloff, a2);
  IOService::IOService(v2);
  *(_QWORD *)v2 = off_80500;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211NetBootNub::gMetaClass);
  return v2;
}
// 68: using guessed type section_64;
// 80500: using guessed type __int64 (__fastcall *off_80500[2])(IO80211NetBootNub *__hidden this);
// 84610: using guessed type _QWORD IO80211NetBootNub::gMetaClass;
// C85F8: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (000000000005AAB2) ----------------------------------------------------
__int64 __fastcall IO80211NetBootNub::IO80211NetBootNub(__int64 a1)
{
  IOService::IOService(a1);
  *(_QWORD *)a1 = off_80500;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211NetBootNub::gMetaClass);
}
// 80500: using guessed type __int64 (__fastcall *off_80500[2])(IO80211NetBootNub *__hidden this);
// 84610: using guessed type _QWORD IO80211NetBootNub::gMetaClass;
// C85F8: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (000000000005AAE2) ----------------------------------------------------
__int64 __fastcall IO80211NetBootNub::IO80211NetBootNub(__int64 a1)
{
  IOService::IOService(a1);
  *(_QWORD *)a1 = off_80500;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211NetBootNub::gMetaClass);
}
// 80500: using guessed type __int64 (__fastcall *off_80500[2])(IO80211NetBootNub *__hidden this);
// 84610: using guessed type _QWORD IO80211NetBootNub::gMetaClass;
// C85F8: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (000000000005AB12) ----------------------------------------------------
__int64 __fastcall IO80211NetBootNub::nubWithControllerAndInterface(IO80211NetBootNub *this, IO80211Controller *a2, IO80211Interface *a3, IOService *a4)
{
  IO80211Interface *v4; // r14@1
  IO80211Controller *v5; // r15@1
  __int64 v6; // rbx@1
  _QWORD *v7; // rsi@1

  v4 = a3;
  v5 = a2;
  v6 = OSObject::operator new((OSObject *)&stru_68.reloff, (unsigned __int64)a2);
  v7 = &IO80211NetBootNub::gMetaClass;
  IOService::IOService(v6);
  *(_QWORD *)v6 = off_80500;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211NetBootNub::gMetaClass);
  if ( v6 )
  {
    if ( !this
      || !v5
      || !v4
      || (*(_QWORD *)(v6 + 136) = this,
          *(_QWORD *)(v6 + 144) = v5,
          *(_QWORD *)(v6 + 152) = v4,
          v7 = 0LL,
          !(unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD))(off_7B070[0] + 600))(v6, 0LL)) )
    {
      (*(void (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v6 + 40LL))(v6, v7);
      v6 = 0LL;
    }
  }
  return v6;
}
// 68: using guessed type section_64 stru_68;
// 7B070: using guessed type __int64 off_7B070[8];
// 80500: using guessed type __int64 (__fastcall *off_80500[2])(IO80211NetBootNub *__hidden this);
// 84610: using guessed type _QWORD IO80211NetBootNub::gMetaClass;
// C85F8: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (000000000005ABB6) ----------------------------------------------------
int __fastcall IO80211NetBootNub::initWithControllerAndInterface(IO80211NetBootNub *this, IO80211Controller *a2, IO80211Interface *a3, IOService *a4)
{
  int result; // eax@1

  result = 0;
  if ( a2 && a3 )
  {
    if ( a4 )
    {
      *((_QWORD *)this + 17) = a2;
      *((_QWORD *)this + 18) = a3;
      *((_QWORD *)this + 19) = a4;
      result = (*(int (__fastcall **)(IO80211NetBootNub *, _QWORD))(off_7B070[0] + 600))(this, 0LL);
    }
  }
  return result;
}
// 7B070: using guessed type __int64 off_7B070[8];

//----- (000000000005ABF2) ----------------------------------------------------
char __fastcall IO80211NetBootNub::start(IO80211NetBootNub *this, IOService *a2)
{
  char result; // al@2

  if ( (unsigned __int8)(*(int (__fastcall **)(IO80211NetBootNub *, IOService *))(off_7B070[0] + 1488))(this, a2) )
  {
    (*(void (__fastcall **)(IO80211NetBootNub *, signed __int64))(*(_QWORD *)this + 1456LL))(this, 2LL);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 7B070: using guessed type __int64 off_7B070[8];

//----- (000000000005AC2A) ----------------------------------------------------
int __fastcall IO80211NetBootNub::getWorkLoop(IO80211NetBootNub *this)
{
  return (*(int (**)(void))(**((_QWORD **)this + 17) + 1672LL))();
}

//----- (000000000005AC40) ----------------------------------------------------
__int64 __fastcall IO80211NetBootNub::associate(__int64 a1, __int64 a2)
{
  int v2; // ebx@1
  unsigned int v3; // eax@2
  signed int v4; // ecx@3
  __int64 v6; // [sp+8h] [bp-28h]@5

  v2 = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, _QWORD, __int64))(**(_QWORD **)(a1 + 136) + 3216LL))(
         *(_QWORD *)(a1 + 136),
         2150132168LL,
         20LL,
         *(_QWORD *)(a1 + 144),
         a2);
  if ( !v2 )
  {
    v3 = *(_WORD *)(a2 + 8);
    if ( v3 > 8
      || (v4 = 278, !_bittest((const unsigned int *)&v4, v3))
      || !(unsigned __int8)(*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(a1 + 136) + 3256LL))(
                             *(_QWORD *)(a1 + 136),
                             *(_QWORD *)(a1 + 144))
      || (io80211_get_calendar_time((__int64)&v6),
          IO80211Interface::setAuthTimeout(*(IO80211Interface **)(a1 + 144), v6 + 15),
          v2 = 6,
          IO80211Interface::initSupplicant(*(IO80211Interface **)(a1 + 144), (unsigned __int8 *)(a2 + 206), 1u))
      && (*(_DWORD *)(a2 + 64) != 6
       || IO80211Interface::setPMK(*(IO80211Interface **)(a1 + 144), (unsigned __int8 *)(a2 + 72))) )
      v2 = 0;
  }
  return (unsigned int)v2;
}

//----- (000000000005AD20) ----------------------------------------------------
int __fastcall IO80211NetBootNub::disassociate(IO80211NetBootNub *this)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 17) + 3216LL))(
           *((_QWORD *)this + 17),
           2150132168LL,
           22LL,
           *((_QWORD *)this + 18),
           0LL);
}

//----- (000000000005AD50) ----------------------------------------------------
__int64 __fastcall IO80211NetBootNub::associationResult(__int64 a1, __int64 a2)
{
  return IO80211Controller::getASSOCIATE_RESULT(*(_QWORD *)(a1 + 136), *(IO80211Interface **)(a1 + 144), 0LL, a2);
}

//----- (000000000005AD74) ----------------------------------------------------
int __fastcall IO80211NetBootNub::enableInterface(IO80211NetBootNub *this)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 17) + 2480LL))(
           *((_QWORD *)this + 17),
           *((_QWORD *)this + 18));
}

//----- (000000000005AD96) ----------------------------------------------------
__int64 __fastcall IO80211NetBootNub::MetaClass::~MetaClass(IO80211NetBootNub::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000005ADA0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_15()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IO80211NetBootNub::gMetaClass, "IO80211NetBootNub", off_7B040[0], 160LL);
  result = (__int64)off_80D70;
  IO80211NetBootNub::gMetaClass = off_80D70;
  return result;
}
// 7B040: using guessed type _QWORD off_7B040[14];
// 80D70: using guessed type __int64 (__fastcall *off_80D70[2])(IO80211NetBootNub::MetaClass *__hidden this);
// 84610: using guessed type _QWORD IO80211NetBootNub::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005ADE0) ----------------------------------------------------
__int64 `global destructor keyed to'_a_15()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211NetBootNub::gMetaClass);
}
// 84610: using guessed type _QWORD IO80211NetBootNub::gMetaClass;

//----- (000000000005AE00) ----------------------------------------------------
__int64 __fastcall IO80211PacketDescriptor::MetaClass::MetaClass(IO80211PacketDescriptor::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211PacketDescriptor", &IO80211QueueDescriptor::gMetaClass, 88LL);
  result = (__int64)off_80FC0;
  *(_QWORD *)this = off_80FC0;
  return result;
}
// 80FC0: using guessed type __int64 (__fastcall *off_80FC0[2])(IO80211PacketDescriptor::MetaClass *__hidden this);
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005AE32) ----------------------------------------------------
__int64 __fastcall IO80211PacketDescriptor::MetaClass::~MetaClass(IO80211PacketDescriptor::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000005AE3C) ----------------------------------------------------
__int64 __fastcall IO80211PacketDescriptor::IO80211PacketDescriptor(__int64 a1)
{
  __int64 result; // rax@1

  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  result = (__int64)off_80E70;
  *(_QWORD *)a1 = off_80E70;
  return result;
}
// 80E70: using guessed type __int64 (__fastcall *off_80E70[2])(IO80211PacketDescriptor *__hidden this);

//----- (000000000005AE5C) ----------------------------------------------------
__int64 __fastcall IO80211PacketDescriptor::IO80211PacketDescriptor(__int64 a1)
{
  __int64 result; // rax@1

  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  result = (__int64)off_80E70;
  *(_QWORD *)a1 = off_80E70;
  return result;
}
// 80E70: using guessed type __int64 (__fastcall *off_80E70[2])(IO80211PacketDescriptor *__hidden this);

//----- (000000000005AE7C) ----------------------------------------------------
__int64 __fastcall IO80211PacketDescriptor::~IO80211PacketDescriptor(IO80211PacketDescriptor *this)
{
  return IO80211QueueDescriptor::~IO80211QueueDescriptor(this);
}

//----- (000000000005AE86) ----------------------------------------------------
__int64 __fastcall IO80211PacketDescriptor::~IO80211PacketDescriptor(IO80211PacketDescriptor *this)
{
  return IO80211QueueDescriptor::~IO80211QueueDescriptor(this);
}

//----- (000000000005AE90) ----------------------------------------------------
void __fastcall IO80211PacketDescriptor::~IO80211PacketDescriptor(IO80211PacketDescriptor *this)
{
  IO80211QueueDescriptor::~IO80211QueueDescriptor(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000005AEB2) ----------------------------------------------------
__int64 __fastcall IO80211PacketDescriptor::getMetaClass(IO80211PacketDescriptor *this)
{
  return (__int64)&IO80211PacketDescriptor::gMetaClass;
}
// 84638: using guessed type _QWORD IO80211PacketDescriptor::gMetaClass;

//----- (000000000005AEC0) ----------------------------------------------------
__int64 __fastcall IO80211PacketDescriptor::MetaClass::MetaClass(IO80211PacketDescriptor::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211PacketDescriptor", &IO80211QueueDescriptor::gMetaClass, 88LL);
  result = (__int64)off_80FC0;
  *(_QWORD *)this = off_80FC0;
  return result;
}
// 80FC0: using guessed type __int64 (__fastcall *off_80FC0[2])(IO80211PacketDescriptor::MetaClass *__hidden this);
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005AEF2) ----------------------------------------------------
__int64 __fastcall IO80211PacketDescriptor::MetaClass::alloc(IO80211PacketDescriptor::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20.maxprot, a2);
  IO80211QueueDescriptor::IO80211QueueDescriptor(v2);
  *(_QWORD *)v2 = off_80E70;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211PacketDescriptor::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 80E70: using guessed type __int64 (__fastcall *off_80E70[2])(IO80211PacketDescriptor *__hidden this);
// 84638: using guessed type _QWORD IO80211PacketDescriptor::gMetaClass;

//----- (000000000005AF32) ----------------------------------------------------
__int64 __fastcall IO80211PacketDescriptor::IO80211PacketDescriptor(__int64 a1)
{
  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  *(_QWORD *)a1 = off_80E70;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211PacketDescriptor::gMetaClass);
}
// 80E70: using guessed type __int64 (__fastcall *off_80E70[2])(IO80211PacketDescriptor *__hidden this);
// 84638: using guessed type _QWORD IO80211PacketDescriptor::gMetaClass;

//----- (000000000005AF62) ----------------------------------------------------
__int64 __fastcall IO80211PacketDescriptor::IO80211PacketDescriptor(__int64 a1)
{
  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  *(_QWORD *)a1 = off_80E70;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211PacketDescriptor::gMetaClass);
}
// 80E70: using guessed type __int64 (__fastcall *off_80E70[2])(IO80211PacketDescriptor *__hidden this);
// 84638: using guessed type _QWORD IO80211PacketDescriptor::gMetaClass;

//----- (000000000005AF92) ----------------------------------------------------
char __fastcall IO80211PacketDescriptor::init(IO80211PacketDescriptor *this, char a2)
{
  char result; // al@2

  if ( (unsigned __int8)((int (*)(void))`vtable for'IO80211QueueDescriptor[19])() )
  {
    *((_QWORD *)this + 4) = 0LL;
    *((_BYTE *)this + 41) = 0;
    *((_WORD *)this + 24) = 0;
    *((_DWORD *)this + 13) = 0;
    *((_WORD *)this + 28) = 0;
    *((_WORD *)this + 30) = 0;
    *((_QWORD *)this + 8) = 0LL;
    *((_QWORD *)this + 9) = 0LL;
    *((_DWORD *)this + 20) = 0;
    *((_WORD *)this + 29) = -1;
    *((_BYTE *)this + 12) = 0;
    *((_BYTE *)this + 40) = a2;
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 822A0: using guessed type __int64 `vtable for'IO80211QueueDescriptor[2];

//----- (000000000005B006) ----------------------------------------------------
int __fastcall IO80211PacketDescriptor::freeResources(IO80211PacketDescriptor *this)
{
  IO80211PacketDescriptor *v1; // rbx@1
  __int64 v2; // rdi@1
  int result; // eax@3

  v1 = this;
  v2 = *((_QWORD *)this + 4);
  if ( v2 && !(*((_BYTE *)v1 + 48) & 1) )
    result = mbuf_freem(v2);
  *((_QWORD *)v1 + 4) = 0LL;
  *((_BYTE *)v1 + 41) = 0;
  *((_WORD *)v1 + 24) = 0;
  *((_DWORD *)v1 + 13) = 0;
  *((_WORD *)v1 + 28) = 0;
  *((_WORD *)v1 + 30) = 0;
  *((_QWORD *)v1 + 8) = 0LL;
  *((_QWORD *)v1 + 9) = 0LL;
  *((_DWORD *)v1 + 20) = 0;
  *((_WORD *)v1 + 29) = -1;
  *((_BYTE *)v1 + 12) = 0;
  return result;
}
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);

//----- (000000000005B070) ----------------------------------------------------
__int64 __fastcall IO80211PacketDescriptor::print(__int64 a1, __int64 a2)
{
  __int64 v2; // ST80_8@1
  unsigned int v3; // ST8C_4@1
  unsigned int v4; // ST7C_4@1
  int v5; // ST78_4@1
  int v6; // ST74_4@1
  int v7; // ST70_4@1
  int v8; // ST6C_4@1
  int v9; // ST68_4@1
  int v10; // ST64_4@1
  int v11; // ST60_4@1
  int v12; // er12@1
  __int64 v13; // r14@1
  unsigned __int64 v14; // r14@1
  __int64 v15; // r15@1
  int v16; // ST50_4@1

  v2 = *(_QWORD *)(a1 + 32);
  v3 = *(_BYTE *)(a1 + 40);
  v4 = *(_DWORD *)(a1 + 52);
  v5 = *(_DWORD *)(a1 + 44);
  v6 = *(_WORD *)(a1 + 56);
  v7 = *(_WORD *)(a1 + 58);
  v8 = *(_WORD *)(a1 + 48);
  v9 = *(_WORD *)(a1 + 60);
  v10 = *(_BYTE *)(a1 + 41);
  v11 = *(_BYTE *)(a1 + 42);
  v12 = *(_BYTE *)(a1 + 43);
  v13 = *(_QWORD *)(a1 + 72);
  v14 = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v13)) >> 64) >> 18;
  v15 = *(_QWORD *)(a1 + 64);
  getAbsoluteTime();
  v16 = *(_DWORD *)(a1 + 80);
  _userPrint(
    a2,
    "      %p: m=%p ac=%u tag=%x pid=%u txseq=%u d11=%u flg=0x%x pflg=0x%x supr=%u hdr: llc=%u drv=%u time: Q=%u(ms) Tx=%u(ms) txs=0x%x\n",
    a1,
    v2,
    v3,
    v4,
    v5);
  return 0LL;
}

//----- (000000000005B182) ----------------------------------------------------
__int64 __fastcall IO80211PacketDescriptor::MetaClass::~MetaClass(IO80211PacketDescriptor::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000005B190) ----------------------------------------------------
__int64 `global constructor keyed to'_a_16()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(
    &IO80211PacketDescriptor::gMetaClass,
    "IO80211PacketDescriptor",
    &IO80211QueueDescriptor::gMetaClass,
    88LL);
  result = (__int64)off_80FC0;
  IO80211PacketDescriptor::gMetaClass = off_80FC0;
  return result;
}
// 80FC0: using guessed type __int64 (__fastcall *off_80FC0[2])(IO80211PacketDescriptor::MetaClass *__hidden this);
// 84638: using guessed type _QWORD IO80211PacketDescriptor::gMetaClass;
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005B1D0) ----------------------------------------------------
__int64 `global destructor keyed to'_a_16()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211PacketDescriptor::gMetaClass);
}
// 84638: using guessed type _QWORD IO80211PacketDescriptor::gMetaClass;

//----- (000000000005B1F0) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::MetaClass::MetaClass(IO80211ScanManager::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211ScanManager", off_7B030[0], 136LL);
  result = (__int64)off_811F0;
  *(_QWORD *)this = off_811F0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 811F0: using guessed type __int64 (__fastcall *off_811F0[2])(IO80211ScanManager::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005B222) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::MetaClass::~MetaClass(IO80211ScanManager::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000005B22C) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::IO80211ScanManager(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_810C0;
  *(_QWORD *)a1 = off_810C0;
  return result;
}
// 810C0: using guessed type __int64 (__fastcall *off_810C0[2])(IO80211ScanManager *__hidden this);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000005B24C) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::IO80211ScanManager(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_810C0;
  *(_QWORD *)a1 = off_810C0;
  return result;
}
// 810C0: using guessed type __int64 (__fastcall *off_810C0[2])(IO80211ScanManager *__hidden this);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000005B26C) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::~IO80211ScanManager(IO80211ScanManager *this)
{
  return OSObject::~OSObject(this);
}

//----- (000000000005B276) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::~IO80211ScanManager(IO80211ScanManager *this)
{
  return OSObject::~OSObject(this);
}

//----- (000000000005B280) ----------------------------------------------------
void __fastcall IO80211ScanManager::~IO80211ScanManager(IO80211ScanManager *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000005B2A2) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::getMetaClass(IO80211ScanManager *this)
{
  return (__int64)&IO80211ScanManager::gMetaClass;
}
// 84660: using guessed type _QWORD IO80211ScanManager::gMetaClass;

//----- (000000000005B2B0) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::MetaClass::MetaClass(IO80211ScanManager::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211ScanManager", off_7B030[0], 136LL);
  result = (__int64)off_811F0;
  *(_QWORD *)this = off_811F0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 811F0: using guessed type __int64 (__fastcall *off_811F0[2])(IO80211ScanManager::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005B2E2) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::MetaClass::alloc(IO80211ScanManager::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_68.addr, a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_810C0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211ScanManager::gMetaClass);
  return v2;
}
// 68: using guessed type section_64 stru_68;
// 810C0: using guessed type __int64 (__fastcall *off_810C0[2])(IO80211ScanManager *__hidden this);
// 84660: using guessed type _QWORD IO80211ScanManager::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000005B322) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::IO80211ScanManager(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_810C0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211ScanManager::gMetaClass);
}
// 810C0: using guessed type __int64 (__fastcall *off_810C0[2])(IO80211ScanManager *__hidden this);
// 84660: using guessed type _QWORD IO80211ScanManager::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000005B352) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::IO80211ScanManager(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_810C0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211ScanManager::gMetaClass);
}
// 810C0: using guessed type __int64 (__fastcall *off_810C0[2])(IO80211ScanManager *__hidden this);
// 84660: using guessed type _QWORD IO80211ScanManager::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000005B382) ----------------------------------------------------
char *__fastcall IO80211ScanManager::makeSSID(IO80211ScanManager *this, unsigned __int8 *a2, size_t a3)
{
  size_t v3; // rbx@1

  v3 = a3;
  if ( a3 > 0x20 )
  {
    *((_BYTE *)this + 44) = 0;
  }
  else
  {
    memcpy((char *)this + 44, a2, a3);
    *((_BYTE *)this + v3 + 44) = 0;
  }
  return (char *)this + 44;
}

//----- (000000000005B3C2) ----------------------------------------------------
int __fastcall IO80211ScanManager::initWithControllerAndInterface(IO80211ScanManager *this, IO80211Controller *a2, IO80211Interface *a3)
{
  IO80211Interface *v3; // r14@1
  __int64 v4; // r12@1
  int result; // eax@1
  __int64 v6; // rax@3
  __int64 v7; // rax@4
  __int64 v8; // rcx@10
  __int64 v9; // [sp+8h] [bp-38h]@5
  int v10; // [sp+10h] [bp-30h]@5
  __int64 v11; // [sp+18h] [bp-28h]@1

  v3 = a3;
  v4 = off_7B078[0];
  v11 = *(_QWORD *)off_7B078[0];
  result = 0;
  if ( a2 && a3 )
  {
    LODWORD(v6) = (*(int (__fastcall **)(IO80211Controller *))(*(_QWORD *)a2 + 1672LL))(a2);
    *((_QWORD *)this + 12) = v6;
    if ( v6
      && (LODWORD(v7) = IOTimerEventSource::timerEventSource(this, IO80211ScanManager::cachePurgeTimeout),
          (*((_QWORD *)this + 13) = v7) != 0LL) )
    {
      (*(void (__fastcall **)(_QWORD, int (__fastcall *)(IO80211ScanManager *)))(**((_QWORD **)this + 12) + 32LL))(
        *((_QWORD *)this + 12),
        IO80211ScanManager::cachePurgeTimeout);
      (*(void (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 12) + 320LL))(
        *((_QWORD *)this + 12),
        *((_QWORD *)this + 13));
      *((_QWORD *)this + 10) = a2;
      *((_QWORD *)this + 11) = v3;
      *((_DWORD *)this + 8) = 30;
      v10 = 0;
      v9 = 1LL;
      if ( !(*(int (__fastcall **)(IO80211Controller *, signed __int64, signed __int64, IO80211Interface *, __int64 *))(*(_QWORD *)a2 + 3216LL))(
              a2,
              3223873993LL,
              12LL,
              v3,
              &v9)
        && BYTE6(v9) & 0x40 )
        *((_BYTE *)this + 112) = 1;
      result = (*(int (__fastcall **)(IO80211ScanManager *))(off_7B068[0] + 152))(this);
    }
    else
    {
      result = 0;
    }
  }
  v8 = *(_QWORD *)v4;
  return result;
}
// 7B068: using guessed type __int64 off_7B068[9];
// 7B078: using guessed type __int64 off_7B078[7];
// C7C78: using guessed type int __fastcall IOTimerEventSource::timerEventSource(_QWORD, _QWORD);

//----- (000000000005B4CA) ----------------------------------------------------
int __fastcall IO80211ScanManager::cachePurgeTimeout(IO80211ScanManager *a1)
{
  return IO80211ScanManager::cachePurge(a1, 0LL);
}

//----- (000000000005B4D6) ----------------------------------------------------
int __fastcall IO80211ScanManager::free(IO80211ScanManager *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  IO80211ScanManager *v6; // rbx@1
  __int64 v7; // rdi@1
  signed __int64 v8; // r14@2
  __int64 v9; // rcx@6
  __int64 v10; // rdi@7
  __int64 v11; // rax@8
  __int64 v12; // rcx@10
  __int64 v13; // rdi@11
  __int64 v14; // rax@12

  v6 = this;
  v7 = *((_QWORD *)this + 13);
  if ( v7 )
  {
    (*(void (**)(void))(*(_QWORD *)v7 + 536LL))();
    v8 = (signed __int64)((char *)v6 + 96);
    a2 = *((_QWORD *)v6 + 13);
    (*(void (__fastcall **)(_QWORD, __int64))(**((_QWORD **)v6 + 12) + 328LL))(*((_QWORD *)v6 + 12), a2);
    (*(void (**)(void))(**((_QWORD **)v6 + 13) + 40LL))();
  }
  else
  {
    v8 = (signed __int64)((char *)v6 + 96);
  }
  if ( *(_QWORD *)v8 )
    (*(void (**)(void))(**(_QWORD **)v8 + 40LL))();
  while ( 1 )
  {
    v10 = *((_QWORD *)v6 + 2);
    if ( !v10 )
      break;
    v11 = *(_QWORD *)v10;
    if ( *(_QWORD *)v10 )
      *(_QWORD *)(v11 + 8) = *(_QWORD *)(v10 + 8);
    v9 = *(_QWORD *)(v10 + 8);
    *(_QWORD *)v9 = v11;
    _releaseReqNode(v10, a2, a3, v9, a5, a6);
  }
  while ( 1 )
  {
    v13 = *((_QWORD *)v6 + 3);
    if ( !v13 )
      break;
    v14 = *(_QWORD *)v13;
    if ( *(_QWORD *)v13 )
      *(_QWORD *)(v14 + 8) = *(_QWORD *)(v13 + 8);
    v12 = *(_QWORD *)(v13 + 8);
    *(_QWORD *)v12 = v14;
    --*(_DWORD *)(v13 + 16);
    _releaseCacheNode(v13, a2, a3, v12, a5, a6);
  }
  return (*(int (__fastcall **)(IO80211ScanManager *))(off_7B068[0] + 160))(v6);
}
// 7B068: using guessed type __int64 off_7B068[9];

//----- (000000000005B58C) ----------------------------------------------------
int __fastcall _releaseReqNode(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // r14@1
  __int64 v7; // rdi@3
  __int64 v8; // rax@4
  __int64 v9; // rbx@7
  __int64 v10; // rax@8
  __int64 v11; // rcx@10
  __int64 v12; // rdi@10
  bool v13; // zf@10

  v6 = a1;
  while ( 1 )
  {
    v7 = *(_QWORD *)(v6 + 4752);
    if ( !v7 )
      break;
    v8 = *(_QWORD *)v7;
    if ( *(_QWORD *)v7 )
      *(_QWORD *)(v8 + 8) = *(_QWORD *)(v7 + 8);
    **(_QWORD **)(v7 + 8) = v8;
    a2 = 32LL;
    IOFree(v7, 32LL);
  }
  while ( 1 )
  {
    v9 = *(_QWORD *)(v6 + 4744);
    if ( !v9 )
      break;
    v10 = *(_QWORD *)v9;
    if ( *(_QWORD *)v9 )
      *(_QWORD *)(v10 + 8) = *(_QWORD *)(v9 + 8);
    v11 = *(_QWORD *)(v9 + 8);
    *(_QWORD *)v11 = v10;
    v12 = *(_QWORD *)(v9 + 16);
    v13 = (*(_DWORD *)(v12 + 16))-- == 1;
    if ( v13 )
      _releaseCacheNode(v12, a2, a3, v11, a5, a6);
    a2 = 24LL;
    IOFree(v9, 24LL);
  }
  return IOFree(v6, 4760LL);
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (000000000005B618) ----------------------------------------------------
int __fastcall _releaseCacheNode(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // rdx@1

  v6 = *(_DWORD *)(a1 + 16);
  if ( (_DWORD)v6 )
    IOLog("%s: Error, releasing cache node with refCnt = %u\n", "_releaseCacheNode", v6, a4, a5, a6);
  if ( *(_WORD *)(a1 + 162) )
    IOFree(*(_QWORD *)(a1 + 168), *(_WORD *)(a1 + 162));
  return IOFree(a1, 192LL);
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005B668) ----------------------------------------------------
signed __int64 __fastcall IO80211ScanManager::getCachedScanResults(__int64 a1, __int64 a2, __int64 a3, const void *a4, unsigned int a5)
{
  const void *v5; // r15@1
  __int64 v6; // rbx@1
  __int64 v7; // r14@1
  __int64 v8; // r12@1
  signed __int64 result; // rax@1
  const void *v10; // rbx@5
  __int64 v11; // r13@5
  int v12; // ecx@8
  __int16 v13; // ax@9
  unsigned int v14; // er12@16
  const void *v15; // rbx@16
  bool v16; // zf@19
  size_t v17; // rdx@20
  int v18; // eax@23
  unsigned int v19; // eax@34
  unsigned int v20; // ecx@35
  signed __int64 v21; // rsi@35
  __int64 v22; // rax@39
  __int64 v23; // rcx@39
  __int64 v24; // rax@40
  signed __int64 v25; // [sp+0h] [bp-80h]@6
  const void *v26; // [sp+8h] [bp-78h]@6
  signed __int64 v27; // [sp+10h] [bp-70h]@6
  signed __int64 v28; // [sp+18h] [bp-68h]@5
  __int64 v29; // [sp+20h] [bp-60h]@4
  __int64 v30; // [sp+28h] [bp-58h]@16
  bool v31; // [sp+3Fh] [bp-41h]@6
  int v32; // [sp+40h] [bp-40h]@5
  unsigned int v33; // [sp+44h] [bp-3Ch]@1
  int v34; // [sp+48h] [bp-38h]@1

  v33 = a5;
  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = a1;
  io80211_get_calendar_time((__int64)&v34);
  result = 22LL;
  if ( (unsigned int)(*(_DWORD *)(a2 + 4) - 1) <= 2
    && *(_DWORD *)(a2 + 16) <= 0x20u
    && (unsigned int)(*(_DWORD *)(a2 + 52) - 1) <= 2 )
  {
    v29 = v6;
    if ( *(_DWORD *)(a2 + 68) <= 0x80u )
    {
      v10 = (const void *)(a2 + 8);
      v28 = a2 + 8;
      v32 = memcmp(
              (const void *)(a2 + 8),
              &IO80211ScanManager::getCachedScanResults(apple80211_scan_data *,apple80211scan_req_node *,ether_addr *,unsigned int)::emptyEA,
              6uLL);
      v11 = *(_QWORD *)(a1 + 24);
      if ( v11 )
      {
        v31 = v5 != 0LL && v33 != 0;
        v27 = v29 + 4744;
        v26 = (const void *)(a2 + 20);
        v25 = a2 + 76;
        do
        {
          if ( (unsigned int)(v34 - *(_DWORD *)(v11 + 184)) < *(_DWORD *)(v8 + 32) )
          {
            v12 = *(_DWORD *)(v7 + 4);
            if ( v12 == 3 )
              goto LABEL_13;
            v13 = *(_WORD *)(v11 + 50) & 1;
            if ( v12 == 2 )
            {
              if ( v13 )
                goto LABEL_13;
            }
            else if ( !v13 )
            {
LABEL_13:
              if ( !v32 || !memcmp((const void *)(v11 + 52), v10, 6uLL) )
              {
                if ( !v31 )
                  goto LABEL_47;
                v30 = v8;
                v14 = 0;
                v15 = v5;
                do
                {
                  if ( !memcmp((const void *)(v11 + 52), v5, 6uLL) )
                    break;
                  ++v14;
                  v5 = (char *)v5 + 6;
                }
                while ( v14 < v33 );
                v16 = v14 == v33;
                v5 = v15;
                v8 = v30;
                v10 = (const void *)v28;
                if ( !v16 )
                {
LABEL_47:
                  v17 = *(_DWORD *)(v7 + 16);
                  if ( !*(_DWORD *)(v7 + 16)
                    || (_DWORD)v17 == *(_BYTE *)(v11 + 120) && !memcmp(v26, (const void *)(v11 + 121), v17) )
                  {
                    if ( (v18 = *(_DWORD *)(v7 + 56), v18 == 1)
                      || v18 & 2 && *(_BYTE *)(v11 + 176) & 2
                      || v18 & 4 && *(_BYTE *)(v11 + 176) & 4
                      || v18 & 8 && *(_BYTE *)(v11 + 176) & 8
                      || v18 & 0x10 && *(_BYTE *)(v11 + 176) & 0x10
                      || v18 & 0x80 && *(_BYTE *)(v11 + 176) & 0x80 )
                    {
                      v19 = *(_DWORD *)(v7 + 68);
                      if ( !v19 )
                        goto LABEL_48;
                      v20 = 0;
                      v21 = v25;
                      do
                      {
                        if ( *(_DWORD *)v21 == *(_DWORD *)(v11 + 32) )
                          break;
                        ++v20;
                        v21 += 12LL;
                      }
                      while ( v20 < v19 );
                      if ( v20 != v19 )
                      {
LABEL_48:
                        LODWORD(v22) = IOMalloc(24LL);
                        v23 = v22;
                        result = 12LL;
                        if ( !v23 )
                          return result;
                        *(_QWORD *)(v23 + 16) = v11;
                        ++*(_DWORD *)(v11 + 16);
                        v24 = *(_QWORD *)v27;
                        *(_QWORD *)v23 = *(_QWORD *)v27;
                        if ( v24 )
                          *(_QWORD *)(v24 + 8) = v23;
                        *(_QWORD *)v27 = v23;
                        *(_QWORD *)(v23 + 8) = v27;
                      }
                    }
                  }
                }
              }
              goto LABEL_43;
            }
          }
LABEL_43:
          v11 = *(_QWORD *)v11;
        }
        while ( v11 );
      }
      *(_QWORD *)(*(_QWORD *)(v29 + 4752) + 24LL) = *(_QWORD *)(v29 + 4744);
      result = 0LL;
    }
  }
  return result;
}
// 7AE5C: using guessed type int IO80211ScanManager::getCachedScanResults(apple80211_scan_data *,apple80211scan_req_node *,ether_addr *,unsigned int)::emptyEA;
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000005B8F2) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::fastScan(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // rax@1
  __int64 v7; // r12@1
  signed int v8; // ebx@1
  __int64 v9; // rdx@2
  __int64 v10; // rcx@2
  __int64 v11; // r8@2
  __int64 v12; // r9@2
  __int64 v13; // rax@4
  signed __int64 v14; // r14@4

  v6 = (__int64)_allocScanReqNode((const void *)a2, 0LL, a3, a4, a5, a6);
  v7 = v6;
  v8 = 12;
  if ( v6 )
  {
    v8 = IO80211ScanManager::getCachedScanResults(a1, a2, v6, 0LL, 0);
    if ( v8 )
    {
      _releaseReqNode(v7, a2, v9, v10, v11, v12);
    }
    else
    {
      v13 = *(_QWORD *)(a1 + 16);
      v14 = a1 + 16;
      *(_QWORD *)v7 = v13;
      if ( v13 )
        *(_QWORD *)(v13 + 8) = v7;
      *(_QWORD *)v14 = v7;
      *(_QWORD *)(v7 + 8) = v14;
      v8 = 0;
    }
  }
  return (unsigned int)v8;
}

//----- (000000000005B967) ----------------------------------------------------
void *__fastcall _allocScanReqNode(const void *a1, const void *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  int v6; // er14@1
  const void *v7; // r12@1
  __int64 v8; // rdi@3
  void *v9; // rax@4
  void *v10; // rbx@4
  signed __int64 v11; // rdi@6
  size_t v12; // rdx@6
  __int64 v13; // rax@10
  __int64 v14; // rdx@11

  v6 = a3;
  v7 = a1;
  if ( !a2 && !a1 )
  {
    v8 = (__int64)"_allocScanReqNode: called w/o input %u\n";
LABEL_8:
    v10 = 0LL;
    IOLog(v8, 4760LL, a3, a4, a5, a6);
    return v10;
  }
  LODWORD(v9) = IOMalloc(4760LL);
  v10 = v9;
  if ( !v9 )
  {
    v8 = (__int64)"_allocScanReqNode:can't allocate apple80211scan_req_node %u\n";
    goto LABEL_8;
  }
  bzero(v9, 0x1298uLL);
  if ( a1 )
  {
    v11 = (signed __int64)((char *)v10 + 16);
    v12 = 2388LL;
    a2 = v7;
  }
  else
  {
    v11 = (signed __int64)((char *)v10 + 2404);
    v12 = 2312LL;
  }
  memcpy((void *)v11, a2, v12);
  io80211_get_calendar_time((__int64)((char *)v10 + 4720));
  *((_BYTE *)v10 + 4736) = 0;
  *((_QWORD *)v10 + 593) = 0LL;
  *((_QWORD *)v10 + 594) = 0LL;
  LODWORD(v13) = IOMalloc(32LL);
  if ( v13 )
  {
    *(_DWORD *)(v13 + 16) = v6;
    *(_QWORD *)(v13 + 24) = 0LL;
    v14 = *((_QWORD *)v10 + 594);
    *(_QWORD *)v13 = v14;
    if ( v14 )
      *(_QWORD *)(v14 + 8) = v13;
    *((_QWORD *)v10 + 594) = v13;
    *(_QWORD *)(v13 + 8) = (char *)v10 + 4752;
  }
  else
  {
    IOFree(v10, 4760LL);
    v10 = 0LL;
  }
  return v10;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000005BA70) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::searchForPendingAndClearPid(IO80211ScanManager *this, unsigned int a2)
{
  __int64 v2; // rax@1
  __int64 v3; // r14@1
  __int64 i; // rbx@2
  __int64 v5; // rax@5
  __int64 v6; // rcx@7
  __int64 v7; // r13@9
  __int64 v8; // r15@9
  IO80211Interface *v9; // rdi@20
  __int64 v10; // rdx@21
  __int64 v11; // rcx@21
  __int64 v12; // r8@21
  __int64 v13; // r9@21
  __int64 v14; // rdx@22
  __int64 v15; // rcx@22
  __int64 v16; // r8@22
  __int64 v17; // r9@22
  __int64 v18; // rax@23
  __int64 v19; // rdx@25
  __int64 v20; // r8@25
  __int64 v21; // r9@25
  char v23; // [sp+0h] [bp-40h]@0
  IO80211ScanManager *v24; // [sp+8h] [bp-38h]@1
  __int64 v25; // [sp+10h] [bp-30h]@20

  v24 = this;
  v2 = *((_QWORD *)this + 2);
  v3 = 0LL;
  if ( v2 )
  {
    i = 0LL;
    v3 = 0LL;
    do
    {
      v7 = v2;
      v2 = *(_QWORD *)v2;
      v8 = v3;
      if ( *(_BYTE *)(v7 + 4736) )
        v8 = v7;
      if ( i )
      {
        v3 = v8;
      }
      else
      {
        for ( i = *(_QWORD *)(v7 + 4752); ; i = *(_QWORD *)i )
        {
          if ( !i )
          {
            v3 = v8;
            i = 0LL;
            goto LABEL_28;
          }
          if ( *(_DWORD *)(i + 16) == a2 )
            break;
        }
        v25 = v2;
        v9 = (IO80211Interface *)*((_QWORD *)v24 + 11);
        if ( v9 && IO80211Interface::debugFlags(v9) & 8 )
        {
          IOLog("IO80211ScanManager::startScan: pid %d had pending scan request. Deleting.\n", a2, v10, v11, v12, v13);
          IO8Log(
            "IO80211ScanManager::startScan: pid %d had pending scan request. Deleting.\n",
            a2,
            v14,
            v15,
            v16,
            v17,
            v23);
        }
        v18 = *(_QWORD *)i;
        if ( *(_QWORD *)i )
          *(_QWORD *)(v18 + 8) = *(_QWORD *)(i + 8);
        **(_QWORD **)(i + 8) = v18;
        IOFree(i, 32LL);
        if ( *(_QWORD *)(v7 + 4752) )
        {
          v3 = v8;
        }
        else
        {
          v3 = 0LL;
          if ( v7 != v8 )
            v3 = v8;
          v5 = *(_QWORD *)v7;
          if ( *(_QWORD *)v7 )
            *(_QWORD *)(v5 + 8) = *(_QWORD *)(v7 + 8);
          v6 = *(_QWORD *)(v7 + 8);
          *(_QWORD *)v6 = v5;
          _releaseReqNode(v7, 32LL, v19, v6, v20, v21);
        }
        v2 = v25;
      }
      if ( v3 && i )
        break;
LABEL_28:
      ;
    }
    while ( v2 );
  }
  return v3;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005BBB4) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::fastScanMultiple(__int64 a1, __int64 a2, unsigned int a3)
{
  unsigned int v3; // er14@1
  __int64 v4; // r15@1
  __int64 v5; // rbx@1
  __int64 v6; // rcx@1
  __int64 v7; // r8@1
  __int64 v8; // r9@1
  void *v9; // rax@1
  signed int v10; // er12@1
  __int64 v11; // rsi@2
  __int64 v12; // rcx@2
  __int64 v13; // r8@2
  __int64 v14; // r9@2
  unsigned int v15; // er14@3
  unsigned __int64 v16; // rdx@4
  unsigned int v17; // ebx@9
  __int64 v18; // rax@12
  signed __int64 v19; // rcx@12
  __int64 result; // rax@16
  __int64 v21; // [sp+8h] [bp-998h]@2
  int v22; // [sp+18h] [bp-988h]@1
  int v23; // [sp+1Ch] [bp-984h]@2
  char v24; // [sp+20h] [bp-980h]@10
  int v25; // [sp+28h] [bp-978h]@5
  char v26; // [sp+2Ch] [bp-974h]@5
  int v27; // [sp+4Ch] [bp-954h]@2
  int v28; // [sp+50h] [bp-950h]@2
  int v29; // [sp+5Ch] [bp-944h]@2
  char v30; // [sp+60h] [bp-940h]@2
  __int64 v31; // [sp+970h] [bp-30h]@1

  v3 = a3;
  v4 = a2;
  v5 = off_7B078[0];
  v31 = *(_QWORD *)off_7B078[0];
  __bzero(&v22, 2388LL);
  v22 = 1;
  v9 = _allocScanReqNode(0LL, (const void *)a2, v3, v6, v7, v8);
  v10 = 12;
  if ( !v9 )
    goto LABEL_16;
  v21 = (__int64)v9;
  v23 = *(_DWORD *)(a2 + 4);
  v29 = *(_DWORD *)(a2 + 768);
  v11 = a2 + 772;
  memcpy(&v30, (const void *)(v4 + 772), 0x600uLL);
  v28 = *(_DWORD *)(v4 + 756);
  v23 = *(_DWORD *)(v4 + 4);
  v27 = *(_DWORD *)(v4 + 752);
  if ( *(_DWORD *)(v4 + 8) )
  {
    v15 = 0;
    while ( 1 )
    {
      v16 = *(_DWORD *)(v4 + 40LL * v15 + 16);
      v10 = 22;
      if ( v16 > 0x20 )
        break;
      v25 = *(_DWORD *)(v4 + 40LL * v15 + 16);
      memcpy(&v26, (const void *)(v4 + 40LL * v15 + 20), v16);
      v11 = (__int64)&v22;
      v10 = IO80211ScanManager::getCachedScanResults(
              a1,
              (__int64)&v22,
              v21,
              (const void *)(v4 + 656),
              *(_DWORD *)(v4 + 652));
      if ( v10 )
        break;
      ++v15;
      if ( v15 >= *(_DWORD *)(v4 + 8) )
        goto LABEL_12;
    }
LABEL_15:
    _releaseReqNode(v21, v11, v16, v12, v13, v14);
    v5 = off_7B078[0];
    goto LABEL_16;
  }
  if ( *(_DWORD *)(v4 + 652) )
  {
    v17 = 0;
    do
    {
      memcpy(&v24, (const void *)(v4 + 6LL * v17 + 656), 6uLL);
      v11 = (__int64)&v22;
      v10 = IO80211ScanManager::getCachedScanResults(a1, (__int64)&v22, v21, 0LL, 0);
      if ( v10 )
        goto LABEL_15;
      ++v17;
    }
    while ( v17 < *(_DWORD *)(v4 + 652) );
  }
LABEL_12:
  v18 = *(_QWORD *)(a1 + 16);
  v19 = a1 + 16;
  *(_QWORD *)v21 = v18;
  v5 = off_7B078[0];
  if ( v18 )
    *(_QWORD *)(v18 + 8) = v21;
  *(_QWORD *)v19 = v21;
  *(_QWORD *)(v21 + 8) = v19;
  v10 = 0;
LABEL_16:
  result = *(_QWORD *)v5;
  if ( *(_QWORD *)v5 == v31 )
    result = (unsigned int)v10;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C8988: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (000000000005BDC4) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::startScanMultiple(IO80211ScanManager *this, void *a2)
{
  __int64 v2; // r14@1
  IO80211ScanManager *v3; // rbx@1
  __int64 v4; // r13@1
  __int64 v5; // rsi@1
  signed __int64 v6; // rcx@1
  char *v7; // rdi@1
  IO80211Interface *v8; // rdi@4
  __int64 v9; // r12@4
  __int64 v10; // r9@5
  __int64 v11; // r9@6
  signed int v12; // ecx@7
  __int64 v13; // r15@9
  __int64 v14; // rax@9
  __int64 v15; // rsi@10
  __int64 v16; // rax@10
  IO80211Interface *v17; // rdi@15
  __int64 v18; // rdx@16
  __int64 v19; // rcx@16
  __int64 v20; // r8@16
  __int64 v21; // r9@16
  __int64 v22; // r8@21
  __int64 v23; // r9@21
  __int64 v24; // rsi@22
  __int64 v25; // rdx@22
  __int64 v26; // r8@22
  __int64 v27; // r9@22
  __int64 v28; // rax@23
  __int64 v29; // rcx@25
  IO80211Interface *v30; // rdi@25
  __int64 v31; // rdx@27
  __int64 v32; // rcx@27
  __int64 v33; // r8@27
  __int64 v34; // r9@27
  __int64 v35; // r15@30
  IO80211Interface *v36; // rdi@31
  __int64 v37; // rdx@32
  __int64 v38; // rcx@32
  __int64 v39; // r8@32
  __int64 v40; // r9@32
  __int64 v41; // rdx@33
  __int64 v42; // rcx@33
  __int64 v43; // r8@33
  __int64 v44; // r9@33
  __int64 v45; // rsi@34
  int v46; // eax@34
  __int64 v47; // rdx@34
  __int64 v48; // rcx@34
  __int64 v49; // r8@34
  __int64 v50; // r9@34
  IO80211Interface *v51; // rdi@35
  __int64 v52; // rax@37
  __int64 v53; // r8@37
  __int64 v54; // r9@37
  __int64 v55; // rax@37
  __int64 v56; // r8@37
  __int64 v57; // r9@37
  IO80211Interface *v58; // rdi@39
  __int64 v59; // rdx@42
  __int64 v60; // rcx@42
  __int64 v61; // r8@42
  __int64 v62; // r9@42
  int v64; // eax@46
  IO80211Interface *v65; // rdi@47
  __int64 v66; // rdx@48
  __int64 v67; // rcx@48
  __int64 v68; // r8@48
  __int64 v69; // r9@48
  __int64 v70; // rdx@49
  __int64 v71; // rcx@49
  __int64 v72; // r8@49
  __int64 v73; // r9@49
  __int64 v74; // rax@50
  __int64 v75; // rcx@51
  __int64 v76; // rax@54
  __int64 v77; // rax@54
  char v78; // [sp+0h] [bp-E0h]@0
  int v79; // [sp+Ch] [bp-D4h]@4
  unsigned __int64 v80; // [sp+10h] [bp-D0h]@22
  __int64 v81; // [sp+20h] [bp-C0h]@21
  __int64 v82; // [sp+28h] [bp-B8h]@54
  char v83; // [sp+30h] [bp-B0h]@1
  __int64 v84; // [sp+B0h] [bp-30h]@1

  v2 = (__int64)a2;
  v3 = this;
  v84 = *(_QWORD *)off_7B078[0];
  v4 = (unsigned int)proc_selfpid(this, a2);
  v5 = (__int64)"<unknown>";
  v6 = 16LL;
  v7 = &v83;
  while ( v6 )
  {
    *(_QWORD *)v7 = *(_QWORD *)v5;
    v5 += 8LL;
    v7 += 8;
    --v6;
  }
  v79 = *(_DWORD *)(v2 + 752);
  proc_selfname(&v83, 128LL);
  v8 = (IO80211Interface *)*((_QWORD *)v3 + 11);
  v9 = (__int64)v3;
  if ( v8 && IO80211Interface::debugFlags(v8) & 8 )
  {
    v3 = (IO80211ScanManager *)(unsigned int)v4;
    IOLog(
      "IO80211ScanManager::startScanMultiple: Scan request received from '%s' (pid %d) (%u SSIDs, %u BSSIDs).\n",
      &v83,
      (unsigned int)v4,
      *(_DWORD *)(v2 + 8),
      *(_DWORD *)(v2 + 652),
      v10);
    v4 = (unsigned int)v3;
    IO8Log(
      "IO80211ScanManager::startScanMultiple: Scan request received from '%s' (pid %d) (%u SSIDs, %u BSSIDs).\n",
      (__int64)&v83,
      (unsigned int)v3,
      *(_DWORD *)(v2 + 8),
      *(_DWORD *)(v2 + 652),
      v11,
      v78);
  }
  v12 = 22;
  if ( *(_DWORD *)(v2 + 8) <= 0x10u )
  {
    v3 = (IO80211ScanManager *)(unsigned int)v4;
    if ( *(_DWORD *)(v2 + 652) <= 0x10u )
    {
      v13 = v9;
      v14 = *(_QWORD *)(*(_QWORD *)(v9 + 80) + 336LL);
      LODWORD(v9) = v79;
      if ( v14 )
      {
        v15 = IO80211AWDLPeerManager::metaClass;
        LODWORD(v16) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(v14 + 144), IO80211AWDLPeerManager::metaClass);
        if ( v16 )
        {
          if ( (*(_DWORD *)(v16 + 4976) == 4 || !*(_BYTE *)(v16 + 1512))
            && IO80211AWDLPeerManager::realTimeDataModeRequired((IO80211AWDLPeerManager *)v16)
            && v79 != 3 )
          {
            v17 = *(IO80211Interface **)(v13 + 88);
            v12 = 16;
            if ( !v17 )
              goto LABEL_44;
            if ( !(IO80211Interface::debugFlags(v17) & 8) )
              goto LABEL_43;
            v3 = (IO80211ScanManager *)"IO80211ScanManager::startScan AWDL returning EBUSY\n";
LABEL_42:
            IOLog(v3, v15, v18, v19, v20, v21);
            IO8Log((const char *)v3, v15, v59, v60, v61, v62, v78);
LABEL_43:
            v12 = 16;
            goto LABEL_44;
          }
        }
      }
      v15 = (unsigned int)v4;
      v4 = IO80211ScanManager::searchForPendingAndClearPid((IO80211ScanManager *)v13, v4);
      if ( v79 == 3 )
      {
        v12 = IO80211ScanManager::fastScanMultiple(v13, v2, (unsigned int)v3);
        goto LABEL_44;
      }
      LODWORD(v9) = (_DWORD)v3;
      if ( !IO80211ScanManager::isOpModeScanFriendly((IO80211ScanManager *)v13) )
      {
        v58 = *(IO80211Interface **)(v13 + 88);
        v12 = 16;
        if ( !v58 )
          goto LABEL_44;
        if ( !(IO80211Interface::debugFlags(v58) & 8) )
          goto LABEL_43;
        v3 = (IO80211ScanManager *)"IO80211ScanManager::startScanMultiple: Rejecting scan request because of interface's operational mode.\n";
        goto LABEL_42;
      }
      v3 = (IO80211ScanManager *)v13;
      io80211_get_calendar_time((__int64)&v81);
      if ( v4 )
      {
        v24 = v4 + 4720;
        timespecSub((__int64)&v81, v4 + 4720, (__int64)&v80);
        if ( v80 < 0xB )
          goto LABEL_46;
        v28 = *(_QWORD *)v4;
        if ( *(_QWORD *)v4 )
          *(_QWORD *)(v28 + 8) = *(_QWORD *)(v4 + 8);
        v29 = *(_QWORD *)(v4 + 8);
        *(_QWORD *)v29 = v28;
        v30 = *(IO80211Interface **)(v13 + 88);
        if ( v30 && IO80211Interface::debugFlags(v30) & 8 )
        {
          IOLog(
            "IO80211ScanManager::startScanMultiple: Found timed out scan request. Deleting.\n",
            v24,
            v25,
            v29,
            v26,
            v27);
          IO8Log(
            "IO80211ScanManager::startScanMultiple: Found timed out scan request. Deleting.\n",
            v24,
            v31,
            v32,
            v33,
            v34,
            v78);
        }
        _releaseReqNode(v4, v24, v25, v29, v26, v27);
      }
      v12 = 102;
      if ( *(_BYTE *)(v13 + 112) )
      {
        v35 = (__int64)_allocScanReqNode(0LL, (const void *)v2, (unsigned int)v9, 102LL, v22, v23);
        v12 = 12;
        if ( v35 )
        {
          v36 = (IO80211Interface *)*((_QWORD *)v3 + 11);
          if ( v36 && IO80211Interface::debugFlags(v36) & 8 )
          {
            v9 = (__int64)"IO80211ScanManager::startScanMultiple: Initiating scan.\n";
            IOLog("IO80211ScanManager::startScanMultiple: Initiating scan.\n", v2, v37, v38, v39, v40);
            IO8Log("IO80211ScanManager::startScanMultiple: Initiating scan.\n", v2, v41, v42, v43, v44, v78);
          }
          v45 = 2150132168LL;
          v46 = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, _QWORD, __int64))(**((_QWORD **)v3 + 10)
                                                                                               + 3216LL))(
                  *((_QWORD *)v3 + 10),
                  2150132168LL,
                  86LL,
                  *((_QWORD *)v3 + 11),
                  v2);
          if ( v46 )
          {
            v2 = (unsigned int)v46;
            v51 = (IO80211Interface *)*((_QWORD *)v3 + 11);
            if ( v51 && IO80211Interface::debugFlags(v51) & 8 )
            {
              LODWORD(v9) = v2;
              LODWORD(v52) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)v3 + 10) + 1920LL))(
                               *((_QWORD *)v3 + 10),
                               (unsigned int)v2);
              IOLog(
                "IO80211ScanManager::startScanMultiple: Scan request failed (%d, %s)!\n",
                (unsigned int)v2,
                v52,
                v52,
                v53,
                v54);
              LODWORD(v55) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)v3 + 10) + 1920LL))(
                               *((_QWORD *)v3 + 10),
                               (unsigned int)v2);
              v45 = (unsigned int)v2;
              v2 = (unsigned int)v2;
              IO8Log(
                "IO80211ScanManager::startScanMultiple: Scan request failed (%d, %s)!\n",
                (unsigned int)v2,
                v55,
                v55,
                v56,
                v57,
                v78);
            }
            _releaseReqNode(v35, v45, v47, v48, v49, v50);
            v12 = v2;
          }
          else
          {
            *(_BYTE *)(v35 + 4736) = 1;
            v76 = v81;
            *(_QWORD *)(v35 + 4728) = v82;
            *(_QWORD *)(v35 + 4720) = v76;
            v77 = *((_QWORD *)v3 + 2);
            v3 = (IO80211ScanManager *)((char *)v3 + 16);
            *(_QWORD *)v35 = v77;
            if ( v77 )
              *(_QWORD *)(v77 + 8) = v35;
            *(_QWORD *)v3 = v35;
            *(_QWORD *)(v35 + 8) = v3;
            v12 = 0;
          }
        }
      }
    }
  }
LABEL_44:
  while ( *(_QWORD *)off_7B078[0] != v84 )
  {
LABEL_46:
    v64 = memcmp((const void *)(v4 + 2404), (const void *)v2, 0x908uLL);
    v12 = 16;
    if ( !v64 )
    {
      v65 = (IO80211Interface *)*((_QWORD *)v3 + 11);
      if ( v65 && IO80211Interface::debugFlags(v65) & 8 )
      {
        v3 = (IO80211ScanManager *)"IO80211ScanManager::startScanMultiple: Found pending scan with identical parameters.\n";
        IOLog(
          "IO80211ScanManager::startScanMultiple: Found pending scan with identical parameters.\n",
          v2,
          v66,
          v67,
          v68,
          v69);
        IO8Log(
          "IO80211ScanManager::startScanMultiple: Found pending scan with identical parameters.\n",
          v2,
          v70,
          v71,
          v72,
          v73,
          v78);
      }
      LODWORD(v74) = IOMalloc(32LL);
      v12 = 12;
      if ( v74 )
      {
        *(_DWORD *)(v74 + 16) = v9;
        v75 = *(_QWORD *)(v4 + 4752);
        v4 += 4752LL;
        *(_QWORD *)v74 = v75;
        if ( v75 )
          *(_QWORD *)(v75 + 8) = v74;
        *(_QWORD *)v4 = v74;
        *(_QWORD *)(v74 + 8) = v4;
        v12 = 0;
      }
    }
  }
  return (unsigned int)v12;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// C8D18: using guessed type int __fastcall proc_selfname(_QWORD, _QWORD);
// C8D20: using guessed type int __fastcall proc_selfpid(_QWORD, _QWORD);

//----- (000000000005C218) ----------------------------------------------------
bool __fastcall IO80211ScanManager::isOpModeScanFriendly(IO80211ScanManager *this)
{
  bool result; // al@2
  __int64 v2; // [sp+8h] [bp-8h]@1

  v2 = 1LL;
  if ( (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, _QWORD, __int64 *))(**((_QWORD **)this + 10)
                                                                                        + 3216LL))(
         *((_QWORD *)this + 10),
         3223873993LL,
         15LL,
         *((_QWORD *)this + 11),
         &v2) )
    result = 1;
  else
    result = (BYTE4(v2) & 0x18) == 0;
  return result;
}

//----- (000000000005C260) ----------------------------------------------------
bool __fastcall IO80211ScanManager::isBroadcastScanRequest(__int64 a1, __int64 a2)
{
  bool result; // al@4
  char v3; // [sp+Ah] [bp-16h]@1

  bzero(&v3, 6uLL);
  if ( memcmp((const void *)(a2 + 8), &v3, 6uLL) || *(_DWORD *)(a2 + 16) || *(_DWORD *)(a2 + 68) )
    result = 0;
  else
    result = *(_DWORD *)(a2 + 1616) == 0;
  return result;
}

//----- (000000000005C2B8) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::startScan(IO80211ScanManager *this, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // r14@1
  __int64 v4; // r15@1
  int v5; // er12@1
  __int64 v6; // rsi@1
  signed __int64 v7; // rcx@1
  char *v8; // rdi@1
  int v9; // ebx@4
  IO80211Interface *v10; // rdi@4
  __int64 v11; // r9@5
  __int64 v12; // rbx@6
  size_t v13; // r14@6
  __int64 v14; // r13@6
  __int64 v15; // r15@6
  void *v16; // r12@8
  __int64 v17; // r9@11
  unsigned __int64 v18; // rbx@11
  __int64 v19; // r8@16
  __int64 v20; // rsi@17
  __int64 v21; // rcx@17
  __int64 v22; // r8@17
  __int64 v23; // r9@17
  __int64 v24; // r13@17
  __int64 v25; // rax@17
  __int64 v26; // rax@18
  IO80211Interface *v27; // rdi@23
  signed int v28; // ebx@23
  __int64 v29; // rdx@24
  __int64 v30; // rcx@24
  __int64 v31; // r8@24
  __int64 v32; // r9@24
  const char *v33; // r14@25
  __int64 v34; // rcx@28
  __int64 v35; // r8@28
  __int64 v36; // r9@28
  __int64 v37; // rsi@30
  __int64 v38; // rdx@30
  __int64 v39; // r8@30
  __int64 v40; // r9@30
  __int64 v41; // rax@31
  __int64 v42; // rcx@33
  IO80211Interface *v43; // rdi@33
  __int64 v44; // rdx@35
  __int64 v45; // rcx@35
  __int64 v46; // r8@35
  __int64 v47; // r9@35
  __int64 v48; // r13@37
  IO80211Interface *v49; // rdi@37
  __int64 v50; // rdx@39
  __int64 v51; // rcx@39
  __int64 v52; // r8@39
  __int64 v53; // r9@39
  __int64 v54; // rdx@40
  __int64 v55; // rcx@40
  __int64 v56; // r8@40
  __int64 v57; // r9@40
  __int64 v58; // rdi@41
  int v59; // eax@41
  __int64 v60; // rsi@42
  __int64 v61; // rdx@42
  __int64 v62; // rcx@42
  __int64 v63; // r8@42
  __int64 v64; // r9@42
  IO80211Interface *v65; // rdi@42
  __int64 v66; // rdx@44
  __int64 v67; // rcx@44
  __int64 v68; // r8@44
  __int64 v69; // r9@44
  IO80211Interface *v70; // rdi@46
  __int64 v71; // rdx@49
  __int64 v72; // rcx@49
  __int64 v73; // r8@49
  __int64 v74; // r9@49
  IO80211Interface *v75; // rdi@51
  __int64 v76; // rdx@52
  __int64 v77; // rcx@52
  __int64 v78; // r8@52
  __int64 v79; // r9@52
  __int64 v80; // rdx@53
  __int64 v81; // rcx@53
  __int64 v82; // r8@53
  __int64 v83; // r9@53
  __int64 v84; // rax@54
  __int64 v85; // rcx@55
  signed __int64 v86; // r13@55
  __int64 v87; // r8@59
  __int64 v88; // r9@59
  __int64 v89; // r8@60
  __int64 v90; // r9@60
  __int64 v91; // rax@61
  signed __int64 v92; // rax@61
  __int64 v93; // rcx@61
  __int64 result; // rax@65
  char v95; // [sp+0h] [bp-F0h]@0
  const void *v96; // [sp+8h] [bp-E8h]@9
  int v97; // [sp+10h] [bp-E0h]@6
  int v98; // [sp+14h] [bp-DCh]@6
  __int64 v99; // [sp+18h] [bp-D8h]@1
  unsigned __int64 v100; // [sp+20h] [bp-D0h]@30
  __int64 v101; // [sp+30h] [bp-C0h]@4
  __int64 v102; // [sp+38h] [bp-B8h]@61
  char v103; // [sp+40h] [bp-B0h]@1
  __int64 v104; // [sp+C0h] [bp-30h]@1

  v2 = a2;
  v99 = a2;
  v3 = (__int64)this;
  v4 = off_7B078[0];
  v104 = *(_QWORD *)off_7B078[0];
  v5 = proc_selfpid(this, a2);
  v6 = (__int64)"<unknown>";
  v7 = 16LL;
  v8 = &v103;
  while ( v7 )
  {
    *(_QWORD *)v8 = *(_QWORD *)v6;
    v6 += 8LL;
    v8 += 8;
    --v7;
  }
  io80211_get_calendar_time((__int64)&v101);
  v9 = *(_DWORD *)(v2 + 52);
  proc_selfname(&v103, 128LL);
  v10 = *(IO80211Interface **)(v3 + 88);
  if ( v10 && IO80211Interface::debugFlags(v10) & 8 )
  {
    v97 = v9;
    v98 = v5;
    v12 = v3;
    v13 = *(_DWORD *)(v99 + 16);
    v14 = (__int64)"Broadcast";
    v15 = (__int64)"Broadcast";
    if ( *(_DWORD *)(v99 + 16) )
      v15 = (__int64)"Directed";
    v16 = (void *)(v12 + 44);
    if ( v13 > 0x20 )
    {
      v96 = (const void *)(v99 + 20);
      *(_BYTE *)v16 = 0;
    }
    else
    {
      v96 = (const void *)(v99 + 20);
      memcpy((void *)(v12 + 44), (const void *)(v99 + 20), v13);
      *(_BYTE *)(v12 + v13 + 44) = 0;
    }
    v3 = v12;
    IOLog(
      "IO80211ScanManager::startScan: %s scan request received from '%s' (pid %d) (%s).\n",
      v15,
      &v103,
      (unsigned int)v98,
      v12 + 44,
      v11);
    v18 = *(_DWORD *)(v99 + 16);
    if ( *(_DWORD *)(v99 + 16) )
      v14 = (__int64)"Directed";
    if ( v18 > 0x20 )
    {
      *(_BYTE *)v16 = 0;
    }
    else
    {
      memcpy(v16, v96, *(_DWORD *)(v99 + 16));
      *(_BYTE *)(v3 + v18 + 44) = 0;
    }
    v4 = off_7B078[0];
    v9 = v97;
    v19 = (__int64)v16;
    v5 = v98;
    IO8Log(
      "IO80211ScanManager::startScan: %s scan request received from '%s' (pid %d) (%s).\n",
      v14,
      (__int64)&v103,
      (unsigned int)v98,
      v19,
      v17,
      v95);
  }
  v20 = (unsigned int)v5;
  v24 = IO80211ScanManager::searchForPendingAndClearPid((IO80211ScanManager *)v3, v5);
  v25 = *(_QWORD *)(*(_QWORD *)(v3 + 80) + 336LL);
  if ( v25 )
  {
    v20 = IO80211AWDLPeerManager::metaClass;
    LODWORD(v26) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(v25 + 144), IO80211AWDLPeerManager::metaClass);
    if ( v26 )
    {
      if ( (*(_DWORD *)(v26 + 4976) == 4 || !*(_BYTE *)(v26 + 1512))
        && IO80211AWDLPeerManager::realTimeDataModeRequired((IO80211AWDLPeerManager *)v26)
        && v9 != 3 )
      {
        v27 = *(IO80211Interface **)(v3 + 88);
        v28 = 16;
        if ( !v27 || !(IO80211Interface::debugFlags(v27) & 8) )
          goto LABEL_65;
        v33 = "IO80211ScanManager::startScan AWDL returning EBUSY\n";
        goto LABEL_49;
      }
    }
  }
  if ( v9 == 3 )
  {
    v28 = IO80211ScanManager::fastScan(v3, v99, (unsigned int)v5, v21, v22, v23);
    goto LABEL_65;
  }
  if ( !IO80211ScanManager::isOpModeScanFriendly((IO80211ScanManager *)v3) )
  {
    v70 = *(IO80211Interface **)(v3 + 88);
    v28 = 16;
    if ( !v70 || !(IO80211Interface::debugFlags(v70) & 8) )
      goto LABEL_65;
    v33 = "IO80211ScanManager::startScan: Rejecting scan request because of interface's operational mode.\n";
LABEL_49:
    IOLog(v33, v20, v29, v30, v31, v32);
    IO8Log(v33, v20, v71, v72, v73, v74, v95);
    goto LABEL_65;
  }
  if ( !v24 )
    goto LABEL_37;
  v37 = v24 + 4720;
  timespecSub((__int64)&v101, v24 + 4720, (__int64)&v100);
  if ( v100 >= 0xB )
  {
    v41 = *(_QWORD *)v24;
    if ( *(_QWORD *)v24 )
      *(_QWORD *)(v41 + 8) = *(_QWORD *)(v24 + 8);
    v42 = *(_QWORD *)(v24 + 8);
    *(_QWORD *)v42 = v41;
    v43 = *(IO80211Interface **)(v3 + 88);
    if ( v43 && IO80211Interface::debugFlags(v43) & 8 )
    {
      IOLog("IO80211ScanManager::startScan: Found timed out scan request. Deleting.\n", v37, v38, v42, v39, v40);
      IO8Log("IO80211ScanManager::startScan: Found timed out scan request. Deleting.\n", v37, v44, v45, v46, v47, v95);
    }
    _releaseReqNode(v24, v37, v38, v42, v39, v40);
LABEL_37:
    v48 = (__int64)_allocScanReqNode((const void *)v99, 0LL, (unsigned int)v5, v34, v35, v36);
    v49 = *(IO80211Interface **)(v3 + 88);
    if ( v48 )
    {
      if ( v49 && IO80211Interface::debugFlags(v49) & 8 )
      {
        IOLog("IO80211ScanManager::startScan: Initiating scan.\n", 0LL, v50, v51, v52, v53);
        IO8Log("IO80211ScanManager::startScan: Initiating scan.\n", 0LL, v54, v55, v56, v57, v95);
      }
      IO80211Controller::scanStarted(*(_QWORD *)(v3 + 80), 0LL, v99);
      v58 = *(_QWORD *)(v3 + 80);
      v59 = (*(int (__fastcall **)(__int64, signed __int64, signed __int64, _QWORD, __int64))(*(_QWORD *)v58 + 3216LL))(
              v58,
              2150132168LL,
              10LL,
              *(_QWORD *)(v3 + 88),
              v99);
      v28 = v59;
      if ( v59 )
      {
        v60 = 0LL;
        IO80211Controller::scanDone(*(_QWORD *)(v3 + 80), 0LL, v59);
        v65 = *(IO80211Interface **)(v3 + 88);
        if ( v65 && IO80211Interface::debugFlags(v65) & 8 )
        {
          IOLog("IO80211ScanManager::startScan: Scan request failed (%d)!\n", (unsigned int)v28, v61, v62, v63, v64);
          v60 = (unsigned int)v28;
          IO8Log(
            "IO80211ScanManager::startScan: Scan request failed (%d)!\n",
            (unsigned int)v28,
            v66,
            v67,
            v68,
            v69,
            v95);
        }
        _releaseReqNode(v48, v60, v61, v62, v63, v64);
      }
      else
      {
        *(_BYTE *)(v48 + 4736) = 1;
        v91 = v101;
        *(_QWORD *)(v48 + 4728) = v102;
        *(_QWORD *)(v48 + 4720) = v91;
        v92 = v3 + 16;
        v93 = *(_QWORD *)(v3 + 16);
        *(_QWORD *)v48 = v93;
        if ( v93 )
          *(_QWORD *)(v93 + 8) = v48;
        *(_QWORD *)v92 = v48;
        *(_QWORD *)(v48 + 8) = v92;
        v28 = 0;
        if ( IO80211ScanManager::isBroadcastScanRequest(v58, v99) )
          io80211_get_calendar_time(v3 + 120);
      }
    }
    else
    {
      v28 = 12;
      if ( v49 && IO80211Interface::debugFlags(v49) & 8 )
      {
        IOLog(
          "IO80211ScanManager::startScan: no memory! curPid %u sizes %u %u\n",
          (unsigned int)v5,
          4760LL,
          32LL,
          v87,
          v88);
        IO8Log(
          "IO80211ScanManager::startScan: no memory! curPid %u sizes %u %u\n",
          (unsigned int)v5,
          4760LL,
          32LL,
          v89,
          v90,
          v95);
      }
    }
    goto LABEL_65;
  }
  v28 = 16;
  if ( !memcmp((const void *)(v24 + 16), (const void *)v99, 0x954uLL) )
  {
    v75 = *(IO80211Interface **)(v3 + 88);
    if ( v75 && IO80211Interface::debugFlags(v75) & 8 )
    {
      IOLog("IO80211ScanManager::startScan: Found pending scan with identical parameters.\n", v99, v76, v77, v78, v79);
      IO8Log(
        "IO80211ScanManager::startScan: Found pending scan with identical parameters.\n",
        v99,
        v80,
        v81,
        v82,
        v83,
        v95);
    }
    LODWORD(v84) = IOMalloc(32LL);
    v28 = 12;
    if ( v84 )
    {
      *(_DWORD *)(v84 + 16) = v5;
      v85 = *(_QWORD *)(v24 + 4752);
      v86 = v24 + 4752;
      *(_QWORD *)v84 = v85;
      if ( v85 )
        *(_QWORD *)(v85 + 8) = v84;
      *(_QWORD *)v86 = v84;
      *(_QWORD *)(v84 + 8) = v86;
      v28 = 0;
    }
  }
LABEL_65:
  result = *(_QWORD *)v4;
  if ( *(_QWORD *)v4 == v104 )
    result = (unsigned int)v28;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// 7CDC0: using guessed type _QWORD IO80211AWDLPeerManager::metaClass;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// C8D18: using guessed type int __fastcall proc_selfname(_QWORD, _QWORD);
// C8D20: using guessed type int __fastcall proc_selfpid(_QWORD, _QWORD);

//----- (000000000005C7DA) ----------------------------------------------------
signed __int64 __fastcall IO80211ScanManager::getScanResult(__int64 a1, __int64 a2)
{
  __int64 v2; // r13@1
  int v3; // er15@1
  __int64 v4; // r14@1
  signed __int64 result; // rax@1
  __int64 i; // rbx@2
  __int64 v7; // rcx@11
  __int64 v8; // rsi@12
  signed __int64 v9; // rcx@12
  char *v10; // rdi@12
  IO80211Interface *v11; // rdi@15
  __int64 v12; // rcx@16
  __int64 v13; // r8@16
  __int64 v14; // r9@16
  __int64 v15; // rcx@17
  __int64 v16; // r8@17
  __int64 v17; // r9@17
  __int64 v18; // rax@18
  __int64 v19; // rdx@20
  __int64 v20; // r8@20
  __int64 v21; // r9@20
  __int64 v22; // rax@21
  __int64 v23; // rcx@23
  __int64 v24; // rcx@25
  int v25; // [sp+0h] [bp-C0h]@11
  char v26; // [sp+10h] [bp-B0h]@12
  __int64 v27; // [sp+90h] [bp-30h]@1

  v2 = a1;
  v27 = *(_QWORD *)off_7B078[0];
  v3 = proc_selfpid(a1, a2);
  v4 = *(_QWORD *)(a1 + 16);
  result = 5LL;
  if ( v4 )
  {
LABEL_2:
    for ( i = *(_QWORD *)(v4 + 4752); ; i = *(_QWORD *)i )
    {
      if ( !i )
      {
        v4 = *(_QWORD *)v4;
        if ( v4 )
          goto LABEL_2;
        goto LABEL_25;
      }
      if ( *(_DWORD *)(i + 16) == v3 )
        break;
    }
    result = 16LL;
    if ( *(_BYTE *)(v4 + 4736) )
      goto LABEL_25;
    if ( *(_QWORD *)(i + 24) )
    {
      io80211_get_calendar_time((__int64)&v25);
      v7 = *(_QWORD *)(*(_QWORD *)(i + 24) + 16LL);
      *(_DWORD *)(v7 + 156) = 1000 * (v25 - *(_DWORD *)(v7 + 184));
      *(_QWORD *)a2 = v7 + 24;
      *(_QWORD *)(i + 24) = **(_QWORD **)(i + 24);
      result = 0LL;
      goto LABEL_25;
    }
    v8 = (__int64)"<unknown>";
    v9 = 16LL;
    v10 = &v26;
    while ( v9 )
    {
      *(_QWORD *)v10 = *(_QWORD *)v8;
      v8 += 8LL;
      v10 += 8;
      --v9;
    }
    proc_selfname(&v26, 128LL);
    v11 = *(IO80211Interface **)(v2 + 88);
    if ( v11 && IO80211Interface::debugFlags(v11) & 8 )
    {
      IOLog(
        "IO80211ScanManager::getScanResult: All scan results returned for '%s' (pid %d).\n",
        &v26,
        (unsigned int)v3,
        v12,
        v13,
        v14);
      IO8Log(
        "IO80211ScanManager::getScanResult: All scan results returned for '%s' (pid %d).\n",
        (__int64)&v26,
        (unsigned int)v3,
        v15,
        v16,
        v17,
        v25);
    }
    v18 = *(_QWORD *)i;
    if ( *(_QWORD *)i )
      *(_QWORD *)(v18 + 8) = *(_QWORD *)(i + 8);
    **(_QWORD **)(i + 8) = v18;
    IOFree(i, 32LL);
    if ( !*(_QWORD *)(v4 + 4752) )
    {
      v22 = *(_QWORD *)v4;
      if ( *(_QWORD *)v4 )
        *(_QWORD *)(v22 + 8) = *(_QWORD *)(v4 + 8);
      v23 = *(_QWORD *)(v4 + 8);
      *(_QWORD *)v23 = v22;
      _releaseReqNode(v4, 32LL, v19, v23, v20, v21);
    }
  }
  result = 5LL;
LABEL_25:
  v24 = *(_QWORD *)off_7B078[0];
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8D18: using guessed type int __fastcall proc_selfname(_QWORD, _QWORD);
// C8D20: using guessed type int __fastcall proc_selfpid(_QWORD, _QWORD);

//----- (000000000005C982) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::updateCache(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r15@1
  __int64 v4; // rcx@1
  __int64 v5; // r13@1
  __int64 v6; // rbx@2
  int v7; // eax@3
  __int64 v8; // rdx@3
  __int64 v9; // r8@3
  __int64 v10; // r9@3
  __int64 v11; // rcx@6
  __int64 v12; // rax@6
  __int64 i; // rcx@8
  __int64 result; // rax@17
  signed __int64 v15; // [sp+0h] [bp-30h]@1

  v3 = a3;
  v15 = a1 + 24;
  v4 = *(_QWORD *)(a1 + 24);
  v5 = a2 + 52;
  while ( 1 )
  {
    v6 = v4;
    if ( !v4 )
      break;
    v7 = memcmp((const void *)(v4 + 52), (const void *)v5, 6uLL);
    v4 = *(_QWORD *)v6;
    if ( !v7 )
    {
      if ( v4 )
        *(_QWORD *)(v4 + 8) = *(_QWORD *)(v6 + 8);
      **(_QWORD **)(v6 + 8) = v4;
      v11 = (unsigned int)(*(_DWORD *)(v6 + 16) - 1);
      *(_DWORD *)(v6 + 16) = v11;
      v12 = *(_QWORD *)(a1 + 16);
      if ( v12 )
      {
        do
        {
          if ( v12 != v3 )
          {
            for ( i = *(_QWORD *)(v12 + 4744); i; i = *(_QWORD *)i )
            {
              if ( *(_QWORD *)(i + 16) == v6 )
              {
                *(_QWORD *)(i + 16) = a2;
                --*(_DWORD *)(v6 + 16);
                ++*(_DWORD *)(a2 + 16);
              }
            }
          }
          v12 = *(_QWORD *)v12;
        }
        while ( v12 );
        v11 = *(_DWORD *)(v6 + 16);
      }
      if ( !(_DWORD)v11 )
        _releaseCacheNode(v6, v5, v8, v11, v9, v10);
      break;
    }
  }
  result = *(_QWORD *)v15;
  *(_QWORD *)a2 = *(_QWORD *)v15;
  if ( result )
    *(_QWORD *)(result + 8) = a2;
  *(_QWORD *)v15 = a2;
  *(_QWORD *)(a2 + 8) = v15;
  ++*(_DWORD *)(a2 + 16);
  return result;
}

//----- (000000000005CA5E) ----------------------------------------------------
char __fastcall IO80211ScanManager::scanDone(IO80211ScanManager *this, char a2)
{
  __int64 v2; // r14@1
  __int64 v3; // r15@1
  __int64 v4; // r12@1
  __int64 v5; // rax@2
  __int64 v6; // rax@8
  char v7; // bl@8
  __int64 v8; // r15@10
  void *v9; // rsi@11
  void *v10; // rax@12
  void *v11; // rcx@13
  unsigned __int8 v12; // dl@14
  char v13; // al@15
  char v14; // r13@15
  char v15; // r8@15
  char v16; // r10@15
  __int64 v17; // rbx@15
  signed __int64 v18; // r9@15
  signed __int64 v19; // r11@15
  unsigned __int64 v20; // rcx@16
  char v21; // di@17
  signed __int64 v22; // rdi@20
  unsigned int v23; // eax@35
  int v24; // er9@35
  char v25; // r11@35
  char v26; // dl@35
  __int64 v27; // r14@36
  int v28; // edx@36
  __int64 v29; // rbx@36
  int v30; // er12@38
  __int64 v31; // rcx@42
  int v32; // ebx@46
  __int64 v33; // rcx@50
  int v34; // esi@53
  int v35; // eax@54
  __int64 v36; // rax@74
  __int64 v37; // rcx@75
  __int64 v38; // rax@85
  __int64 v39; // rcx@86
  IO80211Interface *v40; // rdi@93
  __int64 v41; // rdx@94
  __int64 v42; // rcx@94
  __int64 v43; // r8@94
  __int64 v44; // r9@94
  __int64 v45; // rdx@95
  __int64 v46; // rcx@95
  __int64 v47; // r8@95
  __int64 v48; // r9@95
  char v50; // [sp+0h] [bp-70h]@0
  __int64 v51; // [sp+10h] [bp-60h]@9
  __int64 v52; // [sp+18h] [bp-58h]@9
  IO80211ScanManager *v53; // [sp+20h] [bp-50h]@1
  signed __int64 v54; // [sp+28h] [bp-48h]@9
  void *v55; // [sp+30h] [bp-40h]@8
  __int64 v56; // [sp+38h] [bp-38h]@1

  v2 = (__int64)this;
  v53 = this;
  v3 = *((_QWORD *)this + 3);
  io80211_get_calendar_time((__int64)&v56);
  v4 = 0LL;
  if ( a2 )
  {
    v5 = *((_QWORD *)this + 2);
    v4 = 0LL;
    if ( v5 )
    {
      v4 = 0LL;
      while ( !*(_BYTE *)(v5 + 4736) )
      {
        v5 = *(_QWORD *)v5;
        if ( !v5 )
          goto LABEL_8;
      }
      v4 = v5;
    }
  }
LABEL_8:
  LODWORD(v6) = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, _QWORD, void **))(**((_QWORD **)this + 10)
                                                                                               + 3216LL))(
                  *((_QWORD *)this + 10),
                  3223873993LL,
                  11LL,
                  *((_QWORD *)this + 11),
                  &v55);
  v7 = 0;
  if ( !(_DWORD)v6 )
  {
LABEL_9:
    v52 = v4;
    v51 = v3;
    v54 = v4 + 4744;
    while ( 1 )
    {
      LODWORD(v6) = IOMalloc(192LL);
      v8 = v6;
      if ( !v6 )
        goto LABEL_83;
      bzero((void *)v6, 0xC0uLL);
      memcpy((void *)(v8 + 24), v55, 0x98uLL);
      v9 = v55;
      if ( *((_WORD *)v55 + 69) )
      {
        LODWORD(v10) = IOMalloc(*((_WORD *)v55 + 69));
        *(_QWORD *)(v8 + 168) = v10;
        if ( !v10 )
        {
          LODWORD(v6) = IOFree(v8, 192LL);
LABEL_83:
          v3 = v51;
          break;
        }
        v11 = v55;
        *(_WORD *)(v8 + 162) = *((_WORD *)v55 + 69);
        memcpy(v10, *((const void **)v11 + 18), *((_WORD *)v11 + 69));
        v9 = v55;
      }
      *(_QWORD *)(v8 + 184) = v56;
      v12 = *((_BYTE *)v9 + 34);
      if ( v12 )
      {
        v13 = 0;
        v14 = 0;
        v15 = 0;
        v16 = 0;
        v17 = 0LL;
        v18 = 18295942222713408LL;
        v19 = 2086LL;
        while ( 1 )
        {
          v20 = *((_DWORD *)v9 + v17 + 9);
          if ( v20 > 0x36 )
            goto LABEL_100;
          v21 = 1;
          if ( _bittest((const unsigned __int64 *)&v18, v20) )
          {
            v14 = 1;
            goto LABEL_23;
          }
          if ( _bittest((const unsigned __int64 *)&v19, v20) )
            goto LABEL_25;
          v22 = 8594128896LL;
          if ( _bittest((const unsigned __int64 *)&v22, v20) )
            v15 = 1;
          else
LABEL_100:
            v16 = 1;
LABEL_23:
          if ( v13 )
          {
            v21 = v13;
LABEL_25:
            if ( v14 )
            {
              if ( v15 )
              {
                if ( v16 )
                  goto LABEL_35;
                v16 = 0;
              }
              else
              {
                v15 = 0;
              }
            }
            else
            {
              v14 = 0;
            }
            goto LABEL_32;
          }
          v21 = 0;
LABEL_32:
          ++v17;
          v13 = v21;
          if ( (unsigned __int8)v17 >= (unsigned int)v12 )
            goto LABEL_35;
        }
      }
      v21 = 0;
      v14 = 0;
      v15 = 0;
      v16 = 0;
LABEL_35:
      v23 = *((_WORD *)v9 + 69);
      v24 = 0;
      v25 = 0;
      v26 = 0;
      if ( v23 >= 3 )
      {
        v27 = *((_QWORD *)v9 + 18);
        v28 = *((_WORD *)v9 + 69);
        v29 = *((_QWORD *)v9 + 18);
        do
        {
          if ( *(_BYTE *)v29 == 61 )
          {
            v30 = *(_BYTE *)(v29 + 1);
            if ( v28 - 2 >= v30 )
            {
              v25 = 1;
              if ( (unsigned int)(v30 + 2) > 0x17 )
                goto LABEL_44;
            }
          }
          else
          {
            LOBYTE(v30) = *(_BYTE *)(v29 + 1);
          }
          v31 = (unsigned int)(unsigned __int8)v30 + 2;
          v28 -= v31;
          v29 += v31;
        }
        while ( v28 > 2 );
        v25 = 0;
LABEL_44:
        v4 = v52;
        do
        {
          if ( *(_BYTE *)v27 == 191 )
          {
            v32 = *(_BYTE *)(v27 + 1);
            if ( (signed int)(v23 - 2) >= v32 )
            {
              v26 = 1;
              if ( (unsigned int)(v32 + 2) > 0xD )
                goto LABEL_52;
            }
          }
          else
          {
            LOBYTE(v32) = *(_BYTE *)(v27 + 1);
          }
          v33 = (unsigned int)(unsigned __int8)v32 + 2;
          v23 -= v33;
          v27 += v33;
        }
        while ( (signed int)v23 > 2 );
        v26 = 0;
LABEL_52:
        v2 = (__int64)v53;
      }
      v34 = *((_DWORD *)v9 + 3);
      if ( v34 & 0x18 )
      {
        v35 = 0;
        if ( v34 & 0x10 )
        {
          if ( v14 && !v21 && !v16 )
            v35 = 2 * (((unsigned __int8)v25 & (unsigned __int8)v26) == 0);
        }
        else if ( v34 & 8 )
        {
          v35 = 0;
          if ( v21 && !v14 && !v16 )
            v35 = 4 * (v25 == 0);
          if ( (unsigned __int8)v14 | (unsigned __int8)v15 && !v16 && !v25 )
            v35 |= 8u;
        }
        v24 = v35 | 0x10;
        if ( !v25 )
          v24 = v35;
        if ( v25 && v26 )
          v24 |= 0x80u;
      }
      *(_DWORD *)(v8 + 176) = v24;
      IO80211ScanManager::updateCache(v2, v8, v4);
      if ( !v4 )
      {
        LODWORD(v6) = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, _QWORD, void **))(**(_QWORD **)(v2 + 80) + 3216LL))(
                        *(_QWORD *)(v2 + 80),
                        3223873993LL,
                        11LL,
                        *(_QWORD *)(v2 + 88),
                        &v55);
        v7 = 1;
        v4 = 0LL;
        v3 = v51;
        if ( (_DWORD)v6 )
          goto LABEL_90;
        goto LABEL_9;
      }
      LODWORD(v36) = IOMalloc(24LL);
      if ( v36 )
      {
        *(_QWORD *)(v36 + 16) = v8;
        ++*(_DWORD *)(v8 + 16);
        v37 = *(_QWORD *)v54;
        *(_QWORD *)v36 = *(_QWORD *)v54;
        if ( v37 )
          *(_QWORD *)(v37 + 8) = v36;
        *(_QWORD *)v54 = v36;
        *(_QWORD *)(v36 + 8) = v54;
      }
      LODWORD(v6) = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, _QWORD, void **))(**(_QWORD **)(v2 + 80) + 3216LL))(
                      *(_QWORD *)(v2 + 80),
                      3223873993LL,
                      11LL,
                      *(_QWORD *)(v2 + 88),
                      &v55);
      v7 = 1;
      if ( (_DWORD)v6 )
        goto LABEL_83;
    }
  }
  if ( v4 )
  {
    v38 = *(_QWORD *)(v4 + 4752);
    if ( v38 )
    {
      v39 = *(_QWORD *)(v4 + 4744);
      do
      {
        *(_QWORD *)(v38 + 24) = v39;
        v38 = *(_QWORD *)v38;
      }
      while ( v38 );
    }
    *(_BYTE *)(v4 + 4736) = 0;
    LODWORD(v6) = IO80211Controller::scanDone(*(_QWORD *)(v2 + 80), 0LL, 0);
  }
  if ( v7 & 1 )
LABEL_90:
    LOBYTE(v6) = IO80211Interface::postMessage(*(IO80211Interface **)(v2 + 88), 0LL, v6, 0LL, 15);
  if ( !v3 && *(_QWORD *)(v2 + 24) )
  {
    v40 = *(IO80211Interface **)(v2 + 88);
    if ( v40 && IO80211Interface::debugFlags(v40) & 8 )
    {
      IOLog(
        "IO80211ScanManager::scanDone: Scheduling cache purge timer in %u seconds.\n",
        *(_DWORD *)(v2 + 32),
        v41,
        v42,
        v43,
        v44);
      IO8Log(
        "IO80211ScanManager::scanDone: Scheduling cache purge timer in %u seconds.\n",
        *(_DWORD *)(v2 + 32),
        v45,
        v46,
        v47,
        v48,
        v50);
    }
    LOBYTE(v6) = (*(int (__fastcall **)(_QWORD, _QWORD, signed __int64))(**(_QWORD **)(v2 + 104) + 480LL))(
                   *(_QWORD *)(v2 + 104),
                   *(_DWORD *)(v2 + 32),
                   1000000000LL);
  }
  return v6;
}
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000005CECA) ----------------------------------------------------
int __fastcall IO80211ScanManager::cachePurge(IO80211ScanManager *this, __int64 a2)
{
  IO80211ScanManager *v2; // r15@1
  IO80211Interface *v3; // rdi@1
  __int64 v4; // rdx@2
  __int64 v5; // rcx@2
  __int64 v6; // r8@2
  __int64 v7; // r9@2
  __int64 v8; // rdx@3
  __int64 v9; // rcx@3
  __int64 v10; // r8@3
  __int64 v11; // r9@3
  int result; // eax@4
  __int64 v13; // rdx@4
  __int64 v14; // rcx@4
  __int64 v15; // r8@4
  __int64 v16; // r9@4
  __int64 v17; // rbx@4
  IO80211ScanManager *v18; // r13@4
  __int64 v19; // r15@5
  IO80211Interface *v20; // rdi@6
  __int64 v21; // rcx@7
  __int64 v22; // rdx@8
  __int64 v23; // rcx@8
  __int64 v24; // r8@8
  __int64 v25; // r9@8
  __int64 v26; // rax@9
  __int64 v27; // rcx@11
  IO80211ScanManager *v28; // r12@13
  __int64 v29; // rbx@13
  signed __int64 v30; // r15@14
  char v31; // r14@14
  __int64 v32; // r13@16
  __int64 v33; // rax@19
  bool v34; // cf@22
  IO80211Interface *v35; // rdi@26
  size_t v36; // r14@28
  __int64 v37; // rcx@31
  __int64 v38; // r8@31
  __int64 v39; // r9@31
  unsigned __int64 v40; // r14@31
  IO80211Interface *v41; // rdi@36
  __int64 v42; // rdx@38
  __int64 v43; // rcx@38
  __int64 v44; // r8@38
  __int64 v45; // r9@38
  __int64 v46; // rdx@39
  __int64 v47; // rcx@39
  __int64 v48; // r8@39
  __int64 v49; // r9@39
  __int64 v50; // rdx@43
  __int64 v51; // rcx@43
  __int64 v52; // r8@43
  __int64 v53; // r9@43
  __int64 v54; // rdx@44
  __int64 v55; // rcx@44
  __int64 v56; // r8@44
  __int64 v57; // r9@44
  char v58; // [sp+0h] [bp-60h]@0
  const void *v59; // [sp+8h] [bp-58h]@29
  char v60; // [sp+10h] [bp-50h]@1
  unsigned int v61; // [sp+14h] [bp-4Ch]@1
  unsigned __int64 v62; // [sp+18h] [bp-48h]@5
  int v63; // [sp+28h] [bp-38h]@4

  v60 = a2;
  v2 = this;
  v61 = *((_DWORD *)this + 8);
  v3 = (IO80211Interface *)*((_QWORD *)this + 11);
  if ( v3 && IO80211Interface::debugFlags(v3) & 8 )
  {
    IOLog("IO80211ScanManager::cachePurge: clearEntries[%d] Firing!\n", (unsigned __int8)a2, v4, v5, v6, v7);
    a2 = (unsigned __int8)a2;
    IO8Log("IO80211ScanManager::cachePurge: clearEntries[%d] Firing!\n", (unsigned __int8)a2, v8, v9, v10, v11, v58);
  }
  result = io80211_get_calendar_time((__int64)&v63);
  v17 = *((_QWORD *)v2 + 2);
  v18 = v2;
  if ( v17 )
  {
    do
    {
      v19 = *(_QWORD *)v17;
      a2 = v17 + 4720;
      result = timespecSub((__int64)&v63, v17 + 4720, (__int64)&v62);
      if ( v62 >= 0xB )
      {
        v20 = (IO80211Interface *)*((_QWORD *)v18 + 11);
        if ( v20 && IO80211Interface::debugFlags(v20) & 8 )
        {
          IOLog("IO80211ScanManager:cachePurge: Found stale scan request\n", a2, v13, v21, v15, v16);
          IO8Log("IO80211ScanManager:cachePurge: Found stale scan request\n", a2, v22, v23, v24, v25, v58);
        }
        v26 = *(_QWORD *)v17;
        if ( *(_QWORD *)v17 )
          *(_QWORD *)(v26 + 8) = *(_QWORD *)(v17 + 8);
        v27 = *(_QWORD *)(v17 + 8);
        *(_QWORD *)v27 = v26;
        result = _releaseReqNode(v17, a2, v13, v27, v15, v16);
      }
      v17 = v19;
    }
    while ( v19 );
  }
  v28 = v18;
  v29 = *((_QWORD *)v18 + 3);
  if ( !v29 )
  {
    v41 = (IO80211Interface *)*((_QWORD *)v18 + 11);
    goto LABEL_42;
  }
  v30 = (signed __int64)((char *)v18 + 44);
  v31 = v60;
  while ( 1 )
  {
    while ( 1 )
    {
      v32 = v29;
      v29 = *(_QWORD *)v29;
      result = v63 - *(_DWORD *)(v32 + 184);
      if ( !v31 )
      {
        v14 = *((_DWORD *)v28 + 8);
        if ( result < (unsigned int)v14 )
          goto LABEL_22;
      }
      if ( *(_DWORD *)(v32 + 16) == 1 )
        break;
      LODWORD(v14) = *((_DWORD *)v28 + 8);
LABEL_22:
      v34 = (unsigned int)v14 < result;
      v14 = (unsigned int)(v14 - result);
      if ( v34 || (_DWORD)v14 == 0 )
      {
        v35 = (IO80211Interface *)*((_QWORD *)v28 + 11);
        v61 = 1;
        if ( v35 )
        {
          result = IO80211Interface::debugFlags(v35);
          if ( result & 8 )
          {
            v36 = *(_BYTE *)(v32 + 120);
            if ( v36 > 0x20 )
            {
              v59 = (const void *)(v32 + 121);
              *(_BYTE *)v30 = 0;
            }
            else
            {
              v59 = (const void *)(v32 + 121);
              memcpy((char *)v28 + 44, (const void *)(v32 + 121), v36);
              *((_BYTE *)v28 + v36 + 44) = 0;
            }
            IOLog(
              "IO80211ScanManager::cachePurge: %s still referenced (%u).\n",
              (char *)v28 + 44,
              *(_DWORD *)(v32 + 16),
              v14,
              v15,
              v16);
            v40 = *(_BYTE *)(v32 + 120);
            if ( v40 > 0x20 )
            {
              *(_BYTE *)v30 = 0;
            }
            else
            {
              memcpy((char *)v28 + 44, v59, *(_BYTE *)(v32 + 120));
              *((_BYTE *)v28 + v40 + 44) = 0;
            }
            v31 = v60;
            a2 = (__int64)((char *)v28 + 44);
            result = IO8Log(
                       "IO80211ScanManager::cachePurge: %s still referenced (%u).\n",
                       (__int64)((char *)v28 + 44),
                       *(_DWORD *)(v32 + 16),
                       v37,
                       v38,
                       v39,
                       v58);
          }
        }
      }
      else
      {
        result = v61;
        if ( (unsigned int)v14 < v61 )
          result = v14;
        v61 = result;
      }
      if ( !v29 )
        goto LABEL_36;
    }
    v33 = *(_QWORD *)(v32 + 8);
    if ( !v29 )
      break;
    *(_QWORD *)(v29 + 8) = v33;
    **(_QWORD **)(v32 + 8) = v29;
    *(_DWORD *)(v32 + 16) = 0;
    _releaseCacheNode(v32, a2, v13, v14, v15, v16);
  }
  *(_QWORD *)v33 = 0LL;
  *(_DWORD *)(v32 + 16) = 0;
  result = _releaseCacheNode(v32, a2, v13, v14, v15, v16);
LABEL_36:
  v41 = (IO80211Interface *)*((_QWORD *)v28 + 11);
  if ( *((_QWORD *)v28 + 3) )
  {
    if ( v41 )
    {
      if ( IO80211Interface::debugFlags(v41) & 8 )
      {
        IOLog("IO80211ScanManager::cachePurge: Rescheduling in %u seconds.\n", v61, v42, v43, v44, v45);
        IO8Log("IO80211ScanManager::cachePurge: Rescheduling in %u seconds.\n", v61, v46, v47, v48, v49, v58);
      }
    }
    return (*(int (__fastcall **)(_QWORD, _QWORD, signed __int64))(**((_QWORD **)v28 + 13) + 480LL))(
             *((_QWORD *)v28 + 13),
             v61,
             1000000000LL);
  }
LABEL_42:
  if ( v41 )
  {
    result = IO80211Interface::debugFlags(v41);
    if ( result & 8 )
    {
      IOLog("IO80211ScanManager::cachePurge: NOT Rescheduling.\n", a2, v50, v51, v52, v53);
      result = IO8Log("IO80211ScanManager::cachePurge: NOT Rescheduling.\n", a2, v54, v55, v56, v57, v58);
    }
  }
  return result;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005D180) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::setCacheAgeThreshold(IO80211ScanManager *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rax@1
  __int64 v5; // rbx@1
  signed int v6; // er12@1

  LODWORD(v4) = proc_self(this, a2, a3, a4);
  v5 = v4;
  v6 = 1;
  if ( v4 )
  {
    v6 = 1;
    if ( !proc_suser(v4) )
    {
      *((_DWORD *)this + 8) = a2;
      v6 = 0;
    }
    proc_rele(v5);
  }
  return (unsigned int)v6;
}
// C8D08: using guessed type int __fastcall proc_rele(_QWORD);
// C8D10: using guessed type int __fastcall proc_self(_QWORD, _QWORD, _QWORD, _QWORD);
// C8D28: using guessed type int __fastcall proc_suser(_QWORD);

//----- (000000000005D1D2) ----------------------------------------------------
void __fastcall IO80211ScanManager::getTimeSinceLastBroadcastScan(__int64 a1, __int64 a2)
{
  char v2; // [sp+8h] [bp-28h]@1

  bzero(&v2, 0x10uLL);
  if ( !memcmp((const void *)(a1 + 120), &v2, 0x10uLL) )
  {
    bzero((void *)a2, 0x10uLL);
  }
  else
  {
    io80211_get_calendar_time((__int64)&v2);
    timespecSub((__int64)&v2, a1 + 120, a2);
  }
}

//----- (000000000005D242) ----------------------------------------------------
__int64 __fastcall IO80211ScanManager::MetaClass::~MetaClass(IO80211ScanManager::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000005D250) ----------------------------------------------------
__int64 `global constructor keyed to'_a_17()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IO80211ScanManager::gMetaClass, "IO80211ScanManager", off_7B030[0], 136LL);
  result = (__int64)off_811F0;
  IO80211ScanManager::gMetaClass = off_811F0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 811F0: using guessed type __int64 (__fastcall *off_811F0[2])(IO80211ScanManager::MetaClass *__hidden this);
// 84660: using guessed type _QWORD IO80211ScanManager::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005D290) ----------------------------------------------------
__int64 `global destructor keyed to'_a_17()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211ScanManager::gMetaClass);
}
// 84660: using guessed type _QWORD IO80211ScanManager::gMetaClass;

//----- (000000000005D2B0) ----------------------------------------------------
__int64 _init_crc8_ccitt(void)
{
  __int64 result; // rax@1
  signed int v1; // edx@2
  __int16 v2; // si@2
  unsigned int v3; // edi@3
  __int16 v4; // cx@3

  result = 0LL;
  if ( !_crc8_ccitt_inited )
  {
    do
    {
      v1 = 8;
      v2 = result;
      do
      {
        v3 = (v2 & 0x80u) >> 7;
        v4 = 2 * v2 & 0x1FE;
        v2 = v4 ^ 7;
        if ( !v3 )
          v2 = v4;
        --v1;
      }
      while ( v1 );
      *((_BYTE *)crc8_table + result++) = v2;
    }
    while ( result != 256 );
    _crc8_ccitt_inited = 1;
  }
  return result;
}
// 84AB0: using guessed type int _crc8_ccitt_inited;
// 84AC0: using guessed type __int64 crc8_table[32];

//----- (000000000005D30C) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::MetaClass::MetaClass(IO80211ServiceRequestDescriptor::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211ServiceRequestDescriptor", &IO80211QueueDescriptor::gMetaClass, 120LL);
  result = (__int64)off_81430;
  *(_QWORD *)this = off_81430;
  return result;
}
// 81430: using guessed type __int64 (__fastcall *off_81430[2])(IO80211ServiceRequestDescriptor::MetaClass *__hidden this);
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005D33E) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::MetaClass::~MetaClass(IO80211ServiceRequestDescriptor::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000005D348) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::IO80211ServiceRequestDescriptor(__int64 a1)
{
  __int64 result; // rax@1

  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  result = (__int64)off_812F0;
  *(_QWORD *)a1 = off_812F0;
  return result;
}
// 812F0: using guessed type __int64 (__fastcall *off_812F0[2])(IO80211ServiceRequestDescriptor *__hidden this);

//----- (000000000005D368) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::IO80211ServiceRequestDescriptor(__int64 a1)
{
  __int64 result; // rax@1

  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  result = (__int64)off_812F0;
  *(_QWORD *)a1 = off_812F0;
  return result;
}
// 812F0: using guessed type __int64 (__fastcall *off_812F0[2])(IO80211ServiceRequestDescriptor *__hidden this);

//----- (000000000005D388) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::~IO80211ServiceRequestDescriptor(IO80211ServiceRequestDescriptor *this)
{
  return IO80211QueueDescriptor::~IO80211QueueDescriptor(this);
}

//----- (000000000005D392) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::~IO80211ServiceRequestDescriptor(IO80211ServiceRequestDescriptor *this)
{
  return IO80211QueueDescriptor::~IO80211QueueDescriptor(this);
}

//----- (000000000005D39C) ----------------------------------------------------
void __fastcall IO80211ServiceRequestDescriptor::~IO80211ServiceRequestDescriptor(IO80211ServiceRequestDescriptor *this)
{
  IO80211QueueDescriptor::~IO80211QueueDescriptor(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000005D3BE) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::getMetaClass(IO80211ServiceRequestDescriptor *this)
{
  return (__int64)&IO80211ServiceRequestDescriptor::gMetaClass;
}
// 84BC0: using guessed type _QWORD IO80211ServiceRequestDescriptor::gMetaClass;

//----- (000000000005D3CC) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::MetaClass::MetaClass(IO80211ServiceRequestDescriptor::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211ServiceRequestDescriptor", &IO80211QueueDescriptor::gMetaClass, 120LL);
  result = (__int64)off_81430;
  *(_QWORD *)this = off_81430;
  return result;
}
// 81430: using guessed type __int64 (__fastcall *off_81430[2])(IO80211ServiceRequestDescriptor::MetaClass *__hidden this);
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005D3FE) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::MetaClass::alloc(IO80211ServiceRequestDescriptor::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)stru_68.segname, a2);
  IO80211QueueDescriptor::IO80211QueueDescriptor(v2);
  *(_QWORD *)v2 = off_812F0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211ServiceRequestDescriptor::gMetaClass);
  return v2;
}
// 68: using guessed type section_64 stru_68;
// 812F0: using guessed type __int64 (__fastcall *off_812F0[2])(IO80211ServiceRequestDescriptor *__hidden this);
// 84BC0: using guessed type _QWORD IO80211ServiceRequestDescriptor::gMetaClass;

//----- (000000000005D43E) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::IO80211ServiceRequestDescriptor(__int64 a1)
{
  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  *(_QWORD *)a1 = off_812F0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211ServiceRequestDescriptor::gMetaClass);
}
// 812F0: using guessed type __int64 (__fastcall *off_812F0[2])(IO80211ServiceRequestDescriptor *__hidden this);
// 84BC0: using guessed type _QWORD IO80211ServiceRequestDescriptor::gMetaClass;

//----- (000000000005D46E) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::IO80211ServiceRequestDescriptor(__int64 a1)
{
  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  *(_QWORD *)a1 = off_812F0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211ServiceRequestDescriptor::gMetaClass);
}
// 812F0: using guessed type __int64 (__fastcall *off_812F0[2])(IO80211ServiceRequestDescriptor *__hidden this);
// 84BC0: using guessed type _QWORD IO80211ServiceRequestDescriptor::gMetaClass;

//----- (000000000005D49E) ----------------------------------------------------
char __fastcall IO80211ServiceRequestDescriptor::initWithUserAddress(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r15@1
  __int64 v4; // r12@1
  int v5; // eax@2
  unsigned int v6; // ebx@3
  signed __int64 v7; // r15@4
  const char *v8; // rdi@4
  int v9; // eax@8
  __int64 v10; // rcx@10
  __int64 v11; // r8@10
  __int64 v12; // r9@10
  char *v13; // rsi@11
  __int64 v14; // rdx@12
  __int64 v15; // rcx@12
  __int64 v16; // r8@12
  __int64 v17; // r9@12
  __int64 v18; // rax@13
  signed __int64 v19; // r12@13
  __int64 v20; // rbx@13
  __int64 v21; // rcx@13
  __int64 v22; // r8@13
  __int64 v23; // r9@13
  signed __int64 v24; // rcx@15
  unsigned __int16 v25; // ax@16
  __int64 v26; // rcx@18
  signed __int64 v27; // r14@18
  __int64 v28; // r8@20
  char *v29; // rsi@20
  char *v30; // rsi@23
  __int64 v31; // rdx@26
  __int64 v32; // rdi@26
  signed __int64 v33; // r14@29
  int v34; // eax@29
  unsigned __int8 *v35; // rdx@29
  __int64 v36; // rdx@30
  __int64 v37; // rdi@31
  int v38; // ecx@33
  __int64 v39; // rcx@37
  char v40; // al@37
  unsigned __int16 v41; // ax@37
  unsigned int v42; // eax@37
  void *v43; // rax@38
  __int64 v44; // rcx@39
  __int64 v45; // r8@39
  __int64 v46; // r9@39
  unsigned __int16 v47; // ax@42
  __int64 v48; // rcx@42
  void *v49; // rax@46
  unsigned __int8 *v50; // rsi@47
  char *v51; // rsi@54
  __int64 v52; // rdx@54
  unsigned int v53; // ebx@65
  __int64 v54; // rcx@66
  __int64 v55; // r8@66
  __int64 v56; // r9@66
  __int64 v57; // rdx@67
  __int64 v58; // rcx@67
  __int64 v59; // r8@67
  __int64 v60; // r9@67
  unsigned int v61; // ebx@68
  __int64 v62; // rcx@69
  __int64 v63; // r8@69
  __int64 v64; // r9@69
  __int64 v65; // rdx@71
  __int64 v66; // rcx@71
  __int64 v67; // r8@71
  __int64 v68; // r9@71
  __int64 v69; // rsi@74
  unsigned __int64 v71; // rax@83
  char v72[8]; // rcx@84
  unsigned __int8 *v73; // rax@94
  int v74; // eax@95
  int v75; // eax@97
  unsigned __int8 *v76; // rdx@97
  char *v77; // rdx@98
  unsigned __int8 *v78; // rdx@99
  __int64 v79; // r8@99
  __int64 v80; // r9@99
  __int64 v81; // rcx@100
  char *v82; // rdx@100
  unsigned __int16 v83; // ax@103
  void *v84; // rax@103
  __int64 v85; // r8@103
  __int64 v86; // r9@103
  unsigned __int8 *v87; // r8@104
  unsigned __int16 v88; // ax@104
  unsigned int v89; // eax@104
  void *v90; // rax@105
  unsigned __int16 v91; // ax@107
  void *v92; // rax@107
  unsigned __int8 *v93; // r8@108
  unsigned __int16 v94; // ax@108
  void *v95; // rax@113
  char v96; // [sp+0h] [bp-50h]@0
  char v97; // [sp+0h] [bp-50h]@12
  char v98; // [sp+0h] [bp-50h]@65
  char v99; // [sp+0h] [bp-50h]@68
  __int64 v100; // [sp+10h] [bp-40h]@2
  __int64 v101; // [sp+10h] [bp-40h]@11
  unsigned __int8 v102; // [sp+1Ah] [bp-36h]@69
  unsigned __int8 v103; // [sp+1Bh] [bp-35h]@66
  unsigned __int16 v104; // [sp+1Ch] [bp-34h]@55
  unsigned __int16 v105; // [sp+1Eh] [bp-32h]@10
  unsigned int v106; // [sp+20h] [bp-30h]@10
  int v107; // [sp+24h] [bp-2Ch]@10

  v3 = a3;
  v4 = a1;
  bzero(&buf, 0x200uLL);
  bzero(&bufout, 0x200uLL);
  if ( !inited_awdl_compression )
  {
    v100 = v3;
    v5 = num_awdl_labels;
    if ( num_awdl_labels )
    {
      v6 = 0;
      do
      {
        v7 = 8LL * v6;
        v8 = *(const char **)&awdl_labels[v7 + 4];
        if ( v8 )
        {
          awdl_labels[v7 + 1] = strlen(v8);
          v5 = num_awdl_labels;
        }
        ++v6;
      }
      while ( v6 < v5 );
    }
    memset(&bufout, 170, 0x210uLL);
    memset(&buf, 170, 0x210uLL);
    inited_awdl_compression = 1;
    v3 = v100;
  }
  v9 = OSIncrementAtomic(&_serviceDescriptorAllocCount);
  for ( *(_DWORD *)(v4 + 32) = v9; !v9; *(_DWORD *)(v4 + 32) = v9 )
    v9 = OSIncrementAtomic(&_serviceDescriptorAllocCount);
  *(_DWORD *)(v4 + 32) = v9 & 0xFFFFFF;
  v107 = 0;
  v106 = 0;
  v105 = 0;
  if ( copyin(a2 + 1, &v105, 2LL) )
  {
    v101 = a2;
    v13 = "%s can't copy tlv_length\n";
LABEL_12:
    _userPrint(v3, v13, (__int64)"initWithUserAddress", v10, v11, v12, v96);
    goto LABEL_65;
  }
  v18 = v4;
  v19 = v4 + 73;
  v20 = v18;
  if ( copyin(a2, v19, 1LL) )
  {
    v101 = a2;
    _userPrint(v3, "%s can't copy tlv type\n", (__int64)"initWithUserAddress", v21, v22, v23, v96);
    v4 = v20;
    goto LABEL_65;
  }
  v24 = *(_BYTE *)v19;
  if ( (_DWORD)v24 == 1 )
  {
    v101 = a2;
    v25 = v105;
    if ( (unsigned int)v105 + 3 <= 7 )
    {
      _userPrint(v3, "bad service request len %u key off %u\n", v105, 7LL, v22, v23, v96);
      v25 = v105;
    }
    v26 = (unsigned int)v25 - 4;
    v107 = v25 - 4;
    *(_BYTE *)(v20 + 74) = 1;
    v27 = 7LL;
    goto LABEL_19;
  }
  if ( (unsigned __int8)v24 != 2 )
  {
    v101 = a2;
    v30 = "%s unknown type %u\n";
    goto LABEL_62;
  }
  if ( copyin(a2 + 3, &v107, 2LL) )
  {
    v101 = a2;
    v24 = *(_BYTE *)v19;
    v30 = "%s can't copy key response length type %u\n";
    goto LABEL_62;
  }
  v38 = v107;
  if ( (unsigned int)v105 + 3 <= v107 + 9 )
  {
    _userPrint(v3, "bad service response len %u klen %u\n", v105, (unsigned int)v107, v22, v23, v96);
    v38 = v107;
  }
  if ( copyin(a2 + (unsigned int)v38 + 5, &v106, 2LL) )
  {
    v101 = a2;
    v24 = *(_BYTE *)v19;
    v30 = "%s can't copy value length type %u\n";
    goto LABEL_62;
  }
  v104 = 0;
  if ( copyin(a2 + (unsigned int)v107 + 7, &v104, 2LL) )
  {
    v101 = a2;
    v24 = *(_BYTE *)v19;
    v30 = "%s can't copy value offset type %u\n";
    goto LABEL_62;
  }
  v26 = v104;
  if ( v104 )
  {
    v101 = a2;
    v28 = *(_BYTE *)v19;
    v29 = "%s can't accept fragmented TLV offset %u type %u\n";
    goto LABEL_26;
  }
  *(_BYTE *)(v20 + 74) = 1;
  if ( v106 )
  {
    v101 = a2;
    v26 = (unsigned int)v107;
    v27 = 5LL;
LABEL_19:
    if ( (unsigned int)v26 <= 2 )
    {
      v28 = *(_BYTE *)v19;
      v29 = "%s short key len %u, type %u\n";
LABEL_26:
      v31 = (__int64)"initWithUserAddress";
      v32 = v3;
LABEL_27:
      _userPrint(v32, v29, v31, v26, v28, v23, v96);
      v4 = v20;
      goto LABEL_65;
    }
    if ( (unsigned int)v26 >= 0x201 )
    {
      v28 = *(_BYTE *)v19;
      v29 = "%s key size > max %u type %u\n";
      goto LABEL_26;
    }
    v33 = v101 + v27;
    v34 = copyin(v33, &buf, (unsigned int)v26);
    v24 = (unsigned int)v107;
    if ( v34 )
    {
      v30 = "%s can't copyin tlv ley len %u\n";
      v36 = (__int64)"initWithUserAddress";
LABEL_31:
      v37 = v3;
      goto LABEL_64;
    }
    v39 = (unsigned int)(v107 - 2);
    v40 = *(&buf + v39);
    *(_BYTE *)(v20 + 96) = v40;
    word_84CE2 = 0;
    qword_84CE8 = 0LL;
    v41 = putAsNameD2Dv1(&buf, v35, v40, v39, v23);
    *(_WORD *)(v20 + 78) = v41;
    v42 = v41;
    if ( !v42 )
    {
      v30 = "%s can't uncompress D2D key len %u\n";
      v36 = (__int64)"initWithUserAddress";
      v24 = 0LL;
LABEL_63:
      v37 = v3;
LABEL_64:
      _userPrint(v37, v30, v36, v24, v22, v23, v96);
      v4 = v20;
      goto LABEL_65;
    }
    LODWORD(v43) = kalloc(v42);
    *(_QWORD *)(v20 + 48) = v43;
    v24 = *(_WORD *)(v20 + 78);
    if ( !v43 )
    {
      v30 = "%s can't allocate KEY %u bytes\n";
      goto LABEL_82;
    }
    memcpy(v43, &bufout, *(_WORD *)(v20 + 78));
    if ( v3 && *(_DWORD *)(v3 + 52) )
      _userPrint(v3, "will compress key %u\n", *(_WORD *)(v20 + 78), v44, v45, v46, v96);
    v47 = compressAwdl(*(unsigned __int8 **)(v20 + 48), *(_WORD *)(v20 + 78), 0LL, 0, (unsigned __int8 *)v45);
    *(_WORD *)(v20 + 82) = v47;
    if ( v47 )
    {
      if ( v3 && *(_DWORD *)(v3 + 52) )
      {
        _userPrint(v3, "compressed-- key %u\n", v47, v48, v22, v23, v96);
        v47 = *(_WORD *)(v20 + 82);
      }
      LODWORD(v49) = kalloc(v47);
      *(_QWORD *)(v20 + 56) = v49;
      v24 = *(_WORD *)(v20 + 82);
      if ( v49 )
      {
        v50 = &bufout;
        memcpy(v49, &bufout, *(_WORD *)(v20 + 82));
        if ( v3 && *(_DWORD *)(v3 + 52) )
        {
          v50 = (unsigned __int8 *)"type %u mdns %u, len %u\n";
          _userPrint(v3, "type %u mdns %u, len %u\n", *(_BYTE *)(v20 + 73), *(_BYTE *)(v20 + 96), v106, v23, v96);
        }
        if ( *(_BYTE *)v19 != 2 )
          goto LABEL_116;
        v4 = v20;
        word_84CE2 = *(_WORD *)(v20 + 78);
        qword_84CE8 = *(_QWORD *)(v20 + 48);
        v28 = v106;
        v26 = *(_BYTE *)(v20 + 96);
        if ( !v106 )
        {
          _userPrint(v3, "%s value null length type %u bytes\n", (__int64)"initWithUserAddress", v26, v106, v23, v96);
          goto LABEL_65;
        }
        if ( (_DWORD)v26 == 33 )
        {
          if ( v106 >= 0x1F5 )
          {
            v51 = "%s SRV value wrong length type %u bytes %u\n";
            v52 = (__int64)"initWithUserAddress";
LABEL_93:
            _userPrint(v3, v51, v52, v26, v106, v23, v96);
            goto LABEL_65;
          }
          if ( v106 <= 5 )
          {
            v51 = "%s SRV value wrong length type %u bytes %u\n";
            v52 = (__int64)"initWithUserAddress";
            v26 = 2LL;
            goto LABEL_93;
          }
          if ( copyin(v33 + (unsigned int)v107 + 4, &buf, v106) )
          {
            v81 = *(_WORD *)(v20 + 80);
            v82 = "%s can't copyin tlv data len %u\n";
LABEL_120:
            _userPrint(v3, v82, (__int64)"initWithUserAddress", v81, v79, v80, v96);
            goto LABEL_65;
          }
          v91 = (unsigned __int64)putAsNameD2Dv1(&word_848A6, v78, (unsigned __int8)v106 - 6, v106 - 6, v80) + 6;
          *(_WORD *)(v20 + 80) = v91;
          LODWORD(v92) = kalloc(v91);
          *(_QWORD *)(v20 + 40) = v92;
          if ( !v92 )
          {
            v81 = *(_WORD *)(v20 + 80);
            v82 = "%s can't allocate value %u bytes\n";
            goto LABEL_120;
          }
          memcpy(v92, &buf, 6uLL);
          memcpy((void *)(*(_QWORD *)(v20 + 40) + 6LL), &bufout, *(_WORD *)(v20 + 80) - 6LL);
          v94 = (unsigned __int64)compressAwdl(
                                    (unsigned __int8 *)(*(_QWORD *)(v20 + 40) + 6LL),
                                    (unsigned int)*(_WORD *)(v20 + 80) - 6,
                                    *(unsigned __int8 **)(v20 + 48),
                                    *(_WORD *)(v20 + 78),
                                    v93)
              + 6;
          *(_WORD *)(v20 + 84) = v94;
          if ( v94 <= 6u )
          {
            v81 = *(_WORD *)(v20 + 80);
            v82 = "%s SRVcan't compress DATA %u bytes\n";
            goto LABEL_120;
          }
          LODWORD(v95) = kalloc(v94);
          *(_QWORD *)(v20 + 64) = v95;
          if ( !v95 )
          {
            v81 = *(_WORD *)(v20 + 84);
            v82 = "%s SRVcan't allocate compressed DATA %u bytes\n";
            goto LABEL_120;
          }
          memcpy(v95, *(const void **)(v20 + 40), 6uLL);
          v90 = (void *)(*(_QWORD *)(v20 + 64) + 6LL);
          v24 = *(_WORD *)(v20 + 84) - 6LL;
          goto LABEL_115;
        }
        if ( (unsigned __int8)v26 == 12 )
        {
          if ( v106 >= 0x1F5 )
          {
            v29 = "%s PTR value wrong length type %u bytes %u\n";
            v31 = (__int64)"initWithUserAddress";
            v32 = v3;
            goto LABEL_27;
          }
          v75 = copyin(v33 + (unsigned int)v107 + 4, &buf, v106);
          v24 = v106;
          if ( !v75 )
          {
            v83 = putAsNameD2Dv1(&buf, v76, (unsigned __int64)&buf, v106, v23);
            *(_WORD *)(v20 + 80) = v83;
            LODWORD(v84) = kalloc(v83);
            *(_QWORD *)(v20 + 40) = v84;
            if ( !v84 )
            {
              _userPrint(
                v3,
                "%s can't allocate value %u bytes\n",
                (__int64)"initWithUserAddress",
                *(_WORD *)(v20 + 80),
                v85,
                v86,
                v96);
              goto LABEL_65;
            }
            memcpy(v84, &bufout, *(_WORD *)(v20 + 80));
            v88 = compressAwdl(
                    *(unsigned __int8 **)(v20 + 40),
                    *(_WORD *)(v20 + 80),
                    *(unsigned __int8 **)(v20 + 48),
                    *(_WORD *)(v20 + 78),
                    v87);
            *(_WORD *)(v20 + 84) = v88;
            v89 = v88;
            if ( !v89 )
            {
              _userPrint(
                v3,
                "%s PTRcan't compress DATA %u bytes key len %u user_value_length %u\n",
                (__int64)"initWithUserAddress",
                *(_WORD *)(v20 + 80),
                *(_WORD *)(v20 + 78),
                v106,
                v96);
              goto LABEL_65;
            }
            LODWORD(v90) = kalloc(v89);
            *(_QWORD *)(v20 + 64) = v90;
            v24 = *(_WORD *)(v20 + 84);
            if ( !v90 )
            {
              v22 = (__int64)"initWithUserAddress";
              v37 = v3;
              v30 = "%s PTRcan't allocate compressed DATA %u bytes\n";
              v36 = (__int64)"initWithUserAddress";
              goto LABEL_64;
            }
LABEL_115:
            v50 = &bufout;
            memcpy(v90, &bufout, v24);
            goto LABEL_116;
          }
        }
        else
        {
          LODWORD(v73) = kalloc(v106);
          *(_QWORD *)(v20 + 40) = v73;
          if ( !v73 )
          {
            v24 = v106;
            v77 = "%s can't allocate value %u bytes\n";
            goto LABEL_102;
          }
          v50 = v73;
          v74 = copyin(v33 + (unsigned int)v107 + 4, v73, v106);
          v24 = v106;
          if ( !v74 )
          {
            *(_WORD *)(v20 + 80) = v106;
LABEL_116:
            v4 = v20;
            if ( (unsigned __int8)((int (__fastcall *)(__int64, unsigned __int8 *))`vtable for'IO80211QueueDescriptor[19])(
                                    v20,
                                    v50) )
            {
              *(_BYTE *)(v20 + 12) = _do_crc8_ccitt(*(_WORD *)(v20 + 78), *(unsigned __int8 **)(v20 + 48));
              return 1;
            }
            v13 = "%s init failed\n";
            goto LABEL_12;
          }
        }
        v77 = "%s can't copyin tlv data len %u\n";
LABEL_102:
        v22 = (__int64)"initWithUserAddress";
        v37 = v3;
        v30 = v77;
        v36 = (__int64)"initWithUserAddress";
        goto LABEL_64;
      }
      v30 = "%s can't allocate compressed KEY %u bytes\n";
LABEL_82:
      v36 = (__int64)"initWithUserAddress";
      goto LABEL_31;
    }
    v24 = *(_WORD *)(v20 + 78);
    v30 = "%s can't compress KEY %u bytes\n";
LABEL_62:
    v36 = (__int64)"initWithUserAddress";
    goto LABEL_63;
  }
  v101 = a2;
  v71 = *(_BYTE *)v19;
  if ( v71 > 0x12 )
    *(_QWORD *)v72 = "UNKNOWN";
  else
    *(_QWORD *)v72 = off_81510[v71];
  v4 = v20;
  _userPrint(v3, "%s null key type %s\n", (__int64)"initWithUserAddress", *(__int64 *)v72, v22, v23, v96);
LABEL_65:
  _userPrint(v3, "TLV Error: \n", v14, v15, v16, v17, v97);
  v53 = 0;
  do
  {
    v103 = 0;
    if ( copyin(v101 + v53, &v103, 1LL) )
    {
      v69 = (__int64)" -- copyin error i=%u\n";
      _userPrint(v3, " -- copyin error i=%u\n", v53, v54, v55, v56, v98);
      goto LABEL_77;
    }
    _userPrint(v3, " %02x", v103, v54, v55, v56, v98);
    ++v53;
  }
  while ( v53 < (unsigned int)v105 + 3 );
  _userPrint(v3, "\n", v57, v58, v59, v60, v98);
  v61 = 0;
  while ( 1 )
  {
    v102 = 0;
    if ( copyin(v101 + v61, &v102, 1LL) )
      break;
    if ( (unsigned __int8)(v102 - 20) > 0x6Au )
      _userPrint(v3, ".", v102, v62, v63, v64, v99);
    else
      _userPrint(v3, "%c", v102, v62, v63, v64, v99);
    ++v61;
    if ( v61 >= (unsigned int)v105 + 3 )
    {
      v69 = (__int64)"\n";
      _userPrint(v3, "\n", v65, v66, v67, v68, v99);
      goto LABEL_77;
    }
  }
  v69 = (__int64)" -- copyin error i=%u\n";
  _userPrint(v3, " -- copyin error i=%u\n", v61, v62, v63, v64, v99);
LABEL_77:
  (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v4 + 288LL))(v4, v69);
  return 0;
}
// 81510: using guessed type char *off_81510[19];
// 822A0: using guessed type __int64 `vtable for'IO80211QueueDescriptor[2];
// 84218: using guessed type int num_awdl_labels;
// 8421C: using guessed type int _serviceDescriptorAllocCount;
// 84BF0: using guessed type __int16 awdl_labels[];
// 84CD0: using guessed type int inited_awdl_compression;
// 84CE2: using guessed type __int16 word_84CE2;
// 84CE8: using guessed type __int64 qword_84CE8;
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C8A40: using guessed type int __fastcall copyin(_QWORD, _QWORD, _QWORD);
// C8BB8: using guessed type int __fastcall kalloc(_QWORD);

//----- (000000000005DF34) ----------------------------------------------------
__int64 __usercall putAsNameD2Dv1@<rax>(unsigned __int8 *a1@<rdi>, unsigned __int8 *a2@<rdx>, char a3@<al>, unsigned int a4@<esi>, __int64 a5@<r9>)
{
  __int64 v5; // r8@1
  int v6; // er12@1
  unsigned int v7; // er13@2
  signed int v8; // edx@3
  __int16 *v9; // r14@3
  signed int v10; // esi@6
  int v11; // er15@8
  unsigned int v12; // er15@9
  int v13; // eax@10
  __int64 v14; // rcx@13
  __int64 v15; // rdx@18
  char v17; // [sp-8h] [bp-30h]@1

  v17 = a3;
  v5 = a4;
  v6 = 0;
  if ( a4 )
  {
    v7 = 0;
    while ( 1 )
    {
      v8 = 0;
      v9 = &v1_labels;
      while ( a1[v7] != (unsigned int)(unsigned __int16)*v9 >> 8 || a1[v7 + 1] != (unsigned __int8)*v9 )
      {
        v9 += 8;
        ++v8;
        v10 = 0;
        if ( v8 >= 4 )
          goto LABEL_10;
      }
      v11 = 0;
      if ( v6 + (unsigned int)(unsigned __int16)v9[1] > 0x1FF )
        return (unsigned int)v11;
      v12 = v5;
      memcpy(&bufout + (unsigned int)v6, *((const void **)v9 + 1), (unsigned __int16)v9[1]);
      v5 = v12;
      v7 += 2;
      v10 = 1;
      v6 += (unsigned __int16)v9[1];
LABEL_10:
      v13 = v6 + 1;
      v11 = 0;
      if ( (unsigned int)(v6 + 1) > 0x1FF )
        break;
      if ( v10 )
      {
        v13 = v6;
      }
      else
      {
        v14 = v7++;
        *(&bufout + (unsigned int)v6) = a1[v14];
      }
      v6 = v13;
      if ( v7 >= (unsigned int)v5 )
        goto LABEL_17;
    }
  }
  else
  {
    v13 = 0;
LABEL_17:
    if ( *(&bufout + (unsigned int)(v13 - 1)) )
    {
      v15 = (unsigned int)v13++;
      *(&bufout + v15) = 0;
    }
    v11 = v13;
    if ( (unsigned __int8)byte_84890 != 170 )
    {
      _userPrint(0LL, "bufout overflow! %s %u\n", (__int64)"putAsNameD2Dv1", 1647LL, v5, a5, v17);
      memset(&bufout, 170, 0x210uLL);
    }
    if ( (unsigned __int8)byte_84AA0 != 170 )
    {
      _userPrint(0LL, "buf overflow! %s %u\n", (__int64)"putAsNameD2Dv1", 1647LL, v5, a5, v17);
      memset(&bufout, 170, 0x210uLL);
    }
  }
  return (unsigned int)v11;
}
// 84890: using guessed type char byte_84890;
// 84AA0: using guessed type char byte_84AA0;
// 84CE0: using guessed type __int16 v1_labels;

//----- (000000000005E0CA) ----------------------------------------------------
__int64 __fastcall compressAwdl(unsigned __int8 *a1, unsigned int a2, unsigned __int8 *a3, unsigned int a4, unsigned __int8 *a5)
{
  unsigned int v5; // er14@1
  __int64 result; // rax@1
  int v7; // edx@3
  int v8; // esi@3
  const char *v9; // r13@4
  int v10; // ebx@5
  int v11; // eax@7
  unsigned int v12; // er14@8
  signed __int64 v13; // r12@9
  const char *v14; // rsi@9
  size_t v15; // rdx@10
  int v16; // ecx@15
  __int16 v17; // ax@20
  size_t v18; // [sp+8h] [bp-68h]@3
  char *v19; // [sp+10h] [bp-60h]@1
  unsigned int v20; // [sp+18h] [bp-58h]@3
  bool v21; // [sp+27h] [bp-49h]@3
  unsigned int v22; // [sp+34h] [bp-3Ch]@1
  int v23; // [sp+38h] [bp-38h]@4
  int v24; // [sp+40h] [bp-30h]@4

  v19 = (char *)a3;
  v5 = a2;
  v22 = a2;
  result = 0LL;
  if ( !a1 || !a2 )
    return result;
  v20 = a4;
  v21 = a3 != 0LL && a4 != 0;
  v18 = a4;
  v7 = 0;
  v8 = 0;
  do
  {
    if ( !a1[v8] )
      return (unsigned int)v7;
    v24 = v8;
    v23 = v7;
    v9 = (const char *)&a1[v8];
    if ( !v21 || (v10 = v8 + v20, v8 + v20 > v5) || strncmp(v9, v19, v18) )
    {
      v11 = num_awdl_labels;
      if ( !num_awdl_labels )
      {
LABEL_15:
        v16 = v23 + 1;
        result = 0LL;
        v5 = v22;
        if ( (unsigned int)(v23 + 1) <= 0x1FF )
        {
          *(&bufout + (unsigned int)v23) = *v9;
          v10 = v24 + 1;
          goto LABEL_17;
        }
        return result;
      }
      v12 = 0;
      while ( 1 )
      {
        v13 = 8LL * v12;
        v14 = *(const char **)&awdl_labels[v13 + 4];
        if ( v14 )
        {
          v15 = (unsigned __int16)awdl_labels[v13 + 1];
          if ( awdl_labels[v13 + 1] )
          {
            if ( (unsigned int)v15 <= v22 - v24 )
            {
              if ( !strncmp(v9, v14, v15) )
              {
                v16 = v23 + 2;
                result = 0LL;
                v5 = v22;
                if ( (unsigned int)(v23 + 2) <= 0x1FF )
                {
                  v17 = awdl_labels[v13];
                  *(&bufout + (unsigned int)v23) = HIBYTE(v17);
                  *(&bufout + (unsigned int)(v23 + 1)) = v17;
                  v10 = v24 + (unsigned __int16)awdl_labels[v13 + 1];
                  goto LABEL_17;
                }
                return result;
              }
              v11 = num_awdl_labels;
            }
          }
        }
        ++v12;
        if ( v12 >= v11 )
          goto LABEL_15;
      }
    }
    v16 = v23 + 2;
    result = 0LL;
    if ( (unsigned int)(v23 + 2) > 0x1FF )
      break;
    *(&bufout + (unsigned int)v23) = -64;
    *(&bufout + (unsigned int)(v23 + 1)) = 0;
LABEL_17:
    v7 = v16;
    v8 = v10;
    result = (unsigned int)v16;
  }
  while ( v10 < v5 );
  return result;
}
// 84218: using guessed type int num_awdl_labels;
// 84BF0: using guessed type __int16 awdl_labels[];

//----- (000000000005E27B) ----------------------------------------------------
__int64 __fastcall _do_crc8_ccitt(int a1, unsigned __int8 *a2)
{
  unsigned __int8 *v2; // rbx@1
  int v3; // er14@1
  __int64 v4; // rax@3
  unsigned __int8 v5; // dl@3
  __int64 v6; // rdx@4

  v2 = a2;
  v3 = a1;
  if ( !_crc8_ccitt_inited )
    _init_crc8_ccitt();
  v4 = 0LL;
  v5 = 0;
  if ( a1 )
  {
    do
    {
      v6 = *v2++;
      v5 = *((_BYTE *)crc8_table + (v4 ^ v6));
      v4 = v5;
      --v3;
    }
    while ( v3 );
  }
  return v5;
}
// 84AB0: using guessed type int _crc8_ccitt_inited;
// 84AC0: using guessed type __int64 crc8_table[32];

//----- (000000000005E2C6) ----------------------------------------------------
char __fastcall IO80211ServiceRequestDescriptor::initWithArpaTLV(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // r14@1
  __int64 v7; // r15@1
  __int64 v8; // rcx@1
  char *v9; // rsi@2
  __int64 v10; // rdx@2
  char v11; // r15@2
  unsigned __int16 v12; // ax@4
  void *v13; // rax@4
  __int64 v14; // r8@4
  __int64 v15; // r9@4
  __int64 v16; // rax@5
  int v17; // eax@6
  char v18; // dl@6
  unsigned int v19; // ecx@8
  char v20; // dl@8
  char v21; // cl@8
  int v22; // eax@10
  char v23; // dl@10
  unsigned int v24; // ecx@12
  char v25; // dl@12
  char v26; // cl@12
  int v27; // eax@14
  char v28; // dl@14
  unsigned int v29; // ecx@16
  char v30; // dl@16
  char v31; // cl@16
  int v32; // eax@18
  char v33; // dl@18
  unsigned int v34; // ecx@20
  char v35; // dl@20
  char v36; // cl@20
  int v37; // eax@22
  char v38; // dl@22
  unsigned int v39; // ecx@24
  char v40; // dl@24
  char v41; // cl@24
  int v42; // eax@26
  char v43; // dl@26
  int v44; // eax@28
  char v45; // dl@28
  __int64 v46; // rax@30
  char v47; // al@32
  __int64 v48; // rcx@32
  __int64 v49; // r8@32
  __int64 v50; // r9@32
  char *v51; // rsi@34
  __int64 v52; // rcx@37
  char *v53; // rsi@37
  __int64 v54; // r9@39
  char v56; // [sp+0h] [bp-20h]@0
  char v57; // [sp+0h] [bp-20h]@39

  v6 = a4;
  v7 = a3;
  v8 = *(_WORD *)(a2 + 1);
  if ( (unsigned __int16)(v8 - 2) >= 0x103u )
  {
    v9 = "%s wrong length %u bytes\n";
    v10 = (__int64)"initWithArpaTLV";
    v11 = 0;
LABEL_36:
    _userPrint(v6, v9, v10, v8, a5, a6, v56);
    return v11;
  }
  v8 = *(_BYTE *)(a2 + 3);
  if ( (_DWORD)v8 != 3 )
  {
    v9 = "%s unknown flags %x bytes\n";
    v10 = (__int64)"initWithArpaTLV";
    v11 = 0;
    goto LABEL_36;
  }
  *(_BYTE *)(a1 + 96) = 12;
  *(_WORD *)(a1 + 73) = 258;
  v12 = *(_WORD *)(a2 + 1) - 1;
  *(_WORD *)(a1 + 84) = v12;
  LODWORD(v13) = kalloc(v12);
  *(_QWORD *)(a1 + 64) = v13;
  if ( !v13 )
  {
    v52 = *(_WORD *)(a1 + 84);
    v53 = "%s SRVcan't allocate compressed DATA %u bytes\n";
LABEL_39:
    _userPrint(v6, v53, (__int64)"initWithArpaTLV", v52, v14, v15, v56);
LABEL_42:
    v11 = 0;
    _userPrint(
      v6,
      "%s parse error type %u record %u\n",
      (__int64)"initWithArpaTLV",
      *(_BYTE *)(a1 + 73),
      *(_BYTE *)(a1 + 96),
      v54,
      v57);
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 288LL))(a1, "%s parse error type %u record %u\n");
    return v11;
  }
  memcpy(v13, (const void *)(a2 + 4), *(_WORD *)(a1 + 84));
  memcpy((void *)(a1 + 97), (const void *)v7, 6uLL);
  *(_WORD *)(a1 + 78) = 74;
  LODWORD(v16) = kalloc(74LL);
  *(_QWORD *)(a1 + 48) = v16;
  if ( !v16 )
  {
    v52 = *(_WORD *)(a1 + 78);
    v53 = "%s SRVcan't allocate KEY  %u bytes\n";
    goto LABEL_39;
  }
  *(_BYTE *)v16 = 1;
  v17 = *(_BYTE *)(v7 + 5) & 0xF;
  v18 = v17 + 87;
  if ( (unsigned int)v17 < 0xA )
    v18 = v17 + 48;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 1LL) = v18;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 2LL) = 1;
  v19 = (unsigned int)*(_BYTE *)(v7 + 5) >> 4;
  v20 = v19 + 48;
  v21 = v19 + 87;
  if ( (unsigned int)*(_BYTE *)(v7 + 5) < 0xA0 )
    v21 = v20;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 3LL) = v21;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 4LL) = 1;
  v22 = *(_BYTE *)(v7 + 4) & 0xF;
  v23 = v22 + 87;
  if ( (unsigned int)v22 < 0xA )
    v23 = v22 + 48;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 5LL) = v23;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 6LL) = 1;
  v24 = (unsigned int)*(_BYTE *)(v7 + 4) >> 4;
  v25 = v24 + 48;
  v26 = v24 + 87;
  if ( (unsigned int)*(_BYTE *)(v7 + 4) < 0xA0 )
    v26 = v25;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 7LL) = v26;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 8LL) = 1;
  v27 = *(_BYTE *)(v7 + 3) & 0xF;
  v28 = v27 + 87;
  if ( (unsigned int)v27 < 0xA )
    v28 = v27 + 48;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 9LL) = v28;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 10LL) = 1;
  v29 = (unsigned int)*(_BYTE *)(v7 + 3) >> 4;
  v30 = v29 + 48;
  v31 = v29 + 87;
  if ( (unsigned int)*(_BYTE *)(v7 + 3) < 0xA0 )
    v31 = v30;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 11LL) = v31;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 12LL) = 1;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 13LL) = 101;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 14LL) = 1;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 15LL) = 102;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 16LL) = 1;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 17LL) = 102;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 18LL) = 1;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 19LL) = 102;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 20LL) = 1;
  v32 = *(_BYTE *)(v7 + 2) & 0xF;
  v33 = v32 + 87;
  if ( (unsigned int)v32 < 0xA )
    v33 = v32 + 48;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 21LL) = v33;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 22LL) = 1;
  v34 = (unsigned int)*(_BYTE *)(v7 + 2) >> 4;
  v35 = v34 + 48;
  v36 = v34 + 87;
  if ( (unsigned int)*(_BYTE *)(v7 + 2) < 0xA0 )
    v36 = v35;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 23LL) = v36;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 24LL) = 1;
  v37 = *(_BYTE *)(v7 + 1) & 0xF;
  v38 = v37 + 87;
  if ( (unsigned int)v37 < 0xA )
    v38 = v37 + 48;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 25LL) = v38;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 26LL) = 1;
  v39 = (unsigned int)*(_BYTE *)(v7 + 1) >> 4;
  v40 = v39 + 48;
  v41 = v39 + 87;
  if ( (unsigned int)*(_BYTE *)(v7 + 1) < 0xA0 )
    v41 = v40;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 27LL) = v41;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 28LL) = 1;
  v42 = *(_BYTE *)v7 & 0xD;
  v43 = v42 + 87;
  if ( (unsigned int)v42 < 0xA )
    v43 = v42 + 48;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 29LL) = v43;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 30LL) = 1;
  v44 = *(_BYTE *)v7 & 0xF;
  v45 = v44 + 87;
  if ( (unsigned int)v44 < 0xA )
    v45 = v44 + 48;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 31LL) = v45;
  v46 = 0LL;
  do
  {
    *(_BYTE *)(*(_QWORD *)(a1 + 48) + 2 * v46 + 32) = 1;
    *(_BYTE *)(*(_QWORD *)(a1 + 48) + 2 * v46++ + 33) = 0;
  }
  while ( v46 != 13 );
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 58LL) = 1;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 59LL) = 56;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 60LL) = 1;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 61LL) = 101;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 62LL) = 1;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 63LL) = 102;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 64LL) = 3;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 65LL) = 105;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 66LL) = 112;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 67LL) = 54;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 68LL) = 4;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 69LL) = 97;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 70LL) = 114;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 71LL) = 112;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 72LL) = 97;
  *(_BYTE *)(*(_QWORD *)(a1 + 48) + 73LL) = 0;
  v47 = ((int (__fastcall *)(__int64, __int64))`vtable for'IO80211QueueDescriptor[19])(a1, v7);
  if ( !v47 )
  {
    v51 = "%s init failed\n";
    goto LABEL_41;
  }
  v11 = 1;
  if ( (signed int)IO80211ServiceRequestDescriptor::awdlUncompressData(v47, a1, v6) < 0 )
  {
    v51 = "%s awdlUncompressData failed\n";
LABEL_41:
    _userPrint(v6, v51, (__int64)"initWithArpaTLV", v48, v49, v50, v56);
    goto LABEL_42;
  }
  return v11;
}
// 822A0: using guessed type __int64 `vtable for'IO80211QueueDescriptor[2];
// C8BB8: using guessed type int __fastcall kalloc(_QWORD);

//----- (000000000005E720) ----------------------------------------------------
__int64 __usercall IO80211ServiceRequestDescriptor::awdlUncompressData@<rax>(char a1@<al>, __int64 a2@<rdi>, __int64 a3@<rsi>)
{
  __int64 v3; // r14@1
  unsigned int v4; // er15@1
  unsigned __int8 *v5; // r8@2
  unsigned int v6; // er9@3
  OSMetaClass *v7; // rax@4
  __int64 v8; // rdx@4
  __int64 v9; // r9@4
  __int64 v10; // r8@4
  char *v11; // rsi@4
  int v13; // eax@7
  unsigned int v14; // ecx@9
  OSMetaClass *v15; // rax@14
  __int64 v16; // rdx@14
  __int64 v17; // r8@14
  __int64 v18; // r9@14
  char *v19; // rsi@14
  unsigned __int16 v20; // ax@16
  unsigned int v21; // eax@16
  void *v22; // rax@17
  __int64 v23; // r8@18
  __int64 v24; // r9@18
  char *v25; // rsi@21
  __int64 v26; // rdx@21
  __int64 v27; // rcx@21
  OSMetaClass *v28; // rax@22
  unsigned __int16 v29; // ax@23
  unsigned int v30; // eax@23
  void *v31; // rax@24
  OSMetaClass *v32; // rax@30
  OSMetaClass *v33; // rax@32
  char v34; // [sp-8h] [bp-20h]@1

  v34 = a1;
  v3 = a3;
  v4 = 0;
  if ( *(_BYTE *)(a2 + 73) != 2 )
    return v4;
  v5 = *(unsigned __int8 **)(a2 + 48);
  if ( !v5 || (v6 = *(_WORD *)(a2 + 78), v6 <= 1) )
  {
    LODWORD(v7) = (*(int (__cdecl **)(__int64))(*(_QWORD *)a2 + 56LL))(a2);
    v8 = OSMetaClass::getClassName(v7);
    v10 = *(_WORD *)(a2 + 82);
    v11 = "%s::%s no key len %u\n";
LABEL_5:
    _userPrint(v3, v11, v8, (__int64)"awdlUncompressData", v10, v9, v34);
    return -1;
  }
  v13 = *(_BYTE *)(a2 + 96);
  if ( v13 != 12 && (unsigned __int8)v13 != 33 )
    return v4;
  v14 = *(_WORD *)(a2 + 84);
  if ( !*(_WORD *)(a2 + 84) && !*(_QWORD *)(a2 + 64) )
  {
    LODWORD(v28) = (*(int (__cdecl **)(__int64))(*(_QWORD *)a2 + 56LL))(a2);
    v16 = OSMetaClass::getClassName(v28);
    v19 = "%s::%s no compressed data\n";
    goto LABEL_31;
  }
  if ( !*(_BYTE *)(a2 + 74) )
    return v4;
  v13 = (unsigned __int8)v13;
  if ( (unsigned __int8)v13 == 33 )
  {
    if ( v14 <= 6 )
    {
      LODWORD(v15) = (*(int (__cdecl **)(__int64))(*(_QWORD *)a2 + 56LL))(a2);
      v16 = OSMetaClass::getClassName(v15);
      v19 = "%s::%s SRV short data\n";
LABEL_31:
      _userPrint(v3, v19, v16, (__int64)"awdlUncompressData", v17, v18, v34);
      return -1;
    }
    v29 = (unsigned __int64)uncompressAwdl(
                              &bufout,
                              512,
                              (unsigned __int8 *)(*(_QWORD *)(a2 + 64) + 6LL),
                              v14 - 6,
                              v5,
                              v6)
        + 6;
    *(_WORD *)(a2 + 80) = v29;
    v30 = v29;
    if ( v30 )
    {
      LODWORD(v31) = kalloc(v30);
      *(_QWORD *)(a2 + 40) = v31;
      if ( v31 )
      {
        memcpy(v31, *(const void **)(a2 + 64), 6uLL);
        memcpy((void *)(*(_QWORD *)(a2 + 40) + 6LL), &bufout, *(_WORD *)(a2 + 80) - 6LL);
        if ( (unsigned __int8)byte_84890 != 170 )
        {
          _userPrint(a3, "bufout overflow! %s %u\n", (__int64)"awdlUncompressData", 1815LL, v23, v24, v34);
          memset(&bufout, 170, 0x210uLL);
        }
        if ( (unsigned __int8)byte_84AA0 != 170 )
        {
          v25 = "buf overflow! %s %u\n";
          v26 = (__int64)"awdlUncompressData";
          v4 = 0;
          v27 = 1815LL;
          goto LABEL_29;
        }
        return v4;
      }
LABEL_32:
      LODWORD(v33) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)a2 + 56LL))(a2, 512LL);
      v8 = OSMetaClass::getClassName(v33);
      v10 = *(_WORD *)(a2 + 80);
      v11 = "%s::%s PTRcan't allocate data size %u\n";
      goto LABEL_5;
    }
LABEL_30:
    LODWORD(v32) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)a2 + 56LL))(a2, 512LL);
    v16 = OSMetaClass::getClassName(v32);
    v19 = "%s::%s PTRcan't uncompress data : short data\n";
    goto LABEL_31;
  }
  if ( v13 != 12 )
    return v4;
  v20 = uncompressAwdl(&bufout, 512, *(unsigned __int8 **)(a2 + 64), v14, v5, v6);
  *(_WORD *)(a2 + 80) = v20;
  v21 = v20;
  if ( !v21 )
    goto LABEL_30;
  LODWORD(v22) = kalloc(v21);
  *(_QWORD *)(a2 + 40) = v22;
  if ( !v22 )
    goto LABEL_32;
  memcpy(v22, &bufout, *(_WORD *)(a2 + 80));
  if ( (unsigned __int8)byte_84890 != 170 )
  {
    _userPrint(a3, "bufout overflow! %s %u\n", (__int64)"awdlUncompressData", 1790LL, v23, v24, v34);
    memset(&bufout, 170, 0x210uLL);
  }
  if ( (unsigned __int8)byte_84AA0 != 170 )
  {
    v25 = "buf overflow! %s %u\n";
    v26 = (__int64)"awdlUncompressData";
    v4 = 0;
    v27 = 1790LL;
LABEL_29:
    _userPrint(v3, v25, v26, v27, v23, v24, v34);
    memset(&bufout, 170, 0x210uLL);
  }
  return v4;
}
// 84890: using guessed type char byte_84890;
// 84AA0: using guessed type char byte_84AA0;
// C8BB8: using guessed type int __fastcall kalloc(_QWORD);

//----- (000000000005EA28) ----------------------------------------------------
char __fastcall IO80211ServiceRequestDescriptor::initWithTLVData(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // r14@1
  __int64 v7; // r15@1
  __int64 v8; // r13@1
  __int16 v9; // ax@1
  __int64 v10; // rcx@1
  signed __int64 v11; // rbx@2
  __int64 v12; // rdi@3
  void *v13; // rax@4
  signed __int64 v14; // rsi@5
  __int64 v15; // r9@5
  void *v16; // rax@9
  void *v17; // rax@11
  __int64 v18; // r8@11
  __int64 v19; // r9@11
  int v20; // ecx@12
  signed __int64 v21; // rax@12
  __int64 v22; // rax@13
  int v23; // edx@14
  int v24; // ecx@14
  __int64 v25; // rcx@16
  __int64 v26; // r8@16
  __int64 v27; // r9@16
  int v28; // eax@17
  char v29; // bl@20
  __int64 *v30; // r12@24
  __int64 v31; // rcx@25
  char *v32; // rsi@31
  __int64 v33; // rdx@32
  char *v34; // rsi@34
  __int64 v35; // r9@38
  char v37; // [sp+0h] [bp-40h]@0
  char v38; // [sp+0h] [bp-40h]@38
  unsigned __int16 v39; // [sp+14h] [bp-2Ch]@1
  unsigned __int16 v40; // [sp+16h] [bp-2Ah]@1

  v6 = a3;
  v7 = a2;
  v8 = a1;
  v9 = *(_WORD *)(a2 + 1);
  v10 = *(_BYTE *)a2;
  *(_BYTE *)(a1 + 73) = v10;
  v40 = 0;
  v39 = 0;
  *(_BYTE *)(a1 + 96) = 0;
  if ( (_DWORD)v10 == 1 )
  {
    *(_WORD *)(a1 + 82) = v9 - 4;
    *(_BYTE *)(a1 + 74) = 1;
    v11 = 7LL;
  }
  else
  {
    if ( (unsigned __int8)v10 != 2 )
    {
      v32 = "%s unknown type %u\n";
LABEL_37:
      v33 = (__int64)"initWithTLVData";
      goto LABEL_38;
    }
    v30 = (__int64 *)(a1 + 84);
    if ( !(unsigned int)_service_response_tlv_checks(
                          (unsigned __int8 *)a2,
                          (unsigned __int8)(v9 + 3),
                          (unsigned __int16 *)(a1 + 84),
                          &v40,
                          &v39,
                          (unsigned __int16 *)(a1 + 82),
                          (unsigned __int8 *)(a1 + 96)) )
    {
      v10 = *(_BYTE *)(a1 + 73);
      v32 = "%s fails tlv response checks type %u\n";
      goto LABEL_37;
    }
    v31 = v40;
    if ( !v40 && *(_WORD *)v30 == v39 )
      *(_BYTE *)(a1 + 74) = 1;
    v11 = 5LL;
    if ( v6 )
    {
      v11 = 5LL;
      if ( *(_DWORD *)(v6 + 52) )
      {
        _userPrint(
          v6,
          "%s value_offset %u compressed_data_length %u value_present %u\n",
          (__int64)"initWithTLVData",
          v31,
          *(_WORD *)v30,
          v39,
          v37);
        v11 = 5LL;
      }
    }
  }
  v12 = *(_WORD *)(a1 + 82);
  if ( !*(_WORD *)(v8 + 82) )
  {
    v32 = "%s short compressed_key_length %u\n";
    v33 = (__int64)"initWithTLVData";
    v10 = 0LL;
LABEL_38:
    _userPrint(v6, v32, v33, v10, a5, a6, v37);
LABEL_39:
    v29 = 0;
    _userPrint(
      v6,
      "%s parse error type %u record %u\n",
      (__int64)"initWithTLVData",
      *(_BYTE *)(v8 + 73),
      *(_BYTE *)(v8 + 96),
      v35,
      v38);
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v8 + 288LL))(v8, "%s parse error type %u record %u\n");
    return v29;
  }
  LODWORD(v13) = kalloc(v12);
  *(_QWORD *)(v8 + 56) = v13;
  if ( !v13 )
  {
    v10 = *(_WORD *)(v8 + 78);
    v32 = "%s can't allocate KEY %u bytes\n";
    goto LABEL_37;
  }
  v14 = a2 + v11;
  memcpy(v13, (const void *)(v7 + v11), *(_WORD *)(v8 + 82));
  if ( v6 && *(_DWORD *)(v6 + 52) )
  {
    v14 = (signed __int64)"%s mDNSType %u compressed_key_length %u\n";
    _userPrint(
      v6,
      "%s mDNSType %u compressed_key_length %u\n",
      (__int64)"initWithTLVData",
      *(_BYTE *)(v8 + 96),
      *(_WORD *)(v8 + 82),
      v15,
      v37);
  }
  if ( *(_BYTE *)(v8 + 73) != 2 )
    goto LABEL_16;
  LODWORD(v16) = kalloc(*(_WORD *)(v8 + 84));
  *(_QWORD *)(v8 + 64) = v16;
  if ( !v16 )
  {
    v10 = *(_WORD *)(v8 + 80);
    v32 = "%s can't allocate value %u bytes\n";
    goto LABEL_37;
  }
  bzero(v16, *(_WORD *)(v8 + 84));
  v14 = v7 + *(_WORD *)(v8 + 82) + v11 + 5;
  memcpy((void *)(*(_QWORD *)(v8 + 64) + v40), (const void *)v14, v39);
  if ( !*(_BYTE *)(v8 + 74) )
  {
    LODWORD(v17) = kalloc(256LL);
    *(_QWORD *)(v8 + 112) = v17;
    if ( !v17 )
    {
      _userPrint(v6, "%s can't allocate fragments %lu bytes\n", (__int64)"initWithTLVData", 256LL, v18, v19, v37);
      goto LABEL_39;
    }
    v14 = 256LL;
    bzero(v17, 0x100uLL);
    v20 = 0;
    v21 = 0LL;
    if ( v40 )
    {
      v22 = *(_QWORD *)(v8 + 112);
      *(_WORD *)v22 = 0;
      *(_WORD *)(v22 + 2) = v40;
      v21 = 1LL;
      v20 = v40;
    }
    v23 = v20 + v39;
    v24 = *(_WORD *)(v8 + 80);
    if ( v23 < v24 )
    {
      v14 = *(_QWORD *)(v8 + 112);
      *(_WORD *)(v14 + 4 * v21) = v23;
      *(_WORD *)(v14 + 4 * v21 + 2) = v24;
    }
  }
LABEL_16:
  if ( !(unsigned __int8)((int (__fastcall *)(__int64, signed __int64))`vtable for'IO80211QueueDescriptor[19])(v8, v14) )
  {
    v34 = "%s init failed\n";
LABEL_43:
    _userPrint(v6, v34, (__int64)"initWithTLVData", v25, v26, v27, v37);
    goto LABEL_39;
  }
  v28 = IO80211ServiceRequestDescriptor::awdlUncompressKey(v8, v6);
  if ( v28 < 0 )
  {
    v34 = "%s can't uncompress key\n";
    goto LABEL_43;
  }
  if ( *(_BYTE *)(v8 + 74) && (signed int)IO80211ServiceRequestDescriptor::awdlUncompressData(v28, v8, v6) < 0 )
  {
    v34 = "%s can't uncompress data\n";
    goto LABEL_43;
  }
  *(_BYTE *)(v8 + 12) = _do_crc8_ccitt(*(_WORD *)(v8 + 78), *(unsigned __int8 **)(v8 + 48));
  v29 = 1;
  if ( v6 && *(_DWORD *)(v6 + 52) )
    (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v8 + 280LL))(v8, v6);
  return v29;
}
// 822A0: using guessed type __int64 `vtable for'IO80211QueueDescriptor[2];
// C8BB8: using guessed type int __fastcall kalloc(_QWORD);

//----- (000000000005ED9F) ----------------------------------------------------
__int64 __fastcall _service_response_tlv_checks(unsigned __int8 *a1, unsigned int a2, unsigned __int16 *a3, unsigned __int16 *a4, unsigned __int16 *a5, unsigned __int16 *a6, unsigned __int8 *a7)
{
  __int64 result; // rax@1
  unsigned int v8; // er15@9
  int v9; // er11@11
  unsigned __int16 v10; // si@13
  int v11; // esi@13

  result = 0LL;
  if ( a3 )
  {
    if ( a1 )
    {
      if ( a4 )
      {
        if ( a5 )
        {
          if ( a6 )
          {
            if ( a7 )
            {
              a2 = (unsigned __int8)a2;
              if ( (unsigned __int8)a2 >= 3u && *a1 == 2 )
              {
                v8 = *(_WORD *)(a1 + 1);
                if ( v8 + 3 == a2 && a2 >= 9 )
                {
                  v9 = *(_WORD *)(a1 + 3);
                  if ( (unsigned __int16)(v9 - 2) <= 0xFEu && v9 + 5 < v8 )
                  {
                    *a3 = *(_WORD *)&a1[v9 + 5];
                    *a4 = *(_WORD *)&a1[v9 + 7];
                    v10 = a2 - 9 - v9;
                    *a5 = v10;
                    v11 = v10;
                    if ( v11 )
                    {
                      if ( v11 + *a4 <= *a3 )
                      {
                        *a6 = v9 - 1;
                        *a7 = a1[v9 + 4];
                        result = 1LL;
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return result;
}

//----- (000000000005EE7A) ----------------------------------------------------
signed __int64 __fastcall IO80211ServiceRequestDescriptor::awdlUncompressKey(__int64 a1, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 v3; // rbx@1
  unsigned __int8 *v4; // rdx@1
  signed __int64 v5; // rsi@3
  unsigned __int16 v6; // ax@3
  __int64 v7; // rdx@3
  __int64 v8; // rdi@4
  void *v9; // rax@6
  OSMetaClass *v11; // rax@8
  __int64 v12; // rdx@8
  __int64 v13; // r9@8
  __int64 v14; // r8@8
  char *v15; // rsi@8
  OSMetaClass *v16; // rax@10
  __int64 v17; // rax@10
  __int64 v18; // r8@10
  __int64 v19; // r9@10
  OSMetaClass *v20; // rax@12
  char v21; // [sp+0h] [bp-10h]@0

  v2 = a2;
  v3 = a1;
  v4 = *(unsigned __int8 **)(a1 + 56);
  if ( !v4 || !*(_WORD *)(a1 + 82) )
  {
    LODWORD(v11) = (*(int (**)(void))(*(_QWORD *)a1 + 56LL))();
    v12 = OSMetaClass::getClassName(v11);
    v14 = *(_WORD *)(a1 + 82);
    v15 = "%s::%s no compressed key len %u\n";
LABEL_9:
    _userPrint(v2, v15, v12, (__int64)"awdlUncompressKey", v14, v13, v21);
    return 0xFFFFFFFFLL;
  }
  v5 = 512LL;
  v6 = uncompressAwdl(&bufout, 512, v4, *(_WORD *)(a1 + 82), 0LL, 0);
  *(_WORD *)(a1 + 78) = v6;
  if ( v6 )
  {
    v8 = *(_QWORD *)(a1 + 48);
    if ( v8 )
    {
      v5 = v6;
      kfree(v8, v6);
      *(_QWORD *)(v3 + 48) = 0LL;
      v6 = *(_WORD *)(v3 + 78);
    }
    LODWORD(v9) = kalloc(v6);
    *(_QWORD *)(v3 + 48) = v9;
    if ( v9 )
    {
      memcpy(v9, &bufout, *(_WORD *)(v3 + 78));
      return 0LL;
    }
    LODWORD(v20) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v3 + 56LL))(v3, v5);
    v12 = OSMetaClass::getClassName(v20);
    v14 = *(_WORD *)(v3 + 78);
    v15 = "%s::%s can't allocate key len %u\n";
    goto LABEL_9;
  }
  LODWORD(v16) = (*(int (__fastcall **)(__int64, signed __int64, __int64, _QWORD))(*(_QWORD *)a1 + 56LL))(
                   a1,
                   512LL,
                   v7,
                   0LL);
  v17 = OSMetaClass::getClassName(v16);
  _userPrint(v2, "%s::%s can't uncompress : short key\n", v17, (__int64)"awdlUncompressKey", v18, v19, v21);
  return 0xFFFFFFFFLL;
}
// C8BB8: using guessed type int __fastcall kalloc(_QWORD);
// C8BC8: using guessed type int __fastcall kfree(_QWORD, _QWORD);

//----- (000000000005EF9A) ----------------------------------------------------
int __fastcall IO80211ServiceRequestDescriptor::freeResources(IO80211ServiceRequestDescriptor *this)
{
  IO80211ServiceRequestDescriptor *v1; // rbx@1
  __int64 v2; // rdi@1
  int result; // eax@2
  __int64 v4; // rdi@3
  __int64 v5; // rdi@5
  __int64 v6; // rdi@7
  __int64 v7; // rdi@9
  __int64 v8; // rdi@11

  v1 = this;
  v2 = *((_QWORD *)this + 5);
  if ( v2 )
  {
    result = kfree(v2, *((_WORD *)v1 + 40));
    *((_QWORD *)v1 + 5) = 0LL;
  }
  v4 = *((_QWORD *)v1 + 6);
  if ( v4 )
  {
    result = kfree(v4, *((_WORD *)v1 + 39));
    *((_QWORD *)v1 + 6) = 0LL;
  }
  v5 = *((_QWORD *)v1 + 7);
  if ( v5 )
  {
    result = kfree(v5, *((_WORD *)v1 + 41));
    *((_QWORD *)v1 + 7) = 0LL;
  }
  v6 = *((_QWORD *)v1 + 8);
  if ( v6 )
  {
    result = kfree(v6, *((_WORD *)v1 + 42));
    *((_QWORD *)v1 + 8) = 0LL;
  }
  v7 = *((_QWORD *)v1 + 6);
  if ( v7 )
  {
    result = kfree(v7, *((_WORD *)v1 + 39));
    *((_QWORD *)v1 + 6) = 0LL;
  }
  v8 = *((_QWORD *)v1 + 14);
  if ( v8 )
  {
    result = kfree(v8, 256LL);
    *((_QWORD *)v1 + 14) = 0LL;
  }
  *(_DWORD *)((char *)v1 + 78) = 0;
  return result;
}
// C8BC8: using guessed type int __fastcall kfree(_QWORD, _QWORD);

//----- (000000000005F04E) ----------------------------------------------------
__int64 __fastcall _service_response_get_hash(unsigned __int8 *a1, unsigned __int8 a2, unsigned __int8 *a3, unsigned __int8 *a4)
{
  unsigned __int8 *v4; // r15@1
  signed int v5; // er14@1
  unsigned __int16 v6; // ax@5
  unsigned __int16 v8; // [sp+8h] [bp-28h]@3
  unsigned __int16 v9; // [sp+Ah] [bp-26h]@3
  unsigned __int16 v10; // [sp+Ch] [bp-24h]@3
  unsigned __int16 v11; // [sp+Eh] [bp-22h]@3

  v4 = a3;
  v5 = -1;
  if ( a3 && a4 && (unsigned int)_service_response_tlv_checks(a1, a2, &v11, &v10, &v9, &v8, a4) && v8 )
  {
    v5 = 0;
    v6 = uncompressAwdl(&bufout, 500, a1 + 5, v8, 0LL, 0);
    *v4 = _do_crc8_ccitt(v6, &bufout);
  }
  return (unsigned int)v5;
}

//----- (000000000005F0E1) ----------------------------------------------------
__int64 __fastcall uncompressAwdl(unsigned __int8 *a1, int a2, unsigned __int8 *a3, unsigned int a4, unsigned __int8 *a5, unsigned int a6)
{
  unsigned int v6; // er12@1
  unsigned __int8 *v7; // r13@1
  __int64 result; // rax@1
  int v9; // er15@5
  int v10; // er8@5
  unsigned int v11; // er14@5
  int v12; // ecx@6
  int v13; // edi@8
  unsigned int v14; // er9@12
  const void *v15; // rsi@12
  __int64 v16; // r10@14
  unsigned int v17; // ebx@14
  __int64 v18; // rdx@14
  __int16 v19; // di@15
  int v20; // ebx@23
  __int64 v21; // rdx@26
  __int64 v22; // rax@31
  unsigned int v23; // [sp+4h] [bp-3Ch]@5
  size_t v24; // [sp+8h] [bp-38h]@1
  unsigned __int8 *v25; // [sp+10h] [bp-30h]@1

  v24 = (size_t)a5;
  v6 = a4;
  v7 = a3;
  v25 = a1;
  result = 0LL;
  if ( a1 && a2 && a3 && a4 )
  {
    v23 = a6;
    v9 = a2 - 1;
    result = 0LL;
    v10 = 0;
    v11 = 0;
    while ( 1 )
    {
      v12 = v7[v11];
      if ( !v7[v11] )
        return result;
      if ( (unsigned __int8)v12 < 0xC0u )
        break;
      v13 = v11 + 1;
      if ( v11 + 1 >= v6 )
        break;
      if ( (unsigned __int8)v12 != 192 || v7[v13] || !v24 || (v14 = v23, v15 = (const void *)v24, !v23) )
      {
        if ( !num_awdl_labels )
          break;
        v16 = (unsigned int)v13;
        v17 = 0;
        v18 = (__int64)awdl_labels;
        while ( 1 )
        {
          v19 = *(_WORD *)v18;
          if ( (unsigned int)*(_WORD *)v18 >> 8 == v12 && v7[v16] == (unsigned __int8)v19 )
          {
            v15 = *(const void **)(v18 + 8);
            if ( v15 )
            {
              v14 = *(_WORD *)(v18 + 2);
              if ( *(_WORD *)(v18 + 2) )
                break;
            }
          }
          v18 += 16LL;
          ++v17;
          if ( v17 >= num_awdl_labels )
            goto LABEL_25;
        }
      }
      if ( !v15 || !v14 )
        break;
      v20 = v14 + v10;
      if ( v14 + v10 > v9 )
        return result;
      memcpy(&v25[v10], v15, v14);
      result = 0LL;
      v11 += 2;
      v10 = v20;
LABEL_27:
      if ( v11 >= v6 )
      {
        if ( !v10 )
          return result;
        if ( v25[v10 - 1] )
        {
          if ( v10 >= (unsigned int)v9 )
            return result;
          v22 = (unsigned int)v10++;
          v25[v22] = 0;
        }
        return (unsigned int)v10;
      }
    }
LABEL_25:
    if ( v10 >= (unsigned int)v9 )
      return result;
    ++v11;
    v21 = (unsigned int)v10++;
    v25[v21] = v12;
    goto LABEL_27;
  }
  return result;
}
// 84218: using guessed type int num_awdl_labels;
// 84BF0: using guessed type __int16 awdl_labels[];

//----- (000000000005F261) ----------------------------------------------------
char __fastcall _service_response_init_context(__int64 a1, __int64 a2, unsigned __int8 a3)
{
  char v3; // r15@3
  int v4; // eax@3
  unsigned __int8 v6; // [sp+Dh] [bp-23h]@1
  unsigned __int16 v7; // [sp+Eh] [bp-22h]@1

  v7 = 0;
  v6 = 0;
  if ( a1
    && (unsigned int)_service_response_tlv_checks(
                       (unsigned __int8 *)a2,
                       a3,
                       (unsigned __int16 *)(a1 + 300),
                       (unsigned __int16 *)(a1 + 302),
                       (unsigned __int16 *)(a1 + 304),
                       &v7,
                       &v6) )
  {
    v3 = 0;
    v4 = uncompressAwdl((unsigned __int8 *)(a1 + 40), 256, (unsigned __int8 *)(a2 + 5), v7, 0LL, 0);
    *(_DWORD *)(a1 + 296) = v4;
    if ( v4 )
    {
      *(_BYTE *)(a1 + 306) = v6;
      *(_BYTE *)(a1 + 307) = _do_crc8_ccitt(v4, (unsigned __int8 *)(a1 + 40));
      v3 = 1;
    }
  }
  else
  {
    v3 = 0;
  }
  return v3;
}

//----- (000000000005F31C) ----------------------------------------------------
signed __int64 __fastcall _findTLV(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  int v4; // ecx@1
  signed __int64 result; // rax@1

  v3 = a3;
  v4 = IO80211ServiceRequestDescriptor::compare(a2, a3);
  result = 0LL;
  if ( !v4 )
  {
    *(_DWORD *)(v3 + 36) = *(_DWORD *)(a2 + 32);
    result = 1LL;
  }
  return result;
}

//----- (000000000005F34E) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::compare(__int64 a1, __int64 a2)
{
  __int64 v2; // r15@1
  signed int v3; // er14@1
  const void *v4; // rsi@2
  size_t v5; // rdx@3

  v2 = a2;
  v3 = 1;
  if ( *(_BYTE *)(a2 + 308) == *(_BYTE *)(a1 + 73) )
  {
    v4 = *(const void **)(a1 + 48);
    if ( v4 )
    {
      v5 = *(_WORD *)(a1 + 78);
      if ( (_DWORD)v5 == *(_DWORD *)(v2 + 296) && !memcmp((const void *)(v2 + 40), v4, v5) )
        v3 = *(_BYTE *)(v2 + 306) != *(_BYTE *)(a1 + 96);
    }
  }
  return (unsigned int)v3;
}

//----- (000000000005F3BA) ----------------------------------------------------
__int64 __fastcall _copyTLV(__int64 a1, __int64 a2, __int64 a3, __int64 *a4)
{
  __int64 *v4; // r13@1
  __int64 v5; // r14@1
  __int64 v6; // r15@1
  __int64 v7; // rdi@2
  __int64 v8; // rdx@4
  int v9; // er12@4
  char v10; // si@4
  __int16 v11; // ax@5
  int v12; // er8@12
  int v13; // ebx@13
  int v14; // ST20_4@13
  int v15; // ST10_4@13
  int v16; // ST08_4@13
  unsigned __int64 v17; // rax@14
  __int64 v18; // r9@14
  int v19; // eax@15
  int v20; // eax@17
  int v21; // ecx@18
  int v22; // ecx@23
  __int64 v23; // rax@24
  unsigned int v24; // ecx@25
  __int64 v25; // rsi@26
  signed int v26; // ebx@28
  __int64 v27; // rdi@31
  signed int v28; // eax@35
  __int64 v29; // rcx@38
  char v30; // al@39
  signed __int64 v31; // r12@39
  int v32; // edx@40
  int v33; // ecx@40
  unsigned __int16 v34; // dx@41
  __int64 v35; // rsi@54
  __int64 v36; // rcx@55
  __int64 v37; // r12@60
  __int64 v38; // rdi@61
  __int64 v39; // rdx@63
  int v40; // eax@66
  int v41; // eax@81
  __int64 v42; // r8@81
  char v44; // [sp+0h] [bp-80h]@0

  v4 = a4;
  v5 = a3;
  v6 = a2;
  if ( a4 )
  {
    v7 = *a4;
    if ( *a4 )
    {
      if ( *(_DWORD *)(v7 + 52) )
      {
        v8 = *(_BYTE *)(a2 + 12);
        v9 = *(_BYTE *)(a2 + 73);
        v10 = 0;
        if ( v9 == 2 )
        {
          v11 = *(_WORD *)(v6 + 84);
          if ( !v11 )
            v11 = *(_WORD *)(v6 + 80);
          v10 = v11 + *(_BYTE *)(v6 + 82) + 10;
        }
        else if ( (unsigned __int8)v9 == 1 )
        {
          v10 = *(_WORD *)(v6 + 82) + 8;
        }
        if ( *(_QWORD *)(v6 + 48) && *(_WORD *)(v6 + 78) )
          v12 = *(_BYTE *)(v6 + 96);
        v13 = *(_BYTE *)(((unsigned __int8)v8 >> 3) + v5 + 40);
        _bittest((const unsigned int *)&v13, v8 & 7);
        v14 = *(_DWORD *)(v5 + 28);
        v15 = *(_DWORD *)(v5 + 24);
        v16 = *(_BYTE *)(v5 + 33);
        _userPrint(
          v7,
          "_copyTLV hash 0x%02x numcopied %u maxlen %lu len %lu srvlen %lu match %u ctxtype %u srvtype %u ctxrecType %u srvrecType %u %s\n",
          v8,
          *(_DWORD *)(v5 + 72),
          *(_QWORD *)(v5 + 16),
          *(_QWORD *)(v5 + 8),
          v10);
      }
    }
  }
  v17 = strlen("wifid");
  if ( (signed int)IO80211ServiceRequestDescriptor::hasString((IO80211ServiceRequestDescriptor *)v6, "wifid", v17) < 0 )
  {
    v19 = *(_DWORD *)(v5 + 24);
    if ( !v19 || *(_BYTE *)(v6 + 73) == v19 )
    {
      v20 = *(_DWORD *)(v5 + 28);
      if ( !v20 )
        goto LABEL_87;
      v21 = 0;
      if ( *(_QWORD *)(v6 + 48) && *(_WORD *)(v6 + 78) )
        v21 = *(_BYTE *)(v6 + 96);
      if ( v21 == v20 )
      {
LABEL_87:
        if ( !*(_BYTE *)(v5 + 33)
          || (v22 = *(_BYTE *)((unsigned __int8)(*(_BYTE *)(v6 + 12) >> 3) + v5 + 40),
              _bittest((const unsigned int *)&v22, *(_BYTE *)(v6 + 12) & 7)) )
        {
          v23 = *(_QWORD *)(v5 + 88);
          if ( v23 )
          {
            v24 = *(_DWORD *)(v5 + 96);
            if ( v24 )
            {
              v25 = 0LL;
              while ( *(_DWORD *)(v6 + 32) != *(_DWORD *)(v23 + 4 * v25) )
              {
                ++v25;
                v26 = 0;
                if ( (unsigned int)v25 >= v24 )
                  return (unsigned int)v26;
              }
            }
          }
          v30 = *(_BYTE *)(v5 + 32);
          v31 = 4LL;
          if ( !v30 )
          {
            v32 = *(_BYTE *)(v6 + 73);
            v33 = 0;
            if ( v32 == 2 )
            {
              v34 = *(_WORD *)(v6 + 84);
              if ( !v34 )
                v34 = *(_WORD *)(v6 + 80);
              v33 = v34 + *(_WORD *)(v6 + 82) + 10;
            }
            else if ( (unsigned __int8)v32 == 1 )
            {
              v33 = *(_WORD *)(v6 + 82) + 8;
            }
            v31 = (unsigned int)v33;
          }
          v35 = *(_QWORD *)v5;
          if ( *(_QWORD *)v5 )
          {
            v36 = *(_QWORD *)(v5 + 8);
            if ( (unsigned __int64)(v36 + v31) > *(_QWORD *)(v5 + 16) )
            {
              ++*(_DWORD *)(v5 + 36);
LABEL_70:
              if ( !*(_QWORD *)v5 || (v26 = 3, *(_QWORD *)(v5 + 8) < *(_QWORD *)(v5 + 16)) )
                v26 = 0;
              return (unsigned int)v26;
            }
            if ( v30 )
              *(_DWORD *)(v35 + v36) = *(_DWORD *)(v6 + 32);
            else
              IO80211ServiceRequestDescriptor::copyData(
                (IO80211ServiceRequestDescriptor *)v6,
                (unsigned __int8 *)(v36 + v35));
          }
          v37 = *(_QWORD *)(v5 + 8) + v31;
          *(_QWORD *)(v5 + 8) = v37;
          if ( v4 )
          {
            v38 = *v4;
            if ( *v4 )
            {
              if ( *(_DWORD *)(v38 + 52) )
              {
                v39 = (__int64)&byte_690F5;
                if ( *(_BYTE *)(v5 + 32) )
                  v39 = (__int64)" copyAllocCount";
                _userPrint(v38, "_copyTLV%s num %u len %zu:\n", v39, *(_DWORD *)(v5 + 72), v37, v18, v44);
                (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v6 + 280LL))(v6, *v4);
              }
            }
          }
          ++*(_DWORD *)(v5 + 72);
          v40 = *(_DWORD *)(v5 + 24);
          if ( v40 == 2 )
          {
            ++*(_DWORD *)(v5 + 80);
          }
          else if ( v40 == 1 )
          {
            ++*(_DWORD *)(v5 + 76);
          }
          goto LABEL_70;
        }
      }
    }
  }
  v26 = 0;
  if ( !v4 )
    return (unsigned int)v26;
  v27 = *v4;
  if ( !*v4 || !*(_DWORD *)(v27 + 52) )
    return (unsigned int)v26;
  if ( !*(_QWORD *)(v6 + 48) || !*(_WORD *)(v6 + 78) )
    goto LABEL_80;
  v28 = *(_BYTE *)(v6 + 96);
  if ( v28 > 46 )
  {
    if ( v28 == 47 )
    {
      v29 = (__int64)" NSEC ";
      goto LABEL_81;
    }
LABEL_80:
    v29 = (__int64)&byte_690F5;
    goto LABEL_81;
  }
  if ( v28 > 9 )
  {
    if ( v28 > 32 )
    {
      if ( v28 == 33 )
      {
        v29 = (__int64)" SRV ";
        goto LABEL_81;
      }
    }
    else if ( v28 > 27 )
    {
      if ( v28 == 28 )
      {
        v29 = (__int64)" AAAA ";
        goto LABEL_81;
      }
    }
    else
    {
      if ( v28 == 10 )
      {
        v29 = (__int64)" NULL ";
        goto LABEL_81;
      }
      if ( v28 == 12 )
      {
        v29 = (__int64)" PTR ";
        goto LABEL_81;
      }
      if ( v28 == 16 )
      {
        v29 = (__int64)" TXT ";
        goto LABEL_81;
      }
    }
    goto LABEL_80;
  }
  if ( v28 != 1 )
    goto LABEL_80;
  v29 = (__int64)" A ";
LABEL_81:
  v41 = *(_BYTE *)((unsigned __int8)(*(_BYTE *)(v6 + 12) >> 3) + v5 + 40);
  v42 = (__int64)"!set";
  if ( _bittest((const unsigned int *)&v41, *(_BYTE *)(v6 + 12) & 7) )
    v42 = (__int64)"isSet";
  v26 = 0;
  _userPrint(v27, " bail out type %u %s %s\n", *(_BYTE *)(v6 + 73), v29, v42, v18, v44);
  return (unsigned int)v26;
}
// 690F5: using guessed type char byte_690F5;

//----- (000000000005F7C8) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::getLength(IO80211ServiceRequestDescriptor *this)
{
  int v1; // ecx@1
  __int64 result; // rax@1
  unsigned __int16 v3; // cx@2

  v1 = *((_BYTE *)this + 73);
  result = 0LL;
  if ( v1 == 2 )
  {
    v3 = *((_WORD *)this + 42);
    if ( !v3 )
      v3 = *((_WORD *)this + 40);
    result = v3 + *((_WORD *)this + 41) + 10LL;
  }
  else if ( (unsigned __int8)v1 == 1 )
  {
    result = *((_WORD *)this + 41) + 8LL;
  }
  return result;
}

//----- (000000000005F806) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::recordType(IO80211ServiceRequestDescriptor *this)
{
  __int64 result; // rax@3

  if ( *((_QWORD *)this + 6) && *((_WORD *)this + 39) )
    LOBYTE(result) = *((_BYTE *)this + 96);
  else
    LOBYTE(result) = 0;
  return (unsigned __int8)result;
}

//----- (000000000005F824) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::hasString(IO80211ServiceRequestDescriptor *this, const char *a2, unsigned __int64 a3)
{
  size_t v3; // r13@1
  IO80211ServiceRequestDescriptor *v4; // r12@1
  signed int v5; // er14@1
  __int64 v6; // rdi@3
  __int64 v7; // rax@4
  signed int v8; // ebx@5

  v3 = a3;
  v4 = this;
  v5 = -1;
  if ( a3 )
  {
    if ( a2 )
    {
      v6 = *((_QWORD *)this + 6);
      if ( v6 )
      {
        v7 = 0LL;
        if ( *((_WORD *)v4 + 39) > a3 )
        {
          v8 = 0;
          while ( memcmp((const void *)(v7 + v6), a2, v3) )
          {
            ++v8;
            v7 = (unsigned int)v8;
            if ( (unsigned int)v8 >= *((_WORD *)v4 + 39) - v3 )
              return (unsigned int)v5;
            v6 = *((_QWORD *)v4 + 6);
          }
          v5 = v8;
        }
      }
    }
  }
  return (unsigned int)v5;
}

//----- (000000000005F8A6) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::copyData(IO80211ServiceRequestDescriptor *this, unsigned __int8 *a2)
{
  IO80211ServiceRequestDescriptor *v2; // rbx@1
  __int64 result; // rax@1
  int v4; // eax@3
  __int16 v5; // cx@4
  __int16 v6; // ax@6
  int v7; // ecx@10
  __int16 v8; // cx@13
  __int16 v9; // cx@14
  size_t v10; // rdx@16
  unsigned __int8 *v11; // rdi@16
  const void *v12; // rsi@17
  unsigned __int16 v13; // cx@24

  v2 = this;
  result = 0LL;
  if ( !*((_QWORD *)this + 6) )
    return result;
  result = 0LL;
  if ( !*((_WORD *)this + 39) )
    return result;
  *a2 = *((_BYTE *)this + 73);
  v4 = *((_BYTE *)this + 73);
  if ( v4 == 2 )
  {
    v5 = *((_WORD *)this + 42);
    if ( !v5 )
      v5 = *((_WORD *)this + 40);
    v6 = v5 + *((_WORD *)this + 41) + 10;
  }
  else if ( (unsigned __int8)v4 == 1 )
  {
    v6 = *((_WORD *)this + 41) + 8;
  }
  else
  {
    v6 = 0;
  }
  *(_WORD *)(a2 + 1) = v6 - 3;
  v7 = *((_BYTE *)this + 73);
  if ( v7 == 2 )
  {
    result = 0LL;
    if ( !*((_QWORD *)this + 5) )
      return result;
    result = 0LL;
    if ( !*((_WORD *)this + 40) )
      return result;
    v8 = *((_WORD *)this + 41);
    result = 0LL;
    if ( !v8 )
      return result;
    *(_WORD *)(a2 + 3) = v8 + 1;
    memcpy(a2 + 5, *((const void **)this + 7), *((_WORD *)this + 41));
    a2[*((_WORD *)this + 41) + 5] = *((_BYTE *)this + 96);
    v9 = *((_WORD *)this + 42);
    if ( !v9 )
      v9 = *((_WORD *)this + 40);
    *(_WORD *)&a2[*((_WORD *)this + 41) + 6] = v9;
    *(_WORD *)&a2[*((_WORD *)this + 41) + 8] = 0;
    v10 = *((_WORD *)this + 42);
    v11 = &a2[*((_WORD *)this + 41) + 10];
    if ( *((_WORD *)v2 + 42) )
    {
      v12 = (const void *)*((_QWORD *)v2 + 8);
    }
    else
    {
      v12 = (const void *)*((_QWORD *)v2 + 5);
      v10 = *((_WORD *)v2 + 40);
    }
    memcpy(v11, v12, v10);
  }
  else
  {
    if ( (unsigned __int8)v7 != 1 )
      goto LABEL_23;
    *(_WORD *)(a2 + 3) = 0;
    *(_WORD *)(a2 + 5) = 0;
    memcpy(a2 + 7, *((const void **)this + 7), *((_WORD *)this + 41));
    a2[*((_WORD *)this + 41) + 7] = *((_BYTE *)this + 96);
  }
  LOBYTE(v7) = *((_BYTE *)v2 + 73);
LABEL_23:
  result = 0LL;
  v7 = (unsigned __int8)v7;
  if ( (unsigned __int8)v7 == 2 )
  {
    v13 = *((_WORD *)v2 + 42);
    if ( !v13 )
      v13 = *((_WORD *)v2 + 40);
    result = v13 + *((_WORD *)v2 + 41) + 10LL;
  }
  else if ( v7 == 1 )
  {
    result = *((_WORD *)v2 + 41) + 8LL;
  }
  return result;
}

//----- (000000000005FA22) ----------------------------------------------------
__int64 __fastcall _service_response_tlv_get_type(unsigned __int8 *a1, unsigned int a2)
{
  int v2; // ecx@1
  __int64 result; // rax@1
  unsigned __int8 v4; // [sp+17h] [bp-9h]@1
  unsigned __int16 v5; // [sp+18h] [bp-8h]@1
  unsigned __int16 v6; // [sp+1Ah] [bp-6h]@1
  unsigned __int16 v7; // [sp+1Ch] [bp-4h]@1
  unsigned __int16 v8; // [sp+1Eh] [bp-2h]@1

  v2 = _service_response_tlv_checks(a1, a2, &v8, &v7, &v6, &v5, &v4);
  result = 0xFFFFFFFFLL;
  if ( v2 )
    result = v4;
  return result;
}

//----- (000000000005FA5C) ----------------------------------------------------
__int64 __fastcall _compareServiceKeys(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // r15@1
  unsigned int v5; // ebx@1
  bool v6; // zf@1
  unsigned int v7; // er13@1
  __int64 v8; // rdi@1
  const void *v9; // rsi@3
  unsigned int v10; // eax@11
  int v11; // eax@13
  int v12; // er12@13
  __int64 v13; // rax@19
  unsigned __int8 v14; // dl@21
  __int64 v16; // rcx@26
  unsigned __int8 v17; // si@28
  unsigned __int8 v18; // al@33
  unsigned __int8 v19; // cl@37
  unsigned int v20; // eax@40
  unsigned int v21; // ecx@40

  v3 = a2;
  v4 = a1;
  v5 = 0;
  v6 = a1 == 0;
  v7 = 0;
  v8 = 0LL;
  if ( !v6 )
  {
    v7 = *(_WORD *)(v4 + 78);
    v8 = *(_QWORD *)(v4 + 48);
  }
  v9 = 0LL;
  if ( v3 )
  {
    v5 = *(_WORD *)(v3 + 78);
    v9 = *(const void **)(v3 + 48);
  }
  if ( v4 && v8 && v7 && v3 && v9 && v5 )
  {
    v10 = v5;
    if ( v7 < v5 )
      v10 = v7;
    v11 = memcmp((const void *)v8, v9, v10);
    v12 = 1;
    if ( v11 >= 0 )
    {
      v12 = 1;
      if ( v11 > 0 )
        v12 = -1;
      if ( v11 <= 0 && v7 >= v5 )
      {
        v12 = -1;
        if ( v7 <= v5 )
        {
          v13 = *(_QWORD *)(v4 + 48);
          if ( v13 && *(_WORD *)(v4 + 78) )
            v14 = *(_BYTE *)(v4 + 96);
          else
            v14 = 0;
          v16 = *(_QWORD *)(v3 + 48);
          if ( v16 && *(_WORD *)(v3 + 78) )
            v17 = *(_BYTE *)(v3 + 96);
          else
            v17 = 0;
          if ( v14 <= (unsigned int)v17 )
          {
            if ( v13 && *(_WORD *)(v4 + 78) )
              v18 = *(_BYTE *)(v4 + 96);
            else
              v18 = 0;
            if ( v16 && *(_WORD *)(v3 + 78) )
              v19 = *(_BYTE *)(v3 + 96);
            else
              v19 = 0;
            v12 = 1;
            if ( v18 >= (unsigned int)v19 )
            {
              v20 = *(_BYTE *)(v4 + 73);
              v21 = *(_BYTE *)(v3 + 73);
              v12 = -1;
              if ( v20 >= v21 )
                v12 = (unsigned __int8)v21 < (unsigned int)(unsigned __int8)v20 ? 1 : 0;
            }
          }
        }
      }
    }
  }
  else
  {
    v12 = 2;
    if ( a3 )
      _userPrint(a3, "_compareServiceKeys: Error: srv1 %p key1 %p %u, srv2 %p key2 %p %u\n", v4, v8, v7, v3, (char)v9);
  }
  return (unsigned int)v12;
}

//----- (000000000005FBE0) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::getDataLength(IO80211ServiceRequestDescriptor *this)
{
  __int64 result; // rax@1
  __int64 v2; // rcx@3

  result = *((_WORD *)this + 42);
  if ( !*((_WORD *)this + 42) || !*((_QWORD *)this + 8) )
  {
    v2 = *((_WORD *)this + 40);
    result = 0LL;
    if ( *((_WORD *)this + 40) )
    {
      if ( !*((_QWORD *)this + 5) )
        v2 = 0LL;
      result = v2;
    }
  }
  return result;
}

//----- (000000000005FC10) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::copyDataOnly(IO80211ServiceRequestDescriptor *this, unsigned __int8 *a2, unsigned __int64 a3)
{
  size_t v3; // rcx@1
  __int64 result; // rax@3

  v3 = *((_WORD *)this + 42);
  if ( *((_WORD *)this + 42) && *((_QWORD *)this + 8) )
  {
    result = 0LL;
    if ( v3 <= a3 )
    {
      memcpy(a2, *((const void **)this + 8), v3);
      result = *((_WORD *)this + 42);
    }
  }
  else
  {
    result = 0LL;
    if ( *((_WORD *)this + 40) )
    {
      result = 0LL;
      if ( *((_QWORD *)this + 5) )
      {
        result = 0LL;
        if ( *((_WORD *)this + 40) <= a3 )
        {
          memcpy(a2, *((const void **)this + 5), *((_WORD *)this + 40));
          result = *((_WORD *)this + 40);
        }
      }
    }
  }
  return result;
}

//----- (000000000005FC7C) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::copy(IO80211ServiceRequestDescriptor *this, unsigned __int64 a2)
{
  IO80211ServiceRequestDescriptor *v2; // r14@1
  __int64 v3; // r15@1
  __int64 v4; // rdx@1
  __int64 v5; // rcx@1
  __int64 v6; // r8@1
  __int64 v7; // r9@1
  __int64 v8; // rdi@4
  __int64 v9; // rax@5
  __int64 v10; // rax@8
  void *v11; // rax@10
  OSMetaClass *v12; // rax@13
  __int64 v13; // rsi@13
  __int64 v14; // r8@13
  __int64 v15; // r9@13
  __int64 v16; // rcx@13
  __int64 v17; // rdi@13
  OSMetaClass *v18; // rax@14
  OSMetaClass *v19; // rax@15

  v2 = this;
  v3 = OSObject::operator new((OSObject *)stru_68.segname, a2);
  IO80211QueueDescriptor::IO80211QueueDescriptor(v3);
  *(_QWORD *)v3 = off_812F0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211ServiceRequestDescriptor::gMetaClass);
  if ( v3 )
  {
    if ( (unsigned __int8)((int (__fastcall *)(__int64, _QWORD *))`vtable for'IO80211QueueDescriptor[19])(
                            v3,
                            &IO80211ServiceRequestDescriptor::gMetaClass) )
    {
LABEL_18:
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
      return 0LL;
    }
    *(_BYTE *)(v3 + 12) = *((_BYTE *)this + 12);
    *(_BYTE *)(v3 + 73) = *((_BYTE *)this + 73);
    *(_WORD *)(v3 + 80) = *((_WORD *)this + 40);
    *(_WORD *)(v3 + 78) = *((_WORD *)this + 39);
    *(_BYTE *)(v3 + 74) = *((_BYTE *)this + 74);
    *(_QWORD *)(v3 + 88) = getAbsoluteTime();
    *(_WORD *)(v3 + 101) = *(_WORD *)((char *)this + 101);
    *(_DWORD *)(v3 + 97) = *(_DWORD *)((char *)this + 97);
    if ( *((_QWORD *)this + 5)
      && (v8 = *((_WORD *)this + 40), *((_WORD *)v2 + 40))
      && (LODWORD(v9) = kalloc(v8), (*(_QWORD *)(v3 + 40) = v9) == 0LL) )
    {
      LODWORD(v18) = (*(int (__fastcall **)(IO80211ServiceRequestDescriptor *))(*(_QWORD *)v2 + 56LL))(v2);
      v13 = OSMetaClass::getClassName(v18);
      v16 = *((_WORD *)v2 + 40);
      v17 = (__int64)"%s::%s can't allocate data len %u \n";
    }
    else if ( *((_QWORD *)v2 + 6)
           && *((_WORD *)v2 + 39)
           && (LODWORD(v10) = kalloc(*((_WORD *)v2 + 39)), (*(_QWORD *)(v3 + 48) = v10) == 0LL) )
    {
      LODWORD(v19) = (*(int (__fastcall **)(IO80211ServiceRequestDescriptor *))(*(_QWORD *)v2 + 56LL))(v2);
      v13 = OSMetaClass::getClassName(v19);
      v16 = *((_WORD *)v2 + 40);
      v17 = (__int64)"%s::%s can't allocate key len %u \n";
    }
    else
    {
      if ( !*((_QWORD *)v2 + 14) )
      {
LABEL_17:
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 288LL))(v3);
        goto LABEL_18;
      }
      LODWORD(v11) = kalloc(256LL);
      *(_QWORD *)(v3 + 112) = v11;
      if ( v11 )
      {
        memcpy(v11, *((const void **)v2 + 14), 0x100uLL);
        goto LABEL_17;
      }
      LODWORD(v12) = (*(int (__fastcall **)(IO80211ServiceRequestDescriptor *))(*(_QWORD *)v2 + 56LL))(v2);
      v13 = OSMetaClass::getClassName(v12);
      v16 = *((_WORD *)v2 + 40);
      v17 = (__int64)"%s::%s can't allocate frgments len %u \n";
    }
    IOLog(v17, v13, "copy", v16, v14, v15);
    goto LABEL_17;
  }
  IOLog("can'tallocate service descriptor\n", &IO80211ServiceRequestDescriptor::gMetaClass, v4, v5, v6, v7);
  return 0LL;
}
// 68: using guessed type section_64 stru_68;
// 812F0: using guessed type __int64 (__fastcall *off_812F0[2])(IO80211ServiceRequestDescriptor *__hidden this);
// 822A0: using guessed type __int64 `vtable for'IO80211QueueDescriptor[2];
// 84BC0: using guessed type _QWORD IO80211ServiceRequestDescriptor::gMetaClass;
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8BB8: using guessed type int __fastcall kalloc(_QWORD);

//----- (000000000005FE44) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::setMulticastSendPending(IO80211ServiceRequestDescriptor *this, unsigned __int8 *a2, unsigned __int8 a3, ether_addr *a4)
{
  ether_addr *v4; // r15@1
  IO80211ServiceRequestDescriptor *v5; // r14@1
  signed int v6; // ebx@1
  int v7; // ecx@4
  size_t v8; // rdx@9
  char *v9; // rdi@12

  v4 = a4;
  v5 = this;
  v6 = 2;
  if ( a2 )
  {
    if ( a3 >= 3u && *a2 == 1 )
    {
      v7 = *(_WORD *)(a2 + 1);
      if ( v7 + 3 == a3
        && (unsigned __int16)v7 >= 6u
        && *(_WORD *)(a2 + 7) + (unsigned int)*(_WORD *)(a2 + 5) <= 0x10000
        && a3 - 7 >= 2 )
      {
        *((_WORD *)this + 39) = a3 - 8;
        *((_BYTE *)this + 96) = a2[a3 - 1];
        v6 = 1;
        if ( *((_BYTE *)this + 73) == 2 )
        {
          v8 = (unsigned __int16)(a3 - 7);
          if ( *((_WORD *)this + 41) == (_DWORD)v8 && !memcmp(a2 + 7, *((const void **)this + 7), v8) )
          {
            if ( *((_BYTE *)this + 76) & 1 )
            {
              v9 = (char *)this + 97;
              if ( v4 )
                memcpy(v9, v4, 6uLL);
              else
                bzero(v9, 6uLL);
            }
            *((_BYTE *)v5 + 76) |= 1u;
            v6 = 0;
          }
        }
      }
    }
  }
  return (unsigned int)v6;
}

//----- (000000000005FF38) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::insertData(IO80211ServiceRequestDescriptor *this, unsigned __int8 *a2, unsigned int a3)
{
  IO80211ServiceRequestDescriptor *v3; // r14@1
  signed int v4; // er15@2
  __int64 v5; // r8@3
  __int64 v6; // r9@3
  __int64 v7; // rdi@9
  __int64 v8; // rdi@13
  __int64 v9; // rcx@13
  __int64 v10; // rdx@15
  __int64 v11; // rax@17
  __int64 v12; // rdx@21
  unsigned int v13; // esi@22
  int v14; // ecx@22
  int v15; // ebx@22
  __int16 v16; // r8@22
  signed __int64 v17; // rsi@25
  __int64 v18; // rsi@27
  bool v19; // cf@28
  bool v20; // zf@28
  unsigned int v21; // ebx@28
  int v22; // edx@31
  int v23; // edx@33
  __int64 v24; // rax@39
  char v26; // [sp+0h] [bp-30h]@1
  unsigned __int16 v27; // [sp+10h] [bp-20h]@1
  unsigned __int16 v28; // [sp+12h] [bp-1Eh]@1
  unsigned __int16 v29; // [sp+14h] [bp-1Ch]@1
  unsigned __int16 v30; // [sp+16h] [bp-1Ah]@1

  v3 = this;
  v30 = 0;
  v29 = 0;
  v28 = 0;
  v27 = 0;
  if ( !(unsigned int)_service_response_tlv_checks(a2, a3, &v30, &v29, &v28, &v27, (unsigned __int8 *)this + 96) )
    goto LABEL_53;
  v4 = 1;
  if ( v27 != *((_WORD *)this + 41) || memcmp(a2 + 5, *((const void **)this + 7), v27) )
    return (unsigned int)v4;
  if ( (unsigned __int8)byte_84890 != 170 )
  {
    _userPrint(0LL, "bufout overflow! %s %u\n", (__int64)"insertData", 1380LL, v5, v6, v26);
    memset(&bufout, 170, 0x210uLL);
  }
  if ( (unsigned __int8)byte_84AA0 != 170 )
  {
    _userPrint(0LL, "buf overflow! %s %u\n", (__int64)"insertData", 1380LL, v5, v6, v26);
    memset(&bufout, 170, 0x210uLL);
  }
  if ( *((_BYTE *)this + 74) == 1 )
  {
    v7 = *((_QWORD *)this + 14);
    if ( v7 )
      kfree(v7, 256LL);
    *((_QWORD *)v3 + 14) = 0LL;
    v4 = 0;
    return (unsigned int)v4;
  }
  if ( v30 != *((_WORD *)this + 40) )
  {
LABEL_53:
    v4 = 2;
    return (unsigned int)v4;
  }
  v8 = *((_QWORD *)this + 14);
  v9 = 0LL;
  v4 = 2;
  if ( !v8 )
    return (unsigned int)v4;
  while ( *(_WORD *)(v8 + 4 * v9 + 2) )
  {
LABEL_20:
    ++v9;
    LODWORD(v11) = 0;
    if ( (unsigned int)v9 >= 0x40 )
      goto LABEL_21;
  }
  v10 = 0LL;
  do
  {
    if ( *(_WORD *)(v8 + 4 * v9 + 2 + 4 * v10) )
    {
      *(_DWORD *)(v8 + 4 * v9) = *(_DWORD *)(v8 + 4 * v9 + 4 * v10);
      v8 = *((_QWORD *)v3 + 14);
      LODWORD(v11) = 0;
      if ( !*(_WORD *)(v8 + 4 * v9 + 2) )
        break;
      goto LABEL_20;
    }
    ++v10;
    LODWORD(v11) = 0;
  }
  while ( (unsigned int)(v9 + v10) <= 0x3F );
LABEL_21:
  while ( 1 )
  {
    v11 = (unsigned int)v11;
    v12 = 0LL;
    if ( !*(_WORD *)(v8 + 4LL * (unsigned int)v11 + 2) )
      break;
    v13 = *(_WORD *)(v8 + 4 * v11);
    v14 = v13 + *(_WORD *)(v8 + 4LL * (unsigned int)v11 + 2);
    v15 = v29 + v28;
    v16 = v29 - v13;
    if ( v29 <= v13 )
    {
      v19 = v14 < (unsigned int)v15;
      v20 = v14 == v15;
      v21 = v29;
      if ( v19 || v20 )
      {
        *(_WORD *)(v8 + 4 * v11 + 2) = 0;
        goto LABEL_37;
      }
    }
    else
    {
      if ( v15 < (unsigned int)v14 )
      {
        if ( !*(_WORD *)(v8 + 254) )
        {
          v17 = 63LL;
          if ( (unsigned int)(v11 + 2) <= 0x3F )
          {
            do
            {
              *(_DWORD *)(v8 + 4 * v17) = *(_DWORD *)(v8 + 4 * v17 - 4);
              --v17;
              v8 = *((_QWORD *)v3 + 14);
            }
            while ( (unsigned int)v17 >= (signed int)v11 + 2 );
          }
          *(_WORD *)(v8 + 4 * v11 + 2) = v16;
          v18 = (unsigned int)(v11 + 1);
          *(_WORD *)(v8 + 4 * v18) = v29 + v28;
          *(_WORD *)(v8 + 4 * v18 + 2) = v14 - v29 - v28;
        }
        goto LABEL_37;
      }
      v21 = v29;
    }
    LOWORD(v22) = v29 - v13;
    if ( v29 < v13 || v21 > v14 )
    {
      v23 = v21 + v28;
      if ( v13 > v23 || v23 > (unsigned int)v14 )
        goto LABEL_37;
      *(_WORD *)(v8 + 4 * v11) = v23;
      v22 = v14 - v29 + v28;
    }
    *(_WORD *)(v8 + 4 * v11 + 2) = v22;
LABEL_37:
    LODWORD(v11) = v11 + 1;
    v12 = 0LL;
    if ( (unsigned int)v11 >= 0x40 )
      goto LABEL_38;
  }
  do
  {
LABEL_38:
    if ( !*(_WORD *)(v8 + 4 * v12 + 2) )
    {
      v24 = 0LL;
      while ( !*(_WORD *)(v8 + 4 * v12 + 2 + 4 * v24) )
      {
        ++v24;
        if ( (unsigned int)(v12 + v24) > 0x3F )
          goto LABEL_45;
      }
      *(_DWORD *)(v8 + 4 * v12) = *(_DWORD *)(v8 + 4 * v12 + 4 * v24);
      v8 = *((_QWORD *)v3 + 14);
      if ( !*(_WORD *)(v8 + 4 * v12 + 2) )
        break;
    }
    ++v12;
  }
  while ( (unsigned int)v12 < 0x40 );
LABEL_45:
  v4 = 0;
  if ( *(_WORD *)(v8 + 2) )
  {
    if ( v8 )
      kfree(v8, 256LL);
    *((_QWORD *)v3 + 14) = 0LL;
    *((_BYTE *)v3 + 74) = 1;
  }
  return (unsigned int)v4;
}
// 84890: using guessed type char byte_84890;
// 84AA0: using guessed type char byte_84AA0;
// C8BC8: using guessed type int __fastcall kfree(_QWORD, _QWORD);

//----- (0000000000060224) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::isBrowseFor(IO80211ServiceRequestDescriptor *this, unsigned __int8 *a2, unsigned __int8 a3, __int64 a4, __int64 a5, __int64 a6)
{
  unsigned __int8 v6; // r15@1
  signed int v7; // ebx@5
  char v9; // [sp+0h] [bp-40h]@0
  unsigned __int8 v10; // [sp+17h] [bp-29h]@9
  unsigned __int16 v11; // [sp+18h] [bp-28h]@1
  unsigned __int16 v12; // [sp+1Ah] [bp-26h]@1
  unsigned __int16 v13; // [sp+1Ch] [bp-24h]@1
  unsigned __int16 v14; // [sp+1Eh] [bp-22h]@1

  v6 = a3;
  v14 = 0;
  v13 = 0;
  v12 = 0;
  v11 = 0;
  if ( (unsigned __int8)byte_84890 != 170 )
  {
    _userPrint(0LL, "bufout overflow! %s %u\n", (__int64)"isBrowseFor", 1481LL, a5, a6, v9);
    memset(&bufout, 170, 0x210uLL);
  }
  if ( (unsigned __int8)byte_84AA0 != 170 )
  {
    _userPrint(0LL, "buf overflow! %s %u\n", (__int64)"isBrowseFor", 1481LL, a5, a6, v9);
    memset(&bufout, 170, 0x210uLL);
  }
  v7 = 2;
  if ( a2 && v6 >= 3u )
  {
    if ( *a2 != 2 || *((_BYTE *)this + 73) != 1 )
    {
      v7 = 1;
    }
    else if ( (unsigned int)_service_response_tlv_checks(a2, v6, &v12, &v13, &v14, &v11, &v10) )
    {
      v7 = 1;
      if ( v11 == *((_WORD *)this + 41) )
        v7 = memcmp(*((const void **)this + 7), a2 + 5, v11) != 0;
    }
  }
  return (unsigned int)v7;
}
// 84890: using guessed type char byte_84890;
// 84AA0: using guessed type char byte_84AA0;

//----- (0000000000060360) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::compare(IO80211ServiceRequestDescriptor *this, IO80211ServiceRequestDescriptor *a2)
{
  IO80211ServiceRequestDescriptor *v2; // r15@1
  IO80211ServiceRequestDescriptor *v3; // rbx@1
  signed int v4; // er14@1
  const void *v5; // rsi@2
  const void *v6; // rdi@3
  size_t v7; // rdx@4
  const void *v8; // rsi@7
  const void *v9; // rdi@8
  size_t v10; // rdx@9

  v2 = a2;
  v3 = this;
  v4 = 1;
  if ( *((_BYTE *)a2 + 73) == *((_BYTE *)this + 73) )
  {
    v5 = (const void *)*((_QWORD *)this + 6);
    if ( v5 )
    {
      v6 = (const void *)*((_QWORD *)v2 + 6);
      if ( v6 )
      {
        v7 = *((_WORD *)v3 + 39);
        if ( (_DWORD)v7 == *((_WORD *)v2 + 39) && !memcmp(v6, v5, v7) )
        {
          if ( *((_BYTE *)v3 + 73) != 2
            || (v8 = (const void *)*((_QWORD *)v3 + 5)) != 0LL
            && (v9 = (const void *)*((_QWORD *)v2 + 5)) != 0LL
            && (v10 = *((_WORD *)v3 + 40), (_DWORD)v10 == *((_WORD *)v2 + 40))
            && !memcmp(v9, v8, v10) )
            v4 = 0;
        }
      }
    }
  }
  return (unsigned int)v4;
}

//----- (00000000000603EE) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::recordTypeCoded(IO80211ServiceRequestDescriptor *this)
{
  signed int v1; // eax@1
  char v2; // cl@6

  v1 = *((_BYTE *)this + 96);
  if ( v1 > 46 )
  {
    if ( v1 == 47 )
    {
      v2 = 32;
      return (unsigned __int8)v2;
    }
LABEL_16:
    v2 = 0;
    return (unsigned __int8)v2;
  }
  if ( v1 > 32 )
  {
    if ( v1 == 33 )
    {
      v2 = 8;
      return (unsigned __int8)v2;
    }
    goto LABEL_16;
  }
  if ( v1 > 27 )
  {
    v2 = 16;
    if ( v1 == 28 )
      return (unsigned __int8)v2;
    goto LABEL_16;
  }
  if ( v1 == 10 )
  {
    v2 = 4;
    return (unsigned __int8)v2;
  }
  if ( v1 != 12 )
  {
    if ( v1 == 16 )
    {
      v2 = 2;
      return (unsigned __int8)v2;
    }
    goto LABEL_16;
  }
  v2 = 1;
  return (unsigned __int8)v2;
}

//----- (0000000000060442) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::print(IO80211ServiceRequestDescriptor *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  int v6; // eax@2
  int v7; // eax@3
  int v8; // eax@7
  __int64 v9; // rdx@9
  __int64 v10; // r15@11
  unsigned __int64 v11; // rax@15
  unsigned __int64 v12; // rax@16
  unsigned __int64 v13; // rax@17
  unsigned __int64 v14; // rax@18
  unsigned __int8 v15; // al@20
  __int64 v16; // r8@20
  __int64 v17; // r9@20
  __int64 v18; // rdx@20
  __int64 v19; // rdx@22
  __int64 v20; // r8@24
  __int64 v21; // r9@29
  int v22; // ST10_4@45
  int v23; // ST08_4@45
  __int64 v24; // rdx@45
  __int64 v25; // rcx@45
  __int64 v26; // r8@45
  __int64 v27; // r9@45
  __int64 v28; // rdx@47
  __int64 v29; // rcx@47
  __int64 v30; // r8@47
  __int64 v31; // r9@47
  unsigned int v32; // eax@47
  unsigned int v33; // er12@48
  __int64 v34; // rcx@49
  __int64 v35; // rdx@54
  __int64 v36; // rcx@54
  __int64 v37; // r8@54
  __int64 v38; // r9@54
  unsigned int v39; // eax@54
  unsigned int v40; // er12@55
  __int64 v41; // rcx@56
  __int64 v42; // rdx@61
  __int64 v43; // rcx@61
  __int64 v44; // r8@61
  __int64 v45; // r9@61
  unsigned int v46; // eax@61
  unsigned int v47; // er12@62
  __int64 v48; // rcx@63
  __int64 v49; // rdx@68
  __int64 v50; // rcx@68
  __int64 v51; // r8@68
  __int64 v52; // r9@68
  unsigned int v53; // eax@68
  unsigned int v54; // er12@69
  __int64 v55; // rcx@70
  unsigned int v56; // ebx@75
  __int64 v57; // rdx@75
  __int64 v58; // rcx@75
  __int64 v59; // r8@75
  __int64 v60; // r9@75
  __int64 v61; // rcx@76
  __int64 v62; // rdx@76
  unsigned int v63; // ebx@83
  __int64 v64; // rcx@83
  __int64 v65; // r8@83
  __int64 v66; // r9@83
  __int64 v67; // rdx@83
  __int64 v68; // rcx@86
  __int64 v69; // rdx@86
  signed int v70; // eax@89
  __int64 v71; // r8@93
  __int64 v72; // r9@93
  char v74; // [sp+0h] [bp-40h]@0
  char v75; // [sp+0h] [bp-40h]@45
  char v76; // [sp+0h] [bp-40h]@47
  char v77; // [sp+0h] [bp-40h]@54
  char v78; // [sp+0h] [bp-40h]@61
  char v79; // [sp+0h] [bp-40h]@68
  char v80; // [sp+0h] [bp-40h]@75
  char v81; // [sp+0h] [bp-40h]@83
  char v82; // [sp+0h] [bp-40h]@93

  if ( !a2 )
    return 0LL;
  v6 = *((_BYTE *)this + 73);
  if ( v6 == 2 )
  {
    v7 = *(_DWORD *)(a2 + 48);
    if ( v7 && !(v7 & 2) )
      return 0LL;
  }
  else if ( (unsigned __int8)v6 == 1 )
  {
    v8 = *(_DWORD *)(a2 + 48);
    if ( v8 )
    {
      if ( !(v8 & 1) )
        return 0LL;
    }
  }
  v9 = *(_QWORD *)(a2 + 80);
  if ( v9 )
    _userPrint(a2, "%s", v9, a4, a5, a6, v74);
  v10 = (__int64)"non-airplay";
  if ( this )
  {
    if ( *((_QWORD *)this + 6) )
    {
      if ( *((_WORD *)this + 39) )
      {
        if ( *((_BYTE *)this + 96) == 12 )
        {
          v11 = strlen("ip6");
          if ( (signed int)IO80211ServiceRequestDescriptor::hasString(this, "ip6", v11) < 0
            || (v12 = strlen("arpa"), (signed int)IO80211ServiceRequestDescriptor::hasString(this, "arpa", v12) < 0) )
          {
            v10 = (__int64)"airplay";
            v13 = strlen("airplay");
            if ( (signed int)IO80211ServiceRequestDescriptor::hasString(this, "airplay", v13) < 0 )
            {
              v14 = strlen("raop");
              v10 = (__int64)"non-airplay";
              if ( (signed int)IO80211ServiceRequestDescriptor::hasString(this, "raop", v14) >= 0 )
                v10 = (__int64)"airplay";
            }
          }
        }
      }
    }
  }
  v15 = _do_crc8_ccitt(*((_WORD *)this + 39), *((unsigned __int8 **)this + 6));
  v18 = *((_BYTE *)this + 12);
  if ( v15 != (_DWORD)v18 )
  {
    _userPrint(a2, "Hash error: got %u want %u\n", v18, v15, v16, v17, v74);
    v15 = *((_BYTE *)this + 12);
  }
  v19 = (__int64)"Response";
  if ( *((_BYTE *)this + 73) == 1 )
    v19 = (__int64)"Request";
  v20 = 0LL;
  if ( !*((_QWORD *)this + 6) || !*((_WORD *)this + 39) )
    goto LABEL_44;
  v20 = *((_BYTE *)this + 96);
  if ( (signed int)v20 > 46 )
  {
    if ( (_DWORD)v20 == 47 )
    {
      v21 = (__int64)" NSEC ";
      goto LABEL_45;
    }
LABEL_44:
    v21 = (__int64)&byte_690F5;
    goto LABEL_45;
  }
  if ( (signed int)v20 > 9 )
  {
    if ( (signed int)v20 > 32 )
    {
      if ( (_DWORD)v20 == 33 )
      {
        v21 = (__int64)" SRV ";
        goto LABEL_45;
      }
    }
    else if ( (signed int)v20 > 27 )
    {
      if ( (_DWORD)v20 == 28 )
      {
        v21 = (__int64)" AAAA ";
        goto LABEL_45;
      }
    }
    else
    {
      if ( (_DWORD)v20 == 10 )
      {
        v21 = (__int64)" NULL ";
        goto LABEL_45;
      }
      if ( (_DWORD)v20 == 12 )
      {
        v21 = (__int64)" PTR ";
        goto LABEL_45;
      }
      if ( (_DWORD)v20 == 16 )
      {
        v21 = (__int64)" TXT ";
        goto LABEL_45;
      }
    }
    goto LABEL_44;
  }
  if ( (_DWORD)v20 != 1 )
    goto LABEL_44;
  v21 = (__int64)" A ";
LABEL_45:
  v22 = *((_DWORD *)this + 8);
  v23 = *((_WORD *)this + 41);
  _userPrint(a2, "%s: hash 0x%02X recordType 0x%02X %s %s compressed_key_length %u alloc %u\n", v19, v15, v20, v21, v10);
  if ( *(_DWORD *)(a2 + 52) )
  {
    if ( *((_QWORD *)this + 6) )
    {
      _userPrint(a2, "  Key = [", v24, v25, v26, v27, v75);
      v32 = *((_WORD *)this + 39);
      if ( *((_WORD *)this + 39) )
      {
        v33 = 0;
        do
        {
          v34 = (__int64)&byte_690F5;
          if ( v33 < v32 - 1 )
            v34 = (__int64)" ";
          _userPrint(a2, "%02X%s", *(_BYTE *)(*((_QWORD *)this + 6) + v33++), v34, v30, v31, v76);
          v32 = *((_WORD *)this + 39);
        }
        while ( v33 < v32 );
      }
      _userPrint(a2, "]\n", v28, v29, v30, v31, v76);
    }
    if ( *((_QWORD *)this + 7) )
    {
      _userPrint(a2, "  Compressed Key = [", v24, v25, v26, v27, v75);
      v39 = *((_WORD *)this + 41);
      if ( *((_WORD *)this + 41) )
      {
        v40 = 0;
        do
        {
          v41 = (__int64)&byte_690F5;
          if ( v40 < v39 - 1 )
            v41 = (__int64)" ";
          _userPrint(a2, "%02X%s", *(_BYTE *)(*((_QWORD *)this + 7) + v40++), v41, v37, v38, v77);
          v39 = *((_WORD *)this + 41);
        }
        while ( v40 < v39 );
      }
      _userPrint(a2, "]\n", v35, v36, v37, v38, v77);
    }
    if ( *((_QWORD *)this + 5) )
    {
      _userPrint(a2, " Value = [", v24, v25, v26, v27, v75);
      v46 = *((_WORD *)this + 40);
      if ( *((_WORD *)this + 40) )
      {
        v47 = 0;
        do
        {
          v48 = (__int64)&byte_690F5;
          if ( v47 < v46 - 1 )
            v48 = (__int64)" ";
          _userPrint(a2, "%02X%s", *(_BYTE *)(*((_QWORD *)this + 5) + v47++), v48, v44, v45, v78);
          v46 = *((_WORD *)this + 40);
        }
        while ( v47 < v46 );
      }
      _userPrint(a2, "]\n", v42, v43, v44, v45, v78);
    }
    if ( *((_QWORD *)this + 8) )
    {
      _userPrint(a2, " Compressed Value = [", v24, v25, v26, v27, v75);
      v53 = *((_WORD *)this + 42);
      if ( *((_WORD *)this + 42) )
      {
        v54 = 0;
        do
        {
          v55 = (__int64)&byte_690F5;
          if ( v54 < v53 - 1 )
            v55 = (__int64)" ";
          _userPrint(a2, "%02X%s", *(_BYTE *)(*((_QWORD *)this + 8) + v54++), v55, v51, v52, v79);
          v53 = *((_WORD *)this + 42);
        }
        while ( v54 < v53 );
      }
      _userPrint(a2, "]\n", v49, v50, v51, v52, v79);
    }
  }
  if ( *((_QWORD *)this + 6) )
  {
    v56 = 0;
    _userPrint(a2, "        Key (%u): ", *((_WORD *)this + 39), v25, v26, v27, v75);
    if ( *((_WORD *)this + 39) )
    {
      do
      {
        v61 = *((_QWORD *)this + 6);
        v62 = *(_BYTE *)(v61 + v56);
        if ( (unsigned __int8)(*(_BYTE *)(v61 + v56) - 32) > 0x5Eu )
          _userPrint(a2, ".", v62, v61, v59, v60, v80);
        else
          _userPrint(a2, "%c", v62, v61, v59, v60, v80);
        ++v56;
      }
      while ( v56 < *((_WORD *)this + 39) );
    }
    _userPrint(a2, "\n", v57, v58, v59, v60, v80);
  }
  if ( *((_BYTE *)this + 73) == 2 && *((_QWORD *)this + 5) )
  {
    v63 = 0;
    _userPrint(a2, "        Value (%u): ", *((_WORD *)this + 40), v25, v26, v27, v75);
    v67 = *((_WORD *)this + 42);
    if ( *((_WORD *)this + 42) )
      _userPrint(a2, " (compressed %u) ", v67, v64, v65, v66, v81);
    if ( *((_WORD *)this + 40) )
    {
      do
      {
        v68 = *((_QWORD *)this + 5);
        v69 = *(_BYTE *)(v68 + v63);
        if ( (unsigned __int8)(*(_BYTE *)(v68 + v63) - 20) > 0x6Au )
          _userPrint(a2, ".", v69, v68, v65, v66, v81);
        else
          _userPrint(a2, "%c", v69, v68, v65, v66, v81);
        ++v63;
        v70 = *((_WORD *)this + 40);
        if ( (unsigned int)v70 > 0x100 )
          v70 = 256;
      }
      while ( v63 < v70 );
    }
    _userPrint(a2, "\n", v67, v64, v65, v66, v81);
  }
  _userPrint(a2, "--\n", v24, v25, v26, v27, v75);
  if ( (unsigned __int8)byte_84890 != 170 )
  {
    _userPrint(a2, "bufout overflow! %s %u\n", (__int64)"print", 1745LL, v71, v72, v82);
    memset(&bufout, 170, 0x210uLL);
  }
  if ( (unsigned __int8)byte_84AA0 != 170 )
  {
    _userPrint(a2, "buf overflow! %s %u\n", (__int64)"print", 1745LL, v71, v72, v82);
    memset(&bufout, 170, 0x210uLL);
  }
  return 0LL;
}
// 690F5: using guessed type char byte_690F5;
// 84890: using guessed type char byte_84890;
// 84AA0: using guessed type char byte_84AA0;

//----- (0000000000060A70) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::buildmDNSFrame(__int64 a1, __int64 a2)
{
  __int64 v2; // r13@1
  __int64 v3; // r15@1
  __int64 v4; // rax@1
  OSMetaClass *v5; // rax@2
  __int64 v6; // rdx@2
  __int64 v7; // r9@2
  __int64 v8; // r8@2
  char *v9; // rsi@2
  __int64 v10; // rbx@3
  __int64 v11; // r14@5
  __int64 v12; // rax@7
  __int64 v13; // r12@7
  size_t v14; // rdx@7
  OSMetaClass *v15; // rax@8
  OSMetaClass *v16; // rax@9
  __int64 v17; // rax@9
  __int64 v18; // r9@9
  __int64 v19; // r14@10
  __int64 v20; // rbx@10
  signed __int64 v21; // r13@10
  __int64 v22; // r8@10
  __int64 v23; // r9@10
  unsigned int v24; // ST0C_4@12
  __int64 v25; // rbx@12
  __int64 v26; // r8@12
  __int64 v27; // rdx@12
  __int64 v28; // rcx@12
  __int64 v29; // r8@12
  __int64 v30; // r9@12
  int v31; // ebx@13
  __int64 *v32; // rsi@16
  __int64 v33; // rcx@16
  __int64 v34; // rdx@18
  __int64 v35; // rcx@18
  __int64 v36; // r8@18
  __int64 v37; // r9@18
  __int64 v38; // r13@18
  unsigned int v39; // ebx@19
  signed int v40; // eax@20
  const void *v41; // r12@24
  signed __int64 v42; // r13@24
  void *v43; // rdi@24
  size_t v44; // rdx@24
  OSMetaClass *v45; // rax@26
  __int64 v46; // rdx@26
  __int64 v47; // r9@26
  __int64 v48; // r8@26
  char *v49; // rsi@26
  size_t v50; // rdx@27
  OSMetaClass *v51; // rax@28
  signed __int64 v52; // rbx@30
  __int64 v53; // rdx@32
  __int16 v54; // ax@32
  __int64 v55; // rcx@32
  signed __int64 v56; // rax@35
  __int16 v57; // cx@35
  int v58; // er15@35
  signed __int64 v59; // r15@36
  int v60; // er12@36
  __int16 v61; // ax@36
  __int64 v62; // r8@36
  __int64 v63; // r9@36
  __int64 v64; // rcx@36
  int v65; // eax@36
  int v66; // edx@37
  unsigned __int16 v67; // ax@37
  __int64 v68; // rcx@38
  int v69; // edx@39
  unsigned __int16 v70; // ax@39
  unsigned __int16 v71; // cx@40
  unsigned int v72; // eax@40
  unsigned int v73; // ecx@41
  signed __int64 v74; // rdx@41
  __int64 v75; // rbx@41
  unsigned __int16 v76; // si@42
  __int16 v77; // cx@45
  char v79; // [sp+0h] [bp-60h]@0
  char v80; // [sp+0h] [bp-60h]@12
  char v81; // [sp+0h] [bp-60h]@18
  int v82; // [sp+10h] [bp-50h]@36
  __int64 v83; // [sp+18h] [bp-48h]@10
  __int64 v84; // [sp+18h] [bp-48h]@30
  __int64 v85; // [sp+20h] [bp-40h]@10
  int v86; // [sp+2Ch] [bp-34h]@1
  __int64 v87; // [sp+30h] [bp-30h]@1

  v2 = a2;
  v3 = a1;
  v87 = 0LL;
  v86 = 1;
  v4 = *(_WORD *)(a1 + 78);
  if ( (unsigned __int16)(v4 - 2) < 0x1FFu )
  {
    v10 = 0LL;
    if ( *(_BYTE *)(a1 + 73) != 2 )
      return v10;
    v11 = v4 + *(_WORD *)(a1 + 80) + 598;
    if ( mbuf_allocpacket(0LL, v11, &v86, &v87) || !v87 )
    {
      LODWORD(v16) = (*(int (__fastcall **)(__int64))(*(_QWORD *)a1 + 56LL))(a1);
      v17 = OSMetaClass::getClassName(v16);
      v10 = 0LL;
      _userPrint(a2, "%s::%s cannot allocate mbuf size %lu\n", v17, (__int64)"buildmDNSFrame", v11, v18, v79);
      return v10;
    }
    LODWORD(v12) = mbuf_data(v87);
    v13 = v12;
    *(_DWORD *)v12 = 13107;
    *(_WORD *)(v12 + 4) = -1280;
    memcpy((void *)(v12 + 6), (const void *)(a1 + 97), 6uLL);
    *(_WORD *)(v13 + 12) = -8826;
    memset((void *)(v13 + 14), 0, 0x28uLL);
    *(_BYTE *)(v13 + 14) = 96;
    *(_BYTE *)(v13 + 20) = 17;
    *(_BYTE *)(v13 + 21) = -1;
    *(_BYTE *)(v13 + 22) = -2;
    *(_BYTE *)(v13 + 23) = -128;
    *(_BYTE *)(v13 + 30) = *(_BYTE *)(a1 + 97) & 0xFD;
    *(_BYTE *)(v13 + 31) = *(_BYTE *)(a1 + 98);
    *(_BYTE *)(v13 + 32) = *(_BYTE *)(a1 + 99);
    *(_BYTE *)(v13 + 33) = -1;
    *(_BYTE *)(v13 + 34) = -2;
    *(_BYTE *)(v13 + 35) = *(_BYTE *)(a1 + 100);
    *(_BYTE *)(v13 + 36) = *(_BYTE *)(a1 + 101);
    *(_BYTE *)(v13 + 37) = *(_BYTE *)(a1 + 102);
    *(_BYTE *)(v13 + 38) = -1;
    *(_BYTE *)(v13 + 39) = 2;
    *(_BYTE *)(v13 + 53) = -5;
    memset((void *)(v13 + 54), 0, 8uLL);
    *(_DWORD *)(v13 + 54) = -384505580;
    *(_QWORD *)(v13 + 62) = 72057594046578688LL;
    *(_DWORD *)(v13 + 70) = 0;
    v14 = *(_WORD *)(a1 + 78);
    if ( (signed __int64)(v14 + 74) > v11 )
    {
      LODWORD(v15) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 56LL))(a1, 0LL);
      v6 = OSMetaClass::getClassName(v15);
      v8 = *(_WORD *)(a1 + 78);
      v9 = "%s::%s key too long %u\n";
      goto LABEL_3;
    }
    v83 = v11;
    v19 = v13;
    v20 = a2;
    v21 = v13 + 74;
    v85 = *(_WORD *)(a1 + 78);
    memcpy((void *)(v13 + 74), *(const void **)(a1 + 48), v14);
    if ( a2 && *(_DWORD *)(a2 + 52) )
    {
      v24 = *(_DWORD *)(a1 + 32);
      v25 = *(_QWORD *)(a1 + 88);
      v26 = (unsigned int)((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (getAbsoluteTime() - v25)) >> 64) >> 18);
      _userPrint(
        a2,
        "%s allocCount=%u age=%ums Name (%u) type %u:",
        (__int64)"buildmDNSFrame",
        v24,
        v26,
        (unsigned int)v85,
        *(_BYTE *)(a1 + 96));
      if ( (_WORD)v85 )
      {
        v31 = v85;
        do
        {
          _userPrint(a2, "%02x ", *(_BYTE *)v21++, v28, v29, v30, v80);
          --v31;
        }
        while ( v31 );
      }
      v20 = a2;
      _userPrint(a2, "\n", v27, v28, v29, v30, v80);
      v19 = v13;
    }
    v32 = (__int64 *)(a1 + 80);
    v33 = v85;
    *(_BYTE *)(v19 + v85 + 74) = 0;
    *(_BYTE *)(v19 + v85 + 75) = *(_BYTE *)(a1 + 96);
    *(_BYTE *)(v19 + v85 + 76) = 0;
    *(_BYTE *)(v19 + v85 + 77) = 1;
    *(_BYTE *)(v19 + v85 + 78) = 0;
    *(_BYTE *)(v19 + v85 + 79) = 1;
    *(_BYTE *)(v19 + v85 + 80) = 0;
    *(_BYTE *)(v19 + v85 + 81) = 0;
    if ( v20 && *(_DWORD *)(v20 + 52) )
    {
      _userPrint(v20, "%s Value (%u) :", (__int64)"buildmDNSFrame", *(_WORD *)v32, v22, v23, v79);
      v38 = v20;
      if ( *(_WORD *)(a1 + 80) )
      {
        v39 = 0;
        do
        {
          _userPrint(v38, "%02x ", *(_BYTE *)(*(_QWORD *)(a1 + 40) + v39++), *(_QWORD *)(a1 + 40), v36, v37, v81);
          v40 = *(_WORD *)(a1 + 80);
          v35 = 64LL;
          if ( (unsigned int)v40 >= 0x40 )
            v40 = 64;
        }
        while ( v39 < v40 );
      }
      _userPrint(v38, "\n", v34, v35, v36, v37, v81);
      v20 = v38;
      v33 = v85;
      v32 = (__int64 *)(a1 + 80);
    }
    v41 = (const void *)(v13 + 22);
    v42 = v33 + 84;
    v43 = (void *)(v19 + v33 + 84);
    v44 = *(_WORD *)v32;
    if ( *(_WORD *)v32 )
    {
      if ( (signed __int64)(v44 + v42) > v83 )
      {
        LODWORD(v45) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v3 + 56LL))(v3);
        v46 = OSMetaClass::getClassName(v45);
        v48 = *(_WORD *)(v3 + 78);
        v49 = "%s::%s value too long %u\n";
LABEL_29:
        _userPrint(v20, v49, v46, (__int64)"buildmDNSFrame", v48, v47, v79);
        return v87;
      }
      v84 = v20;
      memcpy(v43, *(const void **)(v3 + 40), v44);
      v52 = (signed __int64)v32;
    }
    else
    {
      v50 = *(_WORD *)(v3 + 84);
      if ( (signed __int64)(v50 + v42) > v83 )
      {
        LODWORD(v51) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v3 + 56LL))(v3);
        v46 = OSMetaClass::getClassName(v51);
        v48 = *(_WORD *)(v3 + 78);
        v49 = "%s::%s compressed data too long %u\n";
        goto LABEL_29;
      }
      v84 = v20;
      v52 = v3 + 84;
      memcpy(v43, *(const void **)(v3 + 64), v50);
    }
    v53 = *(_WORD *)v52;
    v54 = __ROL2__(*(_WORD *)v52, 8);
    v55 = v85;
    *(_WORD *)(v85 + v19 + 82) = v54;
    if ( *(_QWORD *)(v3 + 48) && *(_WORD *)(v3 + 78) && *(_BYTE *)(v3 + 96) == 33 )
    {
      *(_WORD *)(v19 + 68) = 512;
      v56 = v53 + v42;
      v57 = __ROL2__((v85 + 28) | 0xC000, 8);
      *(_WORD *)(v19 + v56) = v57;
      *(_QWORD *)(v19 + v56 + 2) = 1099528412160LL;
      *(_WORD *)(v19 + v56 + 10) = 4096;
      v58 = v53;
      memcpy((void *)(v19 + v53 + v42 + 12), v41, 0x10uLL);
      v55 = v85;
      LODWORD(v53) = v58 + 28;
    }
    v82 = v53;
    *(_BYTE *)(v19 + (unsigned int)v53 + v42) = 0;
    v59 = v55 + (unsigned int)v53 + 30;
    v60 = v55;
    v61 = __ROL2__(v55 + v53 + 30, 8);
    *(_WORD *)(v19 + 58) = v61;
    *(_WORD *)(v19 + 18) = v61;
    mbuf_setlen(v87, (unsigned __int16)v59 + 54LL);
    mbuf_pkthdr_setlen(v87, (unsigned __int16)v59 + 54LL);
    v64 = 0LL;
    v65 = 0;
    do
    {
      v66 = v65;
      v67 = __ROL2__(*(_WORD *)(v19 + 2 * v64 + 22), 8);
      v65 = v66 + v67;
      ++v64;
    }
    while ( v64 != 8 );
    v68 = 0LL;
    do
    {
      v69 = v65;
      v70 = __ROL2__(*(_WORD *)(v19 + 2 * v68 + 38), 8);
      v65 = v69 + v70;
      ++v68;
    }
    while ( v68 != 8 );
    v71 = __ROL2__(*(_WORD *)(v19 + 58), 8);
    v72 = v65 + v71 + 17;
    if ( ((_WORD)v59 + (v59 & 1)) & 0xFFFE )
    {
      v73 = (((((_BYTE)v60 + (_BYTE)v82) & 1u) + v60 + v82 + 30) >> 1) & 0x7FFF;
      v74 = v19 + 54;
      v75 = v84;
      do
      {
        v76 = __ROL2__(*(_WORD *)v74, 8);
        v72 += v76;
        v74 += 2LL;
        --v73;
      }
      while ( v73 );
    }
    else
    {
      v75 = v84;
    }
    v77 = __ROL2__(~((v72 >> 16) + v72 + (((v72 >> 16) + (unsigned __int16)v72) >> 16)), 8);
    *(_WORD *)(v19 + 60) = v77;
    if ( (unsigned __int8)byte_84890 != 170 )
    {
      _userPrint(v75, "bufout overflow! %s %u\n", (__int64)"buildmDNSFrame", 2165LL, v62, v63, v79);
      memset(&bufout, 170, 0x210uLL);
    }
    if ( (unsigned __int8)byte_84AA0 != 170 )
    {
      _userPrint(v75, "buf overflow! %s %u\n", (__int64)"buildmDNSFrame", 2165LL, v62, v63, v79);
      memset(&bufout, 170, 0x210uLL);
    }
    return v87;
  }
  LODWORD(v5) = (*(int (**)(void))(*(_QWORD *)a1 + 56LL))();
  v6 = OSMetaClass::getClassName(v5);
  v8 = *(_WORD *)(a1 + 78);
  v9 = "%s::%s bad key size %u\n";
LABEL_3:
  v10 = 0LL;
  _userPrint(v2, v9, v6, (__int64)"buildmDNSFrame", v8, v7, v79);
  return v10;
}
// 84890: using guessed type char byte_84890;
// 84AA0: using guessed type char byte_84AA0;
// C8BE8: using guessed type int __fastcall mbuf_allocpacket(_QWORD, _QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C80: using guessed type int __fastcall mbuf_pkthdr_setlen(_QWORD, _QWORD);
// C8CB0: using guessed type int __fastcall mbuf_setlen(_QWORD, _QWORD);

//----- (00000000000610CA) ----------------------------------------------------
__int64 __fastcall IO80211ServiceRequestDescriptor::MetaClass::~MetaClass(IO80211ServiceRequestDescriptor::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000610E0) ----------------------------------------------------
char *`global constructor keyed to'_a_18()
{
  char *result; // rax@1

  OSMetaClass::OSMetaClass(
    &IO80211ServiceRequestDescriptor::gMetaClass,
    "IO80211ServiceRequestDescriptor",
    &IO80211QueueDescriptor::gMetaClass,
    120LL);
  IO80211ServiceRequestDescriptor::gMetaClass = off_81430;
  awdl_labels[0] = -16383;
  word_84BF2 = strlen(airplay_tcp_local_label);
  qword_84BF8 = (__int64)airplay_tcp_local_label;
  word_84C00 = -16382;
  word_84C02 = strlen(airplay_udp_local_label);
  qword_84C08 = (__int64)airplay_udp_local_label;
  word_84C10 = -16381;
  word_84C12 = strlen(airplay_label);
  qword_84C18 = (__int64)airplay_label;
  word_84C20 = -16380;
  word_84C22 = strlen(raop_tcp_local_label);
  qword_84C28 = (__int64)raop_tcp_local_label;
  word_84C30 = -16379;
  word_84C32 = strlen(raop_udp_local_label);
  qword_84C38 = (__int64)raop_udp_local_label;
  word_84C40 = -16378;
  word_84C42 = strlen(raop_label);
  qword_84C48 = (__int64)raop_label;
  word_84C50 = -16377;
  word_84C52 = strlen(airdrop_tcp_local_label);
  qword_84C58 = (__int64)airdrop_tcp_local_label;
  word_84C60 = -16376;
  word_84C62 = strlen(airdrop_udp_local_label);
  qword_84C68 = (__int64)airdrop_udp_local_label;
  word_84C70 = -16375;
  word_84C72 = strlen(airdrop_label);
  qword_84C78 = (__int64)airdrop_label;
  word_84C80 = -16374;
  word_84C82 = strlen(tcp_label);
  qword_84C88 = (__int64)tcp_label;
  word_84C90 = -16373;
  word_84C92 = strlen(udp_label);
  qword_84C98 = (__int64)udp_label;
  word_84CA0 = -16372;
  word_84CA2 = strlen(local_label);
  qword_84CA8 = (__int64)local_label;
  word_84CB0 = -16371;
  word_84CB2 = strlen(arpa6_label);
  qword_84CB8 = (__int64)arpa6_label;
  word_84CC0 = -16370;
  word_84CC2 = strlen(arpa4_label);
  qword_84CC8 = (__int64)arpa4_label;
  v1_labels = -16345;
  word_84CE2 = 0;
  qword_84CE8 = 0LL;
  word_84CF0 = -16372;
  word_84CF2 = strlen(tcp_label);
  qword_84CF8 = (__int64)tcp_label;
  word_84D00 = -16356;
  word_84D02 = strlen(udp_label);
  qword_84D08 = (__int64)udp_label;
  word_84D10 = -16367;
  word_84D12 = strlen(local_label);
  result = local_label;
  qword_84D18 = (__int64)local_label;
  return result;
}
// 81430: using guessed type __int64 (__fastcall *off_81430[2])(IO80211ServiceRequestDescriptor::MetaClass *__hidden this);
// 84BC0: using guessed type _QWORD IO80211ServiceRequestDescriptor::gMetaClass;
// 84BF0: using guessed type __int16 awdl_labels[];
// 84BF2: using guessed type __int16 word_84BF2;
// 84BF8: using guessed type __int64 qword_84BF8;
// 84C00: using guessed type __int16 word_84C00;
// 84C02: using guessed type __int16 word_84C02;
// 84C08: using guessed type __int64 qword_84C08;
// 84C10: using guessed type __int16 word_84C10;
// 84C12: using guessed type __int16 word_84C12;
// 84C18: using guessed type __int64 qword_84C18;
// 84C20: using guessed type __int16 word_84C20;
// 84C22: using guessed type __int16 word_84C22;
// 84C28: using guessed type __int64 qword_84C28;
// 84C30: using guessed type __int16 word_84C30;
// 84C32: using guessed type __int16 word_84C32;
// 84C38: using guessed type __int64 qword_84C38;
// 84C40: using guessed type __int16 word_84C40;
// 84C42: using guessed type __int16 word_84C42;
// 84C48: using guessed type __int64 qword_84C48;
// 84C50: using guessed type __int16 word_84C50;
// 84C52: using guessed type __int16 word_84C52;
// 84C58: using guessed type __int64 qword_84C58;
// 84C60: using guessed type __int16 word_84C60;
// 84C62: using guessed type __int16 word_84C62;
// 84C68: using guessed type __int64 qword_84C68;
// 84C70: using guessed type __int16 word_84C70;
// 84C72: using guessed type __int16 word_84C72;
// 84C78: using guessed type __int64 qword_84C78;
// 84C80: using guessed type __int16 word_84C80;
// 84C82: using guessed type __int16 word_84C82;
// 84C88: using guessed type __int64 qword_84C88;
// 84C90: using guessed type __int16 word_84C90;
// 84C92: using guessed type __int16 word_84C92;
// 84C98: using guessed type __int64 qword_84C98;
// 84CA0: using guessed type __int16 word_84CA0;
// 84CA2: using guessed type __int16 word_84CA2;
// 84CA8: using guessed type __int64 qword_84CA8;
// 84CB0: using guessed type __int16 word_84CB0;
// 84CB2: using guessed type __int16 word_84CB2;
// 84CB8: using guessed type __int64 qword_84CB8;
// 84CC0: using guessed type __int16 word_84CC0;
// 84CC2: using guessed type __int16 word_84CC2;
// 84CC8: using guessed type __int64 qword_84CC8;
// 84CE0: using guessed type __int16 v1_labels;
// 84CE2: using guessed type __int16 word_84CE2;
// 84CE8: using guessed type __int64 qword_84CE8;
// 84CF0: using guessed type __int16 word_84CF0;
// 84CF2: using guessed type __int16 word_84CF2;
// 84CF8: using guessed type __int64 qword_84CF8;
// 84D00: using guessed type __int16 word_84D00;
// 84D02: using guessed type __int16 word_84D02;
// 84D08: using guessed type __int64 qword_84D08;
// 84D10: using guessed type __int16 word_84D10;
// 84D12: using guessed type __int16 word_84D12;
// 84D18: using guessed type __int64 qword_84D18;
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000061400) ----------------------------------------------------
__int64 `global destructor keyed to'_a_18()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211ServiceRequestDescriptor::gMetaClass);
}
// 84BC0: using guessed type _QWORD IO80211ServiceRequestDescriptor::gMetaClass;

//----- (0000000000061420) ----------------------------------------------------
__int64 __fastcall getLengthBeforeSensitivePayload(int a1, __mbuf *a2)
{
  __int64 v2; // r12@1
  __mbuf *v3; // rbx@2
  __mbuf *v4; // rax@3
  bool v5; // sf@4
  unsigned __int8 v6; // of@4
  signed __int64 v7; // r12@5
  signed __int64 v8; // r12@10
  signed int v9; // er13@11
  signed int v10; // ebx@11
  unsigned __int16 v11; // ax@14
  int v12; // ecx@14
  __int64 v13; // rax@14
  int v14; // ecx@20
  unsigned __int8 v15; // al@22
  signed __int64 v16; // rax@28
  signed __int64 v17; // rax@31
  char v19; // [sp+0h] [bp-B0h]@22
  unsigned __int8 v20; // [sp+Ch] [bp-A4h]@22
  char v21; // [sp+18h] [bp-98h]@19
  unsigned __int8 v22; // [sp+1Eh] [bp-92h]@19
  char v23; // [sp+40h] [bp-70h]@27
  unsigned __int8 v24; // [sp+4Ch] [bp-64h]@27
  char v25; // [sp+58h] [bp-58h]@18
  unsigned __int8 v26; // [sp+61h] [bp-4Fh]@25
  __int16 v27; // [sp+6Ch] [bp-44h]@13
  unsigned __int8 v28; // [sp+6Eh] [bp-42h]@12
  unsigned __int8 v29; // [sp+6Fh] [bp-41h]@10
  unsigned __int8 v30; // [sp+70h] [bp-40h]@5
  unsigned __int8 v31; // [sp+71h] [bp-3Fh]@6
  char v32; // [sp+73h] [bp-3Dh]@7
  char v33; // [sp+74h] [bp-3Ch]@8
  unsigned __int8 v34; // [sp+75h] [bp-3Bh]@9
  __int16 v35; // [sp+76h] [bp-3Ah]@7
  char v36; // [sp+78h] [bp-38h]@5
  __int16 v37; // [sp+84h] [bp-2Ch]@7

  v2 = 0LL;
  if ( a2 )
  {
    v3 = a2;
    do
    {
      LODWORD(v2) = mbuf_len(v3) + v2;
      LODWORD(v4) = mbuf_next(v3, a2);
      v3 = v4;
    }
    while ( v4 );
    v6 = __OFSUB__((_DWORD)v2, a1);
    v5 = (signed int)v2 - a1 < 0;
    v2 = 0LL;
    if ( !(v5 ^ v6) )
    {
      v7 = 14LL;
      mbuf_copydata(a2, 0LL, 14LL, &v36);
      mbuf_copydata(a2, 14LL, 8LL, &v30);
      if ( v30 == 170 )
      {
        v7 = 14LL;
        if ( v31 == 170 )
        {
          v37 = v35;
          v7 = 22LL;
          if ( !v32 )
          {
            v7 = 22LL;
            if ( v33 == 23 )
            {
              v7 = 22LL;
              if ( v34 == 242 )
              {
                mbuf_copydata(a2, 26LL, 1LL, &v29);
                v8 = 6LL;
                if ( v29 )
                {
                  v9 = 6;
                  v10 = 0;
                  do
                  {
                    mbuf_copydata(a2, v8 + 23, 1LL, &v28);
                    v9 += v28 + 2;
                    ++v10;
                    v8 = v9;
                  }
                  while ( v10 < v29 );
                }
                mbuf_copydata(a2, v8 + 22, 2LL, &v27);
                v7 = v8 + 24;
                v37 = v27;
              }
            }
          }
        }
      }
      v11 = __ROL2__(v37, 8);
      v12 = v11;
      v13 = 0LL;
      if ( v12 == 2048 )
      {
        mbuf_copydata(a2, v7, 20LL, &v25);
        if ( (unsigned __int8)(v25 & 0xF0) != 96 )
        {
          v13 = 0LL;
          if ( v26 != 1 )
          {
            v7 += 4LL * (v25 & 0xF);
            v14 = v26;
            if ( v26 == 6 )
            {
              mbuf_copydata(a2, v7, 20LL, &v23);
              v15 = v24;
              goto LABEL_28;
            }
LABEL_35:
            if ( v14 == 17 )
              v13 = getLengthBeforeSensitivePayloadUDP(v7, a2);
            return v13 + v7;
          }
LABEL_31:
          LODWORD(v17) = mbuf_pkthdr_len(a2);
          v7 = v17;
LABEL_32:
          v13 = 0LL;
          return v13 + v7;
        }
      }
      else if ( v12 != 34525 )
      {
        if ( v12 != 2054 )
          return v13 + v7;
        goto LABEL_31;
      }
      mbuf_copydata(a2, v7, 40LL, &v21);
      v7 += 40LL;
      v13 = 0LL;
      if ( (char)v22 > 57 )
      {
        if ( v22 != 58 )
          return v13 + v7;
      }
      else
      {
        v14 = v22;
        if ( v22 != 1 )
        {
          if ( v22 == 6 )
          {
            mbuf_copydata(a2, v7, 20LL, &v19);
            v15 = v20;
LABEL_28:
            v16 = 4LL * (v15 >> 4);
            if ( (unsigned __int64)v16 < 0x14 )
              v16 = 20LL;
            v7 += v16;
            goto LABEL_32;
          }
          goto LABEL_35;
        }
      }
      goto LABEL_31;
    }
  }
  return v2;
}
// C8BF0: using guessed type int __fastcall mbuf_copydata(_QWORD, _QWORD, _QWORD, _QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C58: using guessed type int __fastcall mbuf_next(_QWORD, _QWORD);
// C8C68: using guessed type int __fastcall mbuf_pkthdr_len(_QWORD);

//----- (00000000000616C6) ----------------------------------------------------
__int64 __fastcall getLengthBeforeSensitivePayloadUDP(int a1, __mbuf *a2)
{
  __int16 v2; // ax@1
  __int16 v3; // cx@4
  __int64 v4; // rax@4
  __int16 v6; // [sp+8h] [bp-8h]@1
  __int16 v7; // [sp+Ah] [bp-6h]@4
  __int16 v8; // [sp+Ch] [bp-4h]@7

  mbuf_copydata(a2, a1, 8LL, &v6);
  v2 = __ROL2__(v6, 8);
  if ( v2 == 53 || v2 == 67 || v2 == 5353 || (v3 = __ROL2__(v7, 8), v4 = 0LL, v3 == 53) || v3 == 67 || v3 == 5353 )
  {
    LOWORD(v4) = __ROL2__(v8, 8);
    v4 = (unsigned __int16)v4;
  }
  return v4 + 8;
}
// C8BF0: using guessed type int __fastcall mbuf_copydata(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000061736) ----------------------------------------------------
__int64 __fastcall Stopwatch::MetaClass::MetaClass(Stopwatch::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "Stopwatch", off_7B030[0], 32LL);
  result = (__int64)off_81700;
  *(_QWORD *)this = off_81700;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 81700: using guessed type __int64 (__fastcall *off_81700[2])(Stopwatch::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000061768) ----------------------------------------------------
__int64 __fastcall Stopwatch::MetaClass::~MetaClass(Stopwatch::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000061772) ----------------------------------------------------
__int64 __fastcall Stopwatch::Stopwatch(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_815D0;
  *(_QWORD *)a1 = off_815D0;
  return result;
}
// 815D0: using guessed type __int64 (__fastcall *off_815D0[2])(Stopwatch *__hidden this);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000061792) ----------------------------------------------------
__int64 __fastcall Stopwatch::Stopwatch(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_815D0;
  *(_QWORD *)a1 = off_815D0;
  return result;
}
// 815D0: using guessed type __int64 (__fastcall *off_815D0[2])(Stopwatch *__hidden this);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000617B2) ----------------------------------------------------
__int64 __fastcall Stopwatch::~Stopwatch(Stopwatch *this)
{
  return OSObject::~OSObject(this);
}

//----- (00000000000617BC) ----------------------------------------------------
__int64 __fastcall Stopwatch::~Stopwatch(Stopwatch *this)
{
  return OSObject::~OSObject(this);
}

//----- (00000000000617C6) ----------------------------------------------------
void __fastcall Stopwatch::~Stopwatch(Stopwatch *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (00000000000617E8) ----------------------------------------------------
__int64 __fastcall Stopwatch::getMetaClass(Stopwatch *this)
{
  return (__int64)&Stopwatch::gMetaClass;
}
// 84D20: using guessed type _QWORD Stopwatch::gMetaClass;

//----- (00000000000617F6) ----------------------------------------------------
__int64 __fastcall Stopwatch::MetaClass::MetaClass(Stopwatch::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "Stopwatch", off_7B030[0], 32LL);
  result = (__int64)off_81700;
  *(_QWORD *)this = off_81700;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 81700: using guessed type __int64 (__fastcall *off_81700[2])(Stopwatch::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000061828) ----------------------------------------------------
__int64 __fastcall Stopwatch::MetaClass::alloc(Stopwatch::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20, a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_815D0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&Stopwatch::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 815D0: using guessed type __int64 (__fastcall *off_815D0[2])(Stopwatch *__hidden this);
// 84D20: using guessed type _QWORD Stopwatch::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000061868) ----------------------------------------------------
__int64 __fastcall Stopwatch::Stopwatch(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_815D0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&Stopwatch::gMetaClass);
}
// 815D0: using guessed type __int64 (__fastcall *off_815D0[2])(Stopwatch *__hidden this);
// 84D20: using guessed type _QWORD Stopwatch::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000061898) ----------------------------------------------------
__int64 __fastcall Stopwatch::Stopwatch(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_815D0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&Stopwatch::gMetaClass);
}
// 815D0: using guessed type __int64 (__fastcall *off_815D0[2])(Stopwatch *__hidden this);
// 84D20: using guessed type _QWORD Stopwatch::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000618C8) ----------------------------------------------------
__int64 __fastcall Stopwatch::withUptime(Stopwatch *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20, a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_815D0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&Stopwatch::gMetaClass);
  if ( v2
    && !(unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v2 + 136LL))(v2, &Stopwatch::gMetaClass) )
  {
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
    v2 = 0LL;
  }
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 815D0: using guessed type __int64 (__fastcall *off_815D0[2])(Stopwatch *__hidden this);
// 84D20: using guessed type _QWORD Stopwatch::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000061928) ----------------------------------------------------
int __fastcall Stopwatch::init(Stopwatch *this)
{
  return (*(int (__fastcall **)(Stopwatch *))(off_7B068[0] + 152))(this);
}
// 7B068: using guessed type __int64 off_7B068[9];

//----- (000000000006193A) ----------------------------------------------------
int __fastcall Stopwatch::free(Stopwatch *this)
{
  return (*(int (__fastcall **)(Stopwatch *))(off_7B068[0] + 160))(this);
}
// 7B068: using guessed type __int64 off_7B068[9];

//----- (000000000006194C) ----------------------------------------------------
int __usercall Stopwatch::start@<eax>(Stopwatch *this@<rdi>, __int64 a2@<rax>)
{
  uint64_t v2; // rax@2
  uint64_t v3; // rax@4
  __int64 v5; // [sp+0h] [bp-10h]@1

  v5 = a2;
  if ( *((_QWORD *)this + 3) )
  {
    v2 = mach_absolute_time();
    absolutetime_to_nanoseconds(v2, &v5);
    a2 = v5 - *((_QWORD *)this + 3);
    *((_QWORD *)this + 2) += a2;
    *((_QWORD *)this + 3) = 0LL;
  }
  else if ( !*((_QWORD *)this + 2) )
  {
    v3 = mach_absolute_time();
    LODWORD(a2) = absolutetime_to_nanoseconds(v3, (char *)this + 16);
  }
  return a2;
}
// C89A8: using guessed type int __fastcall absolutetime_to_nanoseconds(_QWORD, _QWORD);

//----- (00000000000619A6) ----------------------------------------------------
__int64 __fastcall Stopwatch::getElapsed_ns(Stopwatch *this)
{
  return *((_QWORD *)this + 3) - *((_QWORD *)this + 2);
}

//----- (00000000000619B4) ----------------------------------------------------
void __fastcall Stopwatch::reset(Stopwatch *this)
{
  *((_QWORD *)this + 2) = 0LL;
  *((_QWORD *)this + 3) = 0LL;
}

//----- (00000000000619CA) ----------------------------------------------------
int __fastcall Stopwatch::restart(Stopwatch *this)
{
  uint64_t v1; // rax@1
  int result; // eax@1

  v1 = mach_absolute_time();
  result = absolutetime_to_nanoseconds(v1, (char *)this + 16);
  *((_QWORD *)this + 3) = 0LL;
  return result;
}
// C89A8: using guessed type int __fastcall absolutetime_to_nanoseconds(_QWORD, _QWORD);

//----- (00000000000619F4) ----------------------------------------------------
int __fastcall Stopwatch::stop(Stopwatch *this)
{
  uint64_t v1; // rax@4
  int result; // eax@4

  if ( *((_QWORD *)this + 2) )
  {
    if ( !*((_QWORD *)this + 3) )
    {
      v1 = mach_absolute_time();
      result = absolutetime_to_nanoseconds(v1, (char *)this + 24);
    }
  }
  return result;
}
// C89A8: using guessed type int __fastcall absolutetime_to_nanoseconds(_QWORD, _QWORD);

//----- (0000000000061A2C) ----------------------------------------------------
__int64 __usercall Stopwatch::getSplit_ns@<rax>(Stopwatch *this@<rdi>, __int64 a2@<rax>)
{
  uint64_t v2; // rax@1
  __int64 v4; // [sp+0h] [bp-10h]@1

  v4 = a2;
  v2 = mach_absolute_time();
  absolutetime_to_nanoseconds(v2, &v4);
  return v4 - *((_QWORD *)this + 2);
}
// C89A8: using guessed type int __fastcall absolutetime_to_nanoseconds(_QWORD, _QWORD);

//----- (0000000000061A56) ----------------------------------------------------
unsigned __int64 __usercall Stopwatch::getSplit_us@<rax>(Stopwatch *this@<rdi>, __int64 a2@<rax>)
{
  uint64_t v2; // rax@1
  __int64 v4; // [sp+0h] [bp-10h]@1

  v4 = a2;
  v2 = mach_absolute_time();
  absolutetime_to_nanoseconds(v2, &v4);
  return 2361183241434822607LL * ((unsigned __int64)(v4 - *((_QWORD *)this + 2)) >> 3) >> 64 >> 4;
}
// C89A8: using guessed type int __fastcall absolutetime_to_nanoseconds(_QWORD, _QWORD);

//----- (0000000000061A98) ----------------------------------------------------
unsigned __int64 __fastcall Stopwatch::getElapsed_us(Stopwatch *this)
{
  return ((signed __int64)((unsigned __int128)(2361183241434822607LL * (*((_QWORD *)this + 3) - *((_QWORD *)this + 2))) >> 64) >> 7)
       + ((unsigned __int64)((unsigned __int128)(2361183241434822607LL * (*((_QWORD *)this + 3) - *((_QWORD *)this + 2))) >> 64) >> 63);
}

//----- (0000000000061AC2) ----------------------------------------------------
unsigned __int64 __fastcall Stopwatch::getElapsed_s(Stopwatch *this)
{
  return ((signed __int64)((unsigned __int128)(1237940039285380275LL * (*((_QWORD *)this + 3) - *((_QWORD *)this + 2))) >> 64) >> 26)
       + ((unsigned __int64)((unsigned __int128)(1237940039285380275LL * (*((_QWORD *)this + 3) - *((_QWORD *)this + 2))) >> 64) >> 63);
}

//----- (0000000000061AEC) ----------------------------------------------------
unsigned __int64 __fastcall Stopwatch::getElapsed(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  unsigned __int64 v3; // rdi@1
  unsigned __int64 v4; // rdi@1
  unsigned __int64 result; // rax@1

  v2 = *(_QWORD *)(a1 + 24) - *(_QWORD *)(a1 + 16);
  v3 = (unsigned __int128)(1237940039285380275LL * v2) >> 64;
  v4 = (v3 >> 63) + ((signed __int64)v3 >> 26);
  *(_QWORD *)a2 = v4;
  result = ((unsigned __int64)((unsigned __int128)(2361183241434822607LL * v2) >> 64) >> 63)
         + (unsigned int)((unsigned __int64)((unsigned __int128)(2361183241434822607LL * v2) >> 64) >> 7)
         + -1000000 * (signed int)v4;
  *(_DWORD *)(a2 + 8) = result;
  return result;
}

//----- (0000000000061B46) ----------------------------------------------------
__int64 __fastcall Stopwatch::MetaClass::~MetaClass(Stopwatch::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000061B50) ----------------------------------------------------
__int64 `global constructor keyed to'_a_19()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&Stopwatch::gMetaClass, "Stopwatch", off_7B030[0], 32LL);
  result = (__int64)off_81700;
  Stopwatch::gMetaClass = off_81700;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 81700: using guessed type __int64 (__fastcall *off_81700[2])(Stopwatch::MetaClass *__hidden this);
// 84D20: using guessed type _QWORD Stopwatch::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000061B90) ----------------------------------------------------
__int64 `global destructor keyed to'_a_19()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&Stopwatch::gMetaClass);
}
// 84D20: using guessed type _QWORD Stopwatch::gMetaClass;

//----- (0000000000061BA1) ----------------------------------------------------
__int64 __fastcall tls_prf_sha256(void *a1, size_t a2, const char *a3, __int64 a4, __int64 a5, __int64 a6, unsigned __int64 a7)
{
  __int64 v7; // ST08_8@1
  __int64 v8; // r14@1
  void *v9; // r13@1
  size_t v10; // r14@1
  unsigned __int64 v11; // r12@2
  size_t v12; // r13@3
  size_t v13; // r14@3
  __int64 v15; // [sp+18h] [bp-B8h]@1
  __int64 v16; // [sp+20h] [bp-B0h]@1
  size_t v17; // [sp+28h] [bp-A8h]@1
  __int64 v18; // [sp+30h] [bp-A0h]@1
  char *v19; // [sp+40h] [bp-90h]@1
  const char *v20; // [sp+48h] [bp-88h]@1
  __int64 v21; // [sp+50h] [bp-80h]@1
  char v22; // [sp+60h] [bp-70h]@3
  char v23; // [sp+80h] [bp-50h]@1
  __int64 v24; // [sp+A0h] [bp-30h]@1

  v15 = a6;
  v7 = a5;
  v8 = a4;
  v9 = a1;
  v24 = *(_QWORD *)off_7B078[0];
  v19 = &v23;
  v16 = 32LL;
  v20 = a3;
  v17 = strlen(a3);
  v21 = v8;
  v10 = a2;
  v18 = v7;
  hmac_sha256_vector(a1, a2, 2uLL, (__int64 *)&v20, (__int64 *)&v17, (__int64)&v23);
  if ( a7 )
  {
    v11 = 0LL;
    do
    {
      hmac_sha256_vector(v9, v10, 3uLL, (__int64 *)&v19, &v16, (__int64)&v22);
      XX_hmac_sha256(v9, v10, (__int64)&v23, 32LL, (__int64)&v23);
      v12 = v10;
      v13 = a7 - v11;
      if ( a7 - v11 > 0x20 )
        v13 = 32LL;
      memcpy((void *)(v15 + v11), &v22, v13);
      v11 += v13;
      v10 = v12;
      v9 = a1;
    }
    while ( v11 < a7 );
  }
  return *(_QWORD *)off_7B078[0];
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000061CF0) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::MetaClass::MetaClass(IO80211VirtualInterface::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211VirtualInterface", off_7B040[0], 360LL);
  result = (__int64)off_82180;
  *(_QWORD *)this = off_82180;
  return result;
}
// 7B040: using guessed type _QWORD off_7B040[14];
// 82180: using guessed type __int64 (__fastcall *off_82180[2])(IO80211VirtualInterface::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000061D22) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::MetaClass::~MetaClass(IO80211VirtualInterface::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000061D2C) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::IO80211VirtualInterface(__int64 a1)
{
  __int64 result; // rax@1

  IOService::IOService(a1);
  result = (__int64)off_81800;
  *(_QWORD *)a1 = off_81800;
  return result;
}
// 81800: using guessed type __int64 (__fastcall *off_81800[2])(IO80211VirtualInterface *__hidden this);
// C85F8: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (0000000000061D4C) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::IO80211VirtualInterface(__int64 a1)
{
  __int64 result; // rax@1

  IOService::IOService(a1);
  result = (__int64)off_81800;
  *(_QWORD *)a1 = off_81800;
  return result;
}
// 81800: using guessed type __int64 (__fastcall *off_81800[2])(IO80211VirtualInterface *__hidden this);
// C85F8: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (0000000000061D6C) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::~IO80211VirtualInterface(IO80211VirtualInterface *this)
{
  return IOService::~IOService(this);
}

//----- (0000000000061D76) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::~IO80211VirtualInterface(IO80211VirtualInterface *this)
{
  return IOService::~IOService(this);
}

//----- (0000000000061D80) ----------------------------------------------------
void __fastcall IO80211VirtualInterface::~IO80211VirtualInterface(IO80211VirtualInterface *this)
{
  IOService::~IOService(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000061DA2) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::getMetaClass(IO80211VirtualInterface *this)
{
  return (__int64)&IO80211VirtualInterface::gMetaClass;
}
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;

//----- (0000000000061DB0) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::MetaClass::MetaClass(IO80211VirtualInterface::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211VirtualInterface", off_7B040[0], 360LL);
  result = (__int64)off_82180;
  *(_QWORD *)this = off_82180;
  return result;
}
// 7B040: using guessed type _QWORD off_7B040[14];
// 82180: using guessed type __int64 (__fastcall *off_82180[2])(IO80211VirtualInterface::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000061DE2) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::MetaClass::alloc(IO80211VirtualInterface::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_158.segname[8], a2);
  IOService::IOService(v2);
  *(_QWORD *)v2 = off_81800;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211VirtualInterface::gMetaClass);
  return v2;
}
// 158: using guessed type segment_command_64;
// 81800: using guessed type __int64 (__fastcall *off_81800[2])(IO80211VirtualInterface *__hidden this);
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;
// C85F8: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (0000000000061E22) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::IO80211VirtualInterface(__int64 a1)
{
  IOService::IOService(a1);
  *(_QWORD *)a1 = off_81800;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211VirtualInterface::gMetaClass);
}
// 81800: using guessed type __int64 (__fastcall *off_81800[2])(IO80211VirtualInterface *__hidden this);
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;
// C85F8: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (0000000000061E52) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::IO80211VirtualInterface(__int64 a1)
{
  IOService::IOService(a1);
  *(_QWORD *)a1 = off_81800;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211VirtualInterface::gMetaClass);
}
// 81800: using guessed type __int64 (__fastcall *off_81800[2])(IO80211VirtualInterface *__hidden this);
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;
// C85F8: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (0000000000061E82) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface0(IO80211VirtualInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211VirtualInterface::gMetaClass, 0);
}
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;

//----- (0000000000061E96) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface1(IO80211VirtualInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211VirtualInterface::gMetaClass, 1);
}
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;

//----- (0000000000061EAC) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface2(IO80211VirtualInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211VirtualInterface::gMetaClass, 2);
}
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;

//----- (0000000000061EC2) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface3(IO80211VirtualInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211VirtualInterface::gMetaClass, 3);
}
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;

//----- (0000000000061ED8) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface4(IO80211VirtualInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211VirtualInterface::gMetaClass, 4);
}
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;

//----- (0000000000061EEE) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface5(IO80211VirtualInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211VirtualInterface::gMetaClass, 5);
}
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;

//----- (0000000000061F04) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface6(IO80211VirtualInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211VirtualInterface::gMetaClass, 6);
}
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;

//----- (0000000000061F1A) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface7(IO80211VirtualInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211VirtualInterface::gMetaClass, 7);
}
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;

//----- (0000000000061F30) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface8(IO80211VirtualInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211VirtualInterface::gMetaClass, 8);
}
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;

//----- (0000000000061F46) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface9(IO80211VirtualInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211VirtualInterface::gMetaClass, 9);
}
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;

//----- (0000000000061F5C) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface10(IO80211VirtualInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211VirtualInterface::gMetaClass, 10);
}
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;

//----- (0000000000061F72) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface11(IO80211VirtualInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211VirtualInterface::gMetaClass, 11);
}
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;

//----- (0000000000061F88) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface12(IO80211VirtualInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211VirtualInterface::gMetaClass, 12);
}
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;

//----- (0000000000061F9E) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface13(IO80211VirtualInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211VirtualInterface::gMetaClass, 13);
}
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;

//----- (0000000000061FB4) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface14(IO80211VirtualInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211VirtualInterface::gMetaClass, 14);
}
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;

//----- (0000000000061FCA) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::_RESERVEDIO80211VirtualInterface15(IO80211VirtualInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IO80211VirtualInterface::gMetaClass, 15);
}
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;

//----- (0000000000061FE0) ----------------------------------------------------
char __fastcall IO80211VirtualInterface::attachToBpf(IO80211VirtualInterface *this)
{
  __int64 v1; // rbx@1
  __int64 v2; // r15@1
  char v3; // r14@4
  OSMetaClass *v5; // rax@10
  __int64 v6; // rax@10
  __int64 v7; // r8@10
  __int64 v8; // [sp+30h] [bp-30h]@1
  int v9; // [sp+38h] [bp-28h]@1
  __int64 v10; // [sp+40h] [bp-20h]@1

  v1 = (__int64)this;
  v2 = off_7B078[0];
  v10 = *(_QWORD *)off_7B078[0];
  v9 = 0;
  v8 = 1LL;
  if ( !(*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211VirtualInterface *, __int64 *))(**((_QWORD **)this + 23) + 3224LL))(
          *((_QWORD *)this + 23),
          3223873993LL,
          12LL,
          this,
          &v8)
    && ((unsigned int)(*((_DWORD *)this + 44) - 2) > 4 || !IO80211VirtualInterface::bpfAttachEN10MB(this, 14)) )
    goto LABEL_7;
  v3 = 0;
  while ( *(_QWORD *)v2 != v10 )
  {
LABEL_7:
    if ( BYTE7(v8) & 1 )
    {
      v3 = 0;
      if ( (unsigned int)IO80211VirtualInterface::bpfAttach(
                           (IO80211VirtualInterface *)v1,
                           12,
                           64,
                           v1,
                           (__int64)IO80211VirtualInterface::bpfOutputPacket,
                           0LL,
                           0LL,
                           0LL,
                           0LL) )
        continue;
    }
    v3 = 1;
    if ( *(_DWORD *)(v1 + 176) == 4 )
    {
      bpfattach(*(_QWORD *)(v1 + 192), 147LL, 184LL);
      LODWORD(v5) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v1 + 56LL))(v1);
      v6 = OSMetaClass::getClassName(v5);
      v7 = *(_DWORD *)(v1 + 176);
      v1 += 200LL;
      IOLog("%s::%s name <%s> role %u successful attach to bpf type %u\n", v6, "attachToBpf", v1, v7, 147LL);
    }
  }
  return v3;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C89E8: using guessed type int __fastcall bpfattach(_QWORD, _QWORD, _QWORD);

//----- (0000000000062132) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::getController(IO80211VirtualInterface *this)
{
  return *((_QWORD *)this + 23);
}

//----- (0000000000062140) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::getInterfaceRole(IO80211VirtualInterface *this)
{
  return *((_DWORD *)this + 44);
}

//----- (000000000006214C) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::bpfAttach(IO80211VirtualInterface *this, int a2, int a3)
{
  return IO80211VirtualInterface::bpfAttach(
           this,
           a2,
           a3,
           (__int64)this,
           (__int64)IO80211VirtualInterface::bpfOutputPacket,
           0LL,
           0LL,
           0LL,
           0LL);
}

//----- (0000000000062196) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::getIfnet(IO80211VirtualInterface *this)
{
  return *((_QWORD *)this + 24);
}

//----- (00000000000621A4) ----------------------------------------------------
char *__fastcall IO80211VirtualInterface::getBSDName(IO80211VirtualInterface *this)
{
  return (char *)this + 200;
}

//----- (00000000000621B2) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::init(IO80211VirtualInterface *this, IO80211Controller *a2, ether_addr *a3, unsigned int a4, const char *a5)
{
  const char *v5; // r12@1
  unsigned int v6; // er15@1
  ether_addr *v7; // rbx@1
  IO80211VirtualInterface *v8; // r13@1
  char *v9; // rdx@3
  __int64 v10; // rdx@5
  __int64 v11; // rcx@5
  __int64 v12; // r8@5
  __int64 v13; // r9@5
  __int64 v14; // rax@6
  __int64 v15; // rax@7
  __int64 v16; // rax@8
  OSMetaClass *v17; // rax@9
  __int64 v18; // rax@9
  __int64 v19; // r9@9
  char *i; // rdx@10
  signed __int64 v21; // rax@12
  __int64 v23; // rax@17
  int v24; // eax@18
  void *v25; // rdi@18
  char *v26; // rsi@19
  __int64 v27; // rax@22
  __int64 v28; // rax@22
  __int64 v29; // rax@24
  __int64 v30; // rax@24
  __int64 v31; // rax@25
  __int64 v32; // rax@25
  __int64 v33; // rax@26
  __int64 v34; // rax@26
  __int64 v35; // rax@27
  OSMetaClass *v36; // rax@29
  __int64 v37; // rax@29
  __int64 v38; // r8@29
  __int64 v39; // r9@29
  signed __int64 v40; // [sp+8h] [bp-48h]@1
  int v41; // [sp+8h] [bp-48h]@3
  __int64 v42; // [sp+10h] [bp-40h]@17
  int v43; // [sp+18h] [bp-38h]@17
  __int64 v44; // [sp+20h] [bp-30h]@1

  v5 = a5;
  v6 = a4;
  v7 = a3;
  v8 = this;
  v44 = *(_QWORD *)off_7B078[0];
  v40 = 0LL;
  if ( !(unsigned __int8)(*(int (__fastcall **)(IO80211VirtualInterface *, _QWORD))(off_7B070[0] + 600))(this, 0LL) )
    goto LABEL_14;
  *((_DWORD *)this + 44) = v6;
  if ( v6 - 1 > 5 )
  {
    v41 = v6 - 1;
    v9 = "Uknown";
  }
  else
  {
    v41 = v6 - 1;
    v9 = off_82260[v6 - 1];
  }
  (*(void (__fastcall **)(IO80211VirtualInterface *, _QWORD, char *))(*(_QWORD *)this + 624LL))(
    this,
    "IO80211VirtualInterfaceRole",
    v9);
  (*(void (__fastcall **)(IO80211VirtualInterface *, _QWORD, ether_addr *, signed __int64))(*(_QWORD *)this + 648LL))(
    this,
    "IOMACAddress",
    v7,
    6LL);
  *((_QWORD *)this + 23) = a2;
  if ( !IO80211VirtualInterface::attachIfnet(this, v7, v5) )
  {
    v40 = 0LL;
    IOLog("IO80211VirtualInterface::attachIfnet: failed\n", v7, v10, v11, v12, v13);
    goto LABEL_14;
  }
  (*(void (__fastcall **)(IO80211VirtualInterface *, _QWORD, char *))(*(_QWORD *)this + 624LL))(
    this,
    "BSD Name",
    (char *)this + 200);
  LODWORD(v14) = IOLockAlloc(this);
  *((_QWORD *)this + 27) = v14;
  if ( !v14
    || (LODWORD(v15) = IOLockAlloc(this), (*((_QWORD *)this + 37) = v15) == 0LL)
    || (LODWORD(v16) = IOMalloc(8LL), (*((_QWORD *)this + 36) = v16) == 0LL) )
  {
    v21 = 0LL;
    goto LABEL_13;
  }
  *(_QWORD *)v16 = 0LL;
  LODWORD(v17) = (*(int (__fastcall **)(IO80211VirtualInterface *))(*(_QWORD *)this + 56LL))(this);
  v18 = OSMetaClass::getClassName(v17);
  IOLog("%s::%s name <%s> role %u\n", v18, "init", (char *)this + 200, v6, v19);
  *((_DWORD *)this + 44) = v6;
  if ( (unsigned int)v41 > 5 )
    goto LABEL_16;
  for ( i = off_82260[v41]; ; i = "Uknown" )
  {
    (*(void (__fastcall **)(IO80211VirtualInterface *, _QWORD, char *))(*(_QWORD *)v8 + 624LL))(
      v8,
      "IO80211VirtualInterfaceRole",
      i);
    (*(void (**)(void))(**((_QWORD **)v8 + 23) + 32LL))();
    IOService::registerInterestedDriver(*((IOService **)v8 + 23), v8);
    v40 = 0LL;
    (*(void (__fastcall **)(_QWORD, IO80211VirtualInterface *, _QWORD, _QWORD))(**((_QWORD **)v8 + 23) + 1488LL))(
      *((_QWORD *)v8 + 23),
      v8,
      0LL,
      0LL);
    *((_DWORD *)v8 + 57) = 1;
    v43 = 0;
    v42 = 1LL;
    LODWORD(v23) = IOMalloc(8LL);
    *((_QWORD *)v8 + 35) = v23;
    if ( v23 )
    {
      *((_BYTE *)v8 + 272) = 0;
      v24 = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64, IO80211VirtualInterface *, __int64 *))(**((_QWORD **)v8 + 23) + 3224LL))(
              *((_QWORD *)v8 + 23),
              3223873993LL,
              12LL,
              v8,
              &v42);
      v25 = (void *)*((_QWORD *)v8 + 35);
      if ( v24 )
      {
        v26 = (char *)&dword_8;
        bzero(v25, 8uLL);
      }
      else
      {
        v26 = (char *)&v42 + 4;
        memcpy(v25, (char *)&v42 + 4, 8uLL);
        if ( *(_BYTE *)(*((_QWORD *)v8 + 35) + 2LL) & 2 )
          *((_BYTE *)v8 + 272) = 1;
      }
      LODWORD(v27) = (*(int (__fastcall **)(_QWORD, char *))(**((_QWORD **)v8 + 23) + 1672LL))(
                       *((_QWORD *)v8 + 23),
                       v26);
      v40 = 0LL;
      LODWORD(v28) = IOGatedOutputQueue::withTarget(v8, 2161LL, 0LL, v27, 0LL);
      *((_QWORD *)v8 + 30) = v28;
      if ( v28 )
      {
        if ( !*((_BYTE *)v8 + 272)
          || (LODWORD(v29) = (*(int (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)v8 + 23) + 1672LL))(
                               *((_QWORD *)v8 + 23),
                               2161LL),
              v40 = 0LL,
              LODWORD(v30) = IOGatedOutputQueue::withTarget(v8, 2161LL, 0LL, v29, 0LL),
              (*((_QWORD *)v8 + 31) = v30) != 0LL)
          && (LODWORD(v31) = (*(int (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)v8 + 23) + 1672LL))(
                               *((_QWORD *)v8 + 23),
                               2161LL),
              v40 = 0LL,
              LODWORD(v32) = IOGatedOutputQueue::withTarget(v8, 2161LL, 0LL, v31, 0LL),
              (*((_QWORD *)v8 + 32) = v32) != 0LL)
          && (LODWORD(v33) = (*(int (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)v8 + 23) + 1672LL))(
                               *((_QWORD *)v8 + 23),
                               2161LL),
              v40 = 0LL,
              LODWORD(v34) = IOGatedOutputQueue::withTarget(v8, 2161LL, 0LL, v33, 0LL),
              (*((_QWORD *)v8 + 33) = v34) != 0LL) )
        {
          *((_BYTE *)v8 + 308) = 0;
          *((_DWORD *)v8 + 78) = 0;
          LODWORD(v35) = IO80211AllocateBpfTapThreadCall(v8);
          *((_QWORD *)v8 + 41) = v35;
          if ( IO80211VirtualInterface::attachToBpf(v8) )
          {
            v21 = 17179869185LL;
            *((_QWORD *)v8 + 17) = 17179869218LL;
LABEL_13:
            v40 = v21;
          }
          else
          {
            LODWORD(v36) = (*(int (__fastcall **)(IO80211VirtualInterface *, signed __int64))(*(_QWORD *)v8 + 56LL))(
                             v8,
                             2161LL);
            v37 = OSMetaClass::getClassName(v36);
            v40 = 0LL;
            IOLog("%s::%s cannot attach to bpf\n", v37, "init", v37, v38, v39);
          }
        }
      }
    }
LABEL_14:
    if ( *(_QWORD *)off_7B078[0] == v44 )
      break;
LABEL_16:
    ;
  }
  return v40;
}
// 8: using guessed type int;
// 7B070: using guessed type __int64 off_7B070[8];
// 7B078: using guessed type __int64 off_7B078[7];
// 82260: using guessed type char *off_82260[8];
// C76F0: using guessed type int __cdecl IOLockAlloc(_QWORD);
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// C7B08: using guessed type int __fastcall IOGatedOutputQueue::withTarget(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000625D6) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::setInterfaceRole(IO80211VirtualInterface *this, int a2)
{
  int v2; // esi@1
  char *v3; // rdx@2

  *((_DWORD *)this + 44) = a2;
  v2 = a2 - 1;
  if ( (unsigned int)v2 > 5 )
    v3 = "Uknown";
  else
    v3 = off_82260[v2];
  return (*(int (__fastcall **)(IO80211VirtualInterface *, _QWORD, char *))(*(_QWORD *)this + 624LL))(
           this,
           "IO80211VirtualInterfaceRole",
           v3);
}
// 82260: using guessed type char *off_82260[8];

//----- (0000000000062612) ----------------------------------------------------
char __fastcall IO80211VirtualInterface::attachIfnet(IO80211VirtualInterface *this, ether_addr *a2, const char *a3)
{
  const char *v3; // r15@1
  IO80211VirtualInterface *v4; // r13@1
  __int64 v5; // r14@1
  __int64 v6; // rax@1
  __int64 v7; // rax@1
  __int64 v8; // rbx@1
  char *v9; // rdi@3
  __int64 v10; // r8@3
  const char *v11; // rdx@3
  signed __int64 v12; // rcx@3
  char v13; // r12@3
  __int64 v14; // rax@8
  signed __int64 v15; // r15@8
  int v16; // eax@8
  __int64 v17; // r8@8
  __int64 v18; // r9@8
  __int64 v19; // rcx@8
  __int64 v20; // rdi@9
  int v21; // eax@10
  __int64 v22; // rdi@13
  signed __int64 v23; // rsi@13
  int v24; // eax@17
  __int64 v26; // rdi@23
  ether_addr *v27; // [sp+8h] [bp-1C8h]@3
  int v28; // [sp+10h] [bp-1C0h]@23
  __int16 v29; // [sp+14h] [bp-1BCh]@23
  int v30; // [sp+18h] [bp-1B8h]@8
  int v31; // [sp+1Ch] [bp-1B4h]@8
  __int64 v32; // [sp+28h] [bp-1A8h]@8
  int v33; // [sp+30h] [bp-1A0h]@8
  const char *v34; // [sp+38h] [bp-198h]@8
  int v35; // [sp+40h] [bp-190h]@8
  int v36; // [sp+44h] [bp-18Ch]@8
  int v37; // [sp+48h] [bp-188h]@8
  int v38; // [sp+4Ch] [bp-184h]@8
  int (__fastcall *v39)(IO80211VirtualInterface *, __ifnet *); // [sp+60h] [bp-170h]@8
  int v40; // [sp+70h] [bp-160h]@8
  __int64 v41; // [sp+F0h] [bp-E0h]@8
  __int64 v42; // [sp+F8h] [bp-D8h]@8
  __int64 v43; // [sp+100h] [bp-D0h]@8
  __int64 v44; // [sp+108h] [bp-C8h]@8
  __int64 v45; // [sp+110h] [bp-C0h]@8
  IO80211VirtualInterface *v46; // [sp+118h] [bp-B8h]@8
  int (__fastcall *v47)(IO80211VirtualInterface *, __ifnet *, __int64, void *); // [sp+120h] [bp-B0h]@8
  int (__fastcall *v48)(IO80211VirtualInterface *, __ifnet *); // [sp+130h] [bp-A0h]@8
  __int64 v49; // [sp+140h] [bp-90h]@8
  int v50; // [sp+148h] [bp-88h]@8
  int v51; // [sp+158h] [bp-78h]@8
  char v52; // [sp+170h] [bp-60h]@23
  char v53; // [sp+171h] [bp-5Fh]@23
  __int16 v54; // [sp+172h] [bp-5Eh]@23
  char v55; // [sp+174h] [bp-5Ch]@23
  unsigned __int8 v56; // [sp+175h] [bp-5Bh]@23
  char v57; // [sp+176h] [bp-5Ah]@23
  char v58[16]; // [sp+178h] [bp-58h]@23
  __int64 v59; // [sp+188h] [bp-48h]@17
  __int64 v60; // [sp+190h] [bp-40h]@17
  int v61; // [sp+198h] [bp-38h]@17
  __int64 v62; // [sp+1A0h] [bp-30h]@1

  v3 = a3;
  v4 = this;
  v5 = off_7B078[0];
  v62 = *(_QWORD *)off_7B078[0];
  (*(void (**)(void))(*(_QWORD *)this + 2256LL))();
  LODWORD(v6) = (*(int (__fastcall **)(IO80211VirtualInterface *, _QWORD))(*(_QWORD *)this + 696LL))(
                  this,
                  "IOMACAddress");
  LODWORD(v7) = OSMetaClassBase::safeMetaCast(v6, *(_QWORD *)off_7B028[0]);
  v8 = v7;
  if ( !v7 )
    goto LABEL_26;
  if ( *((_DWORD *)this + 44) == 4 )
  {
    v27 = a2;
    *((_DWORD *)this + 84) = 0;
    strncpy((char *)this + 340, v3, 0x10uLL);
    v9 = (char *)this + 200;
    v10 = *((_DWORD *)v4 + 84);
    v11 = "%s%u";
    v12 = (signed __int64)((char *)v4 + 340);
    v13 = 0;
    goto LABEL_7;
  }
  if ( strnlen(v3, 0x10uLL) > 0xF )
  {
LABEL_26:
    v13 = 0;
    goto LABEL_20;
  }
  v27 = a2;
  (*(void (__fastcall **)(IO80211VirtualInterface *, const char *))(*(_QWORD *)this + 2264LL))(this, v3);
  v9 = (char *)this + 200;
  v10 = *((_DWORD *)v4 + 84);
  v11 = "%s%u";
  v13 = 0;
  v12 = (signed __int64)v3;
LABEL_7:
  if ( snprintf(v9, 0x10uLL, v11, v12, v10) <= 15 )
  {
    (*(void (__fastcall **)(__int64, signed __int64, signed __int64))(*(_QWORD *)v8 + 360LL))(v8, (char *)v4 + 336, 4LL);
    memset(&v30, 0, 0x158uLL);
    v30 = 2;
    v31 = 344;
    LODWORD(v14) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v8 + 376LL))(v8, 0LL);
    v32 = v14;
    v33 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v8 + 320LL))(v8);
    v34 = v3;
    v35 = *((_DWORD *)v4 + 84);
    v36 = 2;
    v51 = 3;
    v37 = 6;
    v38 = *((_DWORD *)v4 + 39);
    v39 = IO80211VirtualInterface::ifnet_start_callback;
    v40 = *((_DWORD *)v4 + 38);
    v41 = off_7B098[0];
    v42 = off_7B080[0];
    v43 = off_7B090[0];
    v45 = off_7B0A0[0];
    v44 = off_7B088[0];
    v46 = v4;
    v48 = IO80211VirtualInterface::ifnet_detach_callback;
    v49 = (__int64)&ether_broadcast_addr;
    v50 = 6;
    v47 = IO80211VirtualInterface::ifnet_ioctl_callback;
    v15 = (signed __int64)((char *)v4 + 192);
    v16 = ifnet_allocate_extended(&v30, (char *)v4 + 192);
    v19 = (unsigned int)v16;
    if ( v16 )
    {
      v20 = (__int64)"%s: ifnet_allocate_extended failed (%d)\n";
    }
    else
    {
      v21 = *((_DWORD *)v4 + 44);
      if ( v21 == 4 )
      {
        ifnet_set_eflags(*((_QWORD *)v4 + 24), 0x100000LL, 0x100000LL);
        ifnet_set_eflags(*((_QWORD *)v4 + 24), 0x200000LL, 0x200000LL);
        v21 = *((_DWORD *)v4 + 44);
      }
      if ( v21 == 1 )
      {
        v22 = *(_QWORD *)v15;
        v23 = 2304LL;
      }
      else
      {
        v22 = *(_QWORD *)v15;
        if ( v21 == 4 )
          v23 = 1452LL;
        else
          v23 = 1500LL;
      }
      ifnet_set_mtu(v22, v23);
      ifnet_set_addrlen(*(_QWORD *)v15, 6LL);
      ifnet_set_hdrlen(*(_QWORD *)v15, 14LL);
      ifnet_set_flags(*(_QWORD *)v15, 34818LL, 0xFFFFLL);
      ifnet_set_baudrate(*(_QWORD *)v15, 10000000LL);
      v61 = 0;
      v60 = 0LL;
      v59 = 0LL;
      LOWORD(v59) = 4622;
      BYTE6(v59) = 6;
      memcpy(&v60, v27, 6uLL);
      v24 = ifnet_attach(*(_QWORD *)v15, &v59);
      v19 = (unsigned int)v24;
      if ( !v24 )
        goto LABEL_22;
      v20 = (__int64)"%s: ifnet_attach failed (%d)\n";
    }
    v13 = 0;
    IOLog(v20, "attachIfnet", (unsigned int)v19, v19, v17, v18);
  }
LABEL_20:
  while ( *(_QWORD *)v5 != v62 )
  {
LABEL_22:
    v13 = 1;
    if ( *((_DWORD *)v4 + 44) == 4 )
    {
      v29 = -1280;
      v28 = 8401715;
      bzero(&v52, 0x14uLL);
      v52 = 20;
      v53 = 18;
      v55 = 6;
      v57 = 6;
      v54 = ifnet_index(*((_QWORD *)v4 + 24));
      memcpy(&v58[v56], &v28, 6uLL);
      v26 = *((_QWORD *)v4 + 24);
      v4 = (IO80211VirtualInterface *)((char *)v4 + 168);
      ifnet_add_multicast(v26, &v52, v4);
    }
  }
  return v13;
}
// 7AFDC: using guessed type _QWORD ether_broadcast_addr;
// 7B028: using guessed type _QWORD off_7B028[17];
// 7B078: using guessed type __int64 off_7B078[7];
// 7B080: using guessed type __int64 off_7B080[6];
// 7B088: using guessed type __int64 off_7B088[5];
// 7B090: using guessed type __int64 off_7B090[4];
// 7B098: using guessed type __int64 off_7B098[3];
// 7B0A0: using guessed type __int64 off_7B0A0[2];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7AD8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// C8AB8: using guessed type int __fastcall ifnet_add_multicast(_QWORD, _QWORD, _QWORD);
// C8AC0: using guessed type int __fastcall ifnet_allocate_extended(_QWORD, _QWORD);
// C8AC8: using guessed type int __fastcall ifnet_attach(_QWORD, _QWORD);
// C8B08: using guessed type int __fastcall ifnet_index(_QWORD);
// C8B58: using guessed type int __fastcall ifnet_set_addrlen(_QWORD, _QWORD);
// C8B60: using guessed type int __fastcall ifnet_set_baudrate(_QWORD, _QWORD);
// C8B68: using guessed type int __fastcall ifnet_set_eflags(_QWORD, _QWORD, _QWORD);
// C8B70: using guessed type int __fastcall ifnet_set_flags(_QWORD, _QWORD, _QWORD);
// C8B78: using guessed type int __fastcall ifnet_set_hdrlen(_QWORD, _QWORD);
// C8B88: using guessed type int __fastcall ifnet_set_mtu(_QWORD, _QWORD);
// 62612: using guessed type char var_58[16];

//----- (0000000000062A4A) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::stringFromReturn(IO80211VirtualInterface *this)
{
  IO80211VirtualInterface *v1; // rax@1
  __int64 v2; // rdi@1
  int result; // eax@2

  v1 = this;
  v2 = *((_QWORD *)this + 23);
  if ( v2 )
    result = (*(int (**)(void))(*(_QWORD *)v2 + 1920LL))();
  else
    result = (*(int (__fastcall **)(IO80211VirtualInterface *))(off_7B070[0] + 1936))(v1);
  return result;
}
// 7B070: using guessed type __int64 off_7B070[8];

//----- (0000000000062A7C) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::errnoFromReturn(IO80211VirtualInterface *this)
{
  IO80211VirtualInterface *v1; // rax@1
  __int64 v2; // rdi@1
  int result; // eax@2

  v1 = this;
  v2 = *((_QWORD *)this + 23);
  if ( v2 )
    result = (*(int (**)(void))(*(_QWORD *)v2 + 1928LL))();
  else
    result = (*(int (__fastcall **)(IO80211VirtualInterface *))(off_7B070[0] + 1944))(v1);
  return result;
}
// 7B070: using guessed type __int64 off_7B070[8];

//----- (0000000000062AAE) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::configureAQMOutput(IO80211VirtualInterface *this)
{
  __int64 result; // rax@1

  result = 4398046511105LL;
  *((_QWORD *)this + 19) = 4398046511105LL;
  return result;
}

//----- (0000000000062AC6) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::reportTransmitStatus(__int64 a1, __int64 a2, int a3, __int64 a4)
{
  IO80211PeerManager *v4; // rdi@1
  int result; // eax@2

  v4 = *(IO80211PeerManager **)(a1 + 144);
  if ( v4 )
  {
    result = IO80211PeerManager::reportTransmitStatus(v4, a2, a3, a4);
  }
  else if ( a2 )
  {
    result = mbuf_freem(a2);
  }
  return result;
}
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);

//----- (0000000000062AEC) ----------------------------------------------------
char __fastcall IO80211VirtualInterface::dualBandCapable(IO80211VirtualInterface *this)
{
  return (unsigned __int8)(*(_BYTE *)(*((_QWORD *)this + 35) + 3LL) & 0x20) >> 5;
}

//----- (0000000000062B02) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::reportDataPathEventsGated(IO80211VirtualInterface *this, void *a2, void *a3, void *a4, void *a5, void *a6)
{
  void *v6; // r14@1
  IO80211VirtualInterface *v7; // rbx@1
  unsigned int v8; // er15@1
  unsigned __int64 v9; // r12@1
  __int64 v10; // rdi@4

  v6 = a3;
  v7 = this;
  v8 = *(_DWORD *)a2;
  v9 = 0LL;
  if ( a4 )
    v9 = *(_QWORD *)a4;
  if ( this )
  {
    v10 = *((_QWORD *)this + 18);
    if ( !v10
      || (unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD, void *, unsigned __int64, void *, void *))(*(_QWORD *)v10 + 480LL))(
                            v10,
                            v8,
                            a3,
                            v9,
                            a5,
                            a6) )
      IO80211InterfacePostMessage((char *)v7 + 200, v8, v6, v9);
  }
  return 0LL;
}

//----- (0000000000062B6C) ----------------------------------------------------
bool __fastcall IO80211VirtualInterface::reportDataPathEvents(IO80211VirtualInterface *this, int a2, void *a3, __int64 a4)
{
  __int64 v5; // [sp+10h] [bp-10h]@1
  int v6; // [sp+1Ch] [bp-4h]@1

  v6 = a2;
  v5 = a4;
  return (*(int (__fastcall **)(_QWORD, IO80211VirtualInterface *, __int64 (__fastcall *)(IO80211VirtualInterface *, void *, void *, void *, void *, void *), IO80211VirtualInterface *, int *, void *))(**((_QWORD **)this + 23) + 2128LL))(
           *((_QWORD *)this + 23),
           this,
           IO80211VirtualInterface::reportDataPathEventsGated,
           this,
           &v6,
           a3) != 0;
}

//----- (0000000000062BC0) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::free(IO80211VirtualInterface *this, signed __int64 a2)
{
  IO80211VirtualInterface *v2; // rbx@1
  __int64 v3; // rdi@1
  __int64 v4; // rdi@5
  __int64 v5; // rdi@7
  __int64 v6; // rdi@9
  __int64 v7; // rdi@11
  __int64 v8; // rdi@13
  __int64 v9; // rdi@15
  __int64 v10; // rdi@17
  __int64 v11; // rdi@19
  __int64 v12; // rdi@21

  v2 = this;
  v3 = *((_QWORD *)this + 35);
  if ( v3 )
  {
    a2 = 8LL;
    IOFree(v3, 8LL);
    *((_QWORD *)v2 + 35) = 0LL;
  }
  if ( *((_QWORD *)v2 + 24) )
    IO80211VirtualInterface::detachIfnet(v2);
  v4 = *((_QWORD *)v2 + 23);
  if ( v4 )
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
  v5 = *((_QWORD *)v2 + 27);
  if ( v5 )
    IOLockFree(v5);
  v6 = *((_QWORD *)v2 + 37);
  if ( v6 )
    IOLockFree(v6);
  v7 = *((_QWORD *)v2 + 36);
  if ( v7 )
  {
    IO80211BPFListFree(v7);
    a2 = 8LL;
    IOFree(*((_QWORD *)v2 + 36), 8LL);
  }
  v8 = *((_QWORD *)v2 + 41);
  if ( v8 )
    thread_call_free(v8, a2);
  v9 = *((_QWORD *)v2 + 30);
  if ( v9 )
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v9 + 40LL))(v9);
  v10 = *((_QWORD *)v2 + 31);
  if ( v10 )
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v10 + 40LL))(v10);
  v11 = *((_QWORD *)v2 + 32);
  if ( v11 )
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v11 + 40LL))(v11);
  v12 = *((_QWORD *)v2 + 33);
  if ( v12 )
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v12 + 40LL))(v12);
  if ( *((_BYTE *)v2 + 340) )
    IO80211VirtualInterfaceNamerMarkInterfaceUnitUnused((const char *)v2 + 340, *((_DWORD *)v2 + 84));
  return (*(int (__fastcall **)(IO80211VirtualInterface *))(off_7B070[0] + 160))(v2);
}
// 7B070: using guessed type __int64 off_7B070[8];
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C76F8: using guessed type int __fastcall IOLockFree(_QWORD);
// C8DD0: using guessed type int __fastcall thread_call_free(_QWORD, _QWORD);

//----- (0000000000062CDC) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::detachIfnet(IO80211VirtualInterface *this)
{
  *((_BYTE *)this + 224) = 1;
  ifnet_detach(*((_QWORD *)this + 24));
  IOLockLock(*((_QWORD *)this + 27));
  if ( *((_BYTE *)this + 224) )
  {
    assert_wait(*((_QWORD *)this + 24), 0LL);
    IOLockUnlock(*((_QWORD *)this + 27));
    thread_block(0LL);
    IOLockLock(*((_QWORD *)this + 27));
  }
  IOLockUnlock(*((_QWORD *)this + 27));
  return ifnet_release(*((_QWORD *)this + 24));
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C89C0: using guessed type int __fastcall assert_wait(_QWORD, _QWORD);
// C8AD8: using guessed type int __fastcall ifnet_detach(_QWORD);
// C8B48: using guessed type int __fastcall ifnet_release(_QWORD);
// C8DA8: using guessed type int __fastcall thread_block(_QWORD);

//----- (0000000000062D58) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::terminate(IO80211VirtualInterface *this, unsigned int a2)
{
  IO80211VirtualInterface *v2; // rbx@1
  __int64 v3; // rdi@1

  v2 = this;
  *((_BYTE *)this + 319) = 1;
  (*(void (__fastcall **)(_QWORD, IO80211VirtualInterface *, _QWORD))(**((_QWORD **)this + 23) + 1496LL))(
    *((_QWORD *)this + 23),
    this,
    a2);
  IOService::deRegisterInterestedDriver(*((IOService **)v2 + 23), v2);
  v3 = *((_QWORD *)this + 36);
  if ( v3 )
  {
    IO80211BPFListFree(v3);
    IOFree(*((_QWORD *)v2 + 36), 8LL);
    *((_QWORD *)v2 + 36) = 0LL;
  }
  return (*(int (__fastcall **)(IO80211VirtualInterface *, _QWORD))(off_7B070[0] + 1552))(v2, a2);
}
// 7B070: using guessed type __int64 off_7B070[8];
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (0000000000062DD6) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::powerStateWillChangeTo(IO80211VirtualInterface *this, __int64 a2, __int64 a3, IOService *a4)
{
  __int64 v5; // [sp+10h] [bp-10h]@1
  __int64 v6; // [sp+18h] [bp-8h]@1

  v6 = a2;
  v5 = a3;
  (*(void (__fastcall **)(_QWORD, IO80211VirtualInterface *, int (__fastcall *)(IO80211VirtualInterface *, void *, void *, void *, void *, void *), IO80211VirtualInterface *, __int64 *, __int64 *))(**((_QWORD **)this + 23) + 2128LL))(
    *((_QWORD *)this + 23),
    this,
    IO80211VirtualInterface::powerStateWillChangeToGated,
    this,
    &v6,
    &v5);
  return 0LL;
}

//----- (0000000000062E24) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::powerStateWillChangeToGated(IO80211VirtualInterface *this, void *a2, void *a3, void *a4, void *a5, void *a6)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2192LL))(
           this,
           *((_QWORD *)this + 23),
           *(_QWORD *)a2,
           *(_DWORD *)a3,
           a4);
}

//----- (0000000000062E4C) ----------------------------------------------------
__int64 __usercall IO80211VirtualInterface::controllerWillChangePowerState@<rax>(IO80211VirtualInterface *this@<rdi>, IO80211Controller *a2@<rsi>, IOService *a3@<r8>, char a4@<dh>)
{
  if ( !(a4 & 0x80) && !*((_BYTE *)this + 316) )
  {
    *((_BYTE *)this + 316) = 1;
    if ( *((_BYTE *)this + 317) )
      IO80211VirtualInterface::handleSIOCSIFFLAGS(this);
  }
  return 0LL;
}

//----- (0000000000062E78) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::handleSIOCSIFFLAGS(IO80211VirtualInterface *this)
{
  IO80211VirtualInterface *v1; // rbx@1
  __int16 v2; // r14@1
  char v3; // cl@2
  unsigned __int16 v4; // r14@7
  IO80211PeerManager *v5; // rdi@7
  IO80211PeerManager *v6; // rdi@12

  v1 = this;
  v2 = ifnet_flags(*((_QWORD *)this + 24));
  if ( v2 & 1 )
  {
    v3 = *((_BYTE *)this + 316);
    if ( !v3 || !(v2 & 0x40) )
    {
      if ( !v3
        && !(v2 & 0x40)
        && !(*(int (__fastcall **)(_QWORD, IO80211VirtualInterface *))(**((_QWORD **)this + 23) + 3296LL))(
              *((_QWORD *)this + 23),
              this) )
      {
        v4 = v2 | 0x40;
        *((_BYTE *)this + 317) = 1;
        IO80211VirtualInterface::configureBpfOutputQueues(this, 1u);
        v5 = (IO80211PeerManager *)*((_QWORD *)this + 18);
        if ( v5 && *((_DWORD *)v1 + 57) == 2 )
          IO80211PeerManager::enable(v5, "handleSIOCSIFFLAGS");
LABEL_14:
        ifnet_set_flags(*((_QWORD *)v1 + 24), v4, 64LL);
        return 0LL;
      }
      return 0LL;
    }
  }
  else if ( !(v2 & 0x40) )
  {
    return 0LL;
  }
  if ( !(*(int (__fastcall **)(_QWORD, IO80211VirtualInterface *))(**((_QWORD **)this + 23) + 3304LL))(
          *((_QWORD *)this + 23),
          this) )
  {
    v4 = v2 & 0xFFBF;
    *((_BYTE *)this + 317) = 0;
    IO80211VirtualInterface::configureBpfOutputQueues(this, 0);
    v6 = (IO80211PeerManager *)*((_QWORD *)this + 18);
    if ( v6 )
      IO80211PeerManager::disable(v6, "handleSIOCSIFFLAGS");
    goto LABEL_14;
  }
  return 0LL;
}
// C8AF8: using guessed type int __fastcall ifnet_flags(_QWORD);
// C8B70: using guessed type int __fastcall ifnet_set_flags(_QWORD, _QWORD, _QWORD);

//----- (0000000000062F7C) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::powerStateDidChangeTo(IO80211VirtualInterface *this, __int64 a2, __int64 a3, IOService *a4)
{
  __int64 v5; // [sp+10h] [bp-10h]@1
  __int64 v6; // [sp+18h] [bp-8h]@1

  v6 = a2;
  v5 = a3;
  (*(void (__fastcall **)(_QWORD, IO80211VirtualInterface *, int (__fastcall *)(IO80211VirtualInterface *, void *, void *, void *, void *, void *), IO80211VirtualInterface *, __int64 *, __int64 *))(**((_QWORD **)this + 23) + 2128LL))(
    *((_QWORD *)this + 23),
    this,
    IO80211VirtualInterface::powerStateDidChangeToGated,
    this,
    &v6,
    &v5);
  return 0LL;
}

//----- (0000000000062FCA) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::powerStateDidChangeToGated(IO80211VirtualInterface *this, void *a2, void *a3, void *a4, void *a5, void *a6)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2200LL))(
           this,
           *((_QWORD *)this + 23),
           *(_QWORD *)a2,
           *(_DWORD *)a3,
           a4);
}

//----- (0000000000062FF2) ----------------------------------------------------
__int64 __usercall IO80211VirtualInterface::controllerDidChangePowerState@<rax>(IO80211VirtualInterface *this@<rdi>, IO80211Controller *a2@<rsi>, IOService *a3@<r8>, char a4@<dh>)
{
  if ( a4 & 0x80 )
  {
    *((_BYTE *)this + 316) = 0;
    IO80211VirtualInterface::handleSIOCSIFFLAGS(this);
  }
  return 0LL;
}

//----- (000000000006300C) ----------------------------------------------------
void __fastcall IO80211VirtualInterface::setEnabledBySystem(IO80211VirtualInterface *this, char a2)
{
  *((_BYTE *)this + 317) = a2;
}

//----- (000000000006301A) ----------------------------------------------------
char __fastcall IO80211VirtualInterface::enabledBySystem(IO80211VirtualInterface *this)
{
  return *((_BYTE *)this + 317);
}

//----- (0000000000063026) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::bpfTap(IO80211VirtualInterface *this, int a2, unsigned int a3)
{
  unsigned int v3; // er14@1
  IO80211VirtualInterface *v4; // r13@1
  int v5; // ebx@1
  __int64 v6; // rax@5
  __int64 v7; // r12@5
  char *v8; // rcx@6
  __int64 v9; // rdi@7

  v3 = a3;
  v4 = this;
  v5 = 0;
  if ( !*((_BYTE *)this + 319) )
  {
    if ( a2 == 1 )
    {
      v5 = 22;
      if ( *((_BYTE *)this + 308) )
      {
        *((_DWORD *)this + 78) = a3;
        v5 = 0;
      }
    }
    else
    {
      IOLockLock(*((_QWORD *)this + 37));
      v6 = IO80211BPFNodeForDLT(a2, *((_QWORD *)this + 36));
      v7 = v6;
      if ( v6 )
      {
        v8 = *(char **)(v6 + 40);
        if ( !v8 )
          goto LABEL_16;
        v9 = *(_QWORD *)(v6 + 32) + *(_QWORD *)(v6 + 48);
        if ( (unsigned __int8)v8 & 1 )
          v8 = *(char **)&v8[*(_QWORD *)v9 - 1];
        v5 = ((int (__fastcall *)(__int64, _QWORD, _QWORD))v8)(v9, (unsigned int)a2, v3);
        if ( !v5 )
        {
LABEL_16:
          *(_DWORD *)(v7 + 56) = v3;
          v5 = 0;
        }
        IOLockUnlock(*((_QWORD *)v4 + 37));
      }
      else
      {
        IOLockUnlock(*((_QWORD *)this + 37));
        v5 = 22;
      }
    }
  }
  return (unsigned int)v5;
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);

//----- (00000000000630FA) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::configureBpfOutputQueues(IO80211VirtualInterface *this, unsigned __int8 a2)
{
  __int64 i; // rbx@1

  IOLockLock(*((_QWORD *)this + 37));
  for ( i = **((_QWORD **)this + 36); i; i = *(_QWORD *)i )
    IO80211ConfigureBPFOutputQueue(*(_DWORD *)(i + 16), 3 * a2, *(_QWORD *)(i + 24));
  return IOLockUnlock(*((_QWORD *)this + 37));
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);

//----- (0000000000063158) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::bpfOutputPacket(IO80211VirtualInterface *this, __mbuf *a2, void *a3)
{
  __int64 v3; // rax@1

  LODWORD(v3) = mbuf_pkthdr_rcvif(a2, a2, a3);
  return (*(int (__fastcall **)(_QWORD, IO80211VirtualInterface *, _QWORD, __mbuf *))(**((_QWORD **)this + 23) + 3176LL))(
           *((_QWORD *)this + 23),
           this,
           *(_DWORD *)(v3 + 16),
           a2);
}
// C8C70: using guessed type int __fastcall mbuf_pkthdr_rcvif(_QWORD, _QWORD, _QWORD);

//----- (000000000006318E) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::bpfOutput(IO80211VirtualInterface *this, signed __int64 a2, __mbuf *a3)
{
  __mbuf *v3; // r14@1
  signed int v4; // er15@2
  __int64 v5; // rax@6
  OSMetaClass *v6; // rax@7
  __int64 v7; // rax@7
  __int64 v8; // r8@7
  __int64 v9; // r9@7
  __int64 v10; // rax@8
  __int64 v11; // rdx@8
  __int64 v12; // rbx@8

  v3 = a3;
  if ( (_DWORD)a2 == 1 )
  {
    v4 = 22;
    if ( *((_BYTE *)this + 308) )
    {
      if ( (*((_DWORD *)this + 78) & 0xFFFFFFFE) == 2 )
      {
        a2 = 1LL;
        bpf_tap_out(*((_QWORD *)this + 24), 1LL, a3, 0LL, 0LL);
      }
      if ( *((_QWORD *)this + 18) )
      {
        LODWORD(v5) = mbuf_nextpkt(v3);
        if ( v5 )
        {
          LODWORD(v6) = (*(int (__fastcall **)(IO80211VirtualInterface *, signed __int64))(*(_QWORD *)this + 56LL))(
                          this,
                          a2);
          v7 = OSMetaClass::getClassName(v6);
          v4 = 0;
          IOLog("%s::%s output to peer manager m=%p already on a queue\n", v7, "bpfOutput", v3, v8, v9);
        }
        else
        {
          (*(void (__fastcall **)(_QWORD, __mbuf *))(**((_QWORD **)this + 18) + 464LL))(*((_QWORD *)this + 18), v3);
          v4 = 0;
        }
      }
      else if ( *((_BYTE *)this + 272) )
      {
        IO80211InterfaceQueueWMEPacket(this, v3);
        v4 = 0;
      }
      else
      {
        v4 = 0;
        (*(void (__fastcall **)(_QWORD, __mbuf *, _QWORD))(**((_QWORD **)this + 30) + 360LL))(
          *((_QWORD *)this + 30),
          v3,
          0LL);
      }
    }
  }
  else
  {
    IOLockLock(*((_QWORD *)this + 37));
    v10 = IO80211BPFNodeForDLT(a2, *((_QWORD *)this + 36));
    v12 = v10;
    if ( v10 )
    {
      mbuf_pkthdr_setrcvif(v3, v10, v11);
      v4 = 0;
      (*(void (__fastcall **)(_QWORD, __mbuf *, _QWORD))(**(_QWORD **)(v12 + 24) + 360LL))(
        *(_QWORD *)(v12 + 24),
        v3,
        0LL);
      IOLockUnlock(*((_QWORD *)this + 37));
    }
    else
    {
      IOLockUnlock(*((_QWORD *)this + 37));
      v4 = 22;
    }
  }
  return (unsigned int)v4;
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C89E0: using guessed type int __fastcall bpf_tap_out(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8C60: using guessed type int __fastcall mbuf_nextpkt(_QWORD);
// C8C88: using guessed type int __fastcall mbuf_pkthdr_setrcvif(_QWORD, _QWORD, _QWORD);

//----- (0000000000063300) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::bpfAttachEN10MB(IO80211VirtualInterface *this, int a2)
{
  int result; // eax@1

  result = 22;
  if ( a2 == 14 )
  {
    result = 37;
    if ( !*((_BYTE *)this + 308) )
    {
      result = bpf_attach(*((_QWORD *)this + 24), 1LL, 14LL, _bpfOutput, IO80211BpfTap);
      if ( !result )
      {
        *((_BYTE *)this + 308) = 1;
        result = 0;
      }
    }
  }
  return result;
}
// C89D0: using guessed type int __fastcall bpf_attach(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000063359) ----------------------------------------------------
__int64 __fastcall _bpfOutput(__ifnet *a1, unsigned int a2, __mbuf *a3)
{
  __mbuf *v3; // r14@1
  IO80211VirtualInterface *v4; // rax@1
  unsigned int v5; // ebx@1

  v3 = a3;
  LODWORD(v4) = ifnet_softc(a1);
  v5 = IO80211VirtualInterface::bpfOutput(v4, a2, v3);
  if ( v5 )
    mbuf_freem(v3);
  return v5;
}
// C8B90: using guessed type int __fastcall ifnet_softc(_QWORD);
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);

//----- (000000000006338C) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::bpfAttach(IO80211VirtualInterface *this, int a2, int a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7, __int64 a8, __int64 a9)
{
  int v9; // er15@1
  int v10; // er14@2
  __int64 v11; // r12@5
  __int64 v12; // r8@7
  __int64 v13; // rax@8
  __int64 v14; // rax@9
  __int64 v15; // rcx@10
  __int64 v16; // rdx@10
  __int64 v18; // [sp+20h] [bp-50h]@5
  __int64 v19; // [sp+28h] [bp-48h]@5
  __int64 v20; // [sp+30h] [bp-40h]@5

  v9 = a3;
  if ( a2 == 1 )
  {
    v10 = IO80211VirtualInterface::bpfAttachEN10MB(this, a3);
  }
  else
  {
    v10 = 22;
    if ( a4 && a5 )
    {
      v18 = a4;
      v19 = a5;
      v20 = a6;
      IOLockLock(*((_QWORD *)this + 37));
      v11 = IO80211BPFNodeForDLT(a2, *((_QWORD *)this + 36));
      if ( v11 )
      {
        v10 = 37;
      }
      else
      {
        v10 = bpf_attach(*((_QWORD *)this + 24), (unsigned int)a2, (unsigned int)v9, _bpfOutput, IO80211BpfTap);
        v11 = 0LL;
        if ( !v10 )
        {
          v12 = a9;
          if ( !a9 )
          {
            LODWORD(v13) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 23) + 1672LL))(
                             *((_QWORD *)this + 23),
                             (unsigned int)a2);
            v12 = v13;
          }
          v14 = IO80211AllocBPFNode(v19, v20, a2, v18, v12, a7, a8);
          v10 = 12;
          v11 = 0LL;
          if ( v14 )
          {
            v15 = *((_QWORD *)this + 36);
            v16 = *(_QWORD *)v15;
            *(_QWORD *)v14 = *(_QWORD *)v15;
            if ( v16 )
              *(_QWORD *)(v16 + 8) = v14;
            *(_QWORD *)v15 = v14;
            *(_QWORD *)(v14 + 8) = v15;
            v10 = 0;
            v11 = v14;
          }
        }
      }
      IOLockUnlock(*((_QWORD *)this + 37));
      if ( v10 && v11 )
        IO80211BPFNodeFree(v11);
    }
  }
  return (unsigned int)v10;
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C89D0: using guessed type int __fastcall bpf_attach(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000634FE) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::bpfTapInput(IO80211VirtualInterface *this, __mbuf *a2, unsigned int a3, void *a4, __int64 a5)
{
  __int64 v5; // r14@1
  void *v6; // r15@1
  unsigned int v7; // er13@1
  IO80211VirtualInterface *v8; // rbx@1
  __int64 v9; // rdi@1
  int result; // eax@3

  v5 = a5;
  v6 = a4;
  v7 = a3;
  v8 = this;
  v9 = *((_QWORD *)this + 18);
  if ( !v9
    || a3 != 12
    || (result = (*(int (__fastcall **)(__int64, __mbuf *, signed __int64))(*(_QWORD *)v9 + 392LL))(v9, a2, 12LL),
        (_BYTE)result) )
    result = bpf_tap_in(*((_QWORD *)v8 + 24), v7, a2, v6, v5);
  return result;
}
// C89D8: using guessed type int __fastcall bpf_tap_in(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000006357E) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::ifnet_start_callback(IO80211VirtualInterface *this, __ifnet *a2)
{
  __int64 v2; // rax@1

  LODWORD(v2) = ifnet_softc(this);
  return (*(int (__fastcall **)(__int64, __ifnet *))(*(_QWORD *)v2 + 2248LL))(v2, a2);
}
// C8B90: using guessed type int __fastcall ifnet_softc(_QWORD);

//----- (0000000000063594) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::ifnet_detach_callback(IO80211VirtualInterface *this, __ifnet *a2)
{
  __int64 v2; // rax@1
  __int64 v3; // rbx@1
  __int64 v4; // r14@1

  LODWORD(v2) = ifnet_softc(this);
  v3 = v2;
  v4 = *(_QWORD *)(v2 + 216);
  IOLockLock(*(_QWORD *)(v2 + 216));
  *(_BYTE *)(v3 + 224) = 0;
  thread_wakeup_prim(*(_QWORD *)(v3 + 192), 1LL, 0LL);
  return IOLockUnlock(v4);
}
// C7708: using guessed type int __fastcall IOLockLock(_QWORD);
// C7720: using guessed type int __fastcall IOLockUnlock(_QWORD);
// C8B90: using guessed type int __fastcall ifnet_softc(_QWORD);
// C8DD8: using guessed type int __fastcall thread_wakeup_prim(_QWORD, _QWORD, _QWORD);

//----- (00000000000635D8) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::ifnet_ioctl_callback(IO80211VirtualInterface *this, __ifnet *a2, __int64 a3, void *a4)
{
  __int64 v4; // r14@1
  __int64 v5; // rax@1

  v4 = a3;
  LODWORD(v5) = ifnet_softc(this);
  return (*(int (__fastcall **)(__int64, __ifnet *, __int64))(*(_QWORD *)v5 + 2176LL))(v5, a2, v4);
}
// C8B90: using guessed type int __fastcall ifnet_softc(_QWORD);

//----- (0000000000063604) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::getDetachLock(IO80211VirtualInterface *this)
{
  return *((_QWORD *)this + 27);
}

//----- (0000000000063612) ----------------------------------------------------
void __fastcall IO80211VirtualInterface::setWaitingForDetach(IO80211VirtualInterface *this, char a2)
{
  *((_BYTE *)this + 224) = a2;
}

//----- (0000000000063620) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::dequeueTxPackets(__int64 a1, void *a2)
{
  __int64 v2; // rdi@1
  int result; // eax@2

  v2 = *(_QWORD *)(a1 + 144);
  if ( v2 )
  {
    result = (*(int (**)(void))(*(_QWORD *)v2 + 496LL))();
  }
  else
  {
    memset(a2, 0, 0x60uLL);
    result = 0;
  }
  return result;
}

//----- (0000000000063656) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::ioctl_internal_gated(IO80211VirtualInterface *this, void *a2, void *a3, void *a4, void *a5, void *a6)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 23) + 3224LL))(
           *((_QWORD *)this + 23),
           *(_DWORD *)a2,
           *((_DWORD *)a2 + 1),
           this,
           *((_QWORD *)a2 + 1));
}

//----- (0000000000063680) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::ioctl_internal(IO80211VirtualInterface *this, void *a2)
{
  return (*(int (__fastcall **)(_QWORD, IO80211VirtualInterface *, int (__fastcall *)(IO80211VirtualInterface *, void *, void *, void *, void *, void *), IO80211VirtualInterface *, void *, _QWORD))(**((_QWORD **)this + 23) + 2128LL))(
           *((_QWORD *)this + 23),
           this,
           IO80211VirtualInterface::ioctl_internal_gated,
           this,
           a2,
           0LL);
}

//----- (00000000000636C6) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::handleIoctl(IO80211VirtualInterface *this, __int64 a2, void *a3)
{
  void *v3; // r14@1
  signed __int64 v4; // rbx@1
  int result; // eax@1
  signed __int64 v6; // rcx@14
  __int64 v7; // rcx@15
  char v8; // cl@25

  v3 = a3;
  v4 = a2;
  result = 102;
  if ( a2 > 3224135991LL )
  {
    v6 = 3224135992LL;
    goto LABEL_17;
  }
  if ( a2 > 3223873992LL )
  {
    v7 = 3223873993LL;
    goto LABEL_24;
  }
  if ( a2 > 3223873847LL )
  {
    v6 = 3223873848LL;
    goto LABEL_17;
  }
  if ( a2 > 3223611848LL )
  {
    v7 = 3223611849LL;
    goto LABEL_24;
  }
  if ( a2 <= 3223349554LL )
  {
    if ( a2 > 2150132167LL )
    {
      v7 = 2150132168LL;
    }
    else
    {
      if ( a2 <= 2149870023LL )
      {
        if ( a2 <= 2149607739LL )
        {
          if ( a2 != 2149607692LL && a2 != 2149607696LL )
          {
            if ( a2 == 2149607732LL )
            {
              result = -536870206;
              if ( (unsigned int)(*((_DWORD *)a3 + 4) - 46) <= 0x5AE )
                result = ifnet_set_mtu(*((_QWORD *)this + 24), 1500LL);
            }
            return result;
          }
          return (*(int (__fastcall **)(_QWORD, IO80211VirtualInterface *, int (__fastcall *)(IO80211VirtualInterface *, void *, ifmediareq *, void *, void *, void *), IO80211VirtualInterface *, signed __int64, void *))(**((_QWORD **)this + 23) + 2128LL))(
                   *((_QWORD *)this + 23),
                   this,
                   IO80211VirtualInterface::handleIoctlGated,
                   this,
                   v4,
                   v3);
        }
        v6 = 2149607740LL;
LABEL_17:
        if ( a2 != v6 )
          return result;
        return (*(int (__fastcall **)(_QWORD, IO80211VirtualInterface *, int (__fastcall *)(IO80211VirtualInterface *, void *, ifmediareq *, void *, void *, void *), IO80211VirtualInterface *, signed __int64, void *))(**((_QWORD **)this + 23) + 2128LL))(
                 *((_QWORD *)this + 23),
                 this,
                 IO80211VirtualInterface::handleIoctlGated,
                 this,
                 v4,
                 v3);
      }
      v7 = 2149870024LL;
    }
LABEL_24:
    if ( a2 != v7 )
      return result;
    v8 = IO80211InterfaceValidateApple80211Command(a2, a2, (__int64)a3, v7);
    result = 22;
    if ( !v8 )
      return result;
    if ( a2 != 2149870024LL && a2 != 2150132168LL )
      v4 = 3223873993LL;
    else
      v4 = 2150132168LL;
    return (*(int (__fastcall **)(_QWORD, IO80211VirtualInterface *, int (__fastcall *)(IO80211VirtualInterface *, void *, ifmediareq *, void *, void *, void *), IO80211VirtualInterface *, signed __int64, void *))(**((_QWORD **)this + 23) + 2128LL))(
             *((_QWORD *)this + 23),
             this,
             IO80211VirtualInterface::handleIoctlGated,
             this,
             v4,
             v3);
  }
  if ( a2 == 3223349555LL )
  {
    *((_DWORD *)a3 + 4) = 1500;
    result = 0;
  }
  return result;
}
// C8B88: using guessed type int __fastcall ifnet_set_mtu(_QWORD, _QWORD);

//----- (0000000000063886) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::handleIoctlGated(IO80211VirtualInterface *this, void *a2, ifmediareq *a3, void *a4, void *a5, void *a6)
{
  ifmediareq *v6; // r14@1
  __int64 v7; // r13@1
  int result; // eax@1
  __int64 v9; // r12@3
  signed __int64 v10; // rcx@9
  __int64 v11; // rcx@10
  char v12; // cl@16
  __int64 v13; // rcx@22
  __int64 v14; // rcx@25
  char v15; // [sp+7h] [bp-59h]@16
  char v16[8]; // [sp+8h] [bp-58h]@16
  __int64 v17; // [sp+10h] [bp-50h]@16
  __int64 v18; // [sp+18h] [bp-48h]@16
  __int64 v19; // [sp+20h] [bp-40h]@16
  __int64 v20; // [sp+28h] [bp-38h]@16
  __int64 v21; // [sp+30h] [bp-30h]@1

  v6 = a3;
  v7 = off_7B078[0];
  v21 = *(_QWORD *)off_7B078[0];
  result = 6;
  if ( *((_BYTE *)this + 319) )
    goto LABEL_25;
  result = 102;
  if ( (signed __int64)a2 > 3224135991LL )
  {
    v10 = 3224135992LL;
    goto LABEL_12;
  }
  v9 = *((_QWORD *)this + 23);
  if ( (signed __int64)a2 > 3223873992LL )
  {
    v11 = 3223873993LL;
    goto LABEL_15;
  }
  if ( (signed __int64)a2 > 3223873847LL )
  {
    v10 = 3223873848LL;
LABEL_12:
    if ( a2 == (void *)v10 )
      result = IO80211VirtualInterface::handleSIOCGIFMEDIA(this, a3, 102LL, (__int64)a2);
    goto LABEL_25;
  }
  if ( (signed __int64)a2 <= 2150132167LL )
  {
    if ( a2 == (void *)2149607692 )
    {
      result = IO80211VirtualInterface::handleSIOCSIFADDR(this);
      goto LABEL_25;
    }
    if ( a2 == (void *)2149607696 )
    {
      IO80211VirtualInterface::handleSIOCSIFFLAGS(this);
LABEL_19:
      result = 0;
      goto LABEL_25;
    }
    if ( a2 == (void *)2149607740 )
    {
      result = 22;
      v13 = LOBYTE(a3->ifm_current);
      if ( (_DWORD)v13 == 6 )
      {
        result = 50;
        if ( *((_BYTE *)this + 317) )
          result = (*(int (__fastcall **)(_QWORD, IO80211VirtualInterface *, char *, __int64, void *, void *))(*(_QWORD *)v9 + 3288LL))(
                     *((_QWORD *)this + 23),
                     this,
                     (char *)&a3->ifm_current + 2,
                     v13,
                     a5,
                     a6);
      }
    }
    goto LABEL_25;
  }
  v11 = 2150132168LL;
LABEL_15:
  if ( a2 == (void *)v11 )
  {
    v20 = 0LL;
    v19 = 0LL;
    v18 = 0LL;
    v17 = 0LL;
    *(_QWORD *)v16 = 0LL;
    v12 = IO80211InterfaceUserlandToKernelApple80211Commmand(v16, a3->ifm_name, (__int64)&v15, v11);
    result = 22;
    if ( v12 )
    {
      result = (*(int (__fastcall **)(__int64, _QWORD, IO80211VirtualInterface *, _QWORD, void *, char *))(*(_QWORD *)v9 + 3200LL))(
                 v9,
                 0LL,
                 this,
                 *((_QWORD *)this + 24),
                 a2,
                 v16);
      if ( !result )
      {
        v6->ifm_status = v19;
        v6->ifm_mask = HIDWORD(v18);
        goto LABEL_19;
      }
    }
  }
LABEL_25:
  v14 = *(_QWORD *)v7;
  return result;
}
// 7B078: using guessed type __int64 off_7B078[7];

//----- (0000000000063A44) ----------------------------------------------------
__int64 __usercall IO80211VirtualInterface::handleSIOCGIFMEDIA@<rax>(IO80211VirtualInterface *this@<rdi>, ifmediareq *a2@<rdx>, __int64 a3@<rax>, __int64 a4@<rsi>)
{
  ifmediareq *v4; // rbx@1
  __int64 v5; // rdx@3
  __int64 result; // rax@6
  int v7; // eax@7
  __int64 v8; // [sp-4h] [bp-20h]@1

  v8 = a3;
  v4 = a2;
  HIDWORD(v8) = (*(int (__cdecl **)(IO80211VirtualInterface *))(*(_QWORD *)this + 2136LL))(this);
  if ( !v4->ifm_count
    || (a4 != 3224135992LL ? (v5 = LODWORD(v4->ifm_ulist)) : (v5 = (__int64)v4->ifm_ulist),
        !v5
     || (result = IO80211Controller::copyOut(*((IO80211Controller **)this + 23), (char *)&v8 + 4, v5, 4LL),
         !(_DWORD)result)) )
  {
    v7 = (*(int (__fastcall **)(IO80211VirtualInterface *))(*(_QWORD *)this + 2136LL))(this);
    v4->ifm_active = v7;
    v4->ifm_current = v7;
    v4->ifm_status = 2 * (*((_DWORD *)this + 57) == 2) + 1;
    v4->ifm_mask = 0;
    v4->ifm_count = 1;
    result = 0LL;
  }
  return result;
}

//----- (0000000000063ADC) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::handleSIOCSIFADDR(IO80211VirtualInterface *this)
{
  IO80211VirtualInterface *v1; // rbx@1
  int v2; // er14@1
  IO80211PeerManager *v3; // rdi@4

  v1 = this;
  ifnet_set_flags(*((_QWORD *)this + 24), 1LL, 1LL);
  v2 = 0;
  if ( !(ifnet_flags(*((_QWORD *)this + 24)) & 0x40) )
  {
    v2 = (*(int (__fastcall **)(_QWORD, IO80211VirtualInterface *))(**((_QWORD **)this + 23) + 3296LL))(
           *((_QWORD *)this + 23),
           this);
    if ( !v2 )
    {
      ifnet_set_flags(*((_QWORD *)this + 24), 64LL, 64LL);
      v2 = 0;
    }
  }
  v3 = (IO80211PeerManager *)*((_QWORD *)this + 18);
  if ( v3 && *((_DWORD *)v1 + 57) == 2 )
    IO80211PeerManager::enable(v3, "handleSIOCSIFADDR");
  return (unsigned int)v2;
}
// C8AF8: using guessed type int __fastcall ifnet_flags(_QWORD);
// C8B70: using guessed type int __fastcall ifnet_set_flags(_QWORD, _QWORD, _QWORD);

//----- (0000000000063B6C) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::getMediumType(IO80211VirtualInterface *this)
{
  return 128LL;
}

//----- (0000000000063B78) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::getWorkLoop(IO80211VirtualInterface *this)
{
  __int64 v1; // rdi@1
  int result; // eax@2

  v1 = *((_QWORD *)this + 23);
  if ( v1 )
    result = (*(int (**)(void))(*(_QWORD *)v1 + 1672LL))();
  else
    result = 0;
  return result;
}

//----- (0000000000063B96) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::setScanningState(__int64 a1, __int64 a2, unsigned __int8 a3)
{
  __int64 v3; // rdi@1
  int result; // eax@2

  v3 = *(_QWORD *)(a1 + 144);
  if ( v3 )
    result = (*(int (__fastcall **)(__int64, __int64, _QWORD))(*(_QWORD *)v3 + 336LL))(v3, a2, a3);
  return result;
}

//----- (0000000000063BB8) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::setJoiningState(IO80211VirtualInterface *this, __int64 a2, unsigned __int8 a3)
{
  __int64 v3; // rdi@1
  int result; // eax@2

  v3 = *((_QWORD *)this + 18);
  if ( v3 )
    result = (*(int (__fastcall **)(__int64, __int64, _QWORD))(*(_QWORD *)v3 + 344LL))(v3, a2, a3);
  return result;
}

//----- (0000000000063BDA) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::setInfraTxState(IO80211VirtualInterface *this, unsigned __int8 a2)
{
  __int64 v2; // rdi@1
  int result; // eax@2

  v2 = *((_QWORD *)this + 18);
  if ( v2 )
    result = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v2 + 352LL))(v2, a2);
  return result;
}

//----- (0000000000063BFE) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::infraBSSIDChange(IO80211VirtualInterface *this)
{
  __int64 v1; // rdi@1
  int result; // eax@2

  v1 = *((_QWORD *)this + 18);
  if ( v1 )
    result = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v1 + 320LL))(v1, 5LL);
  return result;
}

//----- (0000000000063C22) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::setInfraChannel(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  int result; // eax@2

  v2 = *(_QWORD *)(a1 + 144);
  if ( v2 )
    result = IO80211PeerManager::setInfraChannel(v2, a2);
  return result;
}

//----- (0000000000063C3A) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::postAwdlStatistics(__int64 a1, const void *a2)
{
  __int64 result; // rax@2
  char v3; // [sp+8h] [bp-E8h]@2

  if ( *(_DWORD *)(a1 + 176) == 4 )
  {
    memcpy(&v3, a2, 0xE0uLL);
    result = IO80211InterfacePostMessage((char *)(a1 + 200), 0x41uLL, 0LL, 0LL);
  }
  return result;
}

//----- (0000000000063C86) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::postSyncStateChanged(IO80211VirtualInterface *this)
{
  __int64 result; // rax@2

  if ( *((_DWORD *)this + 44) == 4 )
    result = IO80211InterfacePostMessage((char *)this + 200, 0x2EuLL, 0LL, 0LL);
  return result;
}

//----- (0000000000063CAC) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::postNewMasterElected(IO80211VirtualInterface *this, __ifnet *a2)
{
  return IO80211QueueCall::ifnet_notice_master_elected(*((IO80211QueueCall **)this + 24), a2);
}

//----- (0000000000063CBE) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::postServiceIndication(IO80211VirtualInterface *this)
{
  return IO80211VirtualInterface::postMessage(this, 0x34uLL, 0LL, 0LL);
}

//----- (0000000000063CD2) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::postMessage(IO80211VirtualInterface *this, unsigned __int64 a2, void *a3, unsigned __int64 a4)
{
  int result; // eax@2
  unsigned __int64 v5; // [sp+10h] [bp-10h]@2
  int v6; // [sp+1Ch] [bp-4h]@2

  if ( *((_QWORD *)this + 18) )
  {
    v6 = a2;
    v5 = a4;
    result = (*(int (__fastcall **)(_QWORD, IO80211VirtualInterface *, __int64 (__fastcall *)(IO80211VirtualInterface *, void *, void *, void *, void *, void *), IO80211VirtualInterface *, int *, void *))(**((_QWORD **)this + 23) + 2128LL))(
               *((_QWORD *)this + 23),
               this,
               IO80211VirtualInterface::reportDataPathEventsGated,
               this,
               &v6,
               a3);
  }
  else
  {
    result = IO80211InterfacePostMessage((char *)this + 200, a2, a3, a4);
  }
  return result;
}

//----- (0000000000063D3E) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::postPeerPresence(IO80211VirtualInterface *this, ether_addr *a2, int a3, int a4, int a5, char *a6)
{
  char *v6; // ST38_8@1
  int v7; // ST34_4@1
  int v8; // er15@1
  IO80211PeerManager *v9; // r13@1
  OSMetaClass *v10; // rax@1
  __int64 v11; // rax@1
  int v12; // ST20_4@1
  int v13; // ST18_4@1
  int v14; // ST10_4@1
  int v15; // ST08_4@1
  int v16; // ST00_4@1
  unsigned int v17; // er14@1
  OSMetaClass *v18; // rax@2
  __int64 v19; // rax@2
  __int64 v20; // r8@2
  __int64 v21; // r9@2
  int v23; // [sp+30h] [bp-A0h]@1
  int v24; // [sp+40h] [bp-90h]@4
  __int16 v25; // [sp+44h] [bp-8Ch]@4
  __int16 v26; // [sp+46h] [bp-8Ah]@4
  int v27; // [sp+48h] [bp-88h]@4
  int v28; // [sp+4Ch] [bp-84h]@4
  int v29; // [sp+50h] [bp-80h]@4
  __int64 v30; // [sp+54h] [bp-7Ch]@4
  __int64 v31; // [sp+5Ch] [bp-74h]@4
  __int64 v32; // [sp+64h] [bp-6Ch]@4
  __int64 v33; // [sp+6Ch] [bp-64h]@4
  __int64 v34; // [sp+74h] [bp-5Ch]@4
  __int64 v35; // [sp+7Ch] [bp-54h]@4
  char v36; // [sp+88h] [bp-48h]@1
  char v37; // [sp+89h] [bp-47h]@1
  __int16 v38; // [sp+8Ah] [bp-46h]@1
  char v39; // [sp+8Ch] [bp-44h]@1
  char v40; // [sp+8Dh] [bp-43h]@1
  char v41; // [sp+8Eh] [bp-42h]@1
  char v42; // [sp+95h] [bp-3Bh]@1
  __int64 v43; // [sp+A0h] [bp-30h]@1

  v6 = a6;
  v7 = a5;
  v23 = a4;
  v8 = a3;
  v43 = *(_QWORD *)off_7B078[0];
  memset(&v36, 0, 0x14uLL);
  v36 = 20;
  v37 = 18;
  v39 = ifnet_type(*((_QWORD *)this + 24), 0LL);
  v38 = ifnet_index(*((_QWORD *)this + 24));
  v41 = 6;
  v40 = 5;
  memcpy(&v42, a2, 6uLL);
  v9 = (IO80211PeerManager *)*((_QWORD *)this + 18);
  LODWORD(v10) = (*(int (__fastcall **)(IO80211VirtualInterface *, ether_addr *))(*(_QWORD *)this + 56LL))(this, a2);
  v11 = OSMetaClass::getClassName(v10);
  v12 = a2->octet[5];
  v13 = a2->octet[4];
  v14 = a2->octet[3];
  v15 = a2->octet[2];
  v16 = a2->octet[1];
  IO80211PeerManager::logDebug(
    v9,
    0x10000000LL,
    "%s::%s %02X:%02X:%02X:%02X:%02X:%02X rssi%d\n",
    v11,
    (__int64)"postPeerPresence",
    a2->octet[0]);
  v17 = IO80211QueueCall::ifnet_notice_node_presence(
          *((IO80211QueueCall **)this + 24),
          (__ifnet *)&v36,
          (sockaddr *)(unsigned int)v8,
          v23,
          v7,
          v6);
  if ( v17 )
  {
    LODWORD(v18) = (*(int (__fastcall **)(IO80211VirtualInterface *, char *))(*(_QWORD *)this + 56LL))(this, &v36);
    v19 = OSMetaClass::getClassName(v18);
    IOLog("%s::%s(): ifnet_notice_node_presence failed: %d\n", v19, "postPeerPresence", v17, v20, v21);
  }
  if ( *((_DWORD *)this + 44) == 4 )
  {
    v25 = *(_WORD *)&a2->octet[4];
    v24 = *(_DWORD *)&a2->octet[0];
    v26 = 0;
    v27 = 0;
    v28 = v8;
    v29 = v23;
    v35 = 0LL;
    v34 = 0LL;
    v33 = 0LL;
    v32 = 0LL;
    v31 = 0LL;
    v30 = 0LL;
    IO80211InterfacePostMessage((char *)this + 200, 0x2FuLL, &v24, 0x44uLL);
  }
  return *(_QWORD *)off_7B078[0];
}
// 7B078: using guessed type __int64 off_7B078[7];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8B08: using guessed type int __fastcall ifnet_index(_QWORD);
// C8BA8: using guessed type int __fastcall ifnet_type(_QWORD, _QWORD);

//----- (0000000000063F60) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::postPeerAbsence(IO80211VirtualInterface *this, ether_addr *a2)
{
  __int64 v2; // r12@1
  sockaddr *v3; // rdx@1
  unsigned int v4; // er15@1
  OSMetaClass *v5; // rax@2
  __int64 v6; // rax@2
  __int64 v7; // r8@2
  __int64 v8; // r9@2
  __int64 v10; // [sp+8h] [bp-88h]@4
  __int64 v11; // [sp+10h] [bp-80h]@4
  __int64 v12; // [sp+18h] [bp-78h]@4
  __int64 v13; // [sp+20h] [bp-70h]@4
  __int64 v14; // [sp+28h] [bp-68h]@4
  __int64 v15; // [sp+30h] [bp-60h]@4
  __int64 v16; // [sp+38h] [bp-58h]@4
  __int64 v17; // [sp+40h] [bp-50h]@4
  int v18; // [sp+48h] [bp-48h]@4
  char v19; // [sp+50h] [bp-40h]@1
  char v20; // [sp+51h] [bp-3Fh]@1
  __int16 v21; // [sp+52h] [bp-3Eh]@1
  char v22; // [sp+54h] [bp-3Ch]@1
  char v23; // [sp+55h] [bp-3Bh]@1
  char v24; // [sp+56h] [bp-3Ah]@1
  char v25; // [sp+5Dh] [bp-33h]@1
  __int64 v26; // [sp+68h] [bp-28h]@1

  v2 = off_7B078[0];
  v26 = *(_QWORD *)off_7B078[0];
  memset(&v19, 0, 0x14uLL);
  v19 = 20;
  v20 = 18;
  v22 = ifnet_type(*((_QWORD *)this + 24), 0LL);
  v21 = ifnet_index(*((_QWORD *)this + 24));
  v24 = 6;
  v23 = 5;
  memcpy(&v25, a2, 6uLL);
  v4 = IO80211QueueCall::ifnet_notice_node_absence(*((IO80211QueueCall **)this + 24), (__ifnet *)&v19, v3);
  if ( v4 )
  {
    LODWORD(v5) = (*(int (__fastcall **)(IO80211VirtualInterface *, char *))(*(_QWORD *)this + 56LL))(this, &v19);
    v6 = OSMetaClass::getClassName(v5);
    IOLog("%s::%s(): ifnet_notice_node_absence failed: %d\n", v6, "postPeerAbsence", v4, v7, v8);
  }
  if ( *((_DWORD *)this + 44) == 4 )
  {
    v18 = 0;
    v17 = 0LL;
    v16 = 0LL;
    v15 = 0LL;
    v14 = 0LL;
    v13 = 0LL;
    v12 = 0LL;
    v11 = 0LL;
    v10 = 0LL;
    HIDWORD(v10) = *(_WORD *)&a2->octet[4];
    LODWORD(v10) = *(_DWORD *)&a2->octet[0];
    WORD3(v10) = 0;
    LODWORD(v11) = 1;
    IO80211InterfacePostMessage((char *)this + 200, 0x2FuLL, &v10, 0x44uLL);
  }
  return *(_QWORD *)v2;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8B08: using guessed type int __fastcall ifnet_index(_QWORD);
// C8BA8: using guessed type int __fastcall ifnet_type(_QWORD, _QWORD);

//----- (00000000000640D6) ----------------------------------------------------
char __usercall IO80211VirtualInterface::signalOutputThread@<al>(IO80211VirtualInterface *this@<rdi>, __int64 a2@<rax>)
{
  IO80211VirtualInterface *v2; // rbx@1
  char result; // al@1
  char *v4; // rsi@2
  IO80211PeerManager *v5; // rdi@3
  IO80211PeerManager *v6; // rdi@7
  __int64 v7; // [sp-4h] [bp-10h]@1

  v7 = a2;
  v2 = this;
  result = (*(int (__cdecl **)(IO80211VirtualInterface *))(*(_QWORD *)this + 2224LL))(this);
  if ( result )
  {
    (*(void (__cdecl **)(IO80211VirtualInterface *))(*(_QWORD *)this + 2248LL))(this);
    HIDWORD(v7) = 0;
    v4 = (char *)&v7 + 4;
    result = ifnet_get_sndq_len(*((_QWORD *)this + 24), (char *)&v7 + 4);
    if ( !HIDWORD(v7) )
    {
      v5 = (IO80211PeerManager *)*((_QWORD *)this + 18);
      if ( v5 )
      {
        v4 = (_BYTE *)(&stru_68 + 24);
        if ( IO80211PeerManager::shouldLog(v5, 128LL) )
        {
          v4 = (_BYTE *)(&stru_68 + 24);
          IO80211PeerManager::printFlowControl(
            *((IO80211PeerManager **)v2 + 18),
            (int *)&stru_68.segname[8],
            "signalOutputThread done");
        }
      }
      result = (*(int (__fastcall **)(IO80211VirtualInterface *, char *))(*(_QWORD *)v2 + 2240LL))(v2, v4);
    }
  }
  else
  {
    v6 = (IO80211PeerManager *)*((_QWORD *)this + 18);
    if ( v6 )
    {
      result = IO80211PeerManager::shouldLog(v6, 128LL);
      if ( result )
        result = IO80211PeerManager::printFlowControl(
                   *((IO80211PeerManager **)v2 + 18),
                   (int *)&stru_68.segname[8],
                   "signalOutputThread  nothing");
    }
  }
  return result;
}
// 68: using guessed type section_64 stru_68;
// C8B00: using guessed type int __fastcall ifnet_get_sndq_len(_QWORD, _QWORD);

//----- (000000000006418E) ----------------------------------------------------
bool __fastcall IO80211VirtualInterface::isOutputFlowControlled(IO80211VirtualInterface *this)
{
  __int64 v1; // rax@1
  char *v2; // rdi@1
  bool v3; // zf@1
  signed __int64 v4; // rax@1

  v1 = *((_QWORD *)this + 18);
  v2 = (char *)this + 320;
  v3 = v1 == 0;
  v4 = v1 + 216;
  if ( v3 )
    v4 = (signed __int64)v2;
  return *(_BYTE *)v4 != 0;
}

//----- (00000000000641B6) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::setOutputFlowControlled(IO80211VirtualInterface *this)
{
  __int64 result; // rax@1

  *((_BYTE *)this + 320) = 1;
  result = *((_QWORD *)this + 18);
  if ( result )
    *(_BYTE *)(result + 216) = 1;
  return result;
}

//----- (00000000000641D6) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::clearOutputFlowControlled(IO80211VirtualInterface *this)
{
  __int64 result; // rax@1

  *((_BYTE *)this + 320) = 0;
  result = *((_QWORD *)this + 18);
  if ( result )
    *(_BYTE *)(result + 216) = 0;
  return result;
}

//----- (00000000000641F6) ----------------------------------------------------
char __fastcall IO80211VirtualInterface::outputStart(IO80211VirtualInterface *this)
{
  IO80211VirtualInterface *v1; // rcx@1
  IO80211PeerManager *v2; // rdi@1
  IO80211VirtualInterface *v3; // rbx@2
  signed __int64 v4; // rax@2
  IO80211VirtualInterface *v5; // r14@3
  __int64 v6; // rdx@3
  __int64 v7; // r8@3
  __int64 v8; // r9@3
  __int64 v9; // r13@6
  signed int v10; // er15@7
  IO80211VirtualInterface *v11; // rcx@8
  unsigned int v12; // esi@9
  __int64 v13; // rdi@15
  signed int v14; // ebx@15
  IO80211VirtualInterface *v15; // rbx@16
  signed int v16; // eax@16
  int v17; // er12@17
  IO80211PeerManager *v33; // rdi@35
  IO80211VirtualInterface *v34; // rbx@36
  char v35; // al@36
  IO80211PeerManager *v37; // rdi@42
  IO80211VirtualInterface *v38; // rbx@43
  IO80211PeerManager *v39; // rdi@44
  const char *v40; // rdx@44
  IO80211PeerManager *v41; // rdi@45
  IO80211PeerManager *v42; // rdi@48
  IO80211PeerManager *v43; // rdi@52
  IO80211VirtualInterface *v44; // rcx@54
  IO80211PeerManager *v45; // rdi@54
  OSMetaClass *v46; // rax@56
  __int64 v47; // rsi@56
  __int64 v48; // r9@56
  char v49[8]; // r8@58
  signed __int64 v51; // [sp+10h] [bp-50h]@15
  int v54; // [sp+24h] [bp-3Ch]@0
  int v55; // [sp+34h] [bp-2Ch]@1

  v1 = this;
  v55 = 0;
  v2 = (IO80211PeerManager *)*((_QWORD *)this + 18);
  if ( v2 && (v3 = v1, LOBYTE(v4) = IO80211PeerManager::fcTryLock(v2), v1 = v3, !(_BYTE)v4) )
  {
    v41 = (IO80211PeerManager *)*((_QWORD *)v3 + 18);
    if ( v41 )
    {
      LOBYTE(v4) = IO80211PeerManager::shouldLog(v41, 128LL);
      if ( (_BYTE)v4 )
        LOBYTE(v4) = IO80211PeerManager::printFlowControl(
                       *((IO80211PeerManager **)v3 + 18),
                       (int *)&stru_68.segname[8],
                       " outputStart Fail");
    }
  }
  else
  {
    v5 = v1;
    LODWORD(v4) = ifnet_get_sndq_len(*((_QWORD *)v1 + 24), &v55);
    if ( (_DWORD)v4 )
      LOBYTE(v4) = IOLog("ifnet_get_sndq_len failed: %d\n", (unsigned int)v4, v6, (unsigned int)v4, v7, v8);
    if ( v55 )
    {
      v9 = (__int64)qword_7AFF0;
      v4 = 0LL;
      while ( 1 )
      {
        v10 = *(_DWORD *)(v9 + 4 * v4);
        if ( v10 <= 1048703 )
          break;
        if ( v10 == 1048704 )
        {
          v12 = 1;
          v11 = v5;
        }
        else
        {
          v12 = 3;
          v11 = v5;
          if ( v10 != 4194688 )
          {
            if ( v10 != 3670272 )
              goto LABEL_9;
            v12 = 2;
          }
        }
LABEL_15:
        v51 = v4;
        v13 = *((_QWORD *)v11 + 18);
        v14 = 64;
        if ( v13 && (v15 = v11, v16 = IO80211PeerManager::packetSpace(v13, v12), v11 = v15, (v14 = v16) == 0) )
        {
          v33 = (IO80211PeerManager *)*((_QWORD *)v11 + 18);
          if ( v33 )
          {
            v34 = v11;
            v35 = IO80211PeerManager::shouldLog(v33, 128LL);
            v11 = v34;
            if ( v35 )
            {
              IO80211PeerManager::printFlowControl(
                *((IO80211PeerManager **)v34 + 18),
                (int *)&stru_68.segname[8],
                " outputStart ON");
              v11 = v34;
            }
          }
          v5 = v11;
          (*(void (__fastcall **)(IO80211VirtualInterface *))(*(_QWORD *)v11 + 2232LL))(v11);
        }
        else
        {
          v5 = v11;
          v17 = ifnet_dequeue_service_class_multi(*((_QWORD *)v11 + 24), (unsigned int)v10, (unsigned int)v14);
          if ( v17 != 35 )
          {
            if ( v54 == v14 )
              (*(void (__fastcall **)(IO80211VirtualInterface *, _QWORD))(*(_QWORD *)v5 + 2232LL))(
                v5,
                (unsigned int)v10);
            if ( v17 )
            {
              v44 = v5;
              v45 = (IO80211PeerManager *)*((_QWORD *)v5 + 18);
              if ( v45 )
              {
                IO80211PeerManager::fcUnlock(v45);
                v44 = v5;
              }
              LODWORD(v46) = (*(int (__fastcall **)(IO80211VirtualInterface *, _QWORD))(*(_QWORD *)v44 + 56LL))(
                               v44,
                               (unsigned int)v10);
              v47 = OSMetaClass::getClassName(v46);
              if ( v10 > 1048703 )
              {
                if ( v10 == 1048704 )
                {
                  *(_QWORD *)v49 = "Background";
                  goto LABEL_66;
                }
                if ( v10 == 4194688 )
                {
                  *(_QWORD *)v49 = "Voice";
                  goto LABEL_66;
                }
                if ( v10 == 3670272 )
                {
                  *(_QWORD *)v49 = "Video";
                  goto LABEL_66;
                }
              }
              else if ( !v10 )
              {
                *(_QWORD *)v49 = "Best Effort";
LABEL_66:
                LOBYTE(v4) = IOLog(
                               "%s::%s() error(%d) processing service class: %s\n",
                               v47,
                               "outputStart",
                               (unsigned int)v17,
                               *(_QWORD *)v49,
                               v48);
                return v4;
              }
              *(_QWORD *)v49 = "Unknown";
              goto LABEL_66;
            }
          }
        }
        v4 = v51 + 1;
        if ( (unsigned int)(v51 + 1) >= 4 )
        {
          v37 = (IO80211PeerManager *)*((_QWORD *)v5 + 18);
          if ( !v37 )
            return v4;
          v38 = v5;
          LOBYTE(v4) = IO80211PeerManager::shouldLog(v37, 128LL);
          if ( (_BYTE)v4 )
          {
            v39 = (IO80211PeerManager *)*((_QWORD *)v5 + 18);
            v40 = " outputStart finished:";
            goto LABEL_51;
          }
          goto LABEL_52;
        }
      }
      v11 = v5;
LABEL_9:
      v12 = 0;
      goto LABEL_15;
    }
    v42 = (IO80211PeerManager *)*((_QWORD *)v5 + 18);
    if ( v42 )
    {
      v38 = v5;
      LOBYTE(v4) = IO80211PeerManager::shouldLog(v42, 128LL);
      if ( (_BYTE)v4 )
      {
        v39 = (IO80211PeerManager *)*((_QWORD *)v5 + 18);
        v40 = " outputStart nothing";
LABEL_51:
        LOBYTE(v4) = IO80211PeerManager::printFlowControl(v39, (int *)&stru_68.segname[8], v40);
      }
LABEL_52:
      v43 = (IO80211PeerManager *)*((_QWORD *)v38 + 18);
      if ( v43 )
        LOBYTE(v4) = IO80211PeerManager::fcUnlock(v43);
    }
  }
  return v4;
}
// 68: using guessed type section_64 stru_68;
// 7AFF0: using guessed type __int64 qword_7AFF0[2];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C89E0: using guessed type int __fastcall bpf_tap_out(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8AD0: using guessed type int __fastcall ifnet_dequeue_service_class_multi(_QWORD, _QWORD, _QWORD);
// C8B00: using guessed type int __fastcall ifnet_get_sndq_len(_QWORD, _QWORD);
// C8B98: using guessed type int __fastcall ifnet_stat_increment_out(_QWORD, _QWORD, _QWORD, _QWORD);
// C8C60: using guessed type int __fastcall mbuf_nextpkt(_QWORD);
// C8C68: using guessed type int __fastcall mbuf_pkthdr_len(_QWORD);
// C8CC0: using guessed type int __fastcall mbuf_setnextpkt(_QWORD, _QWORD);

//----- (0000000000064642) ----------------------------------------------------
__int64 __usercall IO80211VirtualInterface::dequeueOutputPacketsWithServiceClass@<rax>(signed int a1@<edx>, __int64 a2@<rcx>, __int64 a3@<rdi>, unsigned int a4@<esi>, __int64 a5)
{
  __int64 v5; // r14@1
  unsigned int v6; // eax@1
  signed int v7; // ebx@1
  signed __int64 v8; // rsi@2
  __int64 i; // rbx@31
  __int64 v10; // rax@32
  __int64 v11; // rdx@34
  unsigned int v13; // [sp+Ch] [bp-24h]@1

  v5 = a2;
  v6 = a4;
  v13 = 0;
  v7 = -536870206;
  if ( a1 > 99 )
  {
    if ( a1 > 199 )
    {
      if ( a1 > 299 )
      {
        if ( a1 > 399 )
        {
          if ( a1 > 499 )
          {
            if ( a1 > 599 )
            {
              if ( a1 > 699 )
              {
                if ( a1 == 700 )
                {
                  v8 = 3670272LL;
                }
                else if ( a1 == 800 )
                {
                  v8 = 4194688LL;
                }
                else
                {
                  if ( a1 != 900 )
                    return (unsigned int)v7;
                  v8 = 4718992LL;
                }
              }
              else
              {
                if ( a1 != 600 )
                  return (unsigned int)v7;
                v8 = 3146000LL;
              }
            }
            else
            {
              if ( a1 != 500 )
                return (unsigned int)v7;
              v8 = 2621728LL;
            }
          }
          else
          {
            if ( a1 != 400 )
              return (unsigned int)v7;
            v8 = 2097184LL;
          }
        }
        else
        {
          if ( a1 != 300 )
            return (unsigned int)v7;
          v8 = 1572880LL;
        }
      }
      else
      {
        if ( a1 != 200 )
          return (unsigned int)v7;
        v8 = 1048704LL;
      }
    }
    else
    {
      if ( a1 != 100 )
        return (unsigned int)v7;
      v8 = 524432LL;
    }
  }
  else
  {
    v8 = 0LL;
    if ( a1 )
      return (unsigned int)v7;
  }
  if ( ifnet_dequeue_service_class_multi(*(_QWORD *)(a3 + 192), v8, v6) )
  {
    *(_QWORD *)v5 = 0LL;
    v7 = -536870176;
  }
  else
  {
    if ( (*(_DWORD *)(a3 + 312) & 0xFFFFFFFE) == 2 )
    {
      for ( i = *(_QWORD *)v5; i; i = v10 )
      {
        bpf_tap_out(*(_QWORD *)(a3 + 192), 1LL, i, 0LL, 0LL);
        LODWORD(v10) = mbuf_nextpkt(i);
      }
    }
    v11 = v13;
    if ( a5 )
      *(_QWORD *)a5 = v13;
    v7 = 0;
    ifnet_stat_increment_out(*(_QWORD *)(a3 + 192), 1LL, v11, 0LL);
  }
  return (unsigned int)v7;
}
// C89E0: using guessed type int __fastcall bpf_tap_out(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8AD0: using guessed type int __fastcall ifnet_dequeue_service_class_multi(_QWORD, _QWORD, _QWORD);
// C8B98: using guessed type int __fastcall ifnet_stat_increment_out(_QWORD, _QWORD, _QWORD, _QWORD);
// C8C60: using guessed type int __fastcall mbuf_nextpkt(_QWORD);

//----- (00000000000647EC) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::outputPacket(IO80211VirtualInterface *this, __mbuf *a2, void *a3)
{
  if ( !*((_BYTE *)this + 272) )
    mbuf_pkthdr_setrcvif(a2, 0LL, a3);
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 23) + 2136LL))(
           *((_QWORD *)this + 23),
           a2,
           this);
}
// C8C88: using guessed type int __fastcall mbuf_pkthdr_setrcvif(_QWORD, _QWORD, _QWORD);

//----- (000000000006482A) ----------------------------------------------------
void __fastcall IO80211VirtualInterface::setAuthTimeout(IO80211VirtualInterface *this, __int64 a2)
{
  *((_QWORD *)this + 29) = a2;
}

//----- (0000000000064838) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::authTimeout(IO80211VirtualInterface *this)
{
  return *((_QWORD *)this + 29);
}

//----- (0000000000064846) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::initSupplicant(IO80211VirtualInterface *this, unsigned __int8 *a2)
{
  return 0LL;
}

//----- (000000000006484E) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::setPMK(IO80211VirtualInterface *this, unsigned __int8 *a2)
{
  return 0LL;
}

//----- (0000000000064856) ----------------------------------------------------
void __fastcall IO80211VirtualInterface::terminateSupplicant(IO80211VirtualInterface *this)
{
  ;
}

//----- (000000000006485C) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::supplicantInitialized(IO80211VirtualInterface *this)
{
  return 0LL;
}

//----- (0000000000064864) ----------------------------------------------------
void __fastcall IO80211VirtualInterface::resetSupplicant(IO80211VirtualInterface *this)
{
  ;
}

//----- (000000000006486A) ----------------------------------------------------
void __fastcall IO80211VirtualInterface::cachePMKSA(IO80211VirtualInterface *this, unsigned __int8 *a2, __int64 a3, ether_addr *a4, unsigned __int8 *a5)
{
  ;
}

//----- (0000000000064870) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::cachePMKSA(IO80211VirtualInterface *this, unsigned __int8 *a2, __int64 a3, ether_addr *a4)
{
  return 102LL;
}

//----- (000000000006487C) ----------------------------------------------------
void __fastcall IO80211VirtualInterface::setDebugFlags(IO80211VirtualInterface *this, __int64 a2)
{
  IO80211PeerManager *v2; // rdi@1

  *((_QWORD *)this + 20) = a2;
  v2 = (IO80211PeerManager *)*((_QWORD *)this + 18);
  if ( v2 )
    IO80211PeerManager::setPeerManagerLogFlags(v2);
}

//----- (000000000006489C) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::debugFlags(IO80211VirtualInterface *this)
{
  return *((_QWORD *)this + 20);
}

//----- (00000000000648AA) ----------------------------------------------------
void __fastcall IO80211VirtualInterface::setWoWEnabled(IO80211VirtualInterface *this)
{
  ;
}

//----- (00000000000648B0) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::supplicantExchangeComplete(IO80211VirtualInterface *this)
{
  return 0LL;
}

//----- (00000000000648B8) ----------------------------------------------------
void IO80211VirtualInterface::getPMKSAList()
{
  ;
}

//----- (00000000000648BE) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::linkState(IO80211VirtualInterface *this)
{
  return *((_DWORD *)this + 57);
}

//----- (00000000000648CA) ----------------------------------------------------
char __fastcall IO80211VirtualInterface::setLinkState(__int64 a1, int a2, int a3)
{
  int v3; // er15@1
  __int64 v4; // r12@1
  int v5; // er13@2
  const char *v6; // rax@2
  __int64 v7; // rdx@2
  __int64 v8; // rcx@2
  __int64 v9; // r8@2
  __int64 v10; // r9@2
  __int64 v11; // rax@4
  __int64 v12; // r8@4
  __int64 v13; // r9@4
  __int64 v14; // rax@8
  int v16; // [sp+0h] [bp-60h]@2
  int v17; // [sp+4h] [bp-5Ch]@2
  int v18; // [sp+8h] [bp-58h]@2
  int v19; // [sp+Ch] [bp-54h]@2
  int v20; // [sp+14h] [bp-4Ch]@2
  int v21; // [sp+18h] [bp-48h]@2
  int v22; // [sp+1Ch] [bp-44h]@2
  char v23; // [sp+20h] [bp-40h]@2
  __int64 v24; // [sp+30h] [bp-30h]@1

  v3 = a2;
  v4 = off_7B078[0];
  v24 = *(_QWORD *)off_7B078[0];
  if ( *(_DWORD *)(a1 + 228) != a2 )
  {
    v5 = a3;
    bzero(&v16, 0x30uLL);
    v16 = 48;
    v17 = 1;
    v18 = 1;
    v19 = 2;
    v20 = (a2 == 2) | 0xC;
    v21 = ifnet_family(*(_QWORD *)(a1 + 192), 48LL);
    v22 = ifnet_unit(*(_QWORD *)(a1 + 192));
    LODWORD(v6) = ifnet_name(*(_QWORD *)(a1 + 192));
    strncpy(&v23, v6, 0x10uLL);
    v4 = off_7B078[0];
    ifnet_event(*(_QWORD *)(a1 + 192), &v16);
    *(_DWORD *)(a1 + 228) = a2;
    if ( a2 == 2 )
      goto LABEL_13;
    if ( *(_QWORD *)(a1 + 144) )
    {
      v11 = convertIEEEReasonToString(v5);
      IOLog("AirPort: Link Down on %s. Reason %u (%s).\n", a1 + 200, (unsigned int)v5, v11, v12, v13);
      IO80211PeerManager::disable(*(IO80211PeerManager **)(a1 + 144), "setLinkState");
      v3 = *(_DWORD *)(a1 + 228);
    }
    if ( v3 == 2 )
    {
LABEL_13:
      if ( *(_QWORD *)(a1 + 144) )
      {
        IOLog("AirPort: Link Up on %s\n", a1 + 200, v7, v8, v9, v10);
        IO80211PeerManager::enable(*(IO80211PeerManager **)(a1 + 144), "setLinkState");
      }
    }
  }
  v14 = *(_QWORD *)v4;
  if ( *(_QWORD *)v4 == v24 )
    LOBYTE(v14) = 1;
  return v14;
}
// 7B078: using guessed type __int64 off_7B078[7];
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8AE8: using guessed type int __fastcall ifnet_event(_QWORD, _QWORD);
// C8AF0: using guessed type int __fastcall ifnet_family(_QWORD, _QWORD);
// C8B20: using guessed type int __fastcall ifnet_name(_QWORD);
// C8BB0: using guessed type int __fastcall ifnet_unit(_QWORD);

//----- (0000000000064A44) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::startOutputQueues(IO80211VirtualInterface *this)
{
  int result; // eax@1

  (*(void (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)this + 30) + 336LL))(*((_QWORD *)this + 30), 32LL);
  result = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)this + 30) + 304LL))(*((_QWORD *)this + 30));
  if ( *((_BYTE *)this + 272) )
  {
    (*(void (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)this + 31) + 336LL))(*((_QWORD *)this + 31), 32LL);
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 31) + 304LL))(*((_QWORD *)this + 31));
    (*(void (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)this + 33) + 336LL))(*((_QWORD *)this + 33), 32LL);
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 33) + 304LL))(*((_QWORD *)this + 33));
    (*(void (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)this + 32) + 336LL))(*((_QWORD *)this + 32), 32LL);
    result = (*(int (**)(void))(**((_QWORD **)this + 32) + 304LL))();
  }
  return result;
}

//----- (0000000000064AF8) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::stopOutputQueues(IO80211VirtualInterface *this)
{
  IO80211VirtualInterface *v1; // rbx@1
  int result; // eax@1

  v1 = this;
  (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 30) + 312LL))(*((_QWORD *)this + 30));
  (*(void (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 30) + 328LL))(*((_QWORD *)v1 + 30));
  result = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)v1 + 30) + 336LL))(*((_QWORD *)v1 + 30), 0LL);
  if ( *((_BYTE *)this + 272) )
  {
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 31) + 312LL))(*((_QWORD *)this + 31));
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 31) + 328LL))(*((_QWORD *)this + 31));
    (*(void (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 31) + 336LL))(*((_QWORD *)this + 31), 0LL);
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 33) + 312LL))(*((_QWORD *)this + 33));
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 33) + 328LL))(*((_QWORD *)this + 33));
    (*(void (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 33) + 336LL))(*((_QWORD *)this + 33), 0LL);
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 32) + 312LL))(*((_QWORD *)this + 32));
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 32) + 328LL))(*((_QWORD *)this + 32));
    result = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 32) + 336LL))(*((_QWORD *)this + 32), 0LL);
  }
  return result;
}

//----- (0000000000064BE6) ----------------------------------------------------
char __fastcall IO80211VirtualInterface::controllerLostPower(IO80211VirtualInterface *this)
{
  return *((_BYTE *)this + 316);
}

//----- (0000000000064BF2) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::handle11zPacket(IO80211VirtualInterface *this, __mbuf *a2)
{
  __int64 v2; // rdi@1

  v2 = *((_QWORD *)this + 18);
  if ( v2 )
    (*(void (__fastcall **)(__int64, __mbuf *))(*(_QWORD *)v2 + 360LL))(v2, a2);
  return 0LL;
}

//----- (0000000000064C10) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::captureInfraPacket(IO80211VirtualInterface *this, __mbuf **a2)
{
  __int64 v2; // rdi@1
  int result; // eax@2

  v2 = *((_QWORD *)this + 18);
  if ( v2 )
    result = (*(int (__fastcall **)(__int64, __mbuf **))(*(_QWORD *)v2 + 312LL))(v2, a2);
  else
    result = 0;
  return result;
}

//----- (0000000000064C30) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::pushPacket(IO80211VirtualInterface *this, __mbuf *a2, __int64 a3)
{
  __mbuf *v3; // rbx@1
  signed __int64 v4; // rsi@1
  unsigned __int64 v5; // rax@4
  OSMetaClass *v6; // rax@5
  __int64 v7; // r14@5
  __int64 v8; // rax@5
  __int64 v9; // r8@5
  __int64 v10; // r9@5
  int result; // eax@5
  __int64 v12; // rax@6
  __int64 v13; // rax@6
  __int64 v14; // rax@6
  signed __int64 v15; // r15@6
  __int64 v16; // rax@6

  v3 = a2;
  v4 = *((_QWORD *)this + 24);
  mbuf_pkthdr_setrcvif(v3, v4, a3);
  if ( !*((_DWORD *)this + 76) && (*((_DWORD *)this + 78) | 2) == 3 )
  {
    v4 = 1LL;
    bpf_tap_in(*((_QWORD *)this + 24), 1LL, v3, 0LL, 0LL);
  }
  LODWORD(v5) = mbuf_len(v3);
  if ( v5 > 0xD )
  {
    LODWORD(v12) = mbuf_data(v3);
    mbuf_pkthdr_setheader(v3, v12);
    LODWORD(v13) = mbuf_pkthdr_len(v3);
    mbuf_pkthdr_setlen(v3, v13 - 14);
    LODWORD(v14) = mbuf_data(v3);
    v15 = v14 + 14;
    LODWORD(v16) = mbuf_len(v3);
    mbuf_setdata(v3, v15, v16 - 14);
    result = ifnet_input(*((_QWORD *)this + 24), v3, 0LL);
  }
  else
  {
    LODWORD(v6) = (*(int (__fastcall **)(IO80211VirtualInterface *, signed __int64))(*(_QWORD *)this + 56LL))(this, v4);
    v7 = OSMetaClass::getClassName(v6);
    LODWORD(v8) = mbuf_len(v3);
    IOLog("%s::%s() Error: mbuf too short (%ld), dropping sendUp packet\n", v7, "pushPacket", v8, v9, v10);
    result = mbuf_freem(v3);
  }
  return result;
}
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C89D8: using guessed type int __fastcall bpf_tap_in(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8B10: using guessed type int __fastcall ifnet_input(_QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C68: using guessed type int __fastcall mbuf_pkthdr_len(_QWORD);
// C8C78: using guessed type int __fastcall mbuf_pkthdr_setheader(_QWORD, _QWORD);
// C8C80: using guessed type int __fastcall mbuf_pkthdr_setlen(_QWORD, _QWORD);
// C8C88: using guessed type int __fastcall mbuf_pkthdr_setrcvif(_QWORD, _QWORD, _QWORD);
// C8CA0: using guessed type int __fastcall mbuf_setdata(_QWORD, _QWORD, _QWORD);

//----- (0000000000064D3E) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::inputPacket(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r12@1
  __int64 v4; // rbx@1
  __int64 v5; // r14@1
  __int64 v6; // rdi@1
  char v7; // r15@1
  int result; // eax@2
  __int64 v9; // rax@7
  __int64 v10; // rbx@7
  __int64 v11; // rax@7
  __int64 v12; // rbx@7
  __int64 v13; // rax@7
  signed __int64 v14; // r15@7
  __int64 v15; // rax@7
  __int64 v16; // [sp+8h] [bp-28h]@1

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v16 = a2;
  mbuf_pkthdr_setrcvif(a2, *(_QWORD *)(a1 + 192), a3);
  v6 = *(_QWORD *)(a1 + 144);
  v7 = 1;
  if ( !v6
    || (result = (*(int (__fastcall **)(__int64, __int64 *, __int64))(*(_QWORD *)v6 + 384LL))(v6, &v16, v3),
        v7 = result,
        (v4 = v16) != 0) )
  {
    result = *(_DWORD *)(v5 + 312) | 2;
    if ( result == 3 )
    {
      if ( !v7 )
      {
LABEL_8:
        if ( v4 )
          result = mbuf_freem(v4);
        return result;
      }
      result = bpf_tap_in(*(_QWORD *)(v5 + 192), 1LL, v4, 0LL, 0LL);
      v4 = v16;
    }
    if ( v7 )
    {
      LODWORD(v9) = mbuf_data(v4);
      mbuf_pkthdr_setheader(v4, v9);
      v10 = v16;
      LODWORD(v11) = mbuf_pkthdr_len(v16);
      mbuf_pkthdr_setlen(v10, v11 - 14);
      v12 = v16;
      LODWORD(v13) = mbuf_data(v16);
      v14 = v13 + 14;
      LODWORD(v15) = mbuf_len(v16);
      mbuf_setdata(v12, v14, v15 - 14);
      return ifnet_input(*(_QWORD *)(v5 + 192), v16, 0LL);
    }
    goto LABEL_8;
  }
  return result;
}
// C89D8: using guessed type int __fastcall bpf_tap_in(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8B10: using guessed type int __fastcall ifnet_input(_QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C20: using guessed type int __cdecl mbuf_freem(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C68: using guessed type int __fastcall mbuf_pkthdr_len(_QWORD);
// C8C78: using guessed type int __fastcall mbuf_pkthdr_setheader(_QWORD, _QWORD);
// C8C80: using guessed type int __fastcall mbuf_pkthdr_setlen(_QWORD, _QWORD);
// C8C88: using guessed type int __fastcall mbuf_pkthdr_setrcvif(_QWORD, _QWORD, _QWORD);
// C8CA0: using guessed type int __fastcall mbuf_setdata(_QWORD, _QWORD, _QWORD);

//----- (0000000000064E54) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::reportTransmitCompletionStatus(IO80211VirtualInterface *this, __mbuf *a2)
{
  int v2; // eax@1
  signed int v3; // ecx@1

  v2 = ifnet_tx_compl_status(*((_QWORD *)this + 24), a2);
  v3 = -536870212;
  if ( !v2 )
    v3 = 0;
  return (unsigned int)v3;
}
// C8BA0: using guessed type int __fastcall ifnet_tx_compl_status(_QWORD, _QWORD);

//----- (0000000000064E72) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::passUp(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rax@1
  __int64 v4; // rax@1
  __int64 v5; // rax@1
  signed __int64 v6; // r15@1
  __int64 v7; // rax@1
  __int64 v9; // [sp+8h] [bp-38h]@1
  __int64 v10; // [sp+10h] [bp-30h]@1
  __int64 v11; // [sp+18h] [bp-28h]@1
  __int64 v12; // [sp+20h] [bp-20h]@1

  mbuf_pkthdr_setrcvif(a2, *(_QWORD *)(a1 + 192), a3);
  LODWORD(v3) = mbuf_data(a2);
  mbuf_pkthdr_setheader(a2, v3);
  LODWORD(v4) = mbuf_pkthdr_len(a2);
  mbuf_pkthdr_setlen(a2, v4 - 14);
  LODWORD(v5) = mbuf_data(a2);
  v6 = v5 + 14;
  LODWORD(v7) = mbuf_len(a2);
  mbuf_setdata(a2, v6, v7 - 14);
  v12 = 0LL;
  v11 = 0LL;
  v10 = 0LL;
  LODWORD(v9) = 1;
  HIDWORD(v9) = mbuf_pkthdr_len(a2);
  return ifnet_input(*(_QWORD *)(a1 + 192), a2, &v9);
}
// C8B10: using guessed type int __fastcall ifnet_input(_QWORD, _QWORD, _QWORD);
// C8BF8: using guessed type int __fastcall mbuf_data(_QWORD);
// C8C48: using guessed type int __fastcall mbuf_len(_QWORD);
// C8C68: using guessed type int __fastcall mbuf_pkthdr_len(_QWORD);
// C8C78: using guessed type int __fastcall mbuf_pkthdr_setheader(_QWORD, _QWORD);
// C8C80: using guessed type int __fastcall mbuf_pkthdr_setlen(_QWORD, _QWORD);
// C8C88: using guessed type int __fastcall mbuf_pkthdr_setrcvif(_QWORD, _QWORD, _QWORD);
// C8CA0: using guessed type int __fastcall mbuf_setdata(_QWORD, _QWORD, _QWORD);

//----- (0000000000064F2E) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::getOutputQueueForDLT(IO80211VirtualInterface *this, int a2)
{
  __int64 v2; // rcx@1
  __int64 result; // rax@1

  v2 = IO80211BPFNodeForDLT(a2, *((_QWORD *)this + 36));
  result = 0LL;
  if ( v2 )
    result = *(_QWORD *)(v2 + 24);
  return result;
}

//----- (0000000000064F54) ----------------------------------------------------
void __fastcall IO80211VirtualInterface::setPeerManagerLogFlag(IO80211VirtualInterface *this, int a2, char a3)
{
  int v3; // er9@1
  unsigned __int64 v4; // rsi@1
  signed int v5; // eax@1
  unsigned __int64 v6; // rsi@2
  IO80211PeerManager *v7; // rdi@4

  v3 = a2;
  v4 = *((_QWORD *)this + 20);
  v5 = 1 << a3;
  if ( v3 )
    v6 = v5 | v4;
  else
    v6 = ~v5 & v4;
  *((_QWORD *)this + 20) = v6;
  v7 = (IO80211PeerManager *)*((_QWORD *)this + 18);
  if ( v7 )
    IO80211PeerManager::setPeerManagerLogFlags(v7);
}

//----- (0000000000064FA0) ----------------------------------------------------
void __fastcall IO80211VirtualInterface::togglePeerManagerLogFlag(IO80211VirtualInterface *this, char a2)
{
  char v2; // cl@1
  unsigned __int64 v3; // rsi@1
  signed int v4; // eax@1
  __int64 v5; // rcx@1
  unsigned __int64 v6; // rsi@2
  IO80211PeerManager *v7; // rdi@4

  v2 = a2;
  v3 = *((_QWORD *)this + 20);
  v4 = 1 << v2;
  v5 = 1 << v2;
  if ( v3 & v5 )
    v6 = ~v4 & v3;
  else
    v6 = v5 | v3;
  *((_QWORD *)this + 20) = v6;
  v7 = (IO80211PeerManager *)*((_QWORD *)this + 18);
  if ( v7 )
    IO80211PeerManager::setPeerManagerLogFlags(v7);
}

//----- (0000000000064FE4) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::getPeerManagerLogFlags(IO80211VirtualInterface *this)
{
  IO80211PeerManager *v1; // rdi@1
  __int64 result; // rax@2

  v1 = (IO80211PeerManager *)*((_QWORD *)this + 18);
  if ( v1 )
    result = IO80211PeerManager::getPeerManagerLogFlags(v1);
  else
    result = 0LL;
  return result;
}

//----- (0000000000064FFE) ----------------------------------------------------
size_t __fastcall IO80211VirtualInterface::setUnitNumber(IO80211VirtualInterface *this, const char *a2)
{
  *((_DWORD *)this + 84) = IO80211VirtualInterfaceNamerNextAvailableUnitNumberForName(a2, 1);
  return strlcpy((char *)this + 340, a2, 0x10uLL);
}

//----- (000000000006503A) ----------------------------------------------------
size_t __fastcall IO80211VirtualInterface::setUnitNumber(IO80211VirtualInterface *this, const char *a2, int a3)
{
  *((_DWORD *)this + 84) = a3;
  return strlcpy((char *)this + 340, a2, 0x10uLL);
}

//----- (0000000000065056) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::handleDebugCmd(__int64 a1)
{
  __int64 v1; // rdi@1
  int result; // eax@2

  v1 = *(_QWORD *)(a1 + 144);
  if ( v1 )
    result = (*(int (**)(void))(*(_QWORD *)v1 + 536LL))();
  else
    result = 45;
  return result;
}

//----- (000000000006507A) ----------------------------------------------------
int __fastcall IO80211VirtualInterface::handleChannelSwitchAnnouncement(__int64 a1)
{
  __int64 v1; // rdi@1
  int result; // eax@2

  v1 = *(_QWORD *)(a1 + 144);
  if ( v1 )
    result = (*(int (**)(void))(*(_QWORD *)v1 + 296LL))();
  return result;
}

//----- (000000000006509A) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterface::MetaClass::~MetaClass(IO80211VirtualInterface::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000650B0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_20()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IO80211VirtualInterface::gMetaClass, "IO80211VirtualInterface", off_7B040[0], 360LL);
  result = (__int64)off_82180;
  IO80211VirtualInterface::gMetaClass = off_82180;
  return result;
}
// 7B040: using guessed type _QWORD off_7B040[14];
// 82180: using guessed type __int64 (__fastcall *off_82180[2])(IO80211VirtualInterface::MetaClass *__hidden this);
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000650F0) ----------------------------------------------------
__int64 `global destructor keyed to'_a_20()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211VirtualInterface::gMetaClass);
}
// 84D48: using guessed type _QWORD IO80211VirtualInterface::gMetaClass;

//----- (0000000000065110) ----------------------------------------------------
__int64 __fastcall IO80211QueueDescriptor::MetaClass::MetaClass(IO80211QueueDescriptor::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211QueueDescriptor", off_7B030[0], 32LL);
  result = (__int64)off_823F0;
  *(_QWORD *)this = off_823F0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 823F0: using guessed type __int64 (__fastcall *off_823F0[2])(IO80211QueueDescriptor::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000065142) ----------------------------------------------------
__int64 __fastcall IO80211QueueDescriptor::MetaClass::~MetaClass(IO80211QueueDescriptor::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000006514C) ----------------------------------------------------
__int64 __fastcall IO80211QueueDescriptor::IO80211QueueDescriptor(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_822B0;
  *(_QWORD *)a1 = off_822B0;
  return result;
}
// 822B0: using guessed type __int64 (__fastcall *off_822B0[2])(IO80211QueueDescriptor *__hidden this);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000006516C) ----------------------------------------------------
__int64 __fastcall IO80211QueueDescriptor::IO80211QueueDescriptor(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_822B0;
  *(_QWORD *)a1 = off_822B0;
  return result;
}
// 822B0: using guessed type __int64 (__fastcall *off_822B0[2])(IO80211QueueDescriptor *__hidden this);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000006518C) ----------------------------------------------------
__int64 __fastcall IO80211QueueDescriptor::~IO80211QueueDescriptor(IO80211QueueDescriptor *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000065196) ----------------------------------------------------
__int64 __fastcall IO80211QueueDescriptor::~IO80211QueueDescriptor(IO80211QueueDescriptor *this)
{
  return OSObject::~OSObject(this);
}

//----- (00000000000651A0) ----------------------------------------------------
void __fastcall IO80211QueueDescriptor::~IO80211QueueDescriptor(IO80211QueueDescriptor *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (00000000000651C2) ----------------------------------------------------
__int64 __fastcall IO80211QueueDescriptor::getMetaClass(IO80211QueueDescriptor *this)
{
  return (__int64)&IO80211QueueDescriptor::gMetaClass;
}
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;

//----- (00000000000651D0) ----------------------------------------------------
__int64 __fastcall IO80211QueueDescriptor::MetaClass::MetaClass(IO80211QueueDescriptor::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211QueueDescriptor", off_7B030[0], 32LL);
  result = (__int64)off_823F0;
  *(_QWORD *)this = off_823F0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 823F0: using guessed type __int64 (__fastcall *off_823F0[2])(IO80211QueueDescriptor::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000065202) ----------------------------------------------------
__int64 __fastcall IO80211QueueDescriptor::MetaClass::alloc(IO80211QueueDescriptor::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20, a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_822B0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211QueueDescriptor::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 822B0: using guessed type __int64 (__fastcall *off_822B0[2])(IO80211QueueDescriptor *__hidden this);
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000065242) ----------------------------------------------------
__int64 __fastcall IO80211QueueDescriptor::IO80211QueueDescriptor(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_822B0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211QueueDescriptor::gMetaClass);
}
// 822B0: using guessed type __int64 (__fastcall *off_822B0[2])(IO80211QueueDescriptor *__hidden this);
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000065272) ----------------------------------------------------
__int64 __fastcall IO80211QueueDescriptor::IO80211QueueDescriptor(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_822B0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211QueueDescriptor::gMetaClass);
}
// 822B0: using guessed type __int64 (__fastcall *off_822B0[2])(IO80211QueueDescriptor *__hidden this);
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000652A1) ----------------------------------------------------
char *__fastcall buf_kernel_addrperm_addr(void *a1)
{
  char *result; // rax@1

  result = 0LL;
  if ( a1 )
    result = (char *)a1 + buf_kernel_addrperm;
  return result;
}
// 844B0: using guessed type __int64 buf_kernel_addrperm;

//----- (00000000000652BB) ----------------------------------------------------
char *__fastcall vm_kernel_addrperm_addr(void *a1)
{
  char *result; // rax@1

  result = 0LL;
  if ( a1 )
    result = (char *)a1 + *(_QWORD *)&vm_kernel_addrperm;
  return result;
}
// 844B8: using guessed type char vm_kernel_addrperm;

//----- (00000000000652D5) ----------------------------------------------------
__int64 __fastcall _userPrint(__int64 a1, char *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, char a7)
{
  __int64 v7; // r12@1
  __int64 v8; // rbx@1
  char *v9; // rdi@1
  char *v10; // rax@1
  char *v11; // r13@1
  char *v12; // r15@1
  int v13; // er14@1
  unsigned int v14; // edx@6
  __int64 v15; // r8@7
  __int64 v16; // rax@7
  signed int v17; // edx@8
  __int64 v18; // rsi@8
  signed int v19; // er14@8
  int v20; // eax@12
  __int64 v21; // rdx@12
  __int64 v22; // rcx@12
  __int64 v23; // r8@12
  __int64 v24; // r9@12
  char *v25; // rdi@16
  __int64 v26; // rax@22
  char v27; // cl@25
  int v29; // ecx@35
  __int64 v30; // rax@35
  __int64 v31; // rax@35
  __int64 v32; // rdx@35
  char *v33; // [sp+8h] [bp-88h]@1
  char v34; // [sp+10h] [bp-80h]@1
  __int64 v35; // [sp+20h] [bp-70h]@1
  __int64 v36; // [sp+28h] [bp-68h]@1
  __int64 v37; // [sp+30h] [bp-60h]@1
  __int64 v38; // [sp+38h] [bp-58h]@1
  void *v39; // [sp+40h] [bp-50h]@1
  char *v40; // [sp+48h] [bp-48h]@1
  char *v41; // [sp+50h] [bp-40h]@1
  __int64 v42; // [sp+60h] [bp-30h]@1

  v33 = a2;
  v7 = a1;
  v38 = a6;
  v37 = a5;
  v36 = a4;
  v35 = a3;
  v8 = off_7B078[0];
  v42 = *(_QWORD *)off_7B078[0];
  v41 = &v34;
  v40 = &a7;
  v39 = (void *)16;
  v9 = (_BYTE *)(qword_4B8 + 840);
  LODWORD(v10) = IOMalloc(2048LL);
  v11 = v10;
  v12 = (char *)(v10 != 0LL);
  v13 = 0;
  if ( !v10 )
    goto LABEL_29;
  v13 = 0;
  if ( v7 )
  {
    if ( !*(_QWORD *)v7 && !*(_QWORD *)(v7 + 24) )
      *(_DWORD *)(v7 + 32) = 1024;
    v14 = *(_DWORD *)(v7 + 32);
    if ( v14 )
    {
      v15 = *(_DWORD *)(v7 + 36);
      v16 = *(_DWORD *)(v7 + 40);
      if ( v14 > (signed int)v16 + (signed int)v15 )
      {
        v17 = v14 - 1 - v15 - v16;
        v18 = *(_QWORD *)(v7 + 24);
        v19 = 2046;
        if ( v18 != 0 || v17 <= 2046 )
          v19 = v17;
        v9 = v11;
        if ( v18 )
          v9 = (char *)(v15 + v16 + v18);
        a2 = (char *)v19;
        v20 = vsnprintf(v9, v19, v33, (struct __va_list_tag *__attribute__((__org_typedef(va_list))) )&v39);
        if ( v20 > 0 )
        {
          if ( v20 > v19 )
            v20 = v19;
          v13 = v20;
          if ( *(_QWORD *)v7 )
          {
            v25 = *(char **)(v7 + 24);
            if ( !v25 )
              v25 = v11;
            copyout(v25, *(_QWORD *)v7 + *(_DWORD *)(v7 + 40), v20);
            *(_DWORD *)(v7 + 40) += v13;
          }
          else
          {
            if ( *(_QWORD *)(v7 + 64) && *(_QWORD *)(v7 + 8) )
            {
              LODWORD(v26) = v20 + *(_DWORD *)(v7 + 40);
              *(_DWORD *)(v7 + 40) = v26;
              v8 = off_7B078[0];
              if ( (_DWORD)v26 != *(_DWORD *)(v7 + 32) )
              {
                if ( !(_DWORD)v26 )
                  goto LABEL_28;
                if ( *(_BYTE *)(*(_QWORD *)(v7 + 24) + (unsigned int)(v26 + *(_DWORD *)(v7 + 36) - 1)) != 10 )
                  goto LABEL_31;
              }
              v27 = 1;
              goto LABEL_32;
            }
            IOLog("%s", v11, v21, v22, v23, v24);
          }
          v8 = off_7B078[0];
          goto LABEL_28;
        }
        v8 = off_7B078[0];
        v13 = 0;
      }
    }
  }
LABEL_28:
  while ( 1 )
  {
    v12 = (char *)((_QWORD)v12 << 11);
    v9 = v11;
    a2 = v12;
    IOFree(v11, v12);
LABEL_29:
    v26 = *(_QWORD *)v8;
    if ( *(_QWORD *)v8 == v42 )
      return (unsigned int)v13;
LABEL_31:
    v27 = 0;
LABEL_32:
    if ( (_DWORD)v26 == 1 && (a2 = *(char **)(v7 + 24), a2[*(_DWORD *)(v7 + 36)] == 10) )
    {
LABEL_37:
      *(_DWORD *)(v7 + 40) = 0;
    }
    else if ( v27 )
    {
      v29 = v26 + 1;
      v30 = (unsigned int)(*(_DWORD *)(v7 + 36) + v26);
      *(_DWORD *)(v7 + 40) = v29;
      *(_BYTE *)(*(_QWORD *)(v7 + 24) + v30) = 0;
      LODWORD(v31) = current_thread(v9, a2);
      *(_QWORD *)(*(_QWORD *)(v7 + 64) + 144LL) = v31;
      *(_QWORD *)(*(_QWORD *)(v7 + 64) + 128LL) = getAbsoluteTime();
      *(_DWORD *)(*(_QWORD *)(v7 + 64) + 136LL) = OSIncrementAtomic(&_logCount) & 0xFFFFFF;
      v32 = *(_QWORD *)(v7 + 72);
      if ( v32 )
        bpf_tap_in(
          *(_QWORD *)(v7 + 8),
          *(_DWORD *)(v7 + 16),
          v32,
          *(_QWORD *)(v7 + 24),
          (unsigned int)(*(_DWORD *)(v7 + 40) + *(_DWORD *)(v7 + 36)));
      goto LABEL_37;
    }
  }
}
// 4B8: using guessed type __int64[483];
// 7B078: using guessed type __int64 off_7B078[7];
// 844A8: using guessed type __int64 _logCount;
// C76E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// C7728: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C7738: using guessed type int __fastcall IOMalloc(_QWORD);
// C77D0: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// C89D8: using guessed type int __fastcall bpf_tap_in(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// C8A48: using guessed type int __fastcall copyout(_QWORD, _QWORD, _QWORD);
// C8A50: using guessed type int __fastcall current_thread(_QWORD, _QWORD);

//----- (000000000006556A) ----------------------------------------------------
char __fastcall IO80211QueueDescriptor::init(IO80211QueueDescriptor *this)
{
  char result; // al@6

  if ( !buf_kernel_addrperm )
  {
    read_random(&buf_kernel_addrperm, 8u);
    LOBYTE(buf_kernel_addrperm) = buf_kernel_addrperm | 1;
  }
  if ( !*(_QWORD *)&vm_kernel_addrperm )
  {
    read_random(&vm_kernel_addrperm, 8u);
    vm_kernel_addrperm |= 1u;
  }
  if ( (unsigned __int8)(*(int (__fastcall **)(IO80211QueueDescriptor *))(off_7B068[0] + 152))(this) )
  {
    *((_QWORD *)this + 2) = (char *)this + 16;
    *((_QWORD *)this + 3) = (char *)this + 16;
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 7B068: using guessed type __int64 off_7B068[9];
// 844B0: using guessed type __int64 buf_kernel_addrperm;
// 844B8: using guessed type char vm_kernel_addrperm;

//----- (00000000000655DC) ----------------------------------------------------
__int64 IO80211QueueDescriptor::print()
{
  return 0LL;
}

//----- (00000000000655E4) ----------------------------------------------------
__int64 __fastcall IO80211QueueDescriptor::MetaClass::~MetaClass(IO80211QueueDescriptor::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000655EE) ----------------------------------------------------
void __fastcall IO80211QueueDescriptor::freeResources(IO80211QueueDescriptor *this)
{
  ;
}

//----- (0000000000065600) ----------------------------------------------------
__int64 `global constructor keyed to'_a_21()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IO80211QueueDescriptor::gMetaClass, "IO80211QueueDescriptor", off_7B030[0], 32LL);
  result = (__int64)off_823F0;
  IO80211QueueDescriptor::gMetaClass = off_823F0;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 823F0: using guessed type __int64 (__fastcall *off_823F0[2])(IO80211QueueDescriptor::MetaClass *__hidden this);
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000065640) ----------------------------------------------------
__int64 `global destructor keyed to'_a_21()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211QueueDescriptor::gMetaClass);
}
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;

//----- (0000000000065660) ----------------------------------------------------
__int64 __fastcall IO80211PeerExtendedStats::MetaClass::MetaClass(IO80211PeerExtendedStats::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211PeerExtendedStats", off_7B030[0], 16LL);
  result = (__int64)off_82620;
  *(_QWORD *)this = off_82620;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 82620: using guessed type __int64 (__fastcall *off_82620[2])(IO80211PeerExtendedStats::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000065692) ----------------------------------------------------
__int64 __fastcall IO80211PeerExtendedStats::MetaClass::~MetaClass(IO80211PeerExtendedStats::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000006569C) ----------------------------------------------------
__int64 __fastcall IO80211PeerExtendedStats::IO80211PeerExtendedStats(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_824F0;
  *(_QWORD *)a1 = off_824F0;
  return result;
}
// 824F0: using guessed type __int64 (__fastcall *off_824F0[2])(IO80211PeerExtendedStats *__hidden this);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000656BC) ----------------------------------------------------
__int64 __fastcall IO80211PeerExtendedStats::IO80211PeerExtendedStats(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_824F0;
  *(_QWORD *)a1 = off_824F0;
  return result;
}
// 824F0: using guessed type __int64 (__fastcall *off_824F0[2])(IO80211PeerExtendedStats *__hidden this);
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000656DC) ----------------------------------------------------
__int64 __fastcall IO80211PeerExtendedStats::~IO80211PeerExtendedStats(IO80211PeerExtendedStats *this)
{
  return OSObject::~OSObject(this);
}

//----- (00000000000656E6) ----------------------------------------------------
__int64 __fastcall IO80211PeerExtendedStats::~IO80211PeerExtendedStats(IO80211PeerExtendedStats *this)
{
  return OSObject::~OSObject(this);
}

//----- (00000000000656F0) ----------------------------------------------------
void __fastcall IO80211PeerExtendedStats::~IO80211PeerExtendedStats(IO80211PeerExtendedStats *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000065712) ----------------------------------------------------
__int64 __fastcall IO80211PeerExtendedStats::getMetaClass(IO80211PeerExtendedStats *this)
{
  return (__int64)&IO80211PeerExtendedStats::gMetaClass;
}
// 84D98: using guessed type _QWORD IO80211PeerExtendedStats::gMetaClass;

//----- (0000000000065720) ----------------------------------------------------
__int64 __fastcall IO80211PeerExtendedStats::MetaClass::MetaClass(IO80211PeerExtendedStats::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211PeerExtendedStats", off_7B030[0], 16LL);
  result = (__int64)off_82620;
  *(_QWORD *)this = off_82620;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 82620: using guessed type __int64 (__fastcall *off_82620[2])(IO80211PeerExtendedStats::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000065752) ----------------------------------------------------
__int64 __fastcall IO80211PeerExtendedStats::MetaClass::alloc(IO80211PeerExtendedStats::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&dword_10, a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_824F0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211PeerExtendedStats::gMetaClass);
  return v2;
}
// 10: using guessed type int dword_10;
// 824F0: using guessed type __int64 (__fastcall *off_824F0[2])(IO80211PeerExtendedStats *__hidden this);
// 84D98: using guessed type _QWORD IO80211PeerExtendedStats::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000065792) ----------------------------------------------------
__int64 __fastcall IO80211PeerExtendedStats::IO80211PeerExtendedStats(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_824F0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211PeerExtendedStats::gMetaClass);
}
// 824F0: using guessed type __int64 (__fastcall *off_824F0[2])(IO80211PeerExtendedStats *__hidden this);
// 84D98: using guessed type _QWORD IO80211PeerExtendedStats::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000657C2) ----------------------------------------------------
__int64 __fastcall IO80211PeerExtendedStats::IO80211PeerExtendedStats(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_824F0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211PeerExtendedStats::gMetaClass);
}
// 824F0: using guessed type __int64 (__fastcall *off_824F0[2])(IO80211PeerExtendedStats *__hidden this);
// 84D98: using guessed type _QWORD IO80211PeerExtendedStats::gMetaClass;
// C8190: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000657F2) ----------------------------------------------------
__int64 __fastcall IO80211PeerExtendedStats::MetaClass::~MetaClass(IO80211PeerExtendedStats::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000065800) ----------------------------------------------------
__int64 `global constructor keyed to'_a_22()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IO80211PeerExtendedStats::gMetaClass, "IO80211PeerExtendedStats", off_7B030[0], 16LL);
  result = (__int64)off_82620;
  IO80211PeerExtendedStats::gMetaClass = off_82620;
  return result;
}
// 7B030: using guessed type _QWORD off_7B030[16];
// 82620: using guessed type __int64 (__fastcall *off_82620[2])(IO80211PeerExtendedStats::MetaClass *__hidden this);
// 84D98: using guessed type _QWORD IO80211PeerExtendedStats::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000065840) ----------------------------------------------------
__int64 `global destructor keyed to'_a_22()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211PeerExtendedStats::gMetaClass);
}
// 84D98: using guessed type _QWORD IO80211PeerExtendedStats::gMetaClass;

//----- (0000000000065860) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterfaceNamer::MetaClass::MetaClass(IO80211VirtualInterfaceNamer::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211VirtualInterfaceNamer", off_7B040[0], 152LL);
  result = (__int64)off_82F90;
  *(_QWORD *)this = off_82F90;
  return result;
}
// 7B040: using guessed type _QWORD off_7B040[14];
// 82F90: using guessed type __int64 (__fastcall *off_82F90[2])(IO80211VirtualInterfaceNamer::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000065892) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterfaceNamer::MetaClass::~MetaClass(IO80211VirtualInterfaceNamer::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000006589C) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterfaceNamer::IO80211VirtualInterfaceNamer(__int64 a1)
{
  __int64 result; // rax@1

  IOService::IOService(a1);
  result = (__int64)off_82720;
  *(_QWORD *)a1 = off_82720;
  return result;
}
// 82720: using guessed type __int64 (__fastcall *off_82720[2])(IO80211VirtualInterfaceNamer *__hidden this);
// C85F8: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (00000000000658BC) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterfaceNamer::IO80211VirtualInterfaceNamer(__int64 a1)
{
  __int64 result; // rax@1

  IOService::IOService(a1);
  result = (__int64)off_82720;
  *(_QWORD *)a1 = off_82720;
  return result;
}
// 82720: using guessed type __int64 (__fastcall *off_82720[2])(IO80211VirtualInterfaceNamer *__hidden this);
// C85F8: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (00000000000658DC) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterfaceNamer::~IO80211VirtualInterfaceNamer(IO80211VirtualInterfaceNamer *this)
{
  return IOService::~IOService(this);
}

//----- (00000000000658E6) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterfaceNamer::~IO80211VirtualInterfaceNamer(IO80211VirtualInterfaceNamer *this)
{
  return IOService::~IOService(this);
}

//----- (00000000000658F0) ----------------------------------------------------
void __fastcall IO80211VirtualInterfaceNamer::~IO80211VirtualInterfaceNamer(IO80211VirtualInterfaceNamer *this)
{
  IOService::~IOService(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000065912) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterfaceNamer::getMetaClass(IO80211VirtualInterfaceNamer *this)
{
  return (__int64)&IO80211VirtualInterfaceNamer::gMetaClass;
}
// 84DC0: using guessed type _QWORD IO80211VirtualInterfaceNamer::gMetaClass;

//----- (0000000000065920) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterfaceNamer::MetaClass::MetaClass(IO80211VirtualInterfaceNamer::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211VirtualInterfaceNamer", off_7B040[0], 152LL);
  result = (__int64)off_82F90;
  *(_QWORD *)this = off_82F90;
  return result;
}
// 7B040: using guessed type _QWORD off_7B040[14];
// 82F90: using guessed type __int64 (__fastcall *off_82F90[2])(IO80211VirtualInterfaceNamer::MetaClass *__hidden this);
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000065952) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterfaceNamer::MetaClass::alloc(IO80211VirtualInterfaceNamer::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_68.offset, a2);
  IOService::IOService(v2);
  *(_QWORD *)v2 = off_82720;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211VirtualInterfaceNamer::gMetaClass);
  return v2;
}
// 68: using guessed type section_64 stru_68;
// 82720: using guessed type __int64 (__fastcall *off_82720[2])(IO80211VirtualInterfaceNamer *__hidden this);
// 84DC0: using guessed type _QWORD IO80211VirtualInterfaceNamer::gMetaClass;
// C85F8: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (0000000000065992) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterfaceNamer::IO80211VirtualInterfaceNamer(__int64 a1)
{
  IOService::IOService(a1);
  *(_QWORD *)a1 = off_82720;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211VirtualInterfaceNamer::gMetaClass);
}
// 82720: using guessed type __int64 (__fastcall *off_82720[2])(IO80211VirtualInterfaceNamer *__hidden this);
// 84DC0: using guessed type _QWORD IO80211VirtualInterfaceNamer::gMetaClass;
// C85F8: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (00000000000659C2) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterfaceNamer::IO80211VirtualInterfaceNamer(__int64 a1)
{
  IOService::IOService(a1);
  *(_QWORD *)a1 = off_82720;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211VirtualInterfaceNamer::gMetaClass);
}
// 82720: using guessed type __int64 (__fastcall *off_82720[2])(IO80211VirtualInterfaceNamer *__hidden this);
// 84DC0: using guessed type _QWORD IO80211VirtualInterfaceNamer::gMetaClass;
// C85F8: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (00000000000659F2) ----------------------------------------------------
bool __fastcall IO80211VirtualInterfaceNamer::init(IO80211VirtualInterfaceNamer *this)
{
  __int64 v1; // rax@2
  __int64 v2; // rax@3
  bool result; // al@3

  if ( (unsigned __int8)(*(int (__fastcall **)(IO80211VirtualInterfaceNamer *, _QWORD))(off_7B070[0] + 600))(this, 0LL)
    && (LODWORD(v1) = IORecursiveLockAlloc(this), (*((_QWORD *)this + 17) = v1) != 0LL) )
  {
    v2 = OSDictionary::withCapacity((OSDictionary *)((char *)&dword_0 + 2), 0);
    *((_QWORD *)this + 18) = v2;
    result = v2 != 0;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 0: using guessed type int;
// 7B070: using guessed type __int64 off_7B070[8];
// C7748: using guessed type int __cdecl IORecursiveLockAlloc(_QWORD);

//----- (0000000000065A42) ----------------------------------------------------
int __fastcall IO80211VirtualInterfaceNamer::free(IO80211VirtualInterfaceNamer *this)
{
  IO80211VirtualInterfaceNamer *v1; // rbx@1
  __int64 v2; // rdi@1
  __int64 v3; // rdi@3

  v1 = this;
  _interfaceNamer = 0LL;
  v2 = *((_QWORD *)this + 17);
  if ( v2 )
    IORecursiveLockFree(v2);
  v3 = *((_QWORD *)v1 + 18);
  if ( v3 )
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
  return (*(int (__fastcall **)(IO80211VirtualInterfaceNamer *))(off_7B070[0] + 160))(v1);
}
// 7B070: using guessed type __int64 off_7B070[8];
// C7750: using guessed type int __cdecl IORecursiveLockFree(_QWORD);

//----- (0000000000065A90) ----------------------------------------------------
char __fastcall IO80211VirtualInterfaceNamer::arrayContainsUnitNumber(IO80211VirtualInterfaceNamer *this, OSArray *a2, OSNumber *a3)
{
  OSNumber *v3; // r14@1
  int v4; // eax@1
  int v5; // er15@1
  unsigned int v6; // ebx@1
  bool v7; // zf@1
  char result; // al@1
  __int64 v9; // rax@2
  char v10; // cl@2

  v3 = a3;
  v4 = (*(int (__fastcall **)(OSArray *))(*(_QWORD *)a2 + 304LL))(a2);
  v5 = v4;
  v6 = 0;
  v7 = v4 == 0;
  result = 0;
  if ( !v7 )
  {
    while ( 1 )
    {
      LODWORD(v9) = (*(int (__fastcall **)(OSArray *, _QWORD))(*(_QWORD *)a2 + 488LL))(a2, v6);
      v10 = (*(int (__fastcall **)(__int64, OSNumber *))(*(_QWORD *)v9 + 360LL))(v9, v3);
      result = 1;
      if ( v10 )
        break;
      ++v6;
      if ( v6 >= v5 )
        return 0;
    }
  }
  return result;
}

//----- (0000000000065AF6) ----------------------------------------------------
char __fastcall IO80211VirtualInterfaceNamer::markInterfaceUnitUsed(IO80211VirtualInterfaceNamer *this, const char *a2, unsigned int a3)
{
  unsigned int v3; // ebx@1
  const char *v4; // r15@1
  IO80211VirtualInterfaceNamer *v5; // r14@1
  signed __int64 v6; // rsi@1
  unsigned int v7; // edx@1
  OSNumber *v8; // r12@1
  IO80211VirtualInterfaceNamer *v9; // rdi@2
  OSArray *v10; // rax@2
  OSArray *v11; // rbx@2
  char v12; // bl@6

  v3 = a3;
  v4 = a2;
  v5 = this;
  IORecursiveLockLock(*((_QWORD *)this + 17));
  v6 = 32LL;
  v8 = (OSNumber *)OSNumber::withNumber((OSNumber *)v3, 0x20uLL, v7);
  if ( !v8 )
  {
    v12 = 0;
    goto LABEL_8;
  }
  v9 = (IO80211VirtualInterfaceNamer *)*((_QWORD *)this + 18);
  v6 = (signed __int64)v4;
  LODWORD(v10) = (*(int (__fastcall **)(IO80211VirtualInterfaceNamer *, const char *))(*(_QWORD *)v9 + 520LL))(v9, v4);
  v11 = v10;
  if ( !v10 )
  {
    v11 = (OSArray *)OSArray::withCapacity((OSArray *)((char *)&dword_0 + 1), (unsigned int)v4);
    if ( !v11 )
    {
LABEL_9:
      v12 = 0;
      goto LABEL_7;
    }
    v9 = (IO80211VirtualInterfaceNamer *)*((_QWORD *)v5 + 18);
    (*(void (__fastcall **)(IO80211VirtualInterfaceNamer *, const char *, OSArray *))(*(_QWORD *)v9 + 464LL))(
      v9,
      v4,
      v11);
  }
  v6 = (signed __int64)v11;
  if ( IO80211VirtualInterfaceNamer::arrayContainsUnitNumber(v9, v11, v8) )
    goto LABEL_9;
  v6 = (signed __int64)v8;
  (*(void (__fastcall **)(OSArray *, OSNumber *))(*(_QWORD *)v11 + 440LL))(v11, v8);
  v12 = 1;
LABEL_7:
  (*(void (__fastcall **)(OSNumber *))(*(_QWORD *)v8 + 40LL))(v8);
LABEL_8:
  IORecursiveLockUnlock(*((_QWORD *)v5 + 17), v6);
  return v12;
}
// 0: using guessed type int dword_0;
// C7758: using guessed type int __cdecl IORecursiveLockLock(_QWORD);
// C7760: using guessed type int __fastcall IORecursiveLockUnlock(_QWORD, _QWORD);

//----- (0000000000065BBA) ----------------------------------------------------
int __fastcall IO80211VirtualInterfaceNamer::markInterfaceUnitUnused(IO80211VirtualInterfaceNamer *this, const char *a2, unsigned int a3)
{
  unsigned int v3; // ebx@1
  const char *v4; // r12@1
  signed __int64 v5; // rsi@1
  unsigned int v6; // edx@1
  signed __int64 v7; // r15@1
  __int64 v8; // rax@2
  __int64 v9; // r13@2
  int v10; // er12@3
  unsigned int v11; // ebx@4
  __int64 v12; // rax@5

  v3 = a3;
  v4 = a2;
  IORecursiveLockLock(*((_QWORD *)this + 17));
  v5 = 32LL;
  v7 = OSNumber::withNumber((OSNumber *)v3, 0x20uLL, v6);
  if ( v7 )
  {
    v5 = (signed __int64)v4;
    LODWORD(v8) = (*(int (__fastcall **)(_QWORD, const char *))(**((_QWORD **)this + 18) + 520LL))(
                    *((_QWORD *)this + 18),
                    v4);
    v9 = v8;
    if ( v8 )
    {
      v10 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v8 + 304LL))(v8);
      if ( v10 )
      {
        v11 = 0;
        while ( 1 )
        {
          LODWORD(v12) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v9 + 488LL))(v9, v11);
          v5 = v7;
          if ( (unsigned __int8)(*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v12 + 360LL))(v12, v7) )
            break;
          ++v11;
          if ( v11 >= v10 )
            goto LABEL_9;
        }
        v5 = v11;
        (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v9 + 472LL))(v9, v11);
      }
    }
LABEL_9:
    (*(void (__fastcall **)(signed __int64))(*(_QWORD *)v7 + 40LL))(v7);
  }
  return IORecursiveLockUnlock(*((_QWORD *)this + 17), v5);
}
// C7758: using guessed type int __cdecl IORecursiveLockLock(_QWORD);
// C7760: using guessed type int __fastcall IORecursiveLockUnlock(_QWORD, _QWORD);

//----- (0000000000065C80) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterfaceNamer::nextAvailableUnitNumberForName(IO80211VirtualInterfaceNamer *this, const char *a2, char a3)
{
  char v3; // r12@1
  const char *v4; // r15@1
  IO80211VirtualInterfaceNamer *v5; // r14@1
  const char *v6; // rax@1
  unsigned int v7; // edx@1
  const char *v8; // r13@1
  unsigned int v9; // ebx@1
  IO80211VirtualInterfaceNamer *v10; // rdi@2
  OSNumber *v11; // r12@2
  char v12; // r15@4
  unsigned int v13; // edx@4
  const char *v15; // [sp+8h] [bp-38h]@3
  char v16; // [sp+14h] [bp-2Ch]@2

  v3 = a3;
  v4 = a2;
  v5 = this;
  IORecursiveLockLock(*((_QWORD *)this + 17));
  LODWORD(v6) = (*(int (**)(void))(**((_QWORD **)this + 18) + 520LL))();
  v8 = v6;
  v9 = 0;
  if ( v6 )
  {
    v16 = v3;
    v9 = 0;
    v10 = 0LL;
    a2 = (const char *)&stru_20;
    v11 = (OSNumber *)OSNumber::withNumber(0LL, 0x20uLL, v7);
    if ( !v11 )
      goto LABEL_10;
    v15 = v4;
    while ( 1 )
    {
      a2 = v8;
      v12 = IO80211VirtualInterfaceNamer::arrayContainsUnitNumber(v10, (OSArray *)v8, v11);
      (*(void (__fastcall **)(OSNumber *, const char *))(*(_QWORD *)v11 + 40LL))(v11, v8);
      if ( !v12 )
        break;
      ++v9;
      v10 = (IO80211VirtualInterfaceNamer *)v9;
      a2 = (const char *)&stru_20;
      v11 = (OSNumber *)OSNumber::withNumber((OSNumber *)v9, 0x20uLL, v13);
      if ( !v11 )
        goto LABEL_10;
    }
    v4 = v15;
    v3 = v16;
  }
  if ( v3 )
  {
    a2 = v4;
    IO80211VirtualInterfaceNamer::markInterfaceUnitUsed(v5, v4, v9);
  }
LABEL_10:
  IORecursiveLockUnlock(*((_QWORD *)v5 + 17), a2);
  return v9;
}
// 20: using guessed type segment_command_64 stru_20;
// C7758: using guessed type int __cdecl IORecursiveLockLock(_QWORD);
// C7760: using guessed type int __fastcall IORecursiveLockUnlock(_QWORD, _QWORD);

//----- (0000000000065D4D) ----------------------------------------------------
char IO80211VirtualInterfaceNamerRetain(void)
{
  char result; // al@2
  IO80211VirtualInterfaceNamer *v1; // rax@3
  char v2; // cl@4

  if ( _interfaceNamer )
  {
    (*(void (**)(void))(*(_QWORD *)_interfaceNamer + 32LL))();
    return 1;
  }
  LODWORD(v1) = (*(int (__fastcall **)(_QWORD *))(IO80211VirtualInterfaceNamer::gMetaClass + 136LL))(&IO80211VirtualInterfaceNamer::gMetaClass);
  _interfaceNamer = v1;
  if ( v1 )
  {
    v2 = (*(int (__fastcall **)(IO80211VirtualInterfaceNamer *))(*(_QWORD *)v1 + 136LL))(v1);
    result = 1;
    if ( v2 )
      return result;
    (*(void (**)(void))(*(_QWORD *)_interfaceNamer + 40LL))();
    _interfaceNamer = 0LL;
  }
  return 0;
}
// 84DC0: using guessed type _QWORD IO80211VirtualInterfaceNamer::gMetaClass;

//----- (0000000000065DB7) ----------------------------------------------------
int IO80211VirtualInterfaceNamerRelease(void)
{
  int result; // eax@2

  if ( _interfaceNamer )
    result = (*(int (**)(void))(*(_QWORD *)_interfaceNamer + 40LL))();
  return result;
}

//----- (0000000000065DD0) ----------------------------------------------------
char __fastcall IO80211VirtualInterfaceNamerMarkInterfaceUnitUsed(const char *a1, unsigned int a2)
{
  char result; // al@2

  if ( _interfaceNamer )
    result = IO80211VirtualInterfaceNamer::markInterfaceUnitUsed(_interfaceNamer, a1, a2);
  else
    result = 0;
  return result;
}

//----- (0000000000065DF5) ----------------------------------------------------
int __fastcall IO80211VirtualInterfaceNamerMarkInterfaceUnitUnused(const char *a1, unsigned int a2)
{
  int result; // eax@1

  result = a2;
  if ( _interfaceNamer )
    result = IO80211VirtualInterfaceNamer::markInterfaceUnitUnused(_interfaceNamer, a1, a2);
  return result;
}

//----- (0000000000065E17) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterfaceNamerNextAvailableUnitNumberForName(const char *a1, char a2)
{
  __int64 result; // rax@2

  if ( _interfaceNamer )
    result = IO80211VirtualInterfaceNamer::nextAvailableUnitNumberForName(_interfaceNamer, a1, a2);
  else
    result = 0LL;
  return result;
}

//----- (0000000000065E3C) ----------------------------------------------------
__int64 __fastcall IO80211VirtualInterfaceNamer::MetaClass::~MetaClass(IO80211VirtualInterfaceNamer::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000065E50) ----------------------------------------------------
__int64 `global constructor keyed to'_a_23()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(
    &IO80211VirtualInterfaceNamer::gMetaClass,
    "IO80211VirtualInterfaceNamer",
    off_7B040[0],
    152LL);
  result = (__int64)off_82F90;
  IO80211VirtualInterfaceNamer::gMetaClass = off_82F90;
  return result;
}
// 7B040: using guessed type _QWORD off_7B040[14];
// 82F90: using guessed type __int64 (__fastcall *off_82F90[2])(IO80211VirtualInterfaceNamer::MetaClass *__hidden this);
// 84DC0: using guessed type _QWORD IO80211VirtualInterfaceNamer::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000065E90) ----------------------------------------------------
__int64 `global destructor keyed to'_a_23()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211VirtualInterfaceNamer::gMetaClass);
}
// 84DC0: using guessed type _QWORD IO80211VirtualInterfaceNamer::gMetaClass;

//----- (0000000000065EB0) ----------------------------------------------------
__int64 __fastcall IO80211DriverCommandDescriptor::MetaClass::MetaClass(IO80211DriverCommandDescriptor::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211DriverCommandDescriptor", &IO80211QueueDescriptor::gMetaClass, 72LL);
  result = (__int64)off_831D0;
  *(_QWORD *)this = off_831D0;
  return result;
}
// 831D0: using guessed type __int64 (__fastcall *off_831D0[2])(IO80211DriverCommandDescriptor::MetaClass *__hidden this);
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000065EE2) ----------------------------------------------------
__int64 __fastcall IO80211DriverCommandDescriptor::MetaClass::~MetaClass(IO80211DriverCommandDescriptor::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000065EEC) ----------------------------------------------------
__int64 __fastcall IO80211DriverCommandDescriptor::IO80211DriverCommandDescriptor(__int64 a1)
{
  __int64 result; // rax@1

  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  result = (__int64)off_83090;
  *(_QWORD *)a1 = off_83090;
  return result;
}
// 83090: using guessed type __int64 (__fastcall *off_83090[2])(IO80211DriverCommandDescriptor *__hidden this);

//----- (0000000000065F0C) ----------------------------------------------------
__int64 __fastcall IO80211DriverCommandDescriptor::IO80211DriverCommandDescriptor(__int64 a1)
{
  __int64 result; // rax@1

  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  result = (__int64)off_83090;
  *(_QWORD *)a1 = off_83090;
  return result;
}
// 83090: using guessed type __int64 (__fastcall *off_83090[2])(IO80211DriverCommandDescriptor *__hidden this);

//----- (0000000000065F2C) ----------------------------------------------------
__int64 __fastcall IO80211DriverCommandDescriptor::~IO80211DriverCommandDescriptor(IO80211DriverCommandDescriptor *this)
{
  return IO80211QueueDescriptor::~IO80211QueueDescriptor(this);
}

//----- (0000000000065F36) ----------------------------------------------------
__int64 __fastcall IO80211DriverCommandDescriptor::~IO80211DriverCommandDescriptor(IO80211DriverCommandDescriptor *this)
{
  return IO80211QueueDescriptor::~IO80211QueueDescriptor(this);
}

//----- (0000000000065F40) ----------------------------------------------------
void __fastcall IO80211DriverCommandDescriptor::~IO80211DriverCommandDescriptor(IO80211DriverCommandDescriptor *this)
{
  IO80211QueueDescriptor::~IO80211QueueDescriptor(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000065F62) ----------------------------------------------------
__int64 __fastcall IO80211DriverCommandDescriptor::getMetaClass(IO80211DriverCommandDescriptor *this)
{
  return (__int64)&IO80211DriverCommandDescriptor::gMetaClass;
}
// 84DE8: using guessed type _QWORD IO80211DriverCommandDescriptor::gMetaClass;

//----- (0000000000065F70) ----------------------------------------------------
__int64 __fastcall IO80211DriverCommandDescriptor::MetaClass::MetaClass(IO80211DriverCommandDescriptor::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IO80211DriverCommandDescriptor", &IO80211QueueDescriptor::gMetaClass, 72LL);
  result = (__int64)off_831D0;
  *(_QWORD *)this = off_831D0;
  return result;
}
// 831D0: using guessed type __int64 (__fastcall *off_831D0[2])(IO80211DriverCommandDescriptor::MetaClass *__hidden this);
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000065FA2) ----------------------------------------------------
__int64 __fastcall IO80211DriverCommandDescriptor::MetaClass::alloc(IO80211DriverCommandDescriptor::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20.fileoff, a2);
  IO80211QueueDescriptor::IO80211QueueDescriptor(v2);
  *(_QWORD *)v2 = off_83090;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211DriverCommandDescriptor::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 83090: using guessed type __int64 (__fastcall *off_83090[2])(IO80211DriverCommandDescriptor *__hidden this);
// 84DE8: using guessed type _QWORD IO80211DriverCommandDescriptor::gMetaClass;

//----- (0000000000065FE2) ----------------------------------------------------
__int64 __fastcall IO80211DriverCommandDescriptor::IO80211DriverCommandDescriptor(__int64 a1)
{
  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  *(_QWORD *)a1 = off_83090;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211DriverCommandDescriptor::gMetaClass);
}
// 83090: using guessed type __int64 (__fastcall *off_83090[2])(IO80211DriverCommandDescriptor *__hidden this);
// 84DE8: using guessed type _QWORD IO80211DriverCommandDescriptor::gMetaClass;

//----- (0000000000066012) ----------------------------------------------------
__int64 __fastcall IO80211DriverCommandDescriptor::IO80211DriverCommandDescriptor(__int64 a1)
{
  IO80211QueueDescriptor::IO80211QueueDescriptor(a1);
  *(_QWORD *)a1 = off_83090;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IO80211DriverCommandDescriptor::gMetaClass);
}
// 83090: using guessed type __int64 (__fastcall *off_83090[2])(IO80211DriverCommandDescriptor *__hidden this);
// 84DE8: using guessed type _QWORD IO80211DriverCommandDescriptor::gMetaClass;

//----- (0000000000066042) ----------------------------------------------------
char __fastcall IO80211DriverCommandDescriptor::initWithIoctl(IO80211DriverCommandDescriptor *this, unsigned __int8 *a2, size_t a3, int a4, int a5)
{
  int v5; // er12@1
  int v6; // er13@1
  size_t v7; // r14@1
  void *v8; // rax@1
  char result; // al@2

  v5 = a5;
  v6 = a4;
  v7 = a3;
  LODWORD(v8) = kalloc(a3);
  *((_QWORD *)this + 6) = v8;
  if ( v8 )
  {
    *((_DWORD *)this + 14) = v6;
    *((_DWORD *)this + 15) = v5;
    memcpy(v8, a2, v7);
    *((_DWORD *)this + 10) = 0;
    *((_QWORD *)this + 8) = getAbsoluteTime();
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}
// C8BB8: using guessed type int __fastcall kalloc(_QWORD);

//----- (00000000000660AC) ----------------------------------------------------
char __fastcall IO80211DriverCommandDescriptor::initAsOutputStart(IO80211DriverCommandDescriptor *this)
{
  *((_DWORD *)this + 10) = 1;
  return 1;
}

//----- (00000000000660BC) ----------------------------------------------------
int __fastcall IO80211DriverCommandDescriptor::freeResources(IO80211DriverCommandDescriptor *this)
{
  IO80211DriverCommandDescriptor *v1; // rbx@1
  __int64 v2; // rdi@1
  int result; // eax@2

  v1 = this;
  v2 = *((_QWORD *)this + 6);
  if ( v2 )
  {
    result = kfree(v2, *((_QWORD *)v1 + 4));
    *((_QWORD *)v1 + 6) = 0LL;
  }
  *((_QWORD *)v1 + 4) = 0LL;
  return result;
}
// C8BC8: using guessed type int __fastcall kfree(_QWORD, _QWORD);

//----- (00000000000660EE) ----------------------------------------------------
__int64 __usercall IO80211DriverCommandDescriptor::print@<rax>(char a1@<al>, __int64 a2@<rdi>, __int64 a3@<rsi>)
{
  unsigned int v3; // er8@1
  __int64 v4; // rcx@2
  __int64 v5; // r9@6
  __int64 v6; // rdx@7
  char v8; // [sp-8h] [bp-20h]@6

  *(_DWORD *)(a2 + 56) = -2144835128;
  v3 = *(_DWORD *)(a2 + 40);
  if ( v3 )
  {
    if ( v3 == 1 )
      v4 = (__int64)"OutputStart";
    else
      v4 = (__int64)"unknown";
  }
  else
  {
    v4 = (__int64)"IOCTL";
  }
  _userPrint(
    a3,
    "type %u %s %llu.%03llu\n",
    v3,
    v4,
    (unsigned __int64)(19342813113834067LL * (unsigned __int128)(*(_QWORD *)(a2 + 64) >> 9) >> 64) >> 11,
    4835703278458516699LL
  * (*(_QWORD *)(a2 + 64)
   - 1000000000 * ((unsigned __int64)(19342813113834067LL * (unsigned __int128)(*(_QWORD *)(a2 + 64) >> 9) >> 64) >> 11)) >> 64 >> 18,
    a1);
  if ( !*(_DWORD *)(a2 + 40) )
  {
    v6 = (__int64)"GET";
    if ( *(_DWORD *)(a2 + 56) == -2144835128 )
      v6 = (__int64)"SET";
    _userPrint(a3, "     %s %u len %u\n", v6, *(_DWORD *)(a2 + 60), *(_QWORD *)(a2 + 32), v5, v8);
  }
  return 0LL;
}

//----- (00000000000661CC) ----------------------------------------------------
__int64 __fastcall IO80211DriverCommandDescriptor::MetaClass::~MetaClass(IO80211DriverCommandDescriptor::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000661E0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_24()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(
    &IO80211DriverCommandDescriptor::gMetaClass,
    "IO80211DriverCommandDescriptor",
    &IO80211QueueDescriptor::gMetaClass,
    72LL);
  result = (__int64)off_831D0;
  IO80211DriverCommandDescriptor::gMetaClass = off_831D0;
  return result;
}
// 831D0: using guessed type __int64 (__fastcall *off_831D0[2])(IO80211DriverCommandDescriptor::MetaClass *__hidden this);
// 84D70: using guessed type _QWORD IO80211QueueDescriptor::gMetaClass;
// 84DE8: using guessed type _QWORD IO80211DriverCommandDescriptor::gMetaClass;
// C78E8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000066220) ----------------------------------------------------
__int64 `global destructor keyed to'_a_24()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IO80211DriverCommandDescriptor::gMetaClass);
}
// 84DE8: using guessed type _QWORD IO80211DriverCommandDescriptor::gMetaClass;

//----- (0000000000066231) ----------------------------------------------------
int _start()
{
  int result; // eax@2

  if ( _realmain )
    result = _realmain();
  else
    result = 0;
  return result;
}
// 84E10: using guessed type int (*_realmain)(void);

//----- (000000000006624B) ----------------------------------------------------
__int64 *OSKextGetCurrentIdentifier()
{
  return &kmod_info + 2;
}
// 84220: using guessed type __int64 kmod_info;

//----- (000000000006625C) ----------------------------------------------------
__int64 *OSKextGetCurrentVersionString()
{
  return &kmod_info + 10;
}
// 84220: using guessed type __int64 kmod_info;

//----- (000000000006626D) ----------------------------------------------------
__int64 OSKextGetCurrentLoadTag()
{
  return *((_DWORD *)&kmod_info + 3);
}
// 84220: using guessed type __int64 kmod_info;

//----- (000000000006627D) ----------------------------------------------------
int _stop()
{
  int result; // eax@2

  if ( _antimain )
    result = _antimain();
  else
    result = 0;
  return result;
}
// 84E18: using guessed type int (*_antimain)(void);

// ALL OK, 1879 function(s) have been successfully decompiled
